<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Markdown Cheat Sheet</title>
    <url>/blog/efficiency/style/markdown-cheatsheet/</url>
    <content><![CDATA[<h1 id="markdown-cheat-sheet"><a class="markdownIt-Anchor" href="#markdown-cheat-sheet"></a> Markdown Cheat Sheet</h1>
<blockquote>
<p>ğŸ“¦ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<h2 id="ç›®å½•"><a class="markdownIt-Anchor" href="#ç›®å½•"></a> ç›®å½•</h2>
<!-- TOC depthFrom:2 depthTo:2 -->
<ul>
<li><a href="#%E7%9B%AE%E5%BD%95">ç›®å½•</a></li>
<li><a href="#%E6%A0%87%E9%A2%98">æ ‡é¢˜</a></li>
<li><a href="#%E6%96%87%E6%9C%AC%E6%A0%B7%E5%BC%8F">æ–‡æœ¬æ ·å¼</a></li>
<li><a href="#%E5%88%97%E8%A1%A8">åˆ—è¡¨</a></li>
<li><a href="#%E5%88%86%E5%89%B2%E7%BA%BF">åˆ†å‰²çº¿</a></li>
<li><a href="#%E9%93%BE%E6%8E%A5">é“¾æ¥</a></li>
<li><a href="#%E5%BC%95%E7%94%A8">å¼•ç”¨</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E9%AB%98%E4%BA%AE">ä»£ç é«˜äº®</a></li>
<li><a href="#%E8%A1%A8%E6%A0%BC">è¡¨æ ¼</a></li>
<li><a href="#emoji-%E8%A1%A8%E6%83%85">Emoji è¡¨æƒ…</a></li>
<li><a href="#%E6%B3%A8%E8%84%9A">æ³¨è„š</a></li>
<li><a href="#%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F">æ•°å­¦å…¬å¼</a></li>
<li><a href="#diff">Diff</a></li>
<li><a href="#%E6%B5%81%E7%A8%8B%E5%9B%BE">æµç¨‹å›¾</a></li>
<li><a href="#html">HTML</a></li>
<li><a href="#%E7%BC%96%E8%BE%91%E5%99%A8">ç¼–è¾‘å™¨</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="æ ‡é¢˜"><a class="markdownIt-Anchor" href="#æ ‡é¢˜"></a> æ ‡é¢˜</h2>
<p>Markdown æ”¯æŒå…­ä¸ªçº§åˆ«çš„æ ‡é¢˜ã€‚</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">è¯­æ³•ï¼š</span><br><span class="line"># ä¸€çº§æ ‡é¢˜</span><br><span class="line">## äºŒçº§æ ‡é¢˜</span><br><span class="line">### ä¸‰çº§æ ‡é¢˜</span><br><span class="line">#### å››çº§æ ‡é¢˜</span><br><span class="line">##### äº”çº§æ ‡é¢˜</span><br><span class="line">###### å…­çº§æ ‡é¢˜</span><br></pre></td></tr></table></figure>
<h2 id="æ–‡æœ¬æ ·å¼"><a class="markdownIt-Anchor" href="#æ–‡æœ¬æ ·å¼"></a> æ–‡æœ¬æ ·å¼</h2>
<blockquote>
<p>ğŸ’¡ ç²—ä½“ã€æ–œä½“ã€åˆ é™¤çº¿å¯ä»¥æ··åˆä½¿ç”¨ã€‚</p>
<p>åœ¨ Markdown ä¸­ï¼Œç²—ä½“æ–‡æœ¬ã€æ–œä½“æ–‡æœ¬å¯ä»¥ä½¿ç”¨ <code>*</code> æˆ– <code>_</code> ç¬¦å·æ ‡è®°ã€‚å»ºè®®ç»Ÿä¸€é£æ ¼ï¼Œå§‹ç»ˆåªç”¨ä¸€ç§ç¬¦å·ã€‚</p>
</blockquote>
<table>
<thead>
<tr>
<th>è¯­æ³•</th>
<th>æ•ˆæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ™®é€šæ–‡æœ¬</td>
<td>æ™®é€šæ–‡æœ¬</td>
</tr>
<tr>
<td><code>*æ–œä½“æ–‡æœ¬*</code> <code>_æ–œä½“æ–‡æœ¬_</code></td>
<td><em>æ–œä½“æ–‡æœ¬</em> <em>æ–œä½“æ–‡æœ¬</em></td>
</tr>
<tr>
<td><code>**ç²—ä½“æ–‡æœ¬**</code> <code>__ç²—ä½“æ–‡æœ¬__</code></td>
<td><strong>ç²—ä½“æ–‡æœ¬</strong> <strong>ç²—ä½“æ–‡æœ¬</strong></td>
</tr>
<tr>
<td><code>~~åˆ é™¤æ–‡æœ¬~~</code></td>
<td><s>åˆ é™¤æ–‡æœ¬</s></td>
</tr>
<tr>
<td><code>***ç²—æ–œä½“æ–‡æœ¬***</code> <code>___ç²—æ–œä½“æ–‡æœ¬___</code></td>
<td><em><strong>ç²—æ–œä½“æ–‡æœ¬</strong></em> <em><strong>ç²—æ–œä½“æ–‡æœ¬</strong></em></td>
</tr>
</tbody>
</table>
<h2 id="åˆ—è¡¨"><a class="markdownIt-Anchor" href="#åˆ—è¡¨"></a> åˆ—è¡¨</h2>
<h3 id="æ— åºåˆ—è¡¨"><a class="markdownIt-Anchor" href="#æ— åºåˆ—è¡¨"></a> æ— åºåˆ—è¡¨</h3>
<ul>
<li>RED</li>
<li>YELLOW</li>
<li>BLUE</li>
</ul>
<h3 id="æœ‰åºåˆ—è¡¨"><a class="markdownIt-Anchor" href="#æœ‰åºåˆ—è¡¨"></a> æœ‰åºåˆ—è¡¨</h3>
<ol>
<li>ç¬¬ä¸€æ­¥</li>
<li>ç¬¬äºŒæ­¥</li>
<li>ç¬¬ä¸‰æ­¥</li>
</ol>
<h3 id="ä»»åŠ¡åˆ—è¡¨"><a class="markdownIt-Anchor" href="#ä»»åŠ¡åˆ—è¡¨"></a> ä»»åŠ¡åˆ—è¡¨</h3>
<ul>
<li>[x] å®Œæˆä»»åŠ¡</li>
<li>[ ] è®¡åˆ’ä»»åŠ¡</li>
</ul>
<h3 id="å¤šçº§åˆ—è¡¨"><a class="markdownIt-Anchor" href="#å¤šçº§åˆ—è¡¨"></a> å¤šçº§åˆ—è¡¨</h3>
<ul>
<li>æ•°æ®ç»“æ„
<ul>
<li>çº¿æ€§è¡¨
<ul>
<li>é¡ºåºè¡¨</li>
<li>é“¾è¡¨
<ul>
<li>å•é“¾è¡¨</li>
<li>åŒé“¾è¡¨</li>
</ul>
</li>
</ul>
</li>
<li>æ ‘
<ul>
<li>äºŒå‰æ ‘
<ul>
<li>äºŒå‰å¹³è¡¡æ ‘</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="åˆ†å‰²çº¿"><a class="markdownIt-Anchor" href="#åˆ†å‰²çº¿"></a> åˆ†å‰²çº¿</h2>
<p><code>***</code>ã€<code>---</code>ã€<code>___</code> éƒ½å¯ä»¥ä½œä¸ºåˆ†å‰²çº¿ã€‚</p>
<hr />
<hr />
<hr />
<h2 id="é“¾æ¥"><a class="markdownIt-Anchor" href="#é“¾æ¥"></a> é“¾æ¥</h2>
<h3 id="æ™®é€šé“¾æ¥"><a class="markdownIt-Anchor" href="#æ™®é€šé“¾æ¥"></a> æ™®é€šé“¾æ¥</h3>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">æˆ‘çš„åšå®¢</span>](<span class="link">https://dunwu.github.io/blog/</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>[]</code> ä¸­æ ‡è®°é“¾æ¥åã€‚ç±»ä¼¼ HTML ä¸­ <code>&lt;a&gt;</code> å…ƒç´ çš„ <code>title</code> å±æ€§ã€‚</li>
<li><code>()</code> ä¸­æ ‡è®°é“¾æ¥çš„ urlï¼Œä¹Ÿæ”¯æŒç›¸å¯¹è·¯å¾„ï¼ˆå‰ææ˜¯èµ„æºå¯ä»¥è®¿é—®ï¼‰ã€‚ç±»ä¼¼ HTML ä¸­ <code>&lt;a&gt;</code> å…ƒç´ çš„ <code>href</code> å±æ€§ã€‚</li>
</ul>
<p>æ•ˆæœï¼š</p>
<ul>
<li><a href="https://dunwu.github.io/blog/" title="blog">æˆ‘çš„åšå®¢</a></li>
</ul>
<h3 id="å›¾ç‰‡"><a class="markdownIt-Anchor" href="#å›¾ç‰‡"></a> å›¾ç‰‡</h3>
<p>Markdown å¼•ç”¨å›¾ç‰‡çš„è¯­æ³•ï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">alt</span>](<span class="link">url title</span>)</span><br></pre></td></tr></table></figure>
<p>alt å’Œ title å³å¯¹åº” HTML ä¸­ img å…ƒç´ çš„ alt å’Œ title å±æ€§ï¼ˆéƒ½å¯çœç•¥ï¼‰ï¼š</p>
<ul>
<li>
<p>alt - è¡¨ç¤ºå›¾ç‰‡æ˜¾ç¤ºå¤±è´¥æ—¶çš„æ›¿æ¢æ–‡æœ¬ã€‚</p>
</li>
<li>
<p>title - è¡¨ç¤ºé¼ æ ‡æ‚¬åœåœ¨å›¾ç‰‡æ—¶çš„æ˜¾ç¤ºæ–‡æœ¬ï¼ˆæ³¨æ„è¿™é‡Œè¦åŠ å¼•å·ï¼‰</p>
</li>
<li>
<p>url - å³å›¾ç‰‡çš„ url åœ°å€</p>
</li>
</ul>
<p><img src="http://dunwu.test.upcdn.net/common/logo/zp.png" alt="logo" title="logo" /></p>
<h3 id="å›¾ç‰‡é“¾æ¥"><a class="markdownIt-Anchor" href="#å›¾ç‰‡é“¾æ¥"></a> å›¾ç‰‡é“¾æ¥</h3>
<p>å¯ä»¥å°†å›¾ç‰‡å’Œé“¾æ¥æ··åˆä½¿ç”¨ã€‚</p>
<p><a href="https://dunwu.github.io/blog/"><img src="http://dunwu.test.upcdn.net/common/logo/zp.png" alt="logo" title="logo" /></a></p>
<h3 id="é”šç‚¹"><a class="markdownIt-Anchor" href="#é”šç‚¹"></a> é”šç‚¹</h3>
<p>å…¶å®å‘¢ï¼Œæ¯ä¸€ä¸ªæ ‡é¢˜éƒ½æ˜¯ä¸€ä¸ªé”šç‚¹ï¼Œå’Œ HTML çš„é”šç‚¹ï¼ˆ<code>#</code>ï¼‰ç±»ä¼¼ï¼Œæ¯”å¦‚ï¼š<a href="#Markdown-%E5%BA%94%E7%94%A8%E6%8C%87%E5%8D%97">å›åˆ°é¡¶éƒ¨</a></p>
<h2 id="å¼•ç”¨"><a class="markdownIt-Anchor" href="#å¼•ç”¨"></a> å¼•ç”¨</h2>
<p>æ™®é€šå¼•ç”¨ï¼š</p>
<blockquote>
<p>â“ ä»€ä¹ˆæ˜¯ <code>Markdown</code></p>
<p><strong>Markdown</strong>æ˜¯ä¸€ç§<a href="https://zh.wikipedia.org/wiki/%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80" target="_blank" rel="noopener">è½»é‡çº§æ ‡è®°è¯­è¨€</a>ï¼Œåˆ›å§‹äººä¸º<a href="https://zh.wikipedia.org/wiki/%E7%B4%84%E7%BF%B0%C2%B7%E6%A0%BC%E9%AD%AF%E4%BC%AF" target="_blank" rel="noopener">çº¦ç¿°Â·æ ¼é²ä¼¯</a>ï¼ˆè‹±è¯­ï¼šJohn Gruberï¼‰ã€‚å®ƒå…è®¸äººä»¬â€œä½¿ç”¨æ˜“è¯»æ˜“å†™çš„çº¯æ–‡æœ¬æ ¼å¼ç¼–å†™æ–‡æ¡£ï¼Œç„¶åè½¬æ¢æˆæœ‰æ•ˆçš„<a href="https://zh.wikipedia.org/wiki/XHTML" target="_blank" rel="noopener">XHTML</a>ï¼ˆæˆ–è€…<a href="https://zh.wikipedia.org/wiki/HTML" target="_blank" rel="noopener">HTML</a>ï¼‰æ–‡æ¡£â€ã€‚[<a href="https://zh.wikipedia.org/wiki/Markdown#cite_note-md-4" target="_blank" rel="noopener">4]</a>è¿™ç§è¯­è¨€å¸æ”¶äº†å¾ˆå¤šåœ¨<a href="https://zh.wikipedia.org/wiki/%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6" target="_blank" rel="noopener">ç”µå­é‚®ä»¶</a>ä¸­å·²æœ‰çš„çº¯æ–‡æœ¬æ ‡è®°çš„ç‰¹æ€§ã€‚ â€”â€” æ‘˜è‡ª Wiki</p>
</blockquote>
<p>åµŒå¥—å¼•ç”¨ï¼š</p>
<blockquote>
<p>æ•°æ®ç»“æ„</p>
<blockquote>
<p>æ ‘</p>
<blockquote>
<p>äºŒå‰æ ‘</p>
<blockquote>
<p>å¹³è¡¡äºŒå‰æ ‘</p>
<blockquote>
<p>æ»¡äºŒå‰æ ‘</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h2 id="ä»£ç é«˜äº®"><a class="markdownIt-Anchor" href="#ä»£ç é«˜äº®"></a> ä»£ç é«˜äº®</h2>
<h3 id="æ ‡ç­¾"><a class="markdownIt-Anchor" href="#æ ‡ç­¾"></a> æ ‡ç­¾</h3>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line">`Markdown` `Doc`</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœï¼š</p>
<p><code>Markdown</code>, <code>Doc</code></p>
<h3 id="ä»£ç å—"><a class="markdownIt-Anchor" href="#ä»£ç å—"></a> ä»£ç å—</h3>
<p>è¯­æ³•ä¸€ï¼šåœ¨æ–‡æœ¬å‰åéƒ½ä½¿ç”¨ä¸‰ä¸ªåå¼•å·è¿›è¡Œæ ‡è®°ã€‚ã€âœ”ï¸ æ¨èã€‘</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬å—ã€‚</span><br><span class="line">è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬å—ã€‚</span><br><span class="line">è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬å—ã€‚</span><br></pre></td></tr></table></figure>
<p>è¯­æ³•äºŒï¼šåœ¨è¿ç»­å‡ è¡Œçš„æ–‡æœ¬å¼€å¤´åŠ å…¥ 1 ä¸ª Tab æˆ–è€… 4 ä¸ªç©ºæ ¼ã€‚ã€âŒ ä¸æ¨èã€‘</p>
<pre><code>è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬å—ã€‚
è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬å—ã€‚
è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬å—ã€‚
</code></pre>
<h3 id="è¯­æ³•"><a class="markdownIt-Anchor" href="#è¯­æ³•"></a> è¯­æ³•</h3>
<p>åœ¨ä¸‰ä¸ªåå¼•å·åé¢åŠ ä¸Šç¼–ç¨‹è¯­è¨€çš„åå­—ï¼Œå¦èµ·ä¸€è¡Œå¼€å§‹å†™ä»£ç ï¼Œæœ€åä¸€è¡Œå†åŠ ä¸Šä¸‰ä¸ªåå¼•å·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[]args)</span></span>&#123;&#125; <span class="comment">//Java</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> <span class="comment">//C</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"hello GitHub"</span> <span class="comment">#Bash</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'myH1'</span>).innerHTML = <span class="string">'Welcome to my Homepage'</span> <span class="comment">//javascipt</span></span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">string</span> &amp;<span class="keyword">operator</span>+(<span class="keyword">const</span> <span class="built_in">string</span>&amp; A,<span class="keyword">const</span> <span class="built_in">string</span>&amp; B) <span class="comment">//cpp</span></span><br></pre></td></tr></table></figure>
<h2 id="è¡¨æ ¼"><a class="markdownIt-Anchor" href="#è¡¨æ ¼"></a> è¡¨æ ¼</h2>
<p>ä¸€èˆ¬è¡¨æ ¼ï¼š</p>
<table>
<thead>
<tr>
<th>è¡¨å¤´ 1</th>
<th>è¡¨å¤´ 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>è¡¨æ ¼å•å…ƒ</td>
<td>è¡¨æ ¼å•å…ƒ</td>
</tr>
<tr>
<td>è¡¨æ ¼å•å…ƒ</td>
<td>è¡¨æ ¼å•å…ƒ</td>
</tr>
</tbody>
</table>
<p>è¡¨æ ¼å¯ä»¥æŒ‡å®šå¯¹é½æ–¹å¼ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">åºå·</th>
<th style="text-align:left">å•†å“</th>
<th style="text-align:right">ä»·æ ¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left">ç”µè„‘</td>
<td style="text-align:right">6000.0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left">é¼ æ ‡</td>
<td style="text-align:right">100.0</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left">é”®ç›˜</td>
<td style="text-align:right">200.0</td>
</tr>
</tbody>
</table>
<h2 id="emoji-è¡¨æƒ…"><a class="markdownIt-Anchor" href="#emoji-è¡¨æƒ…"></a> Emoji è¡¨æƒ…</h2>
<p>Markdown å¼•æ“ä¸€èˆ¬éƒ½æ”¯æŒ Emojiã€‚</p>
<p>åˆç†ä½¿ç”¨ Emoji è¡¨æƒ…ï¼Œå¾€å¾€å¯ä»¥ä½¿å¾—æ–‡ç« å†…å®¹æ›´åŠ ä¸°å¯Œç”ŸåŠ¨ã€‚ä¾‹å¦‚ï¼šâœ”ï¸ âŒ ğŸ’¡ ğŸ”” â—ï¸ â“</p>
<blockquote>
<p>æ›´å¤š Emoji è¡¨æƒ…è¯·å‚è€ƒï¼š</p>
<ul>
<li><a href="http://emojihomepage.com/" target="_blank" rel="noopener">http://emojihomepage.com/</a></li>
<li><a href="http://www.emoji-cheat-sheet.com" target="_blank" rel="noopener">http://www.emoji-cheat-sheet.com</a></li>
</ul>
</blockquote>
<h2 id="æ³¨è„š"><a class="markdownIt-Anchor" href="#æ³¨è„š"></a> æ³¨è„š</h2>
<p>ä¸€ä¸ªå…·æœ‰æ³¨è„šçš„æ–‡æœ¬ã€‚<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<h2 id="æ•°å­¦å…¬å¼"><a class="markdownIt-Anchor" href="#æ•°å­¦å…¬å¼"></a> æ•°å­¦å…¬å¼</h2>
<p>å¾ˆå¤šæ–‡æ¡£ä¸­ï¼Œéœ€è¦å¼•å…¥ä¸€äº›æ•°å­¦ç¬¦å·ã€ç‰¹æ®Šç¬¦å·ï¼Œå…¶æ’ç‰ˆé—®é¢˜æ¯”è¾ƒå¤´ç–¼ã€‚è¿™ç§é—®é¢˜ï¼Œå¯ä»¥ç”¨ Latex æ¥è§£å†³ï¼Œå¤§éƒ¨åˆ† Markdown å¼•æ“éƒ½æ”¯æŒ Latexã€‚</p>
<p>Latex å¯ä»¥ä½¿ç”¨ <code>$</code> ç¬¦å·æ¥æ ‡è®° Latex è¡¨è¾¾å¼ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªæ•°å­¦å…¬å¼ç¤ºä¾‹ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î“</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>âˆ«</mo><mn>0</mn><mi mathvariant="normal">âˆ</mi></msubsup><msup><mi>t</mi><mrow><mi>z</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>t</mi></mrow></msup><mi>d</mi><mi>t</mi><mtext>â€‰</mtext><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\Gamma(z) = \int_0^\infty t^{z-1}e^{-t}dt\,.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Î“</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.414292em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">âˆ</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span></span></span></span></span></p>
<p>åˆ—ä¸¾ä¸€äº›å¸¸ç”¨æ•°å­¦ç¬¦å·ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">ç¬¦å·</th>
<th>è¯­æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰¤</mo></mrow><annotation encoding="application/x-tex">\leq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">â‰¤</span></span></span></span></td>
<td><code>$\leq$</code></td>
<td>å°äºç­‰äº</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰¥</mo></mrow><annotation encoding="application/x-tex">\geq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">â‰¥</span></span></span></span></td>
<td><code>$\geq$</code></td>
<td>å¤§äºç­‰äº</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â‰ </mi></mrow><annotation encoding="application/x-tex">\neq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">î€ </span></span><span class="fix"></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span></span></span></span></td>
<td><code>$\neq$</code></td>
<td>ä¸ç­‰äº</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰ˆ</mo></mrow><annotation encoding="application/x-tex">\approx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.48312em;vertical-align:0em;"></span><span class="mrel">â‰ˆ</span></span></span></span></td>
<td><code>$\approx$</code></td>
<td>çº¦ç­‰äº</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ</mi></mrow><annotation encoding="application/x-tex">\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord">âˆ</span></span></span></span></td>
<td><code>$\infty$</code></td>
<td>æ— ç©·</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>âˆ</mo><mi>x</mi><mi>y</mi></msubsup></mrow><annotation encoding="application/x-tex">\prod_{x}^{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span style="top:-3.2029000000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span></span></span></span></td>
<td><code>$\prod_{x}^{y}$</code></td>
<td>ç´¯ä¹˜</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\sum_{i=0}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span></span></span></span></td>
<td><code>$\sum_{i=0}^n$</code></td>
<td>æ±‚å’Œ</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>âˆ«</mo></mrow><annotation encoding="application/x-tex">\int</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.11112em;vertical-align:-0.30612em;"></span><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">âˆ«</span></span></span></span></td>
<td><code>$\int$</code></td>
<td>ç§¯åˆ†</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>âˆ¬</mo></mrow><annotation encoding="application/x-tex">\iint</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.111em;vertical-align:-0.306em;"></span><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0004999999999999727em;">âˆ¬</span></span></span></span></td>
<td><code>$\iint$</code></td>
<td>åŒé‡ç§¯åˆ†</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo><mi>log</mi><mo>â¡</mo></mo><mi>x</mi></msub><mi>y</mi></mrow><annotation encoding="application/x-tex">\log_x{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span></span></td>
<td><code>$\log_x{y}$</code></td>
<td>å¯¹æ•°</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mi>y</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">x^{y+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></td>
<td><code>$x^{y+1}$</code></td>
<td>ä¸Šæ ‡</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>y</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_{y+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></td>
<td><code>$x_{y+1}$</code></td>
<td>ä¸‹æ ‡</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>x</mi><mi>y</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{x}{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1764999999999999em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td>
<td><code>$\frac{x}{y}$</code></td>
<td>åˆ†æ•°</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mroot><mi>x</mi><mi>y</mi></mroot></mrow><annotation encoding="application/x-tex">\sqrt[y]{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5516160000000001em;"><span style="top:-2.836336em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">x</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span></span></td>
<td><code>$\sqrt[y]{x}$</code></td>
<td>å¼€æ–¹</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>sin</mi><mo>â¡</mo></mrow><annotation encoding="application/x-tex">\sin</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66786em;vertical-align:0em;"></span><span class="mop">sin</span></span></span></span></td>
<td><code>$\sin$</code></td>
<td>æ­£å¼¦</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>cos</mi><mo>â¡</mo></mrow><annotation encoding="application/x-tex">\cos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mop">cos</span></span></span></span></td>
<td><code>$\cos$</code></td>
<td>ä½™å¼¦</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>tan</mi><mo>â¡</mo></mrow><annotation encoding="application/x-tex">\tan</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mop">tan</span></span></span></span></td>
<td><code>$\tan$</code></td>
<td>æ­£åˆ‡</td>
</tr>
</tbody>
</table>
<blockquote>
<p>æ›´å¤šæ•°å­¦ç¬¦å·æ”¯æŒè¯·å‚è€ƒï¼š</p>
<ul>
<li><a href="https://github.com/luong-komorebi/Begin-Latex-in-minutes" target="_blank" rel="noopener">Begin-Latex-in-minutes</a></li>
<li><a href="https://blog.csdn.net/Katherine_hsr/article/details/79179622" target="_blank" rel="noopener">Markdown æ•°å­¦ç¬¦å·&amp;å…¬å¼</a></li>
</ul>
</blockquote>
<h2 id="diff"><a class="markdownIt-Anchor" href="#diff"></a> Diff</h2>
<p>ç‰ˆæœ¬æ§åˆ¶çš„ç³»ç»Ÿä¸­éƒ½å°‘ä¸äº† diff çš„åŠŸèƒ½ï¼Œå³å±•ç¤ºä¸€ä¸ªæ–‡ä»¶å†…å®¹çš„å¢åŠ ä¸åˆ é™¤ã€‚<br />
GFM ä¸­å¯ä»¥æ˜¾ç¤ºçš„å±•ç¤º diff æ•ˆæœã€‚å¯ä»¥ç”¨ <code>+</code> å¼€å¤´è¡¨ç¤ºæ–°å¢ï¼Œ<code>-</code> å¼€å¤´è¡¨ç¤ºåˆ é™¤ã€‚</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="addition">+ æ–°å¢å†…å®¹</span></span><br><span class="line"><span class="deletion">- åˆ é™¤å†…å®¹</span></span><br></pre></td></tr></table></figure>
<h2 id="uml-å›¾"><a class="markdownIt-Anchor" href="#uml-å›¾"></a> UML å›¾</h2>
<blockquote>
<p>éƒ¨åˆ† Markdown å¼•æ“æ”¯æŒ <a href="https://mermaid-js.github.io/mermaid/" target="_blank" rel="noopener">mermaid</a> æä¾›çš„å„ç§ UML å›¾ã€‚è¯¦æƒ…è¯·å‚è€ƒï¼š<a href="https://mermaidjs.github.io/" target="_blank" rel="noopener">mermaid æ–‡æ¡£</a></p>
</blockquote>
<h3 id="æµç¨‹å›¾"><a class="markdownIt-Anchor" href="#æµç¨‹å›¾"></a> æµç¨‹å›¾</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">graph LR</span><br><span class="line">    A[Hard edge] --&gt;|Link text| B(Round edge)</span><br><span class="line">    B --&gt; C&#123;Decision&#125;</span><br><span class="line">    C --&gt;|One| D[Result one]</span><br><span class="line">    C --&gt;|Two| E[Result two]</span><br></pre></td></tr></table></figure>
<h3 id="æ—¶åºå›¾"><a class="markdownIt-Anchor" href="#æ—¶åºå›¾"></a> æ—¶åºå›¾</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">    Alice-&gt;&gt;Bob: Hello Bob, how are you?</span><br><span class="line">    alt is sick</span><br><span class="line">        Bob-&gt;&gt;Alice: Not so good :(</span><br><span class="line">    else is well</span><br><span class="line">        Bob-&gt;&gt;Alice: Feeling fresh like a daisy</span><br><span class="line">    end</span><br><span class="line">    opt Extra response</span><br><span class="line">        Bob-&gt;&gt;Alice: Thanks for asking</span><br><span class="line">    end</span><br></pre></td></tr></table></figure>
<h3 id="ç”˜ç‰¹å›¾"><a class="markdownIt-Anchor" href="#ç”˜ç‰¹å›¾"></a> ç”˜ç‰¹å›¾</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gantt</span><br><span class="line">       dateFormat  YYYY-MM-DD</span><br><span class="line">       title Adding GANTT diagram functionality to mermaid</span><br><span class="line"></span><br><span class="line">       section A section</span><br><span class="line">       Completed task            :done,    des1, 2014-01-06,2014-01-08</span><br><span class="line">       Active task               :active,  des2, 2014-01-09, 3d</span><br><span class="line">       Future task               :         des3, after des2, 5d</span><br><span class="line">       Future task2              :         des4, after des3, 5d</span><br><span class="line"></span><br><span class="line">       section Critical tasks</span><br><span class="line">       Completed task in the critical line :crit, done, 2014-01-06,24h</span><br><span class="line">       Implement parser and jison          :crit, done, after des1, 2d</span><br><span class="line">       Create tests for parser             :crit, active, 3d</span><br><span class="line">       Future task in critical line        :crit, 5d</span><br><span class="line">       Create tests for renderer           :2d</span><br><span class="line">       Add to mermaid                      :1d</span><br><span class="line"></span><br><span class="line">       section Documentation</span><br><span class="line">       Describe gantt syntax               :active, a1, after des1, 3d</span><br><span class="line">       Add gantt diagram to demo page      :after a1  , 20h</span><br><span class="line">       Add another diagram to demo page    :doc1, after a1  , 48h</span><br><span class="line"></span><br><span class="line">       section Last section</span><br><span class="line">       Describe gantt syntax               :after doc1, 3d</span><br><span class="line">       Add gantt diagram to demo page      :20h</span><br><span class="line">       Add another diagram to demo page    :48h</span><br></pre></td></tr></table></figure>
<h2 id="html"><a class="markdownIt-Anchor" href="#html"></a> HTML</h2>
<p>æœ‰äº› Markdown å¼•æ“æ”¯æŒåœ¨æ–‡æ¡£ä¸­åµŒå…¥çš„ html å…ƒç´ ã€‚</p>
<p>æœ‰äº› Markdown è¯­æ³•æ‰€ä¸æ”¯æŒçš„ç‰¹æ€§ï¼Œå¯ä»¥ä½¿ç”¨ html å…ƒç´ æ¥æ”¯æŒã€‚</p>
<h3 id="æŠ˜å "><a class="markdownIt-Anchor" href="#æŠ˜å "></a> æŠ˜å </h3>
<details>
  <summary>æŠ˜å å†…å®¹ä¸€</summary>
  <p>å±•å¼€æ‰èƒ½çœ‹åˆ°çš„å†…å®¹</p>
</details>
<details>
  <summary>æŠ˜å å†…å®¹äºŒ</summary>
  <p>å±•å¼€æ‰èƒ½çœ‹åˆ°çš„å†…å®¹</p>
</details>
<h3 id="å±…ä¸­"><a class="markdownIt-Anchor" href="#å±…ä¸­"></a> å±…ä¸­</h3>
<div align="center"><p>å±…ä¸­æ˜¾ç¤ºçš„æ–‡æœ¬</p></div>
### å›¾ç‰‡å°ºå¯¸
<div align="center"><img width="100px" src="http://dunwu.test.upcdn.net/common/logo/zp.png" /></div>
## ç¼–è¾‘å™¨
<p>æ¨è Markdown ç¼–è¾‘å™¨</p>
<ul>
<li><a href="https://www.typora.io/" target="_blank" rel="noopener">Typora</a> - ä¸ªäººè®¤ä¸ºæ˜¯åŠŸèƒ½æœ€å¼ºçš„ Markdown ç¼–è¾‘å™¨ã€‚</li>
<li><a href="https://github.com/microsoft/vscode" target="_blank" rel="noopener">Visual Studio Code</a> - å¯ä»¥é€šè¿‡å®‰è£…æ’ä»¶ï¼Œé‡èº«æ‰“é€  Markdown ç¼–è¾‘å™¨ã€‚</li>
<li><a href="https://github.com/marktext/marktext" target="_blank" rel="noopener">marktext</a> - ä¸€æ¬¾ç®€å•ä¼˜é›…çš„ Markdown ç¼–è¾‘å™¨ã€‚</li>
<li><a href="https://stackedit.io/" target="_blank" rel="noopener">StackEdit</a> - åœ¨çº¿ Markdown ç¼–è¾‘å™¨ã€‚</li>
<li><a href="https://pandao.github.io/editor.md/" target="_blank" rel="noopener">Editor.md</a> - åœ¨çº¿ Markdown ç¼–è¾‘å™¨ã€‚</li>
<li><a href="https://maxiang.io/" target="_blank" rel="noopener">Marxico</a> - ä¸€æ¬¾ä¸“ä¸ºå°è±¡ç¬”è®°ï¼ˆEvernoteï¼‰æ‰“é€ çš„ Markdown ç¼–è¾‘å™¨ã€‚</li>
</ul>
<blockquote>
<p>æƒ³äº†è§£æ›´å¤š Markdown ç¼–è¾‘å™¨å¯ä»¥å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/69210764" target="_blank" rel="noopener">ä¸»æµ Markdown ç¼–è¾‘å™¨æ¨è</a></p>
</blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/Markdown" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/Markdown</a></li>
<li><a href="https://github.com/guodongxiaren/README" target="_blank" rel="noopener">https://github.com/guodongxiaren/README</a></li>
<li><a href="https://github.com/tchapi/markdown-cheatsheet" target="_blank" rel="noopener">markdown-cheatsheet</a></li>
<li><a href="https://github.com/luong-komorebi/Begin-Latex-in-minutes" target="_blank" rel="noopener">Begin-Latex-in-minutes</a></li>
<li><a href="https://github.com/mermaid-js/mermaid" target="_blank" rel="noopener">https://github.com/mermaid-js/mermaid</a></li>
</ul>
<hr class="footnotes-sep" />
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>æ³¨è„šçš„è§£é‡Š <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>
]]></content>
      <categories>
        <category>æ•ˆç‡æå‡</category>
        <category>è§„èŒƒ</category>
      </categories>
      <tags>
        <tag>æ•ˆç‡æå‡</tag>
        <tag>è§„èŒƒ</tag>
        <tag>markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>é™æµåŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/flow-limit-theory/</url>
    <content><![CDATA[<h1 id="é™æµåŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#é™æµåŸºæœ¬åŸç†"></a> é™æµåŸºæœ¬åŸç†</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E9%99%90%E6%B5%81%E6%96%B9%E6%B3%95">é™æµæ–¹æ³•</a>
<ul>
<li><a href="#%E8%AE%A1%E6%95%B0%E5%99%A8">è®¡æ•°å™¨</a></li>
<li><a href="#%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3">æ»‘åŠ¨çª—å£</a></li>
<li><a href="#%E4%BB%A4%E7%89%8C%E6%A1%B6token-bucket">ä»¤ç‰Œæ¡¶ï¼ˆToken Bucketï¼‰</a></li>
<li><a href="#%E6%BC%8F%E6%A1%B6">æ¼æ¡¶</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<p>é™æµå¯ä»¥è®¤ä¸ºæ˜¯æœåŠ¡é™çº§çš„ä¸€ç§ã€‚é™æµå°±æ˜¯<strong>é™åˆ¶ç³»ç»Ÿçš„è¾“å…¥å’Œè¾“å‡ºæµé‡å·²è¾¾åˆ°ä¿æŠ¤ç³»ç»Ÿçš„ç›®çš„</strong>ã€‚ä¸€èˆ¬æ¥è¯´ç³»ç»Ÿçš„ååé‡æ˜¯å¯ä»¥è¢«æµ‹ç®—çš„ï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿçš„ç¨³å®šè¿è¡Œï¼Œä¸€æ—¦è¾¾åˆ°çš„éœ€è¦é™åˆ¶çš„é˜ˆå€¼ï¼Œå°±éœ€è¦é™åˆ¶æµé‡å¹¶é‡‡å–ä¸€äº›æªæ–½ä»¥å®Œæˆé™åˆ¶æµé‡çš„ç›®çš„ã€‚æ¯”å¦‚ï¼šå»¶è¿Ÿå¤„ç†ï¼Œæ‹’ç»å¤„ç†ï¼Œæˆ–è€…éƒ¨åˆ†æ‹’ç»å¤„ç†ç­‰ç­‰ã€‚</p>
<h2 id="é™æµæ–¹æ³•"><a class="markdownIt-Anchor" href="#é™æµæ–¹æ³•"></a> é™æµæ–¹æ³•</h2>
<h3 id="è®¡æ•°å™¨"><a class="markdownIt-Anchor" href="#è®¡æ•°å™¨"></a> è®¡æ•°å™¨</h3>
<p>æ§åˆ¶å•ä½æ—¶é—´çš„è¯·æ±‚æ•°é‡ã€‚ä½¿ç”¨ <code>AtomicInteger</code> è¿›è¡Œç»Ÿè®¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€å¤§è®¿é—®æ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> limit = <span class="number">10</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¿é—®æ—¶é—´å·®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> timeout = <span class="number">1000</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯·æ±‚æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> time;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰è®¡æ•°å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> AtomicInteger reqCount = <span class="keyword">new</span> AtomicInteger(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">limit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> now = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">if</span> (now &lt; time + timeout) &#123;</span><br><span class="line">            <span class="comment">// å•ä½æ—¶é—´å†…</span></span><br><span class="line">            reqCount.addAndGet(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> reqCount.get() &lt;= limit;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// è¶…å‡ºå•ä½æ—¶é—´</span></span><br><span class="line">            time = now;</span><br><span class="line">            reqCount = <span class="keyword">new</span> AtomicInteger(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#æ»‘åŠ¨çª—å£"></a> æ»‘åŠ¨çª—å£</h3>
<p>æ»‘åŠ¨çª—å£æ˜¯å¯¹è®¡æ•°å™¨æ–¹å¼çš„æ”¹è¿›ï¼Œå¢åŠ ä¸€ä¸ªæ—¶é—´ç²’åº¦çš„åº¦é‡å•ä½ ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentLinkedQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeWindow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ConcurrentLinkedQueue&lt;Long&gt; queue = <span class="keyword">new</span> ConcurrentLinkedQueue&lt;Long&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é—´éš”ç§’æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> seconds;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ€å¤§é™æµ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> max;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TimeWindow</span><span class="params">(<span class="keyword">int</span> max, <span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.seconds = seconds;</span><br><span class="line">        <span class="keyword">this</span>.max = max;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * æ°¸ç»­çº¿ç¨‹æ‰§è¡Œæ¸…ç†queue ä»»åŠ¡</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// ç­‰å¾… é—´éš”ç§’æ•°-1 æ‰§è¡Œæ¸…ç†æ“ä½œ</span></span><br><span class="line">                    Thread.sleep((seconds - <span class="number">1</span>) * <span class="number">1000L</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                clean();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> TimeWindow timeWindow = <span class="keyword">new</span> TimeWindow(<span class="number">10</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æµ‹è¯•3ä¸ªçº¿ç¨‹</span></span><br><span class="line">        IntStream.range(<span class="number">0</span>, <span class="number">3</span>).forEach((i) -&gt; &#123;</span><br><span class="line">            <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="keyword">new</span> Random().nextInt(<span class="number">20</span>) * <span class="number">100</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    timeWindow.take();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;).start();</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ä»¤ç‰Œï¼Œå¹¶ä¸”æ·»åŠ æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">take</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> size = sizeOfValid();</span><br><span class="line">            <span class="keyword">if</span> (size &gt; max) &#123;</span><br><span class="line">                System.err.println(<span class="string">"è¶…é™"</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">synchronized</span> (queue) &#123;</span><br><span class="line">                <span class="keyword">if</span> (sizeOfValid() &gt; max) &#123;</span><br><span class="line">                    System.err.println(<span class="string">"è¶…é™"</span>);</span><br><span class="line">                    System.err.println(<span class="string">"queueä¸­æœ‰ "</span> + queue.size() + <span class="string">" æœ€å¤§æ•°é‡ "</span> + max);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.queue.offer(System.currentTimeMillis());</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"queueä¸­æœ‰ "</span> + queue.size() + <span class="string">" æœ€å¤§æ•°é‡ "</span> + max);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sizeOfValid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Iterator&lt;Long&gt; it = queue.iterator();</span><br><span class="line">        Long ms = System.currentTimeMillis() - seconds * <span class="number">1000</span>;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">long</span> t = it.next();</span><br><span class="line">            <span class="keyword">if</span> (t &gt; ms) &#123;</span><br><span class="line">                <span class="comment">// åœ¨å½“å‰çš„ç»Ÿè®¡æ—¶é—´èŒƒå›´å†…</span></span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¸…ç†è¿‡æœŸçš„æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clean</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Long c = System.currentTimeMillis() - seconds * <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">        Long tl = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">while</span> ((tl = queue.peek()) != <span class="keyword">null</span> &amp;&amp; tl &lt; c) &#123;</span><br><span class="line">            System.out.println(<span class="string">"æ¸…ç†æ•°æ®"</span>);</span><br><span class="line">            queue.poll();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä»¤ç‰Œæ¡¶token-bucket"><a class="markdownIt-Anchor" href="#ä»¤ç‰Œæ¡¶token-bucket"></a> ä»¤ç‰Œæ¡¶ï¼ˆToken Bucketï¼‰</h3>
<p>è§„å®šå›ºå®šå®¹é‡çš„æ¡¶,token ä»¥å›ºå®šé€Ÿåº¦å¾€æ¡¶å†…å¡«å……,å½“æ¡¶æ»¡æ—¶ token ä¸ä¼šè¢«ç»§ç»­æ”¾å…¥,æ¯è¿‡æ¥ä¸€ä¸ªè¯·æ±‚æŠŠ token ä»æ¡¶ä¸­ç§»é™¤,å¦‚æœæ¡¶ä¸­æ²¡æœ‰ token ä¸èƒ½è¯·æ±‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenBucket</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> time;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€»é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Double total;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * token æ”¾å…¥é€Ÿåº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Double rate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰æ€»é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Double nowSize;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">limit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> now = System.currentTimeMillis();</span><br><span class="line">        nowSize = Math.min(total, nowSize + (now - time) * rate);</span><br><span class="line">        time = now;</span><br><span class="line">        <span class="keyword">if</span> (nowSize &lt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">// æ¡¶é‡Œæ²¡æœ‰token</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å­˜åœ¨token</span></span><br><span class="line">            nowSize -= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ¼æ¡¶"><a class="markdownIt-Anchor" href="#æ¼æ¡¶"></a> æ¼æ¡¶</h3>
<p>è§„å®šå›ºå®šå®¹é‡çš„æ¡¶ï¼Œæœ‰æ°´è¿›å…¥ï¼Œæœ‰æ°´æµå‡ºã€‚å¯¹äºæµè¿›çš„æ°´æˆ‘ä»¬æ— æ³•ä¼°è®¡è¿›æ¥çš„æ•°é‡ã€é€Ÿåº¦ï¼Œå¯¹äºæµå‡ºçš„æ°´æˆ‘ä»¬å¯ä»¥æ§åˆ¶é€Ÿåº¦ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LeakBucket</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> time;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€»é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Double total;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ°´æµå‡ºå»çš„é€Ÿåº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Double rate;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰æ€»é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Double nowSize;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">limit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> now = System.currentTimeMillis();</span><br><span class="line">        nowSize = Math.max(<span class="number">0</span>, (nowSize - (now - time) * rate));</span><br><span class="line">        time = now;</span><br><span class="line">        <span class="keyword">if</span> ((nowSize + <span class="number">1</span>) &lt; total) &#123;</span><br><span class="line">            nowSize++;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li>ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ã€‹</li>
<li><a href="https://www.jianshu.com/p/76cc8ba5ca91" target="_blank" rel="noopener">è°ˆè°ˆé™æµç®—æ³•çš„å‡ ç§å®ç°</a></li>
<li><a href="https://github.com/doocs/advanced-java/blob/master/docs/high-concurrency/huifer-how-to-limit-current.md" target="_blank" rel="noopener">å¦‚ä½•é™æµï¼Ÿåœ¨å·¥ä½œä¸­æ˜¯æ€ä¹ˆåšçš„ï¼Ÿè¯´ä¸€ä¸‹å…·ä½“çš„å®ç°ï¼Ÿ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>é™æµ</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ‹è¯•æŠ€æœ¯åŸç†</title>
    <url>/blog/design/architecture/test-architecture/</url>
    <content><![CDATA[<h1 id="æµ‹è¯•æŠ€æœ¯åŸç†"><a class="markdownIt-Anchor" href="#æµ‹è¯•æŠ€æœ¯åŸç†"></a> æµ‹è¯•æŠ€æœ¯åŸç†</h1>
<blockquote>
<p>è½¯ä»¶æµ‹è¯•æè¿°ä¸€ç§ç”¨æ¥ä¿ƒè¿›é‰´å®šè½¯ä»¶çš„æ­£ç¡®æ€§ã€å®Œæ•´æ€§ã€å®‰å…¨æ€§å’Œè´¨é‡çš„è¿‡ç¨‹ã€‚è½¯ä»¶æµ‹è¯•çš„ç»å…¸å®šä¹‰æ˜¯ï¼šåœ¨è§„å®šçš„æ¡ä»¶ä¸‹å¯¹ç¨‹åºè¿›è¡Œæ“ä½œï¼Œä»¥å‘ç°ç¨‹åºé”™è¯¯ï¼Œè¡¡é‡è½¯ä»¶è´¨é‡ï¼Œå¹¶å¯¹å…¶æ˜¯å¦èƒ½æ»¡è¶³è®¾è®¡è¦æ±‚è¿›è¡Œè¯„ä¼°çš„è¿‡ç¨‹ã€‚</p>
<p>ç°ä»£è½¯ä»¶å¼€å‘é¡¹ç›®ä¸­ï¼Œåˆ†å·¥æ˜ç¡®ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¼šæœ‰ç ”å‘ã€æµ‹è¯•ã€QA ç­‰è§’è‰²ã€‚ä¸åŒè§’è‰²ç”±äºå…³æ³¨çš„è§†è§’ä¸åŒï¼Œæµ‹è¯•ç›®æ ‡å’Œæµ‹è¯•æ–¹æ³•ä¹Ÿä¸å®Œå…¨ç›¸åŒã€‚æœ¬æ–‡ä¸»è¦ä»ç ”å‘ã€æµ‹è¯•çš„è§†è§’å»è€ƒé‡è½¯ä»¶æµ‹è¯•æŠ€æœ¯ã€‚</p>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>ä¸ºäº†æ–¹ä¾¿ï¼Œåªæœ‰æµ‹è¯•äººå‘˜éœ€è¦å…³æ³¨çš„æµ‹è¯•ç‚¹ç”¨ã€æµ‹è¯•ã€‘æ ‡æ³¨ï¼›</li>
<li>è€Œåªæœ‰ç ”å‘äººå‘˜éœ€è¦å…³æ³¨çš„æµ‹è¯•ç‚¹ç”¨ã€ç ”å‘ã€‘æ ‡æ³¨ï¼›</li>
<li>éƒ½éœ€è¦å…³æ³¨çš„æµ‹è¯•ç‚¹åˆ™ä¸ä½œæ ‡æ³¨ã€‚</li>
</ul>
</blockquote>
<h2 id="æµ‹è¯•æ–¹æ³•åˆ†ç±»"><a class="markdownIt-Anchor" href="#æµ‹è¯•æ–¹æ³•åˆ†ç±»"></a> æµ‹è¯•æ–¹æ³•åˆ†ç±»</h2>
<h3 id="ä»æµ‹è¯•è®¾è®¡æ–¹æ³•åˆ†ç±»"><a class="markdownIt-Anchor" href="#ä»æµ‹è¯•è®¾è®¡æ–¹æ³•åˆ†ç±»"></a> ä»æµ‹è¯•è®¾è®¡æ–¹æ³•åˆ†ç±»</h3>
<ul>
<li><strong>é»‘ç›’æµ‹è¯•ã€æµ‹è¯•ã€‘</strong> - æŠŠè½¯ä»¶ç³»ç»Ÿå½“ä½œä¸€ä¸ªâ€œé»‘ç®±â€ï¼Œæ— æ³•äº†è§£æˆ–ä½¿ç”¨ç³»ç»Ÿçš„å†…éƒ¨ç»“æ„åŠçŸ¥è¯†ã€‚ä»è½¯ä»¶çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯å†…éƒ¨ç»“æ„å‡ºå‘æ¥è®¾è®¡æµ‹è¯•ã€‚</li>
<li><strong>ç™½ç›’æµ‹è¯•ã€ç ”å‘ã€‘</strong> - è®¾è®¡è€…å¯ä»¥çœ‹åˆ°è½¯ä»¶ç³»ç»Ÿçš„å†…éƒ¨ç»“æ„ï¼Œå¹¶ä¸”ä½¿ç”¨è½¯ä»¶çš„å†…éƒ¨çŸ¥è¯†æ¥æŒ‡å¯¼æµ‹è¯•æ•°æ®åŠæ–¹æ³•çš„é€‰æ‹©ã€‚</li>
<li><strong>ç°ç›’æµ‹è¯•</strong> - ä»‹äºé»‘ç›’å’Œç™½ç›’ä¹‹é—´ã€‚</li>
</ul>
<blockquote>
<p>å°ç»“ï¼š</p>
<ul>
<li>é»‘æ²³æµ‹è¯•é€šå¸¸é’ˆå¯¹çš„æ˜¯è½¯ä»¶çš„è¡Œä¸ºæˆ–åŠŸèƒ½ï¼Œä¸€èˆ¬æ˜¯æµ‹è¯•äººå‘˜ä¸»è¦å…³æ³¨çš„ã€‚</li>
<li>ç™½ç›’æµ‹è¯•é€šå¸¸åˆ™éœ€è¦å¯¹è½¯ä»¶æœ‰ä¸€å®šç¨‹åº¦çš„äº†è§£ï¼Œä¸€èˆ¬æ˜¯å¼€å‘äººå‘˜æ‰€å…³æ³¨çš„ã€‚</li>
<li>ç°ç›’æµ‹è¯•é€šå¸¸æ˜¯ä¸ºäº†æµ‹è¯•è½¯ä»¶åœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹çš„è¡¨ç°ï¼Œè€Œéä¸»åœºæ™¯ã€‚</li>
</ul>
</blockquote>
<h3 id="ä»æµ‹è¯•çš„ç›®çš„åˆ†ç±»"><a class="markdownIt-Anchor" href="#ä»æµ‹è¯•çš„ç›®çš„åˆ†ç±»"></a> ä»æµ‹è¯•çš„ç›®çš„åˆ†ç±»</h3>
<h4 id="åŠŸèƒ½æµ‹è¯•"><a class="markdownIt-Anchor" href="#åŠŸèƒ½æµ‹è¯•"></a> åŠŸèƒ½æµ‹è¯•</h4>
<ul>
<li><strong>å•å…ƒæµ‹è¯•ï¼ˆUnit Testï¼‰</strong> - åœ¨æœ€ä½ç²’åº¦çš„åŠŸèƒ½/å‚æ•°ä¸ŠéªŒè¯ç¨‹åºçš„å‡†ç¡®æ€§ï¼Œæ¯”å¦‚æµ‹è¯•ä¸€ä¸ªå‡½æ•°çš„æ­£ç¡®æ€§ã€‚ã€ç ”å‘ã€‘
<ul>
<li>å¸¸ç”¨æŠ€æœ¯ï¼š<a href="https://github.com/junit-team/junit4" target="_blank" rel="noopener"><strong>junit4</strong></a>ã€<a href="https://github.com/junit-team/junit5" target="_blank" rel="noopener"><strong>junit5</strong></a>ã€<a href="https://github.com/mockito/mockito" target="_blank" rel="noopener"><strong>mockito</strong></a>ã€<a href="https://github.com/joel-costigliola/assertj-core" target="_blank" rel="noopener"><strong>assertj-core</strong></a></li>
</ul>
</li>
<li><strong>åŠŸèƒ½æµ‹è¯•ï¼ˆFunctional Testï¼‰</strong> - éªŒè¯æ¨¡å—çš„åŠŸèƒ½ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>é›†æˆæµ‹è¯•ï¼ˆIntegration Testï¼‰</strong> - éªŒè¯å‡ ä¸ªäº’ç›¸æœ‰ä¾èµ–å…³ç³»çš„æ¨¡å—çš„åŠŸèƒ½ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>åœºæ™¯æµ‹è¯•ï¼ˆScenario Testï¼‰</strong>- éªŒè¯å‡ ä¸ªæ¨¡å—æ˜¯å¦èƒ½å®Œæˆä¸€ä¸ªç”¨æˆ·åœºæ™¯ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>ç³»ç»Ÿæµ‹è¯•ï¼ˆSystem Testï¼‰</strong> - å¯¹äºæ•´ä¸ªç³»ç»ŸåŠŸèƒ½çš„æµ‹è¯•ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>Alpha æµ‹è¯•</strong> - è½¯ä»¶æµ‹è¯•äººå‘˜åœ¨çœŸå®ç”¨æˆ·ç¯å¢ƒä¸­å¯¹è½¯ä»¶è¿›è¡Œå…¨é¢çš„æµ‹è¯•ã€‚ã€æµ‹è¯•ã€‘</li>
<li><strong>Beta æµ‹è¯•</strong> - ä¹Ÿå«å…¬æµ‹ï¼Œæ˜¯çœŸå®çš„ç”¨æˆ·åœ¨çœŸå®çš„ç¯å¢ƒä¸­è¿›è¡Œçš„æµ‹è¯•ã€‚</li>
</ul>
<h4 id="éåŠŸèƒ½æµ‹è¯•"><a class="markdownIt-Anchor" href="#éåŠŸèƒ½æµ‹è¯•"></a> éåŠŸèƒ½æµ‹è¯•</h4>
<ul>
<li><strong>å‹åŠ›æµ‹è¯•ï¼ˆStress testï¼‰</strong> - éªŒè¯è½¯ä»¶åœ¨è¶…è¿‡è´Ÿè½½è®¾è®¡çš„æƒ…å†µä¸‹ä»èƒ½è¿”å›æ­£ç¡®çš„ç»“æœï¼Œæ²¡æœ‰å´©æºƒ</li>
<li><strong>è´Ÿè½½æµ‹è¯•ï¼ˆLoad testï¼‰</strong> - æµ‹è¯•è½¯ä»¶åœ¨è´Ÿè½½æƒ…å†µä¸‹èƒ½å¦æ­£å¸¸å·¥ä½œ</li>
<li><strong>æ€§èƒ½æµ‹è¯•ï¼ˆPerformance testï¼‰</strong> - æµ‹è¯•è½¯ä»¶çš„æ•ˆèƒ½ï¼Œæ˜¯å¦æä¾›æ»¡æ„çš„æœåŠ¡è´¨é‡ã€‚
<ul>
<li>å¸¸ç”¨æŠ€æœ¯ï¼š<a href="https://jmeter.apache.org/" target="_blank" rel="noopener"><strong>JMeter</strong></a>ã€JMHã€‚</li>
</ul>
</li>
<li><strong>è½¯ä»¶è¾…åŠ©åŠŸèƒ½æµ‹è¯•ï¼ˆAccessibility test</strong>ï¼‰ - æµ‹è¯•è½¯ä»¶æ˜¯å¦å‘æ®‹ç–¾ç”¨æˆ·æä¾›è¶³å¤Ÿçš„è¾…åŠ©åŠŸèƒ½</li>
<li><strong>æœ¬åœ°åŒ–/å…¨çƒåŒ–æµ‹è¯•ï¼ˆLocalization/Globalization</strong>ï¼‰</li>
<li><strong>å…¼å®¹æ€§æµ‹è¯•ï¼ˆCompatibility Testï¼‰</strong></li>
<li><strong>é…ç½®æµ‹è¯•ï¼ˆConfiguration Testï¼‰</strong> - æµ‹è¯•è½¯ä»¶åœ¨å„ç§é…ç½®ä¸‹èƒ½å¦æ­£å¸¸å·¥ä½œ</li>
<li><strong>å¯ç”¨æ€§æµ‹è¯•ï¼ˆUsability Testï¼‰</strong> â€“ æµ‹è¯•è½¯ä»¶æ˜¯å¦å¥½ç”¨</li>
<li><strong>å®‰å…¨æ€§æµ‹è¯•ï¼ˆSecurity Testï¼‰</strong></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://www.cnblogs.com/TankXiao/archive/2012/02/20/2347016.html" target="_blank" rel="noopener">è½¯ä»¶æµ‹è¯• (ä¸€) è½¯ä»¶æµ‹è¯•æ–¹æ³•å¤§æ±‡æ€»</a></li>
<li><a href="https://www.xncoding.com/2018/01/07/java/jmh.html" target="_blank" rel="noopener">Javaå¾®åŸºå‡†æµ‹è¯•æ¡†æ¶JMH</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>design/architecture/system-architecture-interview</title>
    <url>/blog/design/architecture/system-architecture-interview/</url>
    <content><![CDATA[<h1 id="ç³»ç»Ÿæ¶æ„é¢è¯•"><a class="markdownIt-Anchor" href="#ç³»ç»Ÿæ¶æ„é¢è¯•"></a> ç³»ç»Ÿæ¶æ„é¢è¯•</h1>
<h2 id="å¦‚ä½•è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#å¦‚ä½•è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿ"></a> å¦‚ä½•è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿï¼Ÿ</h2>
<h3 id="ç§’æ€ç³»ç»Ÿçš„æŒ‘æˆ˜"><a class="markdownIt-Anchor" href="#ç§’æ€ç³»ç»Ÿçš„æŒ‘æˆ˜"></a> ç§’æ€ç³»ç»Ÿçš„æŒ‘æˆ˜</h3>
<p>ç§’æ€çš„æ ¸å¿ƒé—®é¢˜å°±æ˜¯<strong>æé«˜å¹¶å‘å¤„ç†</strong>ï¼Œç”±äºç³»ç»Ÿè¦åœ¨ç¬æ—¶æ‰¿å—å¹³æ—¶æ•°åå€ç”šè‡³ä¸Šç™¾å€çš„æµé‡ï¼Œè¿™å¾€å¾€è¶…å‡ºç³»ç»Ÿä¸Šé™ï¼Œå› æ­¤å¤„ç†ç§’æ€çš„<strong>æ ¸å¿ƒæ€è·¯æ˜¯é™æµå’Œç¼“å­˜</strong>ã€‚</p>
<h3 id="ç§’æ€ç³»ç»Ÿçš„è§£å†³æ€è·¯"><a class="markdownIt-Anchor" href="#ç§’æ€ç³»ç»Ÿçš„è§£å†³æ€è·¯"></a> ç§’æ€ç³»ç»Ÿçš„è§£å†³æ€è·¯</h3>
<ul>
<li>ç³»ç»Ÿä¸Šæœ‰æ‹¦æˆªæµé‡ï¼šå°½å¯èƒ½åœ¨ä¸Šæ¸¸æ‹¦æˆªå’Œé™åˆ¶è¯·æ±‚ï¼Œé™åˆ¶æµå…¥åç«¯çš„é‡ï¼Œä¿è¯åç«¯ç³»ç»Ÿæ­£å¸¸ã€‚ å› ä¸ºæ— è®ºå¤šå°‘äººå‚ä¸ç§’æ€ï¼Œå®é™…æˆäº¤å¾€å¾€æ˜¯æœ‰é™çš„ï¼Œè€Œä¸”è¿œå°äºå‚åŠ ç§’æ€çš„äººæ•°ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å‰ç«¯ç³»ç»Ÿè¿›è¡Œæ‹¦æˆªï¼Œé™åˆ¶æœ€ç»ˆæµå…¥ç³»ç»Ÿçš„è¯·æ±‚æ•°é‡ï¼Œæ¥ä¿è¯ç³»ç»Ÿæ­£å¸¸è¿›è¡Œã€‚</li>
<li>å……åˆ†åˆ©ç”¨ç¼“å­˜ï¼šè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„è¯»å¤šå†™å°‘çš„åº”ç”¨åœºæ™¯ï¼ˆä¸€è¶Ÿç«è½¦å…¶å®åªæœ‰2000å¼ ç¥¨ï¼Œ200wä¸ªäººæ¥ä¹°ï¼Œæœ€å¤š2000ä¸ªäººä¸‹å•æˆåŠŸï¼Œå…¶ä»–äººéƒ½æ˜¯æŸ¥è¯¢åº“å­˜ï¼Œå†™æ¯”ä¾‹åªæœ‰0.1%ï¼Œè¯»æ¯”ä¾‹å 99.9%ï¼‰ï¼Œéå¸¸é€‚åˆä½¿ç”¨ç¼“å­˜ã€‚</li>
</ul>
<h3 id="ç§’æ€ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#ç§’æ€ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ"></a> ç§’æ€ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ</h3>
<p>ç§’æ€ç³»ç»Ÿå…·ä½“æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰æµè§ˆå™¨ã€å®¢æˆ·ç«¯æ‹¦æˆªé‡å¤è¯·æ±‚</strong></p>
<ul>
<li>ç”¨æˆ·ç‚¹å‡»æŸ¥è¯¢æˆ–è´­ä¹°æŒ‰é’®åï¼Œç¦ç”¨æŒ‰é’®ï¼Œé¿å…ç”¨æˆ·é‡å¤æäº¤è¯·æ±‚ã€‚</li>
<li>JS ä»£ç ä¸­é™åˆ¶ç”¨æˆ·åœ¨é™å®šæ—¶é—´å†…åªå…è®¸æäº¤ä¸€æ¬¡è¯·æ±‚</li>
</ul>
<p>åŸºäºæ­¤ï¼Œå¤§éƒ¨åˆ†æµé‡å·²è¢«æ‹¦æˆªã€‚</p>
<p><strong>ï¼ˆ2ï¼‰åº”ç”¨å±‚æ‹¦æˆªè¯·æ±‚</strong></p>
<p>æµè§ˆå™¨ã€å®¢æˆ·ç«¯æ‹¦æˆªé‡å¤è¯·æ±‚åªèƒ½åº”ä»˜é€šè¿‡æµè§ˆå™¨è®¿é—®çš„ç”¨æˆ·ã€‚å¦‚æœæœ‰äººé€šè¿‡ç¨‹åºå‘é€ http è¯·æ±‚ï¼Œåˆ™æ— æ³•æ‹¦æˆªã€‚é’ˆå¯¹è¿™ç§æƒ…å†µçš„æ–¹æ¡ˆæ˜¯ï¼š</p>
<p>ä»¥é¡µé¢ç¼“å­˜çš„æ–¹å¼ï¼Œé’ˆå¯¹çŸ­æ—¶é—´å†…çš„åŒä¸€ä¸ªè®¿é—®æºï¼ˆå¦‚åŒä¸€ä¸ªIPã€åŒä¸€ä¸ª Sessionã€åŒä¸€ä¸ªç”¨æˆ· IDå¤šæ¬¡å‘é€HTTPè¯·æ±‚ï¼‰æˆ–åŒæ ·çš„æŸ¥è¯¢è¯·æ±‚ï¼ˆå¦‚å¤§é‡è¯·æ±‚éƒ½æ˜¯æŸ¥è¯¢æŸç±»å•†å“çš„åº“å­˜ï¼‰ï¼Œéƒ½è¿”å›ç›¸åŒçš„å±•ç¤ºé¡µé¢ã€‚</p>
<p>å¦‚æ­¤é™æµï¼Œåˆæœ‰å¤§éƒ¨åˆ†çš„æµé‡è¢«æ‹¦æˆª</p>
<p>ï¼ˆ3ï¼‰æœåŠ¡å±‚è¯·æ±‚æ‹¦æˆªä¸æ•°æ®ç¼“å­˜</p>
<p>åŠ å…¥æœ‰é»‘å®¢ï¼Œæ§åˆ¶äº†10wå°è‚‰é¸¡ï¼ˆå¹¶ä¸”å‡è®¾ä¹°ç¥¨ä¸éœ€è¦å®åè®¤è¯ï¼‰ï¼Œå‰é¢çš„çš„é™åˆ¶éƒ½ä¸èµ·ä½œç”¨äº†ã€‚è¿™æ—¶åº”è¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<ul>
<li>
<p>è¯»è¯·æ±‚ï¼ˆæŸ¥åº“å­˜ï¼‰ - å¯¹äºè¯»è¯·æ±‚ï¼Œç›´æ¥ä½¿ç”¨ç¼“å­˜å³å¯ï¼Œä¸€èˆ¬ç¼“å­˜æœåŠ¡å™¨å•æœºå¤„ç†æ¯ç§’10wä¸ªè¯·æ±‚åº”è¯¥æ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p>
</li>
<li>
<p>å†™è¯·æ±‚ï¼ˆä¸‹å•ï¼‰ - ç”±äºæœåŠ¡å±‚æ¸…æ¥šçš„çŸ¥é“åº“å­˜æ•°é‡ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥æ ¹æ®åº“å­˜æ•°é‡è¿›è¡Œé™æµã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰ä¸‹å•è¯·æ±‚éƒ½ä¸¢è¯¥æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œæ¯æ¬¡åªå–æœ‰é™çš„å†™è¯·æ±‚å»æ•°æ®å±‚å¤„ç†ã€‚å½“è¿™äº›å†™è¯·æ±‚å¤„ç†å®Œï¼Œæ›´æ–°ä¸€ä¸‹ç¼“å­˜ä¸­çš„åº“å­˜æ•°ï¼Œå†å»å–ä¸‹ä¸€æ‰¹å†™è¯·æ±‚ï¼Œå¦‚æœåº“å­˜æ•°ä¸å¤Ÿï¼Œåˆ™æ¶ˆæ¯é˜Ÿåˆ—çš„å†™è¯·æ±‚å…¨éƒ¨è¿”å›&quot;å·²å”®ç½„&quot;çš„ç»“æœã€‚</p>
</li>
</ul>
<blockquote>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://www.zhihu.com/question/54895548/answer/146924420" target="_blank" rel="noopener">å¦‚ä½•è®¾è®¡ç§’æ€ç³»ç»Ÿï¼Ÿ - é˜¿é‡Œäº‘äº‘æ –ç¤¾åŒºçš„å›ç­” - çŸ¥ä¹</a></li>
<li><a href="https://www.zhihu.com/question/54895548/answer/259218876" target="_blank" rel="noopener">å¦‚ä½•è®¾è®¡ç§’æ€ç³»ç»Ÿï¼Ÿ - ç½‘æ˜“äº‘çš„å›ç­” - çŸ¥ä¹</a></li>
</ul>
</blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://www.zhihu.com/question/54895548/answer/146924420" target="_blank" rel="noopener">å¦‚ä½•è®¾è®¡ç§’æ€ç³»ç»Ÿï¼Ÿ - é˜¿é‡Œäº‘äº‘æ –ç¤¾åŒºçš„å›ç­” - çŸ¥ä¹</a></li>
<li><a href="https://www.zhihu.com/question/54895548/answer/259218876" target="_blank" rel="noopener">å¦‚ä½•è®¾è®¡ç§’æ€ç³»ç»Ÿï¼Ÿ - ç½‘æ˜“äº‘çš„å›ç­” - çŸ¥ä¹</a></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>bigdata/README</title>
    <url>/blog/bigdata/README/</url>
    <content><![CDATA[<h1 id="å¤§æ•°æ®"><a class="markdownIt-Anchor" href="#å¤§æ•°æ®"></a> å¤§æ•°æ®</h1>
<h2 id="çŸ¥è¯†ç‚¹"><a class="markdownIt-Anchor" href="#çŸ¥è¯†ç‚¹"></a> ğŸ“ çŸ¥è¯†ç‚¹</h2>
<ul>
<li><a href="MapReduce.md">MapReduce</a></li>
<li><a href="HDFS.md">HDFS</a></li>
<li><a href="YARN.md">YARN</a></li>
<li><a href="hbase">HBase</a>
<ul>
<li><a href="hbase/hbase-cli.md">HBase å‘½ä»¤</a></li>
<li><a href="hbase/hbase-ops.md">HBase é…ç½®</a></li>
</ul>
</li>
</ul>
<h2 id="å­¦ä¹ èµ„æº"><a class="markdownIt-Anchor" href="#å­¦ä¹ èµ„æº"></a> ğŸ“š å­¦ä¹ èµ„æº</h2>
<h3 id="ä¹¦"><a class="markdownIt-Anchor" href="#ä¹¦"></a> ä¹¦</h3>
<p><a href="https://book.douban.com/subject/6523762/" target="_blank" rel="noopener">Hadoop æƒå¨æŒ‡å—</a></p>
<h2 id="ä¼ é€é—¨"><a class="markdownIt-Anchor" href="#ä¼ é€é—¨"></a> ğŸšª ä¼ é€é—¨</h2>
<p>| <a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">å›é¦–é </a> |</p>
]]></content>
      <tags>
        <tag>hide</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ†åº“åˆ†è¡¨åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/sharding-theory/</url>
    <content><![CDATA[<h1 id="åˆ†åº“åˆ†è¡¨åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#åˆ†åº“åˆ†è¡¨åŸºæœ¬åŸç†"></a> åˆ†åº“åˆ†è¡¨åŸºæœ¬åŸç†</h1>
<p>åˆ†ç‰‡ï¼ˆShardingï¼‰çš„åŸºæœ¬æ€æƒ³å°±è¦æŠŠä¸€ä¸ªæ•°æ®åº“åˆ‡åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼Œå­˜å‚¨åœ¨ä¸åŒçš„æ•°æ®åº“(server)ä¸Šï¼Œä»è€Œç¼“è§£å•ä¸€æ•°æ®åº“çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<h2 id="1-æ•°æ®åˆ†ç‰‡"><a class="markdownIt-Anchor" href="#1-æ•°æ®åˆ†ç‰‡"></a> 1. æ•°æ®åˆ†ç‰‡</h2>
<p>æ•°æ®åˆ†ç‰‡æŒ‡æŒ‰ç…§æŸä¸ªç»´åº¦å°†å­˜æ”¾åœ¨å•ä¸€æ•°æ®åº“ä¸­çš„æ•°æ®åˆ†æ•£åœ°å­˜æ”¾è‡³å¤šä¸ªæ•°æ®åº“æˆ–è¡¨ä¸­ä»¥è¾¾åˆ°æå‡æ€§èƒ½ç“¶é¢ˆä»¥åŠå¯ç”¨æ€§çš„æ•ˆæœã€‚ æ•°æ®åˆ†ç‰‡çš„æœ‰æ•ˆæ‰‹æ®µæ˜¯å¯¹å…³ç³»å‹æ•°æ®åº“è¿›è¡Œåˆ†åº“å’Œåˆ†è¡¨ã€‚åˆ†åº“å’Œåˆ†è¡¨å‡å¯ä»¥æœ‰æ•ˆçš„é¿å…ç”±æ•°æ®é‡è¶…è¿‡å¯æ‰¿å—é˜ˆå€¼è€Œäº§ç”Ÿçš„æŸ¥è¯¢ç“¶é¢ˆã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œåˆ†åº“è¿˜èƒ½å¤Ÿç”¨äºæœ‰æ•ˆçš„åˆ†æ•£å¯¹æ•°æ®åº“å•ç‚¹çš„è®¿é—®é‡ï¼›åˆ†è¡¨è™½ç„¶æ— æ³•ç¼“è§£æ•°æ®åº“å‹åŠ›ï¼Œä½†å´èƒ½å¤Ÿæä¾›å°½é‡å°†åˆ†å¸ƒå¼äº‹åŠ¡è½¬åŒ–ä¸ºæœ¬åœ°äº‹åŠ¡çš„å¯èƒ½ï¼Œä¸€æ—¦æ¶‰åŠåˆ°è·¨åº“çš„æ›´æ–°æ“ä½œï¼Œåˆ†å¸ƒå¼äº‹åŠ¡å¾€å¾€ä¼šä½¿é—®é¢˜å˜å¾—å¤æ‚ã€‚ ä½¿ç”¨å¤šä¸»å¤šä»çš„åˆ†ç‰‡æ–¹å¼ï¼Œå¯ä»¥æœ‰æ•ˆçš„é¿å…æ•°æ®å•ç‚¹ï¼Œä»è€Œæå‡æ•°æ®æ¶æ„çš„å¯ç”¨æ€§ã€‚</p>
<p>é€šè¿‡åˆ†åº“å’Œåˆ†è¡¨è¿›è¡Œæ•°æ®çš„æ‹†åˆ†æ¥ä½¿å¾—å„ä¸ªè¡¨çš„æ•°æ®é‡ä¿æŒåœ¨é˜ˆå€¼ä»¥ä¸‹ï¼Œä»¥åŠå¯¹æµé‡è¿›è¡Œç–å¯¼åº”å¯¹é«˜è®¿é—®é‡ï¼Œæ˜¯åº”å¯¹é«˜å¹¶å‘å’Œæµ·é‡æ•°æ®ç³»ç»Ÿçš„æœ‰æ•ˆæ‰‹æ®µã€‚ æ•°æ®åˆ†ç‰‡çš„æ‹†åˆ†æ–¹å¼åˆåˆ†ä¸ºå‚ç›´åˆ†ç‰‡å’Œæ°´å¹³åˆ†ç‰‡ã€‚</p>
<h3 id="11-å‚ç›´åˆ†ç‰‡"><a class="markdownIt-Anchor" href="#11-å‚ç›´åˆ†ç‰‡"></a> 1.1. å‚ç›´åˆ†ç‰‡</h3>
<p><strong>æŒ‰ç…§ä¸šåŠ¡æ‹†åˆ†çš„æ–¹å¼ç§°ä¸ºå‚ç›´åˆ†ç‰‡</strong>ï¼Œåˆç§°ä¸ºçºµå‘æ‹†åˆ†ï¼Œå®ƒçš„æ ¸å¿ƒç†å¿µæ˜¯ä¸“åº“ä¸“ç”¨ã€‚</p>
<p>åœ¨æ‹†åˆ†ä¹‹å‰ï¼Œä¸€ä¸ªæ•°æ®åº“ç”±å¤šä¸ªæ•°æ®è¡¨æ„æˆï¼Œæ¯ä¸ªè¡¨å¯¹åº”ç€ä¸åŒçš„ä¸šåŠ¡ã€‚è€Œæ‹†åˆ†ä¹‹åï¼Œåˆ™æ˜¯<strong>æŒ‰ç…§ä¸šåŠ¡å°†è¡¨è¿›è¡Œå½’ç±»ï¼Œåˆ†å¸ƒåˆ°ä¸åŒçš„æ•°æ®åº“ä¸­</strong>ï¼Œä»è€Œå°†å‹åŠ›åˆ†æ•£è‡³ä¸åŒçš„æ•°æ®åº“ã€‚ä¸‹å›¾å±•ç¤ºäº†æ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œå°†ç”¨æˆ·è¡¨å’Œè®¢å•è¡¨å‚ç›´åˆ†ç‰‡åˆ°ä¸åŒçš„æ•°æ®åº“çš„æ–¹æ¡ˆã€‚</p>
<p><img src="https://shardingsphere.apache.org/document/current/img/sharding/vertical_sharding.png" alt="å‚ç›´åˆ†ç‰‡" /></p>
<p>å‚ç›´åˆ†ç‰‡å¾€å¾€éœ€è¦å¯¹æ¶æ„å’Œè®¾è®¡è¿›è¡Œè°ƒæ•´ã€‚é€šå¸¸æ¥è®²ï¼Œæ˜¯æ¥ä¸åŠåº”å¯¹äº’è”ç½‘ä¸šåŠ¡éœ€æ±‚å¿«é€Ÿå˜åŒ–çš„ï¼›è€Œä¸”ï¼Œå®ƒä¹Ÿå¹¶æ— æ³•çœŸæ­£çš„è§£å†³å•ç‚¹ç“¶é¢ˆã€‚<strong>å‚ç›´æ‹†åˆ†å¯ä»¥ç¼“è§£æ•°æ®é‡å’Œè®¿é—®é‡å¸¦æ¥çš„é—®é¢˜ï¼Œä½†æ— æ³•æ ¹æ²»ã€‚å¦‚æœå‚ç›´æ‹†åˆ†ä¹‹åï¼Œè¡¨ä¸­çš„æ•°æ®é‡ä¾ç„¶è¶…è¿‡å•èŠ‚ç‚¹æ‰€èƒ½æ‰¿è½½çš„é˜ˆå€¼ï¼Œåˆ™éœ€è¦æ°´å¹³åˆ†ç‰‡æ¥è¿›ä¸€æ­¥å¤„ç†</strong>ã€‚</p>
<h3 id="12-æ°´å¹³åˆ†ç‰‡"><a class="markdownIt-Anchor" href="#12-æ°´å¹³åˆ†ç‰‡"></a> 1.2. æ°´å¹³åˆ†ç‰‡</h3>
<p>æ°´å¹³åˆ†ç‰‡åˆç§°ä¸ºæ¨ªå‘æ‹†åˆ†ã€‚ ç›¸å¯¹äºå‚ç›´åˆ†ç‰‡ï¼Œ<strong>æ°´å¹³åˆ†ç‰‡ä¸å†å°†æ•°æ®æ ¹æ®ä¸šåŠ¡é€»è¾‘åˆ†ç±»ï¼Œè€Œæ˜¯é€šè¿‡æŸä¸ªå­—æ®µï¼ˆæˆ–æŸå‡ ä¸ªå­—æ®µï¼‰ï¼Œæ ¹æ®æŸç§è§„åˆ™å°†æ•°æ®åˆ†æ•£è‡³å¤šä¸ªåº“æˆ–è¡¨ä¸­ï¼Œæ¯ä¸ªåˆ†ç‰‡ä»…åŒ…å«æ•°æ®çš„ä¸€éƒ¨åˆ†</strong>ã€‚ ä¾‹å¦‚ï¼šæ ¹æ®ä¸»é”®åˆ†ç‰‡ï¼Œå¶æ•°ä¸»é”®çš„è®°å½•æ”¾å…¥ 0 åº“ï¼ˆæˆ–è¡¨ï¼‰ï¼Œå¥‡æ•°ä¸»é”®çš„è®°å½•æ”¾å…¥ 1 åº“ï¼ˆæˆ–è¡¨ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://shardingsphere.apache.org/document/current/img/sharding/horizontal_sharding.png" alt="æ°´å¹³åˆ†ç‰‡" /></p>
<p><strong>æ°´å¹³åˆ†ç‰‡ä»ç†è®ºä¸Šçªç ´äº†å•æœºæ•°æ®é‡å¤„ç†çš„ç“¶é¢ˆï¼Œå¹¶ä¸”æ‰©å±•ç›¸å¯¹è‡ªç”±ï¼Œæ˜¯åˆ†åº“åˆ†è¡¨çš„æ ‡å‡†è§£å†³æ–¹æ¡ˆ</strong>ã€‚</p>
<h2 id="2-åˆ†åº“åˆ†è¡¨çš„é—®é¢˜"><a class="markdownIt-Anchor" href="#2-åˆ†åº“åˆ†è¡¨çš„é—®é¢˜"></a> 2. åˆ†åº“åˆ†è¡¨çš„é—®é¢˜</h2>
<h3 id="21-äº‹åŠ¡é—®é¢˜"><a class="markdownIt-Anchor" href="#21-äº‹åŠ¡é—®é¢˜"></a> 2.1. äº‹åŠ¡é—®é¢˜</h3>
<p>è§£å†³äº‹åŠ¡é—®é¢˜ç›®å‰æœ‰ä¸¤ç§å¯è¡Œçš„æ–¹æ¡ˆï¼šåˆ†å¸ƒå¼äº‹åŠ¡å’Œé€šè¿‡åº”ç”¨ç¨‹åºä¸æ•°æ®åº“å…±åŒæ§åˆ¶å®ç°äº‹åŠ¡ä¸‹é¢å¯¹ä¸¤å¥—æ–¹æ¡ˆè¿›è¡Œä¸€ä¸ªç®€å•çš„å¯¹æ¯”ã€‚</p>
<ul>
<li>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡
<ul>
<li>ä¼˜ç‚¹ï¼šäº¤ç”±æ•°æ®åº“ç®¡ç†ï¼Œç®€å•æœ‰æ•ˆ</li>
<li>ç¼ºç‚¹ï¼šæ€§èƒ½ä»£ä»·é«˜ï¼Œç‰¹åˆ«æ˜¯ sharding è¶Šæ¥è¶Šå¤šæ—¶</li>
</ul>
</li>
<li>æ–¹æ¡ˆäºŒï¼šç”±åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“å…±åŒæ§åˆ¶
<ul>
<li>åŸç†ï¼šå°†ä¸€ä¸ªè·¨å¤šä¸ªæ•°æ®åº“çš„åˆ†å¸ƒå¼äº‹åŠ¡åˆ†æ‹†æˆå¤šä¸ªä»…å¤„äºå•ä¸ªæ•°æ®åº“ä¸Šé¢çš„å°äº‹åŠ¡ï¼Œå¹¶é€šè¿‡åº”ç”¨ç¨‹åºæ¥æ€»æ§å„ä¸ªå°äº‹åŠ¡ã€‚</li>
<li>ä¼˜ç‚¹ï¼šæ€§èƒ½ä¸Šæœ‰ä¼˜åŠ¿</li>
<li>ç¼ºç‚¹ï¼šéœ€è¦åº”ç”¨ç¨‹åºåœ¨äº‹åŠ¡æ§åˆ¶ä¸Šåšçµæ´»è®¾è®¡ã€‚å¦‚æœä½¿ç”¨ äº†<a href="http://lib.csdn.net/base/javaee" target="_blank" rel="noopener">spring</a>çš„äº‹åŠ¡ç®¡ç†ï¼Œæ”¹åŠ¨èµ·æ¥ä¼šé¢ä¸´ä¸€å®šçš„å›°éš¾ã€‚</li>
</ul>
</li>
</ul>
<p>è·¨åº“äº‹åŠ¡ä¹Ÿæ˜¯åˆ†å¸ƒå¼çš„æ•°æ®åº“é›†ç¾¤è¦é¢å¯¹çš„æ£˜æ‰‹äº‹æƒ…ã€‚ åˆç†é‡‡ç”¨åˆ†è¡¨ï¼Œå¯ä»¥åœ¨é™ä½å•è¡¨æ•°æ®é‡çš„æƒ…å†µä¸‹ï¼Œå°½é‡ä½¿ç”¨æœ¬åœ°äº‹åŠ¡ï¼Œå–„äºä½¿ç”¨åŒåº“ä¸åŒè¡¨å¯æœ‰æ•ˆé¿å…åˆ†å¸ƒå¼äº‹åŠ¡å¸¦æ¥çš„éº»çƒ¦ã€‚åœ¨ä¸èƒ½é¿å…è·¨åº“äº‹åŠ¡çš„åœºæ™¯ï¼Œæœ‰äº›ä¸šåŠ¡ä»ç„¶éœ€è¦ä¿æŒäº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚ è€ŒåŸºäº XA çš„åˆ†å¸ƒå¼äº‹åŠ¡ç”±äºåœ¨å¹¶å‘åº¦é«˜çš„åœºæ™¯ä¸­æ€§èƒ½æ— æ³•æ»¡è¶³éœ€è¦ï¼Œå¹¶æœªè¢«äº’è”ç½‘å·¨å¤´å¤§è§„æ¨¡ä½¿ç”¨ï¼Œä»–ä»¬å¤§å¤šé‡‡ç”¨æœ€ç»ˆä¸€è‡´æ€§çš„æŸ”æ€§äº‹åŠ¡ä»£æ›¿å¼ºä¸€è‡´äº‹åŠ¡ã€‚</p>
<h3 id="22-è·¨èŠ‚ç‚¹-join-çš„é—®é¢˜"><a class="markdownIt-Anchor" href="#22-è·¨èŠ‚ç‚¹-join-çš„é—®é¢˜"></a> 2.2. è·¨èŠ‚ç‚¹ Join çš„é—®é¢˜</h3>
<p>åªè¦æ˜¯è¿›è¡Œåˆ‡åˆ†ï¼Œè·¨èŠ‚ç‚¹ Join çš„é—®é¢˜æ˜¯ä¸å¯é¿å…çš„ã€‚ä½†æ˜¯è‰¯å¥½çš„è®¾è®¡å’Œåˆ‡åˆ†å´å¯ä»¥å‡å°‘æ­¤ç±»æƒ…å†µçš„å‘ç”Ÿã€‚è§£å†³è¿™ä¸€é—®é¢˜çš„æ™®éåšæ³•æ˜¯åˆ†ä¸¤æ¬¡æŸ¥è¯¢å®ç°ã€‚åœ¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢çš„ç»“æœé›†ä¸­æ‰¾å‡ºå…³è”æ•°æ®çš„ idï¼Œæ ¹æ®è¿™äº› id å‘èµ·ç¬¬äºŒæ¬¡è¯·æ±‚å¾—åˆ°å…³è”æ•°æ®ã€‚</p>
<h3 id="23-è·¨èŠ‚ç‚¹çš„-countorder-bygroup-by-ä»¥åŠèšåˆå‡½æ•°é—®é¢˜"><a class="markdownIt-Anchor" href="#23-è·¨èŠ‚ç‚¹çš„-countorder-bygroup-by-ä»¥åŠèšåˆå‡½æ•°é—®é¢˜"></a> 2.3. è·¨èŠ‚ç‚¹çš„ count,order by,group by ä»¥åŠèšåˆå‡½æ•°é—®é¢˜</h3>
<p>è¿™äº›æ˜¯ä¸€ç±»é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬éƒ½éœ€è¦åŸºäºå…¨éƒ¨æ•°æ®é›†åˆè¿›è¡Œè®¡ç®—ã€‚å¤šæ•°çš„ä»£ç†éƒ½ä¸ä¼šè‡ªåŠ¨å¤„ç†åˆå¹¶å·¥ä½œã€‚è§£å†³æ–¹æ¡ˆï¼šä¸è§£å†³è·¨èŠ‚ç‚¹ join é—®é¢˜çš„ç±»ä¼¼ï¼Œåˆ†åˆ«åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šå¾—åˆ°ç»“æœååœ¨åº”ç”¨ç¨‹åºç«¯è¿›è¡Œåˆå¹¶ã€‚å’Œ join ä¸åŒçš„æ˜¯æ¯ä¸ªç»“ç‚¹çš„æŸ¥è¯¢å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™å®ƒçš„é€Ÿåº¦è¦æ¯”å•ä¸€å¤§è¡¨å¿«å¾ˆå¤šã€‚ä½†å¦‚æœç»“æœé›†å¾ˆå¤§ï¼Œå¯¹åº”ç”¨ç¨‹åºå†…å­˜çš„æ¶ˆè€—æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</p>
<h3 id="24-æ•°æ®è¿ç§»å®¹é‡è§„åˆ’æ‰©å®¹ç­‰é—®é¢˜"><a class="markdownIt-Anchor" href="#24-æ•°æ®è¿ç§»å®¹é‡è§„åˆ’æ‰©å®¹ç­‰é—®é¢˜"></a> 2.4. æ•°æ®è¿ç§»ï¼Œå®¹é‡è§„åˆ’ï¼Œæ‰©å®¹ç­‰é—®é¢˜</h3>
<p>æ¥è‡ªæ·˜å®ç»¼åˆä¸šåŠ¡å¹³å°å›¢é˜Ÿï¼Œå®ƒåˆ©ç”¨å¯¹ 2 çš„å€æ•°å–ä½™å…·æœ‰å‘å‰å…¼å®¹çš„ç‰¹æ€§ï¼ˆå¦‚å¯¹ 4 å–ä½™å¾— 1 çš„æ•°å¯¹ 2 å–ä½™ä¹Ÿæ˜¯ 1ï¼‰æ¥åˆ†é…æ•°æ®ï¼Œé¿å…äº†<strong>è¡Œçº§åˆ«çš„æ•°æ®è¿ç§»</strong>ï¼Œä½†æ˜¯ä¾ç„¶éœ€è¦è¿›è¡Œ<strong>è¡¨çº§åˆ«çš„è¿ç§»</strong>ï¼ŒåŒæ—¶å¯¹æ‰©å®¹è§„æ¨¡å’Œåˆ†è¡¨æ•°é‡éƒ½æœ‰é™åˆ¶ã€‚æ€»å¾—æ¥è¯´ï¼Œè¿™äº›æ–¹æ¡ˆéƒ½ä¸æ˜¯ååˆ†çš„ç†æƒ³ï¼Œå¤šå¤šå°‘å°‘éƒ½å­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼Œè¿™ä¹Ÿä»ä¸€ä¸ªä¾§é¢åæ˜ å‡ºäº† Sharding æ‰©å®¹çš„éš¾åº¦ã€‚</p>
<h3 id="25-id-é—®é¢˜"><a class="markdownIt-Anchor" href="#25-id-é—®é¢˜"></a> 2.5. ID é—®é¢˜</h3>
<p>ä¸€æ—¦æ•°æ®åº“è¢«åˆ‡åˆ†åˆ°å¤šä¸ªç‰©ç†ç»“ç‚¹ä¸Šï¼Œæˆ‘ä»¬å°†ä¸èƒ½å†ä¾èµ–æ•°æ®åº“è‡ªèº«çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ã€‚ä¸€æ–¹é¢ï¼ŒæŸä¸ªåˆ†åŒºæ•°æ®åº“è‡ªç”Ÿæˆçš„ ID æ— æ³•ä¿è¯åœ¨å…¨å±€ä¸Šæ˜¯å”¯ä¸€çš„ï¼›å¦ä¸€æ–¹é¢ï¼Œåº”ç”¨ç¨‹åºåœ¨æ’å…¥æ•°æ®ä¹‹å‰éœ€è¦å…ˆè·å¾— ID,ä»¥ä¾¿è¿›è¡Œ SQL è·¯ç”±. ä¸€äº›å¸¸è§çš„ä¸»é”®ç”Ÿæˆç­–ç•¥</p>
<h4 id="251-uuid"><a class="markdownIt-Anchor" href="#251-uuid"></a> 2.5.1. UUID</h4>
<p>ä½¿ç”¨ UUID ä½œä¸»é”®æ˜¯æœ€ç®€å•çš„æ–¹æ¡ˆï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿæ˜¯éå¸¸æ˜æ˜¾çš„ã€‚ç”±äº UUID éå¸¸çš„é•¿ï¼Œé™¤å ç”¨å¤§é‡å­˜å‚¨ç©ºé—´å¤–ï¼Œæœ€ä¸»è¦çš„é—®é¢˜æ˜¯åœ¨ç´¢å¼•ä¸Šï¼Œåœ¨å»ºç«‹ç´¢å¼•å’ŒåŸºäºç´¢å¼•è¿›è¡ŒæŸ¥è¯¢æ—¶éƒ½å­˜åœ¨æ€§èƒ½é—®é¢˜ã€‚</p>
<h4 id="252-ç»“åˆæ•°æ®åº“ç»´æŠ¤ä¸€ä¸ª-sequence-è¡¨"><a class="markdownIt-Anchor" href="#252-ç»“åˆæ•°æ®åº“ç»´æŠ¤ä¸€ä¸ª-sequence-è¡¨"></a> 2.5.2. ç»“åˆæ•°æ®åº“ç»´æŠ¤ä¸€ä¸ª Sequence è¡¨</h4>
<p>æ­¤æ–¹æ¡ˆçš„æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨æ•°æ®åº“ä¸­å»ºç«‹ä¸€ä¸ª Sequence è¡¨ï¼Œè¡¨çš„ç»“æ„ç±»ä¼¼äºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`SEQUENCE`</span> (</span><br><span class="line">    <span class="string">`table_name`</span> <span class="built_in">varchar</span>(<span class="number">18</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`nextid`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span> (<span class="string">`table_name`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span></span><br></pre></td></tr></table></figure>
<p>æ¯å½“éœ€è¦ä¸ºæŸä¸ªè¡¨çš„æ–°çºªå½•ç”Ÿæˆ ID æ—¶å°±ä» Sequence è¡¨ä¸­å–å‡ºå¯¹åº”è¡¨çš„ nextid,å¹¶å°† nextid çš„å€¼åŠ  1 åæ›´æ–°åˆ°æ•°æ®åº“ä¸­ä»¥å¤‡ä¸‹æ¬¡ä½¿ç”¨ã€‚æ­¤æ–¹æ¡ˆä¹Ÿè¾ƒç®€å•ï¼Œä½†ç¼ºç‚¹åŒæ ·æ˜æ˜¾ï¼šç”±äºæ‰€æœ‰æ’å…¥ä»»ä½•éƒ½éœ€è¦è®¿é—®è¯¥è¡¨ï¼Œè¯¥è¡¨å¾ˆå®¹æ˜“æˆä¸ºç³»ç»Ÿæ€§èƒ½ç“¶é¢ˆï¼ŒåŒæ—¶å®ƒä¹Ÿå­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œä¸€æ—¦è¯¥è¡¨æ•°æ®åº“å¤±æ•ˆï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºå°†æ— æ³•å·¥ä½œã€‚æœ‰äººæå‡ºä½¿ç”¨ Master-Slave è¿›è¡Œä¸»ä»åŒæ­¥ï¼Œä½†è¿™ä¹Ÿåªèƒ½è§£å†³å•ç‚¹é—®é¢˜ï¼Œå¹¶ä¸èƒ½è§£å†³è¯»å†™æ¯”ä¸º 1:1 çš„è®¿é—®å‹åŠ›é—®é¢˜ã€‚</p>
<h4 id="253-twitter-çš„åˆ†å¸ƒå¼è‡ªå¢-id-ç®—æ³•-snowflake"><a class="markdownIt-Anchor" href="#253-twitter-çš„åˆ†å¸ƒå¼è‡ªå¢-id-ç®—æ³•-snowflake"></a> 2.5.3. <a href="http://blog.sina.com.cn/s/blog_6b7c2e660102vbi2.html" target="_blank" rel="noopener">Twitter çš„åˆ†å¸ƒå¼è‡ªå¢ ID ç®—æ³• Snowflake</a></h4>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œéœ€è¦ç”Ÿæˆå…¨å±€ UID çš„åœºåˆè¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œtwitter çš„ snowflake è§£å†³äº†è¿™ç§éœ€æ±‚ï¼Œå®ç°ä¹Ÿè¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œé™¤å»é…ç½®ä¿¡æ¯ï¼Œæ ¸å¿ƒä»£ç å°±æ˜¯æ¯«ç§’çº§æ—¶é—´ 41 ä½ æœºå™¨ ID 10 ä½ æ¯«ç§’å†…åºåˆ— 12 ä½ã€‚</p>
<ul>
<li>10â€”0000000000 0000000000 0000000000 0000000000 0 â€” 00000 â€”00000 â€”000000000000 åœ¨ä¸Šé¢çš„å­—ç¬¦ä¸²ä¸­ï¼Œç¬¬ä¸€ä½ä¸ºæœªä½¿ç”¨ï¼ˆå®é™…ä¸Šä¹Ÿå¯ä½œä¸º long çš„ç¬¦å·ä½ï¼‰ï¼Œæ¥ä¸‹æ¥çš„ 41 ä½ä¸ºæ¯«ç§’çº§æ—¶é—´ï¼Œç„¶å 5 ä½ datacenter æ ‡è¯†ä½ï¼Œ5 ä½æœºå™¨ IDï¼ˆå¹¶ä¸ç®—æ ‡è¯†ç¬¦ï¼Œå®é™…æ˜¯ä¸ºçº¿ç¨‹æ ‡è¯†ï¼‰ï¼Œç„¶å 12 ä½è¯¥æ¯«ç§’å†…çš„å½“å‰æ¯«ç§’å†…çš„è®¡æ•°ï¼ŒåŠ èµ·æ¥åˆšå¥½ 64 ä½ï¼Œä¸ºä¸€ä¸ª Long å‹ã€‚</li>
</ul>
<p>è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œæ•´ä½“ä¸ŠæŒ‰ç…§æ—¶é—´è‡ªå¢æ’åºï¼Œå¹¶ä¸”æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿå†…ä¸ä¼šäº§ç”Ÿ ID ç¢°æ’ï¼ˆç”± datacenter å’Œæœºå™¨ ID ä½œåŒºåˆ†ï¼‰ï¼Œå¹¶ä¸”æ•ˆç‡è¾ƒé«˜ï¼Œç»æµ‹è¯•ï¼Œsnowflake æ¯ç§’èƒ½å¤Ÿäº§ç”Ÿ 26 ä¸‡ ID å·¦å³ï¼Œå®Œå…¨æ»¡è¶³éœ€è¦ã€‚</p>
<h3 id="26-è·¨åˆ†ç‰‡çš„æ’åºåˆ†é¡µ"><a class="markdownIt-Anchor" href="#26-è·¨åˆ†ç‰‡çš„æ’åºåˆ†é¡µ"></a> 2.6. è·¨åˆ†ç‰‡çš„æ’åºåˆ†é¡µ</h3>
<p>ä¸€èˆ¬æ¥è®²ï¼Œåˆ†é¡µæ—¶éœ€è¦æŒ‰ç…§æŒ‡å®šå­—æ®µè¿›è¡Œæ’åºã€‚å½“æ’åºå­—æ®µå°±æ˜¯åˆ†ç‰‡å­—æ®µçš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡åˆ†ç‰‡è§„åˆ™å¯ä»¥æ¯”è¾ƒå®¹æ˜“å®šä½åˆ°æŒ‡å®šçš„åˆ†ç‰‡ï¼Œè€Œå½“æ’åºå­—æ®µéåˆ†ç‰‡å­—æ®µçš„æ—¶å€™ï¼Œæƒ…å†µå°±ä¼šå˜å¾—æ¯”è¾ƒå¤æ‚äº†ã€‚ä¸ºäº†æœ€ç»ˆç»“æœçš„å‡†ç¡®æ€§ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„åˆ†ç‰‡èŠ‚ç‚¹ä¸­å°†æ•°æ®è¿›è¡Œæ’åºå¹¶è¿”å›ï¼Œå¹¶å°†ä¸åŒåˆ†ç‰‡è¿”å›çš„ç»“æœé›†è¿›è¡Œæ±‡æ€»å’Œå†æ¬¡æ’åºï¼Œæœ€åå†è¿”å›ç»™ç”¨æˆ·ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/3710706-925381b9a478c8df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/640/format/webp" alt="img" /></p>
<p>ä¸Šé¢å›¾ä¸­æ‰€æè¿°çš„åªæ˜¯æœ€ç®€å•çš„ä¸€ç§æƒ…å†µï¼ˆå–ç¬¬ä¸€é¡µæ•°æ®ï¼‰ï¼Œçœ‹èµ·æ¥å¯¹æ€§èƒ½çš„å½±å“å¹¶ä¸å¤§ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³å–å‡ºç¬¬ 10 é¡µæ•°æ®ï¼Œæƒ…å†µåˆå°†å˜å¾—å¤æ‚å¾ˆå¤šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/3710706-9a7cfbdb95bb9b70.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/640/format/webp" alt="img" /></p>
<p>æœ‰äº›è¯»è€…å¯èƒ½å¹¶ä¸å¤ªç†è§£ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åƒè·å–ç¬¬ä¸€é¡µæ•°æ®é‚£æ ·ç®€å•å¤„ç†ï¼ˆæ’åºå–å‡ºå‰ 10 æ¡å†åˆå¹¶ã€æ’åºï¼‰ã€‚å…¶å®å¹¶ä¸éš¾ç†è§£ï¼Œå› ä¸ºå„åˆ†ç‰‡èŠ‚ç‚¹ä¸­çš„æ•°æ®å¯èƒ½æ˜¯éšæœºçš„ï¼Œä¸ºäº†æ’åºçš„å‡†ç¡®æ€§ï¼Œå¿…é¡»æŠŠæ‰€æœ‰åˆ†ç‰‡èŠ‚ç‚¹çš„å‰ N é¡µæ•°æ®éƒ½æ’åºå¥½ååšåˆå¹¶ï¼Œæœ€åå†è¿›è¡Œæ•´ä½“çš„æ’åºã€‚å¾ˆæ˜¾ç„¶ï¼Œè¿™æ ·çš„æ“ä½œæ˜¯æ¯”è¾ƒæ¶ˆè€—èµ„æºçš„ï¼Œç”¨æˆ·è¶Šå¾€åç¿»é¡µï¼Œç³»ç»Ÿæ€§èƒ½å°†ä¼šè¶Šå·®ã€‚</p>
<p>é‚£å¦‚ä½•è§£å†³åˆ†åº“æƒ…å†µä¸‹çš„åˆ†é¡µé—®é¢˜å‘¢ï¼Ÿæœ‰ä»¥ä¸‹å‡ ç§åŠæ³•ï¼š</p>
<p>å¦‚æœæ˜¯åœ¨å‰å°åº”ç”¨æä¾›åˆ†é¡µï¼Œåˆ™é™å®šç”¨æˆ·åªèƒ½çœ‹å‰é¢ n é¡µï¼Œè¿™ä¸ªé™åˆ¶åœ¨ä¸šåŠ¡ä¸Šä¹Ÿæ˜¯åˆç†çš„ï¼Œä¸€èˆ¬çœ‹åé¢çš„åˆ†é¡µæ„ä¹‰ä¸å¤§ï¼ˆå¦‚æœä¸€å®šè¦çœ‹ï¼Œå¯ä»¥è¦æ±‚ç”¨æˆ·ç¼©å°èŒƒå›´é‡æ–°æŸ¥è¯¢ï¼‰ã€‚</p>
<p>å¦‚æœæ˜¯åå°æ‰¹å¤„ç†ä»»åŠ¡è¦æ±‚åˆ†æ‰¹è·å–æ•°æ®ï¼Œåˆ™å¯ä»¥åŠ å¤§ page sizeï¼Œæ¯”å¦‚æ¯æ¬¡è·å– 5000 æ¡è®°å½•ï¼Œæœ‰æ•ˆå‡å°‘åˆ†é¡µæ•°ï¼ˆå½“ç„¶ç¦»çº¿è®¿é—®ä¸€èˆ¬èµ°å¤‡åº“ï¼Œé¿å…å†²å‡»ä¸»åº“ï¼‰ã€‚</p>
<p>åˆ†åº“è®¾è®¡æ—¶ï¼Œä¸€èˆ¬è¿˜æœ‰é…å¥—å¤§æ•°æ®å¹³å°æ±‡æ€»æ‰€æœ‰åˆ†åº“çš„è®°å½•ï¼Œæœ‰äº›åˆ†é¡µæŸ¥è¯¢å¯ä»¥è€ƒè™‘èµ°å¤§æ•°æ®å¹³å°ã€‚</p>
<h3 id="27-åˆ†åº“ç­–ç•¥"><a class="markdownIt-Anchor" href="#27-åˆ†åº“ç­–ç•¥"></a> 2.7. åˆ†åº“ç­–ç•¥</h3>
<ul>
<li>æ ¹æ®æ•°å€¼èŒƒå›´ï¼Œæ¯”å¦‚ç”¨æˆ· Id ä¸º 1-9999 çš„è®°å½•åˆ†åˆ°ç¬¬ä¸€ä¸ªåº“ï¼Œ10000-20000 çš„åˆ†åˆ°ç¬¬äºŒä¸ªåº“ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li>
<li>æ ¹æ®æ•°å€¼å–æ¨¡ï¼Œæ¯”å¦‚ç”¨æˆ· Id mod nï¼Œä½™æ•°ä¸º 0 çš„è®°å½•æ”¾åˆ°ç¬¬ä¸€ä¸ªåº“ï¼Œä½™æ•°ä¸º 1 çš„æ”¾åˆ°ç¬¬äºŒä¸ªåº“ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li>
</ul>
<p>ä¼˜åŠ£æ¯”è¾ƒï¼šè¯„ä»·æŒ‡æ ‡æŒ‰ç…§èŒƒå›´åˆ†åº“æŒ‰ç…§ Mod åˆ†åº“åº“æ•°é‡å‰æœŸæ•°ç›®æ¯”è¾ƒå°ï¼Œå¯ä»¥éšç”¨æˆ·/ä¸šåŠ¡æŒ‰éœ€å¢é•¿å‰æœŸå³æ ¹æ® mode å› å­ç¡®å®šåº“æ•°é‡ï¼Œæ•°ç›®ä¸€èˆ¬æ¯”è¾ƒå¤§è®¿é—®æ€§èƒ½å‰æœŸåº“æ•°é‡å°ï¼Œå…¨åº“æŸ¥è¯¢æ¶ˆè€—èµ„æºå°‘ï¼Œå•åº“æŸ¥è¯¢æ€§èƒ½ç•¥å·®å‰æœŸåº“æ•°é‡å¤§ï¼Œå…¨åº“æŸ¥è¯¢æ¶ˆè€—èµ„æºå¤šï¼Œå•åº“æŸ¥è¯¢æ€§èƒ½ç•¥å¥½è°ƒæ•´åº“æ•°é‡æ¯”è¾ƒå®¹æ˜“ï¼Œä¸€èˆ¬åªéœ€ä¸ºæ–°ç”¨æˆ·å¢åŠ åº“ï¼Œè€åº“æ‹†åˆ†ä¹Ÿåªå½±å“å•ä¸ªåº“å›°éš¾ï¼Œæ”¹å˜ mod å› å­å¯¼è‡´æ•°æ®åœ¨æ‰€æœ‰åº“ä¹‹é—´è¿ç§»æ•°æ®çƒ­ç‚¹æ–°æ—§ç”¨æˆ·è´­ç‰©é¢‘ç‡æœ‰å·®å¼‚ï¼Œæœ‰æ•°æ®çƒ­ç‚¹é—®é¢˜æ–°æ—§ç”¨æˆ·å‡åŒ€åˆ°åˆ†å¸ƒåˆ°å„ä¸ªåº“ï¼Œæ— çƒ­ç‚¹å®è·µä¸­ï¼Œä¸ºäº†å¤„ç†ç®€å•ï¼Œé€‰æ‹© mod åˆ†åº“çš„æ¯”è¾ƒå¤šã€‚åŒæ—¶äºŒæ¬¡åˆ†åº“æ—¶ï¼Œä¸ºäº†æ•°æ®è¿ç§»æ–¹ä¾¿ï¼Œä¸€èˆ¬æ˜¯æŒ‰å€æ•°å¢åŠ ï¼Œæ¯”å¦‚åˆå§‹ 4 ä¸ªåº“ï¼ŒäºŒæ¬¡åˆ†è£‚ä¸º 8 ä¸ªï¼Œå† 16 ä¸ªã€‚è¿™æ ·å¯¹äºæŸä¸ªåº“çš„æ•°æ®ï¼Œä¸€åŠæ•°æ®ç§»åˆ°æ–°åº“ï¼Œå‰©ä½™ä¸åŠ¨ï¼Œå¯¹æ¯”æ¯æ¬¡åªå¢åŠ ä¸€ä¸ªåº“ï¼Œæ‰€æœ‰æ•°æ®éƒ½è¦å¤§è§„æ¨¡å˜åŠ¨ã€‚è¡¥å……ä¸‹ï¼Œmod åˆ†åº“ä¸€èˆ¬æ¯ä¸ªåº“è®°å½•æ•°æ¯”è¾ƒå‡åŒ€ï¼Œä½†ä¹Ÿæœ‰äº›æ•°æ®åº“ï¼Œå­˜åœ¨è¶…çº§ Idï¼Œè¿™äº› Id çš„è®°å½•è¿œè¿œè¶…è¿‡å…¶ä»– Idï¼Œæ¯”å¦‚åœ¨å¹¿å‘Šåœºæ™¯ä¸‹ï¼ŒæŸä¸ªå¤§å¹¿å‘Šä¸»çš„å¹¿å‘Šæ•°å¯èƒ½å æ€»ä½“å¾ˆå¤§æ¯”ä¾‹ã€‚å¦‚æœæŒ‰ç…§å¹¿å‘Šä¸» Id å–æ¨¡åˆ†åº“ï¼ŒæŸäº›åº“çš„è®°å½•æ•°ä¼šç‰¹åˆ«å¤šï¼Œå¯¹äºè¿™äº›è¶…çº§ Idï¼Œéœ€è¦æä¾›å•ç‹¬åº“æ¥å­˜å‚¨è®°å½•ã€‚</p>
<h3 id="28-åˆ†åº“æ•°é‡"><a class="markdownIt-Anchor" href="#28-åˆ†åº“æ•°é‡"></a> 2.8. åˆ†åº“æ•°é‡</h3>
<p>åˆ†åº“æ•°é‡é¦–å…ˆå’Œå•åº“èƒ½å¤„ç†çš„è®°å½•æ•°æœ‰å…³ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒMysql å•åº“è¶…è¿‡ 5000 ä¸‡æ¡è®°å½•ï¼ŒOracle å•åº“è¶…è¿‡ 1 äº¿æ¡è®°å½•ï¼ŒDB å‹åŠ›å°±å¾ˆå¤§(å½“ç„¶å¤„ç†èƒ½åŠ›å’Œå­—æ®µæ•°é‡/è®¿é—®æ¨¡å¼/è®°å½•é•¿åº¦æœ‰è¿›ä¸€æ­¥å…³ç³»)ã€‚</p>
<p>åœ¨æ»¡è¶³ä¸Šè¿°å‰æä¸‹ï¼Œå¦‚æœåˆ†åº“æ•°é‡å°‘ï¼Œè¾¾ä¸åˆ°åˆ†æ•£å­˜å‚¨å’Œå‡è½» DB æ€§èƒ½å‹åŠ›çš„ç›®çš„ï¼›å¦‚æœåˆ†åº“çš„æ•°é‡å¤šï¼Œå¥½å¤„æ˜¯æ¯ä¸ªåº“è®°å½•å°‘ï¼Œå•åº“è®¿é—®æ€§èƒ½å¥½ï¼Œä½†å¯¹äºè·¨å¤šä¸ªåº“çš„è®¿é—®ï¼Œåº”ç”¨ç¨‹åºéœ€è¦è®¿é—®å¤šä¸ªåº“ï¼Œå¦‚æœæ˜¯å¹¶å‘æ¨¡å¼ï¼Œè¦æ¶ˆè€—å®è´µçš„çº¿ç¨‹èµ„æºï¼›å¦‚æœæ˜¯ä¸²è¡Œæ¨¡å¼ï¼Œæ‰§è¡Œæ—¶é—´ä¼šæ€¥å‰§å¢åŠ ã€‚</p>
<p>æœ€ååˆ†åº“æ•°é‡è¿˜ç›´æ¥å½±å“ç¡¬ä»¶çš„æŠ•å…¥ï¼Œä¸€èˆ¬æ¯ä¸ªåˆ†åº“è·‘åœ¨å•ç‹¬ç‰©ç†æœºä¸Šï¼Œå¤šä¸€ä¸ªåº“æ„å‘³å¤šä¸€å°è®¾å¤‡ã€‚æ‰€ä»¥å…·ä½“åˆ†å¤šå°‘ä¸ªåº“ï¼Œè¦ç»¼åˆè¯„ä¼°ï¼Œä¸€èˆ¬åˆæ¬¡åˆ†åº“å»ºè®®åˆ† 4-8 ä¸ªåº“ã€‚</p>
<h2 id="3-è¯»å†™åˆ†ç¦»"><a class="markdownIt-Anchor" href="#3-è¯»å†™åˆ†ç¦»"></a> 3. è¯»å†™åˆ†ç¦»</h2>
<p>é¢å¯¹æ—¥ç›Šå¢åŠ çš„ç³»ç»Ÿè®¿é—®é‡ï¼Œæ•°æ®åº“çš„ååé‡é¢ä¸´ç€å·¨å¤§ç“¶é¢ˆã€‚ å¯¹äºåŒä¸€æ—¶åˆ»æœ‰å¤§é‡å¹¶å‘è¯»æ“ä½œå’Œè¾ƒå°‘å†™æ“ä½œç±»å‹çš„åº”ç”¨ç³»ç»Ÿæ¥è¯´ï¼Œå°†æ•°æ®åº“æ‹†åˆ†ä¸ºä¸»åº“å’Œä»åº“ï¼Œä¸»åº“è´Ÿè´£å¤„ç†äº‹åŠ¡æ€§çš„å¢åˆ æ”¹æ“ä½œï¼Œä»åº“è´Ÿè´£å¤„ç†æŸ¥è¯¢æ“ä½œï¼Œèƒ½å¤Ÿæœ‰æ•ˆçš„é¿å…ç”±æ•°æ®æ›´æ–°å¯¼è‡´çš„è¡Œé”ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿçš„æŸ¥è¯¢æ€§èƒ½å¾—åˆ°æå¤§çš„æ”¹å–„ã€‚</p>
<p>é€šè¿‡ä¸€ä¸»å¤šä»çš„é…ç½®æ–¹å¼ï¼Œå¯ä»¥å°†æŸ¥è¯¢è¯·æ±‚å‡åŒ€çš„åˆ†æ•£åˆ°å¤šä¸ªæ•°æ®å‰¯æœ¬ï¼Œèƒ½å¤Ÿè¿›ä¸€æ­¥çš„æå‡ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚ ä½¿ç”¨å¤šä¸»å¤šä»çš„æ–¹å¼ï¼Œä¸ä½†èƒ½å¤Ÿæå‡ç³»ç»Ÿçš„ååé‡ï¼Œè¿˜èƒ½å¤Ÿæå‡ç³»ç»Ÿçš„å¯ç”¨æ€§ï¼Œå¯ä»¥è¾¾åˆ°åœ¨ä»»ä½•ä¸€ä¸ªæ•°æ®åº“å®•æœºï¼Œç”šè‡³ç£ç›˜ç‰©ç†æŸåçš„æƒ…å†µä¸‹ä»ç„¶ä¸å½±å“ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚</p>
<p>ä¸å°†æ•°æ®æ ¹æ®åˆ†ç‰‡é”®æ‰“æ•£è‡³å„ä¸ªæ•°æ®èŠ‚ç‚¹çš„æ°´å¹³åˆ†ç‰‡ä¸åŒï¼Œè¯»å†™åˆ†ç¦»åˆ™æ˜¯æ ¹æ® SQL è¯­ä¹‰çš„åˆ†æï¼Œå°†è¯»æ“ä½œå’Œå†™æ“ä½œåˆ†åˆ«è·¯ç”±è‡³ä¸»åº“ä¸ä»åº“ã€‚</p>
<p><img src="https://shardingsphere.apache.org/document/current/img/read-write-split/read-write-split.png" alt="è¯»å†™åˆ†ç¦»" /></p>
<p>è¯»å†™åˆ†ç¦»çš„æ•°æ®èŠ‚ç‚¹ä¸­çš„æ•°æ®å†…å®¹æ˜¯ä¸€è‡´çš„ï¼Œè€Œæ°´å¹³åˆ†ç‰‡çš„æ¯ä¸ªæ•°æ®èŠ‚ç‚¹çš„æ•°æ®å†…å®¹å´å¹¶ä¸ç›¸åŒã€‚å°†æ°´å¹³åˆ†ç‰‡å’Œè¯»å†™åˆ†ç¦»è”åˆä½¿ç”¨ï¼Œèƒ½å¤Ÿæ›´åŠ æœ‰æ•ˆçš„æå‡ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<h3 id="31-æŒ‘æˆ˜"><a class="markdownIt-Anchor" href="#31-æŒ‘æˆ˜"></a> 3.1. æŒ‘æˆ˜</h3>
<p>è¯»å†™åˆ†ç¦»è™½ç„¶å¯ä»¥æå‡ç³»ç»Ÿçš„ååé‡å’Œå¯ç”¨æ€§ï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥äº†æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ è¿™åŒ…æ‹¬å¤šä¸ªä¸»åº“ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ï¼Œä»¥åŠä¸»åº“ä¸ä»åº“ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚ å¹¶ä¸”ï¼Œè¯»å†™åˆ†ç¦»ä¹Ÿå¸¦æ¥äº†ä¸æ•°æ®åˆ†ç‰‡åŒæ ·çš„é—®é¢˜ï¼Œå®ƒåŒæ ·ä¼šä½¿å¾—åº”ç”¨å¼€å‘å’Œè¿ç»´äººå‘˜å¯¹æ•°æ®åº“çš„æ“ä½œå’Œè¿ç»´å˜å¾—æ›´åŠ å¤æ‚ã€‚ ä¸‹å›¾å±•ç°äº†å°†åˆ†åº“åˆ†è¡¨ä¸è¯»å†™åˆ†ç¦»ä¸€åŒä½¿ç”¨æ—¶ï¼Œåº”ç”¨ç¨‹åºä¸æ•°æ®åº“é›†ç¾¤ä¹‹é—´çš„å¤æ‚æ‹“æ‰‘å…³ç³»ã€‚</p>
<p><img src="https://shardingsphere.apache.org/document/current/img/read-write-split/sharding-read-write-split.png" alt="æ•°æ®åˆ†ç‰‡ + è¯»å†™åˆ†ç¦»" /></p>
<h2 id="4-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#4-å‚è€ƒèµ„æ–™"></a> 4. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://shardingsphere.apache.org/document/current/cn/overview/" target="_blank" rel="noopener">ShardingSphere å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://juejin.im/post/5bf778ef5188251b8a26ed8b" target="_blank" rel="noopener">â€œåˆ†åº“åˆ†è¡¨&quot; ï¼Ÿé€‰å‹å’Œæµç¨‹è¦æ…é‡ï¼Œå¦åˆ™ä¼šå¤±æ§</a></li>
<li><a href="https://www.jianshu.com/p/32b3e91aa22c" target="_blank" rel="noopener">åˆ†åº“åˆ†è¡¨éœ€è¦è€ƒè™‘çš„é—®é¢˜åŠæ–¹æ¡ˆ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>åˆ†ç‰‡</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ†å¸ƒå¼å­˜å‚¨åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/distributed-storage-theory/</url>
    <content><![CDATA[<h1 id="åˆ†å¸ƒå¼å­˜å‚¨åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼å­˜å‚¨åŸºæœ¬åŸç†"></a> åˆ†å¸ƒå¼å­˜å‚¨åŸºæœ¬åŸç†</h1>
<h2 id="1-åˆ†åŒºè§„åˆ™"><a class="markdownIt-Anchor" href="#1-åˆ†åŒºè§„åˆ™"></a> 1. åˆ†åŒºè§„åˆ™</h2>
<p><strong>åˆ†å¸ƒå¼æ•°æ®åº“</strong> é¦–å…ˆè¦è§£å†³æŠŠ <strong>æ•´ä¸ªæ•°æ®é›†</strong> æŒ‰ç…§ <strong>åˆ†åŒºè§„åˆ™</strong> æ˜ å°„åˆ° <strong>å¤šä¸ªèŠ‚ç‚¹</strong> çš„é—®é¢˜ï¼Œå³æŠŠ <strong>æ•°æ®é›†</strong> åˆ’åˆ†åˆ° <strong>å¤šä¸ªèŠ‚ç‚¹</strong> ä¸Šï¼Œæ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£ <strong>æ•´ä½“æ•°æ®</strong> çš„ä¸€ä¸ª <strong>å­é›†</strong>ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/partition-rule.png!zp" />
</div>
<p>æ•°æ®åˆ†å¸ƒé€šå¸¸æœ‰ <strong>å“ˆå¸Œåˆ†åŒº</strong> å’Œ <strong>é¡ºåºåˆ†åŒº</strong> ä¸¤ç§æ–¹å¼ï¼Œå¯¹æ¯”å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">åˆ†åŒºæ–¹å¼</th>
<th style="text-align:left">ç‰¹ç‚¹</th>
<th style="text-align:left">ç›¸å…³äº§å“</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">å“ˆå¸Œåˆ†åŒº</td>
<td style="text-align:left">ç¦»æ•£ç¨‹åº¦å¥½ï¼Œæ•°æ®åˆ†å¸ƒä¸ä¸šåŠ¡æ— å…³ï¼Œæ— æ³•é¡ºåºè®¿é—®</td>
<td style="text-align:left">Redis Clusterï¼ŒCassandraï¼ŒDynamo</td>
</tr>
<tr>
<td style="text-align:left">é¡ºåºåˆ†åŒº</td>
<td style="text-align:left">ç¦»æ•£ç¨‹åº¦æ˜“å€¾æ–œï¼Œæ•°æ®åˆ†å¸ƒä¸ä¸šåŠ¡ç›¸å…³ï¼Œå¯ä»¥é¡ºåºè®¿é—®</td>
<td style="text-align:left">BigTableï¼ŒHBaseï¼ŒHypertable</td>
</tr>
</tbody>
</table>
<p>ç”±äº <code>Redis Cluster</code> é‡‡ç”¨ <strong>å“ˆå¸Œåˆ†åŒºè§„åˆ™</strong>ï¼Œè¿™é‡Œé‡ç‚¹è®¨è®º <strong>å“ˆå¸Œåˆ†åŒº</strong>ã€‚å¸¸è§çš„ <strong>å“ˆå¸Œåˆ†åŒº</strong> è§„åˆ™æœ‰å‡ ç§ï¼Œä¸‹é¢åˆ†åˆ«ä»‹ç»ï¼š</p>
<h3 id="11-èŠ‚ç‚¹å–ä½™åˆ†åŒº"><a class="markdownIt-Anchor" href="#11-èŠ‚ç‚¹å–ä½™åˆ†åŒº"></a> 1.1. èŠ‚ç‚¹å–ä½™åˆ†åŒº</h3>
<p>ä½¿ç”¨ç‰¹å®šçš„æ•°æ®ï¼Œå¦‚ <code>Redis</code> çš„ <strong>é”®</strong> æˆ– <strong>ç”¨æˆ·</strong> <code>ID</code>ï¼Œå†æ ¹æ® <strong>èŠ‚ç‚¹æ•°é‡</strong> <code>N</code> ä½¿ç”¨å…¬å¼ï¼š<code>hashï¼ˆkeyï¼‰% N</code> è®¡ç®—å‡º <strong>å“ˆå¸Œå€¼</strong>ï¼Œç”¨æ¥å†³å®šæ•°æ® <strong>æ˜ å°„</strong> åˆ°å“ªä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/partition-hash-mod.png!zp" />
</div>
<ul>
<li><strong>ä¼˜ç‚¹</strong></li>
</ul>
<p>è¿™ç§æ–¹å¼çš„çªå‡ºä¼˜ç‚¹æ˜¯ <strong>ç®€å•æ€§</strong>ï¼Œå¸¸ç”¨äº <strong>æ•°æ®åº“</strong> çš„ <strong>åˆ†åº“åˆ†è¡¨è§„åˆ™</strong>ã€‚ä¸€èˆ¬é‡‡ç”¨ <strong>é¢„åˆ†åŒº</strong> çš„æ–¹å¼ï¼Œæå‰æ ¹æ® <strong>æ•°æ®é‡</strong> è§„åˆ’å¥½ <strong>åˆ†åŒºæ•°</strong>ï¼Œæ¯”å¦‚åˆ’åˆ†ä¸º <code>512</code> æˆ– <code>1024</code> å¼ è¡¨ï¼Œä¿è¯å¯æ”¯æ’‘æœªæ¥ä¸€æ®µæ—¶é—´çš„ <strong>æ•°æ®å®¹é‡</strong>ï¼Œå†æ ¹æ® <strong>è´Ÿè½½æƒ…å†µ</strong> å°† <strong>è¡¨</strong> è¿ç§»åˆ°å…¶ä»– <strong>æ•°æ®åº“</strong> ä¸­ã€‚æ‰©å®¹æ—¶é€šå¸¸é‡‡ç”¨ <strong>ç¿»å€æ‰©å®¹</strong>ï¼Œé¿å… <strong>æ•°æ®æ˜ å°„</strong> å…¨éƒ¨è¢« <strong>æ‰“ä¹±</strong>ï¼Œå¯¼è‡´ <strong>å…¨é‡è¿ç§»</strong> çš„æƒ…å†µã€‚</p>
<ul>
<li><strong>ç¼ºç‚¹</strong></li>
</ul>
<p>å½“ <strong>èŠ‚ç‚¹æ•°é‡</strong> å˜åŒ–æ—¶ï¼Œå¦‚ <strong>æ‰©å®¹</strong> æˆ– <strong>æ”¶ç¼©</strong> èŠ‚ç‚¹ï¼Œæ•°æ®èŠ‚ç‚¹ <strong>æ˜ å°„å…³ç³»</strong> éœ€è¦é‡æ–°è®¡ç®—ï¼Œä¼šå¯¼è‡´æ•°æ®çš„ <strong>é‡æ–°è¿ç§»</strong>ã€‚</p>
<h3 id="12-ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº"><a class="markdownIt-Anchor" href="#12-ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº"></a> 1.2. ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº</h3>
<p><strong>ä¸€è‡´æ€§å“ˆå¸Œ</strong> å¯ä»¥å¾ˆå¥½çš„è§£å†³ <strong>ç¨³å®šæ€§é—®é¢˜</strong>ï¼Œå¯ä»¥å°†æ‰€æœ‰çš„ <strong>å­˜å‚¨èŠ‚ç‚¹</strong> æ’åˆ—åœ¨ <strong>é¦–å°¾ç›¸æ¥</strong> çš„ <code>Hash</code> ç¯ä¸Šï¼Œæ¯ä¸ª <code>key</code> åœ¨è®¡ç®— <code>Hash</code> åä¼š <strong>é¡ºæ—¶é’ˆ</strong> æ‰¾åˆ° <strong>ä¸´æ¥</strong> çš„ <strong>å­˜å‚¨èŠ‚ç‚¹</strong> å­˜æ”¾ã€‚è€Œå½“æœ‰èŠ‚ç‚¹ <strong>åŠ å…¥</strong> æˆ– <strong>é€€å‡º</strong> æ—¶ï¼Œä»…å½±å“è¯¥èŠ‚ç‚¹åœ¨ <code>Hash</code> ç¯ä¸Š <strong>é¡ºæ—¶é’ˆç›¸é‚»</strong> çš„ <strong>åç»­èŠ‚ç‚¹</strong>ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/partition-consistent-hash.png!zp" />
</div>
<ul>
<li><strong>ä¼˜ç‚¹</strong></li>
</ul>
<p><strong>åŠ å…¥</strong> å’Œ <strong>åˆ é™¤</strong> èŠ‚ç‚¹åªå½±å“ <strong>å“ˆå¸Œç¯</strong> ä¸­ <strong>é¡ºæ—¶é’ˆæ–¹å‘</strong> çš„ <strong>ç›¸é‚»çš„èŠ‚ç‚¹</strong>ï¼Œå¯¹å…¶ä»–èŠ‚ç‚¹æ— å½±å“ã€‚</p>
<ul>
<li><strong>ç¼ºç‚¹</strong></li>
</ul>
<p><strong>åŠ å‡èŠ‚ç‚¹</strong> ä¼šé€ æˆ <strong>å“ˆå¸Œç¯</strong> ä¸­éƒ¨åˆ†æ•°æ® <strong>æ— æ³•å‘½ä¸­</strong>ã€‚å½“ä½¿ç”¨ <strong>å°‘é‡èŠ‚ç‚¹</strong> æ—¶ï¼Œ<strong>èŠ‚ç‚¹å˜åŒ–</strong> å°†å¤§èŒƒå›´å½±å“ <strong>å“ˆå¸Œç¯</strong> ä¸­ <strong>æ•°æ®æ˜ å°„</strong>ï¼Œä¸é€‚åˆ <strong>å°‘é‡æ•°æ®èŠ‚ç‚¹</strong> çš„åˆ†å¸ƒå¼æ–¹æ¡ˆã€‚<strong>æ™®é€š</strong> çš„ <strong>ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº</strong> åœ¨å¢å‡èŠ‚ç‚¹æ—¶éœ€è¦ <strong>å¢åŠ ä¸€å€</strong> æˆ– <strong>å‡å»ä¸€åŠ</strong> èŠ‚ç‚¹æ‰èƒ½ä¿è¯ <strong>æ•°æ®</strong> å’Œ <strong>è´Ÿè½½çš„å‡è¡¡</strong>ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šå› ä¸º <strong>ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº</strong> çš„è¿™äº›ç¼ºç‚¹ï¼Œä¸€äº›åˆ†å¸ƒå¼ç³»ç»Ÿé‡‡ç”¨ <strong>è™šæ‹Ÿæ§½</strong> å¯¹ <strong>ä¸€è‡´æ€§å“ˆå¸Œ</strong> è¿›è¡Œæ”¹è¿›ï¼Œæ¯”å¦‚ <code>Dynamo</code> ç³»ç»Ÿã€‚</p>
</blockquote>
<h3 id="13-è™šæ‹Ÿæ§½åˆ†åŒº"><a class="markdownIt-Anchor" href="#13-è™šæ‹Ÿæ§½åˆ†åŒº"></a> 1.3. è™šæ‹Ÿæ§½åˆ†åŒº</h3>
<p><strong>è™šæ‹Ÿæ§½åˆ†åŒº</strong> å·§å¦™åœ°ä½¿ç”¨äº† <strong>å“ˆå¸Œç©ºé—´</strong>ï¼Œä½¿ç”¨ <strong>åˆ†æ•£åº¦è‰¯å¥½</strong> çš„ <strong>å“ˆå¸Œå‡½æ•°</strong> æŠŠæ‰€æœ‰æ•°æ® <strong>æ˜ å°„</strong> åˆ°ä¸€ä¸ª <strong>å›ºå®šèŒƒå›´</strong> çš„ <strong>æ•´æ•°é›†åˆ</strong> ä¸­ï¼Œæ•´æ•°å®šä¹‰ä¸º <strong>æ§½</strong>ï¼ˆ<code>slot</code>ï¼‰ã€‚è¿™ä¸ªèŒƒå›´ä¸€èˆ¬ <strong>è¿œè¿œå¤§äº</strong> èŠ‚ç‚¹æ•°ï¼Œæ¯”å¦‚ <code>Redis Cluster</code> æ§½èŒƒå›´æ˜¯ <code>0 ~ 16383</code>ã€‚<strong>æ§½</strong> æ˜¯é›†ç¾¤å†… <strong>æ•°æ®ç®¡ç†</strong> å’Œ <strong>è¿ç§»</strong> çš„ <strong>åŸºæœ¬å•ä½</strong>ã€‚é‡‡ç”¨ <strong>å¤§èŒƒå›´æ§½</strong> çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ <strong>æ•°æ®æ‹†åˆ†</strong> å’Œ <strong>é›†ç¾¤æ‰©å±•</strong>ã€‚æ¯ä¸ªèŠ‚ç‚¹ä¼šè´Ÿè´£ <strong>ä¸€å®šæ•°é‡çš„æ§½</strong>ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/partition-hash-slot.png!zp" />
</div>
å½“å‰é›†ç¾¤æœ‰ `3` ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¹³å‡å¤§çº¦è´Ÿè´£ `5460` ä¸ª **æ§½**ã€‚ç”±äºé‡‡ç”¨ **é«˜è´¨é‡** çš„ **å“ˆå¸Œç®—æ³•**ï¼Œæ¯ä¸ªæ§½æ‰€æ˜ å°„çš„æ•°æ®é€šå¸¸æ¯”è¾ƒ **å‡åŒ€**ï¼Œå°†æ•°æ®å¹³å‡åˆ’åˆ†åˆ° `3` ä¸ªèŠ‚ç‚¹è¿›è¡Œ **æ•°æ®åˆ†åŒº**ã€‚`Redis Cluster` å°±æ˜¯é‡‡ç”¨ **è™šæ‹Ÿæ§½åˆ†åŒº**ã€‚
<p>é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†å“ˆå¸Œæ§½ï¼Œæ¯”å¦‚é›†ç¾¤ä¸­æœ‰ï¼“ä¸ªèŠ‚ç‚¹ï¼Œåˆ™ï¼š</p>
<ul>
<li>èŠ‚ç‚¹ï¼¡å­˜å‚¨çš„å“ˆå¸Œæ§½èŒƒå›´æ˜¯ï¼š0 â€“ 5460</li>
<li>èŠ‚ç‚¹ï¼¢å­˜å‚¨çš„å“ˆå¸Œæ§½èŒƒå›´æ˜¯ï¼š5461 â€“ 10922</li>
<li>èŠ‚ç‚¹ï¼£å­˜å‚¨çš„å“ˆå¸Œæ§½èŒƒå›´æ˜¯ï¼š10923 â€“ 16383</li>
</ul>
<p>è¿™ç§ç»“æ„å¾ˆå®¹æ˜“ <strong>æ·»åŠ </strong> æˆ–è€… <strong>åˆ é™¤</strong> èŠ‚ç‚¹ã€‚å¦‚æœ <strong>å¢åŠ </strong> ä¸€ä¸ªèŠ‚ç‚¹ <code>4</code>ï¼Œå°±éœ€è¦ä»èŠ‚ç‚¹ <code>1 ~ 3</code> è·å¾—éƒ¨åˆ† <strong>æ§½</strong> åˆ†é…åˆ°èŠ‚ç‚¹ <code>4</code> ä¸Šã€‚å¦‚æœæƒ³ <strong>ç§»é™¤</strong> èŠ‚ç‚¹ <code>1</code>ï¼Œéœ€è¦å°†èŠ‚ç‚¹ <code>1</code> ä¸­çš„ <strong>æ§½</strong> ç§»åˆ°èŠ‚ç‚¹ <code>2 ~ 3</code> ä¸Šï¼Œç„¶åå°† <strong>æ²¡æœ‰ä»»ä½•æ§½</strong> çš„èŠ‚ç‚¹ <code>1</code> ä»é›†ç¾¤ä¸­ <strong>ç§»é™¤</strong> å³å¯ã€‚</p>
<blockquote>
<p>ç”±äºä»ä¸€ä¸ªèŠ‚ç‚¹å°† <strong>å“ˆå¸Œæ§½</strong> ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹å¹¶ä¸ä¼š <strong>åœæ­¢æœåŠ¡</strong>ï¼Œæ‰€ä»¥æ— è®º <strong>æ·»åŠ åˆ é™¤</strong> æˆ–è€… <strong>æ”¹å˜</strong> æŸä¸ªèŠ‚ç‚¹çš„ <strong>å“ˆå¸Œæ§½çš„æ•°é‡</strong> éƒ½ä¸ä¼šé€ æˆ <strong>é›†ç¾¤ä¸å¯ç”¨</strong> çš„çŠ¶æ€.</p>
</blockquote>
<h2 id="2-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#2-å‚è€ƒèµ„æ–™"></a> 2. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://juejin.im/post/5b8fc5536fb9a05d2d01fb11" target="_blank" rel="noopener">æ·±å…¥å‰–æ Redis ç³»åˆ—(ä¸‰) - Redis é›†ç¾¤æ¨¡å¼æ­å»ºä¸åŸç†è¯¦è§£</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>å­˜å‚¨</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ†å¸ƒå¼ ID åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/distributed-id-theory/</url>
    <content><![CDATA[<h1 id="åˆ†å¸ƒå¼-id-åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼-id-åŸºæœ¬åŸç†"></a> åˆ†å¸ƒå¼ ID åŸºæœ¬åŸç†</h1>
<blockquote>
<p>ä¼ ç»Ÿæ•°æ®åº“è½¯ä»¶å¼€å‘ä¸­ï¼Œä¸»é”®è‡ªåŠ¨ç”ŸæˆæŠ€æœ¯æ˜¯åŸºæœ¬éœ€æ±‚ã€‚è€Œå„ä¸ªæ•°æ®åº“å¯¹äºè¯¥éœ€æ±‚ä¹Ÿæä¾›äº†ç›¸åº”çš„æ”¯æŒï¼Œæ¯”å¦‚ MySQL çš„è‡ªå¢é”®ï¼ŒOracle çš„è‡ªå¢åºåˆ—ç­‰ã€‚</p>
<p>æ•°æ®åˆ†ç‰‡åï¼Œä¸åŒæ•°æ®èŠ‚ç‚¹ç”Ÿæˆå…¨å±€å”¯ä¸€ä¸»é”®æ˜¯éå¸¸æ£˜æ‰‹çš„é—®é¢˜ã€‚åŒä¸€ä¸ªé€»è¾‘è¡¨å†…çš„ä¸åŒå®é™…è¡¨ä¹‹é—´çš„è‡ªå¢é”®ç”±äºæ— æ³•äº’ç›¸æ„ŸçŸ¥è€Œäº§ç”Ÿé‡å¤ä¸»é”®ã€‚ è™½ç„¶å¯é€šè¿‡çº¦æŸè‡ªå¢ä¸»é”®åˆå§‹å€¼å’Œæ­¥é•¿çš„æ–¹å¼é¿å…ç¢°æ’ï¼Œä½†éœ€å¼•å…¥é¢å¤–çš„è¿ç»´è§„åˆ™ï¼Œä½¿è§£å†³æ–¹æ¡ˆç¼ºä¹å®Œæ•´æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p>
<p>ä¸ºæ­¤ï¼Œéœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼ ID æ¥è§£å†³æ­¤é—®é¢˜ã€‚æœ¬æ–‡æ€»ç»“ä¸šç•Œå¸¸ç”¨çš„åˆ†å¸ƒå¼ ID è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#1-%E7%AE%80%E4%BB%8B">1. ç®€ä»‹</a></li>
<li><a href="#2-uuid">2. UUID</a>
<ul>
<li><a href="#21-uuid-%E7%9A%84%E4%BC%98%E7%82%B9">2.1. UUID çš„ä¼˜ç‚¹</a></li>
<li><a href="#22-uuid-%E7%9A%84%E7%BC%BA%E7%82%B9">2.2. UUID çš„ç¼ºç‚¹</a></li>
<li><a href="#23-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">2.3. é€‚ç”¨åœºæ™¯</a></li>
</ul>
</li>
<li><a href="#3-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%87%AA%E5%A2%9E%E9%94%AE">3. æ•°æ®åº“è‡ªå¢é”®</a>
<ul>
<li><a href="#31-%E4%BC%98%E7%82%B9">3.1. ä¼˜ç‚¹</a></li>
<li><a href="#32-%E7%BC%BA%E7%82%B9">3.2. ç¼ºç‚¹</a></li>
<li><a href="#33-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">3.3. é€‚ç”¨åœºæ™¯</a></li>
<li><a href="#34-%E6%94%B9%E8%BF%9B">3.4. æ”¹è¿›</a></li>
</ul>
</li>
<li><a href="#4-%E5%88%A9%E7%94%A8-redis-%E7%94%9F%E6%88%90%E9%94%AE">4. åˆ©ç”¨ Redis ç”Ÿæˆé”®</a>
<ul>
<li><a href="#41-%E4%BC%98%E7%82%B9">4.1. ä¼˜ç‚¹</a></li>
<li><a href="#42-%E7%BC%BA%E7%82%B9">4.2. ç¼ºç‚¹</a></li>
<li><a href="#43-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">4.3. é€‚ç”¨åœºæ™¯</a></li>
</ul>
</li>
<li><a href="#5-%E9%9B%AA%E8%8A%B1%E7%AE%97%E6%B3%95snowflake">5. é›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰</a>
<ul>
<li><a href="#51-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86">5.1. åŸºæœ¬åŸç†</a></li>
<li><a href="#52-%E4%BC%98%E7%82%B9">5.2. ä¼˜ç‚¹</a></li>
<li><a href="#53-%E7%BC%BA%E7%82%B9">5.3. ç¼ºç‚¹</a></li>
<li><a href="#54-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">5.4. é€‚ç”¨åœºæ™¯</a></li>
<li><a href="#55-%E9%98%B2%E6%AD%A2%E6%97%B6%E9%92%9F%E5%9B%9E%E6%8B%A8">5.5. é˜²æ­¢æ—¶é’Ÿå›æ‹¨</a></li>
</ul>
</li>
<li><a href="#6-leaf">6. Leaf</a>
<ul>
<li><a href="#61-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86">6.1. åŸºæœ¬åŸç†</a></li>
<li><a href="#62-%E4%BC%98%E7%82%B9">6.2. ä¼˜ç‚¹</a></li>
<li><a href="#63-%E7%BC%BA%E7%82%B9">6.3. ç¼ºç‚¹</a></li>
<li><a href="#64-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">6.4. é€‚ç”¨åœºæ™¯</a></li>
</ul>
</li>
<li><a href="#7-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">7. å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="1-ç®€ä»‹"><a class="markdownIt-Anchor" href="#1-ç®€ä»‹"></a> 1. ç®€ä»‹</h2>
<p>é¦–å…ˆï¼Œåˆ†å¸ƒå¼ ID åº”è¯¥å…·å¤‡å“ªäº›ç‰¹æ€§å‘¢ï¼Ÿ</p>
<ol>
<li><strong>å…¨å±€å”¯ä¸€æ€§</strong> - ä¸èƒ½å‡ºç°é‡å¤çš„ ID å·ï¼Œæ—¢ç„¶æ˜¯å”¯ä¸€æ ‡è¯†ï¼Œè¿™æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ã€‚</li>
<li><strong>è¶‹åŠ¿é€’å¢</strong> - åœ¨ MySQL InnoDB å¼•æ“ä¸­ä½¿ç”¨çš„æ˜¯èšé›†ç´¢å¼•ï¼Œç”±äºå¤šæ•° RDBMS ä½¿ç”¨ B-tree çš„æ•°æ®ç»“æ„æ¥å­˜å‚¨ç´¢å¼•æ•°æ®ï¼Œåœ¨ä¸»é”®çš„é€‰æ‹©ä¸Šé¢æˆ‘ä»¬åº”è¯¥å°½é‡ä½¿ç”¨æœ‰åºçš„ä¸»é”®ä¿è¯å†™å…¥æ€§èƒ½ã€‚</li>
<li><strong>å•è°ƒé€’å¢</strong> - ä¿è¯ä¸‹ä¸€ä¸ª ID ä¸€å®šå¤§äºä¸Šä¸€ä¸ª IDï¼Œä¾‹å¦‚äº‹åŠ¡ç‰ˆæœ¬å·ã€IM å¢é‡æ¶ˆæ¯ã€æ’åºç­‰ç‰¹æ®Šéœ€æ±‚ã€‚</li>
<li><strong>ä¿¡æ¯å®‰å…¨</strong> - å¦‚æœ ID æ˜¯è¿ç»­çš„ï¼Œæ¶æ„ç”¨æˆ·çš„æ‰’å–å·¥ä½œå°±éå¸¸å®¹æ˜“åšäº†ï¼Œç›´æ¥æŒ‰ç…§é¡ºåºä¸‹è½½æŒ‡å®š URL å³å¯ï¼›å¦‚æœæ˜¯è®¢å•å·å°±æ›´å±é™©äº†ï¼Œç«å¯¹å¯ä»¥ç›´æ¥çŸ¥é“æˆ‘ä»¬ä¸€å¤©çš„å•é‡ã€‚æ‰€ä»¥åœ¨ä¸€äº›åº”ç”¨åœºæ™¯ä¸‹ï¼Œä¼šéœ€è¦ ID æ— è§„åˆ™ã€ä¸è§„åˆ™ã€‚</li>
</ol>
<h2 id="2-uuid"><a class="markdownIt-Anchor" href="#2-uuid"></a> 2. UUID</h2>
<p>UUID æ˜¯é€šç”¨å”¯ä¸€è¯†åˆ«ç ï¼ˆUniversally Unique Identifier)çš„ç¼©å†™ï¼Œå¼€æ”¾è½¯ä»¶åŸºé‡‘ä¼š(OSF)è§„èŒƒå®šä¹‰äº†åŒ…æ‹¬ç½‘å¡ MAC åœ°å€ã€æ—¶é—´æˆ³ã€åå­—ç©ºé—´ï¼ˆNamespaceï¼‰ã€éšæœºæˆ–ä¼ªéšæœºæ•°ã€æ—¶åºç­‰å…ƒç´ ã€‚åˆ©ç”¨è¿™äº›å…ƒç´ æ¥ç”Ÿæˆ UUIDã€‚</p>
<p>UUID æ˜¯ç”± 128 ä½äºŒè¿›åˆ¶ç»„æˆï¼Œä¸€èˆ¬è½¬æ¢æˆåå…­è¿›åˆ¶ï¼Œç„¶åç”¨ String è¡¨ç¤ºã€‚åœ¨ java ä¸­æœ‰ä¸ª UUID ç±»,åœ¨ä»–çš„æ³¨é‡Šä¸­æˆ‘ä»¬çœ‹è§è¿™é‡Œæœ‰ 4 ç§ä¸åŒçš„ UUID çš„ç”Ÿæˆç­–ç•¥:</p>
<ul>
<li>random - åŸºäºéšæœºæ•°ç”Ÿæˆ UUIDï¼Œç”±äº Java ä¸­çš„éšæœºæ•°æ˜¯ä¼ªéšæœºæ•°ï¼Œå…¶é‡å¤çš„æ¦‚ç‡æ˜¯å¯ä»¥è¢«è®¡ç®—å‡ºæ¥çš„ã€‚è¿™ä¸ªä¸€èˆ¬æˆ‘ä»¬ç”¨ä¸‹é¢çš„ä»£ç è·å–åŸºäºéšæœºæ•°çš„ UUID:</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String id = UUID.randomUUID().toString();</span><br></pre></td></tr></table></figure>
<ul>
<li>time-based - åŸºäºæ—¶é—´çš„ UUID,è¿™ä¸ªä¸€èˆ¬æ˜¯é€šè¿‡å½“å‰æ—¶é—´ï¼Œéšæœºæ•°ï¼Œå’Œæœ¬åœ° Mac åœ°å€æ¥è®¡ç®—å‡ºæ¥ï¼Œè‡ªå¸¦çš„ JDK åŒ…å¹¶æ²¡æœ‰è¿™ä¸ªç®—æ³•çš„æˆ‘ä»¬åœ¨ä¸€äº› UUIDUtil ä¸­ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ log4j.core.utilï¼Œä¼šé‡æ–°å®šä¹‰ UUID çš„é«˜ä½å’Œä½ä½ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UUID <span class="title">getTimeBasedUuid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> time = System.currentTimeMillis() * <span class="number">10000L</span> + <span class="number">122192928000000000L</span> + (<span class="keyword">long</span>)(COUNT.incrementAndGet() % <span class="number">10000</span>);</span><br><span class="line">    <span class="keyword">long</span> timeLow = (time &amp; <span class="number">4294967295L</span>) &lt;&lt; <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">long</span> timeMid = (time &amp; <span class="number">281470681743360L</span>) &gt;&gt; <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">long</span> timeHi = (time &amp; <span class="number">1152640029630136320L</span>) &gt;&gt; <span class="number">48</span>;</span><br><span class="line">    <span class="keyword">long</span> most = timeLow | timeMid | <span class="number">4096L</span> | timeHi;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> UUID(most, LEAST);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>DCE security - DCE å®‰å…¨çš„ UUIDã€‚</p>
</li>
<li>
<p>name-based - åŸºäºåå­—çš„ UUIDï¼Œé€šè¿‡è®¡ç®—åå­—å’Œåå­—ç©ºé—´çš„ MD5 æ¥è®¡ç®— UUIDã€‚</p>
</li>
</ul>
<h3 id="21-uuid-çš„ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#21-uuid-çš„ä¼˜ç‚¹"></a> 2.1. UUID çš„ä¼˜ç‚¹</h3>
<ul>
<li>é€šè¿‡æœ¬åœ°ç”Ÿæˆï¼Œæ²¡æœ‰ç»è¿‡ç½‘ç»œ I/Oï¼Œæ€§èƒ½è¾ƒå¿«</li>
</ul>
<h3 id="22-uuid-çš„ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#22-uuid-çš„ç¼ºç‚¹"></a> 2.2. UUID çš„ç¼ºç‚¹</h3>
<ul>
<li><strong>é•¿åº¦è¿‡é•¿</strong> - UUID å¤ªé•¿ï¼Œ16 å­—èŠ‚ 128 ä½ï¼Œé€šå¸¸ä»¥ 36 é•¿åº¦çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œå¾ˆå¤šåœºæ™¯ä¸é€‚ç”¨ã€‚ä¾‹å¦‚ï¼šMysql å®˜æ–¹æ˜ç¡®å»ºè®®ä¸»é”®è¶ŠçŸ­è¶Šå¥½ï¼Œ36 ä¸ªå­—ç¬¦é•¿åº¦çš„ UUID ä¸ç¬¦åˆè¦æ±‚ã€‚</li>
<li><strong>ä¿¡æ¯ä¸å®‰å…¨</strong> - åŸºäº MAC åœ°å€ç”Ÿæˆ UUID çš„ç®—æ³•å¯èƒ½ä¼šé€ æˆ MAC åœ°å€æ³„éœ²ï¼Œè¿™ä¸ªæ¼æ´æ›¾è¢«ç”¨äºå¯»æ‰¾æ¢…ä¸½èç—…æ¯’çš„åˆ¶ä½œè€…ä½ç½®ã€‚</li>
<li><strong>æ— åºæ€§</strong> - ä¸èƒ½ç”Ÿæˆé€’å¢æœ‰åºçš„æ•°å­—ã€‚è¿™å¯¹äºä¸€äº›ç‰¹å®šåœºæ™¯ä¸åˆ©ã€‚ä¾‹å¦‚ï¼šå¦‚æœä½œä¸ºæ•°æ®åº“ä¸»é”®ï¼Œåœ¨ InnoDB å¼•æ“ä¸‹ï¼ŒUUID çš„æ— åºæ€§å¯èƒ½ä¼šå¼•èµ·æ•°æ®ä½ç½®é¢‘ç¹å˜åŠ¨ï¼Œä¸¥é‡å½±å“æ€§èƒ½ã€‚</li>
</ul>
<h3 id="23-é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#23-é€‚ç”¨åœºæ™¯"></a> 2.3. é€‚ç”¨åœºæ™¯</h3>
<p>UUID çš„é€‚ç”¨åœºæ™¯å¯ä»¥ä¸ºä¸éœ€è¦æ‹…å¿ƒè¿‡å¤šçš„ç©ºé—´å ç”¨ï¼Œä»¥åŠä¸éœ€è¦ç”Ÿæˆæœ‰é€’å¢è¶‹åŠ¿çš„æ•°å­—ã€‚åœ¨ Log4j é‡Œ <code>UuidPatternConverter</code> ä¸­åŠ å…¥äº† UUID æ¥æ ‡è¯†æ¯ä¸€æ¡æ—¥å¿—ã€‚</p>
<h2 id="3-æ•°æ®åº“è‡ªå¢é”®"><a class="markdownIt-Anchor" href="#3-æ•°æ®åº“è‡ªå¢é”®"></a> 3. æ•°æ®åº“è‡ªå¢é”®</h2>
<p>æåˆ°è‡ªå¢é”®ï¼Œæœ€å…ˆæƒ³åˆ°çš„è‚¯å®šæ˜¯ç›´æ¥ä½¿ç”¨æ•°æ®åº“è‡ªå¢é”®ã€‚<em>å„æ•°æ®åº“å¯¹äºè¯¥éœ€æ±‚ä¹Ÿæä¾›äº†ç›¸åº”çš„æ”¯æŒï¼Œæ¯”å¦‚ MySQL çš„è‡ªå¢é”®ï¼ŒOracle çš„è‡ªå¢åºåˆ—ç­‰</em>ã€‚</p>
<h3 id="31-ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#31-ä¼˜ç‚¹"></a> 3.1. ä¼˜ç‚¹</h3>
<ul>
<li>éå¸¸ç®€å•ï¼Œåˆ©ç”¨ç°æœ‰æ•°æ®åº“çš„åŠŸèƒ½å®ç°ï¼Œæˆæœ¬å°ï¼Œæœ‰ DBA ä¸“ä¸šç»´æŠ¤</li>
<li>æœ‰åºé€’å¢</li>
<li>æ–¹ä¾¿æ’åºå’Œåˆ†é¡µ</li>
</ul>
<h3 id="32-ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#32-ç¼ºç‚¹"></a> 3.2. ç¼ºç‚¹</h3>
<ul>
<li>å¼ºä¾èµ–æ•°æ®åº“ï¼Œå½“æ•°æ®åº“å¼‚å¸¸æ—¶æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ã€‚é…ç½®ä¸»ä»å¤åˆ¶å¯ä»¥å°½å¯èƒ½çš„å¢åŠ å¯ç”¨æ€§ï¼Œä½†æ˜¯æ•°æ®ä¸€è‡´æ€§åœ¨ç‰¹æ®Šæƒ…å†µä¸‹éš¾ä»¥ä¿è¯ã€‚ä¸»ä»åˆ‡æ¢æ—¶çš„ä¸ä¸€è‡´å¯èƒ½ä¼šå¯¼è‡´é‡å¤å‘å·ã€‚</li>
<li>ç”Ÿæˆ ID æ€§èƒ½ç“¶é¢ˆé™åˆ¶åœ¨å•å° MySQL çš„è¯»å†™æ€§èƒ½ã€‚</li>
<li>ç®€å•é€’å¢å®¹æ˜“è¢«å…¶ä»–äººåˆ†æåˆ©ç”¨
<ul>
<li>æ¯”å¦‚æ ¹æ®ç”¨æˆ· ID æ¥åˆ†ææ³¨å†Œäººæ•°ï¼ŒçŒœæµ‹å‡ºæœåŠ¡çš„ä¸€ä¸ªå¤§æ¦‚çŠ¶å†µã€‚</li>
</ul>
</li>
</ul>
<h3 id="33-é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#33-é€‚ç”¨åœºæ™¯"></a> 3.3. é€‚ç”¨åœºæ™¯</h3>
<p>æ•°æ®é‡ä¸å¤§ï¼Œå¹¶å‘ä¸é«˜çš„åœºæ™¯ã€‚</p>
<h3 id="34-æ”¹è¿›"><a class="markdownIt-Anchor" href="#34-æ”¹è¿›"></a> 3.4. æ”¹è¿›</h3>
<p>å¯¹äº MySQL æ€§èƒ½é—®é¢˜ï¼Œå¯ç”¨å¦‚ä¸‹æ–¹æ¡ˆè§£å†³ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æˆ‘ä»¬å¯ä»¥å¤šéƒ¨ç½²å‡ å°æœºå™¨ï¼Œæ¯å°æœºå™¨è®¾ç½®ä¸åŒçš„åˆå§‹å€¼ï¼Œä¸”æ­¥é•¿å’Œæœºå™¨æ•°ç›¸ç­‰ã€‚æ¯”å¦‚æœ‰ä¸¤å°æœºå™¨ã€‚è®¾ç½®æ­¥é•¿ step ä¸º 2ï¼ŒTicketServer1 çš„åˆå§‹å€¼ä¸º 1ï¼ˆ1ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ9ï¼Œ11â€¦ï¼‰ã€TicketServer2 çš„åˆå§‹å€¼ä¸º 2ï¼ˆ2ï¼Œ4ï¼Œ6ï¼Œ8ï¼Œ10â€¦ï¼‰ã€‚è¿™æ˜¯ Flickr å›¢é˜Ÿåœ¨ 2010 å¹´æ’°æ–‡ä»‹ç»çš„ä¸€ç§ä¸»é”®ç”Ÿæˆç­–ç•¥ï¼ˆ<a href="http://code.flickr.net/2010/02/08/ticket-servers-distributed-unique-primary-keys-on-the-cheap/" target="_blank" rel="noopener">Ticket Servers: Distributed Unique Primary Keys on the Cheap </a>ï¼‰ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸ºäº†å®ç°ä¸Šè¿°æ–¹æ¡ˆåˆ†åˆ«è®¾ç½®ä¸¤å°æœºå™¨å¯¹åº”çš„å‚æ•°ï¼ŒTicketServer1 ä» 1 å¼€å§‹å‘å·ï¼ŒTicketServer2 ä» 2 å¼€å§‹å‘å·ï¼Œä¸¤å°æœºå™¨æ¯æ¬¡å‘å·ä¹‹åéƒ½é€’å¢ 2ã€‚</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">TicketServer1:</span><br><span class="line">auto-<span class="keyword">increment</span>-<span class="keyword">increment</span> = <span class="number">2</span></span><br><span class="line">auto-<span class="keyword">increment</span>-offset = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">TicketServer2:</span><br><span class="line">auto-<span class="keyword">increment</span>-<span class="keyword">increment</span> = <span class="number">2</span></span><br><span class="line">auto-<span class="keyword">increment</span>-offset = <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p><img src="https://awps-assets.meituan.net/mit-x/blog-images-bundle-2017/6d2c9ec8.png" alt="image" /></p>
<p>è¿™ç§æ¶æ„å­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç³»ç»Ÿæ°´å¹³æ‰©å±•æ¯”è¾ƒå›°éš¾ï¼Œæ¯”å¦‚å®šä¹‰å¥½äº†æ­¥é•¿å’Œæœºå™¨å°æ•°ä¹‹åï¼Œå¦‚æœè¦æ·»åŠ æœºå™¨è¯¥æ€ä¹ˆåšï¼Ÿå‡è®¾ç°åœ¨åªæœ‰ä¸€å°æœºå™¨å‘å·æ˜¯ 1,2,3,4,5ï¼ˆæ­¥é•¿æ˜¯ 1ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦æ‰©å®¹æœºå™¨ä¸€å°ã€‚å¯ä»¥è¿™æ ·åšï¼šæŠŠç¬¬äºŒå°æœºå™¨çš„åˆå§‹å€¼è®¾ç½®å¾—æ¯”ç¬¬ä¸€å°è¶…è¿‡å¾ˆå¤šï¼Œæ¯”å¦‚ 14ï¼ˆå‡è®¾åœ¨æ‰©å®¹æ—¶é—´ä¹‹å†…ç¬¬ä¸€å°ä¸å¯èƒ½å‘åˆ° 14ï¼‰ï¼ŒåŒæ—¶è®¾ç½®æ­¥é•¿ä¸º 2ï¼Œé‚£ä¹ˆè¿™å°æœºå™¨ä¸‹å‘çš„å·ç éƒ½æ˜¯ 14 ä»¥åçš„å¶æ•°ã€‚ç„¶åæ‘˜æ‰ç¬¬ä¸€å°ï¼ŒæŠŠ ID å€¼ä¿ç•™ä¸ºå¥‡æ•°ï¼Œæ¯”å¦‚ 7ï¼Œç„¶åä¿®æ”¹ç¬¬ä¸€å°çš„æ­¥é•¿ä¸º 2ã€‚è®©å®ƒç¬¦åˆæˆ‘ä»¬å®šä¹‰çš„å·æ®µæ ‡å‡†ï¼Œå¯¹äºè¿™ä¸ªä¾‹å­æ¥è¯´å°±æ˜¯è®©ç¬¬ä¸€å°ä»¥ååªèƒ½äº§ç”Ÿå¥‡æ•°ã€‚æ‰©å®¹æ–¹æ¡ˆçœ‹èµ·æ¥å¤æ‚å—ï¼Ÿè²Œä¼¼è¿˜å¥½ï¼Œç°åœ¨æƒ³è±¡ä¸€ä¸‹å¦‚æœæˆ‘ä»¬çº¿ä¸Šæœ‰ 100 å°æœºå™¨ï¼Œè¿™ä¸ªæ—¶å€™è¦æ‰©å®¹è¯¥æ€ä¹ˆåšï¼Ÿç®€ç›´æ˜¯å™©æ¢¦ã€‚æ‰€ä»¥ç³»ç»Ÿæ°´å¹³æ‰©å±•æ–¹æ¡ˆå¤æ‚éš¾ä»¥å®ç°ã€‚</li>
<li>ID æ²¡æœ‰äº†å•è°ƒé€’å¢çš„ç‰¹æ€§ï¼Œåªèƒ½è¶‹åŠ¿é€’å¢ï¼Œè¿™ä¸ªç¼ºç‚¹å¯¹äºä¸€èˆ¬ä¸šåŠ¡éœ€æ±‚ä¸æ˜¯å¾ˆé‡è¦ï¼Œå¯ä»¥å®¹å¿ã€‚</li>
<li>æ•°æ®åº“å‹åŠ›è¿˜æ˜¯å¾ˆå¤§ï¼Œæ¯æ¬¡è·å– ID éƒ½å¾—è¯»å†™ä¸€æ¬¡æ•°æ®åº“ï¼Œåªèƒ½é å †æœºå™¨æ¥æé«˜æ€§èƒ½ã€‚</li>
</ul>
<h2 id="4-åˆ©ç”¨-redis-ç”Ÿæˆé”®"><a class="markdownIt-Anchor" href="#4-åˆ©ç”¨-redis-ç”Ÿæˆé”®"></a> 4. åˆ©ç”¨ Redis ç”Ÿæˆé”®</h2>
<p>Redis ä¸­æœ‰ä¸¤ä¸ªå‘½ä»¤ <code>Incr</code>ï¼Œ<code>IncrBy</code>ã€‚</p>
<p>å› ä¸º Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥èƒ½ä¿è¯åŸå­æ€§ã€‚</p>
<h3 id="41-ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#41-ä¼˜ç‚¹"></a> 4.1. ä¼˜ç‚¹</h3>
<ul>
<li>æ€§èƒ½æ¯”æ•°æ®åº“å¥½</li>
<li>èƒ½æ»¡è¶³æœ‰åºé€’å¢</li>
</ul>
<h3 id="42-ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#42-ç¼ºç‚¹"></a> 4.2. ç¼ºç‚¹</h3>
<ul>
<li>ç”±äº Redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå³ä½¿æ”¯æŒæŒä¹…åŒ–ï¼ˆAOF å’Œ RDBï¼‰ï¼Œä½†æ˜¯ä¾ç„¶å¯èƒ½ä¸¢å¤±æ•°æ®ï¼Œé€ æˆ ID é‡å¤ã€‚</li>
<li>ä¾èµ–äº Redis ç”Ÿæˆé”®ï¼Œå¦‚æœ Redis æœåŠ¡ä¸ç¨³å®šï¼Œä¼šå½±å“ ID ç”Ÿæˆã€‚</li>
</ul>
<h3 id="43-é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#43-é€‚ç”¨åœºæ™¯"></a> 4.3. é€‚ç”¨åœºæ™¯</h3>
<p>Redis æ€§èƒ½æ¯”æ•°æ®åº“å¥½ï¼Œä½†æ˜¯æœ‰å¯èƒ½ä¼šå‡ºç° ID é‡å¤å’Œä¸ç¨³å®šã€‚å¦‚æœå¯ä»¥æ¥å—ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ¡ˆã€‚</p>
<h2 id="5-é›ªèŠ±ç®—æ³•snowflake"><a class="markdownIt-Anchor" href="#5-é›ªèŠ±ç®—æ³•snowflake"></a> 5. é›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰</h2>
<p>é›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰æ˜¯ç”± Twitter å…¬å¸ƒçš„åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆç®—æ³•ï¼Œ<strong>å®ƒä¼šç”Ÿæˆä¸€ä¸ª <code>64 bit</code> çš„æ•´æ•°</strong>ï¼Œå¯ä»¥ä¿è¯ä¸åŒè¿›ç¨‹ä¸»é”®çš„ä¸é‡å¤æ€§ï¼Œä»¥åŠç›¸åŒè¿›ç¨‹ä¸»é”®çš„æœ‰åºæ€§ã€‚</p>
<p>åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå®ƒé¦–å…ˆæ˜¯é€šè¿‡æ—¶é—´ä½ä¿è¯ä¸é‡å¤ï¼Œå¦‚æœæ—¶é—´ç›¸åŒåˆ™æ˜¯é€šè¿‡åºåˆ—ä½ä¿è¯ã€‚ åŒæ—¶ç”±äºæ—¶é—´ä½æ˜¯å•è°ƒé€’å¢çš„ï¼Œä¸”å„ä¸ªæœåŠ¡å™¨å¦‚æœå¤§ä½“åšäº†æ—¶é—´åŒæ­¥ï¼Œé‚£ä¹ˆç”Ÿæˆçš„ä¸»é”®åœ¨åˆ†å¸ƒå¼ç¯å¢ƒå¯ä»¥è®¤ä¸ºæ˜¯æ€»ä½“æœ‰åºçš„ï¼Œè¿™å°±ä¿è¯äº†å¯¹ç´¢å¼•å­—æ®µçš„æ’å…¥çš„é«˜æ•ˆæ€§ã€‚</p>
<h3 id="51-åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#51-åŸºæœ¬åŸç†"></a> 5.1. åŸºæœ¬åŸç†</h3>
<h4 id="é”®çš„ç»„æˆ"><a class="markdownIt-Anchor" href="#é”®çš„ç»„æˆ"></a> é”®çš„ç»„æˆ</h4>
<p>ä½¿ç”¨<strong>é›ªèŠ±ç®—æ³•ç”Ÿæˆçš„ä¸»é”®ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼åŒ…å« 4 éƒ¨åˆ†</strong>ï¼Œä»é«˜ä½åˆ°ä½ä½åˆ†è¡¨ä¸ºï¼š1bit ç¬¦å·ä½ã€41bit æ—¶é—´æˆ³ä½ã€10bit å·¥ä½œè¿›ç¨‹ä½ä»¥åŠ 12bit åºåˆ—å·ä½ã€‚</p>
<ul>
<li><strong>ç¬¦å·ä½(1bit)</strong></li>
</ul>
<p>é¢„ç•™çš„ç¬¦å·ä½ï¼Œæ’ä¸ºé›¶ã€‚</p>
<ul>
<li><strong>æ—¶é—´æˆ³ä½(41bit)</strong></li>
</ul>
<p>41 ä½çš„æ—¶é—´æˆ³å¯ä»¥å®¹çº³çš„æ¯«ç§’æ•°æ˜¯ 2 çš„ 41 æ¬¡å¹‚ï¼Œä¸€å¹´æ‰€ä½¿ç”¨çš„æ¯«ç§’æ•°æ˜¯ï¼š<code>365 * 24 * 60 * 60 * 1000</code>ã€‚é€šè¿‡è®¡ç®—å¯çŸ¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Math.pow(<span class="number">2</span>, <span class="number">41</span>) / (<span class="number">365</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000L</span>);</span><br></pre></td></tr></table></figure>
<p>ç»“æœçº¦ç­‰äº 69.73 å¹´ã€‚ShardingSphere çš„é›ªèŠ±ç®—æ³•çš„æ—¶é—´çºªå…ƒä» 2016 å¹´ 11 æœˆ 1 æ—¥é›¶ç‚¹å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨åˆ° 2086 å¹´ï¼Œç›¸ä¿¡èƒ½æ»¡è¶³ç»å¤§éƒ¨åˆ†ç³»ç»Ÿçš„è¦æ±‚ã€‚</p>
<ul>
<li><strong>å·¥ä½œè¿›ç¨‹ä½(10bit)</strong></li>
</ul>
<p>è¯¥æ ‡å¿—åœ¨ Java è¿›ç¨‹å†…æ˜¯å”¯ä¸€çš„ï¼Œå¦‚æœæ˜¯åˆ†å¸ƒå¼åº”ç”¨éƒ¨ç½²åº”ä¿è¯æ¯ä¸ªå·¥ä½œè¿›ç¨‹çš„ id æ˜¯ä¸åŒçš„ã€‚è¯¥å€¼é»˜è®¤ä¸º 0ï¼Œå¯é€šè¿‡å±æ€§è®¾ç½®ã€‚</p>
<ul>
<li><strong>åºåˆ—å·ä½(12bit)</strong></li>
</ul>
<p>è¯¥åºåˆ—æ˜¯ç”¨æ¥åœ¨åŒä¸€ä¸ªæ¯«ç§’å†…ç”Ÿæˆä¸åŒçš„ IDã€‚å¦‚æœåœ¨è¿™ä¸ªæ¯«ç§’å†…ç”Ÿæˆçš„æ•°é‡è¶…è¿‡ 4096(2 çš„ 12 æ¬¡å¹‚)ï¼Œé‚£ä¹ˆç”Ÿæˆå™¨ä¼šç­‰å¾…åˆ°ä¸‹ä¸ªæ¯«ç§’ç»§ç»­ç”Ÿæˆã€‚</p>
<p>é›ªèŠ±ç®—æ³•ä¸»é”®çš„è¯¦ç»†ç»“æ„è§ä¸‹å›¾ï¼š</p>
<p><img src="https://shardingsphere.apache.org/document/current/img/sharding/snowflake_cn_v2.png" alt="é›ªèŠ±ç®—æ³•" /></p>
<h4 id="æ—¶é’Ÿå›æ‹¨"><a class="markdownIt-Anchor" href="#æ—¶é’Ÿå›æ‹¨"></a> æ—¶é’Ÿå›æ‹¨</h4>
<p>æœåŠ¡å™¨æ—¶é’Ÿå›æ‹¨ä¼šå¯¼è‡´äº§ç”Ÿé‡å¤åºåˆ—ï¼Œå› æ­¤é»˜è®¤åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆå™¨æä¾›äº†ä¸€ä¸ªæœ€å¤§å®¹å¿çš„æ—¶é’Ÿå›æ‹¨æ¯«ç§’æ•°ã€‚ å¦‚æœæ—¶é’Ÿå›æ‹¨çš„æ—¶é—´è¶…è¿‡æœ€å¤§å®¹å¿çš„æ¯«ç§’æ•°é˜ˆå€¼ï¼Œåˆ™ç¨‹åºæŠ¥é”™ï¼›å¦‚æœåœ¨å¯å®¹å¿çš„èŒƒå›´å†…ï¼Œé»˜è®¤åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆå™¨ä¼šç­‰å¾…æ—¶é’ŸåŒæ­¥åˆ°æœ€åä¸€æ¬¡ä¸»é”®ç”Ÿæˆçš„æ—¶é—´åå†ç»§ç»­å·¥ä½œã€‚ æœ€å¤§å®¹å¿çš„æ—¶é’Ÿå›æ‹¨æ¯«ç§’æ•°çš„é»˜è®¤å€¼ä¸º 0ï¼Œå¯é€šè¿‡å±æ€§è®¾ç½®ã€‚</p>
<h4 id="çµæ´»å®šåˆ¶"><a class="markdownIt-Anchor" href="#çµæ´»å®šåˆ¶"></a> çµæ´»å®šåˆ¶</h4>
<p>ä¸Šé¢åªæ˜¯ä¸€ä¸ªå°† <code>64bit</code> åˆ’åˆ†çš„æ ‡å‡†ï¼Œå½“ç„¶ä¹Ÿä¸ä¸€å®šè¿™ä¹ˆåšï¼Œå¯ä»¥æ ¹æ®ä¸åŒä¸šåŠ¡çš„å…·ä½“åœºæ™¯æ¥åˆ’åˆ†ï¼Œæ¯”å¦‚ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼š</p>
<ul>
<li>æœåŠ¡ç›®å‰ QPS10 ä¸‡ï¼Œé¢„è®¡å‡ å¹´ä¹‹å†…ä¼šå‘å±•åˆ°ç™¾ä¸‡ã€‚</li>
<li>å½“å‰æœºå™¨ä¸‰åœ°éƒ¨ç½²ï¼Œä¸Šæµ·ï¼ŒåŒ—äº¬ï¼Œæ·±åœ³éƒ½æœ‰ã€‚</li>
<li>å½“å‰æœºå™¨ 10 å°å·¦å³ï¼Œé¢„è®¡æœªæ¥ä¼šå¢åŠ è‡³ç™¾å°ã€‚</li>
</ul>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ ¹æ®ä¸Šé¢çš„åœºæ™¯å¯ä»¥å†æ¬¡åˆç†çš„åˆ’åˆ† 62bitï¼ŒQPS å‡ å¹´ä¹‹å†…ä¼šå‘å±•åˆ°ç™¾ä¸‡ï¼Œé‚£ä¹ˆæ¯æ¯«ç§’å°±æ˜¯åƒçº§çš„è¯·æ±‚ï¼Œç›®å‰ 10 å°æœºå™¨é‚£ä¹ˆæ¯å°æœºå™¨æ‰¿æ‹…ç™¾çº§çš„è¯·æ±‚ï¼Œä¸ºäº†ä¿è¯æ‰©å±•ï¼Œåé¢çš„å¾ªç¯ä½å¯ä»¥é™åˆ¶åˆ° 1024ï¼Œä¹Ÿå°±æ˜¯ 2^10ï¼Œé‚£ä¹ˆå¾ªç¯ä½ 10 ä½å°±è¶³å¤Ÿäº†ã€‚</p>
<p>æœºå™¨ä¸‰åœ°éƒ¨ç½²æˆ‘ä»¬å¯ä»¥ç”¨ 3bit æ€»å…± 8 æ¥è¡¨ç¤ºæœºæˆ¿ä½ç½®ï¼Œå½“å‰çš„æœºå™¨ 10 å°ï¼Œä¸ºäº†ä¿è¯æ‰©å±•åˆ°ç™¾å°é‚£ä¹ˆå¯ä»¥ç”¨ 7bit 128 æ¥è¡¨ç¤ºï¼Œæ—¶é—´ä½ä¾ç„¶æ˜¯ 41bitï¼Œé‚£ä¹ˆè¿˜å‰©ä¸‹ 64-10-3-7-41-1 = 2bitï¼Œè¿˜å‰©ä¸‹ 2bit å¯ä»¥ç”¨æ¥è¿›è¡Œæ‰©å±•ã€‚</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/9/29/16624909d2007c22?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="" /></p>
<h3 id="52-ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#52-ä¼˜ç‚¹"></a> 5.2. ä¼˜ç‚¹</h3>
<ul>
<li>ç”Ÿæˆçš„ ID éƒ½æ˜¯è¶‹åŠ¿é€’å¢çš„ã€‚</li>
<li>ä¸ä¾èµ–æ•°æ®åº“ç­‰ç¬¬ä¸‰æ–¹ç³»ç»Ÿï¼Œä»¥æœåŠ¡çš„æ–¹å¼éƒ¨ç½²ï¼Œç¨³å®šæ€§æ›´é«˜ï¼Œç”Ÿæˆ ID çš„æ€§èƒ½ä¹Ÿæ˜¯éå¸¸é«˜çš„ã€‚</li>
<li>å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹æ€§åˆ†é… bit ä½ï¼Œéå¸¸çµæ´»ã€‚</li>
</ul>
<h3 id="53-ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#53-ç¼ºç‚¹"></a> 5.3. ç¼ºç‚¹</h3>
<ul>
<li>å¼ºä¾èµ–æœºå™¨æ—¶é’Ÿï¼Œå¦‚æœæœºå™¨ä¸Šæ—¶é’Ÿå›æ‹¨ï¼Œä¼šå¯¼è‡´å‘å·é‡å¤æˆ–è€…æœåŠ¡ä¼šå¤„äºä¸å¯ç”¨çŠ¶æ€ã€‚</li>
</ul>
<h3 id="54-é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#54-é€‚ç”¨åœºæ™¯"></a> 5.4. é€‚ç”¨åœºæ™¯</h3>
<p>å½“æˆ‘ä»¬éœ€è¦æ— åºä¸èƒ½è¢«çŒœæµ‹çš„ IDï¼Œå¹¶ä¸”éœ€è¦ä¸€å®šé«˜æ€§èƒ½ï¼Œä¸”éœ€è¦ long å‹ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬é›ªèŠ±ç®—æ³•ã€‚æ¯”å¦‚å¸¸è§çš„è®¢å• IDï¼Œç”¨é›ªèŠ±ç®—æ³•åˆ«äººå°±æ— æ³•çŒœæµ‹ä½ æ¯å¤©çš„è®¢å•é‡æ˜¯å¤šå°‘ã€‚</p>
<h3 id="55-é˜²æ­¢æ—¶é’Ÿå›æ‹¨"><a class="markdownIt-Anchor" href="#55-é˜²æ­¢æ—¶é’Ÿå›æ‹¨"></a> 5.5. é˜²æ­¢æ—¶é’Ÿå›æ‹¨</h3>
<p>é›ªèŠ±ç®—æ³•æ˜¯å¼ºä¾èµ–äºæ—¶é—´çš„ï¼Œè€Œå¦‚æœæœºå™¨æ—¶é—´å‘ç”Ÿå›æ‹¨ï¼Œæœ‰å¯èƒ½ä¼šç”Ÿæˆé‡å¤çš„ IDã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é’ˆå¯¹ç®—æ³•åšä¸€äº›ä¼˜åŒ–ï¼Œæ¥é˜²æ­¢æ—¶é’Ÿå›æ‹¨ç”Ÿæˆé‡å¤ IDã€‚</p>
<p>ç”¨å½“å‰æ—¶é—´å’Œä¸Šä¸€æ¬¡çš„æ—¶é—´è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ—¶é—´å°äºä¸Šä¸€æ¬¡çš„æ—¶é—´é‚£ä¹ˆè‚¯å®šæ˜¯å‘ç”Ÿäº†å›æ‹¨ã€‚æ™®é€šçš„ç®—æ³•ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œä¼˜åŒ–ï¼Œä¸€èˆ¬åˆ†ä¸ºä¸¤ä¸ªæƒ…å†µ:</p>
<ul>
<li>å¦‚æœæ—¶é—´å›æ‹¨æ—¶é—´è¾ƒçŸ­ï¼Œæ¯”å¦‚é…ç½® <code>5ms</code> ä»¥å†…ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼Œè®©æœºå™¨çš„æ—¶é—´è¿½ä¸Šæ¥ã€‚</li>
<li>å¦‚æœæ—¶é—´çš„å›æ‹¨æ—¶é—´è¾ƒé•¿ï¼Œæˆ‘ä»¬ä¸èƒ½æ¥å—è¿™ä¹ˆé•¿çš„é˜»å¡ç­‰å¾…ï¼Œé‚£ä¹ˆåˆæœ‰ä¸¤ä¸ªç­–ç•¥:
<ul>
<li>ç›´æ¥æ‹’ç»ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚æ‰“æ—¥å¿—ï¼Œé€šçŸ¥ RD æ—¶é’Ÿå›æ»šã€‚</li>
<li>åˆ©ç”¨æ‰©å±•ä½ã€‚ä¸Šé¢æˆ‘ä»¬è®¨è®ºè¿‡ï¼Œä¸åŒä¸šåŠ¡åœºæ™¯ä½æ•°å¯èƒ½ç”¨ä¸åˆ°é‚£ä¹ˆå¤šæ¯”ç‰¹ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠæ‰©å±•ä½æ•°åˆ©ç”¨èµ·æ¥ã€‚æ¯”å¦‚ï¼šå½“è¿™ä¸ªæ—¶é—´å›æ‹¨æ¯”è¾ƒé•¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸éœ€è¦ç­‰å¾…ï¼Œç›´æ¥åœ¨æ‰©å±•ä½åŠ  1ã€‚ä¸¤ä½çš„æ‰©å±•ä½å…è®¸æˆ‘ä»¬æœ‰ä¸‰æ¬¡å¤§çš„æ—¶é’Ÿå›æ‹¨ï¼Œä¸€èˆ¬æ¥è¯´å°±å¤Ÿäº†ï¼Œå¦‚æœå…¶è¶…è¿‡ä¸‰æ¬¡æˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©æŠ›å‡ºå¼‚å¸¸ï¼Œæ‰“æ—¥å¿—ã€‚</li>
</ul>
</li>
</ul>
<h2 id="6-leaf"><a class="markdownIt-Anchor" href="#6-leaf"></a> 6. Leaf</h2>
<blockquote>
<p>ç¾å›¢æä¾›äº†ä¸€ç§åˆ†å¸ƒå¼ ID è§£å†³æ–¹æ¡ˆ Leafï¼Œå…¶æœ¬è´¨å¯ä»¥è§†ä¸ºæ•°æ®åº“åˆ†æ®µ+æœåŠ¡ç¼“å­˜ IDã€‚</p>
<p>è¯¦æƒ…å¯ä»¥å‚è€ƒ <a href="https://tech.meituan.com/2017/04/21/mt-leaf.html" target="_blank" rel="noopener">Leafâ€”â€”ç¾å›¢ç‚¹è¯„åˆ†å¸ƒå¼ ID ç”Ÿæˆç³»ç»Ÿ</a></p>
</blockquote>
<h3 id="61-åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#61-åŸºæœ¬åŸç†"></a> 6.1. åŸºæœ¬åŸç†</h3>
<p>ä½¿ç”¨æ•°æ®åº“ç”Ÿæˆ IDï¼Œä½†æ˜¯åšäº†å¦‚ä¸‹æ”¹è¿›ï¼š</p>
<p>åŸæ–¹æ¡ˆæ¯æ¬¡è·å– ID éƒ½å¾—è¯»å†™ä¸€æ¬¡æ•°æ®åº“ï¼Œé€ æˆæ•°æ®åº“å‹åŠ›å¤§ã€‚æ”¹ä¸ºåˆ©ç”¨ proxy server æ‰¹é‡è·å–ï¼Œæ¯æ¬¡è·å–ä¸€ä¸ª segment(step å†³å®šå¤§å°)å·æ®µçš„å€¼ã€‚ç”¨å®Œä¹‹åå†å»æ•°æ®åº“è·å–æ–°çš„å·æ®µï¼Œå¯ä»¥å¤§å¤§çš„å‡è½»æ•°æ®åº“çš„å‹åŠ›ã€‚ - å„ä¸ªä¸šåŠ¡ä¸åŒçš„å‘å·éœ€æ±‚ç”¨ biz_tag å­—æ®µæ¥åŒºåˆ†ï¼Œæ¯ä¸ª biz-tag çš„ ID è·å–ç›¸äº’éš”ç¦»ï¼Œäº’ä¸å½±å“ã€‚å¦‚æœä»¥åæœ‰æ€§èƒ½éœ€æ±‚éœ€è¦å¯¹æ•°æ®åº“æ‰©å®¹ï¼Œä¸éœ€è¦ä¸Šè¿°æè¿°çš„å¤æ‚çš„æ‰©å®¹æ“ä½œï¼Œåªéœ€è¦å¯¹ biz_tag åˆ†åº“åˆ†è¡¨å°±è¡Œã€‚</p>
<p>æ•°æ®åº“è¡¨è®¾è®¡å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">+<span class="comment">-------------+--------------+------+-----+-------------------+-----------------------------+</span></span><br><span class="line">| Field       | Type         | Null | Key | Default           | Extra                       |</span><br><span class="line">+<span class="comment">-------------+--------------+------+-----+-------------------+-----------------------------+</span></span><br><span class="line">| biz_tag     | varchar(128) | NO   | PRI |                   |                             |</span><br><span class="line">| max_id      | bigint(20)   | NO   |     | 1                 |                             |</span><br><span class="line">| step        | int(11)      | NO   |     | NULL              |                             |</span><br><span class="line">| desc        | varchar(256) | YES  |     | NULL              |                             |</span><br><span class="line">| update_time | timestamp    | NO   |     | CURRENT_TIMESTAMP | on <span class="keyword">update</span> <span class="keyword">CURRENT_TIMESTAMP</span> |</span><br><span class="line">+<span class="comment">-------------+--------------+------+-----+-------------------+-----------------------------+</span></span><br></pre></td></tr></table></figure>
<p>é‡è¦å­—æ®µè¯´æ˜ï¼š</p>
<ul>
<li><code>biz_tag</code> ç”¨æ¥åŒºåˆ†ä¸šåŠ¡</li>
<li><code>max_id</code> è¡¨ç¤ºè¯¥ <code>biz_tag</code> ç›®å‰æ‰€è¢«åˆ†é…çš„ ID å·æ®µçš„æœ€å¤§å€¼</li>
<li><code>step</code> è¡¨ç¤ºæ¯æ¬¡åˆ†é…çš„å·æ®µé•¿åº¦ã€‚åŸæ¥è·å– ID æ¯æ¬¡éƒ½éœ€è¦å†™æ•°æ®åº“ï¼Œç°åœ¨åªéœ€è¦æŠŠ <code>step</code> è®¾ç½®å¾—è¶³å¤Ÿå¤§ï¼Œæ¯”å¦‚ 1000ã€‚é‚£ä¹ˆåªæœ‰å½“ 1000 ä¸ªå·è¢«æ¶ˆè€—å®Œäº†ä¹‹åæ‰ä¼šå»é‡æ–°è¯»å†™ä¸€æ¬¡æ•°æ®åº“ã€‚è¯»å†™æ•°æ®åº“çš„é¢‘ç‡ä» 1 å‡å°åˆ°äº† 1/stepã€‚</li>
</ul>
<p>å¤§è‡´æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://awps-assets.meituan.net/mit-x/blog-images-bundle-2017/5e4ff128.png" alt="image" /></p>
<p>test_tag åœ¨ç¬¬ä¸€å° Leaf æœºå™¨ä¸Šæ˜¯ <code>1~1000</code> çš„å·æ®µï¼Œå½“è¿™ä¸ªå·æ®µç”¨å®Œæ—¶ï¼Œä¼šå»åŠ è½½å¦ä¸€ä¸ªé•¿åº¦ä¸º step=1000 çš„å·æ®µï¼Œå‡è®¾å¦å¤–ä¸¤å°å·æ®µéƒ½æ²¡æœ‰æ›´æ–°ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬ä¸€å°æœºå™¨æ–°åŠ è½½çš„å·æ®µå°±åº”è¯¥æ˜¯ <code>3001~4000</code>ã€‚åŒæ—¶æ•°æ®åº“å¯¹åº”çš„ biz_tag è¿™æ¡æ•°æ®çš„ max_id ä¼šä» 3000 è¢«æ›´æ–°æˆ 4000ï¼Œæ›´æ–°å·æ®µçš„ SQL è¯­å¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Begin</span></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">table</span> <span class="keyword">SET</span> max_id=max_id+step <span class="keyword">WHERE</span> biz_tag=xxx</span><br><span class="line"><span class="keyword">SELECT</span> tag, max_id, step <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">WHERE</span> biz_tag=xxx</span><br><span class="line"><span class="keyword">Commit</span></span><br></pre></td></tr></table></figure>
<h3 id="62-ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#62-ä¼˜ç‚¹"></a> 6.2. ä¼˜ç‚¹</h3>
<ul>
<li>æ¯”æ•°æ®åº“è‡ªå¢é”®æ€§èƒ½é«˜</li>
<li>èƒ½ä¿è¯é”®è¶‹åŠ¿é€’å¢ã€‚</li>
<li>å¦‚æœæ•°æ®åº“å®•æœºï¼Œç”±äº proxServer æœ‰ç¼“å­˜ï¼Œä¾ç„¶å¯ä»¥åšæŒä¸€æ®µæ—¶é—´ã€‚</li>
</ul>
<h3 id="63-ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#63-ç¼ºç‚¹"></a> 6.3. ç¼ºç‚¹</h3>
<ul>
<li>å’Œä¸»é”®é€’å¢ä¸€æ ·ï¼Œå®¹æ˜“è¢«äººçŒœæµ‹ã€‚</li>
<li>æ•°æ®åº“å®•æœºåï¼Œè™½ç„¶èƒ½æ”¯æ’‘ä¸€æ®µæ—¶é—´ï¼Œä½†æ˜¯ä»ç„¶ä¼šé€ æˆç³»ç»Ÿä¸å¯ç”¨ã€‚</li>
</ul>
<h3 id="64-é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#64-é€‚ç”¨åœºæ™¯"></a> 6.4. é€‚ç”¨åœºæ™¯</h3>
<p>éœ€è¦è¶‹åŠ¿é€’å¢ï¼Œå¹¶ä¸” ID å¤§å°å¯æ§åˆ¶çš„ï¼Œå¯ä»¥ä½¿ç”¨è¿™å¥—æ–¹æ¡ˆã€‚</p>
<p>å½“ç„¶è¿™ä¸ªæ–¹æ¡ˆä¹Ÿå¯ä»¥é€šè¿‡ä¸€äº›æ‰‹æ®µé¿å…è¢«äººçŒœæµ‹ï¼ŒæŠŠ ID å˜æˆæ˜¯æ— åºçš„ï¼Œæ¯”å¦‚æŠŠæˆ‘ä»¬ç”Ÿæˆçš„æ•°æ®æ˜¯ä¸€ä¸ªé€’å¢çš„ long å‹ï¼ŒæŠŠè¿™ä¸ª Long åˆ†æˆå‡ ä¸ªéƒ¨åˆ†ï¼Œæ¯”å¦‚å¯ä»¥åˆ†æˆå‡ ç»„ä¸‰ä½æ•°ï¼Œå‡ ç»„å››ä½æ•°ï¼Œç„¶ååœ¨å»ºç«‹ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œå°†æˆ‘ä»¬çš„æ•°æ®å˜æˆæ— åºã€‚</p>
<h2 id="7-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#7-å‚è€ƒèµ„æ–™"></a> 7. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://github.com/baidu/uid-generator/blob/master/README.zh_cn.md" target="_blank" rel="noopener">ç™¾åº¦åˆ†å¸ƒå¼ ID</a></li>
<li><a href="https://juejin.im/post/5bb0217ef265da0ac2567b42" target="_blank" rel="noopener">å¦‚æœå†æœ‰äººé—®ä½ åˆ†å¸ƒå¼ IDï¼Œè¿™ç¯‡æ–‡ç« ä¸¢ç»™ä»–</a></li>
<li><a href="https://segmentfault.com/a/1190000011282426" target="_blank" rel="noopener">ç†è§£åˆ†å¸ƒå¼ id ç”Ÿæˆç®—æ³• SnowFlake</a></li>
<li><a href="https://tech.meituan.com/2017/04/21/mt-leaf.html" target="_blank" rel="noopener">Leafâ€”â€”ç¾å›¢ç‚¹è¯„åˆ†å¸ƒå¼ ID ç”Ÿæˆç³»ç»Ÿ</a></li>
<li><a href="https://www.ietf.org/rfc/rfc4122.txt" target="_blank" rel="noopener">UUID è§„èŒƒ</a></li>
<li><a href="https://shardingsphere.apache.org/document/current/cn/features/sharding/other-features/key-generator/" target="_blank" rel="noopener">ShardingSphere åˆ†å¸ƒå¼ä¸»é”®</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>åˆ†å¸ƒå¼ ID</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/mq-theory/</url>
    <content><![CDATA[<h1 id="æ¶ˆæ¯é˜Ÿåˆ—åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#æ¶ˆæ¯é˜Ÿåˆ—åŸºæœ¬åŸç†"></a> æ¶ˆæ¯é˜Ÿåˆ—åŸºæœ¬åŸç†</h1>
<blockquote>
<p>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼Œç®€ç§° MQï¼‰æŠ€æœ¯æ˜¯åˆ†å¸ƒå¼åº”ç”¨é—´äº¤æ¢ä¿¡æ¯çš„ä¸€ç§æŠ€æœ¯ã€‚</p>
<p>æ¶ˆæ¯é˜Ÿåˆ—ä¸»è¦è§£å†³åº”ç”¨è€¦åˆï¼Œå¼‚æ­¥æ¶ˆæ¯ï¼Œæµé‡å‰Šé”‹ç­‰é—®é¢˜ï¼Œå®ç°é«˜æ€§èƒ½ï¼Œé«˜å¯ç”¨ï¼Œå¯ä¼¸ç¼©å’Œæœ€ç»ˆä¸€è‡´æ€§æ¶æ„ã€‚æ˜¯å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯ç¼ºå°‘çš„ä¸­é—´ä»¶ã€‚</p>
<p>æ³¨æ„ï¼š<em>ä¸ºäº†ç®€ä¾¿ï¼Œä¸‹æ–‡ä¸­é™¤äº†æ–‡ç« æ ‡é¢˜ï¼Œä¸€å¾‹ä½¿ç”¨ MQ ç®€ç§°</em>ã€‚</p>
</blockquote>
<h2 id="1-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-mq"><a class="markdownIt-Anchor" href="#1-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-mq"></a> 1. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ MQ</h2>
<p>MQ æ¯”è¾ƒæ ¸å¿ƒçš„ä¼˜ç‚¹æœ‰ 3 ä¸ªï¼š<strong>è§£è€¦</strong>ã€<strong>å¼‚æ­¥</strong>ã€<strong>å‰Šå³°</strong>ã€‚</p>
<h3 id="11-è§£è€¦"><a class="markdownIt-Anchor" href="#11-è§£è€¦"></a> 1.1. è§£è€¦</h3>
<p>ä¸åŒç³»ç»Ÿå¦‚æœè¦å»ºç«‹é€šä¿¡ï¼Œä¼ ç»Ÿçš„åšæ³•æ˜¯ï¼šè°ƒç”¨æ¥å£ã€‚</p>
<p>å¦‚æœéœ€è¦å’Œæ–°çš„ç³»ç»Ÿå»ºç«‹é€šä¿¡æˆ–åˆ é™¤å·²å»ºç«‹çš„é€šä¿¡ï¼Œéƒ½éœ€è¦ä¿®æ”¹ä»£ç ï¼Œè¿™ç§æ–¹æ¡ˆæ˜¾ç„¶è€¦åˆåº¦å¾ˆé«˜ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/theory/mq/mq_1.png" alt="" /></p>
<p>å¦‚æœä½¿ç”¨ MQï¼Œç³»ç»Ÿé—´çš„é€šä¿¡åªéœ€è¦é€šè¿‡å‘å¸ƒ/è®¢é˜…ï¼ˆPub/Subï¼‰æ¨¡å‹å³å¯ï¼Œå½¼æ­¤æ²¡æœ‰ç›´æ¥è”ç³»ï¼Œä¹Ÿå°±ä¸éœ€è¦ç›¸äº’æ„ŸçŸ¥ï¼Œä»è€Œè¾¾åˆ° <strong>è§£è€¦</strong>ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/theory/mq/mq_2.png" alt="" /></p>
<h3 id="12-å¼‚æ­¥"><a class="markdownIt-Anchor" href="#12-å¼‚æ­¥"></a> 1.2. å¼‚æ­¥</h3>
<p>å‡è®¾è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œç”¨æˆ·å‘ç³»ç»Ÿ A å‘èµ·è¯·æ±‚ï¼Œç³»ç»Ÿ A å¤„ç†è®¡ç®—åªéœ€è¦ 10 msï¼Œç„¶åé€šçŸ¥ç³»ç»Ÿ BCD å†™åº“ï¼Œç³»ç»Ÿ BCD å†™åº“è€—æ—¶åˆ†åˆ«ä¸ºï¼š100msã€200msã€300msã€‚æœ€ç»ˆæ€»è€—æ—¶ä¸ºï¼š 10+100ms+200ms+300ms=610msã€‚æ­¤å¤–ï¼ŒåŠ ä¸Šè¯·æ±‚å’Œå“åº”çš„ç½‘ç»œä¼ è¾“æ—¶é—´ï¼Œä»ç”¨æˆ·è§’åº¦çœ‹ï¼Œå¯èƒ½è¦ç­‰å¾…å°†è¿‘ 1s æ‰èƒ½å¾—åˆ°ç»“æœã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/theory/mq/mq_3.png" alt="" /></p>
<p>å¦‚æœä½¿ç”¨ MQï¼Œç³»ç»Ÿ A æ¥åˆ°è¯·æ±‚åï¼Œè€—æ—¶ 10ms å¤„ç†è®¡ç®—ï¼Œç„¶åå‘ç³»ç»Ÿ BCD è¿ç»­å‘é€æ¶ˆæ¯ï¼Œå‡è®¾è€—æ—¶ 5msã€‚é‚£ä¹ˆ è¿™ä¸€è¿‡ç¨‹çš„æ€»è€—æ—¶ä¸º 3ms + 5ms = 8msï¼Œè¿™ç›¸æ¯”äº 610 msï¼Œå¤§å¤§ç¼©çŸ­äº†å“åº”æ—¶é—´ã€‚è‡³äºç³»ç»Ÿ BCD çš„å†™åº“æ“ä½œï¼Œåªè¦è‡ªè¡Œæ¶ˆè´¹ MQ åå¤„ç†å³å¯ï¼Œç”¨æˆ·æ— éœ€å…³æ³¨ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/theory/mq/mq_4.png" alt="" /></p>
<h3 id="13-å‰Šå³°"><a class="markdownIt-Anchor" href="#13-å‰Šå³°"></a> 1.3. å‰Šå³°</h3>
<p>å‡è®¾æŸä¸ªç³»ç»Ÿè¯»å†™æ•°æ®åº“çš„ç¨³å®šæ€§èƒ½ä¸ºæ¯ç§’å¤„ç† 1000 æ¡æ•°æ®ã€‚å¹³å¸¸æƒ…å†µä¸‹ï¼Œè¿œè¿œè¾¾ä¸åˆ°è¿™ä¹ˆå¤§çš„å¤„ç†é‡ã€‚å‡è®¾ï¼Œå› ä¸ºå› ä¸ºåšæ´»åŠ¨ï¼Œç³»ç»Ÿçš„ç¬æ—¶è¯·æ±‚é‡å‰§å¢ï¼Œè¾¾åˆ°æ¯ç§’ 10000 ä¸ªå¹¶å‘è¯·æ±‚ï¼Œæ•°æ®åº“æ ¹æœ¬æ‰¿å—ä¸äº†ï¼Œå¯èƒ½ç›´æ¥å°±æŠŠæ•°æ®åº“ç»™æ•´å´©æºƒäº†ï¼Œè¿™æ ·ç³»ç»ŸæœåŠ¡å°±ä¸å¯ç”¨äº†ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/theory/mq/mq_5.png" alt="" /></p>
<p>å¦‚æœä½¿ç”¨ MQï¼Œæ¯ç§’å†™å…¥ 10000 æ¡è¯·æ±‚ï¼Œä½†æ˜¯ç³»ç»Ÿ A æ¯ç§’åªä» MQ ä¸­æ¶ˆè´¹ 1000 æ¡è¯·æ±‚ï¼Œç„¶åå†™å…¥æ•°æ®åº“ã€‚è¿™æ ·ï¼Œå°±ä¸ä¼šè¶…è¿‡æ•°æ®åº“çš„æ‰¿å—èƒ½åŠ›ï¼Œè€Œæ˜¯æŠŠè¯·æ±‚ç§¯å‹åœ¨ MQ ä¸­ã€‚åªè¦é«˜å³°æœŸä¸€è¿‡ï¼Œç³»ç»Ÿ A å°±ä¼šå¾ˆå¿«æŠŠç§¯å‹çš„æ¶ˆæ¯ç»™å¤„ç†æ‰ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/theory/mq/mq_6.png" alt="" /></p>
<h2 id="2-mq-å¼•å…¥çš„é—®é¢˜"><a class="markdownIt-Anchor" href="#2-mq-å¼•å…¥çš„é—®é¢˜"></a> 2. MQ å¼•å…¥çš„é—®é¢˜</h2>
<p>å‡¡äº‹æœ‰åˆ©æœ‰å¼Šï¼Œä½¿ç”¨ MQ ç»™ç³»ç»Ÿå¸¦æ¥å¾ˆå¤šå¥½å¤„ï¼Œä¹Ÿä¼šä»˜å‡ºä¸€å®šçš„ä»£ä»·ã€‚</p>
<p>å®ƒå¼•å…¥äº†ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li><strong>ç³»ç»Ÿå¯ç”¨æ€§é™ä½</strong> - å¼•å…¥äº† MQ åï¼Œé€šä¿¡éœ€è¦åŸºäº MQ å®Œæˆï¼Œå¦‚æœ MQ å®•æœºï¼Œåˆ™æœåŠ¡ä¸å¯ç”¨ã€‚å› æ­¤ï¼ŒMQ è¦ä¿è¯æ˜¯é«˜å¯ç”¨çš„ï¼Œè¯¦æƒ…å‚è€ƒï¼š<a href="#MQ-%E7%9A%84%E9%AB%98%E5%8F%AF%E7%94%A8">MQ çš„é«˜å¯ç”¨</a></li>
<li><strong>ç³»ç»Ÿå¤æ‚åº¦æé«˜</strong> - ä½¿ç”¨ MQï¼Œéœ€è¦å…³æ³¨ä¸€äº›æ–°çš„é—®é¢˜ï¼š
<ul>
<li>å¦‚ä½•ä¿è¯æ¶ˆæ¯æ²¡æœ‰é‡å¤æ¶ˆè´¹ï¼Ÿ</li>
<li>å¦‚ä½•å¤„ç†æ¶ˆæ¯ä¸¢å¤±çš„é—®é¢˜ï¼Ÿ</li>
<li>å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¼ é€’çš„é¡ºåºæ€§ï¼Ÿ</li>
<li>å¦‚ä½•å¤„ç†å¤§é‡æ¶ˆæ¯ç§¯å‹çš„é—®é¢˜ï¼Ÿ</li>
</ul>
</li>
<li><strong>ä¸€è‡´æ€§é—®é¢˜</strong> - å‡è®¾ç³»ç»Ÿ A å¤„ç†å®Œç›´æ¥è¿”å›æˆåŠŸçš„ç»“æœç»™ç”¨æˆ·ï¼Œç”¨æˆ·è®¤ä¸ºè¯·æ±‚æˆåŠŸã€‚ä½†å¦‚æœæ­¤æ—¶ï¼Œç³»ç»Ÿ BCD ä¸­åªè¦æœ‰ä»»æ„ä¸€ä¸ªå†™åº“å¤±è´¥ï¼Œé‚£ä¹ˆæ•°æ®å°±ä¸ä¸€è‡´äº†ã€‚è¿™ç§æƒ…å†µå¦‚ä½•å¤„ç†ï¼Ÿ</li>
</ul>
<h3 id="21-é‡å¤æ¶ˆè´¹"><a class="markdownIt-Anchor" href="#21-é‡å¤æ¶ˆè´¹"></a> 2.1. é‡å¤æ¶ˆè´¹</h3>
<p><strong>å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹</strong> å’Œ <strong>å¦‚ä½•ä¿è¯æ¶ˆæ¯æ¶ˆè´¹çš„å¹‚ç­‰æ€§</strong> æ˜¯åŒä¸€ä¸ªé—®é¢˜ã€‚</p>
<p>å¿…é¡»å…ˆæ˜ç¡®äº§ç”Ÿé‡å¤æ¶ˆè´¹çš„åŸå› ï¼Œæ‰èƒ½å¯¹ç—‡ä¸‹è¯ã€‚</p>
<h4 id="211-é‡å¤æ¶ˆè´¹é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#211-é‡å¤æ¶ˆè´¹é—®é¢˜åŸå› "></a> 2.1.1. é‡å¤æ¶ˆè´¹é—®é¢˜åŸå› </h4>
<p>é‡å¤æ¶ˆè´¹é—®é¢˜é€šå¸¸ä¸æ˜¯ MQ æ¥å¤„ç†ï¼Œè€Œæ˜¯ç”±å¼€å‘æ¥å¤„ç†çš„ã€‚</p>
<p>ä»¥ Kafka ä¸¾ä¾‹ï¼šKafka æ¯ä¸ª Partition éƒ½æ˜¯ä¸€ä¸ªæœ‰åºçš„ã€ä¸å¯å˜çš„è®°å½•åºåˆ—ï¼Œä¸æ–­è¿½åŠ åˆ°ç»“æ„åŒ–çš„æäº¤æ—¥å¿—ä¸­ã€‚Partition ä¸­çš„è®°å½•æ¯ä¸ªåˆ†é…ä¸€ä¸ªè¿ç»­çš„ id å·ï¼Œç§°ä¸ºåç§»é‡ï¼ˆOffsetï¼‰ï¼Œç”¨äºå”¯ä¸€æ ‡è¯† Partition å†…çš„æ¯æ¡è®°å½•ã€‚</p>
<p><img src="http://kafka.apachecn.org/10/images/log_consumer.png" alt="" /></p>
<p>Kafka çš„å®¢æˆ·ç«¯å’Œ Broker éƒ½ä¼šä¿å­˜ Offsetã€‚å®¢æˆ·ç«¯æ¶ˆè´¹æ¶ˆæ¯åï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œå°±æŠŠå·²æ¶ˆè´¹çš„ Offset æäº¤ç»™ Kafka Brokerï¼Œè¡¨ç¤ºå·²æ¶ˆè´¹ã€‚</p>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå®¢æˆ·ç«¯åº”ç”¨æ¶ˆè´¹æ¶ˆæ¯åï¼Œå› ä¸ºå®•æœºã€é‡å¯ç­‰æƒ…å†µè€Œæ²¡æœ‰æäº¤å·²æ¶ˆè´¹çš„ Offset ã€‚å½“ç³»ç»Ÿæ¢å¤åï¼Œä¼šç»§ç»­æ¶ˆè´¹æ¶ˆæ¯ï¼Œç”±äº Offset æœªæäº¤ï¼Œå°±ä¼šå‡ºç°é‡å¤æ¶ˆè´¹çš„é—®é¢˜ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/3101171-75abe308f9cf21f8.png" alt="" /></p>
<h4 id="212-é‡å¤æ¶ˆè´¹è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#212-é‡å¤æ¶ˆè´¹è§£å†³æ–¹æ¡ˆ"></a> 2.1.2. é‡å¤æ¶ˆè´¹è§£å†³æ–¹æ¡ˆ</h4>
<p>åº”å¯¹é‡å¤æ¶ˆè´¹é—®é¢˜ï¼Œå°±è¦é€šè¿‡å¹‚ç­‰æ€§æ¥è§£å†³ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜å¯ä»¥ä»ä¸šåŠ¡å±‚é¢æ¥è§£å†³ã€‚</p>
<p>MQ é‡å¤æ¶ˆè´¹ä¸å¯æ€•ï¼Œå¯æ€•çš„æ˜¯æ²¡æœ‰åº”å¯¹æœºåˆ¶ï¼Œå¯ä»¥å€Ÿé‰´çš„æ€è·¯æœ‰ï¼š</p>
<ul>
<li>å¦‚æœæ˜¯å†™åº“ï¼Œå¯ä»¥å…ˆæ ¹æ®ä¸»é”®æŸ¥è¯¢ï¼Œåˆ¤æ–­æ•°æ®æ˜¯å¦å·²å­˜åœ¨ï¼Œå­˜åœ¨åˆ™æ›´æ–°ï¼Œä¸å­˜åœ¨åˆ™æ’å…¥ï¼›</li>
<li>å¦‚æœæ˜¯å†™ Redisï¼Œset æ“ä½œï¼Œç”±äºå¤©ç„¶å…·æœ‰å¹‚ç­‰æ€§ï¼Œå¤§å¯æ”¾å¿ƒï¼›</li>
<li>å¦‚æœæ˜¯æ ¹æ®æ¶ˆæ¯åšè¾ƒå¤æ‚çš„é€»è¾‘å¤„ç†ï¼Œå¯ä»¥åœ¨æ¶ˆæ¯ä¸­åŠ å…¥å…¨å±€å”¯ä¸€ IDï¼Œä¾‹å¦‚ï¼šè®¢å• ID ç­‰ã€‚åœ¨å®¢æˆ·ç«¯å­˜å‚¨ä¸­ï¼ˆMysqlã€Redis ç­‰ï¼‰ä¿å­˜å·²æ¶ˆè´¹æ¶ˆæ¯çš„ IDã€‚ä¸€æ—¦æ¥å—åˆ°æ–°æ¶ˆæ¯ï¼Œå…ˆåˆ¤æ–­æ¶ˆæ¯ä¸­çš„ ID æ˜¯å¦åœ¨å·²æ¶ˆè´¹æ¶ˆæ¯ ID è¡¨ä¸­å­˜åœ¨ï¼Œå­˜åœ¨åˆ™ä¸å†å¤„ç†ï¼Œä¸å­˜åœ¨åˆ™å¤„ç†ã€‚</li>
</ul>
<h3 id="22-æ¶ˆæ¯ä¸¢å¤±"><a class="markdownIt-Anchor" href="#22-æ¶ˆæ¯ä¸¢å¤±"></a> 2.2. æ¶ˆæ¯ä¸¢å¤±</h3>
<p><strong>å¦‚ä½•å¤„ç†æ¶ˆæ¯ä¸¢å¤±çš„é—®é¢˜</strong> å’Œ <strong>å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹</strong> æ˜¯åŒä¸€ä¸ªé—®é¢˜ã€‚å…³æ³¨ç‚¹æœ‰æŒ‰ä¸ªï¼š</p>
<ul>
<li>Kafka ä¸¢å¤±æ•°æ®</li>
<li>æ¶ˆè´¹æ–¹ä¸¢å¤±æ•°æ®</li>
<li>ç”Ÿäº§æ–¹ä¸¢å¤±æ•°æ®</li>
</ul>
<h4 id="221-æ¶ˆè´¹æ–¹ä¸¢å¤±æ•°æ®"><a class="markdownIt-Anchor" href="#221-æ¶ˆè´¹æ–¹ä¸¢å¤±æ•°æ®"></a> 2.2.1. æ¶ˆè´¹æ–¹ä¸¢å¤±æ•°æ®</h4>
<p>å”¯ä¸€å¯èƒ½å¯¼è‡´æ¶ˆè´¹æ–¹ä¸¢å¤±æ•°æ®çš„æƒ…å†µï¼Œå°±æ˜¯ï¼šæ¶ˆè´¹æ–¹è®¾ç½®äº†<strong>è‡ªåŠ¨æäº¤ Offset</strong>ã€‚è®¾ç½®äº†è‡ªåŠ¨æäº¤ Offsetï¼Œæ¥å—åˆ°æ¶ˆæ¯åå°±ä¼šè‡ªåŠ¨æäº¤ Offset ç»™ Kafka ï¼ŒKafka å°±è®¤ä¸ºæ¶ˆæ¯å·²è¢«æ¶ˆè´¹ã€‚å¦‚æœæ­¤æ—¶ï¼Œæ¶ˆè´¹æ–¹å°šæœªæ¥å¾—åŠå¤„ç†æ¶ˆæ¯å°±æŒ‚äº†ï¼Œé‚£ä¹ˆæ¶ˆæ¯å°±ä¸¢äº†ã€‚</p>
<p>è§£å†³æ–¹æ³•å°±æ˜¯æ¶ˆè´¹æ–¹å…³é—­è‡ªåŠ¨æäº¤ Offsetï¼Œå¤„ç†å®Œæ¶ˆæ¯åæ‰‹åŠ¨æäº¤ Offsetã€‚ä½†è¿™ç§æƒ…å†µä¸‹å¯èƒ½ä¼šå‡ºç°é‡å¤æ¶ˆè´¹çš„æƒ…å½¢ï¼Œéœ€è¦è‡ªè¡Œä¿è¯å¹‚ç­‰æ€§ã€‚</p>
<h4 id="222-kafka-ä¸¢å¤±æ•°æ®"><a class="markdownIt-Anchor" href="#222-kafka-ä¸¢å¤±æ•°æ®"></a> 2.2.2. Kafka ä¸¢å¤±æ•°æ®</h4>
<p>å½“ Kafka æŸä¸ª Broker å®•æœºï¼Œéœ€è¦é‡æ–°é€‰ä¸¾ Partition çš„ Leaderã€‚è‹¥æ­¤æ—¶å…¶ä»–çš„ Follower å°šæœªåŒæ­¥ Leader çš„æ•°æ®ï¼Œé‚£ä¹ˆæ–°é€‰æŸä¸ª Follower ä¸º Leader åï¼Œå°±ä¸¢å¤±äº†éƒ¨åˆ†æ•°æ®ã€‚</p>
<p>ä¸ºæ­¤ï¼Œä¸€èˆ¬è¦æ±‚è‡³å°‘è®¾ç½® 4 ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>ç»™ Topic è®¾ç½® <code>replication.factor</code> å‚æ•° - è¿™ä¸ªå€¼å¿…é¡»å¤§äº 1ï¼Œè¦æ±‚æ¯ä¸ª Partition å¿…é¡»æœ‰è‡³å°‘ 2 ä¸ªå‰¯æœ¬ã€‚</li>
<li>åœ¨ Kafka æœåŠ¡ç«¯è®¾ç½® <code>min.insync.replicas</code> å‚æ•° - è¿™ä¸ªå€¼å¿…é¡»å¤§äº 1ï¼Œè¿™æ˜¯è¦æ±‚ä¸€ä¸ª Leader éœ€è¦å’Œè‡³å°‘ä¸€ä¸ª Follower ä¿æŒé€šä¿¡ï¼Œè¿™æ ·æ‰èƒ½ç¡®ä¿ Leader æŒ‚äº†è¿˜æœ‰æ›¿è¡¥ã€‚</li>
<li>åœ¨ Producer ç«¯è®¾ç½® <code>acks=all</code> - è¿™æ„å‘³ç€ï¼šè¦æ±‚æ¯æ¡æ•°æ®ï¼Œå¿…é¡»æ˜¯<strong>å†™å…¥æ‰€æœ‰ replica ä¹‹åï¼Œæ‰èƒ½è®¤ä¸ºæ˜¯å†™æˆåŠŸäº†</strong>ã€‚</li>
<li>åœ¨ Producer ç«¯è®¾ç½® <code>retries=MAX</code>ï¼ˆå¾ˆå¤§å¾ˆå¤§å¾ˆå¤§çš„ä¸€ä¸ªå€¼ï¼Œæ— é™æ¬¡é‡è¯•çš„æ„æ€ï¼‰ - è¿™æ„å‘³ç€<strong>è¦æ±‚ä¸€æ—¦å†™å…¥å¤±è´¥ï¼Œå°±æ— é™é‡è¯•</strong>ï¼Œå¡åœ¨è¿™é‡Œäº†ã€‚</li>
</ul>
<h4 id="223-ç”Ÿäº§æ–¹ä¸¢å¤±æ•°æ®"><a class="markdownIt-Anchor" href="#223-ç”Ÿäº§æ–¹ä¸¢å¤±æ•°æ®"></a> 2.2.3. ç”Ÿäº§æ–¹ä¸¢å¤±æ•°æ®</h4>
<p>å¦‚æœæŒ‰ç…§ä¸Šè¿°çš„æ€è·¯è®¾ç½®äº† <code>acks=all</code>ï¼Œç”Ÿäº§æ–¹ä¸€å®šä¸ä¼šä¸¢æ•°æ®ã€‚</p>
<p>è¦æ±‚æ˜¯ï¼Œä½ çš„ Leader æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œæ‰€æœ‰çš„ Follower éƒ½åŒæ­¥åˆ°äº†æ¶ˆæ¯ä¹‹åï¼Œæ‰è®¤ä¸ºæœ¬ç”Ÿäº§æ¶ˆæ¯æˆåŠŸäº†ã€‚å¦‚æœæœªæ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œç”Ÿäº§è€…ä¼šè‡ªåŠ¨ä¸æ–­çš„é‡è¯•ï¼Œé‡è¯•æ— é™æ¬¡ã€‚</p>
<h3 id="23-æ¶ˆæ¯çš„é¡ºåºæ€§"><a class="markdownIt-Anchor" href="#23-æ¶ˆæ¯çš„é¡ºåºæ€§"></a> 2.3. æ¶ˆæ¯çš„é¡ºåºæ€§</h3>
<blockquote>
<p>ä»¥ Kafka ä¸ºä¾‹</p>
</blockquote>
<p>è¦ä¿è¯ MQ çš„é¡ºåºæ€§ï¼ŒåŠ¿å¿…è¦ä»˜å‡ºä¸€å®šçš„ä»£ä»·ï¼Œæ‰€ä»¥å®æ–½æ–¹æ¡ˆå‰ï¼Œè¦å…ˆæ˜ç¡®ä¸šåŠ¡åœºæ™¯æ˜¯ä¸æ˜¯æœ‰å¿…è¦ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ã€‚åªæœ‰é‚£äº›æ˜ç¡®å¯¹æ¶ˆæ¯å¤„ç†é¡ºåºæœ‰è¦æ±‚çš„ä¸šåŠ¡åœºæ™¯æ‰å€¼å¾—å»ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ã€‚</p>
<p>æ–¹æ¡ˆä¸€</p>
<p>ä¸€ä¸ª Topicï¼Œä¸€ä¸ª Partitionï¼Œä¸€ä¸ª Consumerï¼Œå†…éƒ¨å•çº¿ç¨‹æ¶ˆè´¹ï¼Œå•çº¿ç¨‹ååé‡å¤ªä½ï¼Œä¸€èˆ¬ä¸ä¼šç”¨è¿™ä¸ªã€‚</p>
<p>æ–¹æ¡ˆäºŒ</p>
<ul>
<li>å†™å…¥æ•°æ®åˆ° Partition æ—¶æŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„ Keyï¼Œä¾‹å¦‚è®¢å• IDã€‚ç”±å‘é€æ–¹ä¿è¯ç›¸åŒ Key çš„æ¶ˆæ¯åªèƒ½å‘é€åˆ°åŒä¸€ä¸ª Partition å¹¶ä¸”è¿™ä¸ª Partition ä¸­çš„æ•°æ®ä¸€å®šæ˜¯é¡ºåºçš„ã€‚</li>
<li>åŸºäºä¸Šä¸€ç‚¹ï¼Œæ¶ˆè´¹æ–¹ä» Kafka Partition ä¸­æ¶ˆè´¹æ¶ˆæ¯æ—¶ï¼Œæ­¤åˆ»ä¸€å®šæ˜¯é¡ºåºçš„ã€‚ä½†å¦‚æœæ¶ˆè´¹æ–¹å¼ä»¥å¹¶å‘æ–¹å¼æ¶ˆè´¹æ¶ˆæ¯ï¼Œé¡ºåºå°±å¯èƒ½ä¼šè¢«æ‰“ä¹±ã€‚ä¸ºæ­¤ï¼Œè¿˜æœ‰åšåˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š
<ul>
<li>æ¶ˆè´¹æ–¹ç»´æŠ¤ N ä¸ªç¼“å­˜é˜Ÿåˆ—ï¼Œå…·æœ‰ç›¸åŒ key çš„æ•°æ®éƒ½å†™å…¥åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼›</li>
<li>åˆ›å»º N ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹åªè´Ÿè´£ä»æŒ‡å®šçš„ä¸€ä¸ªé˜Ÿåˆ—ä¸­å–æ•°æ®ã€‚</li>
</ul>
</li>
</ul>
<p><img src="http://dunwu.test.upcdn.net/cs/design/theory/mq/mq_7.png" alt="" /></p>
<h3 id="24-æ¶ˆæ¯ç§¯å‹"><a class="markdownIt-Anchor" href="#24-æ¶ˆæ¯ç§¯å‹"></a> 2.4. æ¶ˆæ¯ç§¯å‹</h3>
<p>å‡è®¾ä¸€ä¸ª MQ æ¶ˆè´¹è€…å¯ä»¥ä¸€ç§’å¤„ç† 1000 æ¡æ¶ˆæ¯ï¼Œä¸‰ä¸ª MQ æ¶ˆè´¹è€…å¯ä»¥ä¸€ç§’å¤„ç† 3000 æ¡æ¶ˆæ¯ï¼Œé‚£ä¹ˆä¸€åˆ†é’Ÿçš„å¤„ç†é‡æ˜¯ 18 ä¸‡æ¡ã€‚å¦‚æœ MQ ä¸­ç§¯å‹äº†å‡ ç™¾ä¸‡åˆ°ä¸Šåƒä¸‡çš„æ•°æ®ï¼Œå³ä½¿æ¶ˆè´¹è€…æ¢å¤äº†ï¼Œä¹Ÿéœ€è¦å¤§æ¦‚å¾ˆé•¿çš„æ—¶é—´æ‰èƒ½æ¢å¤è¿‡æ¥ã€‚</p>
<p>å¯¹äºäº§çº¿ç¯å¢ƒæ¥è¯´ï¼Œæ¼«é•¿çš„ç­‰å¾…æ˜¯ä¸å¯æ¥å—çš„ï¼Œæ‰€ä»¥é¢ä¸´è¿™ç§çª˜å¢ƒæ—¶ï¼Œåªèƒ½ä¸´æ—¶ç´§æ€¥æ‰©å®¹ä»¥åº”å¯¹äº†ï¼Œå…·ä½“æ“ä½œæ­¥éª¤å’Œæ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>å…ˆä¿®å¤ Consumer çš„é—®é¢˜ï¼Œç¡®ä¿å…¶æ¢å¤æ¶ˆè´¹é€Ÿåº¦ï¼Œç„¶åå°†ç°æœ‰ Consumer éƒ½åœæ‰ã€‚</li>
<li>æ–°å»ºä¸€ä¸ª Topicï¼ŒPartition æ˜¯åŸæ¥çš„ 10 å€ï¼Œä¸´æ—¶å»ºç«‹å¥½åŸå…ˆ 10 å€çš„ Queue æ•°é‡ã€‚</li>
<li>ç„¶åå†™ä¸€ä¸ªä¸´æ—¶çš„åˆ†å‘æ•°æ®çš„ Consumer ç¨‹åºï¼Œè¿™ä¸ªç¨‹åºéƒ¨ç½²ä¸Šå»æ¶ˆè´¹ç§¯å‹çš„æ•°æ®ï¼Œ<strong>æ¶ˆè´¹ä¹‹åä¸åšè€—æ—¶çš„å¤„ç†</strong>ï¼Œç›´æ¥å‡åŒ€è½®è¯¢å†™å…¥ä¸´æ—¶å»ºç«‹å¥½çš„ 10 å€æ•°é‡çš„ Queueã€‚</li>
<li>æ¥ç€ä¸´æ—¶å¾ç”¨ 10 å€çš„æœºå™¨æ¥éƒ¨ç½² Consumer ï¼Œæ¯ä¸€æ‰¹ Consumer æ¶ˆè´¹ä¸€ä¸ªä¸´æ—¶ Queue çš„æ•°æ®ã€‚è¿™ç§åšæ³•ç›¸å½“äºæ˜¯ä¸´æ—¶å°† Queue èµ„æºå’Œ Consumer èµ„æºæ‰©å¤§ 10 å€ï¼Œä»¥æ­£å¸¸çš„ 10 å€é€Ÿåº¦æ¥æ¶ˆè´¹æ•°æ®ã€‚</li>
<li>ç­‰å¿«é€Ÿæ¶ˆè´¹å®Œç§¯å‹æ•°æ®ä¹‹åï¼Œ<strong>å¾—æ¢å¤åŸå…ˆéƒ¨ç½²çš„æ¶æ„</strong>ï¼Œ<strong>é‡æ–°</strong>ç”¨åŸå…ˆçš„ consumer æœºå™¨æ¥æ¶ˆè´¹æ¶ˆæ¯ã€‚</li>
</ul>
<h2 id="3-mq-çš„é«˜å¯ç”¨"><a class="markdownIt-Anchor" href="#3-mq-çš„é«˜å¯ç”¨"></a> 3. MQ çš„é«˜å¯ç”¨</h2>
<p>ä¸åŒ MQ å®ç°é«˜å¯ç”¨çš„åŸç†å„ä¸ç›¸åŒã€‚å› ä¸º Kafka æ¯”è¾ƒå…·æœ‰ä»£è¡¨æ€§ï¼Œæ‰€ä»¥è¿™é‡Œä»¥ Kafka ä¸ºä¾‹ã€‚</p>
<h3 id="31-kafka-çš„é«˜å¯ç”¨"><a class="markdownIt-Anchor" href="#31-kafka-çš„é«˜å¯ç”¨"></a> 3.1. Kafka çš„é«˜å¯ç”¨</h3>
<h4 id="311-kafka-çš„æ ¸å¿ƒæ¦‚å¿µ"><a class="markdownIt-Anchor" href="#311-kafka-çš„æ ¸å¿ƒæ¦‚å¿µ"></a> 3.1.1. Kafka çš„æ ¸å¿ƒæ¦‚å¿µ</h4>
<p>äº†è§£ Kafkaï¼Œå¿…é¡»å…ˆäº†è§£ Kafka çš„æ ¸å¿ƒæ¦‚å¿µï¼š</p>
<ul>
<li>
<p><strong>Broker</strong> - Kafka é›†ç¾¤åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ï¼Œè¿™ç§èŠ‚ç‚¹è¢«ç§°ä¸º Brokerã€‚</p>
</li>
<li>
<p><strong>Topic</strong> - æ¯æ¡å‘å¸ƒåˆ° Kafka é›†ç¾¤çš„æ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªç±»åˆ«ï¼Œè¿™ä¸ªç±»åˆ«è¢«ç§°ä¸º Topicã€‚ï¼ˆä¸åŒ Topic çš„æ¶ˆæ¯æ˜¯ç‰©ç†éš”ç¦»çš„ï¼›åŒä¸€ä¸ª Topic çš„æ¶ˆæ¯ä¿å­˜åœ¨ä¸€ä¸ªæˆ–å¤šä¸ª Broker ä¸Šï¼Œä½†ç”¨æˆ·åªéœ€æŒ‡å®šæ¶ˆæ¯çš„ Topic å³å¯ç”Ÿäº§æˆ–æ¶ˆè´¹æ•°æ®è€Œä¸å¿…å…³å¿ƒæ•°æ®å­˜äºä½•å¤„ï¼‰ã€‚å¯¹äºæ¯ä¸€ä¸ª Topicï¼Œ Kafka é›†ç¾¤éƒ½ä¼šç»´æŒä¸€ä¸ªåˆ†åŒºæ—¥å¿—ã€‚</p>
</li>
<li>
<p><strong>Partition</strong> - äº†æé«˜ Kafka çš„ååç‡ï¼Œæ¯ä¸ª Topic åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª Partitionï¼Œæ¯ä¸ª Partition åœ¨ç‰©ç†ä¸Šå¯¹åº”ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹å­˜å‚¨è¿™ä¸ª Partition çš„æ‰€æœ‰æ¶ˆæ¯å’Œç´¢å¼•æ–‡ä»¶ã€‚</p>
<ul>
<li>Kafka æ—¥å¿—çš„åˆ†åŒºï¼ˆPartitionï¼‰åˆ†å¸ƒåœ¨ Kafka é›†ç¾¤çš„èŠ‚ç‚¹ä¸Šã€‚æ¯ä¸ªèŠ‚ç‚¹åœ¨å¤„ç†æ•°æ®å’Œè¯·æ±‚æ—¶ï¼Œå…±äº«è¿™äº›åˆ†åŒºã€‚æ¯ä¸€ä¸ªåˆ†åŒºéƒ½ä¼šåœ¨å·²é…ç½®çš„èŠ‚ç‚¹ä¸Šè¿›è¡Œå¤‡ä»½ï¼Œç¡®ä¿å®¹é”™æ€§ã€‚</li>
</ul>
</li>
</ul>
<p><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/distributed/mq/kafka/kafka-cluster-roles.png" alt="" /></p>
<h4 id="312-kafka-çš„å‰¯æœ¬æœºåˆ¶"><a class="markdownIt-Anchor" href="#312-kafka-çš„å‰¯æœ¬æœºåˆ¶"></a> 3.1.2. Kafka çš„å‰¯æœ¬æœºåˆ¶</h4>
<p>Kafka æ˜¯å¦‚ä½•å®ç°é«˜å¯ç”¨çš„å‘¢ï¼Ÿ</p>
<p>Kafka åœ¨ 0.8 ä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœä¸€ä¸ª Broker å®•æœºäº†ï¼Œå…¶ä¸Šé¢çš„ Partition éƒ½ä¸èƒ½ç”¨äº†ï¼Œè¿™è‡ªç„¶ä¸æ˜¯é«˜å¯ç”¨çš„ã€‚</p>
<p>ä¸ºäº†å®ç°é«˜å¯ç”¨ï¼ŒKafka å¼•å…¥äº†å¤åˆ¶åŠŸèƒ½ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å‰¯æœ¬æœºåˆ¶ï¼ˆ Replicate ï¼‰ã€‚</p>
<p>æ¯ä¸ª Partition éƒ½æœ‰ä¸€ä¸ª Broker ä½œä¸º Leaderï¼Œé›¶ä¸ªæˆ–è€…å¤šä¸ª Broker ä½œä¸º Followerã€‚æ¯ä¸ª Broker éƒ½ä¼šæˆä¸ºæŸäº›åˆ†åŒºçš„ Leader å’ŒæŸäº›åˆ†åŒºçš„ Followerï¼Œå› æ­¤é›†ç¾¤çš„è´Ÿè½½æ˜¯å¹³è¡¡çš„ã€‚</p>
<ul>
<li><strong>Leader å¤„ç†ä¸€åˆ‡å¯¹ Partition ï¼ˆåˆ†åŒºï¼‰çš„è¯»å†™è¯·æ±‚</strong>ï¼›</li>
<li><strong>è€Œ Follower åªéœ€è¢«åŠ¨çš„åŒæ­¥ Leader ä¸Šçš„æ•°æ®</strong>ã€‚</li>
</ul>
<p>åŒä¸€ä¸ª Topic çš„ä¸åŒ Partition ä¼šåˆ†å¸ƒåœ¨å¤šä¸ª Broker ä¸Šï¼Œè€Œä¸”ä¸€ä¸ª Partition è¿˜ä¼šåœ¨å…¶ä»–çš„ Broker ä¸Šé¢è¿›è¡Œå¤‡ä»½ï¼ŒProducer åœ¨å‘å¸ƒæ¶ˆæ¯åˆ°æŸä¸ª Partition æ—¶ï¼Œå…ˆæ‰¾åˆ°è¯¥ Partition çš„ Leaderï¼Œç„¶åå‘è¿™ä¸ª Leader æ¨é€æ¶ˆæ¯ï¼›æ¯ä¸ª Follower éƒ½ä» Leader æ‹‰å–æ¶ˆæ¯ï¼Œæ‹‰å–æ¶ˆæ¯æˆåŠŸä¹‹åï¼Œå‘ Leader å‘é€ä¸€ä¸ª ACK ç¡®è®¤ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/distributed/mq/kafka/kafka-replication.png" alt="" /></p>
<blockquote>
<p>FAQ</p>
<p>é—®ï¼šä¸ºä»€ä¹ˆè®© Leader å¤„ç†ä¸€åˆ‡å¯¹å¯¹ Partition ï¼ˆåˆ†åŒºï¼‰çš„è¯»å†™è¯·æ±‚ï¼Ÿ</p>
<p>ç­”ï¼šå› ä¸ºå¦‚æœå…è®¸æ‰€æœ‰ Broker éƒ½å¯ä»¥å¤„ç†è¯»å†™è¯·æ±‚ï¼Œå°±å¯èƒ½äº§ç”Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚</p>
</blockquote>
<h4 id="313-kafka-é€‰ä¸¾-leader"><a class="markdownIt-Anchor" href="#313-kafka-é€‰ä¸¾-leader"></a> 3.1.3. Kafka é€‰ä¸¾ Leader</h4>
<p>ç”±ä¸Šæ–‡å¯çŸ¥ï¼ŒPartition åœ¨å¤šä¸ª Broker ä¸Šå­˜åœ¨å‰¯æœ¬ã€‚</p>
<p>å¦‚æœæŸä¸ª Follower å®•æœºï¼Œå•¥äº‹å„¿æ²¡æœ‰ï¼Œæ­£å¸¸å·¥ä½œã€‚</p>
<p>å¦‚æœ Leader å®•æœºäº†ï¼Œä¼šä» Follower ä¸­<strong>é‡æ–°é€‰ä¸¾</strong>ä¸€ä¸ªæ–°çš„ Leaderã€‚</p>
<h2 id="4-mq-çš„é€šä¿¡æ¨¡å¼"><a class="markdownIt-Anchor" href="#4-mq-çš„é€šä¿¡æ¨¡å¼"></a> 4. MQ çš„é€šä¿¡æ¨¡å¼</h2>
<p>MQ å¯é©»ç•™åœ¨å†…å­˜æˆ–ç£ç›˜ä¸Šï¼Œé˜Ÿåˆ—å­˜å‚¨æ¶ˆæ¯ç›´åˆ°å®ƒä»¬è¢«åº”ç”¨ç¨‹åºè¯»å–ã€‚é€šè¿‡ MQï¼Œåº”ç”¨ç¨‹åºå¯ç‹¬ç«‹åœ°æ‰§è¡Œï¼Œå®ƒä»¬ä¸éœ€è¦çŸ¥é“å½¼æ­¤çš„ä½ç½®ï¼Œä¸éœ€è¦ç­‰å¾…æ¥æ”¶ç¨‹åºæ¥æ”¶æ­¤æ¶ˆæ¯ã€‚åœ¨åˆ†å¸ƒå¼è®¡ç®—ç¯å¢ƒä¸­ï¼Œä¸ºäº†é›†æˆåˆ†å¸ƒå¼åº”ç”¨ï¼Œå¼€å‘è€…éœ€è¦å¯¹å¼‚æ„ç½‘ç»œç¯å¢ƒä¸‹çš„åˆ†å¸ƒå¼åº”ç”¨æä¾›æœ‰æ•ˆçš„é€šä¿¡æ‰‹æ®µã€‚ä¸ºäº†ç®¡ç†éœ€è¦å…±äº«çš„ä¿¡æ¯ï¼Œå¯¹åº”ç”¨æä¾›å…¬å…±çš„ä¿¡æ¯äº¤æ¢æœºåˆ¶æ˜¯é‡è¦çš„ã€‚</p>
<ul>
<li><strong>ç‚¹å¯¹ç‚¹</strong> - ç‚¹å¯¹ç‚¹æ–¹å¼æ˜¯æœ€ä¸ºä¼ ç»Ÿå’Œå¸¸è§çš„é€šè®¯æ–¹å¼ï¼Œå®ƒæ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šã€å¤šå¯¹ä¸€ç­‰å¤šç§é…ç½®æ–¹å¼ï¼Œæ”¯æŒæ ‘çŠ¶ã€ç½‘çŠ¶ç­‰å¤šç§æ‹“æ‰‘ç»“æ„ã€‚</li>
<li><strong>å¤šç‚¹å¹¿æ’­</strong> - MQ é€‚ç”¨äºä¸åŒç±»å‹çš„åº”ç”¨ã€‚å…¶ä¸­é‡è¦çš„ï¼Œä¹Ÿæ˜¯æ­£åœ¨å‘å±•ä¸­çš„æ˜¯&quot;å¤šç‚¹å¹¿æ’­&quot;åº”ç”¨ï¼Œå³èƒ½å¤Ÿå°†æ¶ˆæ¯å‘é€åˆ°å¤šä¸ªç›®æ ‡ç«™ç‚¹ (Destination List)ã€‚å¯ä»¥ä½¿ç”¨ä¸€æ¡ MQ æŒ‡ä»¤å°†å•ä¸€æ¶ˆæ¯å‘é€åˆ°å¤šä¸ªç›®æ ‡ç«™ç‚¹ï¼Œå¹¶ç¡®ä¿ä¸ºæ¯ä¸€ç«™ç‚¹å¯é åœ°æä¾›ä¿¡æ¯ã€‚MQ ä¸ä»…æä¾›äº†å¤šç‚¹å¹¿æ’­çš„åŠŸèƒ½ï¼Œè€Œä¸”è¿˜æ‹¥æœ‰æ™ºèƒ½æ¶ˆæ¯åˆ†å‘åŠŸèƒ½ï¼Œåœ¨å°†ä¸€æ¡æ¶ˆæ¯å‘é€åˆ°åŒä¸€ç³»ç»Ÿä¸Šçš„å¤šä¸ªç”¨æˆ·æ—¶ï¼ŒMQ å°†æ¶ˆæ¯çš„ä¸€ä¸ªå¤åˆ¶ç‰ˆæœ¬å’Œè¯¥ç³»ç»Ÿä¸Šæ¥æ”¶è€…çš„åå•å‘é€åˆ°ç›®æ ‡ MQ ç³»ç»Ÿã€‚ç›®æ ‡ MQ ç³»ç»Ÿåœ¨æœ¬åœ°å¤åˆ¶è¿™äº›æ¶ˆæ¯ï¼Œå¹¶å°†å®ƒä»¬å‘é€åˆ°åå•ä¸Šçš„é˜Ÿåˆ—ï¼Œä»è€Œå°½å¯èƒ½å‡å°‘ç½‘ç»œçš„ä¼ è¾“é‡ã€‚</li>
<li><strong>å‘å¸ƒ/è®¢é˜… (Publish/Subscribe)</strong> - å‘å¸ƒ/è®¢é˜…æ¨¡å¼ä½¿æ¶ˆæ¯çš„åˆ†å‘å¯ä»¥çªç ´ç›®çš„é˜Ÿåˆ—åœ°ç†ä½ç½®çš„é™åˆ¶ï¼Œä½¿æ¶ˆæ¯æŒ‰ç…§ç‰¹å®šçš„ä¸»é¢˜ç”šè‡³å†…å®¹è¿›è¡Œåˆ†å‘ï¼Œç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®ä¸»é¢˜æˆ–å†…å®¹æ¥æ”¶åˆ°æ‰€éœ€è¦çš„æ¶ˆæ¯ã€‚å‘å¸ƒ/è®¢é˜…æ¨¡å¼ä½¿å¾—å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»å˜å¾—æ›´ä¸ºæ¾æ•£ï¼Œå‘é€è€…ä¸å¿…å…³å¿ƒæ¥æ”¶è€…çš„ç›®çš„åœ°å€ï¼Œè€Œæ¥æ”¶è€…ä¹Ÿä¸å¿…å…³å¿ƒæ¶ˆæ¯çš„å‘é€åœ°å€ï¼Œè€Œåªæ˜¯æ ¹æ®æ¶ˆæ¯çš„ä¸»é¢˜è¿›è¡Œæ¶ˆæ¯çš„æ”¶å‘ã€‚</li>
<li><strong>é›†ç¾¤ (Cluster)</strong> - ä¸ºäº†ç®€åŒ–ç‚¹å¯¹ç‚¹é€šè®¯æ¨¡å¼ä¸­çš„ç³»ç»Ÿé…ç½®ï¼ŒMQ æä¾› Cluster(é›†ç¾¤) çš„è§£å†³æ–¹æ¡ˆã€‚é›†ç¾¤ç±»ä¼¼äºä¸€ä¸ªåŸŸ (Domain)ï¼Œé›†ç¾¤å†…éƒ¨çš„é˜Ÿåˆ—ç®¡ç†å™¨ä¹‹é—´é€šè®¯æ—¶ï¼Œä¸éœ€è¦ä¸¤ä¸¤ä¹‹é—´å»ºç«‹æ¶ˆæ¯é€šé“ï¼Œè€Œæ˜¯é‡‡ç”¨é›†ç¾¤ (Cluster) é€šé“ä¸å…¶å®ƒæˆå‘˜é€šè®¯ï¼Œä»è€Œå¤§å¤§ç®€åŒ–äº†ç³»ç»Ÿé…ç½®ã€‚æ­¤å¤–ï¼Œé›†ç¾¤ä¸­çš„é˜Ÿåˆ—ç®¡ç†å™¨ä¹‹é—´èƒ½å¤Ÿè‡ªåŠ¨è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå½“æŸä¸€é˜Ÿåˆ—ç®¡ç†å™¨å‡ºç°æ•…éšœæ—¶ï¼Œå…¶å®ƒé˜Ÿåˆ—ç®¡ç†å™¨å¯ä»¥æ¥ç®¡å®ƒçš„å·¥ä½œï¼Œä»è€Œå¤§å¤§æé«˜ç³»ç»Ÿçš„é«˜å¯é æ€§ã€‚</li>
</ul>
<h2 id="5-å¸¸ç”¨-mq-å¯¹æ¯”"><a class="markdownIt-Anchor" href="#5-å¸¸ç”¨-mq-å¯¹æ¯”"></a> 5. å¸¸ç”¨ MQ å¯¹æ¯”</h2>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>ActiveMQ</th>
<th>RabbitMQ</th>
<th>RocketMQ</th>
<th>Kafka</th>
</tr>
</thead>
<tbody>
<tr>
<td>å•æœºååé‡</td>
<td>ä¸‡çº§ï¼Œæ¯” RocketMQã€Kafka ä½ä¸€ä¸ªæ•°é‡çº§</td>
<td>åŒ ActiveMQ</td>
<td>10 ä¸‡çº§ï¼Œæ”¯æ’‘é«˜åå</td>
<td>10 ä¸‡çº§ï¼Œé«˜ååï¼Œä¸€èˆ¬é…åˆå¤§æ•°æ®ç±»çš„ç³»ç»Ÿæ¥è¿›è¡Œå®æ—¶æ•°æ®è®¡ç®—ã€æ—¥å¿—é‡‡é›†ç­‰åœºæ™¯</td>
</tr>
<tr>
<td>topic æ•°é‡å¯¹ååé‡çš„å½±å“</td>
<td></td>
<td></td>
<td>topic å¯ä»¥è¾¾åˆ°å‡ ç™¾/å‡ åƒçš„çº§åˆ«ï¼Œååé‡ä¼šæœ‰è¾ƒå°å¹…åº¦çš„ä¸‹é™ï¼Œè¿™æ˜¯ RocketMQ çš„ä¸€å¤§ä¼˜åŠ¿ï¼Œåœ¨åŒç­‰æœºå™¨ä¸‹ï¼Œå¯ä»¥æ”¯æ’‘å¤§é‡çš„ topic</td>
<td>topic ä»å‡ ååˆ°å‡ ç™¾ä¸ªæ—¶å€™ï¼Œååé‡ä¼šå¤§å¹…åº¦ä¸‹é™ï¼Œåœ¨åŒç­‰æœºå™¨ä¸‹ï¼ŒKafka å°½é‡ä¿è¯ topic æ•°é‡ä¸è¦è¿‡å¤šï¼Œå¦‚æœè¦æ”¯æ’‘å¤§è§„æ¨¡çš„ topicï¼Œéœ€è¦å¢åŠ æ›´å¤šçš„æœºå™¨èµ„æº</td>
</tr>
<tr>
<td>æ—¶æ•ˆæ€§</td>
<td>ms çº§</td>
<td>å¾®ç§’çº§ï¼Œè¿™æ˜¯ RabbitMQ çš„ä¸€å¤§ç‰¹ç‚¹ï¼Œå»¶è¿Ÿæœ€ä½</td>
<td>ms çº§</td>
<td>å»¶è¿Ÿåœ¨ ms çº§ä»¥å†…</td>
</tr>
<tr>
<td>å¯ç”¨æ€§</td>
<td>é«˜ï¼ŒåŸºäºä¸»ä»æ¶æ„å®ç°é«˜å¯ç”¨</td>
<td>åŒ ActiveMQ</td>
<td>éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼æ¶æ„</td>
<td>éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼ï¼Œä¸€ä¸ªæ•°æ®å¤šä¸ªå‰¯æœ¬ï¼Œå°‘æ•°æœºå™¨å®•æœºï¼Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä¸ä¼šå¯¼è‡´ä¸å¯ç”¨</td>
</tr>
<tr>
<td>æ¶ˆæ¯å¯é æ€§</td>
<td>æœ‰è¾ƒä½çš„æ¦‚ç‡ä¸¢å¤±æ•°æ®</td>
<td>åŸºæœ¬ä¸ä¸¢</td>
<td>ç»è¿‡å‚æ•°ä¼˜åŒ–é…ç½®ï¼Œå¯ä»¥åšåˆ° 0 ä¸¢å¤±</td>
<td>åŒ RocketMQ</td>
</tr>
<tr>
<td>åŠŸèƒ½æ”¯æŒ</td>
<td>MQ é¢†åŸŸçš„åŠŸèƒ½æå…¶å®Œå¤‡</td>
<td>åŸºäº erlang å¼€å‘ï¼Œå¹¶å‘èƒ½åŠ›å¾ˆå¼ºï¼Œæ€§èƒ½æå¥½ï¼Œå»¶æ—¶å¾ˆä½</td>
<td>MQ åŠŸèƒ½è¾ƒä¸ºå®Œå–„ï¼Œè¿˜æ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ‰©å±•æ€§å¥½</td>
<td>åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ”¯æŒç®€å•çš„ MQ åŠŸèƒ½ï¼Œåœ¨å¤§æ•°æ®é¢†åŸŸçš„å®æ—¶è®¡ç®—ä»¥åŠæ—¥å¿—é‡‡é›†è¢«å¤§è§„æ¨¡ä½¿ç”¨</td>
</tr>
</tbody>
</table>
<p>ç»¼ä¸Šï¼Œå„ç§å¯¹æ¯”ä¹‹åï¼Œæœ‰å¦‚ä¸‹å»ºè®®ï¼š</p>
<ul>
<li>ä¸€èˆ¬çš„ä¸šåŠ¡ç³»ç»Ÿè¦å¼•å…¥ MQï¼Œæœ€æ—©å¤§å®¶éƒ½ç”¨ ActiveMQï¼Œä½†æ˜¯ç°åœ¨ç¡®å®å¤§å®¶ç”¨çš„ä¸å¤šäº†ï¼Œæ²¡ç»è¿‡å¤§è§„æ¨¡ååé‡åœºæ™¯çš„éªŒè¯ï¼Œç¤¾åŒºä¹Ÿä¸æ˜¯å¾ˆæ´»è·ƒï¼Œæ‰€ä»¥å¤§å®¶è¿˜æ˜¯ç®—äº†å§ï¼Œæˆ‘ä¸ªäººä¸æ¨èç”¨è¿™ä¸ªäº†ï¼›</li>
<li>åæ¥å¤§å®¶å¼€å§‹ç”¨ RabbitMQï¼Œä½†æ˜¯ç¡®å® erlang è¯­è¨€é˜»æ­¢äº†å¤§é‡çš„ Java å·¥ç¨‹å¸ˆå»æ·±å…¥ç ”ç©¶å’ŒæŒæ§å®ƒï¼Œå¯¹å…¬å¸è€Œè¨€ï¼Œå‡ ä¹å¤„äºä¸å¯æ§çš„çŠ¶æ€ï¼Œä½†æ˜¯ç¡®å®äººå®¶æ˜¯å¼€æºçš„ï¼Œæ¯”è¾ƒç¨³å®šçš„æ”¯æŒï¼Œæ´»è·ƒåº¦ä¹Ÿé«˜ï¼›</li>
<li>ä¸è¿‡ç°åœ¨ç¡®å®è¶Šæ¥è¶Šå¤šçš„å…¬å¸ä¼šå»ç”¨ RocketMQï¼Œç¡®å®å¾ˆä¸é”™ï¼Œæ¯•ç«Ÿæ˜¯é˜¿é‡Œå‡ºå“ï¼Œä½†ç¤¾åŒºå¯èƒ½æœ‰çªç„¶é»„æ‰çš„é£é™©ï¼ˆç›®å‰ RocketMQ å·²æç»™ <a href="https://github.com/apache/rocketmq" target="_blank" rel="noopener">Apache</a>ï¼Œä½† GitHub ä¸Šçš„æ´»è·ƒåº¦å…¶å®ä¸ç®—é«˜ï¼‰å¯¹è‡ªå·±å…¬å¸æŠ€æœ¯å®åŠ›æœ‰ç»å¯¹è‡ªä¿¡çš„ï¼Œæ¨èç”¨ RocketMQï¼Œå¦åˆ™å›å»è€è€å®å®ç”¨ RabbitMQ å§ï¼Œäººå®¶æœ‰æ´»è·ƒçš„å¼€æºç¤¾åŒºï¼Œç»å¯¹ä¸ä¼šé»„ã€‚</li>
<li>æ‰€ä»¥<strong>ä¸­å°å‹å…¬å¸</strong>ï¼ŒæŠ€æœ¯å®åŠ›è¾ƒä¸ºä¸€èˆ¬ï¼ŒæŠ€æœ¯æŒ‘æˆ˜ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œç”¨ RabbitMQ æ˜¯ä¸é”™çš„é€‰æ‹©ï¼›<strong>å¤§å‹å…¬å¸</strong>ï¼ŒåŸºç¡€æ¶æ„ç ”å‘å®åŠ›è¾ƒå¼ºï¼Œç”¨ RocketMQ æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚</li>
<li>å¦‚æœæ˜¯<strong>å¤§æ•°æ®é¢†åŸŸ</strong>çš„å®æ—¶è®¡ç®—ã€æ—¥å¿—é‡‡é›†ç­‰åœºæ™¯ï¼Œç”¨ Kafka æ˜¯ä¸šå†…æ ‡å‡†çš„ï¼Œç»å¯¹æ²¡é—®é¢˜ï¼Œç¤¾åŒºæ´»è·ƒåº¦å¾ˆé«˜ï¼Œç»å¯¹ä¸ä¼šé»„ï¼Œä½•å†µå‡ ä¹æ˜¯å…¨ä¸–ç•Œè¿™ä¸ªé¢†åŸŸçš„äº‹å®æ€§è§„èŒƒã€‚</li>
</ul>
<h2 id="6-jms"><a class="markdownIt-Anchor" href="#6-jms"></a> 6. JMS</h2>
<p>è°ˆ MQ å°±ä¸å¾—ä¸æä¸€ä¸‹ JMS ã€‚</p>
<p><strong>JMSï¼ˆJAVA Message Serviceï¼Œjava æ¶ˆæ¯æœåŠ¡ï¼‰API æ˜¯ä¸€ä¸ªæ¶ˆæ¯æœåŠ¡çš„æ ‡å‡†/è§„èŒƒï¼Œå…è®¸åº”ç”¨ç¨‹åºç»„ä»¶åŸºäº JavaEE å¹³å°åˆ›å»ºã€å‘é€ã€æ¥æ”¶å’Œè¯»å–æ¶ˆæ¯</strong>ã€‚å®ƒä½¿åˆ†å¸ƒå¼é€šä¿¡è€¦åˆåº¦æ›´ä½ï¼Œæ¶ˆæ¯æœåŠ¡æ›´åŠ å¯é ä»¥åŠå¼‚æ­¥æ€§ã€‚</p>
<p>åœ¨ EJB æ¶æ„ä¸­ï¼Œæœ‰æ¶ˆæ¯ bean å¯ä»¥æ— ç¼çš„ä¸ JM æ¶ˆæ¯æœåŠ¡é›†æˆã€‚åœ¨ J2EE æ¶æ„æ¨¡å¼ä¸­ï¼Œæœ‰æ¶ˆæ¯æœåŠ¡è€…æ¨¡å¼ï¼Œç”¨äºå®ç°æ¶ˆæ¯ä¸åº”ç”¨ç›´æ¥çš„è§£è€¦ã€‚</p>
<h3 id="61-æ¶ˆæ¯æ¨¡å‹"><a class="markdownIt-Anchor" href="#61-æ¶ˆæ¯æ¨¡å‹"></a> 6.1. æ¶ˆæ¯æ¨¡å‹</h3>
<p>åœ¨ JMS æ ‡å‡†ä¸­ï¼Œæœ‰ä¸¤ç§æ¶ˆæ¯æ¨¡å‹ï¼š</p>
<ul>
<li>P2P(Point to Point)</li>
<li>Pub/Sub(Publish/Subscribe)</li>
</ul>
<h4 id="611-p2p-æ¨¡å¼"><a class="markdownIt-Anchor" href="#611-p2p-æ¨¡å¼"></a> 6.1.1. P2P æ¨¡å¼</h4>
<div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-2adc66e2367cd2c2.png"/></div>
P2P æ¨¡å¼åŒ…å«ä¸‰ä¸ªè§’è‰²ï¼šMQï¼ˆQueueï¼‰ï¼Œå‘é€è€…(Sender)ï¼Œæ¥æ”¶è€…(Receiver)ã€‚æ¯ä¸ªæ¶ˆæ¯éƒ½è¢«å‘é€åˆ°ä¸€ä¸ªç‰¹å®šçš„é˜Ÿåˆ—ï¼Œæ¥æ”¶è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ã€‚é˜Ÿåˆ—ä¿ç•™ç€æ¶ˆæ¯ï¼Œç›´åˆ°ä»–ä»¬è¢«æ¶ˆè´¹æˆ–è¶…æ—¶ã€‚
<p>P2P çš„ç‰¹ç‚¹</p>
<ul>
<li>æ¯ä¸ªæ¶ˆæ¯åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ï¼ˆConsumerï¼‰(å³ä¸€æ—¦è¢«æ¶ˆè´¹ï¼Œæ¶ˆæ¯å°±ä¸å†åœ¨ MQ ä¸­)</li>
<li>å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´åœ¨æ—¶é—´ä¸Šæ²¡æœ‰ä¾èµ–æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‘é€è€…å‘é€äº†æ¶ˆæ¯ä¹‹åï¼Œä¸ç®¡æ¥æ”¶è€…æœ‰æ²¡æœ‰æ­£åœ¨è¿è¡Œï¼Œå®ƒä¸ä¼šå½±å“åˆ°æ¶ˆæ¯è¢«å‘é€åˆ°é˜Ÿåˆ—</li>
<li>æ¥æ”¶è€…åœ¨æˆåŠŸæ¥æ”¶æ¶ˆæ¯ä¹‹åéœ€å‘é˜Ÿåˆ—åº”ç­”æˆåŠŸ</li>
</ul>
<p>å¦‚æœå¸Œæœ›å‘é€çš„æ¯ä¸ªæ¶ˆæ¯éƒ½ä¼šè¢«æˆåŠŸå¤„ç†çš„è¯ï¼Œé‚£ä¹ˆéœ€è¦ P2P æ¨¡å¼ã€‚</p>
<h4 id="612-pubsub-æ¨¡å¼"><a class="markdownIt-Anchor" href="#612-pubsub-æ¨¡å¼"></a> 6.1.2. Pub/sub æ¨¡å¼</h4>
<div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-12afe9581da889ea.png"/></div>
åŒ…å«ä¸‰ä¸ªè§’è‰²ä¸»é¢˜ï¼ˆTopicï¼‰ï¼Œå‘å¸ƒè€…ï¼ˆPublisherï¼‰ï¼Œè®¢é˜…è€…ï¼ˆSubscriberï¼‰ ã€‚å¤šä¸ªå‘å¸ƒè€…å°†æ¶ˆæ¯å‘é€åˆ° Topic,ç³»ç»Ÿå°†è¿™äº›æ¶ˆæ¯ä¼ é€’ç»™å¤šä¸ªè®¢é˜…è€…ã€‚
<p>Pub/Sub çš„ç‰¹ç‚¹</p>
<ul>
<li>æ¯ä¸ªæ¶ˆæ¯å¯ä»¥æœ‰å¤šä¸ªæ¶ˆè´¹è€…</li>
<li>å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´æœ‰æ—¶é—´ä¸Šçš„ä¾èµ–æ€§ã€‚é’ˆå¯¹æŸä¸ªä¸»é¢˜ï¼ˆTopicï¼‰çš„è®¢é˜…è€…ï¼Œå®ƒå¿…é¡»åˆ›å»ºä¸€ä¸ªè®¢é˜…è€…ä¹‹åï¼Œæ‰èƒ½æ¶ˆè´¹å‘å¸ƒè€…çš„æ¶ˆæ¯ã€‚</li>
<li>ä¸ºäº†æ¶ˆè´¹æ¶ˆæ¯ï¼Œè®¢é˜…è€…å¿…é¡»ä¿æŒè¿è¡Œçš„çŠ¶æ€ã€‚</li>
</ul>
<p>ä¸ºäº†ç¼“å’Œè¿™æ ·ä¸¥æ ¼çš„æ—¶é—´ç›¸å…³æ€§ï¼ŒJMS å…è®¸è®¢é˜…è€…åˆ›å»ºä¸€ä¸ªå¯æŒä¹…åŒ–çš„è®¢é˜…ã€‚è¿™æ ·ï¼Œå³ä½¿è®¢é˜…è€…æ²¡æœ‰è¢«æ¿€æ´»ï¼ˆè¿è¡Œï¼‰ï¼Œå®ƒä¹Ÿèƒ½æ¥æ”¶åˆ°å‘å¸ƒè€…çš„æ¶ˆæ¯ã€‚</p>
<p>å¦‚æœå¸Œæœ›å‘é€çš„æ¶ˆæ¯å¯ä»¥ä¸è¢«åšä»»ä½•å¤„ç†ã€æˆ–è€…åªè¢«ä¸€ä¸ªæ¶ˆæ¯è€…å¤„ç†ã€æˆ–è€…å¯ä»¥è¢«å¤šä¸ªæ¶ˆè´¹è€…å¤„ç†çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥é‡‡ç”¨ Pub/Sub æ¨¡å‹ã€‚</p>
<h3 id="62-æ¶ˆæ¯æ¶ˆè´¹"><a class="markdownIt-Anchor" href="#62-æ¶ˆæ¯æ¶ˆè´¹"></a> 6.2. æ¶ˆæ¯æ¶ˆè´¹</h3>
<p>åœ¨ JMS ä¸­ï¼Œæ¶ˆæ¯çš„äº§ç”Ÿå’Œæ¶ˆè´¹éƒ½æ˜¯å¼‚æ­¥çš„ã€‚å¯¹äºæ¶ˆè´¹æ¥è¯´ï¼ŒJMS çš„æ¶ˆæ¯è€…å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥æ¶ˆè´¹æ¶ˆæ¯ã€‚</p>
<ul>
<li><strong>åŒæ­¥</strong> - è®¢é˜…è€…æˆ–æ¥æ”¶è€…é€šè¿‡ <code>receive</code> æ–¹æ³•æ¥æ¥æ”¶æ¶ˆæ¯ï¼Œ<code>receive</code> æ–¹æ³•åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹å‰ï¼ˆæˆ–è¶…æ—¶ä¹‹å‰ï¼‰å°†ä¸€ç›´é˜»å¡ï¼›</li>
<li><strong>å¼‚æ­¥</strong> - è®¢é˜…è€…æˆ–æ¥æ”¶è€…å¯ä»¥æ³¨å†Œä¸ºä¸€ä¸ªæ¶ˆæ¯ç›‘å¬å™¨ã€‚å½“æ¶ˆæ¯åˆ°è¾¾ä¹‹åï¼Œç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ç›‘å¬å™¨çš„ <code>onMessage</code> æ–¹æ³•ã€‚</li>
</ul>
<p><code>JNDI</code> - Java å‘½åå’Œç›®å½•æ¥å£,æ˜¯ä¸€ç§æ ‡å‡†çš„ Java å‘½åç³»ç»Ÿæ¥å£ã€‚å¯ä»¥åœ¨ç½‘ç»œä¸ŠæŸ¥æ‰¾å’Œè®¿é—®æœåŠ¡ã€‚é€šè¿‡æŒ‡å®šä¸€ä¸ªèµ„æºåç§°ï¼Œè¯¥åç§°å¯¹åº”äºæ•°æ®åº“æˆ–å‘½åæœåŠ¡ä¸­çš„ä¸€ä¸ªè®°å½•ï¼ŒåŒæ—¶è¿”å›èµ„æºè¿æ¥å»ºç«‹æ‰€å¿…é¡»çš„ä¿¡æ¯ã€‚</p>
<p>JNDI åœ¨ JMS ä¸­èµ·åˆ°æŸ¥æ‰¾å’Œè®¿é—®å‘é€ç›®æ ‡æˆ–æ¶ˆæ¯æ¥æºçš„ä½œç”¨ã€‚</p>
<h3 id="63-jms-ç¼–ç¨‹æ¨¡å‹"><a class="markdownIt-Anchor" href="#63-jms-ç¼–ç¨‹æ¨¡å‹"></a> 6.3. JMS ç¼–ç¨‹æ¨¡å‹</h3>
<h4 id="631-connectionfactory"><a class="markdownIt-Anchor" href="#631-connectionfactory"></a> 6.3.1. ConnectionFactory</h4>
<p>åˆ›å»º Connection å¯¹è±¡çš„å·¥å‚ï¼Œé’ˆå¯¹ä¸¤ç§ä¸åŒçš„ jms æ¶ˆæ¯æ¨¡å‹ï¼Œåˆ†åˆ«æœ‰ QueueConnectionFactory å’Œ TopicConnectionFactory ä¸¤ç§ã€‚å¯ä»¥é€šè¿‡ JNDI æ¥æŸ¥æ‰¾ ConnectionFactory å¯¹è±¡ã€‚</p>
<h4 id="632-destination"><a class="markdownIt-Anchor" href="#632-destination"></a> 6.3.2. Destination</h4>
<p>Destination çš„æ„æ€æ˜¯æ¶ˆæ¯ç”Ÿäº§è€…çš„æ¶ˆæ¯å‘é€ç›®æ ‡æˆ–è€…è¯´æ¶ˆæ¯æ¶ˆè´¹è€…çš„æ¶ˆæ¯æ¥æºã€‚å¯¹äºæ¶ˆæ¯ç”Ÿäº§è€…æ¥è¯´ï¼Œå®ƒçš„ Destination æ˜¯æŸä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰æˆ–æŸä¸ªä¸»é¢˜ï¼ˆTopicï¼‰;å¯¹äºæ¶ˆæ¯æ¶ˆè´¹è€…æ¥è¯´ï¼Œå®ƒçš„ Destination ä¹Ÿæ˜¯æŸä¸ªé˜Ÿåˆ—æˆ–ä¸»é¢˜ï¼ˆå³æ¶ˆæ¯æ¥æºï¼‰ã€‚</p>
<p>æ‰€ä»¥ï¼ŒDestination å®é™…ä¸Šå°±æ˜¯ä¸¤ç§ç±»å‹çš„å¯¹è±¡ï¼šQueueã€Topicã€‚å¯ä»¥é€šè¿‡ JNDI æ¥æŸ¥æ‰¾ Destinationã€‚</p>
<h4 id="633-3-connection"><a class="markdownIt-Anchor" href="#633-3-connection"></a> 6.3.3. (3) Connection</h4>
<p>Connection è¡¨ç¤ºåœ¨å®¢æˆ·ç«¯å’Œ JMS ç³»ç»Ÿä¹‹é—´å»ºç«‹çš„é“¾æ¥ï¼ˆå¯¹ TCP/IP socket çš„åŒ…è£…ï¼‰ã€‚Connection å¯ä»¥äº§ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ª Sessionã€‚è·Ÿ ConnectionFactory ä¸€æ ·ï¼ŒConnection ä¹Ÿæœ‰ä¸¤ç§ç±»å‹ï¼šQueueConnection å’Œ TopicConnectionã€‚</p>
<h4 id="634-4-session"><a class="markdownIt-Anchor" href="#634-4-session"></a> 6.3.4. (4) Session</h4>
<p>Session æ˜¯æ“ä½œæ¶ˆæ¯çš„æ¥å£ã€‚å¯ä»¥é€šè¿‡ session åˆ›å»ºç”Ÿäº§è€…ã€æ¶ˆè´¹è€…ã€æ¶ˆæ¯ç­‰ã€‚Session æä¾›äº†äº‹åŠ¡çš„åŠŸèƒ½ã€‚å½“éœ€è¦ä½¿ç”¨ session å‘é€/æ¥æ”¶å¤šä¸ªæ¶ˆæ¯æ—¶ï¼Œå¯ä»¥å°†è¿™äº›å‘é€/æ¥æ”¶åŠ¨ä½œæ”¾åˆ°ä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚åŒæ ·ï¼Œä¹Ÿåˆ† QueueSession å’Œ TopicSessionã€‚</p>
<h4 id="635-æ¶ˆæ¯çš„ç”Ÿäº§è€…"><a class="markdownIt-Anchor" href="#635-æ¶ˆæ¯çš„ç”Ÿäº§è€…"></a> 6.3.5. æ¶ˆæ¯çš„ç”Ÿäº§è€…</h4>
<p>æ¶ˆæ¯ç”Ÿäº§è€…ç”± Session åˆ›å»ºï¼Œå¹¶ç”¨äºå°†æ¶ˆæ¯å‘é€åˆ° Destinationã€‚åŒæ ·ï¼Œæ¶ˆæ¯ç”Ÿäº§è€…åˆ†ä¸¤ç§ç±»å‹ï¼šQueueSender å’Œ TopicPublisherã€‚å¯ä»¥è°ƒç”¨æ¶ˆæ¯ç”Ÿäº§è€…çš„æ–¹æ³•ï¼ˆsend æˆ– publish æ–¹æ³•ï¼‰å‘é€æ¶ˆæ¯ã€‚</p>
<h4 id="636-æ¶ˆæ¯æ¶ˆè´¹è€…"><a class="markdownIt-Anchor" href="#636-æ¶ˆæ¯æ¶ˆè´¹è€…"></a> 6.3.6. æ¶ˆæ¯æ¶ˆè´¹è€…</h4>
<p>æ¶ˆæ¯æ¶ˆè´¹è€…ç”± Session åˆ›å»ºï¼Œç”¨äºæ¥æ”¶è¢«å‘é€åˆ° Destination çš„æ¶ˆæ¯ã€‚ä¸¤ç§ç±»å‹ï¼šQueueReceiver å’Œ TopicSubscriberã€‚å¯åˆ†åˆ«é€šè¿‡ session çš„ createReceiver(Queue)æˆ– createSubscriber(Topic)æ¥åˆ›å»ºã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ session çš„ creatDurableSubscriber æ–¹æ³•æ¥åˆ›å»ºæŒä¹…åŒ–çš„è®¢é˜…è€…ã€‚</p>
<h4 id="637-messagelistener"><a class="markdownIt-Anchor" href="#637-messagelistener"></a> 6.3.7. MessageListener</h4>
<p>æ¶ˆæ¯ç›‘å¬å™¨ã€‚å¦‚æœæ³¨å†Œäº†æ¶ˆæ¯ç›‘å¬å™¨ï¼Œä¸€æ—¦æ¶ˆæ¯åˆ°è¾¾ï¼Œå°†è‡ªåŠ¨è°ƒç”¨ç›‘å¬å™¨çš„ onMessage æ–¹æ³•ã€‚EJB ä¸­çš„ MDBï¼ˆMessage-Driven Beanï¼‰å°±æ˜¯ä¸€ç§ MessageListenerã€‚</p>
<p>æ·±å…¥å­¦ä¹  JMS å¯¹æŒæ¡ JAVA æ¶æ„ï¼ŒEJB æ¶æ„æœ‰å¾ˆå¥½çš„å¸®åŠ©ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶ä¹Ÿæ˜¯å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿå¿…é¡»çš„ç»„ä»¶ã€‚æœ¬æ¬¡åˆ†äº«ä¸»è¦åšå…¨å±€æ€§ä»‹ç»ï¼Œå…·ä½“çš„æ·±å…¥éœ€è¦å¤§å®¶å­¦ä¹ ï¼Œå®è·µï¼Œæ€»ç»“ï¼Œé¢†ä¼šã€‚</p>
<h2 id="7-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#7-å‚è€ƒèµ„æ–™"></a> 7. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://www.cnblogs.com/itfly8/p/5155983.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æ¶æ„ç³»åˆ—ï¼šåˆ†å¸ƒå¼ MQï¼ˆä¸€ï¼‰</a></li>
<li><a href="https://www.cnblogs.com/itfly8/p/5156155.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æ¶æ„ç³»åˆ—ï¼šMQï¼ˆäºŒï¼‰</a></li>
<li><a href="https://www.jianshu.com/p/453c6e7ff81c" target="_blank" rel="noopener">åˆ†å¸ƒå¼å¼€æ”¾ MQ(RocketMQ)çš„åŸç†ä¸å®è·µ</a></li>
<li><a href="https://juejin.im/entry/5a0abfb5f265da43062a4a91" target="_blank" rel="noopener">é˜¿é‡Œ RocketMQ ä¼˜åŠ¿å¯¹æ¯”</a></li>
<li><a href="https://github.com/doocs/advanced-java/blob/master/docs/high-concurrency/mq-interview.md" target="_blank" rel="noopener">advanced-java ä¹‹ MQ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¼“å­˜åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/cache-theory/</url>
    <content><![CDATA[<h1 id="ç¼“å­˜åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#ç¼“å­˜åŸºæœ¬åŸç†"></a> ç¼“å­˜åŸºæœ¬åŸç†</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#1-%E7%BC%93%E5%AD%98%E6%A6%82%E8%BF%B0">1. ç¼“å­˜æ¦‚è¿°</a>
<ul>
<li><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BC%93%E5%AD%98">1.1. ä»€ä¹ˆæ˜¯ç¼“å­˜</a></li>
<li><a href="#12-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BC%95%E5%85%A5%E7%BC%93%E5%AD%98">1.2. ä¸ºä»€ä¹ˆå¼•å…¥ç¼“å­˜</a></li>
<li><a href="#13-%E7%BC%93%E5%AD%98%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86">1.3. ç¼“å­˜çš„åŸºæœ¬åŸç†</a></li>
<li><a href="#14-%E7%BC%93%E5%AD%98%E6%B7%98%E6%B1%B0%E7%AE%97%E6%B3%95">1.4. ç¼“å­˜æ·˜æ±°ç®—æ³•</a></li>
<li><a href="#15-%E7%BC%93%E5%AD%98%E7%9A%84%E5%88%86%E7%B1%BB">1.5. ç¼“å­˜çš„åˆ†ç±»</a></li>
<li><a href="#16-%E7%BC%93%E5%AD%98%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84">1.6. ç¼“å­˜æ•´ä½“æ¶æ„</a></li>
</ul>
</li>
<li><a href="#2-cdn-%E7%BC%93%E5%AD%98">2. CDN ç¼“å­˜</a>
<ul>
<li><a href="#21-cdn-%E5%8E%9F%E7%90%86">2.1. CDN åŸç†</a></li>
<li><a href="#22-cdn-%E7%89%B9%E7%82%B9">2.2. CDN ç‰¹ç‚¹</a></li>
</ul>
</li>
<li><a href="#3-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%BC%93%E5%AD%98">3. åå‘ä»£ç†ç¼“å­˜</a>
<ul>
<li><a href="#31-%E7%BC%93%E5%AD%98%E5%8E%9F%E7%90%86">3.1. ç¼“å­˜åŸç†</a></li>
<li><a href="#32-%E4%BB%A3%E7%90%86%E7%BC%93%E5%AD%98%E6%AF%94%E8%BE%83">3.2. ä»£ç†ç¼“å­˜æ¯”è¾ƒ</a></li>
</ul>
</li>
<li><a href="#4-%E8%BF%9B%E7%A8%8B%E5%86%85%E7%BC%93%E5%AD%98">4. è¿›ç¨‹å†…ç¼“å­˜</a>
<ul>
<li><a href="#41-concurrenthashmap">4.1. ConcurrentHashMap</a></li>
<li><a href="#42-lruhashmap">4.2. LRUHashMap</a></li>
<li><a href="#43-guava-cache">4.3. Guava Cache</a></li>
<li><a href="#44-caffeine">4.4. Caffeine</a></li>
<li><a href="#45-%E9%80%89%E6%8B%A9%E8%BF%9B%E7%A8%8B%E5%86%85%E7%BC%93%E5%AD%98">4.5. é€‰æ‹©è¿›ç¨‹å†…ç¼“å­˜</a></li>
</ul>
</li>
<li><a href="#5-%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98">5. åˆ†å¸ƒå¼ç¼“å­˜</a>
<ul>
<li><a href="#51-memcache">5.1. Memcache</a></li>
<li><a href="#52-redis">5.2. Redis</a></li>
<li><a href="#53-%E9%80%89%E6%8B%A9%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98">5.3. é€‰æ‹©åˆ†å¸ƒå¼ç¼“å­˜</a></li>
</ul>
</li>
<li><a href="#6-%E5%A4%9A%E7%BA%A7%E7%BC%93%E5%AD%98">6. å¤šçº§ç¼“å­˜</a>
<ul>
<li><a href="#61-%E4%BD%BF%E7%94%A8%E8%BF%9B%E7%A8%8B%E5%86%85%E7%BC%93%E5%AD%98">6.1. ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜</a></li>
<li><a href="#62-%E4%BD%BF%E7%94%A8%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98">6.2. ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜</a></li>
<li><a href="#63-%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%BA%A7%E7%BC%93%E5%AD%98">6.3. ä½¿ç”¨å¤šçº§ç¼“å­˜</a></li>
</ul>
</li>
<li><a href="#7-%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98">7. ç¼“å­˜é—®é¢˜</a>
<ul>
<li><a href="#71-%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9">7.1. ç¼“å­˜é›ªå´©</a></li>
<li><a href="#72-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F">7.2. ç¼“å­˜ç©¿é€</a></li>
<li><a href="#73-%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF">7.3. ç¼“å­˜å‡»ç©¿</a></li>
<li><a href="#74-%E7%BC%93%E5%AD%98%E6%9B%B4%E6%96%B0">7.4. ç¼“å­˜æ›´æ–°</a></li>
<li><a href="#75-%E7%BC%93%E5%AD%98%E9%A2%84%E7%83%AD">7.5. ç¼“å­˜é¢„çƒ­</a></li>
<li><a href="#76-%E7%BC%93%E5%AD%98%E9%99%8D%E7%BA%A7">7.6. ç¼“å­˜é™çº§</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="1-ç¼“å­˜æ¦‚è¿°"><a class="markdownIt-Anchor" href="#1-ç¼“å­˜æ¦‚è¿°"></a> 1. ç¼“å­˜æ¦‚è¿°</h2>
<h3 id="11-ä»€ä¹ˆæ˜¯ç¼“å­˜"><a class="markdownIt-Anchor" href="#11-ä»€ä¹ˆæ˜¯ç¼“å­˜"></a> 1.1. ä»€ä¹ˆæ˜¯ç¼“å­˜</h3>
<p><strong>ç¼“å­˜å°±æ˜¯æ•°æ®äº¤æ¢çš„ç¼“å†²åŒº</strong>ã€‚</p>
<p>ç¼“å­˜æ˜¯ç”¨äºå­˜å‚¨æ•°æ®çš„ç¡¬ä»¶æˆ–è½¯ä»¶çš„ç»„æˆéƒ¨åˆ†ï¼Œä»¥ä½¿å¾—åç»­æ›´å¿«è®¿é—®ç›¸åº”çš„æ•°æ®ã€‚ç¼“å­˜ä¸­çš„æ•°æ®å¯èƒ½æ˜¯æå‰è®¡ç®—å¥½çš„ç»“æœã€æ•°æ®çš„å‰¯æœ¬ç­‰ã€‚å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼šæœ‰ cpu cache, ç£ç›˜ cache ç­‰ã€‚æœ¬æ–‡ä¸­æåŠåˆ°ç¼“å­˜ä¸»è¦æ˜¯æŒ‡äº’è”ç½‘åº”ç”¨ä¸­æ‰€ä½¿ç”¨çš„ç¼“å­˜ç»„ä»¶ã€‚</p>
<h3 id="12-ä¸ºä»€ä¹ˆå¼•å…¥ç¼“å­˜"><a class="markdownIt-Anchor" href="#12-ä¸ºä»€ä¹ˆå¼•å…¥ç¼“å­˜"></a> 1.2. ä¸ºä»€ä¹ˆå¼•å…¥ç¼“å­˜</h3>
<p>ä¼ ç»Ÿçš„åç«¯ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œè®¿é—®é‡ä»¥åŠå¯¹å“åº”æ—¶é—´çš„è¦æ±‚å‡ä¸é«˜ï¼Œé€šå¸¸åªä½¿ç”¨æ•°æ®åº“å³å¯æ»¡è¶³è¦æ±‚ã€‚è¿™ç§æ¶æ„ç®€å•ï¼Œä¾¿äºå¿«é€Ÿéƒ¨ç½²ï¼Œå¾ˆå¤šç½‘ç«™å‘å±•åˆæœŸå‡è€ƒè™‘ä½¿ç”¨è¿™ç§æ¶æ„ã€‚ä½†æ˜¯éšç€è®¿é—®é‡çš„ä¸Šå‡ï¼Œä»¥åŠå¯¹å“åº”æ—¶é—´çš„è¦æ±‚æå‡ï¼Œä¸€ä¸ªæ•°æ®åº“æœåŠ¡å·²æ— æ³•å†æ»¡è¶³è¦æ±‚ã€‚è¿™æ—¶å€™é€šå¸¸ä¼šè€ƒè™‘æ•°æ®åº“æ‹†åˆ†(sharding)ã€è¯»å†™åˆ†ç¦»ã€ç”šè‡³ç¡¬ä»¶å‡çº§(SSD)ç­‰ä»¥æ»¡è¶³æ–°çš„ä¸šåŠ¡éœ€æ±‚ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä»ç„¶ä¼šé¢ä¸´å¾ˆå¤šé—®é¢˜ï¼Œä¸»è¦ä½“ç°åœ¨ï¼š</p>
<ul>
<li>æ€§èƒ½æå‡æœ‰é™ï¼Œå¾ˆéš¾è¾¾åˆ°æ•°é‡çº§ä¸Šçš„æå‡ï¼Œå°¤å…¶åœ¨äº’è”ç½‘ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œéšç€ç½‘ç«™çš„å‘å±•ï¼Œè®¿é—®é‡ç»å¸¸ä¼šé¢ä¸´åå€ã€ç™¾å€çš„ä¸Šæ¶¨ã€‚</li>
<li>æˆæœ¬é«˜æ˜‚ï¼Œä¸ºäº†æ‰¿è½½ N å€çš„è®¿é—®é‡ï¼Œé€šå¸¸éœ€è¦ N å€çš„æœºå™¨ï¼Œè¿™ä¸ªä»£ä»·éš¾ä»¥æ¥å—ã€‚</li>
</ul>
<p>åœ¨æ•°æ®å±‚å¼•å…¥ç¼“å­˜ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªå¥½å¤„ï¼š</p>
<ul>
<li>æå‡æ•°æ®è¯»å–é€Ÿåº¦ã€‚</li>
<li>æå‡ç³»ç»Ÿæ‰©å±•èƒ½åŠ›ï¼Œé€šè¿‡æ‰©å±•ç¼“å­˜ï¼Œæå‡ç³»ç»Ÿæ‰¿è½½èƒ½åŠ›ã€‚</li>
<li>é™ä½å­˜å‚¨æˆæœ¬ï¼ŒCache+DB çš„æ–¹å¼å¯ä»¥æ‰¿æ‹…åŸæœ‰éœ€è¦å¤šå° DB æ‰èƒ½æ‰¿æ‹…çš„è¯·æ±‚é‡ï¼ŒèŠ‚çœæœºå™¨æˆæœ¬ã€‚</li>
</ul>
<p>æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼Œé€šå¸¸ç¼“å­˜æœ‰ä»¥ä¸‹å‡ ç§ä½¿ç”¨æ–¹å¼ï¼š</p>
<ul>
<li>æ‡’æ±‰å¼(è¯»æ—¶è§¦å‘)ï¼šå†™å…¥ DB å, ç„¶åæŠŠç›¸å…³çš„æ•°æ®ä¹Ÿå†™å…¥ Cacheã€‚</li>
<li>é¥¥é¥¿å¼(å†™æ—¶è§¦å‘)ï¼šå…ˆæŸ¥è¯¢ DB é‡Œçš„æ•°æ®, ç„¶åæŠŠç›¸å…³çš„æ•°æ®å†™å…¥ Cacheã€‚</li>
<li>å®šæœŸåˆ·æ–°ï¼šé€‚åˆå‘¨æœŸæ€§çš„è·‘æ•°æ®çš„ä»»åŠ¡ï¼Œæˆ–è€…åˆ—è¡¨å‹çš„æ•°æ®ï¼Œè€Œä¸”ä¸è¦æ±‚ç»å¯¹å®æ—¶æ€§ã€‚</li>
</ul>
<h3 id="13-ç¼“å­˜çš„åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#13-ç¼“å­˜çš„åŸºæœ¬åŸç†"></a> 1.3. ç¼“å­˜çš„åŸºæœ¬åŸç†</h3>
<ol>
<li>å°†æ•°æ®å†™å…¥/è¯»å–é€Ÿåº¦æ›´å¿«çš„å­˜å‚¨ï¼ˆè®¾å¤‡ï¼‰ï¼›</li>
<li>å°†æ•°æ®ç¼“å­˜åˆ°ç¦»åº”ç”¨æœ€è¿‘çš„ä½ç½®ï¼›</li>
<li>å°†æ•°æ®ç¼“å­˜åˆ°ç¦»ç”¨æˆ·æœ€è¿‘çš„ä½ç½®ã€‚</li>
</ol>
<h3 id="14-ç¼“å­˜æ·˜æ±°ç®—æ³•"><a class="markdownIt-Anchor" href="#14-ç¼“å­˜æ·˜æ±°ç®—æ³•"></a> 1.4. ç¼“å­˜æ·˜æ±°ç®—æ³•</h3>
<p>å¸¸è§çš„ç¼“å­˜æ·˜æ±°ç®—æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><strong>FIFO</strong> - å…ˆè¿›å…ˆå‡ºï¼Œåœ¨è¿™ç§æ·˜æ±°ç®—æ³•ä¸­ï¼Œå…ˆè¿›å…¥ç¼“å­˜çš„ä¼šå…ˆè¢«æ·˜æ±°ã€‚è¿™ç§å¯è°“æ˜¯æœ€ç®€å•çš„äº†ï¼Œä½†æ˜¯ä¼šå¯¼è‡´æˆ‘ä»¬å‘½ä¸­ç‡å¾ˆä½ã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬å¦‚æœæœ‰ä¸ªè®¿é—®é¢‘ç‡å¾ˆé«˜çš„æ•°æ®æ˜¯æ‰€æœ‰æ•°æ®ç¬¬ä¸€ä¸ªè®¿é—®çš„ï¼Œè€Œé‚£äº›ä¸æ˜¯å¾ˆé«˜çš„æ˜¯åé¢å†è®¿é—®çš„ï¼Œé‚£è¿™æ ·å°±ä¼šæŠŠæˆ‘ä»¬çš„é¦–ä¸ªæ•°æ®ä½†æ˜¯ä»–çš„è®¿é—®é¢‘ç‡å¾ˆé«˜ç»™æŒ¤å‡ºã€‚</li>
<li><strong>LRU</strong> - æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ã€‚åœ¨è¿™ç§ç®—æ³•ä¸­é¿å…äº†ä¸Šé¢çš„é—®é¢˜ï¼Œæ¯æ¬¡è®¿é—®æ•°æ®éƒ½ä¼šå°†å…¶æ”¾åœ¨æˆ‘ä»¬çš„é˜Ÿå°¾ï¼Œå¦‚æœéœ€è¦æ·˜æ±°æ•°æ®ï¼Œå°±åªéœ€è¦æ·˜æ±°é˜Ÿé¦–å³å¯ã€‚ä½†æ˜¯è¿™ä¸ªä¾ç„¶æœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœæœ‰ä¸ªæ•°æ®åœ¨ 1 ä¸ªå°æ—¶çš„å‰ 59 åˆ†é’Ÿè®¿é—®äº† 1 ä¸‡æ¬¡(å¯è§è¿™æ˜¯ä¸ªçƒ­ç‚¹æ•°æ®),å†åä¸€åˆ†é’Ÿæ²¡æœ‰è®¿é—®è¿™ä¸ªæ•°æ®ï¼Œä½†æ˜¯æœ‰å…¶ä»–çš„æ•°æ®è®¿é—®ï¼Œå°±å¯¼è‡´äº†æˆ‘ä»¬è¿™ä¸ªçƒ­ç‚¹æ•°æ®è¢«æ·˜æ±°ã€‚</li>
<li><strong>LFU</strong> - æœ€è¿‘æœ€å°‘é¢‘ç‡ä½¿ç”¨ã€‚åœ¨è¿™ç§ç®—æ³•ä¸­åˆå¯¹ä¸Šé¢è¿›è¡Œäº†ä¼˜åŒ–ï¼Œåˆ©ç”¨é¢å¤–çš„ç©ºé—´è®°å½•æ¯ä¸ªæ•°æ®çš„ä½¿ç”¨é¢‘ç‡ï¼Œç„¶åé€‰å‡ºé¢‘ç‡æœ€ä½è¿›è¡Œæ·˜æ±°ã€‚è¿™æ ·å°±é¿å…äº† LRU ä¸èƒ½å¤„ç†æ—¶é—´æ®µçš„é—®é¢˜ã€‚</li>
</ul>
<p>è¿™ä¸‰ç§ç¼“å­˜æ·˜æ±°ç®—æ³•ï¼Œå®ç°å¤æ‚åº¦ä¸€ä¸ªæ¯”ä¸€ä¸ªé«˜ï¼ŒåŒæ ·çš„å‘½ä¸­ç‡ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”ä¸€ä¸ªå¥½ã€‚è€Œæˆ‘ä»¬ä¸€èˆ¬æ¥è¯´é€‰æ‹©çš„æ–¹æ¡ˆå±…ä¸­å³å¯ï¼Œå³å®ç°æˆæœ¬ä¸æ˜¯å¤ªé«˜ï¼Œè€Œå‘½ä¸­ç‡ä¹Ÿè¿˜è¡Œçš„ LRUã€‚</p>
<h3 id="15-ç¼“å­˜çš„åˆ†ç±»"><a class="markdownIt-Anchor" href="#15-ç¼“å­˜çš„åˆ†ç±»"></a> 1.5. ç¼“å­˜çš„åˆ†ç±»</h3>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç¼“å­˜çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œä»éƒ¨ç½²è§’åº¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ç¼“å­˜åº”ç”¨ã€‚</p>
<ul>
<li><strong>CDN ç¼“å­˜</strong> - å­˜æ”¾ HTMLã€CSSã€JS ç­‰é™æ€èµ„æºã€‚</li>
<li><strong>åå‘ä»£ç†ç¼“å­˜</strong> - åŠ¨é™åˆ†ç¦»ï¼Œåªç¼“å­˜ç”¨æˆ·è¯·æ±‚çš„é™æ€èµ„æºã€‚</li>
<li><strong>è¿›ç¨‹å†…ç¼“å­˜</strong> - ç¼“å­˜åº”ç”¨å­—å…¸ç­‰å¸¸ç”¨æ•°æ®ã€‚</li>
<li><strong>åˆ†å¸ƒå¼ç¼“å­˜</strong> - ç¼“å­˜æ•°æ®åº“ä¸­çš„çƒ­ç‚¹æ•°æ®ã€‚</li>
</ul>
<h3 id="16-ç¼“å­˜æ•´ä½“æ¶æ„"><a class="markdownIt-Anchor" href="#16-ç¼“å­˜æ•´ä½“æ¶æ„"></a> 1.6. ç¼“å­˜æ•´ä½“æ¶æ„</h3>
<p>é€šå¸¸ï¼Œç½‘ç«™çš„ç¼“å­˜æ•´ä½“æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/technology/cache/ç¼“å­˜æ•´ä½“æ¶æ„.png!zp" /></div>
è¯·æ±‚è¿‡ç¨‹ï¼š
<ol>
<li>æµè§ˆå™¨å‘å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œå¦‚æœ CDN æœ‰ç¼“å­˜åˆ™ç›´æ¥è¿”å›ï¼›</li>
<li>å¦‚æœ CDN æ— ç¼“å­˜ï¼Œåˆ™è®¿é—®åå‘ä»£ç†æœåŠ¡å™¨ï¼›</li>
<li>å¦‚æœåå‘ä»£ç†æœåŠ¡å™¨æœ‰ç¼“å­˜åˆ™ç›´æ¥è¿”å›ï¼›</li>
<li>å¦‚æœåå‘ä»£ç†æœåŠ¡å™¨æ— ç¼“å­˜æˆ–åŠ¨æ€è¯·æ±‚ï¼Œåˆ™è®¿é—®åº”ç”¨æœåŠ¡å™¨ï¼›</li>
<li>åº”ç”¨æœåŠ¡å™¨è®¿é—®è¿›ç¨‹å†…ç¼“å­˜ï¼›å¦‚æœæœ‰ç¼“å­˜ï¼Œåˆ™è¿”å›ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ç¼“å­˜æ•°æ®ï¼›ï¼ˆåŠ¨æ€è¯·æ±‚ä¸ç¼“å­˜ï¼‰</li>
<li>å¦‚æœè¿›ç¨‹å†…ç¼“å­˜æ— æ•°æ®ï¼Œåˆ™è¯»å–åˆ†å¸ƒå¼ç¼“å­˜ï¼›å¹¶è¿”å›åº”ç”¨æœåŠ¡å™¨ï¼›åº”ç”¨æœåŠ¡å™¨å°†æ•°æ®ç¼“å­˜åˆ°æœ¬åœ°ç¼“å­˜ï¼ˆéƒ¨åˆ†ï¼‰ï¼›</li>
<li>å¦‚æœåˆ†å¸ƒå¼ç¼“å­˜æ— æ•°æ®ï¼Œåˆ™åº”ç”¨ç¨‹åºè¯»å–æ•°æ®åº“æ•°æ®ï¼Œå¹¶æ”¾å…¥åˆ†å¸ƒå¼ç¼“å­˜ï¼›</li>
</ol>
<h2 id="2-cdn-ç¼“å­˜"><a class="markdownIt-Anchor" href="#2-cdn-ç¼“å­˜"></a> 2. CDN ç¼“å­˜</h2>
<blockquote>
<p><strong>CDN å°†æ•°æ®ç¼“å­˜åˆ°ç¦»ç”¨æˆ·ç‰©ç†è·ç¦»æœ€è¿‘çš„æœåŠ¡å™¨ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥å°±è¿‘è·å–è¯·æ±‚å†…å®¹ã€‚CDN ä¸€èˆ¬ç¼“å­˜é™æ€èµ„æºæ–‡ä»¶ï¼ˆé¡µé¢ï¼Œè„šæœ¬ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘ï¼Œæ–‡ä»¶ç­‰ï¼‰</strong>ã€‚</p>
<p>å›½å†…ç½‘ç»œå¼‚å¸¸å¤æ‚ï¼Œè·¨è¿è¥å•†çš„ç½‘ç»œè®¿é—®ä¼šå¾ˆæ…¢ã€‚ä¸ºäº†è§£å†³è·¨è¿è¥å•†æˆ–å„åœ°ç”¨æˆ·è®¿é—®é—®é¢˜ï¼Œå¯ä»¥åœ¨é‡è¦çš„åŸå¸‚ï¼Œéƒ¨ç½² CDN åº”ç”¨ã€‚ä½¿ç”¨æˆ·å°±è¿‘è·å–æ‰€éœ€å†…å®¹ï¼Œé™ä½ç½‘ç»œæ‹¥å¡ï¼Œæé«˜ç”¨æˆ·è®¿é—®å“åº”é€Ÿåº¦å’Œå‘½ä¸­ç‡ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559138689425.png!zp"/></div>
### 2.1. CDN åŸç†
<p>CDN çš„åŸºæœ¬åŸç†æ˜¯å¹¿æ³›é‡‡ç”¨å„ç§ç¼“å­˜æœåŠ¡å™¨ï¼Œå°†è¿™äº›ç¼“å­˜æœåŠ¡å™¨åˆ†å¸ƒåˆ°ç”¨æˆ·è®¿é—®ç›¸å¯¹é›†ä¸­çš„åœ°åŒºæˆ–ç½‘ç»œä¸­ï¼Œåœ¨ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶ï¼Œåˆ©ç”¨å…¨å±€è´Ÿè½½æŠ€æœ¯å°†ç”¨æˆ·çš„è®¿é—®æŒ‡å‘è·ç¦»æœ€è¿‘çš„å·¥ä½œæ­£å¸¸çš„ç¼“å­˜æœåŠ¡å™¨ä¸Šï¼Œç”±ç¼“å­˜æœåŠ¡å™¨ç›´æ¥å“åº”ç”¨æˆ·è¯·æ±‚ã€‚</p>
<p>ï¼ˆ1ï¼‰æœªéƒ¨ç½² CDN åº”ç”¨å‰çš„ç½‘ç»œè·¯å¾„ï¼š</p>
<ul>
<li>è¯·æ±‚ï¼šæœ¬æœºç½‘ç»œï¼ˆå±€åŸŸç½‘ï¼‰=&gt; è¿è¥å•†ç½‘ç»œ =&gt; åº”ç”¨æœåŠ¡å™¨æœºæˆ¿</li>
<li>å“åº”ï¼šåº”ç”¨æœåŠ¡å™¨æœºæˆ¿ =&gt; è¿è¥å•†ç½‘ç»œ =&gt; æœ¬æœºç½‘ç»œï¼ˆå±€åŸŸç½‘ï¼‰</li>
</ul>
<p>åœ¨ä¸è€ƒè™‘å¤æ‚ç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œä»è¯·æ±‚åˆ°å“åº”éœ€è¦ç»è¿‡ 3 ä¸ªèŠ‚ç‚¹ï¼Œ6 ä¸ªæ­¥éª¤å®Œæˆä¸€æ¬¡ç”¨æˆ·è®¿é—®æ“ä½œã€‚</p>
<p>ï¼ˆ2ï¼‰éƒ¨ç½² CDN åº”ç”¨åç½‘ç»œè·¯å¾„ï¼š</p>
<ul>
<li>è¯·æ±‚ï¼šæœ¬æœºç½‘ç»œï¼ˆå±€åŸŸç½‘ï¼‰ =&gt; è¿è¥å•†ç½‘ç»œ</li>
<li>å“åº”ï¼šè¿è¥å•†ç½‘ç»œ =&gt; æœ¬æœºç½‘ç»œï¼ˆå±€åŸŸç½‘ï¼‰</li>
</ul>
<p>åœ¨ä¸è€ƒè™‘å¤æ‚ç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œä»è¯·æ±‚åˆ°å“åº”éœ€è¦ç»è¿‡ 2 ä¸ªèŠ‚ç‚¹ï¼Œ2 ä¸ªæ­¥éª¤å®Œæˆä¸€æ¬¡ç”¨æˆ·è®¿é—®æ“ä½œã€‚</p>
<p>ä¸ä¸éƒ¨ç½² CDN æœåŠ¡ç›¸æ¯”ï¼Œå‡å°‘äº† 1 ä¸ªèŠ‚ç‚¹ï¼Œ4 ä¸ªæ­¥éª¤çš„è®¿é—®ã€‚æå¤§çš„æé«˜çš„ç³»ç»Ÿçš„å“åº”é€Ÿåº¦ã€‚</p>
<h3 id="22-cdn-ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#22-cdn-ç‰¹ç‚¹"></a> 2.2. CDN ç‰¹ç‚¹</h3>
<ul>
<li><strong>ä¼˜ç‚¹</strong>
<ul>
<li><strong>æœ¬åœ° Cache åŠ é€Ÿ</strong> - æå‡è®¿é—®é€Ÿåº¦ï¼Œå°¤å…¶å«æœ‰å¤§é‡å›¾ç‰‡å’Œé™æ€é¡µé¢ç«™ç‚¹ï¼›</li>
<li><strong>é•œåƒæœåŠ¡</strong> - æ¶ˆé™¤äº†ä¸åŒè¿è¥å•†ä¹‹é—´äº’è”çš„ç“¶é¢ˆé€ æˆçš„å½±å“ï¼Œå®ç°äº†è·¨è¿è¥å•†çš„ç½‘ç»œåŠ é€Ÿï¼Œä¿è¯ä¸åŒç½‘ç»œä¸­çš„ç”¨æˆ·éƒ½èƒ½å¾—åˆ°è‰¯å¥½çš„è®¿é—®è´¨é‡ï¼›</li>
<li><strong>è¿œç¨‹åŠ é€Ÿ</strong> - è¿œç¨‹è®¿é—®ç”¨æˆ·æ ¹æ® DNS è´Ÿè½½å‡è¡¡æŠ€æœ¯æ™ºèƒ½è‡ªåŠ¨é€‰æ‹© Cache æœåŠ¡å™¨ï¼Œé€‰æ‹©æœ€å¿«çš„ Cache æœåŠ¡å™¨ï¼ŒåŠ å¿«è¿œç¨‹è®¿é—®çš„é€Ÿåº¦ï¼›</li>
<li><strong>å¸¦å®½ä¼˜åŒ–</strong> - è‡ªåŠ¨ç”ŸæˆæœåŠ¡å™¨çš„è¿œç¨‹ Mirrorï¼ˆé•œåƒï¼‰cache æœåŠ¡å™¨ï¼Œè¿œç¨‹ç”¨æˆ·è®¿é—®æ—¶ä» cache æœåŠ¡å™¨ä¸Šè¯»å–æ•°æ®ï¼Œå‡å°‘è¿œç¨‹è®¿é—®çš„å¸¦å®½ã€åˆ†æ‹…ç½‘ç»œæµé‡ã€å‡è½»åŸç«™ç‚¹ WEB æœåŠ¡å™¨è´Ÿè½½ç­‰åŠŸèƒ½ã€‚</li>
<li><strong>é›†ç¾¤æŠ—æ”»å‡»</strong> - å¹¿æ³›åˆ†å¸ƒçš„ CDN èŠ‚ç‚¹åŠ ä¸ŠèŠ‚ç‚¹ä¹‹é—´çš„æ™ºèƒ½å†—ä½™æœºåˆ¶ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é¢„é˜²é»‘å®¢å…¥ä¾µä»¥åŠé™ä½å„ç§ D.D.o.S æ”»å‡»å¯¹ç½‘ç«™çš„å½±å“ï¼ŒåŒæ—¶ä¿è¯è¾ƒå¥½çš„æœåŠ¡è´¨é‡ã€‚</li>
</ul>
</li>
<li><strong>ç¼ºç‚¹</strong>
<ul>
<li><strong>ä¸é€‚å®œç¼“å­˜åŠ¨æ€èµ„æº</strong>
<ul>
<li>è§£å†³æ–¹æ¡ˆï¼šä¸»è¦ç¼“å­˜é™æ€èµ„æºï¼ŒåŠ¨æ€èµ„æºå»ºç«‹å¤šçº§ç¼“å­˜æˆ–å‡†å®æ—¶åŒæ­¥ï¼›</li>
</ul>
</li>
<li><strong>å­˜åœ¨æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜</strong>
<ul>
<li>è§£å†³æ–¹æ¡ˆï¼ˆä¸»è¦æ˜¯åœ¨æ€§èƒ½å’Œæ•°æ®ä¸€è‡´æ€§äºŒè€…é—´å¯»æ‰¾ä¸€ä¸ªå¹³è¡¡ï¼‰
<ul>
<li>è®¾ç½®ç¼“å­˜å¤±æ•ˆæ—¶é—´ï¼ˆ1 ä¸ªå°æ—¶ï¼Œè¿‡æœŸååŒæ­¥æ•°æ®ï¼‰ã€‚</li>
<li>é’ˆå¯¹èµ„æºè®¾ç½®ç‰ˆæœ¬å·ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="3-åå‘ä»£ç†ç¼“å­˜"><a class="markdownIt-Anchor" href="#3-åå‘ä»£ç†ç¼“å­˜"></a> 3. åå‘ä»£ç†ç¼“å­˜</h2>
<blockquote>
<p><strong>åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å— internet ä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ internet ä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚</strong></p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/web/nginx/reverse-proxy.png!zp"/></div>
### 3.1. ç¼“å­˜åŸç†
<p>åå‘ä»£ç†ä½äºåº”ç”¨æœåŠ¡å™¨åŒä¸€ç½‘ç»œï¼Œå¤„ç†æ‰€æœ‰å¯¹ WEB æœåŠ¡å™¨çš„è¯·æ±‚ã€‚</p>
<p>åå‘ä»£ç†ç¼“å­˜çš„åŸç†ï¼š</p>
<ul>
<li>å¦‚æœç”¨æˆ·è¯·æ±‚çš„é¡µé¢åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šæœ‰ç¼“å­˜çš„è¯ï¼Œä»£ç†æœåŠ¡å™¨ç›´æ¥å°†ç¼“å­˜å†…å®¹å‘é€ç»™ç”¨æˆ·ã€‚</li>
<li>å¦‚æœæ²¡æœ‰ç¼“å­˜åˆ™å…ˆå‘ WEB æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå–å›æ•°æ®ï¼Œæœ¬åœ°ç¼“å­˜åå†å‘é€ç»™ç”¨æˆ·ã€‚</li>
</ul>
<p>è¿™ç§æ–¹å¼é€šè¿‡é™ä½å‘ WEB æœåŠ¡å™¨çš„è¯·æ±‚æ•°ï¼Œä»è€Œé™ä½äº† WEB æœåŠ¡å™¨çš„è´Ÿè½½ã€‚</p>
<p><strong>åå‘ä»£ç†ç¼“å­˜ä¸€èˆ¬é’ˆå¯¹çš„æ˜¯é™æ€èµ„æºï¼Œè€Œå°†åŠ¨æ€èµ„æºè¯·æ±‚è½¬å‘åˆ°åº”ç”¨æœåŠ¡å™¨å¤„ç†</strong>ã€‚å¸¸ç”¨çš„ç¼“å­˜åº”ç”¨æœåŠ¡å™¨æœ‰ Varnishï¼ŒNgnixï¼ŒSquidã€‚</p>
<h3 id="32-ä»£ç†ç¼“å­˜æ¯”è¾ƒ"><a class="markdownIt-Anchor" href="#32-ä»£ç†ç¼“å­˜æ¯”è¾ƒ"></a> 3.2. ä»£ç†ç¼“å­˜æ¯”è¾ƒ</h3>
<p>å¸¸ç”¨çš„ä»£ç†ç¼“å­˜æœ‰ Varnishï¼ŒSquidï¼ŒNgnixï¼Œç®€å•æ¯”è¾ƒå¦‚ä¸‹ï¼š</p>
<ul>
<li>Varnish å’Œ Squid æ˜¯ä¸“ä¸šçš„ cache æœåŠ¡ï¼ŒNgnix éœ€è¦ç¬¬ä¸‰æ–¹æ¨¡å—æ”¯æŒï¼›</li>
<li>Varnish é‡‡ç”¨å†…å­˜å‹ç¼“å­˜ï¼Œé¿å…äº†é¢‘ç¹åœ¨å†…å­˜ã€ç£ç›˜ä¸­äº¤æ¢æ–‡ä»¶ï¼Œæ€§èƒ½æ¯” Squid é«˜ï¼›</li>
<li>Varnish ç”±äºæ˜¯å†…å­˜ cacheï¼Œæ‰€ä»¥å¯¹å°æ–‡ä»¶å¦‚ cssã€jsã€å°å›¾ç‰‡çš„æ”¯æŒå¾ˆæ£’ï¼Œåç«¯çš„æŒä¹…åŒ–ç¼“å­˜å¯ä»¥é‡‡ç”¨çš„æ˜¯ Squid æˆ– ATSï¼›</li>
<li>Squid åŠŸèƒ½å…¨è€Œå¤§ï¼Œé€‚åˆäºå„ç§é™æ€çš„æ–‡ä»¶ç¼“å­˜ï¼Œä¸€èˆ¬ä¼šåœ¨å‰ç«¯æŒ‚ä¸€ä¸ª HAProxy æˆ– Ngnix åšè´Ÿè½½å‡è¡¡è·‘å¤šä¸ªå®ä¾‹ï¼›</li>
<li>Nginx é‡‡ç”¨ç¬¬ä¸‰æ–¹æ¨¡å— ncache åšçš„ç¼“å†²ï¼Œæ€§èƒ½åŸºæœ¬è¾¾åˆ° Varnishï¼Œä¸€èˆ¬ä½œä¸ºåå‘ä»£ç†ä½¿ç”¨ï¼Œå¯ä»¥å®ç°ç®€å•çš„ç¼“å­˜ã€‚</li>
</ul>
<h2 id="4-è¿›ç¨‹å†…ç¼“å­˜"><a class="markdownIt-Anchor" href="#4-è¿›ç¨‹å†…ç¼“å­˜"></a> 4. è¿›ç¨‹å†…ç¼“å­˜</h2>
<blockquote>
<p>è¿›ç¨‹å†…ç¼“å­˜æ˜¯æŒ‡åº”ç”¨å†…éƒ¨çš„ç¼“å­˜ï¼Œæ ‡å‡†çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä¸€èˆ¬æœ‰å¤šçº§ç¼“å­˜æ„æˆã€‚æœ¬åœ°ç¼“å­˜æ˜¯ç¦»åº”ç”¨æœ€è¿‘çš„ç¼“å­˜ï¼Œä¸€èˆ¬å¯ä»¥å°†æ•°æ®ç¼“å­˜åˆ°ç¡¬ç›˜æˆ–å†…å­˜ã€‚</p>
</blockquote>
<ul>
<li><code>ç¡¬ç›˜ç¼“å­˜</code> - å°†æ•°æ®ç¼“å­˜åˆ°ç¡¬ç›˜åˆ°ï¼Œè¯»å–æ—¶ä»ç¡¬ç›˜è¯»å–ã€‚åŸç†æ˜¯ç›´æ¥è¯»å–æœ¬æœºæ–‡ä»¶ï¼Œå‡å°‘äº†ç½‘ç»œä¼ è¾“æ¶ˆè€—ï¼Œæ¯”é€šè¿‡ç½‘ç»œè¯»å–æ•°æ®åº“é€Ÿåº¦æ›´å¿«ã€‚å¯ä»¥åº”ç”¨åœ¨å¯¹é€Ÿåº¦è¦æ±‚ä¸æ˜¯å¾ˆé«˜ï¼Œä½†éœ€è¦å¤§é‡ç¼“å­˜å­˜å‚¨çš„åœºæ™¯ã€‚</li>
<li><code>å†…å­˜ç¼“å­˜</code> - ç›´æ¥å°†æ•°æ®å­˜å‚¨åˆ°æœ¬æœºå†…å­˜ä¸­ï¼Œé€šè¿‡ç¨‹åºç›´æ¥ç»´æŠ¤ç¼“å­˜å¯¹è±¡ï¼Œæ˜¯è®¿é—®é€Ÿåº¦æœ€å¿«çš„æ–¹å¼ã€‚</li>
</ul>
<p>å¸¸è§çš„æœ¬åœ°ç¼“å­˜å®ç°æ–¹æ¡ˆï¼šHashMapã€Guava Cacheã€Caffeineã€Ehcacheã€‚</p>
<h3 id="41-concurrenthashmap"><a class="markdownIt-Anchor" href="#41-concurrenthashmap"></a> 4.1. ConcurrentHashMap</h3>
<p>æœ€ç®€å•çš„è¿›ç¨‹å†…ç¼“å­˜å¯ä»¥é€šè¿‡ JDK è‡ªå¸¦çš„ <code>HashMap</code> æˆ– <code>ConcurrentHashMap</code> å®ç°ã€‚</p>
<p>é€‚ç”¨åœºæ™¯ï¼šä¸éœ€è¦æ·˜æ±°çš„ç¼“å­˜æ•°æ®ã€‚</p>
<p>ç¼ºç‚¹ï¼šæ— æ³•è¿›è¡Œç¼“å­˜æ·˜æ±°ï¼Œå†…å­˜ä¼šæ— é™åˆ¶çš„å¢é•¿ã€‚</p>
<h3 id="42-lruhashmap"><a class="markdownIt-Anchor" href="#42-lruhashmap"></a> 4.2. LRUHashMap</h3>
<p>å¯ä»¥é€šè¿‡ç»§æ‰¿ <code>LinkedHashMap</code> æ¥å®ç°ä¸€ä¸ªç®€å•çš„ <code>LRUHashMap</code>ã€‚é‡å†™ <code>removeEldestEntry</code> æ–¹æ³•ï¼Œå³å¯å®Œæˆä¸€ä¸ªç®€å•çš„æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ã€‚</p>
<ul>
<li>ç¼ºç‚¹ï¼š
<ul>
<li>é”ç«äº‰ä¸¥é‡ï¼Œæ€§èƒ½æ¯”è¾ƒä½ã€‚</li>
<li>ä¸æ”¯æŒè¿‡æœŸæ—¶é—´</li>
<li>ä¸æ”¯æŒè‡ªåŠ¨åˆ·æ–°</li>
</ul>
</li>
</ul>
<h3 id="43-guava-cache"><a class="markdownIt-Anchor" href="#43-guava-cache"></a> 4.3. Guava Cache</h3>
<p>è§£å†³äº† <code>LRUHashMap</code> ä¸­çš„å‡ ä¸ªç¼ºç‚¹ã€‚</p>
<p>Guava Cache é‡‡ç”¨äº†ç±»ä¼¼ <code>ConcurrentHashMap</code> çš„æ€æƒ³ï¼Œåˆ†æ®µåŠ é”ï¼Œå‡å°‘é”ç«äº‰ã€‚</p>
<p>Guava Cache å¯¹äºè¿‡æœŸçš„ Entry å¹¶æ²¡æœ‰é©¬ä¸Šè¿‡æœŸ(ä¹Ÿå°±æ˜¯å¹¶æ²¡æœ‰åå°çº¿ç¨‹ä¸€ç›´åœ¨æ‰«)ï¼Œè€Œæ˜¯é€šè¿‡è¿›è¡Œè¯»å†™æ“ä½œçš„æ—¶å€™è¿›è¡Œè¿‡æœŸå¤„ç†ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯é¿å…åå°çº¿ç¨‹æ‰«æçš„æ—¶å€™è¿›è¡Œå…¨å±€åŠ é”ã€‚</p>
<p>ç›´æ¥é€šè¿‡æŸ¥è¯¢ï¼Œåˆ¤æ–­å…¶æ˜¯å¦æ»¡è¶³åˆ·æ–°æ¡ä»¶ï¼Œè¿›è¡Œåˆ·æ–°ã€‚</p>
<h3 id="44-caffeine"><a class="markdownIt-Anchor" href="#44-caffeine"></a> 4.4. Caffeine</h3>
<p>Caffeine å®ç°äº† W-TinyLFU(LFU+LRU ç®—æ³•çš„å˜ç§)ï¼Œå…¶å‘½ä¸­ç‡å’Œè¯»å†™ååé‡å¤§å¤§ä¼˜äº Guava Cacheã€‚</p>
<p>å…¶å®ç°åŸç†è¾ƒå¤æ‚ï¼Œå¯ä»¥å‚è€ƒ<a href="https://juejin.im/post/5b7593496fb9a009b62904fa#comment" target="_blank" rel="noopener">ä½ åº”è¯¥çŸ¥é“çš„ç¼“å­˜è¿›åŒ–å²</a>ã€‚</p>
<h3 id="45-é€‰æ‹©è¿›ç¨‹å†…ç¼“å­˜"><a class="markdownIt-Anchor" href="#45-é€‰æ‹©è¿›ç¨‹å†…ç¼“å­˜"></a> 4.5. é€‰æ‹©è¿›ç¨‹å†…ç¼“å­˜</h3>
<table>
<thead>
<tr>
<th>æ¯”è¾ƒé¡¹</th>
<th>ConcurrentHashMap</th>
<th>LRUMap</th>
<th>Ehcache</th>
<th>Guava Cache</th>
<th>Caffeine</th>
</tr>
</thead>
<tbody>
<tr>
<td>è¯»å†™æ€§èƒ½</td>
<td>å¾ˆå¥½ï¼Œåˆ†æ®µé”</td>
<td>ä¸€èˆ¬ï¼Œå…¨å±€åŠ é”</td>
<td>å¥½</td>
<td>å¥½ï¼Œéœ€è¦åšæ·˜æ±°æ“ä½œ</td>
<td>å¾ˆå¥½</td>
</tr>
<tr>
<td>æ·˜æ±°ç®—æ³•</td>
<td>æ— </td>
<td>LRUï¼Œä¸€èˆ¬</td>
<td>æ”¯æŒå¤šç§æ·˜æ±°ç®—æ³•,LRU,LFU,FIFO</td>
<td>LRUï¼Œä¸€èˆ¬</td>
<td>W-TinyLFU, å¾ˆå¥½</td>
</tr>
<tr>
<td>åŠŸèƒ½ä¸°å¯Œç¨‹åº¦</td>
<td>åŠŸèƒ½æ¯”è¾ƒç®€å•</td>
<td>åŠŸèƒ½æ¯”è¾ƒå•ä¸€</td>
<td>åŠŸèƒ½å¾ˆä¸°å¯Œ</td>
<td>åŠŸèƒ½å¾ˆä¸°å¯Œï¼Œæ”¯æŒåˆ·æ–°å’Œè™šå¼•ç”¨ç­‰</td>
<td>åŠŸèƒ½å’Œ Guava Cache ç±»ä¼¼</td>
</tr>
<tr>
<td>å·¥å…·å¤§å°</td>
<td>jdk è‡ªå¸¦ç±»ï¼Œå¾ˆå°</td>
<td>åŸºäº LinkedHashMapï¼Œè¾ƒå°</td>
<td>å¾ˆå¤§ï¼Œæœ€æ–°ç‰ˆæœ¬ 1.4MB</td>
<td>æ˜¯ Guava å·¥å…·ç±»ä¸­çš„ä¸€ä¸ªå°éƒ¨åˆ†ï¼Œè¾ƒå°</td>
<td>ä¸€èˆ¬ï¼Œæœ€æ–°ç‰ˆæœ¬ 644KB</td>
</tr>
<tr>
<td>æ˜¯å¦æŒä¹…åŒ–</td>
<td>å¦</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>å¦</td>
<td>å¦</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒé›†ç¾¤</td>
<td>å¦</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>å¦</td>
<td>å¦</td>
</tr>
</tbody>
</table>
<ul>
<li><strong><code>ConcurrentHashMap</code></strong> - æ¯”è¾ƒé€‚åˆç¼“å­˜æ¯”è¾ƒå›ºå®šä¸å˜çš„å…ƒç´ ï¼Œä¸”ç¼“å­˜çš„æ•°é‡è¾ƒå°çš„ã€‚è™½ç„¶ä»ä¸Šé¢è¡¨æ ¼ä¸­æ¯”èµ·æ¥æœ‰ç‚¹é€Šè‰²ï¼Œä½†æ˜¯å…¶ç”±äºæ˜¯ JDK è‡ªå¸¦çš„ç±»ï¼Œåœ¨å„ç§æ¡†æ¶ä¸­ä¾ç„¶æœ‰å¤§é‡çš„ä½¿ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç”¨æ¥ç¼“å­˜æˆ‘ä»¬åå°„çš„ Methodï¼ŒField ç­‰ç­‰ï¼›ä¹Ÿå¯ä»¥ç¼“å­˜ä¸€äº›é“¾æ¥ï¼Œé˜²æ­¢å…¶é‡å¤å»ºç«‹ã€‚åœ¨ Caffeine ä¸­ä¹Ÿæ˜¯ä½¿ç”¨çš„ <code>ConcurrentHashMap</code> æ¥å­˜å‚¨å…ƒç´ ã€‚</li>
<li><strong><code>LRUMap</code></strong> - å¦‚æœä¸æƒ³å¼•å…¥ç¬¬ä¸‰æ–¹åŒ…ï¼Œåˆæƒ³ä½¿ç”¨æ·˜æ±°ç®—æ³•æ·˜æ±°æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªã€‚</li>
<li><strong><code>Ehcache</code></strong> - ç”±äºå…¶ jar åŒ…å¾ˆå¤§ï¼Œè¾ƒé‡é‡çº§ã€‚å¯¹äºéœ€è¦æŒä¹…åŒ–å’Œé›†ç¾¤çš„ä¸€äº›åŠŸèƒ½çš„ï¼Œå¯ä»¥é€‰æ‹© Ehcacheã€‚ç¬”è€…æ²¡æ€ä¹ˆä½¿ç”¨è¿‡è¿™ä¸ªç¼“å­˜ï¼Œå¦‚æœè¦é€‰æ‹©çš„è¯ï¼Œå¯ä»¥é€‰æ‹©åˆ†å¸ƒå¼ç¼“å­˜æ¥æ›¿ä»£ Ehcacheã€‚</li>
<li><strong><code>Guava Cache</code></strong> - Guava è¿™ä¸ª jar åŒ…åœ¨å¾ˆå¤š Java åº”ç”¨ç¨‹åºä¸­éƒ½æœ‰å¤§é‡çš„å¼•å…¥ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™å…¶å®æ˜¯ç›´æ¥ç”¨å°±å¥½äº†ï¼Œå¹¶ä¸”å…¶æœ¬èº«æ˜¯è½»é‡çº§çš„è€Œä¸”åŠŸèƒ½è¾ƒä¸ºä¸°å¯Œï¼Œåœ¨ä¸äº†è§£ Caffeine çš„æƒ…å†µä¸‹å¯ä»¥é€‰æ‹© Guava Cacheã€‚</li>
<li><strong><code>Caffeine</code></strong> - å…¶åœ¨å‘½ä¸­ç‡ï¼Œè¯»å†™æ€§èƒ½ä¸Šéƒ½æ¯” Guava Cache å¥½å¾ˆå¤šï¼Œå¹¶ä¸”å…¶ API å’Œ Guava cache åŸºæœ¬ä¸€è‡´ï¼Œç”šè‡³ä¼šå¤šä¸€ç‚¹ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ä½¿ç”¨ Caffeineï¼Œå–å¾—è¿‡ä¸é”™çš„æ•ˆæœã€‚</li>
</ul>
<p>æ€»ç»“ä¸€ä¸‹ï¼šå¦‚æœä¸éœ€è¦æ·˜æ±°ç®—æ³•åˆ™é€‰æ‹© <code>ConcurrentHashMap</code>ï¼Œå¦‚æœéœ€è¦æ·˜æ±°ç®—æ³•å’Œä¸€äº›ä¸°å¯Œçš„ APIï¼Œæ¨èé€‰æ‹© Caffeineã€‚</p>
<h2 id="5-åˆ†å¸ƒå¼ç¼“å­˜"><a class="markdownIt-Anchor" href="#5-åˆ†å¸ƒå¼ç¼“å­˜"></a> 5. åˆ†å¸ƒå¼ç¼“å­˜</h2>
<blockquote>
<p><strong>åˆ†å¸ƒå¼ç¼“å­˜è§£å†³äº†è¿›ç¨‹å†…ç¼“å­˜æœ€å¤§çš„é—®é¢˜ï¼šå¦‚æœåº”ç”¨æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼ŒèŠ‚ç‚¹ä¹‹é—´æ— æ³•å…±äº«å½¼æ­¤çš„è¿›ç¨‹å†…ç¼“å­˜</strong>ã€‚</p>
<p>åˆ†å¸ƒå¼ç¼“å­˜çš„åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>ç¼“å­˜ç»è¿‡å¤æ‚è®¡ç®—å¾—åˆ°çš„æ•°æ®</li>
<li>ç¼“å­˜ç³»ç»Ÿä¸­é¢‘ç¹è®¿é—®çš„çƒ­ç‚¹æ•°æ®ï¼Œå‡è½»æ•°æ®åº“å‹åŠ›</li>
</ul>
</blockquote>
<p>ä¸åŒåˆ†å¸ƒå¼ç¼“å­˜çš„å®ç°åŸç†å¾€å¾€æœ‰æ¯”è¾ƒå¤§çš„å·®å¼‚ã€‚æœ¬æ–‡ä¸»è¦é’ˆå¯¹ Memcached å’Œ Redis è¿›è¡Œè¯´æ˜ã€‚</p>
<h3 id="51-memcache"><a class="markdownIt-Anchor" href="#51-memcache"></a> 5.1. Memcache</h3>
<blockquote>
<p><a href="https://memcached.org/" target="_blank" rel="noopener">Memcache</a> æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ï¼Œåˆ†å¸ƒå¼å†…å­˜å¯¹è±¡ç¼“å­˜ç³»ç»Ÿï¼Œé€šè¿‡åœ¨å†…å­˜é‡Œç»´æŠ¤ä¸€ä¸ªç»Ÿä¸€çš„å·¨å¤§çš„ hash è¡¨ï¼Œå®ƒèƒ½å¤Ÿç”¨æ¥å­˜å‚¨å„ç§æ ¼å¼çš„æ•°æ®ï¼ŒåŒ…æ‹¬å›¾åƒã€è§†é¢‘ã€æ–‡ä»¶ä»¥åŠæ•°æ®åº“æ£€ç´¢çš„ç»“æœç­‰ã€‚</p>
<p>ç®€å•çš„è¯´å°±æ˜¯ï¼šå°†æ•°æ®ç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œç„¶åä»å†…å­˜ä¸­è¯»å–ï¼Œä»è€Œå¤§å¤§æé«˜è¯»å–é€Ÿåº¦ã€‚</p>
</blockquote>
<h4 id="memcache-ç‰¹æ€§"><a class="markdownIt-Anchor" href="#memcache-ç‰¹æ€§"></a> Memcache ç‰¹æ€§</h4>
<ul>
<li><strong>ä½¿ç”¨ç‰©ç†å†…å­˜ä½œä¸ºç¼“å­˜åŒºï¼Œå¯ç‹¬ç«‹è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Š</strong>ã€‚æ¯ä¸ªè¿›ç¨‹æœ€å¤§ 2Gï¼Œå¦‚æœæƒ³ç¼“å­˜æ›´å¤šçš„æ•°æ®ï¼Œå¯ä»¥å¼€è¾Ÿæ›´å¤šçš„ Memcache è¿›ç¨‹ï¼ˆä¸åŒç«¯å£ï¼‰æˆ–è€…ä½¿ç”¨åˆ†å¸ƒå¼ Memcache è¿›è¡Œç¼“å­˜ï¼Œå°†æ•°æ®ç¼“å­˜åˆ°ä¸åŒçš„ç‰©ç†æœºæˆ–è€…è™šæ‹Ÿæœºä¸Šã€‚</li>
<li><strong>ä½¿ç”¨ key-value çš„æ–¹å¼æ¥å­˜å‚¨æ•°æ®</strong>ã€‚è¿™æ˜¯ä¸€ç§å•ç´¢å¼•çš„ç»“æ„åŒ–æ•°æ®ç»„ç»‡å½¢å¼ï¼Œå¯ä½¿æ•°æ®é¡¹æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚</li>
<li><strong>åè®®ç®€å•ï¼ŒåŸºäºæ–‡æœ¬è¡Œçš„åè®®</strong>ã€‚ç›´æ¥é€šè¿‡ telnet åœ¨ Memcached æœåŠ¡å™¨ä¸Šå¯è¿›è¡Œå­˜å–æ•°æ®æ“ä½œï¼Œç®€å•ï¼Œæ–¹ä¾¿å¤šç§ç¼“å­˜å‚è€ƒæ­¤åè®®ï¼›</li>
<li><strong>åŸºäº libevent é«˜æ€§èƒ½é€šä¿¡</strong>ã€‚Libevent æ˜¯ä¸€å¥—åˆ©ç”¨ C å¼€å‘çš„ç¨‹åºåº“ï¼Œå®ƒå°† BSD ç³»ç»Ÿçš„ kqueue,Linux ç³»ç»Ÿçš„ epoll ç­‰äº‹ä»¶å¤„ç†åŠŸèƒ½å°è£…æˆä¸€ä¸ªæ¥å£ï¼Œä¸ä¼ ç»Ÿçš„ select ç›¸æ¯”ï¼Œæé«˜äº†æ€§èƒ½ã€‚</li>
<li><strong>åˆ†å¸ƒå¼èƒ½åŠ›å–å†³äº Memcache å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨ä¹‹é—´äº’ä¸é€šä¿¡</strong>ã€‚å„ä¸ª Memcached æœåŠ¡å™¨ä¹‹é—´äº’ä¸é€šä¿¡ï¼Œå„è‡ªç‹¬ç«‹å­˜å–æ•°æ®ï¼Œä¸å…±äº«ä»»ä½•ä¿¡æ¯ã€‚æœåŠ¡å™¨å¹¶ä¸å…·æœ‰åˆ†å¸ƒå¼åŠŸèƒ½ï¼Œåˆ†å¸ƒå¼éƒ¨ç½²å–å†³äº Memcached å®¢æˆ·ç«¯ã€‚</li>
<li><strong>é‡‡ç”¨ LRU ç¼“å­˜æ·˜æ±°ç­–ç•¥</strong>ã€‚åœ¨ Memcached å†…å­˜å‚¨æ•°æ®é¡¹æ—¶ï¼Œå¯ä»¥æŒ‡å®šå®ƒåœ¨ç¼“å­˜çš„å¤±æ•ˆæ—¶é—´ï¼Œé»˜è®¤ä¸ºæ°¸ä¹…ã€‚å½“ Memcached æœåŠ¡å™¨ç”¨å®Œåˆ†é…çš„å†…æ—¶ï¼Œå¤±æ•ˆçš„æ•°æ®è¢«é¦–å…ˆæ›¿æ¢ï¼Œç„¶åä¹Ÿæ˜¯æœ€è¿‘æœªä½¿ç”¨çš„æ•°æ®ã€‚åœ¨ LRU ä¸­ï¼ŒMemcached ä½¿ç”¨çš„æ˜¯ä¸€ç§ Lazy Expiration ç­–ç•¥ï¼Œè‡ªå·±ä¸ä¼šç›‘æ§å­˜å…¥çš„ key/vlue å¯¹æ˜¯å¦è¿‡æœŸï¼Œè€Œæ˜¯åœ¨è·å– key å€¼æ—¶æŸ¥çœ‹è®°å½•çš„æ—¶é—´æˆ³ï¼Œæ£€æŸ¥ key/value å¯¹ç©ºé—´æ˜¯å¦è¿‡æœŸï¼Œè¿™æ ·å¯å‡è½»æœåŠ¡å™¨çš„è´Ÿè½½ã€‚</li>
<li><strong>å†…ç½®äº†ä¸€å¥—é«˜æ•ˆçš„å†…å­˜ç®¡ç†ç®—æ³•</strong>ã€‚è¿™å¥—å†…å­˜ç®¡ç†æ•ˆç‡å¾ˆé«˜ï¼Œè€Œä¸”ä¸ä¼šé€ æˆå†…å­˜ç¢ç‰‡ï¼Œä½†æ˜¯å®ƒæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ä¼šå¯¼è‡´ç©ºé—´æµªè´¹ã€‚å½“å†…å­˜æ»¡åï¼Œé€šè¿‡ LRU ç®—æ³•è‡ªåŠ¨åˆ é™¤ä¸ä½¿ç”¨çš„ç¼“å­˜ã€‚</li>
<li><strong>ä¸æ”¯æŒæŒä¹…åŒ–</strong>ã€‚Memcached æ²¡æœ‰è€ƒè™‘æ•°æ®çš„å®¹ç¾é—®é¢˜ï¼Œé‡å¯æœåŠ¡ï¼Œæ‰€æœ‰æ•°æ®ä¼šä¸¢å¤±ã€‚</li>
</ul>
<h4 id="memcache-å·¥ä½œåŸç†"><a class="markdownIt-Anchor" href="#memcache-å·¥ä½œåŸç†"></a> Memcache å·¥ä½œåŸç†</h4>
<p>ï¼ˆ1ï¼‰å†…å­˜ç®¡ç†</p>
<p>Memcached åˆ©ç”¨ <strong>slab allocation</strong> æœºåˆ¶æ¥åˆ†é…å’Œç®¡ç†å†…å­˜ï¼Œå®ƒæŒ‰ç…§é¢„å…ˆè§„å®šçš„å¤§å°ï¼Œå°†åˆ†é…çš„å†…å­˜åˆ†å‰²æˆç‰¹å®šé•¿åº¦çš„å†…å­˜å—ï¼Œå†æŠŠå°ºå¯¸ç›¸åŒçš„å†…å­˜å—åˆ†æˆç»„ï¼Œæ•°æ®åœ¨å­˜æ”¾æ—¶ï¼Œæ ¹æ®é”®å€¼ å¤§å°å»åŒ¹é… slab å¤§å°ï¼Œæ‰¾å°±è¿‘çš„ slab å­˜æ”¾ï¼Œæ‰€ä»¥å­˜åœ¨ç©ºé—´æµªè´¹ç°è±¡ã€‚</p>
<p>è¿™å¥—å†…å­˜ç®¡ç†æ•ˆç‡å¾ˆé«˜ï¼Œè€Œä¸”ä¸ä¼šé€ æˆå†…å­˜ç¢ç‰‡ï¼Œä½†æ˜¯å®ƒæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ä¼šå¯¼è‡´ç©ºé—´æµªè´¹ã€‚</p>
<p>ï¼ˆ2ï¼‰ç¼“å­˜æ·˜æ±°ç­–ç•¥</p>
<p>Memcached çš„ç¼“å­˜æ·˜æ±°ç­–ç•¥æ˜¯ <strong>LRU</strong> + åˆ°æœŸå¤±æ•ˆç­–ç•¥ã€‚</p>
<p>å½“ä½ åœ¨ Memcached å†…å­˜å‚¨æ•°æ®é¡¹æ—¶ï¼Œä½ æœ‰å¯èƒ½ä¼šæŒ‡å®šå®ƒåœ¨ç¼“å­˜çš„å¤±æ•ˆæ—¶é—´ï¼Œé»˜è®¤ä¸ºæ°¸ä¹…ã€‚å½“ Memcached æœåŠ¡å™¨ç”¨å®Œåˆ†é…çš„å†…æ—¶ï¼Œå¤±æ•ˆçš„æ•°æ®è¢«é¦–å…ˆæ›¿æ¢ï¼Œç„¶åæ˜¯æœ€è¿‘æœªä½¿ç”¨çš„æ•°æ®ã€‚</p>
<p>åœ¨ LRU ä¸­ï¼ŒMemcached ä½¿ç”¨çš„æ˜¯ä¸€ç§ Lazy Expiration ç­–ç•¥ï¼š<strong>Memcached ä¸ä¼šç›‘æ§å­˜å…¥çš„ key/vlue å¯¹æ˜¯å¦è¿‡æœŸ</strong>ï¼Œè€Œæ˜¯åœ¨è·å– key å€¼æ—¶æŸ¥çœ‹è®°å½•çš„æ—¶é—´æˆ³ï¼Œ<strong>æ£€æŸ¥ key/value å¯¹ç©ºé—´æ˜¯å¦è¿‡æœŸ</strong>ï¼Œè¿™æ ·å¯å‡è½»æœåŠ¡å™¨çš„è´Ÿè½½ã€‚</p>
<p>ï¼ˆ3ï¼‰åˆ†åŒº</p>
<p>Memcached æœåŠ¡å™¨ä¹‹é—´å½¼æ­¤ä¸é€šä¿¡ï¼Œå®ƒçš„åˆ†å¸ƒå¼èƒ½åŠ›æ˜¯ä¾èµ–å®¢æˆ·ç«¯æ¥å®ç°ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨å®¢æˆ·ç«¯å®ç°ä¸€ç§ç®—æ³•ï¼Œæ ¹æ® key æ¥è®¡ç®—å‡ºæ•°æ®åº”è¯¥å‘å“ªä¸ªæœåŠ¡å™¨èŠ‚ç‚¹è¯»/å†™ã€‚</p>
<p>è€Œè¿™ç§é€‰å–é›†ç¾¤èŠ‚ç‚¹çš„ç®—æ³•å¸¸è§çš„æœ‰ä¸‰ç§ï¼š</p>
<ul>
<li><strong>å“ˆå¸Œå–ä½™ç®—æ³•</strong> - ä½¿ç”¨å…¬å¼ï¼š<code>hashï¼ˆkeyï¼‰% N</code> è®¡ç®—å‡º <strong>å“ˆå¸Œå€¼</strong> æ¥å†³å®šæ•°æ®æ˜ å°„åˆ°å“ªä¸€ä¸ªèŠ‚ç‚¹ã€‚</li>
<li><strong>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•</strong> - å¯ä»¥å¾ˆå¥½çš„è§£å†³ <strong>ç¨³å®šæ€§é—®é¢˜</strong>ï¼Œå¯ä»¥å°†æ‰€æœ‰çš„ <strong>å­˜å‚¨èŠ‚ç‚¹</strong> æ’åˆ—åœ¨ <strong>é¦–å°¾ç›¸æ¥</strong> çš„ <code>Hash</code> ç¯ä¸Šï¼Œæ¯ä¸ª <code>key</code> åœ¨è®¡ç®— <code>Hash</code> åä¼š <strong>é¡ºæ—¶é’ˆ</strong> æ‰¾åˆ° <strong>ä¸´æ¥</strong> çš„ <strong>å­˜å‚¨èŠ‚ç‚¹</strong> å­˜æ”¾ã€‚è€Œå½“æœ‰èŠ‚ç‚¹ <strong>åŠ å…¥</strong> æˆ– <strong>é€€å‡º</strong> æ—¶ï¼Œä»…å½±å“è¯¥èŠ‚ç‚¹åœ¨ <code>Hash</code> ç¯ä¸Š <strong>é¡ºæ—¶é’ˆç›¸é‚»</strong> çš„ <strong>åç»­èŠ‚ç‚¹</strong>ã€‚</li>
<li><strong>è™šæ‹Ÿ Hash æ§½ç®—æ³•</strong> - ä½¿ç”¨ <strong>åˆ†æ•£åº¦è‰¯å¥½</strong> çš„ <strong>å“ˆå¸Œå‡½æ•°</strong> æŠŠæ‰€æœ‰æ•°æ® <strong>æ˜ å°„</strong> åˆ°ä¸€ä¸ª <strong>å›ºå®šèŒƒå›´</strong> çš„ <strong>æ•´æ•°é›†åˆ</strong> ä¸­ï¼Œæ•´æ•°å®šä¹‰ä¸º <strong>æ§½</strong>ï¼ˆ<code>slot</code>ï¼‰ï¼Œè¿™ä¸ªèŒƒå›´ä¸€èˆ¬ <strong>è¿œè¿œå¤§äº</strong> èŠ‚ç‚¹æ•°ã€‚<strong>æ§½</strong> æ˜¯é›†ç¾¤å†… <strong>æ•°æ®ç®¡ç†</strong> å’Œ <strong>è¿ç§»</strong> çš„ <strong>åŸºæœ¬å•ä½</strong>ã€‚é‡‡ç”¨ <strong>å¤§èŒƒå›´æ§½</strong> çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ <strong>æ•°æ®æ‹†åˆ†</strong> å’Œ <strong>é›†ç¾¤æ‰©å±•</strong>ã€‚æ¯ä¸ªèŠ‚ç‚¹ä¼šè´Ÿè´£ <strong>ä¸€å®šæ•°é‡çš„æ§½</strong>ã€‚</li>
</ul>
<h3 id="52-redis"><a class="markdownIt-Anchor" href="#52-redis"></a> 5.2. Redis</h3>
<blockquote>
<p>Redis æ˜¯ä¸€ä¸ªå¼€æºï¼ˆBSD è®¸å¯ï¼‰çš„ï¼ŒåŸºäºå†…å­˜çš„ï¼Œå¤šæ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿã€‚å¯ä»¥ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚</p>
<p>Redis è¿˜å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯åˆ†ç‰‡æ¥æ‰©å±•å†™æ€§èƒ½ã€‚å†…ç½®äº† å¤åˆ¶ï¼ˆreplicationï¼‰ï¼ŒLUA è„šæœ¬ï¼ˆLua scriptingï¼‰ï¼ŒLRU é©±åŠ¨äº‹ä»¶ï¼ˆLRU evictionï¼‰ï¼Œäº‹åŠ¡ï¼ˆtransactionsï¼‰ å’Œä¸åŒçº§åˆ«çš„ ç£ç›˜æŒä¹…åŒ–ï¼ˆpersistenceï¼‰ï¼Œ å¹¶é€šè¿‡ Redis å“¨å…µï¼ˆSentinelï¼‰å’Œè‡ªåŠ¨åˆ†åŒºï¼ˆClusterï¼‰æä¾›é«˜å¯ç”¨æ€§ï¼ˆhigh availabilityï¼‰ã€‚</p>
</blockquote>
<h4 id="redis-ç‰¹æ€§"><a class="markdownIt-Anchor" href="#redis-ç‰¹æ€§"></a> Redis ç‰¹æ€§</h4>
<ul>
<li>
<p>æ”¯æŒå¤šç§æ•°æ®ç±»å‹ - stringã€hashã€listã€setã€sorted setã€‚</p>
</li>
<li>
<p>æ”¯æŒå¤šç§æ•°æ®æ·˜æ±°ç­–ç•¥</p>
<ul>
<li><strong>volatile-lru</strong> - ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ä¸­æŒ‘é€‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®æ·˜æ±°</li>
<li><strong>volatile-ttl</strong> - ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ä¸­æŒ‘é€‰å°†è¦è¿‡æœŸçš„æ•°æ®æ·˜æ±°</li>
<li><strong>volatile-random</strong> - ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ä¸­ä»»æ„é€‰æ‹©æ•°æ®æ·˜æ±°</li>
<li><strong>allkeys-lru</strong> - ä»æ‰€æœ‰æ•°æ®é›†ä¸­æŒ‘é€‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®æ·˜æ±°</li>
<li><strong>allkeys-random</strong> - ä»æ‰€æœ‰æ•°æ®é›†ä¸­ä»»æ„é€‰æ‹©æ•°æ®è¿›è¡Œæ·˜æ±°</li>
<li><strong>noeviction</strong> - ç¦æ­¢é©±é€æ•°æ®</li>
</ul>
</li>
<li>
<p>æä¾›ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ - RDB å’Œ AOF</p>
</li>
<li>
<p>é€šè¿‡ Redis cluster æä¾›é›†ç¾¤æ¨¡å¼ã€‚</p>
</li>
</ul>
<h4 id="redis-åŸç†"><a class="markdownIt-Anchor" href="#redis-åŸç†"></a> Redis åŸç†</h4>
<ul>
<li>ç¼“å­˜æ·˜æ±°
<ul>
<li>Redis æœ‰ä¸¤ç§æ•°æ®æ·˜æ±°å®ç°
<ul>
<li>æ¶ˆææ–¹å¼ - è®¿é—® Redis key æ—¶ï¼Œå¦‚æœå‘ç°å®ƒå·²ç»å¤±æ•ˆï¼Œåˆ™åˆ é™¤å®ƒ</li>
<li>ç§¯ææ–¹å¼ - å‘¨æœŸæ€§ä»è®¾ç½®äº†å¤±æ•ˆæ—¶é—´çš„ key ä¸­ï¼Œæ ¹æ®æ·˜æ±°ç­–ç•¥ï¼Œé€‰æ‹©ä¸€éƒ¨åˆ†å¤±æ•ˆçš„ key è¿›è¡Œåˆ é™¤ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>åˆ†åŒº
<ul>
<li>Redis Cluster é›†ç¾¤åŒ…å« 16384 ä¸ªè™šæ‹Ÿ Hash æ§½ï¼Œå®ƒé€šè¿‡ä¸€ä¸ªé«˜æ•ˆçš„ç®—æ³•æ¥è®¡ç®— key å±äºå“ªä¸ª Hash æ§½ã€‚</li>
<li>Redis Cluster æ”¯æŒè¯·æ±‚åˆ†å‘ - èŠ‚ç‚¹åœ¨æ¥åˆ°ä¸€ä¸ªå‘½ä»¤è¯·æ±‚æ—¶ï¼Œä¼šå…ˆæ£€æµ‹è¿™ä¸ªå‘½ä»¤è¯·æ±‚è¦å¤„ç†çš„é”®æ‰€åœ¨çš„æ§½æ˜¯å¦ç”±è‡ªå·±è´Ÿè´£ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼ŒèŠ‚ç‚¹å°†å‘å®¢æˆ·ç«¯è¿”å›ä¸€ä¸ª MOVED é”™è¯¯ï¼ŒMOVED é”™è¯¯æºå¸¦çš„ä¿¡æ¯å¯ä»¥æŒ‡å¼•å®¢æˆ·ç«¯å°†è¯·æ±‚é‡å®šå‘è‡³æ­£åœ¨è´Ÿè´£ç›¸å…³æ§½çš„èŠ‚ç‚¹ã€‚</li>
</ul>
</li>
<li>ä¸»ä»å¤åˆ¶
<ul>
<li>Redis 2.8 åæ”¯æŒå¼‚æ­¥å¤åˆ¶ã€‚å®ƒæœ‰ä¸¤ç§æ¨¡å¼ï¼š
<ul>
<li><code>å®Œæ•´é‡åŒæ­¥ï¼ˆfull resychronizationï¼‰</code> - ç”¨äºåˆæ¬¡å¤åˆ¶ã€‚æ‰§è¡Œæ­¥éª¤ä¸ <code>SYNC</code> å‘½ä»¤åŸºæœ¬ä¸€è‡´ã€‚</li>
<li><code>éƒ¨åˆ†é‡åŒæ­¥ï¼ˆpartial resychronizationï¼‰</code> - ç”¨äºæ–­çº¿åé‡å¤åˆ¶ã€‚å¦‚æœæ¡ä»¶å…è®¸ï¼Œä¸»æœåŠ¡å™¨å¯ä»¥å°†ä¸»ä»æœåŠ¡å™¨è¿æ¥æ–­å¼€æœŸé—´æ‰§è¡Œçš„å†™å‘½ä»¤å‘é€ç»™ä»æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨åªéœ€æ¥æ”¶å¹¶æ‰§è¡Œè¿™äº›å†™å‘½ä»¤ï¼Œå³å¯å°†ä¸»ä»æœåŠ¡å™¨çš„æ•°æ®åº“çŠ¶æ€ä¿æŒä¸€è‡´ã€‚</li>
</ul>
</li>
<li>é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šå®šæœŸå‘é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹å‘é€ PING æ¶ˆæ¯ï¼Œä»¥æ­¤æ¥æ£€æµ‹å¯¹æ–¹æ˜¯å¦åœ¨çº¿ã€‚</li>
<li>å¦‚æœä¸€ä¸ªä¸»èŠ‚ç‚¹è¢«è®¤ä¸ºä¸‹çº¿ï¼Œåˆ™åœ¨å…¶ä»èŠ‚ç‚¹ä¸­ï¼Œæ ¹æ® Raft ç®—æ³•ï¼Œé€‰ä¸¾å‡ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œå‡çº§ä¸ºä¸»èŠ‚ç‚¹ã€‚</li>
</ul>
</li>
<li>æ•°æ®ä¸€è‡´æ€§
<ul>
<li>Redis ä¸ä¿è¯å¼ºä¸€è‡´æ€§ï¼Œå› ä¸ºè¿™ä¼šä½¿å¾—é›†ç¾¤æ€§èƒ½å¤§å¤§é™ä½ã€‚</li>
<li>Redis æ˜¯é€šè¿‡å¼‚æ­¥å¤åˆ¶æ¥å®ç°æœ€ç»ˆä¸€è‡´æ€§ã€‚</li>
</ul>
</li>
</ul>
<h3 id="53-é€‰æ‹©åˆ†å¸ƒå¼ç¼“å­˜"><a class="markdownIt-Anchor" href="#53-é€‰æ‹©åˆ†å¸ƒå¼ç¼“å­˜"></a> 5.3. é€‰æ‹©åˆ†å¸ƒå¼ç¼“å­˜</h3>
<p>ä¸åŒçš„åˆ†å¸ƒå¼ç¼“å­˜åŠŸèƒ½ç‰¹æ€§å’Œå®ç°åŸç†æ–¹é¢æœ‰å¾ˆå¤§çš„å·®å¼‚ï¼Œå› æ­¤ä»–ä»¬æ‰€é€‚åº”çš„åœºæ™¯ä¹Ÿæœ‰æ‰€ä¸åŒã€‚</p>
<p>è¿™é‡Œé€‰å–ä¸‰ä¸ªæ¯”è¾ƒå‡ºåçš„åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆMemCacheï¼ŒRedisï¼ŒTairï¼‰æ¥ä½œä¸ºæ¯”è¾ƒï¼š</p>
<table>
<thead>
<tr>
<th>æ¯”è¾ƒé¡¹</th>
<th>MemCache</th>
<th>Redis</th>
<th>Tair</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ•°æ®ç»“æ„</td>
<td>åªæ”¯æŒç®€å•çš„ Key-Value ç»“æ„</td>
<td>String,Hash, List, Set, Sorted Set</td>
<td>String,HashMap, Listï¼ŒSet</td>
</tr>
<tr>
<td>æŒä¹…åŒ–</td>
<td>ä¸æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td>å®¹é‡å¤§å°</td>
<td>æ•°æ®çº¯å†…å­˜ï¼Œæ•°æ®å­˜å‚¨ä¸å®œè¿‡å¤š</td>
<td>æ•°æ®å…¨å†…å­˜ï¼Œèµ„æºæˆæœ¬è€ƒé‡ä¸å®œè¶…è¿‡ 100GB</td>
<td>å¯ä»¥é…ç½®å…¨å†…å­˜æˆ–å†…å­˜+ç£ç›˜å¼•æ“ï¼Œæ•°æ®å®¹é‡å¯æ— é™æ‰©å……</td>
</tr>
<tr>
<td>è¯»å†™æ€§èƒ½</td>
<td>å¾ˆé«˜</td>
<td>å¾ˆé«˜(RT0.5ms å·¦å³)</td>
<td>String ç±»å‹æ¯”è¾ƒé«˜(RT1ms å·¦å³)ï¼Œå¤æ‚ç±»å‹æ¯”è¾ƒæ…¢(RT5ms å·¦å³)</td>
</tr>
<tr>
<td>è¿‡æœŸç­–ç•¥</td>
<td>è¿‡æœŸåï¼Œä¸åˆ é™¤ç¼“å­˜</td>
<td>æœ‰å…­ç§ç­–ç•¥æ¥å¤„ç†è¿‡æœŸæ•°æ®</td>
<td>æ”¯æŒ</td>
</tr>
</tbody>
</table>
<ul>
<li><code>MemCache</code> - è¿™ä¸€å—æ¥è§¦å¾—æ¯”è¾ƒå°‘ï¼Œä¸åšè¿‡å¤šçš„æ¨èã€‚å…¶ååé‡è¾ƒå¤§ï¼Œä½†æ˜¯æ”¯æŒçš„æ•°æ®ç»“æ„è¾ƒå°‘ï¼Œå¹¶ä¸”ä¸æ”¯æŒæŒä¹…åŒ–ã€‚</li>
<li><code>Redis</code> - æ”¯æŒä¸°å¯Œçš„æ•°æ®ç»“æ„ï¼Œè¯»å†™æ€§èƒ½å¾ˆé«˜ï¼Œä½†æ˜¯æ•°æ®å…¨å†…å­˜ï¼Œå¿…é¡»è¦è€ƒè™‘èµ„æºæˆæœ¬ï¼Œæ”¯æŒæŒä¹…åŒ–ã€‚</li>
<li><code>Tair</code> - æ”¯æŒä¸°å¯Œçš„æ•°æ®ç»“æ„ï¼Œè¯»å†™æ€§èƒ½è¾ƒé«˜ï¼Œéƒ¨åˆ†ç±»å‹æ¯”è¾ƒæ…¢ï¼Œç†è®ºä¸Šå®¹é‡å¯ä»¥æ— é™æ‰©å……ã€‚</li>
</ul>
<p>æ€»ç»“ï¼šå¦‚æœæœåŠ¡å¯¹å»¶è¿Ÿæ¯”è¾ƒæ•æ„Ÿï¼ŒMap/Set æ•°æ®ä¹Ÿæ¯”è¾ƒå¤šçš„è¯ï¼Œæ¯”è¾ƒé€‚åˆ Redisã€‚å¦‚æœæœåŠ¡éœ€è¦æ”¾å…¥ç¼“å­˜é‡çš„æ•°æ®å¾ˆå¤§ï¼Œå¯¹å»¶è¿Ÿåˆä¸æ˜¯ç‰¹åˆ«æ•æ„Ÿçš„è¯ï¼Œé‚£å°±å¯ä»¥é€‰æ‹© Tairã€‚</p>
<h2 id="6-å¤šçº§ç¼“å­˜"><a class="markdownIt-Anchor" href="#6-å¤šçº§ç¼“å­˜"></a> 6. å¤šçº§ç¼“å­˜</h2>
<h3 id="61-ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜"><a class="markdownIt-Anchor" href="#61-ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜"></a> 6.1. ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜</h3>
<p>å¦‚æœåº”ç”¨æœåŠ¡ä¸æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œé‚£ä¹ˆè¿›ç¨‹å†…ç¼“å­˜å½“ç„¶æ˜¯ç¼“å­˜çš„é¦–é€‰æ–¹æ¡ˆã€‚</p>
<p>å¯¹äºè¿›ç¨‹å†…ç¼“å­˜ï¼Œå…¶æœ¬æ¥å—é™äºå†…å­˜çš„å¤§å°çš„é™åˆ¶ï¼Œä»¥åŠè¿›ç¨‹ç¼“å­˜æ›´æ–°åå…¶ä»–ç¼“å­˜æ— æ³•å¾—çŸ¥ï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´è¿›ç¨‹ç¼“å­˜é€‚ç”¨äº:</p>
<ol>
<li>æ•°æ®é‡ä¸æ˜¯å¾ˆå¤§ä¸”æ›´æ–°é¢‘ç‡è¾ƒä½çš„æ•°æ®ã€‚</li>
<li>å¦‚æœæ›´æ–°é¢‘ç¹çš„æ•°æ®ï¼Œä¹Ÿæƒ³ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜ï¼Œé‚£ä¹ˆå¯ä»¥å°†å…¶è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºè¾ƒçŸ­çš„æ—¶é—´ï¼Œæˆ–è€…è®¾ç½®è¾ƒçŸ­çš„è‡ªåŠ¨åˆ·æ–°æ—¶é—´ã€‚</li>
</ol>
<p>è¿™ç§æ–¹æ¡ˆå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>å¦‚æœåº”ç”¨æœåŠ¡æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œåº”ç”¨èŠ‚ç‚¹ä¹‹é—´æ— æ³•å…±äº«ç¼“å­˜ï¼Œå­˜åœ¨æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</li>
<li>ç”±äºè¿›ç¨‹å†…ç¼“å­˜å—é™äºå†…å­˜å¤§å°çš„é™åˆ¶ï¼Œæ‰€ä»¥ç¼“å­˜ä¸èƒ½æ— é™æ‰©å±•ã€‚</li>
</ul>
<h3 id="62-ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜"><a class="markdownIt-Anchor" href="#62-ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜"></a> 6.2. ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜</h3>
<p>å¦‚æœåº”ç”¨æœåŠ¡æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œé‚£ä¹ˆæœ€ç®€å•çš„ç¼“å­˜æ–¹æ¡ˆå°±æ˜¯ç›´æ¥ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜ã€‚</p>
<p>å…¶åº”ç”¨åœºæ™¯å¦‚å›¾æ‰€ç¤ºï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/technology/cache/å¤šçº§ç¼“å­˜1.png!zp" width="600px"/></div>
Redis ç”¨æ¥å­˜å‚¨çƒ­ç‚¹æ•°æ®ï¼Œå¦‚æœç¼“å­˜ä¸å‘½ä¸­ï¼Œåˆ™å»æŸ¥è¯¢æ•°æ®åº“ï¼Œå¹¶æ›´æ–°ç¼“å­˜ã€‚
<p>è¿™ç§æ–¹æ¡ˆå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li>ç¼“å­˜æœåŠ¡å¦‚æœæŒ‚äº†ï¼Œè¿™æ—¶åº”ç”¨åªèƒ½è®¿é—®æ•°æ®åº“ï¼Œå®¹æ˜“é€ æˆç¼“å­˜é›ªå´©ã€‚</li>
<li>è®¿é—®åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡ä¼šæœ‰ä¸€å®šçš„ I/O ä»¥åŠåºåˆ—åŒ–ååºåˆ—åŒ–çš„å¼€é”€ï¼Œè™½ç„¶æ€§èƒ½å¾ˆé«˜ï¼Œä½†æ˜¯å…¶ç»ˆç©¶æ²¡æœ‰åœ¨å†…å­˜ä¸­æŸ¥è¯¢å¿«ã€‚</li>
</ol>
<h3 id="63-ä½¿ç”¨å¤šçº§ç¼“å­˜"><a class="markdownIt-Anchor" href="#63-ä½¿ç”¨å¤šçº§ç¼“å­˜"></a> 6.3. ä½¿ç”¨å¤šçº§ç¼“å­˜</h3>
<p>å•çº¯ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜éƒ½å­˜åœ¨å„è‡ªçš„ä¸è¶³ã€‚å¦‚æœéœ€è¦æ›´é«˜çš„æ€§èƒ½ä»¥åŠæ›´å¥½çš„å¯ç”¨æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¼“å­˜è®¾è®¡ä¸ºå¤šçº§ç»“æ„ã€‚å°†æœ€çƒ­çš„æ•°æ®ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œè¿›ä¸€æ­¥æå‡è®¿é—®é€Ÿåº¦ã€‚</p>
<p>è¿™ä¸ªè®¾è®¡æ€è·¯åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ä¹Ÿå­˜åœ¨ï¼Œæ¯”å¦‚ CPU ä½¿ç”¨ L1ã€L2ã€L3 å¤šçº§ç¼“å­˜ï¼Œç”¨æ¥å‡å°‘å¯¹å†…å­˜çš„ç›´æ¥è®¿é—®ï¼Œä»è€ŒåŠ å¿«è®¿é—®é€Ÿåº¦ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå¤šçº§ç¼“å­˜æ¶æ„ä½¿ç”¨äºŒçº§ç¼“å­˜å·²å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†ä¸šåŠ¡éœ€æ±‚ï¼Œè¿‡å¤šçš„åˆ†çº§ä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦ä»¥åŠç»´æŠ¤çš„æˆæœ¬ã€‚å› æ­¤ï¼Œå¤šçº§ç¼“å­˜ä¸æ˜¯åˆ†çº§è¶Šå¤šè¶Šå¥½ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œæƒè¡¡ã€‚</p>
<p>ä¸€ä¸ªå…¸å‹çš„äºŒçº§ç¼“å­˜æ¶æ„ï¼Œå¯ä»¥ä½¿ç”¨è¿›ç¨‹å†…ç¼“å­˜ï¼ˆå¦‚ï¼š Caffeine/Google Guava/Ehcache/HashMapï¼‰ä½œä¸ºä¸€çº§ç¼“å­˜ï¼›ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆå¦‚ï¼šRedis/Memcachedï¼‰ä½œä¸ºäºŒçº§ç¼“å­˜ã€‚</p>
<h4 id="å¤šçº§ç¼“å­˜æŸ¥è¯¢"><a class="markdownIt-Anchor" href="#å¤šçº§ç¼“å­˜æŸ¥è¯¢"></a> å¤šçº§ç¼“å­˜æŸ¥è¯¢</h4>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/technology/cache/å¤šçº§ç¼“å­˜2.png!zp" width="600" /></div>
å¤šçº§ç¼“å­˜æŸ¥è¯¢æµç¨‹å¦‚ä¸‹ï¼š
<ol>
<li>é¦–å…ˆï¼ŒæŸ¥è¯¢ L1 ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›ç»“æœï¼›å¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥ã€‚</li>
<li>æ¥ä¸‹æ¥ï¼ŒæŸ¥è¯¢ L2 ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›ç»“æœå¹¶å›å¡« L1 ç¼“å­˜ï¼›å¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥ã€‚</li>
<li>æœ€åï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼Œè¿”å›ç»“æœå¹¶ä¾æ¬¡å›å¡« L2 ç¼“å­˜ã€L1 ç¼“å­˜ã€‚</li>
</ol>
<h4 id="å¤šçº§ç¼“å­˜æ›´æ–°"><a class="markdownIt-Anchor" href="#å¤šçº§ç¼“å­˜æ›´æ–°"></a> å¤šçº§ç¼“å­˜æ›´æ–°</h4>
<p>å¯¹äº L1 ç¼“å­˜ï¼Œå¦‚æœæœ‰æ•°æ®æ›´æ–°ï¼Œåªèƒ½åˆ é™¤å¹¶æ›´æ–°æ‰€åœ¨æœºå™¨ä¸Šçš„ç¼“å­˜ï¼Œå…¶ä»–æœºå™¨åªèƒ½é€šè¿‡è¶…æ—¶æœºåˆ¶æ¥åˆ·æ–°ç¼“å­˜ã€‚è¶…æ—¶è®¾å®šå¯ä»¥æœ‰ä¸¤ç§ç­–ç•¥:</p>
<ul>
<li>è®¾ç½®æˆå†™å…¥åå¤šå°‘æ—¶é—´åè¿‡æœŸ</li>
<li>è®¾ç½®æˆå†™å…¥åå¤šå°‘æ—¶é—´åˆ·æ–°</li>
</ul>
<p>å¯¹äº L1 ç¼“å­˜ï¼Œå¦‚æœæœ‰æ•°æ®æ›´æ–°ï¼Œå…¶ä»–æœºå™¨ç«‹é©¬å¯è§ã€‚ä½†æ˜¯ï¼Œä¹Ÿå¿…é¡»è¦è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå…¶æ—¶é—´åº”è¯¥æ¯” L1 ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´é•¿ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿›ç¨‹å†…ç¼“å­˜ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œè®¾è®¡å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–:</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/technology/cache/å¤šçº§ç¼“å­˜3.png!zp" /></div>
é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—çš„å‘å¸ƒã€è®¢é˜…æœºåˆ¶ï¼Œå¯ä»¥é€šçŸ¥å…¶ä»–åº”ç”¨èŠ‚ç‚¹å¯¹è¿›ç¨‹å†…ç¼“å­˜è¿›è¡Œæ›´æ–°ã€‚ä½¿ç”¨è¿™ç§æ–¹æ¡ˆï¼Œå³ä½¿æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡æŒ‚äº†æˆ–ä¸å¯é ï¼Œç”±äºå…ˆæ‰§è¡Œäº†æ•°æ®åº“æ›´æ–°ï¼Œä½†è¿›ç¨‹å†…ç¼“å­˜è¿‡æœŸï¼Œåˆ·æ–°ç¼“å­˜æ—¶ï¼Œä¹Ÿèƒ½ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚
<h2 id="7-ç¼“å­˜é—®é¢˜"><a class="markdownIt-Anchor" href="#7-ç¼“å­˜é—®é¢˜"></a> 7. ç¼“å­˜é—®é¢˜</h2>
<h3 id="71-ç¼“å­˜é›ªå´©"><a class="markdownIt-Anchor" href="#71-ç¼“å­˜é›ªå´©"></a> 7.1. ç¼“å­˜é›ªå´©</h3>
<blockquote>
<p><strong>ç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜ä¸å¯ç”¨æˆ–è€…å¤§é‡ç¼“å­˜ç”±äºè¶…æ—¶æ—¶é—´ç›¸åŒåœ¨åŒä¸€æ—¶é—´æ®µå¤±æ•ˆï¼Œå¤§é‡è¯·æ±‚ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œæ•°æ®åº“å‹åŠ›è¿‡å¤§å¯¼è‡´ç³»ç»Ÿé›ªå´©</strong>ã€‚</p>
</blockquote>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>å¢åŠ ç¼“å­˜ç³»ç»Ÿå¯ç”¨æ€§ã€‚é€šè¿‡ç›‘æ§å…³æ³¨ç¼“å­˜çš„å¥åº·ç¨‹åº¦ï¼Œæ ¹æ®ä¸šåŠ¡é‡é€‚å½“çš„æ‰©å®¹ç¼“å­˜ã€‚</li>
<li>é‡‡ç”¨å¤šçº§ç¼“å­˜ã€‚ä¸åŒçº§åˆ«ç¼“å­˜è®¾ç½®çš„è¶…æ—¶æ—¶é—´ä¸åŒï¼Œå³ä½¿æŸä¸ªçº§åˆ«ç¼“å­˜éƒ½è¿‡æœŸï¼Œä¹Ÿæœ‰å…¶ä»–çº§åˆ«ç¼“å­˜å…œåº•ã€‚</li>
<li>ç¼“å­˜çš„è¿‡æœŸæ—¶é—´å¯ä»¥å–ä¸ªéšæœºå€¼ã€‚æ¯”å¦‚ä»¥å‰æ˜¯è®¾ç½® 10 åˆ†é’Ÿçš„è¶…æ—¶æ—¶é—´ï¼Œé‚£æ¯ä¸ª Key éƒ½å¯ä»¥éšæœº 8-13 åˆ†é’Ÿè¿‡æœŸï¼Œå°½é‡è®©ä¸åŒ Key çš„è¿‡æœŸæ—¶é—´ä¸åŒã€‚</li>
<li>å¯¹æ•°æ®åº“è¿›è¡Œè¿‡è½½ä¿æŠ¤æˆ–åº”ç”¨å±‚é™æµã€‚</li>
</ul>
<h3 id="72-ç¼“å­˜ç©¿é€"><a class="markdownIt-Anchor" href="#72-ç¼“å­˜ç©¿é€"></a> 7.2. ç¼“å­˜ç©¿é€</h3>
<blockquote>
<p><strong>ç¼“å­˜ç©¿é€æ˜¯æŒ‡ï¼šæŸ¥è¯¢çš„æ•°æ®åœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆç¼“å­˜ä¸­è‡ªç„¶ä¹Ÿä¸å­˜åœ¨ã€‚æ‰€ä»¥ï¼Œåº”ç”¨åœ¨ç¼“å­˜ä¸­æŸ¥ä¸åˆ°ï¼Œåˆ™ä¼šå»æŸ¥è¯¢æ•°æ®åº“ã€‚å½“è¿™æ ·çš„è¯·æ±‚å¤šäº†åï¼Œæ•°æ®åº“çš„å‹åŠ›å°±ä¼šå¢å¤§ã€‚</strong></p>
</blockquote>
<p>è§£å†³ç¼“å­˜ç©¿é€ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>
<ul>
<li><strong>å¯¹äºè¿”å›ä¸º NULL çš„ä¾ç„¶ç¼“å­˜ï¼Œå¯¹äºæŠ›å‡ºå¼‚å¸¸çš„è¿”å›ä¸è¿›è¡Œç¼“å­˜</strong>ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/technology/cache/ç¼“å­˜ç©¿é€1.png!zp" width="350px"/></div>
é‡‡ç”¨è¿™ç§æ‰‹æ®µçš„ä¼šå¢åŠ æˆ‘ä»¬ç¼“å­˜çš„ç»´æŠ¤æˆæœ¬ï¼Œéœ€è¦åœ¨æ’å…¥ç¼“å­˜çš„æ—¶å€™åˆ é™¤è¿™ä¸ªç©ºç¼“å­˜ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®è¾ƒçŸ­çš„è¶…æ—¶æ—¶é—´æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
<ul>
<li><strong>è¿‡æ»¤ä¸å¯èƒ½å­˜åœ¨çš„æ•°æ®</strong></li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/technology/cache/ç¼“å­˜ç©¿é€2.png!zp" width="350px"/></div>
**åˆ¶å®šä¸€äº›è§„åˆ™è¿‡æ»¤ä¸€äº›ä¸å¯èƒ½å­˜åœ¨çš„æ•°æ®**ã€‚å°æ•°æ®ç”¨ BitMapï¼Œå¤§æ•°æ®å¯ä»¥ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œæ¯”å¦‚ä½ çš„è®¢å• ID æ˜æ˜¾æ˜¯åœ¨ä¸€ä¸ªèŒƒå›´ 1-1000ï¼Œå¦‚æœä¸æ˜¯ 1-1000 ä¹‹å†…çš„æ•°æ®é‚£å…¶å®å¯ä»¥ç›´æ¥ç»™è¿‡æ»¤æ‰ã€‚
<h3 id="73-ç¼“å­˜å‡»ç©¿"><a class="markdownIt-Anchor" href="#73-ç¼“å­˜å‡»ç©¿"></a> 7.3. ç¼“å­˜å‡»ç©¿</h3>
<p>å¯¹äºæŸäº› key è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œä½†æ˜¯å…¶æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œå¦‚æœæŸä¸ª key å¤±æ•ˆï¼Œå¯èƒ½å¤§é‡çš„è¯·æ±‚æ‰“è¿‡æ¥ï¼Œç¼“å­˜æœªå‘½ä¸­ï¼Œç„¶åå»æ•°æ®åº“è®¿é—®ï¼Œæ­¤æ—¶æ•°æ®åº“è®¿é—®é‡ä¼šæ€¥å‰§å¢åŠ ã€‚</p>
<p>ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä¸‹é¢çš„ä¸¤ä¸ªæ‰‹æ®µ:</p>
<ul>
<li><strong>åˆ†å¸ƒå¼é”</strong> - é”ä½çƒ­ç‚¹æ•°æ®çš„ keyï¼Œé¿å…å¤§é‡çº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ª keyã€‚</li>
<li><strong>å¼‚æ­¥åŠ è½½</strong> - å¯ä»¥å¯¹éƒ¨åˆ†æ•°æ®é‡‡å–åˆ°æœŸè‡ªåŠ¨åˆ·æ–°çš„ç­–ç•¥ï¼Œè€Œä¸æ˜¯åˆ°æœŸè‡ªåŠ¨æ·˜æ±°ã€‚æ·˜æ±°å…¶å®ä¹Ÿæ˜¯ä¸ºäº†æ•°æ®çš„æ—¶æ•ˆæ€§ï¼Œæ‰€ä»¥é‡‡ç”¨è‡ªåŠ¨åˆ·æ–°ä¹Ÿå¯ä»¥ã€‚</li>
</ul>
<h3 id="74-ç¼“å­˜æ›´æ–°"><a class="markdownIt-Anchor" href="#74-ç¼“å­˜æ›´æ–°"></a> 7.4. ç¼“å­˜æ›´æ–°</h3>
<p>ä¸€èˆ¬æ¥è¯´ç¼“å­˜çš„æ›´æ–°æœ‰ä¸¤ç§æƒ…å†µ:</p>
<ul>
<li>å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“ã€‚</li>
<li>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜ã€‚</li>
</ul>
<blockquote>
<p><strong>ä¸ºä»€ä¹ˆæ˜¯åˆ é™¤ç¼“å­˜ï¼Œè€Œä¸æ˜¯æ›´æ–°ç¼“å­˜å‘¢ï¼Ÿ</strong></p>
<p>ä½ å¯ä»¥æƒ³æƒ³å½“æœ‰å¤šä¸ªå¹¶å‘çš„è¯·æ±‚æ›´æ–°æ•°æ®ï¼Œä½ å¹¶ä¸èƒ½ä¿è¯æ›´æ–°æ•°æ®åº“çš„é¡ºåºå’Œæ›´æ–°ç¼“å­˜çš„é¡ºåºä¸€è‡´ï¼Œé‚£å°±ä¼šå‡ºç°æ•°æ®åº“ä¸­å’Œç¼“å­˜ä¸­æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µã€‚æ‰€ä»¥ä¸€èˆ¬æ¥è¯´è€ƒè™‘åˆ é™¤ç¼“å­˜ã€‚</p>
</blockquote>
<ul>
<li><strong>å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“</strong></li>
</ul>
<p>å¯¹äºä¸€ä¸ªæ›´æ–°æ“ä½œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å…ˆå»å„çº§ç¼“å­˜è¿›è¡Œåˆ é™¤ï¼Œç„¶åæ›´æ–°æ•°æ®åº“ã€‚</p>
<p>è¿™ä¸ªæ“ä½œæœ‰ä¸€ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼Œåœ¨å¯¹ç¼“å­˜åˆ é™¤å®Œä¹‹åï¼Œæœ‰ä¸€ä¸ªè¯»è¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™ç”±äºç¼“å­˜è¢«åˆ é™¤æ‰€ä»¥ç›´æ¥ä¼šè¯»åº“ï¼Œè¯»æ“ä½œçš„æ•°æ®æ˜¯è€çš„å¹¶ä¸”ä¼šè¢«åŠ è½½è¿›å…¥ç¼“å­˜å½“ä¸­ï¼Œåç»­è¯»è¯·æ±‚å…¨éƒ¨è®¿é—®çš„è€æ•°æ®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/technology/cache/ç¼“å­˜æ›´æ–°.png!zp" width="400px"/></div>
å¯¹ç¼“å­˜çš„æ“ä½œä¸è®ºæˆåŠŸå¤±è´¥éƒ½ä¸èƒ½é˜»å¡æˆ‘ä»¬å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œé‚£ä¹ˆå¾ˆå¤šæ—¶å€™åˆ é™¤ç¼“å­˜å¯ä»¥ç”¨å¼‚æ­¥çš„æ“ä½œï¼Œä½†æ˜¯å…ˆåˆ é™¤ç¼“å­˜ä¸èƒ½å¾ˆå¥½çš„é€‚ç”¨äºè¿™ä¸ªåœºæ™¯ã€‚
<p>å…ˆåˆ é™¤ç¼“å­˜ä¹Ÿæœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå¦‚æœå¯¹æ•°æ®åº“æ“ä½œå¤±è´¥äº†ï¼Œé‚£ä¹ˆç”±äºå…ˆåˆ é™¤çš„ç¼“å­˜ï¼Œæœ€å¤šåªæ˜¯é€ æˆ Cache Missã€‚</p>
<ul>
<li><strong>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜</strong></li>
</ul>
<blockquote>
<p>æ³¨ï¼šæ›´æ¨èä½¿ç”¨è¿™ç§ç­–ç•¥</p>
</blockquote>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜å°±èƒ½é¿å…ä¸Šé¢çš„é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯åŒæ ·çš„å¼•å…¥äº†æ–°çš„é—®é¢˜ï¼šå‡è®¾æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶ï¼Œåˆæ¥æ”¶åˆ°æŸ¥è¯¢è¯·æ±‚ï¼Œæ­¤æ—¶å°±ä¼šè¿”å›ç¼“å­˜ä¸­çš„è€æ•°æ®ã€‚æ›´éº»çƒ¦çš„æ˜¯ï¼Œå¦‚æœæ•°æ®åº“æ›´æ–°æ“ä½œæ‰§è¡Œå¤±è´¥ï¼Œåˆ™ç¼“å­˜ä¸­å¯èƒ½æ°¸è¿œæ˜¯è„æ•°æ®ã€‚</p>
<ul>
<li>åº”è¯¥é€‰æ‹©å“ªç§æ›´æ–°æµ‹å½•</li>
</ul>
<p>é€šè¿‡ä¸Šé¢çš„å†…å®¹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä¸¤ç§æ›´æ–°ç­–ç•¥éƒ½å­˜åœ¨å¹¶å‘é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯å»ºè®®é€‰æ‹©å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œå› ä¸ºå…¶å¹¶å‘é—®é¢˜å‡ºç°çš„æ¦‚ç‡å¯èƒ½éå¸¸ä½ï¼Œå› ä¸ºè¿™ä¸ªæ¡ä»¶éœ€è¦å‘ç”Ÿåœ¨è¯»ç¼“å­˜æ—¶ç¼“å­˜å¤±æ•ˆï¼Œè€Œä¸”å¹¶å‘ç€æœ‰ä¸€ä¸ªå†™æ“ä½œã€‚è€Œå®é™…ä¸Šæ•°æ®åº“çš„å†™æ“ä½œä¼šæ¯”è¯»æ“ä½œæ…¢å¾—å¤šï¼Œè€Œä¸”è¿˜è¦é”è¡¨ï¼Œè€Œè¯»æ“ä½œå¿…éœ€åœ¨å†™æ“ä½œå‰è¿›å…¥æ•°æ®åº“æ“ä½œï¼Œè€Œåˆè¦æ™šäºå†™æ“ä½œæ›´æ–°ç¼“å­˜ï¼Œæ‰€æœ‰çš„è¿™äº›æ¡ä»¶éƒ½å…·å¤‡çš„æ¦‚ç‡åŸºæœ¬å¹¶ä¸å¤§ã€‚</p>
<p>å¦‚æœéœ€è¦æ•°æ®åº“å’Œç¼“å­˜ä¿è¯å¼ºä¸€è‡´æ€§ï¼Œåˆ™å¯ä»¥é€šè¿‡ 2PC æˆ– Paxos åè®®æ¥å®ç°ã€‚ä½†æ˜¯ 2PC å¤ªæ…¢ï¼Œè€Œ Paxos å¤ªå¤æ‚ï¼Œæ‰€ä»¥å¦‚æœä¸æ˜¯éå¸¸é‡è¦çš„æ•°æ®ï¼Œä¸å»ºè®®ä½¿ç”¨å¼ºä¸€è‡´æ€§æ–¹æ¡ˆã€‚</p>
<h3 id="75-ç¼“å­˜é¢„çƒ­"><a class="markdownIt-Anchor" href="#75-ç¼“å­˜é¢„çƒ­"></a> 7.5. ç¼“å­˜é¢„çƒ­</h3>
<p>ç¼“å­˜é¢„çƒ­æ˜¯æŒ‡ç³»ç»Ÿå¯åŠ¨åï¼Œå°†å¸¸ç”¨çš„æ•°æ®ç›´æ¥ç¼“å­˜ã€‚è¿™æ ·å°±å¯ä»¥é¿å…ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åå†æ›´æ–°ç¼“å­˜çš„é—®é¢˜ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>ç›´æ¥å†™ä¸ªç¼“å­˜åˆ·æ–°é¡µé¢ï¼Œä¸Šçº¿æ—¶æ‰‹å·¥æ“ä½œä¸‹ã€‚</li>
<li>æ•°æ®é‡ä¸å¤§ï¼Œå¯ä»¥åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨è¿›è¡ŒåŠ è½½ã€‚</li>
<li>å®šæ—¶åˆ·æ–°ç¼“å­˜ã€‚</li>
</ul>
<h3 id="76-ç¼“å­˜é™çº§"><a class="markdownIt-Anchor" href="#76-ç¼“å­˜é™çº§"></a> 7.6. ç¼“å­˜é™çº§</h3>
<p>å½“è®¿é—®é‡å‰§å¢ã€æœåŠ¡å‡ºç°é—®é¢˜ï¼ˆå¦‚å“åº”æ—¶é—´æ…¢æˆ–ä¸å“åº”ï¼‰æˆ–éæ ¸å¿ƒæœåŠ¡å½±å“åˆ°æ ¸å¿ƒæµç¨‹çš„æ€§èƒ½æ—¶ï¼Œä»ç„¶éœ€è¦ä¿è¯æœåŠ¡è¿˜æ˜¯å¯ç”¨çš„ï¼Œå³ä½¿æ˜¯æœ‰æŸæœåŠ¡ã€‚ç³»ç»Ÿå¯ä»¥æ ¹æ®ä¸€äº›å…³é”®æ•°æ®è¿›è¡Œè‡ªåŠ¨é™çº§ï¼Œä¹Ÿå¯ä»¥é…ç½®å¼€å…³å®ç°äººå·¥é™çº§ã€‚</p>
<p>é™çº§çš„æœ€ç»ˆç›®çš„æ˜¯ä¿è¯æ ¸å¿ƒæœåŠ¡å¯ç”¨ï¼Œå³ä½¿æ˜¯æœ‰æŸçš„ã€‚è€Œä¸”æœ‰äº›æœåŠ¡æ˜¯æ— æ³•é™çº§çš„ï¼ˆå¦‚åŠ å…¥è´­ç‰©è½¦ã€ç»“ç®—ï¼‰ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li>ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ã€‹</li>
<li><a href="https://link.juejin.im/?target=https%3A%2F%2Fjuejin.im%2Fpost%2F5b7593496fb9a009b62904fa">ä½ åº”è¯¥çŸ¥é“çš„ç¼“å­˜è¿›åŒ–å²</a></li>
<li><a href="https://link.juejin.im/?target=https%3A%2F%2Fjuejin.im%2Fpost%2F5b849878e51d4538c77a974a">å¦‚ä½•ä¼˜é›…çš„è®¾è®¡å’Œä½¿ç”¨ç¼“å­˜ï¼Ÿ</a></li>
<li><a href="https://www.jianshu.com/p/73ce0ef820f9" target="_blank" rel="noopener">ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ç¼“å­˜æ¶æ„(ä¸Š)</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>ç¼“å­˜</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ†å¸ƒå¼äº‹åŠ¡åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/distributed-transaction-theory/</url>
    <content><![CDATA[<h1 id="åˆ†å¸ƒå¼äº‹åŠ¡åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼äº‹åŠ¡åŸºæœ¬åŸç†"></a> åˆ†å¸ƒå¼äº‹åŠ¡åŸºæœ¬åŸç†</h1>
<blockquote>
<p><strong>åˆ†å¸ƒå¼äº‹åŠ¡æŒ‡çš„æ˜¯äº‹åŠ¡æ“ä½œè·¨è¶Šå¤šä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸”è¦æ±‚æ»¡è¶³äº‹åŠ¡çš„ ACID ç‰¹æ€§ã€‚</strong></p>
</blockquote>
<p>åˆ†å¸ƒå¼äº‹åŠ¡çš„å®ç°ä¸»è¦æœ‰ä»¥ä¸‹ 5 ç§æ–¹æ¡ˆï¼š</p>
<ul>
<li>XA æ–¹æ¡ˆ</li>
<li>TCC æ–¹æ¡ˆ</li>
<li>æœ¬åœ°æ¶ˆæ¯è¡¨</li>
<li>å¯é æ¶ˆæ¯æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ</li>
<li>æœ€å¤§åŠªåŠ›é€šçŸ¥æ–¹æ¡ˆ</li>
</ul>
<h2 id="1-ä¸¤é˜¶æ®µæäº¤"><a class="markdownIt-Anchor" href="#1-ä¸¤é˜¶æ®µæäº¤"></a> 1. ä¸¤é˜¶æ®µæäº¤</h2>
<blockquote>
<p>ä¸¤é˜¶æ®µæäº¤ï¼ˆTwo-phase Commitï¼Œ2PCï¼‰é€šè¿‡å¼•å…¥åè°ƒè€…ï¼ˆCoordinatorï¼‰æ¥è°ƒåº¦å‚ä¸è€…çš„è¡Œä¸ºï¼Œå¹¶æœ€ç»ˆå†³å®šè¿™äº›å‚ä¸è€…æ˜¯å¦è¦çœŸæ­£æ‰§è¡Œäº‹åŠ¡ã€‚</p>
<p>å‚è€ƒå®ç°ï¼š<a href="https://github.com/changmingxie/tcc-transaction" target="_blank" rel="noopener">https://github.com/changmingxie/tcc-transaction</a></p>
</blockquote>
<h3 id="11-è¿è¡Œè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#11-è¿è¡Œè¿‡ç¨‹"></a> 1.1. è¿è¡Œè¿‡ç¨‹</h3>
<h4 id="111-å‡†å¤‡é˜¶æ®µ"><a class="markdownIt-Anchor" href="#111-å‡†å¤‡é˜¶æ®µ"></a> 1.1.1. å‡†å¤‡é˜¶æ®µ</h4>
<p>åè°ƒè€…è¯¢é—®å‚ä¸è€…äº‹åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œå‚ä¸è€…å‘å›äº‹åŠ¡æ‰§è¡Œç»“æœã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/åˆ†å¸ƒå¼äº‹åŠ¡ä¸¤é˜¶æ®µæäº¤-01.jpg!zp" />
</div>
<h4 id="112-æäº¤é˜¶æ®µ"><a class="markdownIt-Anchor" href="#112-æäº¤é˜¶æ®µ"></a> 1.1.2. æäº¤é˜¶æ®µ</h4>
<p>å¦‚æœäº‹åŠ¡åœ¨æ¯ä¸ªå‚ä¸è€…ä¸Šéƒ½æ‰§è¡ŒæˆåŠŸï¼Œäº‹åŠ¡åè°ƒè€…å‘é€é€šçŸ¥è®©å‚ä¸è€…æäº¤äº‹åŠ¡ï¼›å¦åˆ™ï¼Œåè°ƒè€…å‘é€é€šçŸ¥è®©å‚ä¸è€…å›æ»šäº‹åŠ¡ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/åˆ†å¸ƒå¼äº‹åŠ¡ä¸¤é˜¶æ®µæäº¤-02.jpg!zp" />
</div>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å‡†å¤‡é˜¶æ®µï¼Œå‚ä¸è€…æ‰§è¡Œäº†äº‹åŠ¡ï¼Œä½†æ˜¯è¿˜æœªæäº¤ã€‚åªæœ‰åœ¨æäº¤é˜¶æ®µæ¥æ”¶åˆ°åè°ƒè€…å‘æ¥çš„é€šçŸ¥åï¼Œæ‰è¿›è¡Œæäº¤æˆ–è€…å›æ»šã€‚</p>
<h3 id="12-é—®é¢˜"><a class="markdownIt-Anchor" href="#12-é—®é¢˜"></a> 1.2. é—®é¢˜</h3>
<ul>
<li><strong>åŒæ­¥é˜»å¡</strong> - æ‰€æœ‰äº‹åŠ¡å‚ä¸è€…åœ¨ç­‰å¾…å…¶å®ƒå‚ä¸è€…å“åº”çš„æ—¶å€™éƒ½å¤„äºåŒæ­¥é˜»å¡çŠ¶æ€ï¼Œæ— æ³•è¿›è¡Œå…¶å®ƒæ“ä½œã€‚</li>
<li><strong>å•ç‚¹é—®é¢˜</strong> - åè°ƒè€…åœ¨ 2PC ä¸­èµ·åˆ°éå¸¸å¤§çš„ä½œç”¨ï¼Œå‘ç”Ÿæ•…éšœå°†ä¼šé€ æˆå¾ˆå¤§å½±å“ï¼Œç‰¹åˆ«æ˜¯åœ¨é˜¶æ®µäºŒå‘ç”Ÿæ•…éšœï¼Œæ‰€æœ‰å‚ä¸è€…ä¼šä¸€ç›´ç­‰å¾…çŠ¶æ€ï¼Œæ— æ³•å®Œæˆå…¶å®ƒæ“ä½œã€‚</li>
<li><strong>æ•°æ®ä¸ä¸€è‡´</strong> - åœ¨é˜¶æ®µäºŒï¼Œå¦‚æœåè°ƒè€…åªå‘é€äº†éƒ¨åˆ† Commit æ¶ˆæ¯ï¼Œæ­¤æ—¶ç½‘ç»œå‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¹ˆåªæœ‰éƒ¨åˆ†å‚ä¸è€…æ¥æ”¶åˆ° Commit æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰éƒ¨åˆ†å‚ä¸è€…æäº¤äº†äº‹åŠ¡ï¼Œä½¿å¾—ç³»ç»Ÿæ•°æ®ä¸ä¸€è‡´ã€‚</li>
<li><strong>å¤ªè¿‡ä¿å®ˆ</strong> - ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å¤±è´¥å°±ä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡å¤±è´¥ï¼Œæ²¡æœ‰å®Œå–„çš„å®¹é”™æœºåˆ¶ã€‚</li>
</ul>
<h3 id="13-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#13-ä¼˜ç¼ºç‚¹"></a> 1.3. ä¼˜ç¼ºç‚¹</h3>
<ul>
<li>ä¼˜ç‚¹ï¼šå°½é‡ä¿è¯äº†æ•°æ®çš„å¼ºä¸€è‡´ï¼Œé€‚åˆå¯¹æ•°æ®å¼ºä¸€è‡´è¦æ±‚å¾ˆé«˜çš„å…³é”®é¢†åŸŸã€‚ï¼ˆå…¶å®ä¹Ÿä¸èƒ½ 100%ä¿è¯å¼ºä¸€è‡´</li>
<li>ç¼ºç‚¹ï¼šå®ç°å¤æ‚ï¼Œç‰ºç‰²äº†å¯ç”¨æ€§ï¼Œå¯¹æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œä¸é€‚åˆé«˜å¹¶å‘é«˜æ€§èƒ½åœºæ™¯ã€‚</li>
</ul>
<h2 id="2-è¡¥å¿äº‹åŠ¡"><a class="markdownIt-Anchor" href="#2-è¡¥å¿äº‹åŠ¡"></a> 2. è¡¥å¿äº‹åŠ¡</h2>
<blockquote>
<p>è¡¥å¿äº‹åŠ¡ï¼ˆTCCï¼‰ï¼Œå…¨ç§°æ˜¯ï¼š<code>Try</code>ã€<code>Confirm</code>ã€<code>Cancel</code>ã€‚</p>
<p>å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šé’ˆå¯¹æ¯ä¸ªæ“ä½œï¼Œéƒ½è¦æ³¨å†Œä¸€ä¸ªä¸å…¶å¯¹åº”çš„ç¡®è®¤å’Œè¡¥å¿ï¼ˆæ’¤é”€ï¼‰æ“ä½œã€‚å®ƒåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<p>TCC çš„ã€‚</p>
<ul>
<li>Try é˜¶æ®µï¼šè¿™ä¸ªé˜¶æ®µè¯´çš„æ˜¯å¯¹å„ä¸ªæœåŠ¡çš„èµ„æºåšæ£€æµ‹ä»¥åŠå¯¹èµ„æºè¿›è¡Œ<strong>é”å®šæˆ–è€…é¢„ç•™</strong>ã€‚</li>
<li>Confirm é˜¶æ®µï¼šè¿™ä¸ªé˜¶æ®µè¯´çš„æ˜¯åœ¨å„ä¸ªæœåŠ¡ä¸­<strong>æ‰§è¡Œå®é™…çš„æ“ä½œ</strong>ã€‚</li>
<li>Cancel é˜¶æ®µï¼šå¦‚æœä»»ä½•ä¸€ä¸ªæœåŠ¡çš„ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œå‡ºé”™ï¼Œé‚£ä¹ˆè¿™é‡Œå°±éœ€è¦<strong>è¿›è¡Œè¡¥å¿</strong>ï¼Œå°±æ˜¯æ‰§è¡Œå·²ç»æ‰§è¡ŒæˆåŠŸçš„ä¸šåŠ¡é€»è¾‘çš„å›æ»šæ“ä½œã€‚ï¼ˆæŠŠé‚£äº›æ‰§è¡ŒæˆåŠŸçš„å›æ»šï¼‰</li>
</ul>
</blockquote>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ Bob è¦å‘ Smith è½¬è´¦ï¼Œæ€è·¯å¤§æ¦‚æ˜¯ï¼š</p>
<ol>
<li>é¦–å…ˆåœ¨ Try é˜¶æ®µï¼Œè¦å…ˆè°ƒç”¨è¿œç¨‹æ¥å£æŠŠ Smith å’Œ Bob çš„é’±ç»™å†»ç»“èµ·æ¥ã€‚</li>
<li>åœ¨ Confirm é˜¶æ®µï¼Œæ‰§è¡Œè¿œç¨‹è°ƒç”¨çš„è½¬è´¦çš„æ“ä½œï¼Œè½¬è´¦æˆåŠŸè¿›è¡Œè§£å†»ã€‚</li>
<li>å¦‚æœç¬¬ 2 æ­¥æ‰§è¡ŒæˆåŠŸï¼Œé‚£ä¹ˆè½¬è´¦æˆåŠŸï¼Œå¦‚æœç¬¬äºŒæ­¥æ‰§è¡Œå¤±è´¥ï¼Œåˆ™è°ƒç”¨è¿œç¨‹å†»ç»“æ¥å£å¯¹åº”çš„è§£å†»æ–¹æ³• (Cancel)ã€‚</li>
</ol>
<p>ä¼˜ç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šè·Ÿ 2PC æ¯”èµ·æ¥ï¼Œå®ç°ä»¥åŠæµç¨‹ç›¸å¯¹ç®€å•äº†ä¸€äº›ï¼Œä½†æ•°æ®çš„ä¸€è‡´æ€§æ¯” 2PC ä¹Ÿè¦å·®ä¸€äº›ã€‚</li>
<li>ç¼ºç‚¹ï¼šç¼ºç‚¹è¿˜æ˜¯æ¯”è¾ƒæ˜æ˜¾çš„ï¼Œåœ¨ 2,3 æ­¥ä¸­éƒ½æœ‰å¯èƒ½å¤±è´¥ã€‚TCC å±äºåº”ç”¨å±‚çš„ä¸€ç§è¡¥å¿æ–¹å¼ï¼Œæ‰€ä»¥éœ€è¦ç¨‹åºå‘˜åœ¨å®ç°çš„æ—¶å€™å¤šå†™å¾ˆå¤šè¡¥å¿çš„ä»£ç ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œä¸€äº›ä¸šåŠ¡æµç¨‹å¯èƒ½ç”¨ TCC ä¸å¤ªå¥½å®šä¹‰åŠå¤„ç†ã€‚</li>
</ul>
<p>è¿™ç§æ–¹æ¡ˆå‡ ä¹å¾ˆå°‘äººä½¿ç”¨ï¼Œå› ä¸º<strong>äº‹åŠ¡å›æ»š</strong>å®é™…ä¸Šæ˜¯<strong>ä¸¥é‡ä¾èµ–äºè‡ªå·±å†™ä»£ç æ¥å›æ»šå’Œè¡¥å¿</strong>äº†ï¼Œä¼šé€ æˆè¡¥å¿ä»£ç å·¨å¤§ã€‚</p>
<p>ä½†æ˜¯ï¼Œä¹Ÿæœ‰ç‰¹æ®Šçš„ä½¿ç”¨åœºæ™¯ï¼šä¸€èˆ¬æ¥è¯´è·Ÿ<strong>é’±</strong>ç›¸å…³çš„ï¼Œè·Ÿé’±æ‰“äº¤é“çš„ï¼Œ<strong>æ”¯ä»˜</strong>ã€<strong>äº¤æ˜“</strong>ç›¸å…³çš„åœºæ™¯ï¼Œä¼šç”¨ TCCï¼Œä¸¥æ ¼ä¿è¯åˆ†å¸ƒå¼äº‹åŠ¡è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨è‡ªåŠ¨å›æ»šï¼Œä¸¥æ ¼ä¿è¯èµ„é‡‘çš„æ­£ç¡®æ€§ï¼Œä¿è¯åœ¨èµ„é‡‘ä¸Šä¸ä¼šå‡ºç°é—®é¢˜ã€‚</p>
<p>è€Œä¸”æœ€å¥½æ˜¯ä½ çš„å„ä¸ªä¸šåŠ¡æ‰§è¡Œçš„æ—¶é—´éƒ½æ¯”è¾ƒçŸ­ã€‚</p>
<p>ä½†æ˜¯è¯´å®è¯ï¼Œä¸€èˆ¬å°½é‡åˆ«è¿™ä¹ˆæï¼Œè‡ªå·±æ‰‹å†™å›æ»šé€»è¾‘ï¼Œæˆ–è€…æ˜¯è¡¥å¿é€»è¾‘ï¼Œå®åœ¨å¤ªæ¶å¿ƒäº†ï¼Œé‚£ä¸ªä¸šåŠ¡ä»£ç æ˜¯å¾ˆéš¾ç»´æŠ¤çš„ã€‚</p>
<h2 id="3-æœ¬åœ°æ¶ˆæ¯è¡¨å¼‚æ­¥ç¡®ä¿"><a class="markdownIt-Anchor" href="#3-æœ¬åœ°æ¶ˆæ¯è¡¨å¼‚æ­¥ç¡®ä¿"></a> 3. æœ¬åœ°æ¶ˆæ¯è¡¨ï¼ˆå¼‚æ­¥ç¡®ä¿ï¼‰</h2>
<blockquote>
<p>æœ¬åœ°æ¶ˆæ¯è¡¨ä¸ä¸šåŠ¡æ•°æ®è¡¨å¤„äºåŒä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œè¿™æ ·å°±èƒ½åˆ©ç”¨æœ¬åœ°äº‹åŠ¡æ¥ä¿è¯åœ¨å¯¹è¿™ä¸¤ä¸ªè¡¨çš„æ“ä½œæ»¡è¶³äº‹åŠ¡ç‰¹æ€§ã€‚</p>
<ol>
<li>åœ¨åˆ†å¸ƒå¼äº‹åŠ¡æ“ä½œçš„ä¸€æ–¹å®Œæˆå†™ä¸šåŠ¡æ•°æ®çš„æ“ä½œä¹‹åå‘æœ¬åœ°æ¶ˆæ¯è¡¨å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼Œæœ¬åœ°äº‹åŠ¡èƒ½ä¿è¯è¿™ä¸ªæ¶ˆæ¯ä¸€å®šä¼šè¢«å†™å…¥æœ¬åœ°æ¶ˆæ¯è¡¨ä¸­ã€‚</li>
<li>ä¹‹åå°†æœ¬åœ°æ¶ˆæ¯è¡¨ä¸­çš„æ¶ˆæ¯è½¬å‘åˆ° Kafka ç­‰æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰ä¸­ï¼Œå¦‚æœè½¬å‘æˆåŠŸåˆ™å°†æ¶ˆæ¯ä»æœ¬åœ°æ¶ˆæ¯è¡¨ä¸­åˆ é™¤ï¼Œå¦åˆ™ç»§ç»­é‡æ–°è½¬å‘ã€‚</li>
<li>åœ¨åˆ†å¸ƒå¼äº‹åŠ¡æ“ä½œçš„å¦ä¸€æ–¹ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¯»å–ä¸€ä¸ªæ¶ˆæ¯ï¼Œå¹¶æ‰§è¡Œæ¶ˆæ¯ä¸­çš„æ“ä½œã€‚</li>
</ol>
</blockquote>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/åˆ†å¸ƒå¼äº‹åŠ¡æœ¬åœ°æ¶ˆæ¯.jpg!zp" />
</div>
<p>è¿™ç§æ–¹æ¡ˆéµå¾ª BASE ç†è®ºï¼Œé‡‡ç”¨çš„æ˜¯æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<p>æœ¬åœ°æ¶ˆæ¯è¡¨åˆ©ç”¨äº†æœ¬åœ°äº‹åŠ¡æ¥å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¹¶ä¸”ä½¿ç”¨äº†æ¶ˆæ¯é˜Ÿåˆ—æ¥ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<h3 id="31-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#31-ä¼˜ç¼ºç‚¹"></a> 3.1. ä¼˜ç¼ºç‚¹</h3>
<ul>
<li>ä¼˜ç‚¹ï¼šä¸€ç§éå¸¸ç»å…¸çš„å®ç°ï¼Œé¿å…äº†åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå®ç°äº†æœ€ç»ˆä¸€è‡´æ€§ã€‚</li>
<li>ç¼ºç‚¹ï¼šæ¶ˆæ¯è¡¨ä¼šè€¦åˆåˆ°ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œå¦‚æœæ²¡æœ‰å°è£…å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä¼šæœ‰å¾ˆå¤šæ‚æ´»éœ€è¦å¤„ç†ã€‚</li>
</ul>
<h2 id="4-mq-äº‹åŠ¡æ¶ˆæ¯"><a class="markdownIt-Anchor" href="#4-mq-äº‹åŠ¡æ¶ˆæ¯"></a> 4. MQ äº‹åŠ¡æ¶ˆæ¯</h2>
<p>æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹çš„ MQ æ˜¯æ”¯æŒäº‹åŠ¡æ¶ˆæ¯çš„ï¼Œæ¯”å¦‚ RocketMQï¼Œä»–ä»¬æ”¯æŒäº‹åŠ¡æ¶ˆæ¯çš„æ–¹å¼ä¹Ÿæ˜¯ç±»ä¼¼äºé‡‡ç”¨çš„äºŒé˜¶æ®µæäº¤ã€‚ä½†æ˜¯å¸‚é¢ä¸Šä¸€äº›ä¸»æµçš„ MQ éƒ½æ˜¯ä¸æ”¯æŒäº‹åŠ¡æ¶ˆæ¯çš„ï¼Œæ¯”å¦‚ RabbitMQ å’Œ Kafka éƒ½ä¸æ”¯æŒã€‚</p>
<p>ä»¥é˜¿é‡Œçš„ RocketMQ ä¸­é—´ä»¶ä¸ºä¾‹ï¼Œå…¶æ€è·¯å¤§è‡´ä¸ºï¼š</p>
<ol>
<li>Prepared æ¶ˆæ¯ï¼Œä¼šæ‹¿åˆ°æ¶ˆæ¯çš„åœ°å€ã€‚</li>
<li>æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ã€‚</li>
<li>é€šè¿‡ç¬¬ä¸€é˜¶æ®µæ‹¿åˆ°çš„åœ°å€å»è®¿é—®æ¶ˆæ¯ï¼Œå¹¶ä¿®æ”¹çŠ¶æ€ã€‚</li>
</ol>
<p>ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸šåŠ¡æ–¹æ³•å†…è¦æƒ³æ¶ˆæ¯é˜Ÿåˆ—æäº¤ä¸¤æ¬¡è¯·æ±‚ï¼Œä¸€æ¬¡å‘é€æ¶ˆæ¯å’Œä¸€æ¬¡ç¡®è®¤æ¶ˆæ¯ã€‚å¦‚æœç¡®è®¤æ¶ˆæ¯å‘é€å¤±è´¥äº† RocketMQ ä¼šå®šæœŸæ‰«ææ¶ˆæ¯é›†ç¾¤ä¸­çš„äº‹åŠ¡æ¶ˆæ¯ï¼Œè¿™æ—¶å€™å‘ç°äº† Prepared æ¶ˆæ¯ï¼Œå®ƒä¼šå‘æ¶ˆæ¯å‘é€è€…ç¡®è®¤ï¼Œæ‰€ä»¥ç”Ÿäº§æ–¹éœ€è¦å®ç°ä¸€ä¸ª check æ¥å£ï¼ŒRocketMQ ä¼šæ ¹æ®å‘é€ç«¯è®¾ç½®çš„ç­–ç•¥æ¥å†³å®šæ˜¯å›æ»šè¿˜æ˜¯ç»§ç»­å‘é€ç¡®è®¤æ¶ˆæ¯ã€‚è¿™æ ·å°±ä¿è¯äº†æ¶ˆæ¯å‘é€ä¸æœ¬åœ°äº‹åŠ¡åŒæ—¶æˆåŠŸæˆ–åŒæ—¶å¤±è´¥ã€‚</p>
<h3 id="41-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#41-ä¼˜ç¼ºç‚¹"></a> 4.1. ä¼˜ç¼ºç‚¹</h3>
<ul>
<li>ä¼˜ç‚¹ï¼šå®ç°äº†æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸éœ€è¦ä¾èµ–æœ¬åœ°æ•°æ®åº“äº‹åŠ¡ã€‚</li>
<li>ç¼ºç‚¹ï¼šå®ç°éš¾åº¦å¤§ï¼Œä¸»æµ MQ ä¸æ”¯æŒã€‚</li>
</ul>
<h3 id="42-ä¸¤é˜¶æ®µæäº¤æ–¹æ¡ˆxa-æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#42-ä¸¤é˜¶æ®µæäº¤æ–¹æ¡ˆxa-æ–¹æ¡ˆ"></a> 4.2. ä¸¤é˜¶æ®µæäº¤æ–¹æ¡ˆ/XA æ–¹æ¡ˆ</h3>
<p>æ‰€è°“çš„ XA æ–¹æ¡ˆï¼Œå³ï¼šä¸¤é˜¶æ®µæäº¤ï¼Œæœ‰ä¸€ä¸ª<strong>äº‹åŠ¡ç®¡ç†å™¨</strong>çš„æ¦‚å¿µï¼Œè´Ÿè´£åè°ƒå¤šä¸ªæ•°æ®åº“ï¼ˆèµ„æºç®¡ç†å™¨ï¼‰çš„äº‹åŠ¡ï¼Œäº‹åŠ¡ç®¡ç†å™¨å…ˆé—®é—®å„ä¸ªæ•°æ®åº“ä½ å‡†å¤‡å¥½äº†å—ï¼Ÿå¦‚æœæ¯ä¸ªæ•°æ®åº“éƒ½å›å¤ okï¼Œé‚£ä¹ˆå°±æ­£å¼æäº¤äº‹åŠ¡ï¼Œåœ¨å„ä¸ªæ•°æ®åº“ä¸Šæ‰§è¡Œæ“ä½œï¼›å¦‚æœä»»ä½•å…¶ä¸­ä¸€ä¸ªæ•°æ®åº“å›ç­”ä¸ okï¼Œé‚£ä¹ˆå°±å›æ»šäº‹åŠ¡ã€‚</p>
<p>è¿™ç§åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆï¼Œæ¯”è¾ƒé€‚åˆå•å—åº”ç”¨é‡Œï¼Œè·¨å¤šä¸ªåº“çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè€Œä¸”å› ä¸ºä¸¥é‡ä¾èµ–äºæ•°æ®åº“å±‚é¢æ¥æå®šå¤æ‚çš„äº‹åŠ¡ï¼Œæ•ˆç‡å¾ˆä½ï¼Œç»å¯¹ä¸é€‚åˆé«˜å¹¶å‘çš„åœºæ™¯ã€‚å¦‚æœè¦ç©å„¿ï¼Œé‚£ä¹ˆåŸºäº <code>Spring + JTA</code> å°±å¯ä»¥æå®šï¼Œè‡ªå·±éšä¾¿æœä¸ª demo çœ‹çœ‹å°±çŸ¥é“äº†ã€‚</p>
<p>è¿™ä¸ªæ–¹æ¡ˆï¼Œæˆ‘ä»¬å¾ˆå°‘ç”¨ï¼Œä¸€èˆ¬æ¥è¯´<strong>æŸä¸ªç³»ç»Ÿå†…éƒ¨å¦‚æœå‡ºç°è·¨å¤šä¸ªåº“</strong>çš„è¿™ä¹ˆä¸€ä¸ªæ“ä½œï¼Œæ˜¯<strong>ä¸åˆè§„</strong>çš„ã€‚æˆ‘å¯ä»¥ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹ï¼Œ ç°åœ¨å¾®æœåŠ¡ï¼Œä¸€ä¸ªå¤§çš„ç³»ç»Ÿåˆ†æˆå‡ åä¸ªç”šè‡³å‡ ç™¾ä¸ªæœåŠ¡ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬çš„è§„å®šå’Œè§„èŒƒï¼Œæ˜¯è¦æ±‚<strong>æ¯ä¸ªæœåŠ¡åªèƒ½æ“ä½œè‡ªå·±å¯¹åº”çš„ä¸€ä¸ªæ•°æ®åº“</strong>ã€‚</p>
<p>å¦‚æœä½ è¦æ“ä½œåˆ«çš„æœåŠ¡å¯¹åº”çš„åº“ï¼Œä¸å…è®¸ç›´è¿åˆ«çš„æœåŠ¡çš„åº“ï¼Œè¿åå¾®æœåŠ¡æ¶æ„çš„è§„èŒƒï¼Œä½ éšä¾¿äº¤å‰èƒ¡ä¹±è®¿é—®ï¼Œå‡ ç™¾ä¸ªæœåŠ¡çš„è¯ï¼Œå…¨ä½“ä¹±å¥—ï¼Œè¿™æ ·çš„ä¸€å¥—æœåŠ¡æ˜¯æ²¡æ³•ç®¡ç†çš„ï¼Œæ²¡æ³•æ²»ç†çš„ï¼Œå¯èƒ½ä¼šå‡ºç°æ•°æ®è¢«åˆ«äººæ”¹é”™ï¼Œè‡ªå·±çš„åº“è¢«åˆ«äººå†™æŒ‚ç­‰æƒ…å†µã€‚</p>
<p>å¦‚æœä½ è¦æ“ä½œåˆ«äººçš„æœåŠ¡çš„åº“ï¼Œä½ å¿…é¡»æ˜¯é€šè¿‡<strong>è°ƒç”¨åˆ«çš„æœåŠ¡çš„æ¥å£</strong>æ¥å®ç°ï¼Œç»å¯¹ä¸å…è®¸äº¤å‰è®¿é—®åˆ«äººçš„æ•°æ®åº“ã€‚</p>
<div align="center"><img src="https://github.com/doocs/advanced-java/blob/master/images/distributed-transaction-XA.png"/></div>
### 4.3. æœ¬åœ°æ¶ˆæ¯è¡¨
<p>æœ¬åœ°æ¶ˆæ¯è¡¨å…¶å®æ˜¯å›½å¤–çš„ ebay æå‡ºæ¥çš„è¿™ä¹ˆä¸€å¥—æ€æƒ³ã€‚</p>
<p>è¿™ä¸ªå¤§æ¦‚æ„æ€æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>A ç³»ç»Ÿåœ¨è‡ªå·±æœ¬åœ°ä¸€ä¸ªäº‹åŠ¡é‡Œæ“ä½œåŒæ—¶ï¼Œæ’å…¥ä¸€æ¡æ•°æ®åˆ°æ¶ˆæ¯è¡¨ï¼›</li>
<li>æ¥ç€ A ç³»ç»Ÿå°†è¿™ä¸ªæ¶ˆæ¯å‘é€åˆ° MQ ä¸­å»ï¼›</li>
<li>B ç³»ç»Ÿæ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œï¼Œå¾€è‡ªå·±æœ¬åœ°æ¶ˆæ¯è¡¨é‡Œæ’å…¥ä¸€æ¡æ•°æ®ï¼ŒåŒæ—¶æ‰§è¡Œå…¶ä»–çš„ä¸šåŠ¡æ“ä½œï¼Œå¦‚æœè¿™ä¸ªæ¶ˆæ¯å·²ç»è¢«å¤„ç†è¿‡äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶è¿™ä¸ªäº‹åŠ¡ä¼šå›æ»šï¼Œè¿™æ ·<strong>ä¿è¯ä¸ä¼šé‡å¤å¤„ç†æ¶ˆæ¯</strong>ï¼›</li>
<li>B ç³»ç»Ÿæ‰§è¡ŒæˆåŠŸä¹‹åï¼Œå°±ä¼šæ›´æ–°è‡ªå·±æœ¬åœ°æ¶ˆæ¯è¡¨çš„çŠ¶æ€ä»¥åŠ A ç³»ç»Ÿæ¶ˆæ¯è¡¨çš„çŠ¶æ€ï¼›</li>
<li>å¦‚æœ B ç³»ç»Ÿå¤„ç†å¤±è´¥äº†ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæ›´æ–°æ¶ˆæ¯è¡¨çŠ¶æ€ï¼Œé‚£ä¹ˆæ­¤æ—¶ A ç³»ç»Ÿä¼šå®šæ—¶æ‰«æè‡ªå·±çš„æ¶ˆæ¯è¡¨ï¼Œå¦‚æœæœ‰æœªå¤„ç†çš„æ¶ˆæ¯ï¼Œä¼šå†æ¬¡å‘é€åˆ° MQ ä¸­å»ï¼Œè®© B å†æ¬¡å¤„ç†ï¼›</li>
<li>è¿™ä¸ªæ–¹æ¡ˆä¿è¯äº†æœ€ç»ˆä¸€è‡´æ€§ï¼Œå“ªæ€• B äº‹åŠ¡å¤±è´¥äº†ï¼Œä½†æ˜¯ A ä¼šä¸æ–­é‡å‘æ¶ˆæ¯ï¼Œç›´åˆ° B é‚£è¾¹æˆåŠŸä¸ºæ­¢ã€‚</li>
</ol>
<p>è¿™ä¸ªæ–¹æ¡ˆè¯´å®è¯æœ€å¤§çš„é—®é¢˜å°±åœ¨äº<strong>ä¸¥é‡ä¾èµ–äºæ•°æ®åº“çš„æ¶ˆæ¯è¡¨æ¥ç®¡ç†äº‹åŠ¡</strong>å•¥çš„ï¼Œå¦‚æœæ˜¯é«˜å¹¶å‘åœºæ™¯å’‹åŠå‘¢ï¼Ÿå’‹æ‰©å±•å‘¢ï¼Ÿæ‰€ä»¥ä¸€èˆ¬ç¡®å®å¾ˆå°‘ç”¨ã€‚</p>
<div align="center"><img src="https://github.com/doocs/advanced-java/blob/master/images/distributed-transaction-local-message-table.png"/></div>
### 4.4. å¯é æ¶ˆæ¯æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ
<p>è¿™ä¸ªçš„æ„æ€ï¼Œå°±æ˜¯å¹²è„†ä¸è¦ç”¨æœ¬åœ°çš„æ¶ˆæ¯è¡¨äº†ï¼Œç›´æ¥åŸºäº MQ æ¥å®ç°äº‹åŠ¡ã€‚æ¯”å¦‚é˜¿é‡Œçš„ RocketMQ å°±æ”¯æŒæ¶ˆæ¯äº‹åŠ¡ã€‚</p>
<p>å¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼š</p>
<ol>
<li>A ç³»ç»Ÿå…ˆå‘é€ä¸€ä¸ª prepared æ¶ˆæ¯åˆ° mqï¼Œå¦‚æœè¿™ä¸ª prepared æ¶ˆæ¯å‘é€å¤±è´¥é‚£ä¹ˆå°±ç›´æ¥å–æ¶ˆæ“ä½œåˆ«æ‰§è¡Œäº†ï¼›</li>
<li>å¦‚æœè¿™ä¸ªæ¶ˆæ¯å‘é€æˆåŠŸè¿‡äº†ï¼Œé‚£ä¹ˆæ¥ç€æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼Œå¦‚æœæˆåŠŸå°±å‘Šè¯‰ mq å‘é€ç¡®è®¤æ¶ˆæ¯ï¼Œå¦‚æœå¤±è´¥å°±å‘Šè¯‰ mq å›æ»šæ¶ˆæ¯ï¼›</li>
<li>å¦‚æœå‘é€äº†ç¡®è®¤æ¶ˆæ¯ï¼Œé‚£ä¹ˆæ­¤æ—¶ B ç³»ç»Ÿä¼šæ¥æ”¶åˆ°ç¡®è®¤æ¶ˆæ¯ï¼Œç„¶åæ‰§è¡Œæœ¬åœ°çš„äº‹åŠ¡ï¼›</li>
<li>mq ä¼šè‡ªåŠ¨<strong>å®šæ—¶è½®è¯¢</strong>æ‰€æœ‰ prepared æ¶ˆæ¯å›è°ƒä½ çš„æ¥å£ï¼Œé—®ä½ ï¼Œè¿™ä¸ªæ¶ˆæ¯æ˜¯ä¸æ˜¯æœ¬åœ°äº‹åŠ¡å¤„ç†å¤±è´¥äº†ï¼Œæ‰€æœ‰æ²¡å‘é€ç¡®è®¤çš„æ¶ˆæ¯ï¼Œæ˜¯ç»§ç»­é‡è¯•è¿˜æ˜¯å›æ»šï¼Ÿä¸€èˆ¬æ¥è¯´è¿™é‡Œä½ å°±å¯ä»¥æŸ¥ä¸‹æ•°æ®åº“çœ‹ä¹‹å‰æœ¬åœ°äº‹åŠ¡æ˜¯å¦æ‰§è¡Œï¼Œå¦‚æœå›æ»šäº†ï¼Œé‚£ä¹ˆè¿™é‡Œä¹Ÿå›æ»šå§ã€‚è¿™ä¸ªå°±æ˜¯é¿å…å¯èƒ½æœ¬åœ°äº‹åŠ¡æ‰§è¡ŒæˆåŠŸäº†ï¼Œè€Œç¡®è®¤æ¶ˆæ¯å´å‘é€å¤±è´¥äº†ã€‚</li>
<li>è¿™ä¸ªæ–¹æ¡ˆé‡Œï¼Œè¦æ˜¯ç³»ç»Ÿ B çš„äº‹åŠ¡å¤±è´¥äº†å’‹åŠï¼Ÿé‡è¯•å’¯ï¼Œè‡ªåŠ¨ä¸æ–­é‡è¯•ç›´åˆ°æˆåŠŸï¼Œå¦‚æœå®åœ¨æ˜¯ä¸è¡Œï¼Œè¦ä¹ˆå°±æ˜¯é’ˆå¯¹é‡è¦çš„èµ„é‡‘ç±»ä¸šåŠ¡è¿›è¡Œå›æ»šï¼Œæ¯”å¦‚ B ç³»ç»Ÿæœ¬åœ°å›æ»šåï¼Œæƒ³åŠæ³•é€šçŸ¥ç³»ç»Ÿ A ä¹Ÿå›æ»šï¼›æˆ–è€…æ˜¯å‘é€æŠ¥è­¦ç”±äººå·¥æ¥æ‰‹å·¥å›æ»šå’Œè¡¥å¿ã€‚</li>
<li>è¿™ä¸ªè¿˜æ˜¯æ¯”è¾ƒåˆé€‚çš„ï¼Œç›®å‰å›½å†…äº’è”ç½‘å…¬å¸å¤§éƒ½æ˜¯è¿™ä¹ˆç©å„¿çš„ï¼Œè¦ä¸ä½ ä¸¾ç”¨ RocketMQ æ”¯æŒçš„ï¼Œè¦ä¸ä½ å°±è‡ªå·±åŸºäºç±»ä¼¼ ActiveMQï¼ŸRabbitMQï¼Ÿè‡ªå·±å°è£…ä¸€å¥—ç±»ä¼¼çš„é€»è¾‘å‡ºæ¥ï¼Œæ€»ä¹‹æ€è·¯å°±æ˜¯è¿™æ ·å­çš„ã€‚</li>
</ol>
<div align="center"><img src="https://github.com/doocs/advanced-java/blob/master/images/distributed-transaction-reliable-message.png"/></div>
### 4.5. æœ€å¤§åŠªåŠ›é€šçŸ¥æ–¹æ¡ˆ
<p>è¿™ä¸ªæ–¹æ¡ˆçš„å¤§è‡´æ„æ€å°±æ˜¯ï¼š</p>
<ol>
<li>ç³»ç»Ÿ A æœ¬åœ°äº‹åŠ¡æ‰§è¡Œå®Œä¹‹åï¼Œå‘é€ä¸ªæ¶ˆæ¯åˆ° MQï¼›</li>
<li>è¿™é‡Œä¼šæœ‰ä¸ªä¸“é—¨æ¶ˆè´¹ MQ çš„<strong>æœ€å¤§åŠªåŠ›é€šçŸ¥æœåŠ¡</strong>ï¼Œè¿™ä¸ªæœåŠ¡ä¼šæ¶ˆè´¹ MQ ç„¶åå†™å…¥æ•°æ®åº“ä¸­è®°å½•ä¸‹æ¥ï¼Œæˆ–è€…æ˜¯æ”¾å…¥ä¸ªå†…å­˜é˜Ÿåˆ—ä¹Ÿå¯ä»¥ï¼Œæ¥ç€è°ƒç”¨ç³»ç»Ÿ B çš„æ¥å£ï¼›</li>
<li>è¦æ˜¯ç³»ç»Ÿ B æ‰§è¡ŒæˆåŠŸå°± ok äº†ï¼›è¦æ˜¯ç³»ç»Ÿ B æ‰§è¡Œå¤±è´¥äº†ï¼Œé‚£ä¹ˆæœ€å¤§åŠªåŠ›é€šçŸ¥æœåŠ¡å°±å®šæ—¶å°è¯•é‡æ–°è°ƒç”¨ç³»ç»Ÿ Bï¼Œåå¤ N æ¬¡ï¼Œæœ€åè¿˜æ˜¯ä¸è¡Œå°±æ”¾å¼ƒã€‚</li>
</ol>
<h3 id="46-ä½ ä»¬å…¬å¸æ˜¯å¦‚ä½•å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„"><a class="markdownIt-Anchor" href="#46-ä½ ä»¬å…¬å¸æ˜¯å¦‚ä½•å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„"></a> 4.6. ä½ ä»¬å…¬å¸æ˜¯å¦‚ä½•å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„ï¼Ÿ</h3>
<p>å¦‚æœä½ çœŸçš„è¢«é—®åˆ°ï¼Œå¯ä»¥è¿™ä¹ˆè¯´ï¼Œæˆ‘ä»¬æŸæŸç‰¹åˆ«ä¸¥æ ¼çš„åœºæ™¯ï¼Œç”¨çš„æ˜¯ TCC æ¥ä¿è¯å¼ºä¸€è‡´æ€§ï¼›ç„¶åå…¶ä»–çš„ä¸€äº›åœºæ™¯åŸºäºé˜¿é‡Œçš„ RocketMQ æ¥å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ã€‚</p>
<p>ä½ æ‰¾ä¸€ä¸ªä¸¥æ ¼èµ„é‡‘è¦æ±‚ç»å¯¹ä¸èƒ½é”™çš„åœºæ™¯ï¼Œä½ å¯ä»¥è¯´ä½ æ˜¯ç”¨çš„ TCC æ–¹æ¡ˆï¼›å¦‚æœæ˜¯ä¸€èˆ¬çš„åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯ï¼Œè®¢å•æ’å…¥ä¹‹åè¦è°ƒç”¨åº“å­˜æœåŠ¡æ›´æ–°åº“å­˜ï¼Œåº“å­˜æ•°æ®æ²¡æœ‰èµ„é‡‘é‚£ä¹ˆçš„æ•æ„Ÿï¼Œå¯ä»¥ç”¨å¯é æ¶ˆæ¯æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆã€‚</p>
<p>å‹æƒ…æç¤ºä¸€ä¸‹ï¼ŒRocketMQ 3.2.6 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæ˜¯å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„æ€è·¯æ¥çš„ï¼Œä½†æ˜¯ä¹‹åæ¥å£åšäº†ä¸€äº›æ”¹å˜ï¼Œæˆ‘è¿™é‡Œä¸å†èµ˜è¿°äº†ã€‚</p>
<p>å½“ç„¶å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥å‚è€ƒå¯é æ¶ˆæ¯æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆæ¥è‡ªå·±å®ç°ä¸€å¥—åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæ¯”å¦‚åŸºäº RocketMQ æ¥ç©å„¿ã€‚</p>
<h2 id="5-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#5-å‚è€ƒèµ„æ–™"></a> 5. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html" target="_blank" rel="noopener">èŠèŠåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå†è¯´è¯´è§£å†³æ–¹æ¡ˆ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>äº‹åŠ¡</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/distributed-session-theory/</url>
    <content><![CDATA[<h1 id="åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†"></a> åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†</h1>
<blockquote>
<p>ç”±äº Http æ˜¯ä¸€ç§æ— çŠ¶æ€çš„åè®®ï¼ŒæœåŠ¡å™¨å•å•ä»ç½‘ç»œè¿æ¥ä¸Šæ— ä»çŸ¥é“å®¢æˆ·èº«ä»½ã€‚</p>
<p>ä¼šè¯è·Ÿè¸ªæ˜¯ Web ç¨‹åºä¸­å¸¸ç”¨çš„æŠ€æœ¯ï¼Œç”¨æ¥è·Ÿè¸ªç”¨æˆ·çš„æ•´ä¸ªä¼šè¯ã€‚å¸¸ç”¨ä¼šè¯è·Ÿè¸ªæŠ€æœ¯æ˜¯ Cookie ä¸ Sessionã€‚</p>
</blockquote>
<h2 id="1-ç®€ä»‹"><a class="markdownIt-Anchor" href="#1-ç®€ä»‹"></a> 1. ç®€ä»‹</h2>
<h3 id="11-ä»€ä¹ˆæ˜¯-cookie"><a class="markdownIt-Anchor" href="#11-ä»€ä¹ˆæ˜¯-cookie"></a> 1.1. ä»€ä¹ˆæ˜¯ Cookie</h3>
<p>Cookie å®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šçš„æ–‡æœ¬ä¿¡æ¯ï¼Œå¹¶ä¿ç•™äº†å„ç§è·Ÿè¸ªçš„ä¿¡æ¯ã€‚</p>
<p>Cookie å·¥ä½œæ­¥éª¤ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çš„çŠ¶æ€ï¼Œå°±æ˜¯ç”¨ response å‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ª Cookieã€‚</li>
<li>å®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠ Cookie ä¿å­˜ä¸‹æ¥ã€‚</li>
<li>å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯¥è¯·æ±‚çš„ç½‘å€è¿åŒ Cookie ä¸€åŒæäº¤ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æ£€æŸ¥è¯¥ Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚</li>
</ol>
<p>Cookie ä¸»è¦ç”¨äºä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>ä¼šè¯çŠ¶æ€ç®¡ç†ï¼ˆå¦‚ç”¨æˆ·ç™»å½•çŠ¶æ€ã€è´­ç‰©è½¦ã€æ¸¸æˆåˆ†æ•°æˆ–å…¶å®ƒéœ€è¦è®°å½•çš„ä¿¡æ¯ï¼‰</li>
<li>ä¸ªæ€§åŒ–è®¾ç½®ï¼ˆå¦‚ç”¨æˆ·è‡ªå®šä¹‰è®¾ç½®ã€ä¸»é¢˜ç­‰ï¼‰</li>
<li>æµè§ˆå™¨è¡Œä¸ºè·Ÿè¸ªï¼ˆå¦‚è·Ÿè¸ªåˆ†æç”¨æˆ·è¡Œä¸ºç­‰ï¼‰</li>
</ul>
<p><strong><em>æ³¨ï¼šCookie åŠŸèƒ½éœ€è¦æµè§ˆå™¨çš„æ”¯æŒï¼Œå¦‚æœæµè§ˆå™¨ä¸æ”¯æŒ Cookie æˆ–è€… Cookie ç¦ç”¨äº†ï¼ŒCookie åŠŸèƒ½å°±ä¼šå¤±æ•ˆã€‚</em></strong></p>
<h3 id="12-ä»€ä¹ˆæ˜¯-session"><a class="markdownIt-Anchor" href="#12-ä»€ä¹ˆæ˜¯-session"></a> 1.2. ä»€ä¹ˆæ˜¯ Session</h3>
<p>Session ä»£è¡¨ç€æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸€æ¬¡ä¼šè¯çš„è¿‡ç¨‹ã€‚Session å¯¹è±¡å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºçš„ Web é¡µä¹‹é—´è·³è½¬æ—¶ï¼Œå­˜å‚¨åœ¨ Session å¯¹è±¡ä¸­çš„å˜é‡å°†ä¸ä¼šä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æ•´ä¸ªç”¨æˆ·ä¼šè¯ä¸­ä¸€ç›´å­˜åœ¨ä¸‹å»ã€‚å½“å®¢æˆ·ç«¯å…³é—­ä¼šè¯ï¼Œæˆ–è€… Session è¶…æ—¶å¤±æ•ˆæ—¶ä¼šè¯ç»“æŸã€‚</p>
<h3 id="13-cookie-å’Œ-session-çš„åŒºåˆ«"><a class="markdownIt-Anchor" href="#13-cookie-å’Œ-session-çš„åŒºåˆ«"></a> 1.3. Cookie å’Œ Session çš„åŒºåˆ«</h3>
<ul>
<li><strong>ä½œç”¨èŒƒå›´ä¸åŒ</strong>ï¼ŒCookie ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ï¼ŒSession ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚</li>
<li><strong>å­˜å–æ–¹å¼çš„ä¸åŒ</strong>ï¼ŒCookie åªèƒ½ä¿å­˜ ASCIIï¼ŒSession å¯ä»¥å­˜ä»»æ„æ•°æ®ç±»å‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥åœ¨ Session ä¸­ä¿æŒä¸€äº›å¸¸ç”¨å˜é‡ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ UserId ç­‰ã€‚</li>
<li><strong>æœ‰æ•ˆæœŸä¸åŒ</strong>ï¼ŒCookie å¯è®¾ç½®ä¸ºé•¿æ—¶é—´ä¿æŒï¼Œæ¯”å¦‚æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„é»˜è®¤ç™»å½•åŠŸèƒ½ï¼ŒSession ä¸€èˆ¬å¤±æ•ˆæ—¶é—´è¾ƒçŸ­ï¼Œå®¢æˆ·ç«¯å…³é—­æˆ–è€… Session è¶…æ—¶éƒ½ä¼šå¤±æ•ˆã€‚</li>
<li><strong>éšç§ç­–ç•¥ä¸åŒ</strong>ï¼ŒCookie å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ¯”è¾ƒå®¹æ˜“é­åˆ°ä¸æ³•è·å–ï¼Œæ—©æœŸæœ‰äººå°†ç”¨æˆ·çš„ç™»å½•åå’Œå¯†ç å­˜å‚¨åœ¨ Cookie ä¸­å¯¼è‡´ä¿¡æ¯è¢«çªƒå–ï¼›Session å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œå®‰å…¨æ€§ç›¸å¯¹ Cookie è¦å¥½ä¸€äº›ã€‚</li>
<li><strong>å­˜å‚¨å¤§å°ä¸åŒ</strong>ï¼Œ å•ä¸ª Cookie ä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡ 4Kï¼ŒSession å¯å­˜å‚¨æ•°æ®è¿œé«˜äº Cookieã€‚</li>
</ul>
<h3 id="14-ä¸ºä»€ä¹ˆéœ€è¦-cookie-å’Œ-sessionä»–ä»¬æœ‰ä»€ä¹ˆå…³è”"><a class="markdownIt-Anchor" href="#14-ä¸ºä»€ä¹ˆéœ€è¦-cookie-å’Œ-sessionä»–ä»¬æœ‰ä»€ä¹ˆå…³è”"></a> 1.4. ä¸ºä»€ä¹ˆéœ€è¦ Cookie å’Œ Sessionï¼Œä»–ä»¬æœ‰ä»€ä¹ˆå…³è”ï¼Ÿ</h3>
<p>è¯´èµ·æ¥ä¸ºä»€ä¹ˆéœ€è¦ Cookie ï¼Œè¿™å°±éœ€è¦ä»æµè§ˆå™¨å¼€å§‹è¯´èµ·ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“æµè§ˆå™¨æ˜¯æ²¡æœ‰çŠ¶æ€çš„(HTTP åè®®æ— çŠ¶æ€)ï¼Œè¿™æ„å‘³ç€æµè§ˆå™¨å¹¶ä¸çŸ¥é“æ˜¯å¼ ä¸‰è¿˜æ˜¯æå››åœ¨å’ŒæœåŠ¡ç«¯æ‰“äº¤é“ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦æœ‰ä¸€ä¸ªæœºåˆ¶æ¥å‘Šè¯‰æœåŠ¡ç«¯ï¼Œæœ¬æ¬¡æ“ä½œç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œæ˜¯å“ªä¸ªç”¨æˆ·åœ¨æ‰§è¡Œçš„æ“ä½œï¼Œé‚£è¿™å¥—æœºåˆ¶çš„å®ç°å°±éœ€è¦ Cookie å’Œ Session çš„é…åˆã€‚</p>
<p>é‚£ä¹ˆ Cookie å’Œ Session æ˜¯å¦‚ä½•é…åˆçš„å‘¢ï¼Ÿæˆ‘ç”»äº†ä¸€å¼ å›¾å¤§å®¶å¯ä»¥å…ˆäº†è§£ä¸‹ã€‚</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/5/13/16aafb5d90f398e2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img" /></p>
<p>ç”¨æˆ·ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æ ¹æ®ç”¨æˆ·æäº¤çš„ç›¸å…³ä¿¡æ¯ï¼Œåˆ›å»ºåˆ›å»ºå¯¹åº”çš„ Session ï¼Œè¯·æ±‚è¿”å›æ—¶å°†æ­¤ Session çš„å”¯ä¸€æ ‡è¯†ä¿¡æ¯ SessionID è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ SessionID ä¿¡æ¯åï¼Œä¼šå°†æ­¤ä¿¡æ¯å­˜å…¥åˆ° Cookie ä¸­ï¼ŒåŒæ—¶ Cookie è®°å½•æ­¤ SessionID å±äºå“ªä¸ªåŸŸåã€‚</p>
<p>å½“ç”¨æˆ·ç¬¬äºŒæ¬¡è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼Œè¯·æ±‚ä¼šè‡ªåŠ¨åˆ¤æ–­æ­¤åŸŸåä¸‹æ˜¯å¦å­˜åœ¨ Cookie ä¿¡æ¯ï¼Œå¦‚æœå­˜åœ¨è‡ªåŠ¨å°† Cookie ä¿¡æ¯ä¹Ÿå‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¼šä» Cookie ä¸­è·å– SessionIDï¼Œå†æ ¹æ® SessionID æŸ¥æ‰¾å¯¹åº”çš„ Session ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯´æ˜ç”¨æˆ·æ²¡æœ‰ç™»å½•æˆ–è€…ç™»å½•å¤±æ•ˆï¼Œå¦‚æœæ‰¾åˆ° Session è¯æ˜ç”¨æˆ·å·²ç»ç™»å½•å¯æ‰§è¡Œåé¢æ“ä½œã€‚</p>
<p>æ ¹æ®ä»¥ä¸Šæµç¨‹å¯çŸ¥ï¼ŒSessionID æ˜¯è¿æ¥ Cookie å’Œ Session çš„ä¸€é“æ¡¥æ¢ï¼Œå¤§éƒ¨åˆ†ç³»ç»Ÿä¹Ÿæ˜¯æ ¹æ®æ­¤åŸç†æ¥éªŒè¯ç”¨æˆ·ç™»å½•çŠ¶æ€ã€‚</p>
<h3 id="15-å¦‚æœæµè§ˆå™¨ç¦ç”¨-cookie-æ€ä¹ˆåŠ"><a class="markdownIt-Anchor" href="#15-å¦‚æœæµè§ˆå™¨ç¦ç”¨-cookie-æ€ä¹ˆåŠ"></a> 1.5. å¦‚æœæµè§ˆå™¨ç¦ç”¨ Cookie æ€ä¹ˆåŠ</h3>
<p>æ—¢ç„¶æœåŠ¡ç«¯æ˜¯æ ¹æ® Cookie ä¸­çš„ä¿¡æ¯åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œé‚£ä¹ˆå¦‚æœæµè§ˆå™¨ä¸­ç¦æ­¢äº† Cookieï¼Œå¦‚ä½•ä¿éšœæ•´ä¸ªæœºåˆ¶çš„æ­£å¸¸è¿è½¬ã€‚</p>
<p>ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œæ¯æ¬¡è¯·æ±‚ä¸­éƒ½æºå¸¦ä¸€ä¸ª SessionID çš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥ Post çš„æ–¹å¼æäº¤ï¼Œä¹Ÿå¯ä»¥åœ¨è¯·æ±‚çš„åœ°å€åé¢æ‹¼æ¥ <code>xxx?SessionID=123456...</code>ã€‚</p>
<p>ç¬¬äºŒç§æ–¹æ¡ˆï¼ŒToken æœºåˆ¶ã€‚Token æœºåˆ¶å¤šç”¨äº App å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’çš„æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ç”¨äº Web ç«¯åšç”¨æˆ·çŠ¶æ€ç®¡ç†ã€‚</p>
<p>Token çš„æ„æ€æ˜¯â€œä»¤ç‰Œâ€ï¼Œæ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä½œä¸ºå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚çš„ä¸€ä¸ªæ ‡è¯†ã€‚Token æœºåˆ¶å’Œ Cookie å’Œ Session çš„ä½¿ç”¨æœºåˆ¶æ¯”è¾ƒç±»ä¼¼ã€‚</p>
<p>å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»å½•åï¼ŒæœåŠ¡å™¨æ ¹æ®æäº¤çš„ç”¨æˆ·ä¿¡æ¯ç”Ÿæˆä¸€ä¸ª Tokenï¼Œå“åº”æ—¶å°† Token è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥åå®¢æˆ·ç«¯åªéœ€å¸¦ä¸Šè¿™ä¸ª Token å‰æ¥è¯·æ±‚æ•°æ®å³å¯ï¼Œæ— éœ€å†æ¬¡ç™»å½•éªŒè¯ã€‚</p>
<h2 id="2-åˆ†å¸ƒå¼-session"><a class="markdownIt-Anchor" href="#2-åˆ†å¸ƒå¼-session"></a> 2. åˆ†å¸ƒå¼ Session</h2>
<p>åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œä¸€ä¸ªç”¨æˆ·çš„ Session å¦‚æœåªå­˜å‚¨åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆå½“è´Ÿè½½å‡è¡¡å™¨æŠŠç”¨æˆ·çš„ä¸‹ä¸€ä¸ªè¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¯¥æœåŠ¡å™¨æ²¡æœ‰ç”¨æˆ·çš„ Sessionï¼Œå°±å¯èƒ½å¯¼è‡´ç”¨æˆ·éœ€è¦é‡æ–°è¿›è¡Œç™»å½•ç­‰æ“ä½œã€‚</p>
<p>åˆ†å¸ƒå¼ Session çš„å‡ ç§å®ç°ç­–ç•¥ï¼š</p>
<ol>
<li>ç²˜æ€§ session</li>
<li>åº”ç”¨æœåŠ¡å™¨é—´çš„ session å¤åˆ¶å…±äº«</li>
<li>åŸºäºç¼“å­˜çš„ session å…±äº« âœ…</li>
</ol>
<blockquote>
<p>æ¨èï¼šåŸºäºç¼“å­˜çš„ session å…±äº«</p>
</blockquote>
<h3 id="21-ç²˜æ€§-session"><a class="markdownIt-Anchor" href="#21-ç²˜æ€§-session"></a> 2.1. ç²˜æ€§ Session</h3>
<blockquote>
<p>ç²˜æ€§ Sessionï¼ˆSticky Sessionsï¼‰<strong>éœ€è¦é…ç½®è´Ÿè½½å‡è¡¡å™¨ï¼Œä½¿å¾—ä¸€ä¸ªç”¨æˆ·çš„æ‰€æœ‰è¯·æ±‚éƒ½è·¯ç”±åˆ°ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ä¸Š</strong>ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠç”¨æˆ·çš„ Session å­˜æ”¾åœ¨è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸­ã€‚</p>
<p>ç¼ºç‚¹ï¼š<strong>å½“æœåŠ¡å™¨èŠ‚ç‚¹å®•æœºæ—¶ï¼Œå°†ä¸¢å¤±è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰ Session</strong>ã€‚</p>
</blockquote>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/MultiNode-StickySessions.jpg!zp" />
</div>
<h3 id="22-session-å¤åˆ¶å…±äº«"><a class="markdownIt-Anchor" href="#22-session-å¤åˆ¶å…±äº«"></a> 2.2. Session å¤åˆ¶å…±äº«</h3>
<blockquote>
<p>Session å¤åˆ¶å…±äº«ï¼ˆSession Replicationï¼‰<strong>åœ¨æœåŠ¡å™¨èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œ Session åŒæ­¥æ“ä½œ</strong>ï¼Œè¿™æ ·çš„è¯ç”¨æˆ·å¯ä»¥è®¿é—®ä»»ä½•ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ã€‚</p>
<p>ç¼ºç‚¹ï¼š<strong>å ç”¨è¿‡å¤šå†…å­˜</strong>ï¼›<strong>åŒæ­¥è¿‡ç¨‹å ç”¨ç½‘ç»œå¸¦å®½ä»¥åŠæœåŠ¡å™¨å¤„ç†å™¨æ—¶é—´</strong>ã€‚</p>
</blockquote>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/MultiNode-SessionReplication.jpg!zp" />
</div>
<h3 id="23-åŸºäºç¼“å­˜çš„-session-å…±äº«"><a class="markdownIt-Anchor" href="#23-åŸºäºç¼“å­˜çš„-session-å…±äº«"></a> 2.3. åŸºäºç¼“å­˜çš„ session å…±äº«</h3>
<blockquote>
<p><strong>ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„å­˜å‚¨æœåŠ¡å™¨å­˜å‚¨ Session æ•°æ®</strong>ï¼Œå¯ä»¥å­˜åœ¨ MySQL æ•°æ®åº“ä¸Šï¼Œä¹Ÿå¯ä»¥å­˜åœ¨ Redis æˆ–è€… Memcached è¿™ç§å†…å­˜å‹æ•°æ®åº“ã€‚</p>
<p>ç¼ºç‚¹ï¼šéœ€è¦å»å®ç°å­˜å– Session çš„ä»£ç ã€‚</p>
</blockquote>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/MultiNode-SpringSession.jpg!zp" />
</div>
<h2 id="3-å…·ä½“å®ç°"><a class="markdownIt-Anchor" href="#3-å…·ä½“å®ç°"></a> 3. å…·ä½“å®ç°</h2>
<h3 id="31-jwt-token"><a class="markdownIt-Anchor" href="#31-jwt-token"></a> 3.1. JWT Token</h3>
<p>ä½¿ç”¨ JWT Token å‚¨å­˜ç”¨æˆ·èº«ä»½ï¼Œç„¶åå†ä»æ•°æ®åº“æˆ–è€… cache ä¸­è·å–å…¶ä»–çš„ä¿¡æ¯ã€‚è¿™æ ·æ— è®ºè¯·æ±‚åˆ†é…åˆ°å“ªä¸ªæœåŠ¡å™¨éƒ½æ— æ‰€è°“ã€‚</p>
<h3 id="32-tomcat-redis"><a class="markdownIt-Anchor" href="#32-tomcat-redis"></a> 3.2. tomcat + redis</h3>
<p>è¿™ä¸ªå…¶å®è¿˜æŒºæ–¹ä¾¿çš„ï¼Œå°±æ˜¯ä½¿ç”¨ session çš„ä»£ç ï¼Œè·Ÿä»¥å‰ä¸€æ ·ï¼Œè¿˜æ˜¯åŸºäº tomcat åŸç”Ÿçš„ session æ”¯æŒå³å¯ï¼Œç„¶åå°±æ˜¯ç”¨ä¸€ä¸ªå«åš <code>Tomcat RedisSessionManager</code> çš„ä¸œè¥¿ï¼Œè®©æ‰€æœ‰æˆ‘ä»¬éƒ¨ç½²çš„ tomcat éƒ½å°† session æ•°æ®å­˜å‚¨åˆ° redis å³å¯ã€‚</p>
<p>åœ¨ tomcat çš„é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">"com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">"com.orangefunction.tomcat.redissessions.RedisSessionManager"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">host</span>=<span class="string">"&#123;redis.host&#125;"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">port</span>=<span class="string">"&#123;redis.port&#125;"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">database</span>=<span class="string">"&#123;redis.dbnum&#125;"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">maxInactiveInterval</span>=<span class="string">"60"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åæŒ‡å®š redis çš„ host å’Œ port å°± ok äº†ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">"com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">"com.orangefunction.tomcat.redissessions.RedisSessionManager"</span></span></span><br><span class="line"><span class="tag">	 <span class="attr">sentinelMaster</span>=<span class="string">"mymaster"</span></span></span><br><span class="line"><span class="tag">	 <span class="attr">sentinels</span>=<span class="string">"&lt;sentinel1-ip&gt;:26379,&lt;sentinel2-ip&gt;:26379,&lt;sentinel3-ip&gt;:26379"</span></span></span><br><span class="line"><span class="tag">	 <span class="attr">maxInactiveInterval</span>=<span class="string">"60"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥ç”¨ä¸Šé¢è¿™ç§æ–¹å¼åŸºäº redis å“¨å…µæ”¯æŒçš„ redis é«˜å¯ç”¨é›†ç¾¤æ¥ä¿å­˜ session æ•°æ®ï¼Œéƒ½æ˜¯ ok çš„ã€‚</p>
<h3 id="33-spring-session-redis"><a class="markdownIt-Anchor" href="#33-spring-session-redis"></a> 3.3. spring session + redis</h3>
<p>ä¸Šé¢é‚£ç§ tomcat + redis çš„æ–¹å¼å¥½ç”¨ï¼Œä½†æ˜¯ä¼š<strong>ä¸¥é‡ä¾èµ–äº web å®¹å™¨</strong>ï¼Œä¸å¥½å°†ä»£ç ç§»æ¤åˆ°å…¶ä»– web å®¹å™¨ä¸Šå»ï¼Œå°¤å…¶æ˜¯ä½ è¦æ˜¯æ¢äº†æŠ€æœ¯æ ˆå’‹æ•´ï¼Ÿæ¯”å¦‚æ¢æˆäº† spring cloud æˆ–è€…æ˜¯ spring boot ä¹‹ç±»çš„å‘¢ï¼Ÿ</p>
<p>æ‰€ä»¥ç°åœ¨æ¯”è¾ƒå¥½çš„è¿˜æ˜¯åŸºäº Java ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯ springã€‚äººå®¶ spring åŸºæœ¬ä¸Šæ‰¿åŒ…äº†å¤§éƒ¨åˆ†æˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„æ¡†æ¶ï¼Œspirng cloud åšå¾®æœåŠ¡ï¼Œspring boot åšè„šæ‰‹æ¶ï¼Œæ‰€ä»¥ç”¨ <a href="https://github.com/spring-projects/spring-session" target="_blank" rel="noopener">sping session</a> æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p>
<p>åœ¨ pom.xml ä¸­é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.session<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-session-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ spring é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"redisHttpSessionConfiguration"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">class</span>=<span class="string">"org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxInactiveIntervalInSeconds"</span> <span class="attr">value</span>=<span class="string">"600"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jedisPoolConfig"</span> <span class="attr">class</span>=<span class="string">"redis.clients.jedis.JedisPoolConfig"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxTotal"</span> <span class="attr">value</span>=<span class="string">"100"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jedisConnectionFactory"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</span> <span class="attr">destroy-method</span>=<span class="string">"destroy"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hostName"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis_hostname&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"port"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis_port&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;redis_pwd&#125;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"timeout"</span> <span class="attr">value</span>=<span class="string">"3000"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"usePool"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"poolConfig"</span> <span class="attr">ref</span>=<span class="string">"jedisPoolConfig"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ web.xml ä¸­é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/putIntoSession"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">putIntoSession</span><span class="params">(HttpServletRequest request, String username)</span> </span>&#123;</span><br><span class="line">        request.getSession().setAttribute(<span class="string">"name"</span>,  <span class="string">"leo"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/getFromSession"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFromSession</span><span class="params">(HttpServletRequest request, Model model)</span></span>&#123;</span><br><span class="line">        String name = request.getSession().getAttribute(<span class="string">"name"</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç å°±æ˜¯ ok çš„ï¼Œç»™ sping session é…ç½®åŸºäº redis æ¥å­˜å‚¨ session æ•°æ®ï¼Œç„¶åé…ç½®äº†ä¸€ä¸ª spring session çš„è¿‡æ»¤å™¨ï¼Œè¿™æ ·çš„è¯ï¼Œsession ç›¸å…³æ“ä½œéƒ½ä¼šäº¤ç»™ spring session æ¥ç®¡äº†ã€‚æ¥ç€åœ¨ä»£ç ä¸­ï¼Œå°±ç”¨åŸç”Ÿçš„ session æ“ä½œï¼Œå°±æ˜¯ç›´æ¥åŸºäº spring sesion ä» redis ä¸­è·å–æ•°æ®äº†ã€‚</p>
<p>å®ç°åˆ†å¸ƒå¼çš„ä¼šè¯æœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œæˆ‘è¯´çš„åªä¸è¿‡æ˜¯æ¯”è¾ƒå¸¸è§çš„å‡ ç§æ–¹å¼ï¼Œtomcat + redis æ—©æœŸæ¯”è¾ƒå¸¸ç”¨ï¼Œä½†æ˜¯ä¼šé‡è€¦åˆåˆ° tomcat ä¸­ï¼›è¿‘äº›å¹´ï¼Œé€šè¿‡ spring session æ¥å®ç°ã€‚</p>
<h2 id="4-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#4-å‚è€ƒèµ„æ–™"></a> 4. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://github.com/L316476844/distributed-session" target="_blank" rel="noopener">é›†ç¾¤/åˆ†å¸ƒå¼ç¯å¢ƒ Session çš„å‡ ç§ç­–ç•¥</a></li>
<li><a href="https://juejin.im/post/5cd9037ee51d456e5c5babca" target="_blank" rel="noopener">ä½ çœŸçš„äº†è§£ Cookie å’Œ Session å—</a></li>
<li><a href="https://juejin.im/post/5aede266f265da0ba266e0ef" target="_blank" rel="noopener">èŠä¸€èŠ session å’Œ cookie</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>session</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/distributed-lock-theory/</url>
    <content><![CDATA[<h1 id="åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†"></a> åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E6%80%9D%E8%B7%AF">1. åˆ†å¸ƒå¼é”æ€è·¯</a></li>
<li><a href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81">2. æ•°æ®åº“åˆ†å¸ƒå¼é”</a>
<ul>
<li><a href="#21-%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0">2.1. å…·ä½“å®ç°</a></li>
<li><a href="#22-%E9%97%AE%E9%A2%98">2.2. é—®é¢˜</a></li>
<li><a href="#23-%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95">2.3. è§£å†³åŠæ³•</a></li>
<li><a href="#24-%E5%B0%8F%E7%BB%93">2.4. å°ç»“</a></li>
</ul>
</li>
<li><a href="#3-redis-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81">3. Redis åˆ†å¸ƒå¼é”</a>
<ul>
<li><a href="#31-%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF">3.1. å®ç°æ€è·¯</a></li>
<li><a href="#32-%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0">3.2. å…·ä½“å®ç°</a></li>
<li><a href="#33-%E5%B0%8F%E7%BB%93">3.3. å°ç»“</a></li>
<li><a href="#34-redlock-%E7%AE%97%E6%B3%95">3.4. RedLock ç®—æ³•</a></li>
</ul>
</li>
<li><a href="#4-zookeeper-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81">4. ZooKeeper åˆ†å¸ƒå¼é”</a>
<ul>
<li><a href="#41-%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF">4.1. å®ç°æ€è·¯</a></li>
<li><a href="#42-%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0">4.2. å…·ä½“å®ç°</a></li>
<li><a href="#43-%E5%B0%8F%E7%BB%93">4.3. å°ç»“</a></li>
</ul>
</li>
<li><a href="#5-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E6%96%B9%E6%A1%88%E5%AF%B9%E6%AF%94">5. åˆ†å¸ƒå¼é”æ–¹æ¡ˆå¯¹æ¯”</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<p>Java åŸç”Ÿ API è™½ç„¶æœ‰å¹¶å‘é”ï¼Œä½†å¹¶æ²¡æœ‰æä¾›åˆ†å¸ƒå¼é”çš„èƒ½åŠ›ï¼Œæ‰€ä»¥é’ˆå¯¹åˆ†å¸ƒå¼åœºæ™¯ä¸­çš„é”éœ€è¦è§£å†³çš„æ–¹æ¡ˆã€‚</p>
<p>åˆ†å¸ƒå¼é”çš„è§£å†³æ–¹æ¡ˆå¤§è‡´æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>åŸºäºæ•°æ®åº“å®ç°</li>
<li>åŸºäºç¼“å­˜ï¼ˆredisï¼Œmemcached ç­‰ï¼‰å®ç°</li>
<li>åŸºäº Zookeeper å®ç° âœ…</li>
</ul>
<blockquote>
<p>æ³¨ï¼šæ¨èåŸºäº ZooKeeper å®ç°åˆ†å¸ƒå¼é”ï¼Œå…·ä½“åŸå› çœ‹å®Œæœ¬æ–‡å³å¯æ˜äº†ã€‚</p>
</blockquote>
<h2 id="1-åˆ†å¸ƒå¼é”æ€è·¯"><a class="markdownIt-Anchor" href="#1-åˆ†å¸ƒå¼é”æ€è·¯"></a> 1. åˆ†å¸ƒå¼é”æ€è·¯</h2>
<p>åˆ†å¸ƒå¼é”çš„æ€»ä½“æ€è·¯å¤§åŒå°å¼‚ï¼Œä»…åœ¨å®ç°ç»†èŠ‚ä¸Šæœ‰æ‰€ä¸åŒã€‚</p>
<p>åˆ†å¸ƒå¼é”çš„ä¸»è¦æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>äº’æ–¥</strong> - åˆ›å»ºé”å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œè¡¨ç°å½¢å¼ä¸ºå‘æ•°æ®å­˜å‚¨æœåŠ¡å™¨æˆ–å®¹å™¨æ’å…¥ä¸€ä¸ªå”¯ä¸€çš„ keyï¼Œä¸€æ—¦æœ‰ä¸€ä¸ªçº¿ç¨‹æ’å…¥è¿™ä¸ª keyï¼Œå…¶ä»–çº¿ç¨‹å°±ä¸èƒ½å†æ’å…¥äº†ã€‚</li>
<li><strong>é¿å…æ°¸è¿œä¸é‡Šæ”¾é”</strong> - æ•°æ®åº“åˆ†å¸ƒå¼é”å’Œç¼“å­˜åˆ†å¸ƒå¼é”ï¼ˆRedisï¼‰çš„æ€è·¯éƒ½æ˜¯å¼•å…¥è¶…æ—¶æœºåˆ¶ï¼Œå³æˆåŠŸç”³è¯·é”åï¼Œè¶…è¿‡ä¸€å®šæ—¶é—´ï¼Œé”å¤±æ•ˆï¼ˆåˆ é™¤ keyï¼‰ï¼ŒåŸå› åœ¨äºå®ƒä»¬æ— æ³•æ„ŸçŸ¥ç”³è¯·é”çš„å®¢æˆ·ç«¯èŠ‚ç‚¹çŠ¶æ€ã€‚è€Œ ZooKeeper ç”±äºå…¶ znode ä»¥ç›®å½•ã€æ–‡ä»¶å½¢å¼ç»„ç»‡ï¼Œå¤©ç„¶å°±å­˜åœ¨ç‰©ç†ç©ºé—´éš”ç¦»ï¼Œåªè¦ znode å­˜åœ¨ï¼Œå³è¡¨ç¤ºå®¢æˆ·ç«¯èŠ‚ç‚¹è¿˜åœ¨å·¥ä½œï¼Œæ‰€ä»¥ä¸å­˜åœ¨è¿™ç§é—®é¢˜ã€‚</li>
<li><strong>å®¹é”™</strong>ï¼ˆåªè¦å¤§éƒ¨åˆ† redis èŠ‚ç‚¹åˆ›å»ºäº†è¿™æŠŠé”å°±å¯ä»¥ï¼‰</li>
</ul>
<h2 id="2-æ•°æ®åº“åˆ†å¸ƒå¼é”"><a class="markdownIt-Anchor" href="#2-æ•°æ®åº“åˆ†å¸ƒå¼é”"></a> 2. æ•°æ®åº“åˆ†å¸ƒå¼é”</h2>
<h3 id="21-å…·ä½“å®ç°"><a class="markdownIt-Anchor" href="#21-å…·ä½“å®ç°"></a> 2.1. å…·ä½“å®ç°</h3>
<p>ï¼ˆ1ï¼‰åˆ›å»ºè¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`methodLock`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'ä¸»é”®'</span>,</span><br><span class="line">  <span class="string">`method_name`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span> <span class="keyword">COMMENT</span> <span class="string">'é”å®šçš„æ–¹æ³•å'</span>,</span><br><span class="line">  <span class="string">`desc`</span> <span class="built_in">varchar</span>(<span class="number">1024</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'å¤‡æ³¨ä¿¡æ¯'</span>,</span><br><span class="line">  <span class="string">`update_time`</span> <span class="built_in">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'ä¿å­˜æ•°æ®æ—¶é—´ï¼Œè‡ªåŠ¨ç”Ÿæˆ'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`uidx_method_name`</span> (<span class="string">`method_name `</span>) <span class="keyword">USING</span> BTREE</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'é”å®šä¸­çš„æ–¹æ³•'</span>;</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰è·å–é”</p>
<p>æƒ³è¦é”ä½æŸä¸ªæ–¹æ³•æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹ SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> methodLock(method_name,<span class="keyword">desc</span>) <span class="keyword">values</span> (â€˜method_nameâ€™,â€˜<span class="keyword">desc</span>â€™)</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæˆ‘ä»¬å¯¹ <code>method_name</code> åšäº†å”¯ä¸€æ€§çº¦æŸï¼Œè¿™é‡Œå¦‚æœæœ‰å¤šä¸ªè¯·æ±‚åŒæ—¶æäº¤åˆ°æ•°æ®åº“çš„è¯ï¼Œæ•°æ®åº“ä¼šä¿è¯åªæœ‰ä¸€ä¸ªæ“ä½œå¯ä»¥æˆåŠŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºæ“ä½œæˆåŠŸçš„é‚£ä¸ªçº¿ç¨‹è·å¾—äº†è¯¥æ–¹æ³•çš„é”ï¼Œå¯ä»¥æ‰§è¡Œæ–¹æ³•ä½“å†…å®¹ã€‚</p>
<p>æˆåŠŸæ’å…¥åˆ™è·å–é”ã€‚</p>
<p>ï¼ˆ3ï¼‰é‡Šæ”¾é”</p>
<p>å½“æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæƒ³è¦é‡Šæ”¾é”çš„è¯ï¼Œéœ€è¦æ‰§è¡Œä»¥ä¸‹ Sql:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> methodLock <span class="keyword">where</span> method_name =<span class="string">'method_name'</span></span><br></pre></td></tr></table></figure>
<h3 id="22-é—®é¢˜"><a class="markdownIt-Anchor" href="#22-é—®é¢˜"></a> 2.2. é—®é¢˜</h3>
<ul>
<li>è¿™æŠŠé”å¼ºä¾èµ–æ•°æ®åº“çš„å¯ç”¨æ€§ã€‚å¦‚æœæ•°æ®åº“æ˜¯ä¸€ä¸ªå•ç‚¹ï¼Œä¸€æ—¦æ•°æ®åº“æŒ‚æ‰ï¼Œä¼šå¯¼è‡´ä¸šåŠ¡ç³»ç»Ÿä¸å¯ç”¨ã€‚</li>
<li>è¿™æŠŠé”æ²¡æœ‰å¤±æ•ˆæ—¶é—´ï¼Œä¸€æ—¦è§£é”æ“ä½œå¤±è´¥ï¼Œå°±ä¼šå¯¼è‡´é”è®°å½•ä¸€ç›´åœ¨æ•°æ®åº“ä¸­ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•å†è·å¾—åˆ°é”ã€‚</li>
<li>è¿™æŠŠé”åªèƒ½æ˜¯éé˜»å¡çš„ï¼Œå› ä¸ºæ•°æ®çš„ insert æ“ä½œï¼Œä¸€æ—¦æ’å…¥å¤±è´¥å°±ä¼šç›´æ¥æŠ¥é”™ã€‚æ²¡æœ‰è·å¾—é”çš„çº¿ç¨‹å¹¶ä¸ä¼šè¿›å…¥æ’é˜Ÿé˜Ÿåˆ—ï¼Œè¦æƒ³å†æ¬¡è·å¾—é”å°±è¦å†æ¬¡è§¦å‘è·å¾—é”æ“ä½œã€‚</li>
<li>è¿™æŠŠé”æ˜¯éé‡å…¥çš„ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹åœ¨æ²¡æœ‰é‡Šæ”¾é”ä¹‹å‰æ— æ³•å†æ¬¡è·å¾—è¯¥é”ã€‚å› ä¸ºæ•°æ®ä¸­æ•°æ®å·²ç»å­˜åœ¨äº†ã€‚</li>
</ul>
<h3 id="23-è§£å†³åŠæ³•"><a class="markdownIt-Anchor" href="#23-è§£å†³åŠæ³•"></a> 2.3. è§£å†³åŠæ³•</h3>
<ul>
<li>å•ç‚¹é—®é¢˜å¯ä»¥ç”¨å¤šæ•°æ®åº“å®ä¾‹ï¼ŒåŒæ—¶å¡ N ä¸ªè¡¨ï¼ŒN/2+1 ä¸ªæˆåŠŸå°±ä»»åŠ¡é”å®šæˆåŠŸ</li>
<li>å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œéš”ä¸€æ®µæ—¶é—´æ¸…é™¤ä¸€æ¬¡è¿‡æœŸçš„æ•°æ®ã€‚</li>
<li>å†™ä¸€ä¸ª while å¾ªç¯ï¼Œä¸æ–­çš„é‡è¯•æ’å…¥ï¼Œç›´åˆ°æˆåŠŸã€‚</li>
<li>åœ¨æ•°æ®åº“è¡¨ä¸­åŠ ä¸ªå­—æ®µï¼Œè®°å½•å½“å‰è·å¾—é”çš„æœºå™¨çš„ä¸»æœºä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯ï¼Œé‚£ä¹ˆä¸‹æ¬¡å†è·å–é”çš„æ—¶å€™å…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œå¦‚æœå½“å‰æœºå™¨çš„ä¸»æœºä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯åœ¨æ•°æ®åº“å¯ä»¥æŸ¥åˆ°çš„è¯ï¼Œç›´æ¥æŠŠé”åˆ†é…ç»™ä»–å°±å¯ä»¥äº†ã€‚</li>
</ul>
<h3 id="24-å°ç»“"><a class="markdownIt-Anchor" href="#24-å°ç»“"></a> 2.4. å°ç»“</h3>
<ul>
<li>ä¼˜ç‚¹: ç›´æ¥å€ŸåŠ©æ•°æ®åº“ï¼Œå®¹æ˜“ç†è§£ã€‚</li>
<li>ç¼ºç‚¹: ä¼šæœ‰å„ç§å„æ ·çš„é—®é¢˜ï¼Œåœ¨è§£å†³é—®é¢˜çš„è¿‡ç¨‹ä¸­ä¼šä½¿æ•´ä¸ªæ–¹æ¡ˆå˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚æ“ä½œæ•°æ®åº“éœ€è¦ä¸€å®šçš„å¼€é”€ï¼Œæ€§èƒ½é—®é¢˜éœ€è¦è€ƒè™‘ã€‚</li>
</ul>
<h2 id="3-redis-åˆ†å¸ƒå¼é”"><a class="markdownIt-Anchor" href="#3-redis-åˆ†å¸ƒå¼é”"></a> 3. Redis åˆ†å¸ƒå¼é”</h2>
<p>ç›¸æ¯”äºç”¨æ•°æ®åº“æ¥å®ç°åˆ†å¸ƒå¼é”ï¼ŒåŸºäºç¼“å­˜å®ç°çš„åˆ†å¸ƒå¼é”çš„æ€§èƒ½ä¼šæ›´å¥½ä¸€äº›ã€‚ç›®å‰æœ‰å¾ˆå¤šæˆç†Ÿçš„åˆ†å¸ƒå¼äº§å“ï¼ŒåŒ…æ‹¬ Redisã€memcacheã€Tair ç­‰ã€‚è¿™é‡Œä»¥ Redis ä¸¾ä¾‹ã€‚</p>
<h3 id="31-å®ç°æ€è·¯"><a class="markdownIt-Anchor" href="#31-å®ç°æ€è·¯"></a> 3.1. å®ç°æ€è·¯</h3>
<p>è¿™ä¸ªåˆ†å¸ƒå¼é”æœ‰ 3 ä¸ªé‡è¦çš„è€ƒé‡ç‚¹ï¼š</p>
<ol>
<li>äº’æ–¥ï¼ˆåªèƒ½æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯è·å–é”ï¼‰</li>
<li>ä¸èƒ½æ­»é”</li>
<li>å®¹é”™ï¼ˆåªè¦å¤§éƒ¨åˆ† redis èŠ‚ç‚¹åˆ›å»ºäº†è¿™æŠŠé”å°±å¯ä»¥ï¼‰</li>
</ol>
<p>å¯¹åº”çš„ Redis æŒ‡ä»¤å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>setnx</code> - <code>setnx key val</code>ï¼šå½“ä¸”ä»…å½“ key ä¸å­˜åœ¨æ—¶ï¼Œset ä¸€ä¸ª key ä¸º val çš„å­—ç¬¦ä¸²ï¼Œè¿”å› 1ï¼›è‹¥ key å­˜åœ¨ï¼Œåˆ™ä»€ä¹ˆéƒ½ä¸åšï¼Œè¿”å› 0ã€‚</li>
<li><code>expire</code> - <code>expire key timeout</code>ï¼šä¸º key è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸º secondï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´é”ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œé¿å…æ­»é”ã€‚</li>
<li><code>delete</code> - <code>delete key</code>ï¼šåˆ é™¤ key</li>
</ul>
<h3 id="32-å…·ä½“å®ç°"><a class="markdownIt-Anchor" href="#32-å…·ä½“å®ç°"></a> 3.2. å…·ä½“å®ç°</h3>
<p>ï¼ˆ1ï¼‰ç”³è¯·é”</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SET</span> resource_name <span class="comment">my_random_value NX PX 30000</span></span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤å°± okã€‚</p>
<ul>
<li><code>NX</code>ï¼šè¡¨ç¤ºåªæœ‰ <code>key</code> ä¸å­˜åœ¨çš„æ—¶å€™æ‰ä¼šè®¾ç½®æˆåŠŸã€‚ï¼ˆå¦‚æœæ­¤æ—¶ redis ä¸­å­˜åœ¨è¿™ä¸ª keyï¼Œé‚£ä¹ˆè®¾ç½®å¤±è´¥ï¼Œè¿”å› <code>nil</code>ï¼‰</li>
<li><code>PX 30000</code>ï¼šæ„æ€æ˜¯ 30s åé”è‡ªåŠ¨é‡Šæ”¾ã€‚åˆ«äººåˆ›å»ºçš„æ—¶å€™å¦‚æœå‘ç°å·²ç»æœ‰äº†å°±ä¸èƒ½åŠ é”äº†ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰é‡Šæ”¾é”</p>
<p>é‡Šæ”¾é”å°±æ˜¯åˆ é™¤ key ï¼Œä½†æ˜¯ä¸€èˆ¬å¯ä»¥ç”¨ <code>lua</code> è„šæœ¬åˆ é™¤ï¼Œåˆ¤æ–­ value ä¸€æ ·æ‰åˆ é™¤ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">-- åˆ é™¤é”çš„æ—¶å€™ï¼Œæ‰¾åˆ° key å¯¹åº”çš„ valueï¼Œè·Ÿè‡ªå·±ä¼ è¿‡å»çš„ value åšæ¯”è¾ƒï¼Œå¦‚æœæ˜¯ä¸€æ ·çš„æ‰åˆ é™¤ã€‚</span><br><span class="line"><span class="keyword">if</span> redis.call(<span class="string">"get"</span>,KEYS[<span class="number">1</span>]) == ARGV[<span class="number">1</span>] then</span><br><span class="line">    <span class="keyword">return</span> redis.call(<span class="string">"del"</span>,KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h3 id="33-å°ç»“"><a class="markdownIt-Anchor" href="#33-å°ç»“"></a> 3.3. å°ç»“</h3>
<p>ä¸ºå•¥è¦ç”¨ <code>random_value</code> éšæœºå€¼å‘¢ï¼Ÿå› ä¸ºå¦‚æœæŸä¸ªå®¢æˆ·ç«¯è·å–åˆ°äº†é”ï¼Œä½†æ˜¯é˜»å¡äº†å¾ˆé•¿æ—¶é—´æ‰æ‰§è¡Œå®Œï¼Œæ¯”å¦‚è¯´è¶…è¿‡äº† 30sï¼Œæ­¤æ—¶å¯èƒ½å·²ç»è‡ªåŠ¨é‡Šæ”¾é”äº†ï¼Œæ­¤æ—¶å¯èƒ½åˆ«çš„å®¢æˆ·ç«¯å·²ç»è·å–åˆ°äº†è¿™ä¸ªé”ï¼Œè¦æ˜¯ä½ è¿™ä¸ªæ—¶å€™ç›´æ¥åˆ é™¤ key çš„è¯ä¼šæœ‰é—®é¢˜ï¼Œæ‰€ä»¥å¾—ç”¨éšæœºå€¼åŠ ä¸Šé¢çš„ <code>lua</code> è„šæœ¬æ¥é‡Šæ”¾é”ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·æ˜¯è‚¯å®šä¸è¡Œçš„ã€‚å› ä¸ºå¦‚æœæ˜¯æ™®é€šçš„ redis å•å®ä¾‹ï¼Œé‚£å°±æ˜¯å•ç‚¹æ•…éšœã€‚æˆ–è€…æ˜¯ redis æ™®é€šä¸»ä»ï¼Œé‚£ redis ä¸»ä»å¼‚æ­¥å¤åˆ¶ï¼Œå¦‚æœä¸»èŠ‚ç‚¹æŒ‚äº†ï¼ˆkey å°±æ²¡æœ‰äº†ï¼‰ï¼Œkey è¿˜æ²¡åŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼Œæ­¤æ—¶ä»èŠ‚ç‚¹åˆ‡æ¢ä¸ºä¸»èŠ‚ç‚¹ï¼Œåˆ«äººå°±å¯ä»¥ set keyï¼Œä»è€Œæ‹¿åˆ°é”ã€‚</p>
<h3 id="34-redlock-ç®—æ³•"><a class="markdownIt-Anchor" href="#34-redlock-ç®—æ³•"></a> 3.4. RedLock ç®—æ³•</h3>
<p>è¿™ä¸ªåœºæ™¯æ˜¯å‡è®¾æœ‰ä¸€ä¸ª redis clusterï¼Œæœ‰ 5 ä¸ª redis master å®ä¾‹ã€‚ç„¶åæ‰§è¡Œå¦‚ä¸‹æ­¥éª¤è·å–ä¸€æŠŠé”ï¼š</p>
<ol>
<li>è·å–å½“å‰æ—¶é—´æˆ³ï¼Œå•ä½æ˜¯æ¯«ç§’ï¼›</li>
<li>è·Ÿä¸Šé¢ç±»ä¼¼ï¼Œè½®æµå°è¯•åœ¨æ¯ä¸ª master èŠ‚ç‚¹ä¸Šåˆ›å»ºé”ï¼Œè¿‡æœŸæ—¶é—´è¾ƒçŸ­ï¼Œä¸€èˆ¬å°±å‡ åæ¯«ç§’ï¼›</li>
<li>å°è¯•åœ¨<strong>å¤§å¤šæ•°èŠ‚ç‚¹</strong>ä¸Šå»ºç«‹ä¸€ä¸ªé”ï¼Œæ¯”å¦‚ 5 ä¸ªèŠ‚ç‚¹å°±è¦æ±‚æ˜¯ 3 ä¸ªèŠ‚ç‚¹ <code>n / 2 + 1</code>ï¼›</li>
<li>å®¢æˆ·ç«¯è®¡ç®—å»ºç«‹å¥½é”çš„æ—¶é—´ï¼Œå¦‚æœå»ºç«‹é”çš„æ—¶é—´å°äºè¶…æ—¶æ—¶é—´ï¼Œå°±ç®—å»ºç«‹æˆåŠŸäº†ï¼›</li>
<li>è¦æ˜¯é”å»ºç«‹å¤±è´¥äº†ï¼Œé‚£ä¹ˆå°±ä¾æ¬¡ä¹‹å‰å»ºç«‹è¿‡çš„é”åˆ é™¤ï¼›</li>
<li>åªè¦åˆ«äººå»ºç«‹äº†ä¸€æŠŠåˆ†å¸ƒå¼é”ï¼Œä½ å°±å¾—<strong>ä¸æ–­è½®è¯¢å»å°è¯•è·å–é”</strong>ã€‚</li>
</ol>
<p><a href="https://redis.io/" target="_blank" rel="noopener">Redis å®˜æ–¹</a>ç»™å‡ºäº†ä»¥ä¸Šä¸¤ç§åŸºäº Redis å®ç°åˆ†å¸ƒå¼é”çš„æ–¹æ³•ï¼Œè¯¦ç»†è¯´æ˜å¯ä»¥æŸ¥çœ‹ï¼š<a href="https://redis.io/topics/distlock" target="_blank" rel="noopener">https://redis.io/topics/distlock</a> ã€‚</p>
<h2 id="4-zookeeper-åˆ†å¸ƒå¼é”"><a class="markdownIt-Anchor" href="#4-zookeeper-åˆ†å¸ƒå¼é”"></a> 4. ZooKeeper åˆ†å¸ƒå¼é”</h2>
<h3 id="41-å®ç°æ€è·¯"><a class="markdownIt-Anchor" href="#41-å®ç°æ€è·¯"></a> 4.1. å®ç°æ€è·¯</h3>
<p>è¿™ä¹Ÿæ˜¯ ZooKeeper å®¢æˆ·ç«¯ curator çš„åˆ†å¸ƒå¼é”å®ç°ã€‚</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç›®å½• mylockï¼›</li>
<li>çº¿ç¨‹ A æƒ³è·å–é”å°±åœ¨ mylock ç›®å½•ä¸‹åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼›</li>
<li>è·å– mylock ç›®å½•ä¸‹æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œç„¶åè·å–æ¯”è‡ªå·±å°çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜å½“å‰çº¿ç¨‹é¡ºåºå·æœ€å°ï¼Œè·å¾—é”ï¼›</li>
<li>çº¿ç¨‹ B è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ¤æ–­è‡ªå·±ä¸æ˜¯æœ€å°èŠ‚ç‚¹ï¼Œè®¾ç½®ç›‘å¬æ¯”è‡ªå·±æ¬¡å°çš„èŠ‚ç‚¹ï¼›</li>
<li>çº¿ç¨‹ A å¤„ç†å®Œï¼Œåˆ é™¤è‡ªå·±çš„èŠ‚ç‚¹ï¼Œçº¿ç¨‹ B ç›‘å¬åˆ°å˜æ›´äº‹ä»¶ï¼Œåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯åˆ™è·å¾—é”ã€‚</li>
</ol>
<h3 id="42-å…·ä½“å®ç°"><a class="markdownIt-Anchor" href="#42-å…·ä½“å®ç°"></a> 4.2. å…·ä½“å®ç°</h3>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ZooKeeperSession</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> bingo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2018/11/29</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZooKeeperSession</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> CountDownLatch connectedSemaphore = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ZooKeeper zookeeper;</span><br><span class="line">    <span class="keyword">private</span> CountDownLatch latch;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ZooKeeperSession</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.zookeeper = <span class="keyword">new</span> ZooKeeper(<span class="string">"192.168.31.187:2181,192.168.31.19:2181,192.168.31.227:2181"</span>, <span class="number">50000</span>, <span class="keyword">new</span> ZooKeeperWatcher());</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                connectedSemaphore.await();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">"ZooKeeper session established......"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åˆ†å¸ƒå¼é”</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> productId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">acquireDistributedLock</span><span class="params">(Long productId)</span> </span>&#123;</span><br><span class="line">        String path = <span class="string">"/product-lock-"</span> + productId;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            zookeeper.create(path, <span class="string">""</span>.getBytes(), Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// ç›¸å½“äºæ˜¯ç»™nodeæ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œå»çœ‹çœ‹è¿™ä¸ªç›‘å¬å™¨æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">                    Stat stat = zk.exists(path, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (stat != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">this</span>.latch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">this</span>.latch.await(waitTime, TimeUnit.MILLISECONDS);</span><br><span class="line">                        <span class="keyword">this</span>.latch = <span class="keyword">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    zookeeper.create(path, <span class="string">""</span>.getBytes(), Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception ee) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡Šæ”¾æ‰ä¸€ä¸ªåˆ†å¸ƒå¼é”</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> productId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">releaseDistributedLock</span><span class="params">(Long productId)</span> </span>&#123;</span><br><span class="line">        String path = <span class="string">"/product-lock-"</span> + productId;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            zookeeper.delete(path, -<span class="number">1</span>);</span><br><span class="line">            System.out.println(<span class="string">"release the lock for product[id="</span> + productId + <span class="string">"]......"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å»ºç«‹zk sessionçš„watcher</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> bingo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 2018/11/29</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ZooKeeperWatcher</span> <span class="keyword">implements</span> <span class="title">Watcher</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(WatchedEvent event)</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"Receive watched event: "</span> + event.getState());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (KeeperState.SyncConnected == event.getState()) &#123;</span><br><span class="line">                connectedSemaphore.countDown();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.latch != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.latch.countDown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°è£…å•ä¾‹çš„é™æ€å†…éƒ¨ç±»</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> bingo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 2018/11/29</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> ZooKeeperSession instance;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span> &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> ZooKeeperSession();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ZooKeeperSession <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å•ä¾‹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ZooKeeperSession <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Singleton.getInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ–å•ä¾‹çš„ä¾¿æ·æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        getInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥é‡‡ç”¨å¦ä¸€ç§æ–¹å¼ï¼Œåˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼š</p>
<p>å¦‚æœæœ‰ä¸€æŠŠé”ï¼Œè¢«å¤šä¸ªäººç»™ç«äº‰ï¼Œæ­¤æ—¶å¤šä¸ªäººä¼šæ’é˜Ÿï¼Œç¬¬ä¸€ä¸ªæ‹¿åˆ°é”çš„äººä¼šæ‰§è¡Œï¼Œç„¶åé‡Šæ”¾é”ï¼›åé¢çš„æ¯ä¸ªäººéƒ½ä¼šå»ç›‘å¬<strong>æ’åœ¨è‡ªå·±å‰é¢</strong>çš„é‚£ä¸ªäººåˆ›å»ºçš„ node ä¸Šï¼Œä¸€æ—¦æŸä¸ªäººé‡Šæ”¾äº†é”ï¼Œæ’åœ¨è‡ªå·±åé¢çš„äººå°±ä¼šè¢« zookeeper ç»™é€šçŸ¥ï¼Œä¸€æ—¦è¢«é€šçŸ¥äº†ä¹‹åï¼Œå°± ok äº†ï¼Œè‡ªå·±å°±è·å–åˆ°äº†é”ï¼Œå°±å¯ä»¥æ‰§è¡Œä»£ç äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZooKeeperDistributedLock</span> <span class="keyword">implements</span> <span class="title">Watcher</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ZooKeeper zk;</span><br><span class="line">    <span class="keyword">private</span> String locksRoot = <span class="string">"/locks"</span>;</span><br><span class="line">    <span class="keyword">private</span> String productId;</span><br><span class="line">    <span class="keyword">private</span> String waitNode;</span><br><span class="line">    <span class="keyword">private</span> String lockNode;</span><br><span class="line">    <span class="keyword">private</span> CountDownLatch latch;</span><br><span class="line">    <span class="keyword">private</span> CountDownLatch connectedLatch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> sessionTimeout = <span class="number">30000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ZooKeeperDistributedLock</span><span class="params">(String productId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productId = productId;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String address = <span class="string">"192.168.31.187:2181,192.168.31.19:2181,192.168.31.227:2181"</span>;</span><br><span class="line">            zk = <span class="keyword">new</span> ZooKeeper(address, sessionTimeout, <span class="keyword">this</span>);</span><br><span class="line">            connectedLatch.await();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(WatchedEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (event.getState() == KeeperState.SyncConnected) &#123;</span><br><span class="line">            connectedLatch.countDown();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.latch != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.latch.countDown();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">acquireDistributedLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.tryLock()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                waitForLock(waitNode, sessionTimeout);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"> 		    <span class="comment">// ä¼ å…¥è¿›å»çš„locksRoot + â€œ/â€ + productId</span></span><br><span class="line">		    <span class="comment">// å‡è®¾productIdä»£è¡¨äº†ä¸€ä¸ªå•†å“idï¼Œæ¯”å¦‚è¯´1</span></span><br><span class="line">		    <span class="comment">// locksRoot = locks</span></span><br><span class="line">		    <span class="comment">// /locks/10000000000ï¼Œ/locks/10000000001ï¼Œ/locks/10000000002</span></span><br><span class="line">            lockNode = zk.create(locksRoot + <span class="string">"/"</span> + productId, <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">0</span>], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// çœ‹çœ‹åˆšåˆ›å»ºçš„èŠ‚ç‚¹æ˜¯ä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹</span></span><br><span class="line">	 	    <span class="comment">// locksï¼š10000000000ï¼Œ10000000001ï¼Œ10000000002</span></span><br><span class="line">            List&lt;String&gt; locks = zk.getChildren(locksRoot, <span class="keyword">false</span>);</span><br><span class="line">            Collections.sort(locks);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(lockNode.equals(locksRoot+<span class="string">"/"</span>+ locks.get(<span class="number">0</span>)))&#123;</span><br><span class="line">                <span class="comment">//å¦‚æœæ˜¯æœ€å°çš„èŠ‚ç‚¹,åˆ™è¡¨ç¤ºå–å¾—é”</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼Œæ‰¾åˆ°æ¯”è‡ªå·±å°1çš„èŠ‚ç‚¹</span></span><br><span class="line">	  <span class="keyword">int</span> previousLockIndex = -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; locks.size(); i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(lockNode.equals(locksRoot + â€œ/â€ + locks.get(i))) &#123;</span><br><span class="line">	         	    previousLockIndex = i - <span class="number">1</span>;</span><br><span class="line">		    <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	   &#125;</span><br><span class="line"></span><br><span class="line">	   <span class="keyword">this</span>.waitNode = locks.get(previousLockIndex);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">waitForLock</span><span class="params">(String waitNode, <span class="keyword">long</span> waitTime)</span> <span class="keyword">throws</span> InterruptedException, KeeperException </span>&#123;</span><br><span class="line">        Stat stat = zk.exists(locksRoot + <span class="string">"/"</span> + waitNode, <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">if</span> (stat != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.latch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">this</span>.latch.await(waitTime, TimeUnit.MILLISECONDS);</span><br><span class="line">            <span class="keyword">this</span>.latch = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unlock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ é™¤/locks/10000000000èŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment">// åˆ é™¤/locks/10000000001èŠ‚ç‚¹</span></span><br><span class="line">            System.out.println(<span class="string">"unlock "</span> + lockNode);</span><br><span class="line">            zk.delete(lockNode, -<span class="number">1</span>);</span><br><span class="line">            lockNode = <span class="keyword">null</span>;</span><br><span class="line">            zk.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LockException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LockException</span><span class="params">(String e)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LockException</span><span class="params">(Exception e)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="43-å°ç»“"><a class="markdownIt-Anchor" href="#43-å°ç»“"></a> 4.3. å°ç»“</h3>
<p>ZooKeeper ç‰ˆæœ¬çš„åˆ†å¸ƒå¼é”é—®é¢˜ç›¸å¯¹æ¯”è¾ƒæ¥è¯´å°‘ã€‚</p>
<ul>
<li>é”çš„å ç”¨æ—¶é—´é™åˆ¶ï¼šredis å°±æœ‰å ç”¨æ—¶é—´é™åˆ¶ï¼Œè€Œ ZooKeeper åˆ™æ²¡æœ‰ï¼Œæœ€ä¸»è¦çš„åŸå› æ˜¯ redis ç›®å‰æ²¡æœ‰åŠæ³•çŸ¥é“å·²ç»è·å–é”çš„å®¢æˆ·ç«¯çš„çŠ¶æ€ï¼Œæ˜¯å·²ç»æŒ‚äº†å‘¢è¿˜æ˜¯æ­£åœ¨æ‰§è¡Œè€—æ—¶è¾ƒé•¿çš„ä¸šåŠ¡é€»è¾‘ã€‚è€Œ ZooKeeper é€šè¿‡ä¸´æ—¶èŠ‚ç‚¹å°±èƒ½æ¸…æ™°çŸ¥é“ï¼Œå¦‚æœä¸´æ—¶èŠ‚ç‚¹å­˜åœ¨è¯´æ˜è¿˜åœ¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æœä¸´æ—¶èŠ‚ç‚¹ä¸å­˜åœ¨è¯´æ˜å·²ç»æ‰§è¡Œå®Œæ¯•é‡Šæ”¾é”æˆ–è€…æ˜¯æŒ‚äº†ã€‚ç”±æ­¤çœ‹æ¥ redis å¦‚æœèƒ½åƒ ZooKeeper ä¸€æ ·æ·»åŠ ä¸€äº›ä¸å®¢æˆ·ç«¯ç»‘å®šçš„ä¸´æ—¶é”®ï¼Œä¹Ÿæ˜¯ä¸€å¤§å¥½äº‹ã€‚</li>
<li>æ˜¯å¦å•ç‚¹æ•…éšœï¼šredis æœ¬èº«æœ‰å¾ˆå¤šä¸­ç©æ³•ï¼Œå¦‚å®¢æˆ·ç«¯ä¸€è‡´æ€§ hashï¼ŒæœåŠ¡å™¨ç«¯ sentinel æ–¹æ¡ˆæˆ–è€… cluster æ–¹æ¡ˆï¼Œå¾ˆéš¾åšåˆ°ä¸€ç§åˆ†å¸ƒå¼é”æ–¹å¼èƒ½åº”å¯¹æ‰€æœ‰è¿™äº›æ–¹æ¡ˆã€‚è€Œ ZooKeeper åªæœ‰ä¸€ç§ç©æ³•ï¼Œå¤šå°æœºå™¨çš„èŠ‚ç‚¹æ•°æ®æ˜¯ä¸€è‡´çš„ï¼Œæ²¡æœ‰ redis çš„é‚£ä¹ˆå¤šçš„éº»çƒ¦å› ç´ è¦è€ƒè™‘ã€‚</li>
</ul>
<p>æ€»ä½“ä¸Šæ¥è¯´ ZooKeeper å®ç°åˆ†å¸ƒå¼é”æ›´åŠ çš„ç®€å•ï¼Œå¯é æ€§æ›´é«˜ã€‚ä½† ZooKeeper å› ä¸ºéœ€è¦é¢‘ç¹çš„åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹ï¼Œæ€§èƒ½ä¸Šä¸å¦‚ Redis æ–¹å¼ã€‚</p>
<h2 id="5-åˆ†å¸ƒå¼é”æ–¹æ¡ˆå¯¹æ¯”"><a class="markdownIt-Anchor" href="#5-åˆ†å¸ƒå¼é”æ–¹æ¡ˆå¯¹æ¯”"></a> 5. åˆ†å¸ƒå¼é”æ–¹æ¡ˆå¯¹æ¯”</h2>
<ul>
<li>
<p>æ•°æ®åº“åˆ†å¸ƒå¼é”ï¼Œé—®é¢˜æ¯”è¾ƒå¤šï¼Œè§£å†³èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œä¸æ¨è</p>
</li>
<li>
<p>redis åˆ†å¸ƒå¼é”ï¼Œå…¶å®<strong>éœ€è¦è‡ªå·±ä¸æ–­å»å°è¯•è·å–é”</strong>ï¼Œæ¯”è¾ƒæ¶ˆè€—æ€§èƒ½ã€‚</p>
</li>
<li>
<p>zk åˆ†å¸ƒå¼é”ï¼Œè·å–ä¸åˆ°é”ï¼Œæ³¨å†Œä¸ªç›‘å¬å™¨å³å¯ï¼Œä¸éœ€è¦ä¸æ–­ä¸»åŠ¨å°è¯•è·å–é”ï¼Œæ€§èƒ½å¼€é”€è¾ƒå°ã€‚</p>
</li>
</ul>
<p>å¦å¤–ä¸€ç‚¹å°±æ˜¯ï¼Œå¦‚æœæ˜¯ redis è·å–é”çš„é‚£ä¸ªå®¢æˆ·ç«¯å‡ºç° bug æŒ‚äº†ï¼Œé‚£ä¹ˆåªèƒ½ç­‰å¾…è¶…æ—¶æ—¶é—´ä¹‹åæ‰èƒ½é‡Šæ”¾é”ï¼›è€Œ zk çš„è¯ï¼Œå› ä¸ºåˆ›å»ºçš„æ˜¯ä¸´æ—¶ znodeï¼Œåªè¦å®¢æˆ·ç«¯æŒ‚äº†ï¼Œznode å°±æ²¡äº†ï¼Œæ­¤æ—¶å°±è‡ªåŠ¨é‡Šæ”¾é”ã€‚</p>
<p>æ€»ä½“ä¸Šæ¥è¯´ï¼ŒZooKeeper å®ç°åˆ†å¸ƒå¼é”æ›´åŠ çš„ç®€å•ï¼Œå¯é æ€§æ›´é«˜ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://juejin.im/post/5a20cd8bf265da43163cdd9a" target="_blank" rel="noopener">åˆ†å¸ƒå¼é”å®ç°æ±‡æ€»</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>åˆ†å¸ƒå¼é”</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œé€šä¿¡çŸ¥è¯†ç‚¹é¢ç»</title>
    <url>/blog/communication/network-interview/</url>
    <content><![CDATA[<h1 id="ç½‘ç»œé€šä¿¡çŸ¥è¯†ç‚¹é¢ç»"><a class="markdownIt-Anchor" href="#ç½‘ç»œé€šä¿¡çŸ¥è¯†ç‚¹é¢ç»"></a> ç½‘ç»œé€šä¿¡çŸ¥è¯†ç‚¹é¢ç»</h1>
<!-- TOC depthFrom:2 depthTo:4 -->
<ul>
<li><a href="#1-%E7%BB%BC%E5%90%88">1. ç»¼åˆ</a>
<ul>
<li><a href="#11-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A6%82%E4%BD%95%E5%88%86%E5%B1%82">1.1. è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿ</a></li>
</ul>
</li>
<li><a href="#2-http">2. HTTP</a></li>
<li><a href="#3-dns">3. DNS</a></li>
<li><a href="#4-tcpudp">4. TCP/UDP</a>
<ul>
<li><a href="#41-%E4%BB%80%E4%B9%88%E6%98%AF-tcp">4.1. ä»€ä¹ˆæ˜¯ TCPï¼Ÿ</a></li>
<li><a href="#42-tcp-%E7%9A%84%E7%89%B9%E6%80%A7%E6%98%AF%E4%BB%80%E4%B9%88">4.2. TCP çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="#43-tcp-%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B">4.3. TCP ä¸‰æ¬¡æ¡æ‰‹</a></li>
<li><a href="#44-tcp-%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B">4.4. TCP å››æ¬¡æŒ¥æ‰‹</a></li>
<li><a href="#45-tcp-%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3">4.5. TCP æ»‘åŠ¨çª—å£</a></li>
<li><a href="#46-tcp-%E9%87%8D%E4%BC%A0%E6%9C%BA%E5%88%B6">4.6. TCP é‡ä¼ æœºåˆ¶</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="1-ç»¼åˆ"><a class="markdownIt-Anchor" href="#1-ç»¼åˆ"></a> 1. ç»¼åˆ</h2>
<h3 id="11-è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚"><a class="markdownIt-Anchor" href="#11-è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚"></a> 1.1. è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿ</h3>
<blockquote>
<p>â“ é—®é¢˜ï¼šè®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿå„å±‚çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå„å±‚çš„ä¸»è¦åè®®ã€è®¾å¤‡åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>è¿™æ˜¯å­¦ä¹ è®¡ç®—æœºç½‘ç»œçŸ¥è¯†å®è§‚å±‚é¢å¿…é¡»è¦äº†è§£çš„æ ¸å¿ƒç‚¹ã€‚çŸ¥é“äº†è¿™äº›ï¼Œå¯¹äºç½‘ç»œçš„ä½“ç³»ç»“æ„å°±åŸºæœ¬ä¸Šäº†è§£äº†ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/overview/network-layers.png!zp"/></div>
<p>è®¡ç®—æœºç½‘ç»œåˆ†å±‚ä¸€èˆ¬æœ‰ä¸‰ç§åˆ’åˆ†ä½“ç³»ï¼šOSI åˆ†å±‚ï¼›äº”å±‚åè®®åˆ†å±‚ï¼›TCP/IP åè®®åˆ†å±‚ã€‚</p>
<ul>
<li>OSI çš„ä¸ƒå±‚ä½“ç³»ç»“æ„æ¦‚å¿µæ¸…æ¥šï¼Œç†è®ºå®Œæ•´ï¼Œä½†æ˜¯æ¯”è¾ƒå¤æ‚ä¸”ä¸å®ç”¨ï¼Œæ‰€ä»¥å¹¶ä¸æµè¡Œã€‚</li>
<li>äº”å±‚åè®®åˆ†å±‚æ˜¯ä¸€ç§æŠ˜ä¸­æ–¹æ¡ˆï¼Œåœ¨ç°å®ä¸­æ›´ä¸ºæµè¡Œã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/overview/ç½‘ç»œåˆ†å±‚æ¶æ„å›¾.png!zp"/></div>
<p><strong>ç‰©ç†å±‚</strong></p>
<blockquote>
<p>ç‰©ç†å±‚ï¼ˆPhysical Layerï¼‰åªæ¥æ”¶å’Œå‘é€ä¸€ä¸²æ¯”ç‰¹(bit)æµï¼Œä¸è€ƒè™‘ä¿¡æ¯çš„æ„ä¹‰å’Œä¿¡æ¯ç»“æ„ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-physical.md">è®¡ç®—æœºç½‘ç»œä¹‹ç‰©ç†å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼šè°ƒåˆ¶ã€è§£è°ƒã€æ•°å­—ä¿¡å·ã€æ¨¡æ‹Ÿä¿¡å·ã€é€šä¿¡åª’ä»‹ã€ä¿¡é“å¤ç”¨</li>
<li>æ•°æ®å•å…ƒï¼šæ¯”ç‰¹æµã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šå…‰çº¤ã€åŒè½´ç”µç¼†ã€åŒç»çº¿ã€ä¸­ç»§å™¨å’Œé›†çº¿å™¨ã€‚</li>
</ul>
<p><strong>æ•°æ®é“¾è·¯å±‚</strong></p>
<blockquote>
<p>ç½‘ç»œå±‚é’ˆå¯¹çš„è¿˜æ˜¯ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œè€Œä¸»æœºä¹‹é—´å¯ä»¥æœ‰å¾ˆå¤šé“¾è·¯ï¼Œæ•°æ®é“¾è·¯å±‚ï¼ˆData Link Layerï¼‰å°±æ˜¯ä¸ºåŒä¸€é“¾è·¯çš„ä¸»æœºæä¾›æ•°æ®ä¼ è¾“æœåŠ¡ã€‚æ•°æ®é“¾è·¯å±‚æŠŠç½‘ç»œå±‚ä¼ ä¸‹æ¥çš„åˆ†ç»„å°è£…æˆå¸§ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-data-link.md">è®¡ç®—æœºç½‘ç»œä¹‹æ•°æ®é“¾è·¯å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼šç‚¹å¯¹ç‚¹ä¿¡é“ã€å¹¿æ’­ä¿¡é“ã€<code>PPP</code>ã€<code>CSMA/CD</code>ã€å±€åŸŸç½‘ã€ä»¥å¤ªç½‘ã€<code>MAC</code>ã€é€‚é…å™¨ã€é›†çº¿å™¨ã€ç½‘æ¡¥ã€äº¤æ¢æœº</li>
<li>ä¸»è¦åè®®ï¼š<code>PPP</code>ã€<code>CSMA/CD</code> ç­‰ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šå¸§ï¼ˆframeï¼‰ã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šäºŒå±‚äº¤æ¢æœºã€ç½‘æ¡¥ã€ç½‘å¡ã€‚</li>
</ul>
<p><strong>ç½‘ç»œå±‚</strong></p>
<blockquote>
<p>ç½‘ç»œå±‚ï¼ˆnetwork layerï¼‰ä¸ºåˆ†ç»„äº¤æ¢ç½‘ä¸Šçš„ä¸åŒä¸»æœºæä¾›é€šä¿¡æœåŠ¡ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„æˆ–åŒ…è¿›è¡Œä¼ é€ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-network.md">è®¡ç®—æœºç½‘ç»œä¹‹ç½‘ç»œå±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>IP</code>ã€<code>ICMP</code>ã€<code>ARP</code>ã€è·¯ç”±</li>
<li>ä¸»è¦åè®®ï¼š<code>IP</code>ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šIP æ•°æ®æŠ¥ï¼ˆpacketï¼‰ã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šç½‘å…³ã€è·¯ç”±å™¨ã€‚</li>
</ul>
<p><strong>ä¼ è¾“å±‚</strong></p>
<blockquote>
<p>ä¼ è¾“å±‚ï¼ˆtransport layerï¼‰ä¸ºä¸¤å°ä¸»æœºä¸­è¿›ç¨‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-network.md">è®¡ç®—æœºç½‘ç»œä¹‹ç½‘ç»œå±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>UDP</code>ã€<code>TCP</code>ã€æ»‘åŠ¨çª—å£ã€æ‹¥å¡æ§åˆ¶ã€ä¸‰æ¬¡æ¡æ‰‹</li>
<li>ä¸»è¦åè®®ï¼š<code>TCP</code>ã€<code>UDP</code>ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šæŠ¥æ–‡æ®µï¼ˆsegmentï¼‰æˆ–ç”¨æˆ·æ•°æ®æŠ¥ã€‚</li>
</ul>
<p><sub>~**ä¼šè¯å±‚**~</sub></p>
<blockquote>
<p>~~ä¼šè¯å±‚ï¼ˆSession Layerï¼‰ä¸å‚ä¸å…·ä½“çš„ä¼ è¾“ï¼Œå®ƒæä¾›åŒ…æ‹¬è®¿é—®éªŒè¯å’Œä¼šè¯ç®¡ç†åœ¨å†…çš„å»ºç«‹å’Œç»´æŠ¤åº”ç”¨ä¹‹é—´é€šä¿¡çš„æœºåˆ¶ã€‚~~</p>
</blockquote>
<p><sub>~**è¡¨ç¤ºå±‚**~</sub></p>
<blockquote>
<p>~~è¡¨ç¤ºå±‚ï¼ˆPresentation Layerï¼‰æ˜¯ä¸ºåœ¨åº”ç”¨è¿‡ç¨‹ä¹‹é—´ä¼ é€çš„ä¿¡æ¯æä¾›è¡¨ç¤ºæ–¹æ³•çš„æœåŠ¡ï¼Œå®ƒå…³å¿ƒçš„åªæ˜¯å‘å‡ºä¿¡æ¯çš„è¯­æ³•ä¸è¯­ä¹‰ã€‚è¡¨ç¤ºå±‚è¦å®ŒæˆæŸäº›ç‰¹å®šçš„åŠŸèƒ½ï¼Œä¸»è¦æœ‰ä¸åŒæ•°æ®ç¼–ç æ ¼å¼çš„è½¬æ¢ï¼Œæä¾›æ•°æ®å‹ç¼©ã€è§£å‹ç¼©æœåŠ¡ï¼Œå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ã€è§£å¯†ã€‚~~</p>
</blockquote>
<p><strong>åº”ç”¨å±‚</strong></p>
<blockquote>
<p>åº”ç”¨å±‚ï¼ˆapplication layerï¼‰é€šè¿‡åº”ç”¨è¿›ç¨‹é—´çš„äº¤äº’æ¥å®Œæˆç‰¹å®šç½‘ç»œåº”ç”¨ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹é—´é€šä¿¡å’Œäº¤äº’çš„è§„åˆ™ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-application.md">è®¡ç®—æœºç½‘ç»œä¹‹åº”ç”¨å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>HTTP</code>ã€<code>DNS</code>ã€<code>FTP</code>ã€<code>TELNET</code>ã€<code>DHCP</code></li>
<li>ä¸»è¦åè®®ï¼š<code>HTTP</code>ã€<code>DNS</code>ã€<code>SMTP</code>ã€<code>Telnet</code>ã€<code>FTP</code>ã€<code>SNMP</code> ç­‰ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šæŠ¥æ–‡ï¼ˆmessageï¼‰ã€‚</li>
</ul>
<h2 id="2-http"><a class="markdownIt-Anchor" href="#2-http"></a> 2. HTTP</h2>
<blockquote>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="http.md">è¶…æ–‡æœ¬ä¼ è¾“åè®® HTTP</a></p>
</blockquote>
<h2 id="3-dns"><a class="markdownIt-Anchor" href="#3-dns"></a> 3. DNS</h2>
<blockquote>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="dns.md">åŸŸåç³»ç»Ÿ DNS</a></p>
</blockquote>
<h2 id="4-tcpudp"><a class="markdownIt-Anchor" href="#4-tcpudp"></a> 4. TCP/UDP</h2>
<blockquote>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="tcp.md">ä¼ è¾“æ§åˆ¶åè®® TCP</a>ï¼Œ<a href="udp.md">ç”¨æˆ·æ•°æ®æŠ¥åè®® UDP</a></p>
</blockquote>
<h3 id="41-ä»€ä¹ˆæ˜¯-tcp"><a class="markdownIt-Anchor" href="#41-ä»€ä¹ˆæ˜¯-tcp"></a> 4.1. ä»€ä¹ˆæ˜¯ TCPï¼Ÿ</h3>
<p><strong>TCPï¼ˆTransmission Control Protocolï¼‰ï¼Œå³ä¼ è¾“æ§åˆ¶åè®®ï¼Œå®ƒæ˜¯ä¸€ç§<code>é¢å‘è¿æ¥çš„</code>ã€<code>å¯é çš„</code>ã€<code>åŸºäºå­—èŠ‚æµçš„</code>ä¼ è¾“å±‚é€šä¿¡åè®®</strong>ã€‚</p>
<h3 id="42-tcp-çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#42-tcp-çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆ"></a> 4.2. TCP çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ul>
<li><code>é¢å‘è¿æ¥çš„</code> - é¢å‘è¿æ¥æ˜¯æŒ‡ TCP éœ€è¦é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹åŸåˆ™å»ºç«‹å’Œæ–­å¼€åŒå‘è¿æ¥ã€‚</li>
<li><code>å¯é çš„</code> - å¯é æ˜¯æŒ‡ TCP ä¼ è¾“çš„æ•°æ®åŒ…ä¿è¯ä»¥åŸå§‹é¡ºåºåˆ°è¾¾ç›®çš„åœ°ï¼Œä¸”æ•°æ®åŒ…ä¸è¢«æŸåã€‚ä¸ºäº†å®ç°è¿™ç‚¹ï¼ŒTCP é€šè¿‡ä»¥ä¸‹æŠ€æœ¯æ¥ä¿è¯ï¼š
<ul>
<li>æ•°æ®åŒ…çš„åºåˆ—å·å’Œæ ¡éªŒç </li>
<li>ç¡®è®¤åŒ…å’Œè‡ªåŠ¨é‡ä¼ 
<ul>
<li>å¦‚æœå‘é€è€…æ²¡æœ‰æ”¶åˆ°æ­£ç¡®çš„å“åº”ï¼Œå®ƒå°†é‡æ–°å‘é€æ•°æ®åŒ…ã€‚å¦‚æœå¤šæ¬¡è¶…æ—¶ï¼Œè¿æ¥å°±ä¼šæ–­å¼€ã€‚</li>
<li>TCP å®è¡Œæµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶ã€‚è¿™äº›ç¡®ä¿æªæ–½ä¼šå¯¼è‡´å»¶è¿Ÿï¼Œè€Œä¸”é€šå¸¸å¯¼è‡´ä¼ è¾“æ•ˆç‡æ¯” UDP ä½ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><code>åŸºäºå­—èŠ‚æµçš„</code>
<ul>
<li>è™½ç„¶åº”ç”¨ç¨‹åºå’Œ TCP çš„äº¤äº’æ˜¯ä¸€æ¬¡ä¸€ä¸ªæ•°æ®å—ï¼ˆå¤§å°ä¸ç­‰ï¼‰ï¼Œä½† TCP æŠŠåº”ç”¨ç¨‹åºçœ‹æˆæ˜¯ä¸€è¿ä¸²çš„æ— ç»“æ„çš„å­—èŠ‚æµã€‚TCP æœ‰ä¸€ä¸ªç¼“å†²ï¼Œå½“åº”ç”¨ç¨‹åºä¼ é€çš„æ•°æ®å—å¤ªé•¿ï¼ŒTCP å°±å¯ä»¥æŠŠå®ƒåˆ’åˆ†çŸ­ä¸€äº›å†ä¼ é€ã€‚å¦‚æœåº”ç”¨ç¨‹åºä¸€æ¬¡åªå‘é€ä¸€ä¸ªå­—èŠ‚ï¼ŒTCP ä¹Ÿå¯ä»¥ç­‰å¾…ç§¯ç´¯æœ‰è¶³å¤Ÿå¤šçš„å­—èŠ‚åå†æ„æˆæŠ¥æ–‡æ®µå‘é€å‡ºå»ã€‚</li>
<li>åœ¨ TCP å»ºç«‹è¿æ¥å‰ä¸¤æ¬¡æ¡æ‰‹çš„ SYN æŠ¥æ–‡ä¸­é€‰é¡¹å­—æ®µçš„ MSS å€¼ï¼Œé€šä¿¡åŒæ–¹å•†å®šé€šä¿¡çš„æœ€å¤§æŠ¥æ–‡é•¿åº¦ã€‚å¦‚æœåº”ç”¨å±‚äº¤ä»˜ä¸‹æ¥çš„æ•°æ®è¿‡å¤§ï¼Œå°±ä¼šå¯¹æ•°æ®åˆ†æ®µï¼Œç„¶åå‘é€ï¼›å¦åˆ™é€šè¿‡æ»‘åŠ¨çª—å£æ¥æ§åˆ¶é€šä¿¡åŒå‘çš„æ•°æ®ã€‚</li>
</ul>
</li>
</ul>
<h3 id="43-tcp-ä¸‰æ¬¡æ¡æ‰‹"><a class="markdownIt-Anchor" href="#43-tcp-ä¸‰æ¬¡æ¡æ‰‹"></a> 4.3. TCP ä¸‰æ¬¡æ¡æ‰‹</h3>
<blockquote>
<p>â“ é—®é¢˜ï¼šä¸‰æ¬¡æ¡æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</p>
</blockquote>
<p>ï¼ˆ1ï¼‰ä¸‰æ¬¡æ¡æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>
<ul>
<li>ä¸‰æ¬¡æ¡æ‰‹è´Ÿè´£å»ºç«‹ TCP åŒå‘è¿æ¥ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰ä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/ä¸‰æ¬¡æ¡æ‰‹.gif!zp"/></div>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸‰æ¬¡æ¡æ‰‹æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¸¦æœ‰ SYN æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
<li>ç¬¬äºŒæ¬¡æ¡æ‰‹ - æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€å¸¦æœ‰ SYN/ACK æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¸¦æœ‰å¸¦æœ‰ ACK æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
</ol>
<p>è‡³æ­¤ï¼ŒTCP ä¸‰æ¬¡æ¡æ‰‹å®Œæˆï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å·²å»ºç«‹åŒå‘è¿æ¥ã€‚</p>
<blockquote>
<p>ğŸ’¡ è¯´æ˜ï¼šSYN ä¸º synchronize çš„ç¼©å†™ï¼ŒACK ä¸º acknowledgment çš„ç¼©å†™ã€‚</p>
</blockquote>
<p>ï¼ˆ3ï¼‰ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</p>
<p>ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œå‡è®¾å®¢æˆ·ç«¯ä¸º A, æœåŠ¡ç«¯ä¸º Bã€‚</p>
<ol>
<li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼ŒA å‘ B å‘åŒæ­¥æ¶ˆæ¯ã€‚B æ”¶åˆ°æ¶ˆæ¯åï¼ŒB è®¤ä¸ºï¼šA å‘æ¶ˆæ¯æ²¡é—®é¢˜ï¼›B æ”¶æ¶ˆæ¯æ²¡é—®é¢˜ã€‚</li>
<li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼ŒB å‘ A å‘åŒæ­¥æ¶ˆæ¯å’Œç¡®è®¤æ¶ˆæ¯ã€‚A æ”¶åˆ°æ¶ˆæ¯åï¼ŒA è®¤ä¸ºï¼šA å‘æ¶ˆæ¯ã€æ”¶æ¶ˆæ¯éƒ½æ²¡é—®é¢˜ï¼›B å‘æ¶ˆæ¯ã€æ”¶æ¶ˆæ¯éƒ½æ²¡é—®é¢˜ã€‚<strong>ä½†æ˜¯ï¼Œæ­¤æ—¶ B ä¸ç¡®å®šè‡ªå·±å‘æ¶ˆæ¯æ˜¯å¦æ²¡é—®é¢˜</strong>ï¼Œæ‰€ä»¥å°±éœ€è¦ç¬¬ä¸‰æ¬¡æ¡æ‰‹ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼ŒA å‘ B å‘ç¡®è®¤æ¶ˆæ¯ã€‚B æ”¶åˆ°æ¶ˆæ¯åã€‚B è®¤ä¸ºï¼šB å‘æ¶ˆæ¯æ²¡é—®é¢˜ã€‚</li>
</ol>
<h3 id="44-tcp-å››æ¬¡æŒ¥æ‰‹"><a class="markdownIt-Anchor" href="#44-tcp-å››æ¬¡æŒ¥æ‰‹"></a> 4.4. TCP å››æ¬¡æŒ¥æ‰‹</h3>
<blockquote>
<p>â“ é—®é¢˜ï¼šå››æ¬¡æŒ¥æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿä»€ä¹ˆæ˜¯å››æ¬¡æŒ¥æ‰‹ï¼Ÿä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­è¿æ¥ç¡®æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ</p>
</blockquote>
<p>ï¼ˆ1ï¼‰å››æ¬¡æŒ¥æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>
<ul>
<li>å››æ¬¡æŒ¥æ‰‹è´Ÿè´£æ–­å¼€ TCP è¿æ¥ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰ä»€ä¹ˆæ˜¯å››æ¬¡æŒ¥æ‰‹ï¼Ÿ</p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå››æ¬¡æŒ¥æ‰‹æµç¨‹å¦‚ä¸‹ï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/å››æ¬¡æŒ¥æ‰‹.gif!zp"/></div>
<ol>
<li>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ª FIN åŒ…ï¼Œç”¨æ¥å…³é—­å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„æ•°æ®ä¼ é€ã€‚</li>
<li>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ - æœåŠ¡ç«¯æ”¶åˆ°è¿™ä¸ª FIN åŒ…ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª ACK åŒ…ï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°çš„åºå·åŠ  1ã€‚å’Œ SYN ä¸€æ ·ï¼Œä¸€ä¸ª FIN å°†å ç”¨ä¸€ä¸ªåºå·ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ - æœåŠ¡ç«¯å…³é—­ä¸å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN åŒ…ã€‚</li>
<li>ç¬¬å››æ¬¡æŒ¥æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ ACK åŒ…ï¼Œå¹¶å°†ç¡®è®¤åºå·è®¾ç½®ä¸ºæ”¶åˆ°åºå·åŠ  1ã€‚</li>
</ol>
<p>ï¼ˆ3ï¼‰ä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­è¿æ¥ç¡®æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ</p>
<ul>
<li>å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œ æœåŠ¡å™¨åœ¨ LISTEN çŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿æ¥è¯·æ±‚çš„ SYN æŠ¥æ–‡åï¼ŒæŠŠ ACK å’Œ SYN æ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>è€Œå…³é—­è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°å¯¹æ–¹çš„ FIN æŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå¯¹æ–¹ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ï¼Œè€Œè‡ªå·±ä¹Ÿæœªå¿…å…¨éƒ¨æ•°æ®éƒ½å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥å·±æ–¹å¯ä»¥ç«‹å³å…³é—­ï¼Œä¹Ÿå¯ä»¥å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹åï¼Œå†å‘é€ FIN æŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ï¼Œå› æ­¤ï¼Œå·±æ–¹ ACK å’Œ FIN ä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ï¼Œä»è€Œå¯¼è‡´å¤šäº†ä¸€æ¬¡ã€‚</li>
</ul>
<h3 id="45-tcp-æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#45-tcp-æ»‘åŠ¨çª—å£"></a> 4.5. TCP æ»‘åŠ¨çª—å£</h3>
<blockquote>
<p>â“ é—®é¢˜ï¼šä»€ä¹ˆæ˜¯æ»‘åŠ¨çª—å£ï¼Ÿæ»‘åŠ¨çª—å£åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>ä»€ä¹ˆæ˜¯æ»‘åŠ¨çª—å£ï¼Ÿ</p>
<p><strong>æ»‘åŠ¨çª—å£æ˜¯ TCP çš„ä¸€ç§æ§åˆ¶ç½‘ç»œæµé‡çš„æŠ€æœ¯ã€‚</strong></p>
<p><strong>TCP å¿…éœ€è¦è§£å†³çš„å¯é ä¼ è¾“ä»¥åŠåŒ…ä¹±åºï¼ˆreorderingï¼‰çš„é—®é¢˜</strong>ï¼Œæ‰€ä»¥ï¼ŒTCP å¿…éœ€è¦çŸ¥é“ç½‘ç»œå®é™…çš„æ•°æ®å¤„ç†å¸¦å®½æˆ–æ˜¯æ•°æ®å¤„ç†é€Ÿåº¦ï¼Œè¿™æ ·æ‰ä¸ä¼šå¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´ä¸¢åŒ…ã€‚</p>
<p>TCP å¤´é‡Œæœ‰ä¸€ä¸ªå­—æ®µå« Windowï¼Œåˆå« Advertised-Windowï¼Œè¿™ä¸ªå­—æ®µæ˜¯æ¥æ”¶ç«¯å‘Šè¯‰å‘é€ç«¯è‡ªå·±è¿˜æœ‰å¤šå°‘ç¼“å†²åŒºå¯ä»¥æ¥æ”¶æ•°æ®ã€‚<strong>äºæ˜¯å‘é€ç«¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥æ”¶ç«¯çš„å¤„ç†èƒ½åŠ›æ¥å‘é€æ•°æ®ï¼Œè€Œä¸ä¼šå¯¼è‡´æ¥æ”¶ç«¯å¤„ç†ä¸è¿‡æ¥</strong>ã€‚</p>
<p>æ»‘åŠ¨çª—å£åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559265819762.png!zp"/></div>
<ol>
<li>å·²å‘é€å·²ç¡®è®¤ - æ•°æ®æµä¸­æœ€æ—©çš„å­—èŠ‚å·²ç»å‘é€å¹¶å¾—åˆ°ç¡®è®¤ã€‚è¿™äº›æ•°æ®æ˜¯ç«™åœ¨å‘é€ç«¯çš„è§’åº¦æ¥çœ‹çš„ã€‚ä¸Šå›¾ä¸­çš„ 31 ä¸ªå­—èŠ‚å·²ç»å‘é€å¹¶ç¡®è®¤ã€‚</li>
<li>å·²å‘é€ä½†å°šæœªç¡®è®¤ - å·²å‘é€ä½†å°šæœªå¾—åˆ°ç¡®è®¤çš„å­—èŠ‚ã€‚å‘é€æ–¹åœ¨ç¡®è®¤ä¹‹å‰ï¼Œä¸è®¤ä¸ºè¿™äº›æ•°æ®å·²ç»è¢«å¤„ç†ã€‚ä¸Šå›¾ä¸­çš„ 32 ~ 45 å­—èŠ‚ä¸ºç¬¬ 2 ç±»ã€‚</li>
<li>æœªå‘é€è€Œæ¥æ”¶æ–¹å·² Ready - è®¾å¤‡å°šæœªå°†æ•°æ®å‘å‡º ï¼Œä½†æ¥æ”¶æ–¹æ ¹æ®æœ€è¿‘ä¸€æ¬¡å…³äºå‘é€æ–¹ä¸€æ¬¡è¦å‘é€å¤šå°‘å­—èŠ‚ç¡®è®¤è‡ªå·±æœ‰è¶³å¤Ÿç©ºé—´ã€‚å‘é€æ–¹ä¼šç«‹å³å°è¯•å‘é€ã€‚ä¸Šå›¾ä¸­çš„ 46 ~ 51 å­—èŠ‚ä¸ºç¬¬ 3 ç±»ã€‚</li>
<li>æœªå‘é€è€Œæ¥æ”¶æ–¹ Not Ready - ç”±äºæ¥æ”¶æ–¹ not readyï¼Œè¿˜ä¸å…è®¸å°†è¿™éƒ¨åˆ†æ•°æ®å‘å‡ºã€‚ä¸Šå›¾ä¸­çš„ 52 ä»¥åçš„å­—èŠ‚ä¸ºç¬¬ 4 ç±»ã€‚</li>
</ol>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559265927658.png!zp"/></div>
<p>è¿™å¼ å›¾ç‰‡ç›¸å¯¹äºä¸Šä¸€å¼ å›¾ç‰‡ï¼Œæ»‘åŠ¨çª—å£åç§»äº† 5 ä¸ªå­—èŠ‚ï¼Œæ„å‘³ç€æœ‰ 5 ä¸ªå·²å‘é€çš„å­—èŠ‚å¾—åˆ°äº†ç¡®è®¤ã€‚</p>
<h3 id="46-tcp-é‡ä¼ æœºåˆ¶"><a class="markdownIt-Anchor" href="#46-tcp-é‡ä¼ æœºåˆ¶"></a> 4.6. TCP é‡ä¼ æœºåˆ¶</h3>
<blockquote>
<p>â“ é—®é¢˜ï¼šä¸ºä»€ä¹ˆéœ€è¦é‡ä¼ æœºåˆ¶ï¼ŸTCP æœ‰å“ªäº›é‡ä¼ æœºåˆ¶ï¼ŒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>TCP è¦ä¿è¯æ‰€æœ‰çš„æ•°æ®åŒ…éƒ½å¯ä»¥åˆ°è¾¾ï¼Œæ‰€ä»¥ï¼Œå¿…éœ€è¦æœ‰é‡ä¼ æœºåˆ¶ã€‚</p>
<p>TCP é‡ä¼ æœºåˆ¶ä¸»è¦æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>è¶…æ—¶é‡ä¼ æœºåˆ¶</li>
<li>å¿«é€Ÿé‡ä¼ æœºåˆ¶</li>
</ul>
<p>ï¼ˆ1ï¼‰è¶…æ—¶é‡ä¼ æœºåˆ¶</p>
<p>è¶…æ—¶é‡ä¼ æœºåˆ¶æ˜¯æŒ‡ï¼šå‘é€æ•°æ®åŒ…åœ¨ä¸€å®šçš„æ—¶é—´å‘¨æœŸå†…æ²¡æœ‰æ”¶åˆ°ç›¸åº”çš„ ACKï¼Œç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼Œè¶…æ—¶ä¹‹åå°±è®¤ä¸ºè¿™ä¸ªæ•°æ®åŒ…ä¸¢å¤±ï¼Œå°±ä¼šé‡æ–°å‘é€ã€‚è¿™ä¸ªç­‰å¾…æ—¶é—´è¢«ç§°ä¸º RTO(Retransmission TimeOut)ï¼Œå³é‡ä¼ è¶…æ—¶æ—¶é—´ã€‚</p>
<p>æ²¡æœ‰ç¡®è®¤çš„æ•°æ®åŒ…ä¸ä¼šä»çª—å£ä¸­ç§»èµ°ï¼Œå®šæ—¶å™¨åœ¨é‡ä¼ æ—¶é—´åˆ°æœŸå†…ï¼Œæ¯ä¸ªç‰‡æ®µçš„ä½ç½®ä¸å˜ã€‚</p>
<p>è¿™ç§æœºåˆ¶çš„é‡ç‚¹æ˜¯ RTO çš„è®¾ç½®ï¼š</p>
<ul>
<li>RTO è®¾é•¿äº†ï¼Œé‡å‘å°±æ…¢ï¼Œä¸¢äº†è€åŠå¤©æ‰é‡å‘ï¼Œæ²¡æœ‰æ•ˆç‡ï¼Œæ€§èƒ½å·®ï¼›</li>
<li>RTO è®¾çŸ­äº†ï¼Œä¼šå¯¼è‡´å¯èƒ½å¹¶æ²¡æœ‰ä¸¢å°±é‡å‘ã€‚äºæ˜¯é‡å‘çš„å°±å¿«ï¼Œä¼šå¢åŠ ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´æ›´å¤šçš„è¶…æ—¶ï¼Œæ›´å¤šçš„è¶…æ—¶å¯¼è‡´æ›´å¤šçš„é‡å‘</li>
</ul>
<p>ï¼ˆ2ï¼‰å¿«é€Ÿé‡ä¼ æœºåˆ¶</p>
<p>å¿«é€Ÿé‡ä¼ æœºåˆ¶ï¼Œå®ç°äº†å¦å¤–çš„ä¸€ç§ä¸¢åŒ…è¯„å®šæ ‡å‡†ï¼Œå³å¦‚æœè¿ç»­æ”¶åˆ° 3 æ¬¡é‡å¤ ACKï¼Œå‘é€æ–¹å°±è®¤ä¸ºè¿™ä¸ª seq çš„åŒ…ä¸¢å¤±äº†ï¼Œç«‹åˆ»è¿›è¡Œé‡ä¼ ã€‚</p>
<p>å½“æ¥æ”¶æ–¹æ”¶åˆ°ä¹±åºç‰‡æ®µæ—¶ï¼Œéœ€è¦é‡å¤å‘é€ ACKã€‚</p>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
        <tag>application</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œåè®®ä¹‹ UDP</title>
    <url>/blog/communication/udp/</url>
    <content><![CDATA[<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559263939493.png!zp"/></div>
<p>UDP æ˜¯æ— è¿æ¥çš„ã€‚æ•°æ®æŠ¥ï¼ˆç±»ä¼¼äºæ•°æ®åŒ…ï¼‰åªåœ¨æ•°æ®æŠ¥çº§åˆ«æœ‰ä¿è¯ã€‚æ•°æ®æŠ¥å¯èƒ½ä¼šæ— åºçš„åˆ°è¾¾ç›®çš„åœ°ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šé—å¤±ã€‚UDP ä¸æ”¯æŒæ‹¥å¡æ§åˆ¶ã€‚è™½ç„¶ä¸å¦‚ TCP é‚£æ ·æœ‰ä¿è¯ï¼Œä½† UDP é€šå¸¸æ•ˆç‡æ›´é«˜ã€‚</p>
<p>UDP å¯ä»¥é€šè¿‡å¹¿æ’­å°†æ•°æ®æŠ¥å‘é€è‡³å­ç½‘å†…çš„æ‰€æœ‰è®¾å¤‡ã€‚è¿™å¯¹ <a href="https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol" target="_blank" rel="noopener">DHCP</a> å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå­ç½‘å†…çš„è®¾å¤‡è¿˜æ²¡æœ‰åˆ†é… IP åœ°å€ï¼Œè€Œ IP å¯¹äº TCP æ˜¯å¿…é¡»çš„ã€‚</p>
<p>UDP å¯é æ€§æ›´ä½ä½†é€‚åˆç”¨åœ¨ç½‘ç»œç”µè¯ã€è§†é¢‘èŠå¤©ï¼Œæµåª’ä½“å’Œå®æ—¶å¤šäººæ¸¸æˆä¸Šã€‚</p>
<p>ä»¥ä¸‹æƒ…å†µä½¿ç”¨ UDP ä»£æ›¿ TCPï¼š</p>
<ul>
<li>ä½ éœ€è¦ä½å»¶è¿Ÿ</li>
<li>ç›¸å¯¹äºæ•°æ®ä¸¢å¤±æ›´ç³Ÿçš„æ˜¯æ•°æ®å»¶è¿Ÿ</li>
<li>ä½ æƒ³å®ç°è‡ªå·±çš„é”™è¯¯æ ¡æ­£æ–¹æ³•</li>
</ul>
<h3 id="udp-ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#udp-ç‰¹ç‚¹"></a> UDP ç‰¹ç‚¹</h3>
<ol>
<li><strong>æ— è¿æ¥çš„</strong>ï¼Œå³å‘é€æ•°æ®ä¹‹å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œå› æ­¤å‡å°‘äº†å¼€é”€å’Œå‘é€æ•°æ®ä¹‹å‰çš„æ—¶å»¶ã€‚</li>
<li><strong>ä¸ä¿è¯å¯é äº¤ä»˜</strong>ï¼Œå› æ­¤ä¸»æœºä¸éœ€è¦ä¸ºæ­¤å¤æ‚çš„è¿æ¥çŠ¶æ€è¡¨</li>
<li><strong>é¢å‘æŠ¥æ–‡çš„</strong>ï¼Œæ„æ€æ˜¯ UDP å¯¹åº”ç”¨å±‚äº¤ä¸‹æ¥çš„æŠ¥æ–‡ï¼Œæ—¢ä¸åˆå¹¶ï¼Œä¹Ÿä¸æ‹†åˆ†ï¼Œè€Œæ˜¯ä¿ç•™è¿™äº›æŠ¥æ–‡çš„è¾¹ç•Œï¼Œåœ¨æ·»åŠ é¦–éƒ¨åå‘ä¸‹äº¤ç»™ IP å±‚ã€‚</li>
<li><strong>æ²¡æœ‰é˜»å¡æ§åˆ¶</strong>ï¼Œå› æ­¤ç½‘ç»œå‡ºç°çš„æ‹¥å¡ä¸ä¼šä½¿å‘é€æ–¹çš„å‘é€é€Ÿç‡é™ä½ã€‚</li>
<li><strong>æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡</strong>ï¼Œä¹Ÿå³æ˜¯æä¾›å¹¿æ’­å’Œå¤šæ’­çš„åŠŸèƒ½ã€‚</li>
<li><strong>é¦–éƒ¨å¼€é”€å°</strong>ï¼Œé¦–éƒ¨åªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œåˆ†ä¸ºå››éƒ¨åˆ†ã€‚</li>
</ol>
<h3 id="udp-åº”ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#udp-åº”ç”¨åœºæ™¯"></a> UDP åº”ç”¨åœºæ™¯</h3>
<ol>
<li>åå­—è½¬æ¢ï¼ˆDNSï¼‰</li>
<li>æ–‡ä»¶ä¼ é€ï¼ˆTFTPï¼‰</li>
<li>è·¯ç”±é€‰æ‹©åè®®ï¼ˆRIPï¼‰</li>
<li>IP åœ°å€é…ç½®ï¼ˆBOOTPï¼ŒDHTPï¼‰</li>
<li>ç½‘ç»œç®¡ç†ï¼ˆSNMPï¼‰</li>
<li>è¿œç¨‹æ–‡ä»¶æœåŠ¡ï¼ˆNFSï¼‰</li>
<li>IP ç”µè¯</li>
<li>æµå¼å¤šåª’ä½“é€šä¿¡</li>
</ol>
<h2 id="udp-æŠ¥æ–‡"><a class="markdownIt-Anchor" href="#udp-æŠ¥æ–‡"></a> UDP æŠ¥æ–‡</h2>
<p>UDP æ•°æ®æŠ¥åˆ†ä¸ºæ•°æ®å­—æ®µå’Œé¦–éƒ¨å­—æ®µã€‚<br />
é¦–éƒ¨å­—æ®µåªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œç”±å››ä¸ªå­—æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µçš„é•¿åº¦æ˜¯ 2 ä¸ªå­—èŠ‚ã€‚</p>
<p><strong>é¦–éƒ¨å„å­—æ®µæ„ä¹‰</strong>ï¼š</p>
<ol>
<li><strong>æºç«¯å£</strong>ï¼šæºç«¯å£å·ï¼Œåœ¨éœ€è¦å¯¹æ–¹å›ä¿¡æ—¶é€‰ç”¨ï¼Œä¸éœ€è¦æ—¶å¯å…¨ 0.</li>
<li><strong>ç›®çš„ç«¯å£</strong>ï¼šç›®çš„ç«¯å£å·ï¼Œåœ¨ç»ˆç‚¹äº¤ä»˜æŠ¥æ–‡æ—¶å¿…é¡»è¦ä½¿ç”¨åˆ°ã€‚</li>
<li><strong>é•¿åº¦</strong>ï¼šUDP ç”¨æˆ·æ•°æ®æŠ¥çš„é•¿åº¦ï¼Œåœ¨åªæœ‰é¦–éƒ¨çš„æƒ…å†µï¼Œå…¶æœ€å°å€¼æ˜¯ 8 ã€‚</li>
<li><strong>æ£€éªŒå’Œ</strong>ï¼šæ£€æµ‹ UDP ç”¨æˆ·æ•°æ®æŠ¥åœ¨ä¼ è¾“ä¸­æ˜¯å¦æœ‰é”™ï¼Œæœ‰é”™å°±ä¸¢å¼ƒã€‚</li>
</ol>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
        <tag>åè®®</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œåè®®ä¹‹ Websocket</title>
    <url>/blog/communication/websocket/</url>
    <content><![CDATA[<h1 id="socket-å’Œ-websocket"><a class="markdownIt-Anchor" href="#socket-å’Œ-websocket"></a> Socket å’Œ WebSocket</h1>
<h2 id="socket"><a class="markdownIt-Anchor" href="#socket"></a> Socket</h2>
<p>Socket ä½œä¸ºä¸€ç§æŠ½è±¡å±‚ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡å®ƒæ¥å‘é€å’Œæ¥æ”¶æ•°æ®ï¼Œä½¿ç”¨ Socket å¯ä»¥å°†åº”ç”¨ç¨‹åºä¸å¤„äºåŒä¸€ç½‘ç»œä¸­çš„å…¶ä»–åº”ç”¨ç¨‹åºè¿›è¡Œé€šä¿¡äº¤äº’ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒSocket æä¾›äº†åº”ç”¨ç¨‹åºå†…éƒ¨ä¸å¤–ç•Œé€šä¿¡çš„ç«¯å£ä»¥åŠä¸ºé€šä¿¡åŒæ–¹æä¾›äº†æ•°æ®ä¼ è¾“çš„é€šé“ã€‚</p>
<h3 id="socket-ç”¨æ³•"><a class="markdownIt-Anchor" href="#socket-ç”¨æ³•"></a> Socket ç”¨æ³•</h3>
<p>å¾ˆå¤šç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒ Socketã€‚è¿™é‡Œä»¥ Java çš„ Socket ç”¨æ³•ä¸ºä¾‹ã€‚</p>
<p>åœ¨ Java çš„ SDK ä¸­ï¼Œsocket çš„å…±æœ‰ä¸¤ä¸ªæ¥å£ï¼šç”¨äºç›‘å¬å®¢æˆ·è¿æ¥çš„ <code>ServerSocket</code> å’Œç”¨äºé€šä¿¡çš„ <code>Socket</code>ã€‚ä½¿ç”¨ socket çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>åˆ›å»º <code>ServerSocket</code> å¹¶ç›‘å¬å®¢æˆ·è¿æ¥</li>
<li>ä½¿ç”¨ <code>Socket</code> è¿æ¥æœåŠ¡ç«¯</li>
<li>é€šè¿‡ <code>Socket</code> è·å–è¾“å…¥è¾“å‡ºæµè¿›è¡Œé€šä¿¡</li>
</ul>
<h3 id="socket-é•¿è¿æ¥"><a class="markdownIt-Anchor" href="#socket-é•¿è¿æ¥"></a> Socket é•¿è¿æ¥</h3>
<p>Socket é•¿è¿æ¥ï¼ŒæŒ‡çš„æ˜¯åœ¨å®¢æˆ·å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¿æŒä¸€ä¸ª socket è¿æ¥é•¿æ—¶é—´ä¸æ–­å¼€ã€‚</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">socket.set<span class="constructor">KeepAlive(<span class="params">true</span>)</span>;</span><br></pre></td></tr></table></figure>
<h2 id="websocket"><a class="markdownIt-Anchor" href="#websocket"></a> WebSocket</h2>
<h3 id="websocket-ç®€ä»‹"><a class="markdownIt-Anchor" href="#websocket-ç®€ä»‹"></a> WebSocket ç®€ä»‹</h3>
<h4 id="websocket-æ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#websocket-æ˜¯ä»€ä¹ˆ"></a> WebSocket æ˜¯ä»€ä¹ˆ</h4>
<p><a href="http://websocket.org/" target="_blank" rel="noopener">WebSocket</a> æ˜¯ä¸€ç§ç½‘ç»œé€šä¿¡åè®®ã€‚<a href="https://tools.ietf.org/html/rfc6455" target="_blank" rel="noopener">RFC6455</a> å®šä¹‰äº†å®ƒçš„é€šä¿¡æ ‡å‡†ã€‚</p>
<p>WebSocket æ˜¯ HTML5 å¼€å§‹æä¾›çš„ä¸€ç§åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®®ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆéœ€è¦-websocket"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦-websocket"></a> ä¸ºä»€ä¹ˆéœ€è¦ WebSocket</h4>
<p>äº†è§£è®¡ç®—æœºç½‘ç»œåè®®çš„äººï¼Œåº”è¯¥éƒ½çŸ¥é“ï¼šHTTP åè®®æ˜¯ä¸€ç§æ— çŠ¶æ€çš„ã€æ— è¿æ¥çš„ã€å•å‘çš„åº”ç”¨å±‚åè®®ã€‚å®ƒé‡‡ç”¨äº†è¯·æ±‚/å“åº”æ¨¡å‹ã€‚é€šä¿¡è¯·æ±‚åªèƒ½ç”±å®¢æˆ·ç«¯å‘èµ·ï¼ŒæœåŠ¡ç«¯å¯¹è¯·æ±‚åšå‡ºåº”ç­”å¤„ç†ã€‚</p>
<p>è¿™ç§é€šä¿¡æ¨¡å‹æœ‰ä¸€ä¸ªå¼Šç«¯ï¼šHTTP åè®®æ— æ³•å®ç°æœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘èµ·æ¶ˆæ¯ã€‚</p>
<p>è¿™ç§å•å‘è¯·æ±‚çš„ç‰¹ç‚¹ï¼Œæ³¨å®šäº†å¦‚æœæœåŠ¡å™¨æœ‰è¿ç»­çš„çŠ¶æ€å˜åŒ–ï¼Œå®¢æˆ·ç«¯è¦è·çŸ¥å°±éå¸¸éº»çƒ¦ã€‚å¤§å¤šæ•° Web åº”ç”¨ç¨‹åºå°†é€šè¿‡é¢‘ç¹çš„å¼‚æ­¥ JavaScript å’Œ XMLï¼ˆAJAXï¼‰è¯·æ±‚å®ç°é•¿è½®è¯¢ã€‚è½®è¯¢çš„æ•ˆç‡ä½ï¼Œéå¸¸æµªè´¹èµ„æºï¼ˆå› ä¸ºå¿…é¡»ä¸åœè¿æ¥ï¼Œæˆ–è€… HTTP è¿æ¥å§‹ç»ˆæ‰“å¼€ï¼‰ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/spring/web/ajax-long-polling.png!zp"/></div>
å› æ­¤ï¼Œå·¥ç¨‹å¸ˆä»¬ä¸€ç›´åœ¨æ€è€ƒï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚WebSocket å°±æ˜¯è¿™æ ·å‘æ˜çš„ã€‚WebSocket è¿æ¥å…è®¸å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œå…¨åŒå·¥é€šä¿¡ï¼Œä»¥ä¾¿ä»»ä¸€æ–¹éƒ½å¯ä»¥é€šè¿‡å»ºç«‹çš„è¿æ¥å°†æ•°æ®æ¨é€åˆ°å¦ä¸€ç«¯ã€‚WebSocket åªéœ€è¦å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œå°±å¯ä»¥ä¸€ç›´ä¿æŒè¿æ¥çŠ¶æ€ã€‚è¿™ç›¸æ¯”äºè½®è¯¢æ–¹å¼çš„ä¸åœå»ºç«‹è¿æ¥æ˜¾ç„¶æ•ˆç‡è¦å¤§å¤§æé«˜ã€‚
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/spring/web/websockets-flow.png!zp"/></div>
#### WebSocket å¦‚ä½•å·¥ä½œ
<p>Web æµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½å¿…é¡»å®ç° WebSockets åè®®æ¥å»ºç«‹å’Œç»´æŠ¤è¿æ¥ã€‚ç”±äº WebSockets è¿æ¥é•¿æœŸå­˜åœ¨ï¼Œä¸å…¸å‹çš„ HTTP è¿æ¥ä¸åŒï¼Œå¯¹æœåŠ¡å™¨æœ‰é‡è¦çš„å½±å“ã€‚</p>
<p>åŸºäºå¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹çš„æœåŠ¡å™¨æ— æ³•é€‚ç”¨äº WebSocketsï¼Œå› ä¸ºå®ƒæ—¨åœ¨æ‰“å¼€è¿æ¥ï¼Œå°½å¯èƒ½å¿«åœ°å¤„ç†è¯·æ±‚ï¼Œç„¶åå…³é—­è¿æ¥ã€‚ä»»ä½•å®é™…çš„ WebSockets æœåŠ¡å™¨ç«¯å®ç°éƒ½éœ€è¦ä¸€ä¸ªå¼‚æ­¥æœåŠ¡å™¨ã€‚</p>
<h3 id="websocket-ä½¿ç”¨"><a class="markdownIt-Anchor" href="#websocket-ä½¿ç”¨"></a> WebSocket ä½¿ç”¨</h3>
<h4 id="websocket-å®¢æˆ·ç«¯"><a class="markdownIt-Anchor" href="#websocket-å®¢æˆ·ç«¯"></a> WebSocket å®¢æˆ·ç«¯</h4>
<p>åœ¨å®¢æˆ·ç«¯ï¼Œæ²¡æœ‰å¿…è¦ä¸º WebSockets ä½¿ç”¨ JavaScript åº“ã€‚å®ç° WebSockets çš„ Web æµè§ˆå™¨å°†é€šè¿‡ WebSockets å¯¹è±¡å…¬å¼€æ‰€æœ‰å¿…éœ€çš„å®¢æˆ·ç«¯åŠŸèƒ½ï¼ˆä¸»è¦æŒ‡æ”¯æŒ Html5 çš„æµè§ˆå™¨ï¼‰ã€‚</p>
<p>ä»¥ä¸‹ API ç”¨äºåˆ›å»º WebSocket å¯¹è±¡ã€‚</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">var Socket = <span class="keyword">new</span> <span class="constructor">WebSocket(<span class="params">url</span>, [<span class="params">protocol</span>] )</span>;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•° url, æŒ‡å®šè¿æ¥çš„ URLã€‚ç¬¬äºŒä¸ªå‚æ•° protocol æ˜¯å¯é€‰çš„ï¼ŒæŒ‡å®šäº†å¯æ¥å—çš„å­åè®®ã€‚</p>
<h5 id="websocket-å±æ€§"><a class="markdownIt-Anchor" href="#websocket-å±æ€§"></a> WebSocket å±æ€§</h5>
<p>ä»¥ä¸‹æ˜¯ WebSocket å¯¹è±¡çš„å±æ€§ã€‚å‡å®šæˆ‘ä»¬ä½¿ç”¨äº†ä»¥ä¸Šä»£ç åˆ›å»ºäº† Socket å¯¹è±¡ï¼š</p>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>Socket.readyState</td>
<td>åªè¯»å±æ€§ <strong>readyState</strong> è¡¨ç¤ºè¿æ¥çŠ¶æ€ï¼Œå¯ä»¥æ˜¯ä»¥ä¸‹å€¼ï¼š0 - è¡¨ç¤ºè¿æ¥å°šæœªå»ºç«‹ã€‚1 - è¡¨ç¤ºè¿æ¥å·²å»ºç«‹ï¼Œå¯ä»¥è¿›è¡Œé€šä¿¡ã€‚2 - è¡¨ç¤ºè¿æ¥æ­£åœ¨è¿›è¡Œå…³é—­ã€‚3 - è¡¨ç¤ºè¿æ¥å·²ç»å…³é—­æˆ–è€…è¿æ¥ä¸èƒ½æ‰“å¼€ã€‚</td>
</tr>
<tr>
<td>Socket.bufferedAmount</td>
<td>åªè¯»å±æ€§ <strong>bufferedAmount</strong> å·²è¢« send() æ”¾å…¥æ­£åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ä¼ è¾“ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å‘å‡ºçš„ UTF-8 æ–‡æœ¬å­—èŠ‚æ•°ã€‚</td>
</tr>
</tbody>
</table>
<h5 id="websocket-äº‹ä»¶"><a class="markdownIt-Anchor" href="#websocket-äº‹ä»¶"></a> WebSocket äº‹ä»¶</h5>
<p>ä»¥ä¸‹æ˜¯ WebSocket å¯¹è±¡çš„ç›¸å…³äº‹ä»¶ã€‚å‡å®šæˆ‘ä»¬ä½¿ç”¨äº†ä»¥ä¸Šä»£ç åˆ›å»ºäº† Socket å¯¹è±¡ï¼š</p>
<table>
<thead>
<tr>
<th>äº‹ä»¶</th>
<th>äº‹ä»¶å¤„ç†ç¨‹åº</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>open</td>
<td>Socket.onopen</td>
<td>è¿æ¥å»ºç«‹æ—¶è§¦å‘</td>
</tr>
<tr>
<td>message</td>
<td>Socket.onmessage</td>
<td>å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡ç«¯æ•°æ®æ—¶è§¦å‘</td>
</tr>
<tr>
<td>error</td>
<td>Socket.onerror</td>
<td>é€šä¿¡å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘</td>
</tr>
<tr>
<td>close</td>
<td>Socket.onclose</td>
<td>è¿æ¥å…³é—­æ—¶è§¦å‘</td>
</tr>
</tbody>
</table>
<h5 id="websocket-æ–¹æ³•"><a class="markdownIt-Anchor" href="#websocket-æ–¹æ³•"></a> WebSocket æ–¹æ³•</h5>
<p>ä»¥ä¸‹æ˜¯ WebSocket å¯¹è±¡çš„ç›¸å…³æ–¹æ³•ã€‚å‡å®šæˆ‘ä»¬ä½¿ç”¨äº†ä»¥ä¸Šä»£ç åˆ›å»ºäº† Socket å¯¹è±¡ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>Socket.send()</td>
<td>ä½¿ç”¨è¿æ¥å‘é€æ•°æ®</td>
</tr>
<tr>
<td>Socket.close()</td>
<td>å…³é—­è¿æ¥</td>
</tr>
</tbody>
</table>
<p>WebSocket å®¢æˆ·ç«¯ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–ä¸€ä¸ª WebSocket å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">'ws://localhost:9998/echo'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»ºç«‹ web socket è¿æ¥æˆåŠŸè§¦å‘äº‹ä»¶</span></span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// ä½¿ç”¨ send() æ–¹æ³•å‘é€æ•°æ®</span></span><br><span class="line">	ws.send(<span class="string">'å‘é€æ•°æ®'</span>)</span><br><span class="line">	alert(<span class="string">'æ•°æ®å‘é€ä¸­...'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥æ”¶æœåŠ¡ç«¯æ•°æ®æ—¶è§¦å‘äº‹ä»¶</span></span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> received_msg = evt.data</span><br><span class="line">	alert(<span class="string">'æ•°æ®å·²æ¥æ”¶...'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–­å¼€ web socket è¿æ¥æˆåŠŸè§¦å‘äº‹ä»¶</span></span><br><span class="line">ws.onclose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	alert(<span class="string">'è¿æ¥å·²å…³é—­...'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="websocket-æœåŠ¡ç«¯"><a class="markdownIt-Anchor" href="#websocket-æœåŠ¡ç«¯"></a> WebSocket æœåŠ¡ç«¯</h4>
<p>WebSocket åœ¨æœåŠ¡ç«¯çš„å®ç°éå¸¸ä¸°å¯Œã€‚Node.jsã€Javaã€C++ã€Python ç­‰å¤šç§è¯­è¨€éƒ½æœ‰è‡ªå·±çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ä»¥ä¸‹ï¼Œä»‹ç»æˆ‘åœ¨å­¦ä¹  WebSocket è¿‡ç¨‹ä¸­æ¥è§¦è¿‡çš„ WebSocket æœåŠ¡ç«¯è§£å†³æ–¹æ¡ˆã€‚</p>
<h5 id="nodejs"><a class="markdownIt-Anchor" href="#nodejs"></a> Node.js</h5>
<p>å¸¸ç”¨çš„ Node å®ç°æœ‰ä»¥ä¸‹ä¸‰ç§ã€‚</p>
<ul>
<li><a href="https://github.com/uWebSockets/uWebSockets" target="_blank" rel="noopener">ÂµWebSockets</a></li>
<li><a href="http://socket.io/" target="_blank" rel="noopener">Socket.IO</a></li>
<li><a href="https://github.com/theturtle32/WebSocket-Node" target="_blank" rel="noopener">WebSocket-Node</a></li>
</ul>
<h5 id="java"><a class="markdownIt-Anchor" href="#java"></a> Java</h5>
<p>Java çš„ web ä¸€èˆ¬éƒ½ä¾æ‰˜äº servlet å®¹å™¨ã€‚</p>
<p>æˆ‘ä½¿ç”¨è¿‡çš„ servlet å®¹å™¨æœ‰ï¼šTomcatã€Jettyã€Resinã€‚å…¶ä¸­ Tomcat7ã€Jetty7 åŠä»¥ä¸Šç‰ˆæœ¬å‡å¼€å§‹æ”¯æŒ WebSocketï¼ˆæ¨èè¾ƒæ–°çš„ç‰ˆæœ¬ï¼Œå› ä¸ºéšç€ç‰ˆæœ¬çš„æ›´è¿­ï¼Œå¯¹ WebSocket çš„æ”¯æŒå¯èƒ½æœ‰å˜æ›´ï¼‰ã€‚</p>
<p>æ­¤å¤–ï¼ŒSpring æ¡†æ¶å¯¹ WebSocket ä¹Ÿæä¾›äº†æ”¯æŒã€‚</p>
<p>è™½ç„¶ï¼Œä»¥ä¸Šåº”ç”¨å¯¹äº WebSocket éƒ½æœ‰å„è‡ªçš„å®ç°ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬éƒ½éµå¾ª<a href="https://tools.ietf.org/html/rfc6455" target="_blank" rel="noopener">RFC6455</a> çš„é€šä¿¡æ ‡å‡†ï¼Œå¹¶ä¸” Java API ç»Ÿä¸€éµå¾ª <a href="http://www.jcp.org/en/jsr/detail?id=356" target="_blank" rel="noopener">JSR 356 - JavaTM API for WebSocket </a> è§„èŒƒã€‚æ‰€ä»¥ï¼Œåœ¨å®é™…ç¼–ç ä¸­ï¼ŒAPI å·®å¼‚ä¸å¤§ã€‚</p>
<h5 id="spring"><a class="markdownIt-Anchor" href="#spring"></a> Spring</h5>
<p>Spring å¯¹äº WebSocket çš„æ”¯æŒåŸºäºä¸‹é¢çš„ jar åŒ…ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-websocket<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ Spring å®ç° WebSocket æœåŠ¡å™¨å¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p>
<p><strong>åˆ›å»º WebSocket å¤„ç†å™¨</strong></p>
<p>æ‰©å±• <code>TextWebSocketHandler</code> æˆ– <code>BinaryWebSocketHandler</code> ï¼Œä½ å¯ä»¥è¦†å†™æŒ‡å®šçš„æ–¹æ³•ã€‚Spring åœ¨æ”¶åˆ° WebSocket äº‹ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨äº‹ä»¶å¯¹åº”çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.socket.WebSocketHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.WebSocketSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.TextMessage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">extends</span> <span class="title">TextWebSocketHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleTextMessage</span><span class="params">(WebSocketSession session, TextMessage message)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>WebSocketHandler</code> æºç å¦‚ä¸‹ï¼Œè¿™æ„å‘³ç€ä½ çš„å¤„ç†å™¨å¤§æ¦‚å¯ä»¥å¤„ç†å“ªäº› WebSocket äº‹ä»¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WebSocketHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * å»ºç«‹è¿æ¥åè§¦å‘çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">afterConnectionEstablished</span><span class="params">(WebSocketSession session)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ”¶åˆ°æ¶ˆæ¯æ—¶è§¦å‘çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(WebSocketSession session, WebSocketMessage&lt;?&gt; message)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * ä¼ è¾“æ¶ˆæ¯å‡ºé”™æ—¶è§¦å‘çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">handleTransportError</span><span class="params">(WebSocketSession session, Throwable exception)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ–­å¼€è¿æ¥åè§¦å‘çš„å›è°ƒ</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">afterConnectionClosed</span><span class="params">(WebSocketSession session, CloseStatus closeStatus)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ˜¯å¦å¤„ç†åˆ†ç‰‡æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">boolean</span> <span class="title">supportsPartialMessages</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>é…ç½® WebSocket</strong></p>
<p>é…ç½®æœ‰ä¸¤ç§æ–¹å¼ï¼šæ³¨è§£å’Œ xml ã€‚å…¶ä½œç”¨å°±æ˜¯å°† WebSocket å¤„ç†å™¨æ·»åŠ åˆ°æ³¨å†Œä¸­å¿ƒã€‚</p>
<ol>
<li>å®ç° <code>WebSocketConfigurer</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.socket.config.annotation.EnableWebSocket;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.config.annotation.WebSocketConfigurer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableWebSocket</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketConfig</span> <span class="keyword">implements</span> <span class="title">WebSocketConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerWebSocketHandlers</span><span class="params">(WebSocketHandlerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addHandler(myHandler(), <span class="string">"/myHandler"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> WebSocketHandler <span class="title">myHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyHandler();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>xml æ–¹å¼</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:websocket</span>=<span class="string">"http://www.springframework.org/schema/websocket"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/websocket</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/websocket/spring-websocket.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">websocket:handlers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">websocket:mapping</span> <span class="attr">path</span>=<span class="string">"/myHandler"</span> <span class="attr">handler</span>=<span class="string">"myHandler"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">websocket:handlers</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myHandler"</span> <span class="attr">class</span>=<span class="string">"org.springframework.samples.MyHandler"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ›´å¤šé…ç½®ç»†èŠ‚å¯ä»¥å‚è€ƒï¼š<a href="https://docs.spring.io/spring/docs/4.3.12.RELEASE/spring-framework-reference/htmlsingle/#websocket" target="_blank" rel="noopener">Spring WebSocket æ–‡æ¡£</a></p>
</blockquote>
<p>javax.websocket</p>
<p>å¦‚æœä¸æƒ³ä½¿ç”¨ Spring æ¡†æ¶çš„ WebSocket APIï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©åŸºæœ¬çš„ javax.websocketã€‚</p>
<p>é¦–å…ˆï¼Œéœ€è¦å¼•å…¥ API jar åŒ…ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- To write basic javax.websocket against --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.websocket<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.websocket-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½¿ç”¨åµŒå…¥å¼ jettyï¼Œä½ è¿˜éœ€è¦å¼•å…¥å®ƒçš„å®ç°åŒ…ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- To run javax.websocket in embedded server --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty.websocket<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax-websocket-server-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jetty-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- To run javax.websocket client --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.eclipse.jetty.websocket<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax-websocket-client-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jetty-version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>@ServerEndpoint</strong></p>
<p>è¿™ä¸ªæ³¨è§£ç”¨æ¥æ ‡è®°ä¸€ä¸ªç±»æ˜¯ WebSocket çš„å¤„ç†å™¨ã€‚</p>
<p>ç„¶åï¼Œä½ å¯ä»¥åœ¨è¿™ä¸ªç±»ä¸­ä½¿ç”¨ä¸‹é¢çš„æ³¨è§£æ¥è¡¨æ˜æ‰€ä¿®é¥°çš„æ–¹æ³•æ˜¯è§¦å‘äº‹ä»¶çš„å›è°ƒ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ”¶åˆ°æ¶ˆæ¯è§¦å‘äº‹ä»¶</span></span><br><span class="line"><span class="meta">@OnMessage</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(String message, Session session)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å¼€è¿æ¥è§¦å‘äº‹ä»¶</span></span><br><span class="line"><span class="meta">@OnOpen</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onOpen</span><span class="params">(Session session, EndpointConfig config, @PathParam(<span class="string">"id"</span>)</span> String id) </span>&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…³é—­è¿æ¥è§¦å‘äº‹ä»¶</span></span><br><span class="line"><span class="meta">@OnClose</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClose</span><span class="params">(Session session, CloseReason closeReason)</span> </span>&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ è¾“æ¶ˆæ¯é”™è¯¯è§¦å‘äº‹ä»¶</span></span><br><span class="line"><span class="meta">@OnError</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable error)</span> </span>&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ServerEndpointConfig.Configurator</strong></p>
<p>ç¼–å†™å®Œå¤„ç†å™¨ï¼Œä½ éœ€è¦æ‰©å±• ServerEndpointConfig.Configurator ç±»å®Œæˆé…ç½®ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketServerConfigurator</span> <span class="keyword">extends</span> <span class="title">ServerEndpointConfig</span>.<span class="title">Configurator</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">modifyHandshake</span><span class="params">(ServerEndpointConfig sec, HandshakeRequest request, HandshakeResponse response)</span> </span>&#123;</span><br><span class="line">        HttpSession httpSession = (HttpSession) request.getHttpSession();</span><br><span class="line">        sec.getUserProperties().put(HttpSession<span class="class">.<span class="keyword">class</span>.<span class="title">getName</span>(), <span class="title">httpSession</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±æ²¡æœ‰ç„¶åäº†ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p>
<h4 id="websocket-ä»£ç†"><a class="markdownIt-Anchor" href="#websocket-ä»£ç†"></a> WebSocket ä»£ç†</h4>
<p>å¦‚æœæŠŠ WebSocket çš„é€šä¿¡çœ‹æˆæ˜¯ç”µè¯è¿æ¥ï¼ŒNginx çš„è§’è‰²åˆ™åƒæ˜¯ç”µè¯æ¥çº¿å‘˜ï¼Œè´Ÿè´£å°†å‘èµ·ç”µè¯è¿æ¥çš„ç”µè¯è½¬æ¥åˆ°æŒ‡å®šçš„å®¢æœã€‚</p>
<p>Nginx ä» <a href="http://nginx.com/blog/websocket-nginx/" target="_blank" rel="noopener">1.3 ç‰ˆ</a>å¼€å§‹æ­£å¼æ”¯æŒ WebSocket ä»£ç†ã€‚å¦‚æœä½ çš„ web åº”ç”¨ä½¿ç”¨äº†ä»£ç†æœåŠ¡å™¨ Nginxï¼Œé‚£ä¹ˆä½ è¿˜éœ€è¦ä¸º Nginx åšä¸€äº›é…ç½®ï¼Œä½¿å¾—å®ƒå¼€å¯ WebSocket ä»£ç†åŠŸèƒ½ã€‚</p>
<p>ä»¥ä¸‹ä¸ºå‚è€ƒé…ç½®ï¼š</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">  <span class="comment"># this section is specific to the WebSockets proxying</span></span><br><span class="line">  <span class="attribute">location</span> /socket.io &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> http://app_server_wsgiapp/socket.io;</span><br><span class="line">    <span class="attribute">proxy_redirect</span> <span class="literal">off</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">proxy_http_version</span> <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Connection <span class="string">"upgrade"</span>;</span><br><span class="line">    <span class="attribute">proxy_read_timeout</span> <span class="number">600</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ›´å¤šé…ç½®ç»†èŠ‚å¯ä»¥å‚è€ƒï¼š<a href="http://nginx.org/en/docs/http/websocket.html" target="_blank" rel="noopener">Nginx å®˜æ–¹çš„ websocket æ–‡æ¡£</a></p>
</blockquote>
<h4 id="websocket-åº”ç”¨ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#websocket-åº”ç”¨ç¤ºä¾‹"></a> WebSocket åº”ç”¨ç¤ºä¾‹</h4>
<p>å¦‚æœéœ€è¦å®Œæ•´ç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„ Github ä»£ç ï¼š</p>
<ul>
<li><a href="https://github.com/dunwu/spring-notes/tree/master/codes/web/websocket" target="_blank" rel="noopener">Spring å¯¹ WebSocket æ”¯æŒçš„ç¤ºä¾‹</a></li>
<li><a href="https://github.com/dunwu/javaee-notes/tree/master/codes/websocket" target="_blank" rel="noopener">åµŒå…¥å¼ Jetty æœåŠ¡å™¨çš„ WebSocket ç¤ºä¾‹</a></li>
</ul>
<p>spring-websocket å’Œ jetty 9.3 ç‰ˆæœ¬ä¼¼ä¹å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼ŒTomcat åˆ™æœ¨æœ‰é—®é¢˜ã€‚</p>
<p>æˆ‘å°è¯•äº†å¥½å‡ æ¬¡ï¼Œæ²¡æœ‰æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œåªå¥½ä½¿ç”¨ Jetty å®˜æ–¹çš„åµŒå…¥å¼ç¤ºä¾‹åœ¨ Jetty ä¸­ä½¿ç”¨ WebSocket ã€‚</p>
<h2 id="faq"><a class="markdownIt-Anchor" href="#faq"></a> FAQ</h2>
<h3 id="http-vs-socket"><a class="markdownIt-Anchor" href="#http-vs-socket"></a> Http vs. Socket</h3>
<p>Http é€šä¿¡ä¸ Socket é€šä¿¡æ–¹å¼æœ‰ä½•å·®å¼‚ï¼Ÿ</p>
<ul>
<li>Http
<ul>
<li>åŸºäºè¯·æ±‚/å“åº”æ¨¡å¼ï¼Œé‡‡å–ä¸€é—®ä¸€ç­”æ–¹å¼ï¼ˆå®¢æˆ·ç«¯è¯·æ±‚ï¼ŒæœåŠ¡ç«¯æ‰ä¼šå“åº”ï¼‰</li>
</ul>
</li>
<li>Socket
<ul>
<li>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹åŒå‘è¿æ¥ã€‚è¿æ¥æˆåŠŸåï¼Œä»»æ„ä¸€æ–¹éƒ½å¯ä¸»åŠ¨å‘é€æ¶ˆæ¯ã€‚</li>
<li>æ•°æ®ä¸¢å¤±ç‡ä½ï¼Œä½¿ç”¨ç®€å•ï¼Œæ˜“äºç§»æ¤ã€‚</li>
</ul>
</li>
</ul>
<h3 id="http-å’Œ-websocket-æœ‰ä»€ä¹ˆå…³ç³»"><a class="markdownIt-Anchor" href="#http-å’Œ-websocket-æœ‰ä»€ä¹ˆå…³ç³»"></a> HTTP å’Œ WebSocket æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</h3>
<p>Websocket å…¶å®æ˜¯ä¸€ä¸ªæ–°åè®®ï¼Œè·Ÿ HTTP åè®®åŸºæœ¬æ²¡æœ‰å…³ç³»ï¼Œåªæ˜¯ä¸ºäº†å…¼å®¹ç°æœ‰æµè§ˆå™¨çš„æ¡æ‰‹è§„èŒƒè€Œå·²ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ HTTP åè®®ä¸Šçš„ä¸€ç§è¡¥å……ã€‚</p>
<h3 id="html-å’Œ-http-æœ‰ä»€ä¹ˆå…³ç³»"><a class="markdownIt-Anchor" href="#html-å’Œ-http-æœ‰ä»€ä¹ˆå…³ç³»"></a> Html å’Œ HTTP æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</h3>
<p>Html æ˜¯è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œæ˜¯ä¸€ç§ç”¨äºåˆ›å»ºç½‘é¡µçš„æ ‡å‡†æ ‡è®°è¯­è¨€ã€‚å®ƒæ˜¯ä¸€ç§æŠ€æœ¯æ ‡å‡†ã€‚Html5 æ˜¯å®ƒçš„æœ€æ–°ç‰ˆæœ¬ã€‚</p>
<p>Http æ˜¯ä¸€ç§ç½‘ç»œé€šä¿¡åè®®ã€‚å…¶æœ¬èº«å’Œ Html æ²¡æœ‰ç›´æ¥å…³ç³»ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://www.zhihu.com/question/20215561" target="_blank" rel="noopener">çŸ¥ä¹é«˜ç¥¨ç­”æ¡ˆâ€”â€”WebSocket æ˜¯ä»€ä¹ˆåŸç†</a> - å¯¹ WebSocket åŸç†çš„é˜è¿°ç®€å•æ˜“æ‡‚ã€‚</li>
<li><a href="http://www.ruanyifeng.com/blog/2017/05/websocket.html" target="_blank" rel="noopener">WebSocket æ•™ç¨‹</a> - é˜®ä¸€å³°å¤§ç¥çš„ç§‘æ™®ä¸€å¦‚æ—¢å¾€çš„æµ…æ˜¾æ˜“æ‡‚ã€‚</li>
<li><a href="https://www.fullstackpython.com/websockets.html" target="_blank" rel="noopener">WebSockets</a> - by <em>fullstackpython</em></li>
<li><a href="http://nginx.org/en/docs/http/websocket.html" target="_blank" rel="noopener">Nginx å®˜æ–¹çš„ websocket æ–‡æ¡£</a></li>
<li><a href="https://docs.spring.io/spring/docs/4.3.12.RELEASE/spring-framework-reference/htmlsingle/#websocket" target="_blank" rel="noopener">Spring WebSocket æ–‡æ¡£</a></li>
<li><a href="http://tomcat.apache.org/tomcat-7.0-doc/web-socket-howto.html" target="_blank" rel="noopener">Tomcat7 WebSocket æ–‡æ¡£</a></li>
<li><a href="https://www.eclipse.org/jetty/documentation/9.4.7.v20170914/websocket-intro.html" target="_blank" rel="noopener">Jetty WebSocket æ–‡æ¡£</a></li>
<li><a href="https://juejin.im/post/57f885370bd1d00058b37d74" target="_blank" rel="noopener">Socketï¼Œä½ éœ€è¦çŸ¥é“çš„äº‹å„¿</a></li>
<li><a href="https://juejin.im/post/5b3649d751882552f052703b" target="_blank" rel="noopener">æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Socket é•¿è¿æ¥</a></li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
        <tag>åè®®</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œåè®®ä¹‹ TCP</title>
    <url>/blog/communication/tcp/</url>
    <content><![CDATA[<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯-tcp"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-tcp"></a> ä»€ä¹ˆæ˜¯ TCP</h3>
<p><strong>TCPï¼ˆTransmission Control Protocolï¼‰ï¼Œå³ä¼ è¾“æ§åˆ¶åè®®ï¼Œå®ƒæ˜¯ä¸€ç§<code>é¢å‘è¿æ¥çš„</code>ã€<code>å¯é çš„</code>ã€<code>åŸºäºå­—èŠ‚æµçš„</code>ä¼ è¾“å±‚é€šä¿¡åè®®</strong>ã€‚TCP ç”± RFC 793 å®šä¹‰ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559263786555.png!zp"/></div>
<h3 id="tcp-çš„ç‰¹æ€§"><a class="markdownIt-Anchor" href="#tcp-çš„ç‰¹æ€§"></a> TCP çš„ç‰¹æ€§</h3>
<ul>
<li><code>é¢å‘è¿æ¥çš„</code> - é¢å‘è¿æ¥æ˜¯æŒ‡ TCP éœ€è¦é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹åŸåˆ™å»ºç«‹å’Œæ–­å¼€åŒå‘è¿æ¥ã€‚</li>
<li><code>å¯é çš„</code> - å¯é æ˜¯æŒ‡ TCP ä¼ è¾“çš„æ•°æ®åŒ…ä¿è¯ä»¥åŸå§‹é¡ºåºåˆ°è¾¾ç›®çš„åœ°ï¼Œä¸”æ•°æ®åŒ…ä¸è¢«æŸåã€‚ä¸ºäº†å®ç°è¿™ç‚¹ï¼ŒTCP é€šè¿‡ä»¥ä¸‹æŠ€æœ¯æ¥ä¿è¯ï¼š
<ul>
<li>æ•°æ®åŒ…çš„åºåˆ—å·å’Œæ ¡éªŒç </li>
<li>ç¡®è®¤åŒ…å’Œè‡ªåŠ¨é‡ä¼ 
<ul>
<li>å¦‚æœå‘é€è€…æ²¡æœ‰æ”¶åˆ°æ­£ç¡®çš„å“åº”ï¼Œå®ƒå°†é‡æ–°å‘é€æ•°æ®åŒ…ã€‚å¦‚æœå¤šæ¬¡è¶…æ—¶ï¼Œè¿æ¥å°±ä¼šæ–­å¼€ã€‚</li>
<li>TCP å®è¡Œæµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶ã€‚è¿™äº›ç¡®ä¿æªæ–½ä¼šå¯¼è‡´å»¶è¿Ÿï¼Œè€Œä¸”é€šå¸¸å¯¼è‡´ä¼ è¾“æ•ˆç‡æ¯” UDP ä½ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><code>åŸºäºå­—èŠ‚æµçš„</code>
<ul>
<li>è™½ç„¶åº”ç”¨ç¨‹åºå’Œ TCP çš„äº¤äº’æ˜¯ä¸€æ¬¡ä¸€ä¸ªæ•°æ®å—ï¼ˆå¤§å°ä¸ç­‰ï¼‰ï¼Œä½† TCP æŠŠåº”ç”¨ç¨‹åºçœ‹æˆæ˜¯ä¸€è¿ä¸²çš„æ— ç»“æ„çš„å­—èŠ‚æµã€‚TCP æœ‰ä¸€ä¸ªç¼“å†²ï¼Œå½“åº”ç”¨ç¨‹åºä¼ é€çš„æ•°æ®å—å¤ªé•¿ï¼ŒTCP å°±å¯ä»¥æŠŠå®ƒåˆ’åˆ†çŸ­ä¸€äº›å†ä¼ é€ã€‚å¦‚æœåº”ç”¨ç¨‹åºä¸€æ¬¡åªå‘é€ä¸€ä¸ªå­—èŠ‚ï¼ŒTCP ä¹Ÿå¯ä»¥ç­‰å¾…ç§¯ç´¯æœ‰è¶³å¤Ÿå¤šçš„å­—èŠ‚åå†æ„æˆæŠ¥æ–‡æ®µå‘é€å‡ºå»ã€‚</li>
<li>åœ¨ TCP å»ºç«‹è¿æ¥å‰ä¸¤æ¬¡æ¡æ‰‹çš„ SYN æŠ¥æ–‡ä¸­é€‰é¡¹å­—æ®µçš„ MSS å€¼ï¼Œé€šä¿¡åŒæ–¹å•†å®šé€šä¿¡çš„æœ€å¤§æŠ¥æ–‡é•¿åº¦ã€‚å¦‚æœåº”ç”¨å±‚äº¤ä»˜ä¸‹æ¥çš„æ•°æ®è¿‡å¤§ï¼Œå°±ä¼šå¯¹æ•°æ®åˆ†æ®µï¼Œç„¶åå‘é€ï¼›å¦åˆ™é€šè¿‡æ»‘åŠ¨çª—å£æ¥æ§åˆ¶é€šä¿¡åŒå‘çš„æ•°æ®ã€‚</li>
</ul>
</li>
</ul>
<h3 id="tcp-çš„é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#tcp-çš„é€‚ç”¨åœºæ™¯"></a> TCP çš„é€‚ç”¨åœºæ™¯</h3>
<p>åŸºäºä»¥ä¸Šç‰¹æ€§ï¼Œä¸ºäº†ç¡®ä¿é«˜ååé‡ï¼ŒWeb æœåŠ¡å™¨å¯ä»¥ä¿æŒå¤§é‡çš„ TCP è¿æ¥ï¼Œä»è€Œå¯¼è‡´é«˜å†…å­˜ä½¿ç”¨ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ Web æœåŠ¡å™¨çº¿ç¨‹é—´æ‹¥æœ‰å¤§é‡å¼€æ”¾è¿æ¥å¯èƒ½å¼€é”€å·¨å¤§ï¼Œæ¶ˆè€—èµ„æºè¿‡å¤šï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘åœ¨é€‚ç”¨æƒ…å†µä¸‹åˆ‡æ¢åˆ° UDPã€‚</p>
<p>TCP å¯¹äºéœ€è¦é«˜å¯é æ€§ä½†æ—¶é—´ç´§è¿«çš„åº”ç”¨ç¨‹åºå¾ˆæœ‰ç”¨ã€‚æ¯”å¦‚åŒ…æ‹¬ Web æœåŠ¡å™¨ï¼Œæ•°æ®åº“ä¿¡æ¯ï¼ŒSMTPï¼ŒFTP å’Œ SSHã€‚</p>
<p>ä»¥ä¸‹æƒ…å†µä½¿ç”¨ TCP ä»£æ›¿ UDPï¼š</p>
<ul>
<li>ä½ éœ€è¦æ•°æ®å®Œå¥½æ— æŸã€‚</li>
<li>ä½ æƒ³å¯¹ç½‘ç»œååé‡è‡ªåŠ¨è¿›è¡Œæœ€ä½³è¯„ä¼°ã€‚</li>
</ul>
<h3 id="tcp-æŠ¥æ–‡"><a class="markdownIt-Anchor" href="#tcp-æŠ¥æ–‡"></a> TCP æŠ¥æ–‡</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559264511812.png!zp"/></div>
<p>æŠ¥æ–‡å­—æ®µä¸ä¸€ä¸€é˜è¿°ï¼Œé‡ç‚¹å…³æ³¨ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>TCP çš„åŒ…æ˜¯æ²¡æœ‰ IP åœ°å€çš„ï¼Œé‚£æ˜¯ IP å±‚ä¸Šçš„äº‹ã€‚ä½†æ˜¯æœ‰æºç«¯å£å’Œç›®æ ‡ç«¯å£ã€‚</li>
<li>ä¸€ä¸ª TCP è¿æ¥éœ€è¦å››ä¸ªå…ƒç»„æ¥è¡¨ç¤ºæ˜¯åŒä¸€ä¸ªè¿æ¥ï¼ˆsrc_ip, src_port, dst_ip, dst_portï¼‰å‡†ç¡®è¯´æ˜¯äº”å…ƒç»„ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯åè®®ã€‚ä½†å› ä¸ºè¿™é‡Œåªæ˜¯è¯´ TCP åè®®ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘åªè¯´å››å…ƒç»„ã€‚</li>
<li>æ³¨æ„ä¸Šå›¾ä¸­çš„å››ä¸ªéå¸¸é‡è¦çš„ä¸œè¥¿ï¼š
<ul>
<li><strong>Sequence Number</strong>æ˜¯åŒ…çš„åºå·ï¼Œ<strong>ç”¨æ¥è§£å†³ç½‘ç»œåŒ…ä¹±åºï¼ˆreorderingï¼‰é—®é¢˜ã€‚</strong></li>
<li><strong>Acknowledgement Number</strong>å°±æ˜¯ ACKâ€”â€”ç”¨äºç¡®è®¤æ”¶åˆ°ï¼Œ<strong>ç”¨æ¥è§£å†³ä¸ä¸¢åŒ…çš„é—®é¢˜</strong>ã€‚</li>
<li><strong>Window åˆå« Advertised-Window</strong>ï¼Œä¹Ÿå°±æ˜¯è‘—åçš„æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰ï¼Œ<strong>ç”¨äºè§£å†³æµæ§çš„</strong>ã€‚</li>
<li><strong>TCP Flag</strong>ï¼Œä¹Ÿå°±æ˜¯åŒ…çš„ç±»å‹ï¼Œ<strong>ä¸»è¦æ˜¯ç”¨äºæ“æ§ TCP çš„çŠ¶æ€æœºçš„</strong>ã€‚</li>
</ul>
</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559264593860.png!zp"/></div>
<h2 id="tcp-é€šä¿¡æµç¨‹"><a class="markdownIt-Anchor" href="#tcp-é€šä¿¡æµç¨‹"></a> TCP é€šä¿¡æµç¨‹</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559264679371.png!zp"/></div>
<p>TCP å®Œæ•´çš„é€šä¿¡åˆ†ä¸ºä¸‰å—ï¼š</p>
<ol>
<li>ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥</li>
<li>æ•°æ®ä¼ è¾“</li>
<li>å››æ¬¡æŒ¥æ‰‹ç«¯å£è¿æ¥</li>
</ol>
<h3 id="ä¸‰æ¬¡æ¡æ‰‹"><a class="markdownIt-Anchor" href="#ä¸‰æ¬¡æ¡æ‰‹"></a> ä¸‰æ¬¡æ¡æ‰‹</h3>
<p>ï¼ˆ1ï¼‰ä¸‰æ¬¡æ¡æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>
<ul>
<li>ä¸‰æ¬¡æ¡æ‰‹è´Ÿè´£å»ºç«‹ TCP åŒå‘è¿æ¥ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰ä»€ä¹ˆæ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/ä¸‰æ¬¡æ¡æ‰‹.gif!zp"/></div>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸‰æ¬¡æ¡æ‰‹æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¸¦æœ‰ SYN æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
<li>ç¬¬äºŒæ¬¡æ¡æ‰‹ - æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€å¸¦æœ‰ SYN/ACK æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¸¦æœ‰å¸¦æœ‰ ACK æ ‡å¿—çš„æ•°æ®åŒ…ã€‚</li>
</ol>
<p>è‡³æ­¤ï¼ŒTCP ä¸‰æ¬¡æ¡æ‰‹å®Œæˆï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å·²å»ºç«‹åŒå‘è¿æ¥ã€‚</p>
<blockquote>
<p>ğŸ’¡ è¯´æ˜ï¼šSYN ä¸º synchronize çš„ç¼©å†™ï¼ŒACK ä¸º acknowledgment çš„ç¼©å†™ã€‚</p>
</blockquote>
<p>ï¼ˆ3ï¼‰ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</p>
<p>ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œå‡è®¾å®¢æˆ·ç«¯ä¸º A, æœåŠ¡ç«¯ä¸º Bã€‚</p>
<ol>
<li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼ŒA å‘ B å‘åŒæ­¥æ¶ˆæ¯ã€‚B æ”¶åˆ°æ¶ˆæ¯åï¼ŒB è®¤ä¸ºï¼šA å‘æ¶ˆæ¯æ²¡é—®é¢˜ï¼›B æ”¶æ¶ˆæ¯æ²¡é—®é¢˜ã€‚</li>
<li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼ŒB å‘ A å‘åŒæ­¥æ¶ˆæ¯å’Œç¡®è®¤æ¶ˆæ¯ã€‚A æ”¶åˆ°æ¶ˆæ¯åï¼ŒA è®¤ä¸ºï¼šA å‘æ¶ˆæ¯ã€æ”¶æ¶ˆæ¯éƒ½æ²¡é—®é¢˜ï¼›B å‘æ¶ˆæ¯ã€æ”¶æ¶ˆæ¯éƒ½æ²¡é—®é¢˜ã€‚<strong>ä½†æ˜¯ï¼Œæ­¤æ—¶ B ä¸ç¡®å®šè‡ªå·±å‘æ¶ˆæ¯æ˜¯å¦æ²¡é—®é¢˜</strong>ï¼Œæ‰€ä»¥å°±éœ€è¦ç¬¬ä¸‰æ¬¡æ¡æ‰‹ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼ŒA å‘ B å‘ç¡®è®¤æ¶ˆæ¯ã€‚B æ”¶åˆ°æ¶ˆæ¯åã€‚B è®¤ä¸ºï¼šB å‘æ¶ˆæ¯æ²¡é—®é¢˜ã€‚</li>
</ol>
<h3 id="å››æ¬¡æŒ¥æ‰‹"><a class="markdownIt-Anchor" href="#å››æ¬¡æŒ¥æ‰‹"></a> å››æ¬¡æŒ¥æ‰‹</h3>
<p>ï¼ˆ1ï¼‰å››æ¬¡æŒ¥æ‰‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>
<ul>
<li>å››æ¬¡æŒ¥æ‰‹è´Ÿè´£æ–­å¼€ TCP è¿æ¥ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰ä»€ä¹ˆæ˜¯å››æ¬¡æŒ¥æ‰‹ï¼Ÿ</p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå››æ¬¡æŒ¥æ‰‹æµç¨‹å¦‚ä¸‹ï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/å››æ¬¡æŒ¥æ‰‹.gif!zp"/></div>
<ol>
<li>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ª FIN åŒ…ï¼Œç”¨æ¥å…³é—­å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„æ•°æ®ä¼ é€ã€‚</li>
<li>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ - æœåŠ¡ç«¯æ”¶åˆ°è¿™ä¸ª FIN åŒ…ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª ACK åŒ…ï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°çš„åºå·åŠ  1ã€‚å’Œ SYN ä¸€æ ·ï¼Œä¸€ä¸ª FIN å°†å ç”¨ä¸€ä¸ªåºå·ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ - æœåŠ¡ç«¯å…³é—­ä¸å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN åŒ…ã€‚</li>
<li>ç¬¬å››æ¬¡æŒ¥æ‰‹ - å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ ACK åŒ…ï¼Œå¹¶å°†ç¡®è®¤åºå·è®¾ç½®ä¸ºæ”¶åˆ°åºå·åŠ  1ã€‚</li>
</ol>
<p>ï¼ˆ3ï¼‰ä¸ºä»€ä¹ˆå»ºç«‹è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­è¿æ¥ç¡®æ˜¯å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ</p>
<ul>
<li>å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œ æœåŠ¡å™¨åœ¨ LISTEN çŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°å»ºç«‹è¿æ¥è¯·æ±‚çš„ SYN æŠ¥æ–‡åï¼ŒæŠŠ ACK å’Œ SYN æ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡é‡Œå‘é€ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>è€Œå…³é—­è¿æ¥æ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°å¯¹æ–¹çš„ FIN æŠ¥æ–‡æ—¶ï¼Œä»…ä»…è¡¨ç¤ºå¯¹æ–¹ä¸å†å‘é€æ•°æ®äº†ä½†æ˜¯è¿˜èƒ½æ¥æ”¶æ•°æ®ï¼Œè€Œè‡ªå·±ä¹Ÿæœªå¿…å…¨éƒ¨æ•°æ®éƒ½å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥å·±æ–¹å¯ä»¥ç«‹å³å…³é—­ï¼Œä¹Ÿå¯ä»¥å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹åï¼Œå†å‘é€ FIN æŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºåŒæ„ç°åœ¨å…³é—­è¿æ¥ï¼Œå› æ­¤ï¼Œå·±æ–¹ ACK å’Œ FIN ä¸€èˆ¬éƒ½ä¼šåˆ†å¼€å‘é€ï¼Œä»è€Œå¯¼è‡´å¤šäº†ä¸€æ¬¡ã€‚</li>
</ul>
<h2 id="æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#æ»‘åŠ¨çª—å£"></a> æ»‘åŠ¨çª—å£</h2>
<p>ä»€ä¹ˆæ˜¯æ»‘åŠ¨çª—å£ï¼Ÿ</p>
<p><strong>æ»‘åŠ¨çª—å£æ˜¯ TCP çš„ä¸€ç§æ§åˆ¶ç½‘ç»œæµé‡çš„æŠ€æœ¯ã€‚</strong></p>
<p><strong>TCP å¿…éœ€è¦è§£å†³çš„å¯é ä¼ è¾“ä»¥åŠåŒ…ä¹±åºï¼ˆreorderingï¼‰çš„é—®é¢˜</strong>ï¼Œæ‰€ä»¥ï¼ŒTCP å¿…éœ€è¦çŸ¥é“ç½‘ç»œå®é™…çš„æ•°æ®å¤„ç†å¸¦å®½æˆ–æ˜¯æ•°æ®å¤„ç†é€Ÿåº¦ï¼Œè¿™æ ·æ‰ä¸ä¼šå¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´ä¸¢åŒ…ã€‚</p>
<p>TCP å¤´é‡Œæœ‰ä¸€ä¸ªå­—æ®µå« Windowï¼Œåˆå« Advertised-Windowï¼Œè¿™ä¸ªå­—æ®µæ˜¯æ¥æ”¶ç«¯å‘Šè¯‰å‘é€ç«¯è‡ªå·±è¿˜æœ‰å¤šå°‘ç¼“å†²åŒºå¯ä»¥æ¥æ”¶æ•°æ®ã€‚<strong>äºæ˜¯å‘é€ç«¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥æ”¶ç«¯çš„å¤„ç†èƒ½åŠ›æ¥å‘é€æ•°æ®ï¼Œè€Œä¸ä¼šå¯¼è‡´æ¥æ”¶ç«¯å¤„ç†ä¸è¿‡æ¥</strong>ã€‚</p>
<p>æ»‘åŠ¨çª—å£åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559265819762.png!zp"/></div>
<ol>
<li>å·²å‘é€å·²ç¡®è®¤ - æ•°æ®æµä¸­æœ€æ—©çš„å­—èŠ‚å·²ç»å‘é€å¹¶å¾—åˆ°ç¡®è®¤ã€‚è¿™äº›æ•°æ®æ˜¯ç«™åœ¨å‘é€ç«¯çš„è§’åº¦æ¥çœ‹çš„ã€‚ä¸Šå›¾ä¸­çš„ 31 ä¸ªå­—èŠ‚å·²ç»å‘é€å¹¶ç¡®è®¤ã€‚</li>
<li>å·²å‘é€ä½†å°šæœªç¡®è®¤ - å·²å‘é€ä½†å°šæœªå¾—åˆ°ç¡®è®¤çš„å­—èŠ‚ã€‚å‘é€æ–¹åœ¨ç¡®è®¤ä¹‹å‰ï¼Œä¸è®¤ä¸ºè¿™äº›æ•°æ®å·²ç»è¢«å¤„ç†ã€‚ä¸Šå›¾ä¸­çš„ 32 ~ 45 å­—èŠ‚ä¸ºç¬¬ 2 ç±»ã€‚</li>
<li>æœªå‘é€è€Œæ¥æ”¶æ–¹å·² Ready - è®¾å¤‡å°šæœªå°†æ•°æ®å‘å‡º ï¼Œä½†æ¥æ”¶æ–¹æ ¹æ®æœ€è¿‘ä¸€æ¬¡å…³äºå‘é€æ–¹ä¸€æ¬¡è¦å‘é€å¤šå°‘å­—èŠ‚ç¡®è®¤è‡ªå·±æœ‰è¶³å¤Ÿç©ºé—´ã€‚å‘é€æ–¹ä¼šç«‹å³å°è¯•å‘é€ã€‚ä¸Šå›¾ä¸­çš„ 46 ~ 51 å­—èŠ‚ä¸ºç¬¬ 3 ç±»ã€‚</li>
<li>æœªå‘é€è€Œæ¥æ”¶æ–¹ Not Ready - ç”±äºæ¥æ”¶æ–¹ not readyï¼Œè¿˜ä¸å…è®¸å°†è¿™éƒ¨åˆ†æ•°æ®å‘å‡ºã€‚ä¸Šå›¾ä¸­çš„ 52 ä»¥åçš„å­—èŠ‚ä¸ºç¬¬ 4 ç±»ã€‚</li>
</ol>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559265927658.png!zp"/></div>
<p>è¿™å¼ å›¾ç‰‡ç›¸å¯¹äºä¸Šä¸€å¼ å›¾ç‰‡ï¼Œæ»‘åŠ¨çª—å£åç§»äº† 5 ä¸ªå­—èŠ‚ï¼Œæ„å‘³ç€æœ‰ 5 ä¸ªå·²å‘é€çš„å­—èŠ‚å¾—åˆ°äº†ç¡®è®¤ã€‚</p>
<h2 id="tcp-é‡ä¼ æœºåˆ¶"><a class="markdownIt-Anchor" href="#tcp-é‡ä¼ æœºåˆ¶"></a> TCP é‡ä¼ æœºåˆ¶</h2>
<p>TCP è¦ä¿è¯æ‰€æœ‰çš„æ•°æ®åŒ…éƒ½å¯ä»¥åˆ°è¾¾ï¼Œæ‰€ä»¥ï¼Œå¿…éœ€è¦æœ‰é‡ä¼ æœºåˆ¶ã€‚</p>
<p>TCP é‡ä¼ æœºåˆ¶ä¸»è¦æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>è¶…æ—¶é‡ä¼ æœºåˆ¶</li>
<li>å¿«é€Ÿé‡ä¼ æœºåˆ¶</li>
</ul>
<h3 id="è¶…æ—¶é‡ä¼ æœºåˆ¶"><a class="markdownIt-Anchor" href="#è¶…æ—¶é‡ä¼ æœºåˆ¶"></a> è¶…æ—¶é‡ä¼ æœºåˆ¶</h3>
<p>è¶…æ—¶é‡ä¼ æœºåˆ¶æ˜¯æŒ‡ï¼šå‘é€æ•°æ®åŒ…åœ¨ä¸€å®šçš„æ—¶é—´å‘¨æœŸå†…æ²¡æœ‰æ”¶åˆ°ç›¸åº”çš„ ACKï¼Œç­‰å¾…ä¸€å®šçš„æ—¶é—´ï¼Œè¶…æ—¶ä¹‹åå°±è®¤ä¸ºè¿™ä¸ªæ•°æ®åŒ…ä¸¢å¤±ï¼Œå°±ä¼šé‡æ–°å‘é€ã€‚è¿™ä¸ªç­‰å¾…æ—¶é—´è¢«ç§°ä¸º RTO(Retransmission TimeOut)ï¼Œå³é‡ä¼ è¶…æ—¶æ—¶é—´ã€‚</p>
<p>æ²¡æœ‰ç¡®è®¤çš„æ•°æ®åŒ…ä¸ä¼šä»çª—å£ä¸­ç§»èµ°ï¼Œå®šæ—¶å™¨åœ¨é‡ä¼ æ—¶é—´åˆ°æœŸå†…ï¼Œæ¯ä¸ªç‰‡æ®µçš„ä½ç½®ä¸å˜ã€‚</p>
<p>è¿™ç§æœºåˆ¶çš„é‡ç‚¹æ˜¯ RTO çš„è®¾ç½®ï¼š</p>
<ul>
<li>RTO è®¾é•¿äº†ï¼Œé‡å‘å°±æ…¢ï¼Œä¸¢äº†è€åŠå¤©æ‰é‡å‘ï¼Œæ²¡æœ‰æ•ˆç‡ï¼Œæ€§èƒ½å·®ï¼›</li>
<li>RTO è®¾çŸ­äº†ï¼Œä¼šå¯¼è‡´å¯èƒ½å¹¶æ²¡æœ‰ä¸¢å°±é‡å‘ã€‚äºæ˜¯é‡å‘çš„å°±å¿«ï¼Œä¼šå¢åŠ ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´æ›´å¤šçš„è¶…æ—¶ï¼Œæ›´å¤šçš„è¶…æ—¶å¯¼è‡´æ›´å¤šçš„é‡å‘</li>
</ul>
<h3 id="å¿«é€Ÿé‡ä¼ æœºåˆ¶"><a class="markdownIt-Anchor" href="#å¿«é€Ÿé‡ä¼ æœºåˆ¶"></a> å¿«é€Ÿé‡ä¼ æœºåˆ¶</h3>
<p>å¿«é€Ÿé‡ä¼ æœºåˆ¶ï¼Œå®ç°äº†å¦å¤–çš„ä¸€ç§ä¸¢åŒ…è¯„å®šæ ‡å‡†ï¼Œå³å¦‚æœè¿ç»­æ”¶åˆ° 3 æ¬¡é‡å¤ ACKï¼Œå‘é€æ–¹å°±è®¤ä¸ºè¿™ä¸ª seq çš„åŒ…ä¸¢å¤±äº†ï¼Œç«‹åˆ»è¿›è¡Œé‡ä¼ ã€‚</p>
<p>å½“æ¥æ”¶æ–¹æ”¶åˆ°ä¹±åºç‰‡æ®µæ—¶ï¼Œéœ€è¦é‡å¤å‘é€ ACKã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://coolshell.cn/articles/11564.html" target="_blank" rel="noopener">TCP çš„é‚£äº›äº‹å„¿ï¼ˆä¸Šï¼‰</a></li>
<li><a href="https://coolshell.cn/articles/11609.html" target="_blank" rel="noopener">TCP çš„é‚£äº›äº‹å„¿ï¼ˆä¸‹ï¼‰</a></li>
<li><a href="https://juejin.im/post/5a7835a46fb9a063606eb801" target="_blank" rel="noopener">å›¾è§£ TCP ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡åˆ†æ‰‹</a></li>
<li><a href="https://blog.csdn.net/qzcsu/article/details/72861891" target="_blank" rel="noopener">TCP çš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹ï¼ˆè¯¦è§£+åŠ¨å›¾ï¼‰</a></li>
<li><a href="https://blog.csdn.net/sinat_36629696/article/details/80740678" target="_blank" rel="noopener">TCP è¯¦è§£</a></li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
        <tag>åè®®</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œé€šä¿¡ä¹‹ CDN</title>
    <url>/blog/communication/cdn/</url>
    <content><![CDATA[<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559138689425.png!zp"/></div>
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<h3 id="cdn-æ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#cdn-æ˜¯ä»€ä¹ˆ"></a> CDN æ˜¯ä»€ä¹ˆ</h3>
<p>CDN(<strong>Content Delivery Network</strong>)ï¼Œå³<strong>å†…å®¹åˆ†å‘ç½‘ç»œ</strong>ã€‚</p>
<p>CDN æ˜¯ä¸€ä¸ªå…¨çƒæ€§çš„ä»£ç†æœåŠ¡å™¨åˆ†å¸ƒå¼ç½‘ç»œï¼Œä¾é éƒ¨ç½²åœ¨å„åœ°çš„è¾¹ç¼˜æœåŠ¡å™¨ï¼Œé€šè¿‡ä¸­å¿ƒå¹³å°çš„è´Ÿè½½å‡è¡¡ã€å†…å®¹åˆ†å‘ã€è°ƒåº¦ç­‰åŠŸèƒ½æ¨¡å—ï¼Œä½¿ç”¨æˆ·å°±è¿‘è·å–æ‰€éœ€å†…å®¹ï¼Œé™ä½ç½‘ç»œæ‹¥å¡ï¼Œæé«˜ç”¨æˆ·è®¿é—®å“åº”é€Ÿåº¦å’Œå‘½ä¸­ç‡ã€‚å®ƒä»é è¿‘ç”¨æˆ·çš„ä½ç½®æä¾›å†…å®¹ã€‚é€šå¸¸ï¼ŒHTML/CSS/JSï¼Œå›¾ç‰‡å’Œè§†é¢‘ç­‰é™æ€å†…å®¹ç”± CDN æä¾›ã€‚CDN çš„ DNS è§£æä¼šå‘ŠçŸ¥å®¢æˆ·ç«¯è¿æ¥å“ªå°æœåŠ¡å™¨ã€‚CDN çš„å…³é”®æŠ€æœ¯ä¸»è¦æœ‰å†…å®¹å­˜å‚¨å’Œåˆ†å‘æŠ€æœ¯ã€‚</p>
<h3 id="cdn-çš„ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#cdn-çš„ä¼˜ç¼ºç‚¹"></a> CDN çš„ä¼˜ç¼ºç‚¹</h3>
<ul>
<li>ä¼˜ç‚¹
<ul>
<li><strong>è®¿é—®åŠ é€Ÿ</strong> - ç”±äº CDN å°±è¿‘æœåŠ¡ï¼Œå¤§å¤§é™ä½äº†ç½‘ç»œä¼ æ’­æ—¶å»¶ï¼Œæ‰€ä»¥è‡ªç„¶æé«˜äº†è®¿é—®é€Ÿåº¦ã€‚</li>
<li><strong>é™ä½è´Ÿè½½</strong> - å¦‚æœ CDN å·²ç»èƒ½è·å–æ•°æ®ï¼Œé‚£ä¹ˆå°±ä¸å¿…è¯·æ±‚æºç«™ï¼Œè¿™è‡ªç„¶é™ä½äº†æºç«™ï¼ˆæœåŠ¡å™¨ï¼‰çš„è´Ÿè½½ã€‚</li>
</ul>
</li>
<li>ç¼ºç‚¹
<ul>
<li>CDN æˆæœ¬å¯èƒ½å› æµé‡è€Œå¼‚ï¼Œå¯èƒ½åœ¨æƒè¡¡ä¹‹åä½ å°†ä¸ä¼šä½¿ç”¨ CDNã€‚</li>
<li>å¦‚æœåœ¨ TTL è¿‡æœŸä¹‹å‰æ›´æ–°å†…å®¹ï¼ŒCDN ç¼“å­˜å†…å®¹å¯èƒ½ä¼šè¿‡æ—¶ã€‚</li>
<li>CDN éœ€è¦æ›´æ”¹é™æ€å†…å®¹çš„ URL åœ°å€ä»¥æŒ‡å‘ CDNã€‚</li>
</ul>
</li>
</ul>
<h2 id="cdn-åŸç†"><a class="markdownIt-Anchor" href="#cdn-åŸç†"></a> CDN åŸç†</h2>
<p>CDN çš„åŸºæœ¬åŸç†æ˜¯ï¼š</p>
<ul>
<li>å¹¿æ³›é‡‡ç”¨å„ç§ç¼“å­˜æœåŠ¡å™¨ï¼Œå°†è¿™äº›ç¼“å­˜æœåŠ¡å™¨åˆ†å¸ƒåˆ°ç”¨æˆ·è®¿é—®ç›¸å¯¹é›†ä¸­çš„åœ°åŒºæˆ–ç½‘ç»œä¸­ï¼›</li>
<li>åœ¨ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶ï¼Œå®æ—¶åœ°æ ¹æ®ç½‘ç»œæµé‡å’Œå„èŠ‚ç‚¹çš„è¿æ¥ã€è´Ÿè½½çŠ¶å†µä»¥åŠåˆ°ç”¨æˆ·çš„è·ç¦»å’Œå“åº”æ—¶é—´ç­‰ç»¼åˆä¿¡æ¯æ¥é€‰æ‹©æœ€ä½³ç¼“å­˜æœåŠ¡å™¨ï¼›</li>
<li>ç„¶åï¼Œå°†ç”¨æˆ·çš„è¯·æ±‚é‡æ–°å¯¼å‘æœ€ä½³çš„ç¼“å­˜æœåŠ¡å™¨ä¸Šï¼Œç”±ç¼“å­˜æœåŠ¡å™¨ç›´æ¥å“åº”ç”¨æˆ·è¯·æ±‚ã€‚</li>
</ul>
<p>CDN ç½‘ç»œæ¶æ„ä¸»è¦ç”±ä¸¤å¤§éƒ¨åˆ†ï¼Œåˆ†ä¸º<strong>ä¸­å¿ƒ</strong>å’Œ<strong>è¾¹ç¼˜</strong>ä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li>ä¸­å¿ƒæŒ‡ CDN ç½‘ç®¡ä¸­å¿ƒå’Œ DNS é‡å®šå‘è§£æä¸­å¿ƒï¼Œè´Ÿè´£å…¨å±€è´Ÿè½½å‡è¡¡ï¼Œè®¾å¤‡ç³»ç»Ÿå®‰è£…åœ¨ç®¡ç†ä¸­å¿ƒæœºæˆ¿ï¼›</li>
<li>è¾¹ç¼˜ä¸»è¦æŒ‡å¼‚åœ°èŠ‚ç‚¹ï¼ŒCDN åˆ†å‘çš„è½½ä½“ï¼Œä¸»è¦ç”± Cache å’Œè´Ÿè½½å‡è¡¡å™¨ç­‰ç»„æˆã€‚</li>
</ul>
<p>CDN æ˜¯ä¸€ä¸ªç­–ç•¥æ€§éƒ¨ç½²çš„æ•´ä½“ç³»ç»Ÿï¼ŒåŒ…æ‹¬<strong>åˆ†å¸ƒå¼å­˜å‚¨</strong>ã€<strong>è´Ÿè½½å‡è¡¡</strong>ã€<strong>å†…å®¹ç®¡ç†</strong>å’Œ<strong>ç½‘ç»œè¯·æ±‚çš„é‡å®šå‘</strong>ï¼”ä¸ªè¦ä»¶ã€‚</p>
<h3 id="åˆ†å¸ƒå¼å­˜å‚¨"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼å­˜å‚¨"></a> åˆ†å¸ƒå¼å­˜å‚¨</h3>
<p>CDN ç½‘ç»œå°†å­˜å‚¨èµ„æºåˆ†å¸ƒåˆ°å„ä¸ªåœ°ç†ä½ç½®ã€å„ä¸ªç½‘æ®µã€‚å­˜å‚¨ç³»ç»Ÿä½œä¸º CDN ç³»ç»Ÿå¯†ä¸å¯åˆ†çš„ä¸€éƒ¨åˆ†ï¼Œå°† CDN åˆ†å‘çš„æ–‡ä»¶å’Œæ•°æ®åº“è¡¨è®°å½•å†…å®¹å­˜å‚¨èµ·æ¥ï¼Œæä¾›æŒç»­æœåŠ¡ã€‚å­˜å‚¨ç³»ç»Ÿé‡‡ç”¨ä¸‰çº§å­˜å‚¨æ¶æ„ï¼ŒåŒ…æ‹¬æ ¸å¿ƒå­˜å‚¨ã€CDN æœåŠ¡èŠ‚ç‚¹åˆ†å¸ƒå¼ç¼“å­˜å’Œç»ˆç«¯æœ¬åœ°ç¼“å­˜ã€‚ä»»æ„ä¸€ä¸ªç‚¹çš„å­˜å‚¨å´©æºƒæˆ–å¤±æ•ˆï¼Œå¹¶ä¸å½±å“ç³»ç»ŸæœåŠ¡çš„å¯ç”¨æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559140068433.png!zp"/></div>
<p>å¦‚ CDN ç³»ç»Ÿåœ¨ 5 å¤§è¿è¥å•†ï¼ˆä¸­å›½ç”µä¿¡ã€ä¸­å›½ç½‘é€šã€ä¸­å›½é“é€šã€ä¸­å›½ç§»åŠ¨ã€ä¸­å›½è”é€šï¼‰ä»¥åŠ 2 å¤§ä¸“æœ‰ç½‘ç»œï¼ˆä¸­å›½æ•™è‚²å’Œç§‘ç ”è®¡ç®—æœºç½‘ã€ä¸­å›½ç§‘æŠ€ç½‘ï¼‰éƒ½å¸ƒæœ‰ CDN èŠ‚ç‚¹ã€‚<strong>è¿™æ ·å°±æ¶ˆé™¤äº†ä¸åŒè¿è¥å•†ä¹‹é—´äº’è”çš„ç“¶é¢ˆé€ æˆçš„å½±å“ï¼Œå®ç°äº†è·¨è¿è¥å•†çš„ç½‘ç»œåŠ é€Ÿï¼Œä¿è¯ä¸åŒç½‘ç»œä¸­çš„ç”¨æˆ·éƒ½èƒ½å¾—åˆ°è‰¯å¥½çš„è®¿é—®è´¨é‡ã€‚</strong></p>
<h3 id="å†…å®¹ç®¡ç†"><a class="markdownIt-Anchor" href="#å†…å®¹ç®¡ç†"></a> å†…å®¹ç®¡ç†</h3>
<p>å†…å®¹ç®¡ç†å’Œå…¨å±€çš„ç½‘ç»œæµé‡ç®¡ç†(Traffic Management)æ˜¯ CDN çš„æ ¸å¿ƒæ‰€åœ¨ã€‚<strong>é€šè¿‡ç”¨æˆ·å°±è¿‘æ€§å’ŒæœåŠ¡å™¨è´Ÿè½½çš„åˆ¤æ–­ï¼ŒCDN ç¡®ä¿å†…å®¹ä»¥ä¸€ç§æä¸ºé«˜æ•ˆçš„æ–¹å¼ä¸ºç”¨æˆ·çš„è¯·æ±‚æä¾›æœåŠ¡</strong>ã€‚æ€»çš„æ¥è¯´ï¼Œå†…å®¹æœåŠ¡åŸºäº<strong>ç¼“å­˜æœåŠ¡å™¨</strong>ï¼Œä¹Ÿç§°ä½œ<strong>ä»£ç†ç¼“å­˜(Surrogate)</strong>ï¼Œå®ƒä½äºç½‘ç»œçš„è¾¹ç¼˜ï¼Œè·ç”¨æˆ·ä»…æœ‰&quot;ä¸€è·³&quot;(Single Hop)ä¹‹é¥ã€‚åŒæ—¶ï¼Œä»£ç†ç¼“å­˜æ˜¯å†…å®¹æä¾›å•†æºæœåŠ¡å™¨ï¼ˆé€šå¸¸ä½äº CDN æœåŠ¡æä¾›å•†çš„æ•°æ®ä¸­å¿ƒï¼‰çš„ä¸€ä¸ªé€æ˜é•œåƒã€‚è¿™æ ·çš„æ¶æ„ä½¿å¾— CDN æœåŠ¡æä¾›å•†èƒ½å¤Ÿä»£è¡¨ä»–ä»¬å®¢æˆ·ï¼Œå³å†…å®¹ä¾›åº”å•†ï¼Œå‘æœ€ç»ˆç”¨æˆ·æä¾›å°½å¯èƒ½å¥½çš„ä½“éªŒï¼Œè€Œè¿™äº›ç”¨æˆ·æ˜¯ä¸èƒ½å®¹å¿è¯·æ±‚å“åº”æ—¶é—´æœ‰ä»»ä½•å»¶è¿Ÿçš„ã€‚æ®ç»Ÿè®¡ï¼Œé‡‡ç”¨ CDN æŠ€æœ¯ï¼Œèƒ½å¤„ç†æ•´ä¸ªç½‘ç«™é¡µé¢çš„ 70%ï½ 95ï¼…çš„å†…å®¹è®¿é—®é‡ï¼Œå‡è½»æœåŠ¡å™¨çš„å‹åŠ›ï¼Œæå‡äº†ç½‘ç«™çš„æ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚</p>
<h3 id="è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#è´Ÿè½½å‡è¡¡"></a> è´Ÿè½½å‡è¡¡</h3>
<p>CDN è´Ÿè½½å‡è¡¡ç³»ç»Ÿå®ç° CDN çš„<strong>å†…å®¹è·¯ç”±åŠŸèƒ½</strong>ã€‚å®ƒçš„ä½œç”¨æ˜¯å°†ç”¨æˆ·çš„è¯·æ±‚å¯¼å‘æ•´ä¸ª CDN ç½‘ç»œä¸­çš„æœ€ä½³èŠ‚ç‚¹ã€‚æœ€ä½³èŠ‚ç‚¹çš„é€‰å®šå¯ä»¥æ ¹æ®å¤šç§ç­–ç•¥ï¼Œä¾‹å¦‚<strong>è·ç¦»æœ€è¿‘</strong>ã€<strong>èŠ‚ç‚¹è´Ÿè½½æœ€è½»</strong>ç­‰ã€‚è´Ÿè½½å‡è¡¡ç³»ç»Ÿæ˜¯æ•´ä¸ª CDN çš„æ ¸å¿ƒï¼Œè´Ÿè½½å‡è¡¡çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ç›´æ¥å†³å®šäº†æ•´ä¸ª CDN çš„æ•ˆç‡å’Œæ€§èƒ½ã€‚é€šå¸¸è´Ÿè½½å‡è¡¡å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå±‚æ¬¡ï¼š<strong>å…¨å±€è´Ÿè½½å‡è¡¡ï¼ˆGSLBï¼‰<strong>å’Œ</strong>æœ¬åœ°è´Ÿè½½å‡è¡¡ï¼ˆSLBï¼‰</strong>ã€‚</p>
<h3 id="ç½‘ç»œè¯·æ±‚çš„é‡å®šå‘"><a class="markdownIt-Anchor" href="#ç½‘ç»œè¯·æ±‚çš„é‡å®šå‘"></a> ç½‘ç»œè¯·æ±‚çš„é‡å®šå‘</h3>
<p>å½“ç”¨æˆ·è®¿é—®äº†ä½¿ç”¨ CDN æœåŠ¡çš„èµ„æºæ—¶ï¼ŒDNS åŸŸåæœåŠ¡å™¨é€šè¿‡ CNAME æ–¹å¼å°†æœ€ç»ˆåŸŸåè¯·æ±‚é‡å®šå‘åˆ° CDN ç³»ç»Ÿä¸­çš„æ™ºèƒ½ DNS è´Ÿè½½å‡è¡¡ç³»ç»Ÿã€‚<strong>æ™ºèƒ½ DNS è´Ÿè½½å‡è¡¡ç³»ç»Ÿé€šè¿‡ä¸€ç»„é¢„å…ˆå®šä¹‰å¥½çš„ç­–ç•¥ï¼ˆå¦‚å†…å®¹ç±»å‹ã€åœ°ç†åŒºåŸŸã€ç½‘ç»œè´Ÿè½½çŠ¶å†µç­‰ï¼‰ï¼Œå°†å½“æ—¶èƒ½å¤Ÿæœ€å¿«å“åº”ç”¨æˆ·çš„èŠ‚ç‚¹åœ°å€æä¾›ç»™ç”¨æˆ·ï¼Œä½¿ç”¨æˆ·å¯ä»¥å¾—åˆ°å¿«é€Ÿçš„æœåŠ¡</strong>ã€‚</p>
<p>åŒæ—¶ï¼Œå®ƒè¿˜ä¸åˆ†å¸ƒåœ¨ä¸åŒåœ°ç‚¹çš„æ‰€æœ‰ CDN èŠ‚ç‚¹ä¿æŒé€šä¿¡ï¼Œæœé›†å„èŠ‚ç‚¹çš„å¥åº·çŠ¶æ€ï¼Œç¡®ä¿ä¸å°†ç”¨æˆ·çš„è¯·æ±‚åˆ†é…åˆ°ä»»ä½•ä¸€ä¸ªå·²ç»ä¸å¯ç”¨çš„èŠ‚ç‚¹ä¸Šã€‚</p>
<blockquote>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://www.cnblogs.com/skynet/archive/2012/12/18/2824141.html" target="_blank" rel="noopener">CDN-å†…å®¹æ¨é€ç½‘ç»œ</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/39028766" target="_blank" rel="noopener">é—²è¯ CDN</a></li>
</ul>
</blockquote>
<h2 id="cdn-è®¿é—®æµç¨‹"><a class="markdownIt-Anchor" href="#cdn-è®¿é—®æµç¨‹"></a> CDN è®¿é—®æµç¨‹</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/snap/1559126750010.png!zp"/></div>
<ol>
<li>ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è®¿é—®åŸŸåï¼ŒåŸŸåè§£æçš„è¯·æ±‚è¢«å‘å¾€ç½‘ç«™çš„ DNS åŸŸåè§£ææœåŠ¡å™¨ï¼›</li>
<li>ç”±äºç½‘ç«™çš„ DNS åŸŸåè§£ææœåŠ¡å™¨å¯¹æ­¤åŸŸåçš„è§£æè®¾ç½®äº† CNAMEï¼Œè¯·æ±‚è¢«æŒ‡å‘ CDN ç½‘ç»œä¸­çš„æ™ºèƒ½ DNS è´Ÿè½½å‡è¡¡ç³»ç»Ÿï¼›</li>
<li>æ™ºèƒ½ DNS è´Ÿè½½å‡è¡¡ç³»ç»Ÿå¯¹åŸŸåè¿›è¡Œæ™ºèƒ½è§£æï¼Œå°†å“åº”é€Ÿåº¦æœ€å¿«çš„èŠ‚ç‚¹ IP è¿”å›ç»™ç”¨æˆ·ï¼›æµè§ˆå™¨åœ¨å¾—åˆ°é€Ÿåº¦æœ€å¿«èŠ‚ç‚¹çš„ IP åœ°å€ä»¥åï¼Œå‘ CDN èŠ‚ç‚¹å‘å‡ºè®¿é—®è¯·æ±‚ï¼›</li>
<li>ç”±äºæ˜¯ç¬¬ä¸€æ¬¡è®¿é—®ï¼ŒCDN èŠ‚ç‚¹å°†å›åˆ°æºç«™å–ç”¨æˆ·è¯·æ±‚çš„æ•°æ®å¹¶å‘ç»™ç”¨æˆ·ï¼›</li>
<li>å½“æœ‰å…¶ä»–ç”¨æˆ·å†æ¬¡è®¿é—®åŒæ ·å†…å®¹æ—¶ï¼ŒCDN å°†ç›´æ¥å°†æ•°æ®è¿”å›ç»™å®¢æˆ·ï¼Œå®Œæˆè¯·æ±‚/æœåŠ¡è¿‡ç¨‹ã€‚</li>
</ol>
<p>åŒæ—¶ï¼Œå®ƒè¿˜ä¸åˆ†å¸ƒåœ¨ä¸åŒåœ°ç‚¹çš„æ‰€æœ‰ CDN èŠ‚ç‚¹ä¿æŒé€šä¿¡ï¼Œæœé›†å„èŠ‚ç‚¹çš„å¥åº·çŠ¶æ€ï¼Œç¡®ä¿ä¸å°†ç”¨æˆ·çš„è¯·æ±‚åˆ†é…åˆ°ä»»ä½•ä¸€ä¸ªå·²ç»ä¸å¯ç”¨çš„èŠ‚ç‚¹ä¸Šã€‚</p>
<blockquote>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://www.cnblogs.com/skynet/archive/2012/12/18/2824141.html" target="_blank" rel="noopener">CDN-å†…å®¹æ¨é€ç½‘ç»œ</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/39028766" target="_blank" rel="noopener">é—²è¯ CDN</a></li>
</ul>
</blockquote>
<h2 id="æ¨é€å’Œæ‹‰å–"><a class="markdownIt-Anchor" href="#æ¨é€å’Œæ‹‰å–"></a> æ¨é€å’Œæ‹‰å–</h2>
<p>CDN æœåŠ¡æœ‰æ¨é€å’Œæ‹‰å–ä¸¤ç§æ–¹å¼ï¼š</p>
<h3 id="cdn-æ¨é€"><a class="markdownIt-Anchor" href="#cdn-æ¨é€"></a> CDN æ¨é€</h3>
<p>å½“ä½ æœåŠ¡å™¨ä¸Šå†…å®¹å‘ç”Ÿå˜åŠ¨æ—¶ï¼Œæ¨é€ CDN æ¥å—æ–°å†…å®¹ã€‚ç›´æ¥æ¨é€ç»™ CDN å¹¶é‡å†™ URL åœ°å€ä»¥æŒ‡å‘ä½ çš„å†…å®¹çš„ CDN åœ°å€ã€‚ä½ å¯ä»¥é…ç½®å†…å®¹åˆ°æœŸæ—¶é—´åŠä½•æ—¶æ›´æ–°ã€‚å†…å®¹åªæœ‰åœ¨æ›´æ”¹æˆ–æ–°å¢æ˜¯æ‰æ¨é€ï¼Œæµé‡æœ€å°åŒ–ï¼Œä½†å‚¨å­˜æœ€å¤§åŒ–ã€‚</p>
<p>ä¼˜ç‚¹åœ¨äºèŠ‚çœæºç«™å¸¦å®½ï¼Œæå‰å°†è¦åˆ†å‘çš„å†…å®¹æ”¾åˆ° CDN èŠ‚ç‚¹ä¸Šäº†ï¼Œå½“æŸä¸ªæµé‡é«˜å³°æ¥ä¸´æ—¶ï¼Œä¸ä¼šæŠŠä½ çš„æºç«™å¸¦å®½å æ»¡ï¼ˆæºç«™è¿˜è¦ç•™ç‚¹å¸¦å®½æä¾›åŠ¨æ€ HTML å•Šï¼‰ã€‚</p>
<p>ç¼ºç‚¹æ˜¯éœ€è¦é’ˆå¯¹ CDN åšæ¥å£å¼€å‘ï¼Œåœ¨è¢«åˆ†å‘å†…å®¹ç”Ÿæˆæ—¶ä¸»åŠ¨ä¸Šä¼ ç»™ CDNã€‚</p>
<h3 id="cdn-æ‹‰å–"><a class="markdownIt-Anchor" href="#cdn-æ‹‰å–"></a> CDN æ‹‰å–</h3>
<p>CDN æ‹‰å–æ˜¯å½“ç¬¬ä¸€ä¸ªç”¨æˆ·è¯·æ±‚è¯¥èµ„æºæ—¶ï¼Œä»æœåŠ¡å™¨ä¸Šæ‹‰å–èµ„æºã€‚ä½ å°†å†…å®¹ç•™åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå¹¶é‡å†™ URL æŒ‡å‘ CDN åœ°å€ã€‚ç›´åˆ°å†…å®¹è¢«ç¼“å­˜åœ¨ CDN ä¸Šä¸ºæ­¢ï¼Œè¿™æ ·è¯·æ±‚åªä¼šæ›´æ…¢ï¼Œ</p>
<p><a href="https://en.wikipedia.org/wiki/Time_to_live" target="_blank" rel="noopener">å­˜æ´»æ—¶é—´ï¼ˆTTLï¼‰</a>å†³å®šç¼“å­˜å¤šä¹…æ—¶é—´ã€‚CDN æ‹‰å–æ–¹å¼æœ€å°åŒ– CDN ä¸Šçš„å‚¨å­˜ç©ºé—´ï¼Œä½†å¦‚æœè¿‡æœŸæ–‡ä»¶å¹¶åœ¨å®é™…æ›´æ”¹ä¹‹å‰è¢«æ‹‰å–ï¼Œåˆ™ä¼šå¯¼è‡´å†—ä½™çš„æµé‡ã€‚</p>
<p>é«˜æµé‡ç«™ç‚¹ä½¿ç”¨ CDN æ‹‰å–æ•ˆæœä¸é”™ï¼Œå› ä¸ºåªæœ‰æœ€è¿‘è¯·æ±‚çš„å†…å®¹ä¿å­˜åœ¨ CDN ä¸­ï¼Œæµé‡æ‰èƒ½æ›´å¹³è¡¡åœ°åˆ†æ•£ã€‚</p>
<p>ä¼˜ç‚¹åœ¨äºå®ç°ç®€å•ã€‚</p>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://segmentfault.com/q/1010000000119794" target="_blank" rel="noopener">æ¨é€å¼ä¸æ‹‰å–å¼ CDN æœåŠ¡çš„ä¼˜åŠ£é—®é¢˜</a></p>
</blockquote>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
<ul>
<li>æ–‡ç« 
<ul>
<li><a href="https://en.wikipedia.org/wiki/Content_delivery_network" target="_blank" rel="noopener">Wikipedia - CDN</a></li>
<li><a href="https://www.cnblogs.com/skynet/archive/2012/12/18/2824141.html" target="_blank" rel="noopener">CDN-å†…å®¹æ¨é€ç½‘ç»œ</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/39028766" target="_blank" rel="noopener">é—²è¯ CDN</a></li>
<li><a href="https://www.cnblogs.com/losbyday/p/5843960.html" target="_blank" rel="noopener">CDN æŠ€æœ¯è¯¦è§£</a></li>
<li><a href="https://segmentfault.com/q/1010000000119794" target="_blank" rel="noopener">æ¨é€å¼ä¸æ‹‰å–å¼ CDN æœåŠ¡çš„ä¼˜åŠ£é—®é¢˜</a></li>
</ul>
</li>
<li>CDN èµ„æº
<ul>
<li><a href="https://staticfile.org/" target="_blank" rel="noopener">https://staticfile.org/</a></li>
<li><a href="https://unpkg.com/" target="_blank" rel="noopener">https://unpkg.com/</a></li>
<li><a href="https://cdnjs.com/" target="_blank" rel="noopener">https://cdnjs.com/</a></li>
<li><a href="https://github.com/ossrs/srs" target="_blank" rel="noopener">https://github.com/ossrs/srs</a></li>
<li><a href="https://github.com/jsdelivr/jsdelivr" target="_blank" rel="noopener">https://github.com/jsdelivr/jsdelivr</a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>Mac å¸¸ç”¨æŠ€å·§æ€»ç»“</title>
    <url>/blog/os/mac/</url>
    <content><![CDATA[<h2 id="åŸºæœ¬æ“ä½œ"><a class="markdownIt-Anchor" href="#åŸºæœ¬æ“ä½œ"></a> åŸºæœ¬æ“ä½œ</h2>
<h3 id="è½¯ä»¶ç®¡ç†"><a class="markdownIt-Anchor" href="#è½¯ä»¶ç®¡ç†"></a> è½¯ä»¶ç®¡ç†</h3>
<p>dmg æ ¼å¼ï¼šåŒå‡»å®‰è£…åŒ…ï¼Œç„¶åæ‹–åˆ° applications æ–‡ä»¶å¤¹ä¸‹å³å¯ã€‚</p>
<h3 id="æµè§ˆå™¨"><a class="markdownIt-Anchor" href="#æµè§ˆå™¨"></a> æµè§ˆå™¨</h3>
<h4 id="æ›´æ”¹é»˜è®¤æœç´¢å¼•æ“"><a class="markdownIt-Anchor" href="#æ›´æ”¹é»˜è®¤æœç´¢å¼•æ“"></a> æ›´æ”¹é»˜è®¤æœç´¢å¼•æ“</h4>
<p>é€‰æ‹©ã€Œåå¥½è®¾ç½®â€“&gt;æœç´¢â€“&gt;æœç´¢å¼•æ“â€“&gt;Googleã€ã€‚</p>
<h4 id="å¯¼å…¥-chrome-æµè§ˆå™¨çš„ä¹¦ç­¾"><a class="markdownIt-Anchor" href="#å¯¼å…¥-chrome-æµè§ˆå™¨çš„ä¹¦ç­¾"></a> å¯¼å…¥ chrome æµè§ˆå™¨çš„ä¹¦ç­¾</h4>
<p>é€‰æ‹©ã€Œæ–‡ä»¶â€“&gt;å¯¼å…¥è‡ªâ€“&gt; Google Chromeã€ï¼Œç„¶åé€‰æ‹©è¦å¯¼å…¥çš„é¡¹ç›®ã€‚</p>
<h4 id="å¿«æ·é”®"><a class="markdownIt-Anchor" href="#å¿«æ·é”®"></a> å¿«æ·é”®</h4>
<p>Command + R åˆ·æ–°</p>
<h4 id="ä¸Šæ–¹æ˜¾ç¤ºä¹¦ç­¾æ æ”¶è—æ "><a class="markdownIt-Anchor" href="#ä¸Šæ–¹æ˜¾ç¤ºä¹¦ç­¾æ æ”¶è—æ "></a> ä¸Šæ–¹æ˜¾ç¤ºä¹¦ç­¾æ ï¼æ”¶è—æ </h4>
<p>é€‰æ‹©ã€Œæ˜¾ç¤ºâ€“&gt; æ˜¾ç¤ºä¸ªäººæ”¶è—æ ã€ã€‚</p>
<h4 id="å…³é—­è½¯ä»¶çš„å³ä¸Šè§’é€šçŸ¥"><a class="markdownIt-Anchor" href="#å…³é—­è½¯ä»¶çš„å³ä¸Šè§’é€šçŸ¥"></a> å…³é—­è½¯ä»¶çš„å³ä¸Šè§’é€šçŸ¥</h4>
<p>åœ¨ Mac ç³»ç»Ÿä¸­æœ‰å¯¹é€šçŸ¥çš„è®¾ç½®ï¼Œæ‰“å¼€ç³»ç»Ÿåå¥½è®¾ç½® â€” é€šçŸ¥ æ‰¾åˆ° QQï¼Œç„¶åå°† QQ æç¤ºæ ·å¼è®¾ç½®æˆæ— å³å¯ã€‚</p>
<h4 id="å¤åˆ¶æ–‡ä»¶æ–‡ä»¶å¤¹è·¯å¾„"><a class="markdownIt-Anchor" href="#å¤åˆ¶æ–‡ä»¶æ–‡ä»¶å¤¹è·¯å¾„"></a> å¤åˆ¶æ–‡ä»¶/æ–‡ä»¶å¤¹è·¯å¾„</h4>
<ul>
<li>OS X 10.11 ç³»ç»Ÿï¼Œé€‰ä¸­æ–‡ä»¶å¤¹ï¼Œã€Œcmd +Option +cã€ å¤åˆ¶æ–‡ä»¶å¤¹è·¯å¾„ï¼Œcmd+v ç²˜è´´ã€‚<br />
ä¹‹å‰çš„ç³»ç»Ÿï¼Œåˆ©ç”¨ Administrator åˆ›å»ºä¸€ä¸ªåˆ°å³é”®èœå•ï¼Œç„¶ååˆ°è®¾ç½®é‡Œé¢è®¾ç½®å¿«æ·é”®ã€‚å…·ä½“æ“ä½œè¯·ç™¾åº¦ã€‚</li>
</ul>
<h4 id="æ‰“å¼€æ¥è‡ªèº«ä»½ä¸æ˜çš„å¼€å‘è€…çš„åº”ç”¨ç¨‹åº"><a class="markdownIt-Anchor" href="#æ‰“å¼€æ¥è‡ªèº«ä»½ä¸æ˜çš„å¼€å‘è€…çš„åº”ç”¨ç¨‹åº"></a> æ‰“å¼€æ¥è‡ªèº«ä»½ä¸æ˜çš„å¼€å‘è€…çš„åº”ç”¨ç¨‹åº</h4>
<p>åœ¨åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹ï¼ŒæŒ‰ä½ control é”®çš„åŒæ—¶æ‰“å¼€åº”ç”¨ç¨‹åºã€‚</p>
<h4 id="å¤åˆ¶æ–‡ä»¶è·¯å¾„"><a class="markdownIt-Anchor" href="#å¤åˆ¶æ–‡ä»¶è·¯å¾„"></a> å¤åˆ¶æ–‡ä»¶è·¯å¾„</h4>
<ul>
<li>
<p>é€‰æ‹©æ–‡ä»¶ï¼æ–‡ä»¶å¤¹æŒ‰ Command+C å¤åˆ¶ï¼Œåœ¨ç»ˆç«¯ä¸­ Command+V ç²˜è´´å³å¯ã€‚</p>
</li>
<li>
<p>å¦‚æœåªæ˜¯æƒ³åœ¨ Finder ä¸­çœ‹åˆ°æ–‡ä»¶çš„è·¯å¾„, å¹¶æ–¹ä¾¿åˆ‡æ¢å±‚çº§, Finder å†…ç½®äº†ã€Œæ˜¾ç¤ºè·¯å¾„æ ã€çš„åŠŸèƒ½, å¹¶é…ç½®äº†å¿«æ·é”®(Option+Cmd+P). å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
</li>
</ul>
<p>20161124-184148.png</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li>[<a href="https://www.zhihu.com/question/22883229" target="_blank" rel="noopener">https://www.zhihu.com/question/22883229</a>]</li>
</ul>
<h3 id="éšè—å’Œå–æ¶ˆéšè—-mac-app-store-ä¸­çš„å·²è´­é¡¹ç›®"><a class="markdownIt-Anchor" href="#éšè—å’Œå–æ¶ˆéšè—-mac-app-store-ä¸­çš„å·²è´­é¡¹ç›®"></a> éšè—å’Œå–æ¶ˆéšè— Mac App Store ä¸­çš„å·²è´­é¡¹ç›®</h3>
<h3 id="mac-åŒæ—¶ç™»é™†ä¸¤ä¸ª-qq"><a class="markdownIt-Anchor" href="#mac-åŒæ—¶ç™»é™†ä¸¤ä¸ª-qq"></a> Mac åŒæ—¶ç™»é™†ä¸¤ä¸ª QQ</h3>
<p>åœ¨å·²ç»æ‰“å¼€çš„ QQ ä¸­ï¼ŒæŒ‰ä½ã€Œcommand + Nã€å³å¯ã€‚</p>
<h2 id="ç³»ç»Ÿä¾¿å¥½è®¾ç½®"><a class="markdownIt-Anchor" href="#ç³»ç»Ÿä¾¿å¥½è®¾ç½®"></a> ç³»ç»Ÿä¾¿å¥½è®¾ç½®</h2>
<h3 id="è¯­éŸ³æ’­æŠ¥"><a class="markdownIt-Anchor" href="#è¯­éŸ³æ’­æŠ¥"></a> è¯­éŸ³æ’­æŠ¥</h3>
<p>æ‰“å¼€ã€Œç³»ç»Ÿä¾¿å¥½è®¾ç½®â€“&gt;è¾…åŠ©åŠŸèƒ½â€“&gt;è¯­éŸ³ã€ï¼Œå³å¯è®¾ç½®ä¸åŒå›½å®¶çš„è¯­è¨€ã€‚</p>
<p>å‹¾é€‰ä¸Šå›¾ä¸­çš„çº¢æ¡†éƒ¨åˆ†ï¼Œå¯ä»¥è®¾ç½®å…¨å±€å¿«æ·é”®ã€‚è¿™æ ·çš„è¯ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªè½¯ä»¶å½“ä¸­ï¼ŒæŒ‰ä¸‹ã€Œ option+escã€æ—¶ï¼Œå°±ä¼šæœ—è¯»é€‰ä¸­çš„æ–‡æœ¬ã€‚</p>
<h3 id="è°ƒæ•´å­—ä½“å¤§å°"><a class="markdownIt-Anchor" href="#è°ƒæ•´å­—ä½“å¤§å°"></a> è°ƒæ•´å­—ä½“å¤§å°</h3>
<p>Mac è°ƒæ•´å­—ä½“å¤§å°ï¼šã€Œç³»ç»Ÿåå¥½è®¾ç½® -&gt; æ˜¾ç¤ºå™¨ -&gt; ç¼©æ”¾ã€ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<h3 id="å¦‚ä½•åˆ†åˆ«è®¾ç½®-mac-çš„é¼ æ ‡å’Œè§¦æ§æ¿çš„æ»šåŠ¨æ–¹å‘"><a class="markdownIt-Anchor" href="#å¦‚ä½•åˆ†åˆ«è®¾ç½®-mac-çš„é¼ æ ‡å’Œè§¦æ§æ¿çš„æ»šåŠ¨æ–¹å‘"></a> å¦‚ä½•åˆ†åˆ«è®¾ç½® Mac çš„é¼ æ ‡å’Œè§¦æ§æ¿çš„æ»šåŠ¨æ–¹å‘</h3>
<p>å¾ˆå¤šäººä¹ æƒ¯é¼ æ ‡ä½¿ç”¨ç›¸åçš„æ»šåŠ¨æ–¹å‘ï¼Œè€Œè§¦æ§æ¿ç±»ä¼¼ iPad é‚£æ ·çš„è‡ªç„¶æ»šåŠ¨ï¼Œé—®å¦‚ä½•è®¾ç½®ï¼Œå½“æ—¶æˆ‘çš„å›ç­”æ˜¯ä¸çŸ¥é“ï¼Œå› ä¸ºç›®å‰ OS X çš„ç³»ç»Ÿè®¾ç½®é‡Œï¼Œé¼ æ ‡å’Œè§¦æ§æ¿çš„è®¾ç½®æ˜¯ç»Ÿä¸€<br />
çš„ã€‚ä»Šå¤©å‘ç°äº†ä¸€ä¸ªå…è´¹çš„è½¯ä»¶ Scroll Reverserï¼Œå¯ä»¥å®ç°é¼ æ ‡å’Œè§¦æ§æ¿çš„åˆ†åˆ«è®¾ç½®ã€‚ä¸‹è½½åœ°å€ï¼š<a href="https://pilotmoon.com/scrollreverser/" target="_blank" rel="noopener">https://pilotmoon.com/scrollreverser/</a><br />
å¯åŠ¨åç¨‹åºæ˜¾ç¤ºåœ¨é¡¶éƒ¨èœå•æ ï¼Œè®¾ç½®ç®€å•æ˜äº†ï¼Œæœ‰éœ€è¦çš„ç”¨æˆ·ä½“éªŒä¸€ä¸‹å§ã€‚</p>
<h3 id="touch-bar-è‡ªå®šä¹‰"><a class="markdownIt-Anchor" href="#touch-bar-è‡ªå®šä¹‰"></a> Touch Bar è‡ªå®šä¹‰</h3>
<p>æ‰“å¼€ã€Œç³»ç»Ÿåå¥½è®¾ç½®-é”®ç›˜ã€ï¼Œä¸‹é¢æœ‰ä¸ªè‡ªå®šä¹‰æ§åˆ¶æ¡ã€‚</p>
<h3 id="è‰²æ¸©è°ƒèŠ‚å¤œé—´æ¨¡å¼"><a class="markdownIt-Anchor" href="#è‰²æ¸©è°ƒèŠ‚å¤œé—´æ¨¡å¼"></a> è‰²æ¸©è°ƒèŠ‚ï¼šå¤œé—´æ¨¡å¼</h3>
<p>iOS9.3 çš„æœ€æ˜æ˜¾å˜åŒ–ï¼Œè«è¿‡äºè‹¹æœåœ¨å‘å¸ƒä¼šä¸Šç‰¹æ„æåˆ°çš„ Night Shift å¤œé—´æŠ¤çœ¼æ¨¡å¼ã€‚</p>
<h3 id="icloud-é‚®ç®±"><a class="markdownIt-Anchor" href="#icloud-é‚®ç®±"></a> iCloud é‚®ç®±</h3>
<p>å¦‚æœæ‚¨ç”¨äºè®¾ç½® iCloud çš„ Apple ID ä¸ä»¥â€œ@icloud.comâ€ã€â€œ@me.comâ€æˆ–â€œ@mac.comâ€ç»“å°¾ï¼Œæ‚¨å¿…é¡»å…ˆè®¾ç½®ä¸€ä¸ªâ€œ@icloud.comâ€ç”µå­é‚®ä»¶åœ°å€ï¼Œç„¶åæ‰èƒ½ä½¿ç”¨ iCloudâ€œé‚®ä»¶â€ã€‚</p>
<p>å¦‚æœæ‚¨æ‹¥æœ‰ä»¥â€œ@mac.comâ€æˆ–â€œ@me.comâ€ç»“å°¾çš„ç”µå­é‚®ä»¶åœ°å€ï¼Œåˆ™æ‚¨å·²ç»æ‹¥æœ‰äº†åç§°ç›¸åŒä½†ä»¥â€œ@icloud.comâ€ç»“å°¾çš„ç­‰æ•ˆåœ°å€ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„ç”µå­é‚®ä»¶åˆ«åä»¥â€œ@mac.comâ€æˆ–â€œ@me.comâ€ç»“å°¾ï¼Œæ‚¨ä¹Ÿå°†æ‹¥æœ‰ä»¥â€œ@icloud.comâ€ç»“å°¾çš„ç­‰æ•ˆåœ°å€ã€‚</p>
<p><strong>æ“ä½œå¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>
<p>åœ¨ iOS è®¾å¤‡ä¸Šï¼Œå‰å¾€â€œè®¾ç½®â€&gt;â€œiCloudâ€ï¼Œå¼€å¯â€œé‚®ä»¶â€ï¼Œç„¶åæŒ‰ç…§å±å¹•ä¸Šçš„è¯´æ˜æ“ä½œã€‚</p>
</li>
<li>
<p>åœ¨ Mac ä¸Šï¼Œé€‰å– Apple èœå• &gt;â€œç³»ç»Ÿåå¥½è®¾ç½®â€ï¼Œç‚¹æŒ‰â€œiCloudâ€ï¼Œå†é€‰æ‹©â€œé‚®ä»¶â€ï¼Œç„¶åæŒ‰ç…§å±å¹•ä¸Šçš„è¯´æ˜æ“ä½œã€‚</p>
</li>
</ul>
<p>PSï¼šåˆ›å»º iCloud ç”µå­é‚®ä»¶åœ°å€åï¼Œæ‚¨æ— æ³•å¯¹å…¶è¿›è¡Œæ›´æ”¹ã€‚</p>
<p>è®¾ç½® @icloud.com ç”µå­é‚®ä»¶åœ°å€åå³å¯ç”¨å…¶ç™»å½• iCloudã€‚æ‚¨ä¹Ÿå¯ä»¥ç”¨åˆ›å»º iCloud å¸æˆ·æ—¶æ‰€ç”¨çš„ Apple ID ç™»å½•ã€‚</p>
<p>æ‚¨å¯ä»¥ä»ä»¥ä¸‹ä»»æ„åœ°å€å‘é€ iCloud ç”µå­é‚®ä»¶ï¼š</p>
<p>æ‚¨çš„ iCloud ç”µå­é‚®ä»¶åœ°å€ï¼ˆæ‚¨çš„å¸å·åç§°@icloud.comï¼‰</p>
<p>åˆ«å</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><strong>ç›´æ¥æ³¨å†Œä»¥@icloud.com ç»“å°¾çš„ Apple IDï¼š</strong></p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<h2 id="podcast"><a class="markdownIt-Anchor" href="#podcast"></a> PodCast</h2>
<p>PodCast ä¸­æ–‡ç¿»è¯‘ä¸ºæ’­å®¢ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„éŸ³é¢‘ or è§†é¢‘èŠ‚ç›®ã€‚PodCast è¿™ä¸ªå•è¯æ˜¯ç”± iPod+Broadcast è¿™ä¸¤ä¸ªå•è¯ç»„æˆçš„ã€‚</p>
<p>PodCast å¯ä»¥åœ¨ iTunes ä¸­æ”¶å¬ã€‚</p>
<h2 id="others"><a class="markdownIt-Anchor" href="#others"></a> others</h2>
<h3 id="è¯å…¸"><a class="markdownIt-Anchor" href="#è¯å…¸"></a> è¯å…¸</h3>
<p>ç³»ç»Ÿæœ‰ä¸€ä¸ªè‡ªå¸¦åº”ç”¨ã€Œè¯å…¸ã€ï¼Œå¯ä»¥è¿›è¡Œå•è¯çš„æŸ¥è¯¢ã€‚</p>
<h3 id="å¦‚ä½•è§£å†³-mac-è½¯ä»¶dmgakpappå‡ºç°ç¨‹åºå·²æŸåçš„æç¤º"><a class="markdownIt-Anchor" href="#å¦‚ä½•è§£å†³-mac-è½¯ä»¶dmgakpappå‡ºç°ç¨‹åºå·²æŸåçš„æç¤º"></a> å¦‚ä½•è§£å†³ MAC è½¯ä»¶ï¼ˆdmgï¼Œakpï¼Œappï¼‰å‡ºç°ç¨‹åºå·²æŸåçš„æç¤º</h3>
<p>ã€Œxxx.app å·²æŸå,æ‰“ä¸å¼€.ä½ åº”è¯¥å°†å®ƒç§»åˆ°åºŸçº¸ç¯“ã€ï¼Œå¹¶éä½ å®‰è£…çš„è½¯ä»¶å·²æŸåï¼Œè€Œæ˜¯ Mac ç³»ç»Ÿçš„å®‰å…¨è®¾ç½®é—®é¢˜ï¼Œå› ä¸ºè¿™äº›åº”ç”¨éƒ½æ˜¯ç ´è§£æˆ–è€…æ±‰åŒ–çš„,é‚£ä¹ˆè§£å†³æ–¹æ³•å°±æ˜¯ä¸´æ—¶æ”¹å˜ Mac ç³»ç»Ÿå®‰å…¨è®¾ç½®ã€‚</p>
<p>å‡ºç°è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ³•ï¼šä¿®æ”¹ç³»ç»Ÿé…ç½®ï¼šç³»ç»Ÿåå¥½è®¾ç½®â€¦ -&gt; å®‰å…¨æ€§ä¸éšç§ã€‚ä¿®æ”¹ä¸ºä»»ä½•æ¥æºã€‚</p>
<p>å¦‚æœæ²¡æœ‰è¿™ä¸ªé€‰é¡¹çš„è¯ï¼ˆmacOS Sierra 10.12ï¼‰,æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo spctl --master-disable</span><br></pre></td></tr></table></figure>
<p>å³å¯ã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li>
<p><a href="http://www.jianshu.com/p/379b49b88df9" target="_blank" rel="noopener">Max OS-[xxx.app å·²æŸå,æ‰“ä¸å¼€.ä½ åº”è¯¥å°†å®ƒç§»åˆ°åºŸçº¸ç¯“]</a></p>
</li>
<li>
<p><a href="http://www.yunrui.co/25693.html" target="_blank" rel="noopener">å¦‚ä½•è§£å†³ MAC è½¯ä»¶ï¼ˆdmgï¼Œakpï¼Œappï¼‰å‡ºç°ç¨‹åºå·²æŸåçš„æç¤º</a></p>
</li>
</ul>
<p>å¤‡æ³¨ï¼šè¿™ä¸ªé“¾æ¥é‡Œçš„å„ç§èµ„æºéƒ½å¾ˆä¸é”™å•Šã€‚</p>
<h4 id="ç»ˆç«¯"><a class="markdownIt-Anchor" href="#ç»ˆç«¯"></a> ç»ˆç«¯</h4>
<h4 id="åœ¨-finder-çš„å½“å‰ç›®å½•æ‰“å¼€ç»ˆç«¯"><a class="markdownIt-Anchor" href="#åœ¨-finder-çš„å½“å‰ç›®å½•æ‰“å¼€ç»ˆç«¯"></a> åœ¨ Finder çš„å½“å‰ç›®å½•æ‰“å¼€ç»ˆç«¯</h4>
<p>åœ¨ Finder æ‰“å¼€ terminal ç»ˆç«¯è¿™ä¸ªåŠŸèƒ½å…¶å®æ˜¯æœ‰çš„ï¼Œä½†æ˜¯ç³»ç»Ÿé»˜è®¤æ²¡æœ‰æ‰“å¼€ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•å°†å…¶æ‰“å¼€ï¼š</p>
<p>è¿›å…¥ç³»ç»Ÿåå¥½è®¾ç½®-&gt;é”®ç›˜-&gt;å¿«æ·é”®-&gt;æœåŠ¡ã€‚</p>
<p>åœ¨å³è¾¹æ–°å»ºä½äºæ–‡ä»¶å¤¹ä½ç½®çš„ç»ˆç«¯çª—å£ä¸Šæ‰“å‹¾ã€‚</p>
<p>å¦‚æ­¤è®¾ç½®åï¼Œåœ¨ Finder ä¸­å³å‡»æŸæ–‡ä»¶ï¼Œåœ¨å‡ºç°çš„èœå•ä¸­æ‰¾åˆ°æœåŠ¡ï¼Œç„¶åç‚¹å‡»æ–°å»ºä½äºæ–‡ä»¶å¤¹ä½ç½®çš„ç»ˆç«¯çª—å£å³å¯ï¼</p>
<h2 id="mac-å¸¸ç”¨å¿«æ·é”®"><a class="markdownIt-Anchor" href="#mac-å¸¸ç”¨å¿«æ·é”®"></a> Mac å¸¸ç”¨å¿«æ·é”®</h2>
<h3 id="finder"><a class="markdownIt-Anchor" href="#finder"></a> Finder</h3>
<table>
<thead>
<tr>
<th style="text-align:left">å¿«æ·é”®</th>
<th style="text-align:left">ä½œç”¨</th>
<th style="text-align:left">å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Shift + Command + G</td>
<td style="text-align:left">å‰å¾€æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å¤¹</td>
<td style="text-align:left">åŒ…æ‹¬éšè—æ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td style="text-align:left">Shift + Command + .</td>
<td style="text-align:left">æ˜¾ç¤ºéšè—æ–‡ä»¶ã€æ–‡ä»¶å¤¹</td>
<td style="text-align:left">å†æŒ‰ä¸€æ¬¡ï¼Œæ¢å¤éšè—</td>
</tr>
<tr>
<td style="text-align:left">Command + â†‘</td>
<td style="text-align:left">è¿”å›ä¸Šä¸€å±‚</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Command + â†“</td>
<td style="text-align:left">è¿›å…¥å½“å‰æ–‡ä»¶å¤¹</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h3 id="ç¼–è¾‘"><a class="markdownIt-Anchor" href="#ç¼–è¾‘"></a> ç¼–è¾‘</h3>
<p><strong>åˆ é™¤æ–‡å­—</strong>ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">å¿«æ·é”®</th>
<th style="text-align:left">ä½œç”¨</th>
<th style="text-align:left">å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">delete</td>
<td style="text-align:left">åˆ é™¤å…‰æ ‡çš„å‰ä¸€ä¸ªå­—ç¬¦</td>
<td style="text-align:left">ç›¸å½“äº Windows é”®ç›˜ä¸Šçš„é€€æ ¼é”®</td>
</tr>
<tr>
<td style="text-align:left">fn + delete</td>
<td style="text-align:left">åˆ é™¤å…‰æ ‡çš„åä¸€ä¸ªå­—ç¬¦</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">option + delete</td>
<td style="text-align:left">åˆ é™¤å…‰æ ‡ä¹‹å‰çš„ä¸€ä¸ªå•è¯</td>
<td style="text-align:left">è‹±æ–‡æœ‰æ•ˆ</td>
</tr>
<tr>
<td style="text-align:left"><strong>command + delete</strong></td>
<td style="text-align:left">åˆ é™¤å…‰æ ‡ä¹‹å‰çš„æ•´è¡Œå†…å®¹</td>
<td style="text-align:left">ã€èã€‘</td>
</tr>
<tr>
<td style="text-align:left">command + delete</td>
<td style="text-align:left">åœ¨ finder ä¸­åˆ æ‰è¯¥æ–‡ä»¶</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">shift + command + delete</td>
<td style="text-align:left">æ¸…ç©ºå›æ”¶ç«™</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<p><strong>å‰ªåˆ‡æ–‡ä»¶</strong>ï¼š</p>
<p>é¦–å…ˆé€‰ä¸­æ–‡ä»¶ï¼ŒæŒ‰ Command+C å¤åˆ¶æ–‡ä»¶ï¼›ç„¶åæŒ‰ã€ŒCommand ï¼‹ Option ï¼‹ Vã€å‰ªåˆ‡æ–‡ä»¶ã€‚</p>
<p>å¤‡æ³¨ï¼šCommand+X åªèƒ½å‰ªåˆ‡æ–‡å­—æ–‡æœ¬ï¼Œä¸è¦æ··æ·†äº†ã€‚</p>
<h2 id="mac-ç”¨æˆ·å¿…é¡»çŸ¥é“çš„-15-ç»„å¿«æ·é”®"><a class="markdownIt-Anchor" href="#mac-ç”¨æˆ·å¿…é¡»çŸ¥é“çš„-15-ç»„å¿«æ·é”®"></a> Mac ç”¨æˆ·å¿…é¡»çŸ¥é“çš„ 15 ç»„å¿«æ·é”®</h2>
<blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="http://v.youku.com/v_show/id_XNDE4MzM0NDgw.html" target="_blank" rel="noopener">ã€Šè½»æ¾ç© Macã€‹ç¬¬ 6 æœŸï¼šMac ç”¨æˆ·å¿…é¡»çŸ¥é“çš„ 15 ç»„å¿«æ·é”®</a></p>
</blockquote>
<h3 id="spaceé”®å¿«é€Ÿé¢„è§ˆ"><a class="markdownIt-Anchor" href="#spaceé”®å¿«é€Ÿé¢„è§ˆ"></a> ã€Œspaceã€é”®ï¼šå¿«é€Ÿé¢„è§ˆ</h3>
<p>é€‰ä¸­æ–‡ä»¶åï¼Œ ä¸éœ€è¦å¯åŠ¨ä»»ä½•åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨ã€Œspaceã€ç©ºæ ¼é”®å¯è¿›è¡Œå¿«é€Ÿé¢„è§ˆï¼Œå†æ¬¡æŒ‰ä¸‹ã€Œspaceã€ç©ºæ ¼é”®å–æ¶ˆé¢„è§ˆã€‚</p>
<p>å¯ä»¥é¢„è§ˆ mp3ã€è§†é¢‘ã€pdf ç­‰æ–‡ä»¶ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥<strong>é€‰ä¸­å¤šå¼ å›¾ç‰‡</strong>ï¼Œ ç„¶åæŒ‰ã€Œspaceã€é”®ï¼Œå°±å¯ä»¥åŒæ—¶å¯¹æ¯”é¢„è§ˆå¤šå¼ å›¾ç‰‡ã€‚è¿™ä¸€ç‚¹ï¼Œå¾ˆèµã€‚</p>
<h3 id="æ”¹å"><a class="markdownIt-Anchor" href="#æ”¹å"></a> æ”¹å</h3>
<p>é€‰ä¸­æ–‡ä»¶/æ–‡ä»¶å¤¹åï¼ŒæŒ‰ enter é”®ï¼Œå°±å¯ä»¥æ”¹åäº†ã€‚</p>
<h3 id="command-ié”®æŸ¥çœ‹æ–‡ä»¶å±æ€§"><a class="markdownIt-Anchor" href="#command-ié”®æŸ¥çœ‹æ–‡ä»¶å±æ€§"></a> ã€Œcommand + Iã€é”®ï¼šæŸ¥çœ‹æ–‡ä»¶å±æ€§</h3>
<ul>
<li>
<p>é€‰ä¸­æ–‡ä»¶åï¼ŒæŒ‰ã€Œcommand + Iã€é”®ï¼Œå¯ä»¥æŸ¥çœ‹æ–‡ä»¶çš„å„ç§å±æ€§ã€‚</p>
</li>
<li>
<p>é€‰ä¸­<strong>æ–‡ä»¶å¤¹</strong>åï¼ŒæŒ‰ã€Œcommand + Iã€é”®ï¼Œå¯ä»¥æŸ¥çœ‹æ–‡ä»¶å¤¹çš„å¤§å°ã€‚ã€èã€‘</p>
</li>
</ul>
<h3 id="åˆ‡æ¢è¾“å…¥æ³•"><a class="markdownIt-Anchor" href="#åˆ‡æ¢è¾“å…¥æ³•"></a> åˆ‡æ¢è¾“å…¥æ³•</h3>
<p>ã€Œcontrol + spaceã€</p>
<h3 id="æ‰“å¼€-spotlight-æœç´¢æ¡†"><a class="markdownIt-Anchor" href="#æ‰“å¼€-spotlight-æœç´¢æ¡†"></a> æ‰“å¼€ spotlight æœç´¢æ¡†</h3>
<p>spotlight æ˜¯ç³»ç»Ÿè‡ªå¸¦çš„è½¯ä»¶ï¼Œæœç´¢åŠŸèƒ½ä¸æ˜¯å¾ˆå¼ºå¤§ã€‚æˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šç”¨ç¬¬ä¸‰æ–¹çš„ Alfred è½¯ä»¶ã€‚</p>
<h3 id="ç¼–è¾‘ç›¸å…³"><a class="markdownIt-Anchor" href="#ç¼–è¾‘ç›¸å…³"></a> ç¼–è¾‘ç›¸å…³</h3>
<p>Cmd+Cã€Cmd+Vã€Cmd+Xã€Cmd+Aã€Cmd+Zã€‚</p>
<h3 id="ç¿»é¡µå’Œå…‰æ ‡"><a class="markdownIt-Anchor" href="#ç¿»é¡µå’Œå…‰æ ‡"></a> ç¿»é¡µå’Œå…‰æ ‡</h3>
<ul>
<li>
<p>ã€Œcontrol + â†‘ã€ï¼šå°†å…‰æ ‡å®šä½åˆ°æ–‡ç« çš„æœ€å¼€å¤´ï¼ˆç¿»é¡µåˆ°æ–‡æ¡£çš„æœ€ä¸Šæ–¹ï¼‰</p>
</li>
<li>
<p>ã€Œcontrol + â†“ã€ï¼šå°†å…‰æ ‡å®šä½åˆ°æ–‡ç« çš„æœ€æœ«å°¾ï¼ˆç¿»é¡µåˆ°æ–‡æ¡£çš„æœ€ä¸‹æ–¹ï¼‰</p>
</li>
<li>
<p>ã€Œcontrol + â†ã€ï¼šå°†å…‰æ ‡å®šä½åˆ°å½“å‰è¡Œçš„æœ€å·¦ä¾§</p>
</li>
<li>
<p>ã€Œcontrol + â†’ã€ï¼šå°†å…‰æ ‡å®šä½åˆ°å½“å‰è¡Œçš„æœ€å³ä¾§</p>
</li>
</ul>
<h3 id="command-shift-yå°†æ–‡å­—å¿«é€Ÿä¿å­˜åˆ°ä¾¿ç¬º"><a class="markdownIt-Anchor" href="#command-shift-yå°†æ–‡å­—å¿«é€Ÿä¿å­˜åˆ°ä¾¿ç¬º"></a> ã€Œcommand + shift + Yã€ï¼šå°†æ–‡å­—å¿«é€Ÿä¿å­˜åˆ°ä¾¿ç¬º</h3>
<p>é€‰ä¸­ä½ æƒ³è¦çš„å†…å®¹ï¼ˆä¾‹å¦‚æ–‡å­—ã€é“¾æ¥ç­‰ï¼‰ï¼Œç„¶åæŒ‰ä¸‹ command + shift + Yã€ï¼Œé‚£ä¹ˆä½ é€‰ä¸­çš„å†…å®¹å°±ä¼šå¿«é€Ÿä¿å­˜åˆ°ç³»ç»Ÿè‡ªå¸¦çš„ã€Œä¾¿ç¬ºã€è½¯ä»¶ä¸­ã€‚</p>
<p>å¦‚æœä½ æƒ³ä¸´æ—¶æ€§çš„ä¿å­˜ä¸€æ®µå†…å®¹ï¼Œè¿™ä¸ªæ“ä½œå¾ˆå®ç”¨ã€‚</p>
<h3 id="ç¨‹åºç›¸å…³"><a class="markdownIt-Anchor" href="#ç¨‹åºç›¸å…³"></a> ç¨‹åºç›¸å…³</h3>
<ul>
<li>
<p>ã€Œcommand + Qã€ï¼šå¿«é€Ÿé€€å‡ºç¨‹åº</p>
</li>
<li>
<p>ã€Œcommand + tabã€ï¼šåˆ‡æ¢ç¨‹åº</p>
</li>
<li>
<p>ã€Œcommand + Hã€ï¼šéšè—å½“å‰åº”ç”¨ç¨‹åºã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„å¿«æ·é”®ã€‚</p>
</li>
<li>
<p>ã€Œcommand + ï¼Œã€ï¼šæ‰“å¼€å½“å‰åº”ç”¨ç¨‹åºçš„ã€Œåå¥½è®¾ç½®ã€ã€‚</p>
</li>
</ul>
<h3 id="çª—å£ç›¸å…³"><a class="markdownIt-Anchor" href="#çª—å£ç›¸å…³"></a> çª—å£ç›¸å…³</h3>
<ul>
<li>
<p>ã€Œcommand + Nã€ï¼šæ–°å»ºä¸€ä¸ªå½“å‰åº”ç”¨ç¨‹åºçš„çª—å£</p>
</li>
<li>
<p>ã€Œcommand + `ã€ï¼šåœ¨å½“å‰åº”ç”¨ç¨‹åºçš„ä¸åŒçª—å£ä¹‹é—´åˆ‡æ¢ã€å¾ˆå®ç”¨ã€‘</p>
</li>
</ul>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œã€Œcommand + tabã€æ˜¯åœ¨ä¸åŒçš„è½¯ä»¶ä¹‹é—´åˆ‡æ¢ã€‚ä½†ä½ ä¸çŸ¥é“çš„æ˜¯ï¼Œã€Œcommand + `ã€æ˜¯åœ¨åŒä¸€ä¸ªè½¯ä»¶çš„ä¸åŒçª—å£ä¹‹é—´åˆ‡æ¢ã€‚</p>
<ul>
<li>
<p>ã€Œcommand + Mã€ï¼šå°†å½“å‰çª—å£æœ€å°åŒ–</p>
</li>
<li>
<p>ã€Œcommand + Wã€ï¼šå…³é—­å½“å‰çª—å£</p>
</li>
</ul>
<h3 id="æµè§ˆå™¨ç›¸å…³"><a class="markdownIt-Anchor" href="#æµè§ˆå™¨ç›¸å…³"></a> æµè§ˆå™¨ç›¸å…³</h3>
<ul>
<li>
<p>ã€Œcommand + Tã€ï¼šæµè§ˆå™¨ä¸­ï¼Œæ–°å»ºä¸€ä¸ªæ ‡ç­¾</p>
</li>
<li>
<p>ã€Œcommand + Wã€ï¼šå…³é—­å½“å‰æ ‡ç­¾</p>
</li>
</ul>
<ul>
<li>ã€Œcommand + Rã€ï¼šå¼ºåˆ¶åˆ·æ–°ã€‚</li>
</ul>
<ul>
<li>ã€Œcommand + Lã€ï¼šå®šä½åˆ°åœ°å€æ ã€‚ã€é‡è¦ã€‘</li>
</ul>
<h3 id="æˆªå›¾ç›¸å…³"><a class="markdownIt-Anchor" href="#æˆªå›¾ç›¸å…³"></a> æˆªå›¾ç›¸å…³</h3>
<ul>
<li>ã€Œcommand + shift + 3ã€ï¼šæˆªå…¨å±ï¼ˆå¯¹æ•´ä¸ªå±å¹•æˆªå›¾ï¼‰ã€‚</li>
</ul>
<h3 id="å£°éŸ³ç›¸å…³"><a class="markdownIt-Anchor" href="#å£°éŸ³ç›¸å…³"></a> å£°éŸ³ç›¸å…³</h3>
<p>é€‰ä¸­æ–‡å­—åï¼ŒæŒ‰ä½ã€Œctrl + escã€é”®ï¼Œä¼šå°†æ–‡å­—è¿›è¡Œæœ—è¯»ã€‚ï¼ˆæˆ‘å‘ç°ï¼Œåœ¨è§¦æ§æ¡ç‰ˆçš„ mac ä¸Šï¼Œå¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼‰</p>
<h3 id="dock-æ ç›¸å…³"><a class="markdownIt-Anchor" href="#dock-æ ç›¸å…³"></a> Dock æ ç›¸å…³</h3>
<ul>
<li>ã€Œoption + command + Dã€ï¼šéšè— dock æ </li>
</ul>
<h3 id="å¼ºåˆ¶æ¨å‡º"><a class="markdownIt-Anchor" href="#å¼ºåˆ¶æ¨å‡º"></a> å¼ºåˆ¶æ¨å‡º</h3>
<blockquote>
<p>å¼ºåˆ¶é€€å‡ºçš„å¿«æ·é”®éå¸¸é‡è¦</p>
</blockquote>
<ul>
<li>ã€Œoption + command + escã€ï¼šæ‰“å¼€å¼ºåˆ¶é€€å‡ºçš„çª—å£</li>
</ul>
<h3 id="option-ç›¸å…³"><a class="markdownIt-Anchor" href="#option-ç›¸å…³"></a> option ç›¸å…³</h3>
<blockquote>
<p>å¼ºçƒˆæ¨è</p>
</blockquote>
<ul>
<li>
<p>ã€Œoption + command + Hã€ï¼šéšè—é™¤å½“å‰åº”ç”¨ç¨‹åºä¹‹å¤–çš„å…¶ä»–åº”ç”¨ç¨‹åº</p>
</li>
<li>
<p>åœ¨æ–‡æœ¬ä¸­ï¼ŒæŒ‰ä½ã€Œoptionã€é”®ï¼Œé…åˆé¼ æ ‡çš„é€‰ä¸­ï¼Œå¯ä»¥è¿›è¡Œå—çŠ¶æ–‡å­—é€‰å–ã€‚</p>
</li>
<li>
<p>ã€Œoption + command + Wã€ï¼šå¿«é€Ÿå…³é—­å½“å‰åº”ç”¨ç¨‹åºçš„æ‰€æœ‰çª—å£ã€‚ã€å¾ˆå®ç”¨ã€‘</p>
</li>
</ul>
<p>æ¯”å¦‚è¯´ï¼Œä½ ä¸€æ¬¡æ€§æ‰“å¼€äº†å¾ˆå¤šæ–‡ä»¶çš„è¯¦æƒ…ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡æ­¤å¿«æ·é”®ï¼Œå°†è¿™äº›çª—å£ä¸€æ¬¡æ€§å…³é—­ã€‚</p>
<ul>
<li>ã€Œoption + command + Iã€ï¼šæŸ¥çœ‹å¤šä¸ªæ–‡ä»¶çš„æ€»çš„å±æ€§ã€‚</li>
</ul>
<ul>
<li>
<p>æ‰“å¼€ launchpadï¼ŒæŒ‰ä½ã€Œoptionã€é”®ï¼Œå¯ä»¥å¿«é€Ÿå¸è½½åº”ç”¨ç¨‹åºã€‚</p>
</li>
<li>
<p>åœ¨ dock æ ï¼Œå³é”®ç‚¹å‡»è½¯ä»¶å›¾æ ‡ï¼ŒåŒæ—¶æŒ‰ä½ã€Œoptionã€é”®ï¼Œå°±å¯ä»¥<strong>å¼ºåˆ¶é€€å‡º</strong>è¯¥è½¯ä»¶ã€‚ã€é‡è¦ã€‘</p>
</li>
</ul>
<ul>
<li>åœ¨ Safari æµè§ˆå™¨ä¸­ï¼ŒæŒ‰ä½ã€Œoption + command + Qã€é€€å‡º Safariã€‚ç­‰ä¸‹æ¬¡è¿›å…¥ Safari çš„æ—¶å€™ï¼Œä¸Šæ¬¡é€€å‡ºæ—¶çš„ç½‘å€ä¼šè‡ªåŠ¨è¢«æ‰“å¼€ã€‚ã€å®ç”¨ã€‘</li>
</ul>
<h3 id="æ¨èä¸€ä¸ªè½¯ä»¶cheatsheet"><a class="markdownIt-Anchor" href="#æ¨èä¸€ä¸ªè½¯ä»¶cheatsheet"></a> æ¨èä¸€ä¸ªè½¯ä»¶ï¼šCheatSheet</h3>
<p>æ‰“å¼€ CheatSheet åï¼Œé•¿æŒ‰ command é”®ï¼Œä¼šå¼¹å‡ºå½“å‰åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å¿«æ·é”®ã€‚æˆ‘ä»¬è¿˜å¯ä»¥å¯¹è¿™äº›å¿«æ·é”®è¿›è¡Œä¿å­˜ã€‚</p>
<h2 id="å­¦ä¹ èµ„æº"><a class="markdownIt-Anchor" href="#å­¦ä¹ èµ„æº"></a> ğŸ“š å­¦ä¹ èµ„æº</h2>
<ul>
<li><a href="https://github.com/jaywcjlove/awesome-mac" target="_blank" rel="noopener">Awesome Mac</a></li>
<li><a href="https://github.com/herrbischoff/awesome-macos-command-line" target="_blank" rel="noopener">awesome-macos-command-line</a></li>
</ul>
<h2 id="ä¼ é€é—¨"><a class="markdownIt-Anchor" href="#ä¼ é€é—¨"></a> ğŸšª ä¼ é€é—¨</h2>
<p>| <a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">å›é¦–é </a> |</p>
]]></content>
      <categories>
        <category>æ“ä½œç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>Mac</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows å¸¸ç”¨æŠ€å·§æ€»ç»“</title>
    <url>/blog/os/windows/</url>
    <content><![CDATA[<h1 id="windows-å¸¸ç”¨æŠ€å·§æ€»ç»“"><a class="markdownIt-Anchor" href="#windows-å¸¸ç”¨æŠ€å·§æ€»ç»“"></a> Windows å¸¸ç”¨æŠ€å·§æ€»ç»“</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E8%BD%AF%E4%BB%B6">è½¯ä»¶</a>
<ul>
<li><a href="#%E8%A7%86%E9%A2%91%E9%9F%B3%E9%A2%91">è§†é¢‘éŸ³é¢‘</a></li>
<li><a href="#%E5%8E%8B%E7%BC%A9">å‹ç¼©</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86">æ–‡ä»¶ç®¡ç†</a></li>
<li><a href="#%E5%BC%80%E5%8F%91">å¼€å‘</a></li>
<li><a href="#%E7%BC%96%E8%BE%91%E5%99%A8">ç¼–è¾‘å™¨</a></li>
<li><a href="#%E6%96%87%E6%A1%A3">æ–‡æ¡£</a></li>
<li><a href="#%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87">æ•ˆç‡æå‡</a></li>
<li><a href="#%E5%8A%9E%E5%85%AC">åŠå…¬</a></li>
<li><a href="#%E4%B8%AA%E6%80%A7%E5%8C%96">ä¸ªæ€§åŒ–</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="è½¯ä»¶"><a class="markdownIt-Anchor" href="#è½¯ä»¶"></a> è½¯ä»¶</h2>
<blockquote>
<p>æ‰©å±•é˜…è¯»ï¼š</p>
<ul>
<li><a href="https://github.com/Awesome-Windows/Awesome/blob/master/README-cn.md" target="_blank" rel="noopener">Awesome Windows</a></li>
<li><a href="https://github.com/stackia/best-windows-apps" target="_blank" rel="noopener">best-windows-apps</a></li>
</ul>
</blockquote>
<h3 id="è§†é¢‘éŸ³é¢‘"><a class="markdownIt-Anchor" href="#è§†é¢‘éŸ³é¢‘"></a> è§†é¢‘éŸ³é¢‘</h3>
<ul>
<li><a href="http://getmusicbee.com/" target="_blank" rel="noopener">Musicbee</a> - ç±»ä¼¼ iTunesï¼Œä½†æ¯” iTunes æ›´å¥½ç”¨ã€‚</li>
<li><a href="http://www.screentogif.com/" target="_blank" rel="noopener">ScreenToGif</a> - å®ƒå…è®¸ä½ å½•åˆ¶å±å¹•çš„ä¸€éƒ¨åˆ†åŒºåŸŸå¹¶ä¿å­˜ä¸º gif æˆ–è§†é¢‘ã€‚</li>
<li><a href="http://potplayer.daum.net/" target="_blank" rel="noopener">PotPlayer</a> - å¤šåª’ä½“æ’­æ”¾å™¨ï¼Œå…·æœ‰å¹¿æ³›çš„ç¼–è§£ç å™¨é›†åˆï¼Œå®ƒè¿˜ä¸ºç”¨æˆ·æä¾›å¤§é‡é…ç½®é€‰é¡¹ã€‚</li>
<li><a href="http://www.splayer.org/" target="_blank" rel="noopener">å°„æ‰‹å½±éŸ³æ’­æ”¾å™¨</a> - æ¥è‡ªå°„æ‰‹ç½‘ï¼Œå°å·§å¼€æºï¼Œé¦–åˆ›è‡ªåŠ¨åŒ¹é…å­—å¹•åŠŸèƒ½ã€‚</li>
</ul>
<h3 id="å‹ç¼©"><a class="markdownIt-Anchor" href="#å‹ç¼©"></a> å‹ç¼©</h3>
<ul>
<li><a href="http://www.7-zip.org/" target="_blank" rel="noopener">7-Zip</a> - ç”¨äºå¤„ç†å‹ç¼©åŒ…çš„å¼€æº Windows å®ç”¨ç¨‹åºã€‚å®Œç¾æ”¯æŒ 7zï¼ŒZIPï¼ŒGZIPï¼ŒBZIP2 å’Œ TAR çš„å…¨éƒ¨ç‰¹æ€§ï¼Œå…¶ä»–æ ¼å¼ä¹Ÿå¯è§£å‹ç¼©ã€‚</li>
<li><a href="http://www.rarlab.com/" target="_blank" rel="noopener">WinRAR</a> - å¼ºå¤§çš„å½’æ¡£ç®¡ç†å™¨ã€‚ å®ƒå¯ä»¥å¤‡ä»½æ‚¨çš„æ•°æ®å¹¶å‡å°ç”µå­é‚®ä»¶é™„ä»¶çš„å¤§å°ï¼Œè§£å‹ç¼© RARï¼ŒZIP å’Œå…¶ä»–æ–‡ä»¶ã€‚</li>
</ul>
<h3 id="æ–‡ä»¶ç®¡ç†"><a class="markdownIt-Anchor" href="#æ–‡ä»¶ç®¡ç†"></a> æ–‡ä»¶ç®¡ç†</h3>
<ul>
<li><a href="http://en.ejie.me/" target="_blank" rel="noopener">Clover</a> - ä¸ºèµ„æºç®¡ç†å™¨åŠ ä¸Šå¤šæ ‡ç­¾åŠŸèƒ½ã€‚</li>
<li><a href="http://www.ghisler.com/" target="_blank" rel="noopener">Total Commander</a> - è€ç‰Œã€åŠŸèƒ½å¼‚å¸¸å¼ºå¤§çš„æ–‡ä»¶ç®¡ç†å¢å¼ºè½¯ä»¶ã€‚</li>
<li><a href="http://www.softwareok.com/?seite=Freeware/Q-Dir" target="_blank" rel="noopener">Q-Dir</a> - è½»é‡çº§çš„æ–‡ä»¶ç®¡ç†å™¨ï¼Œå„ç§å¸ƒå±€è§†å›¾åˆ‡æ¢çµæ´»ï¼Œé»˜è®¤å››ä¸ªå°çª—å£ç»„æˆä¸€ä¸ªå¤§çª—å£ï¼Œæ“ä½œå¿«æ·ã€‚è½¯ä»¶è™½å°ï¼Œç²‰ä¸å¿ è¯šã€‚</li>
<li><a href="https://github.com/Wox-launcher/Wox" target="_blank" rel="noopener">WoX</a> - æ–°ä¸€ä»£æ–‡ä»¶å®šä½å·¥å…·ï¼Œå ªç§° Windows ä¸Šçš„ Alfredã€‚</li>
<li><a href="http://www.voidtools.com/" target="_blank" rel="noopener">Everything</a> - æœ€å¿«çš„æ–‡ä»¶/æ–‡ä»¶å¤¹æœç´¢å·¥å…·ï¼Œ é€šè¿‡åç§°æœç´¢ã€‚</li>
<li><a href="http://www.listary.com/" target="_blank" rel="noopener">Listary</a> - éå¸¸ä¼˜ç§€çš„ Windows æ–‡ä»¶æµè§ˆå’Œæœç´¢å¢å¼ºå·¥å…·ã€‚</li>
<li>Beyond Compare - å¥½ç”¨åˆä¸‡èƒ½çš„æ–‡ä»¶å¯¹æ¯”å·¥å…·ã€‚</li>
<li><a href="https://www.piriform.com/ccleaner/download" target="_blank" rel="noopener">CCleaner</a> - å¦‚æœä½ æœ‰ç³»ç»Ÿæ´ç™–ï¼Œé‚£ä¸€å®šè¦é€‰æ‹©ä¸€æ¬¾å¹²å‡€ã€è‰¯å¿ƒã€è€ç‰Œçš„æ¸…æ´è½¯ä»¶ã€‚</li>
<li><a href="https://chocolatey.org/" target="_blank" rel="noopener">chocolatey</a> - åŒ…ç®¡ç†å™¨</li>
<li><a href="https://ninite.com/" target="_blank" rel="noopener">Ninite</a> - æœ€ç®€å•ï¼Œæœ€å¿«é€Ÿçš„æ›´æ–°æˆ–å®‰è£…è½¯ä»¶çš„æ–¹å¼ã€‚</li>
<li><a href="http://www.piriform.com/RECUVA" target="_blank" rel="noopener">Recuva</a> - æ¥è‡ª piriform æ¢¨å­å…¬å¸äº§å“ï¼Œå…è´¹çš„æ•°æ®æ¢å¤å·¥å…·ã€‚</li>
<li><a href="http://www.launchy.net/" target="_blank" rel="noopener">Launchy</a>ï¼šè‡ªç”±çš„è·¨å¹³å°å·¥å…·ï¼Œå¸®åŠ©ä½ å¿˜è®°å¼€å§‹èœå•ã€æ¡Œé¢å›¾æ ‡ç”šè‡³æ–‡ä»¶ç®¡ç†å™¨ã€‚</li>
</ul>
<h3 id="å¼€å‘"><a class="markdownIt-Anchor" href="#å¼€å‘"></a> å¼€å‘</h3>
<ul>
<li><a href="http://www.telerik.com/fiddler" target="_blank" rel="noopener">Fiddler</a> - web è°ƒè¯•ä»£ç†å·¥å…·ã€‚</li>
<li><a href="https://www.getpostman.com/postman" target="_blank" rel="noopener">Postman</a> - é€‚åˆ API å¼€å‘çš„å®Œæ•´å·¥å…·é“¾ï¼Œæœ€å¸¸ç”¨çš„ REST å®¢æˆ·ç«¯ã€‚</li>
<li><a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener">SourceTree</a> - ä¸€ä¸ªå…è´¹çš„ Git &amp; Mercurial å®¢æˆ·ç«¯ã€‚</li>
<li><a href="https://tortoisesvn.net/" target="_blank" rel="noopener">TortoiseSVN</a> - Subversion(SVN)çš„å›¾å½¢å®¢æˆ·ç«¯</li>
<li><a href="https://www.wireshark.org/" target="_blank" rel="noopener">Wireshark</a> - ä¸€ä¸ªç½‘ç»œåè®®åˆ†æå·¥å…·ã€‚</li>
<li>Switchhosts</li>
<li><a href="https://github.com/cmderdev/cmder" target="_blank" rel="noopener">Cmder</a> - æ§åˆ¶å°æ¨¡æ‹Ÿå™¨åŒ…ã€‚æ‰©å±•é˜…è¯»ï¼š<a href="https://www.jeffjade.com/2016/01/13/2016-01-13-windows-software-cmder/" target="_blank" rel="noopener">Win ä¸‹å¿…å¤‡ç¥å™¨ä¹‹ Cmder</a></li>
<li><a href="http://babun.github.io/" target="_blank" rel="noopener">Babun</a> - åŸºäº Cygwinï¼Œç”¨äºæ›¿ä»£ Windows shellã€‚</li>
</ul>
<h3 id="ç¼–è¾‘å™¨"><a class="markdownIt-Anchor" href="#ç¼–è¾‘å™¨"></a> ç¼–è¾‘å™¨</h3>
<ul>
<li><a href="http://www.jetbrains.com/" target="_blank" rel="noopener">JetBrain IDE ç³»åˆ—</a> - çœŸé¦™ï¼</li>
<li><a href="https://code.visualstudio.com/" target="_blank" rel="noopener">Visual Studio Code</a> - ç”¨äºæ„å»ºå’Œè°ƒè¯•ç°ä»£ Web å’Œäº‘åº”ç”¨ç¨‹åºã€‚</li>
<li><a href="https://eclipse.org/downloads/" target="_blank" rel="noopener">Eclipse</a> - ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ IDEã€‚</li>
<li><a href="https://www.visualstudio.com/vs/" target="_blank" rel="noopener">Visual Studio</a> - å¾®è½¯å®˜æ–¹çš„ IDEï¼Œé€šè¿‡æ’ä»¶å¯æ”¯æŒå¤§é‡ç¼–ç¨‹è¯­è¨€ã€‚</li>
<li><a href="https://netbeans.org/" target="_blank" rel="noopener">NetBeans IDE</a> - å…è´¹å¼€æºçš„ IDEã€‚</li>
<li><a href="https://www.typora.io/" target="_blank" rel="noopener">Typora</a> - ä¸ªäººè§‰å¾—æœ€å¥½ç”¨çš„ Markdown ç¼–è¾‘å™¨ã€‚</li>
<li><a href="https://www.zybuluo.com/cmd/" target="_blank" rel="noopener">Cmd Markdown</a> - è·¨å¹³å°ä¼˜ç§€ Markdown ç¼–è¾‘å™¨ï¼Œæœ¬æ–‡å³ç”¨å…¶æ‰€å†™ã€‚</li>
<li><a href="https://notepad-plus-plus.org/" target="_blank" rel="noopener">Notepad++</a> - ä¸€æ¬¾æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€çš„æºç ç¼–è¾‘å™¨ã€‚</li>
<li><a href="http://www.flos-freeware.ch/notepad2.html" target="_blank" rel="noopener">Notepad2</a> - ç”¨äºæ›¿ä»£é»˜è®¤æ–‡æœ¬ç¼–è¾‘å™¨çš„è½»é‡å¿«é€Ÿçš„ç¼–è¾‘å™¨ï¼Œæ‹¥æœ‰ä¼—å¤šæœ‰ç”¨çš„åŠŸèƒ½ã€‚</li>
<li><a href="http://www.sublimetext.com/3" target="_blank" rel="noopener">Sublime Text 3</a> - é«˜çº§æ–‡æœ¬ç¼–è¾‘å™¨ã€‚</li>
<li><a href="https://atom.io/" target="_blank" rel="noopener">Atom</a> - é¢å‘ 21 ä¸–çºªçš„æå®¢æ–‡æœ¬ç¼–è¾‘å™¨ã€‚</li>
</ul>
<h3 id="æ–‡æ¡£"><a class="markdownIt-Anchor" href="#æ–‡æ¡£"></a> æ–‡æ¡£</h3>
<ul>
<li><a href="http://www.office.com/" target="_blank" rel="noopener">Microsoft Office</a> - å¾®è½¯åŠå…¬è½¯ä»¶ã€‚</li>
<li><a href="https://www.wps.com/office-free" target="_blank" rel="noopener">WPS Office</a> - é‡‘å±±å…è´¹åŠå…¬è½¯ä»¶ã€‚</li>
<li><a href="http://calibre-ebook.com/" target="_blank" rel="noopener">Calibre</a> - ç”¨äºç”µå­ä¹¦ç®¡ç†å’Œè½¬æ¢çš„å¼ºå¤§è½¯ä»¶ã€‚</li>
<li><a href="http://www.foxitsoftware.cn/products/reader/" target="_blank" rel="noopener">ç¦æ˜•é˜…è¯»å™¨</a> - åœ¨å…¨çƒæ‹¥æœ‰å¤§é‡ç”¨æˆ·ï¼Œæœ€ä¼˜ç§€çš„å›½äº§è½¯ä»¶ä¹‹ä¸€ã€‚Ribbon ç•Œé¢ï¼Œæ”¯æŒæ‰‹å†™ç­¾åã€æ’å…¥å°ç« ç­‰ã€‚</li>
</ul>
<h3 id="æ•ˆç‡æå‡"><a class="markdownIt-Anchor" href="#æ•ˆç‡æå‡"></a> æ•ˆç‡æå‡</h3>
<p><strong>ã€ç¬”è®°ã€‘</strong></p>
<ul>
<li><a href="http://www.xmind.net/" target="_blank" rel="noopener">XMind</a> - ä¼˜ç§€çš„æ€ç»´å¯¼å›¾ã€‚</li>
<li><a href="https://www.onenote.com/" target="_blank" rel="noopener">OneNote</a> - Windows ä¸‹ç»¼åˆè¯„ä»·éå¸¸é«˜çš„ç¬”è®°åº”ç”¨ã€‚</li>
<li><a href="http://www.yinxiang.com/" target="_blank" rel="noopener">å°è±¡ç¬”è®°</a> - è€ç‰Œè·¨å¹³å°ç¬”è®°å·¥å…·ï¼Œå›½é™…ç‰ˆ Evernoteã€‚ä¸€å®¶ç«‹å¿—äºåšç™¾å¹´å…¬å¸çš„ä¼ä¸šï¼Œå®‰å…¨ã€å¯é ã€‚</li>
<li><a href="http://www.wiz.cn/index.html" target="_blank" rel="noopener">ä¸ºçŸ¥ç¬”è®°</a> - è¶Šæ¥è¶Šå¥½çš„ç¬”è®°åº”ç”¨ï¼Œè®°å½•ã€æŸ¥é˜…ä¸€åˆ‡æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼ŒåŒæ ·è·¨å¹³å°æ”¯æŒã€‚</li>
<li><a href="http://note.youdao.com/" target="_blank" rel="noopener">æœ‰é“äº‘ç¬”è®°</a> - ç½‘æ˜“æ——ä¸‹ç¬”è®°å·¥å…·ï¼ŒåŒæ ·è·¨ä¸»æµå¹³å°æ”¯æŒï¼Œæ–‡å­—ã€æ‰‹å†™ã€å½•éŸ³ã€æ‹ç…§å¤šç§è®°å½•æ–¹å¼ï¼Œæ”¯æŒä»»æ„é™„ä»¶æ ¼å¼ã€‚</li>
<li><a href="https://getsharex.com/" target="_blank" rel="noopener">ShareX</a> - ä½ è¦çš„æ‰€æœ‰ä¸æˆªå›¾ã€å½•å±ç›¸å…³çš„åŠŸèƒ½ï¼Œè¿™é‡Œéƒ½æœ‰äº†ã€‚</li>
</ul>
<p>ã€å¿«æ·é”®ã€‘</p>
<ul>
<li><a href="https://autohotkey.com/" target="_blank" rel="noopener">AutoHotkey</a> - Windows å¹³å°çš„ç»ˆæè‡ªåŠ¨åŒ–è„šæœ¬è¯­è¨€ã€‚</li>
</ul>
<blockquote>
<p>æŠ€å·§ï¼š</p>
<ul>
<li><a href="https://www.jeffjade.com/2016/03/11/2016-03-11-autohotkey/" target="_blank" rel="noopener">https://www.jeffjade.com/2016/03/11/2016-03-11-autohotkey/</a></li>
<li><a href="https://www.autohotkey.com/boards/viewtopic.php?f=29&amp;t=4296" target="_blank" rel="noopener">https://www.autohotkey.com/boards/viewtopic.php?f=29&amp;t=4296</a></li>
</ul>
</blockquote>
<h3 id="åŠå…¬"><a class="markdownIt-Anchor" href="#åŠå…¬"></a> åŠå…¬</h3>
<ul>
<li><a href="http://cidian.youdao.com/index.html" target="_blank" rel="noopener">æœ‰é“è¯å…¸</a> - æœ€å¥½ç”¨çš„å…è´¹å…¨èƒ½ç¿»è¯‘è½¯ä»¶ã€‚</li>
<li><a href="http://office.microsoft.com/zh-cn/outlook/" target="_blank" rel="noopener">Outlook</a> - å¤§åé¼é¼çš„ Microsoft Office ç»„ä»¶ä¹‹ä¸€ï¼Œé™¤äº†ç”µå­é‚®ä»¶ï¼Œè¿˜åŒ…å«äº†æ—¥å†ã€ä»»åŠ¡ç®¡ç†ã€è”ç³»äººã€è®°äº‹æœ¬ç­‰åŠŸèƒ½ã€‚</li>
<li><a href="http://www.gmail.com/" target="_blank" rel="noopener">Gmail</a> - åŠŸèƒ½ä¸Šå¯ä»¥ç§°ä¸ºä¸šç•Œæ ‡æ†ï¼Œç”¨æˆ·æ•°é‡ä¸–ç•Œç¬¬ä¸€ï¼Œæˆ–è®¸ä½ çœŸçš„æ‰¾ä¸åˆ°æ¯”å®ƒæ›´å¥½çš„é‚®ä»¶ç³»ç»Ÿã€‚</li>
<li><a href="https://www.google.com/intl/zh-CN/chrome/browser/" target="_blank" rel="noopener">Chrome</a> - æœ€å¥½çš„æµè§ˆå™¨ã€‚</li>
<li><a href="http://www.teamviewer.com/Zhcn/index.aspx" target="_blank" rel="noopener">Teamviewer</a> - ä¸“ä¸šã€åŠŸèƒ½å¼ºå¤§çš„è¿œç¨‹æ§åˆ¶è½¯ä»¶ã€‚ä½¿ç”¨ç®€å•ï¼Œå¯¹ä¸ªäººç”¨æˆ·å…è´¹ã€‚</li>
</ul>
<h3 id="ä¸ªæ€§åŒ–"><a class="markdownIt-Anchor" href="#ä¸ªæ€§åŒ–"></a> ä¸ªæ€§åŒ–</h3>
<ul>
<li><a href="https://github.com/TranslucentTB/TranslucentTB" target="_blank" rel="noopener">TranslucentTB</a> - é€æ˜åŒ–ä½ çš„ Windows ä»»åŠ¡æ ã€‚</li>
<li><a href="http://qttabbar.wikidot.com/" target="_blank" rel="noopener">QTTabBar</a> - é€šè¿‡å¤šæ ‡ç­¾å’Œé¢å¤–çš„æ–‡ä»¶å¤¹è§†å›¾æ‰©å±•èµ„æºç®¡ç†å™¨çš„åŠŸèƒ½ã€‚</li>
<li><a href="https://www.stardock.com/products/fences/" target="_blank" rel="noopener">Fences</a> - ç®¡ç†æ¡Œé¢å¿«æ·æ–¹å¼ã€‚</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://github.com/Awesome-Windows/Awesome/blob/master/README-cn.md" target="_blank" rel="noopener">https://github.com/Awesome-Windows/Awesome/blob/master/README-cn.md</a></li>
<li><a href="https://love.appinn.com/" target="_blank" rel="noopener">https://love.appinn.com/</a></li>
<li><a href="https://github.com/stackia/best-windows-apps" target="_blank" rel="noopener">https://github.com/stackia/best-windows-apps</a></li>
</ul>
]]></content>
      <categories>
        <category>æ“ä½œç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¶æ„è®¾è®¡</title>
    <url>/blog/design/architecture/README/</url>
    <content><![CDATA[<h1 id="æ¶æ„è®¾è®¡"><a class="markdownIt-Anchor" href="#æ¶æ„è®¾è®¡"></a> æ¶æ„è®¾è®¡</h1>
<h2 id="å†…å®¹"><a class="markdownIt-Anchor" href="#å†…å®¹"></a> å†…å®¹</h2>
<ul>
<li><a href="system-architecture-interview.md">ç³»ç»Ÿæ¶æ„é¢è¯•é¢˜</a></li>
<li><a href="system-architecture-overview.md">ç³»ç»Ÿæ¶æ„æ¦‚è¿°</a></li>
<li><a href="high-performance-architecture.md">é«˜æ€§èƒ½æ¶æ„</a></li>
<li><a href="high-availability-architecture.md">é«˜å¯ç”¨æ¶æ„</a></li>
<li><a href="scalable-architecture.md">ä¼¸ç¼©æ€§æ¶æ„</a></li>
<li><a href="extensible-architecture.md">æ‰©å±•æ€§æ¶æ„</a></li>
<li><a href="security-architecture.md">ç³»ç»Ÿå®‰å…¨æ€§æ¶æ„</a></li>
<li><a href="system-core-technologies.md">å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯</a></li>
</ul>
<h2 id="å­¦ä¹ èµ„æ–™"><a class="markdownIt-Anchor" href="#å­¦ä¹ èµ„æ–™"></a> å­¦ä¹ èµ„æ–™</h2>
<ul>
<li><strong>ä¹¦ç±</strong>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æ</a> - æµ…æ˜¾æ˜“æ‡‚çš„å°†è§£å¤§å‹ç½‘ç«™æ¶æ„æ¼”è¿›ä¹‹è·¯ï¼›ç®€ä»‹äº†å¤§å‹ç³»ç»Ÿæ‰€é¢ä¸´çš„æŒ‘æˆ˜ä»¥åŠæ ¸å¿ƒæŠ€æœ¯ç‚¹ã€‚</li>
<li><a href="https://item.jd.com/11449803.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™ç³»ç»Ÿä¸ Java ä¸­é—´ä»¶å®è·µ</a></li>
<li><a href="https://item.jd.com/12153914.html" target="_blank" rel="noopener">äº¿çº§æµé‡ç½‘ç«™æ¶æ„æ ¸å¿ƒæŠ€æœ¯ï¼šè·Ÿå¼€æ¶›å­¦æ­å»ºé«˜å¯ç”¨é«˜å¹¶å‘ç³»ç»Ÿ</a></li>
<li><a href="https://item.jd.com/12176278.html" target="_blank" rel="noopener">ä¼ä¸š IT æ¶æ„è½¬å‹ä¹‹é“ï¼šé˜¿é‡Œå·´å·´ä¸­å°æˆ˜ç•¥æ€æƒ³ä¸æ¶æ„å®æˆ˜</a> - é˜è¿°é˜¿é‡Œå·´å·´ä¸­å°ç³»ç»Ÿå‘å±•ï¼Œæ›´å¤šçš„æ˜¯è®²è§£åº”ç”¨åœºæ™¯å’Œèƒ½åŠ›ï¼Œæ²¡æœ‰è®²è§£æŠ€æœ¯ç»†èŠ‚ã€‚</li>
<li><a href="https://item.jd.com/12238227.html" target="_blank" rel="noopener">é€†æµè€Œä¸Šï¼šé˜¿é‡Œå·´å·´æŠ€æœ¯æˆé•¿ä¹‹è·¯</a> - ä¸»è¦ä»¥è¿ç»´çš„è§†è§’é˜è¿°ç³»ç»Ÿè¿ç»´ä¸­é‡åˆ°çš„å›°éš¾ï¼Œå®šä½æ€è·¯ä»¥åŠè§£å†³æ–¹æ³•ã€‚</li>
</ul>
</li>
<li><strong>æ•™ç¨‹</strong>
<ul>
<li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md" target="_blank" rel="noopener">system-design-primer</a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>ç³»ç»ŸåŸç†</title>
    <url>/blog/design/theory/README/</url>
    <content><![CDATA[<h1 id="ç³»ç»ŸåŸç†"><a class="markdownIt-Anchor" href="#ç³»ç»ŸåŸç†"></a> ç³»ç»ŸåŸç†</h1>
<blockquote>
<p>ç³»ç»ŸåŸç†æ—¨åœ¨æ€»ç»“å¤§å‹ç³»ç»Ÿä¸­å¸¸ç”¨çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œè¿™ä¹Ÿæ¶æ„è®¾è®¡çš„åŸºçŸ³ã€‚</p>
</blockquote>
<h2 id="å†…å®¹"><a class="markdownIt-Anchor" href="#å†…å®¹"></a> å†…å®¹</h2>
<ul>
<li><a href="system-theory-interview.md">ç³»ç»ŸåŸç†é¢è¯•é¢˜</a></li>
<li><a href="distributed-base-theory.md">åˆ†å¸ƒå¼åŸºæœ¬åŸç†</a></li>
<li><a href="load-balance-theory.md">è´Ÿè½½å‡è¡¡åŸºæœ¬åŸç†</a></li>
<li><a href="cache-theory.md">ç¼“å­˜åŸºæœ¬åŸç†</a></li>
<li><a href="mq-theory.md">æ¶ˆæ¯é˜Ÿåˆ—åŸºæœ¬åŸç†</a></li>
<li><a href="distributed-lock-theory.md">åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†</a></li>
<li><a href="distributed-session-theory.md">åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†</a></li>
<li><a href="distributed-storage-theory.md">åˆ†å¸ƒå¼å­˜å‚¨åŸºæœ¬åŸç†</a></li>
<li><a href="distributed-id-theory.md">åˆ†å¸ƒå¼ ID åŸºæœ¬åŸç†</a></li>
<li><a href="distributed-transaction-theory.md">åˆ†å¸ƒå¼äº‹åŠ¡åŸºæœ¬åŸç†</a></li>
<li><a href="sharding-theory.md">åˆ†åº“åˆ†è¡¨åŸºæœ¬åŸç†</a></li>
</ul>
<h2 id="å­¦ä¹ èµ„æ–™"><a class="markdownIt-Anchor" href="#å­¦ä¹ èµ„æ–™"></a> å­¦ä¹ èµ„æ–™</h2>
<ul>
<li>
<p><strong>ä¹¦ç±</strong></p>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æ</a> - æµ…æ˜¾æ˜“æ‡‚çš„å°†è§£å¤§å‹ç½‘ç«™æ¶æ„æ¼”è¿›ä¹‹è·¯ï¼›ç®€ä»‹äº†å¤§å‹ç³»ç»Ÿæ‰€é¢ä¸´çš„æŒ‘æˆ˜ä»¥åŠæ ¸å¿ƒæŠ€æœ¯ç‚¹ã€‚</li>
<li><a href="https://item.jd.com/11449803.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™ç³»ç»Ÿä¸ Java ä¸­é—´ä»¶å®è·µ</a></li>
<li><a href="https://item.jd.com/12153914.html" target="_blank" rel="noopener">äº¿çº§æµé‡ç½‘ç«™æ¶æ„æ ¸å¿ƒæŠ€æœ¯ï¼šè·Ÿå¼€æ¶›å­¦æ­å»ºé«˜å¯ç”¨é«˜å¹¶å‘ç³»ç»Ÿ</a></li>
<li><a href="https://item.jd.com/12176278.html" target="_blank" rel="noopener">ä¼ä¸š IT æ¶æ„è½¬å‹ä¹‹é“ï¼šé˜¿é‡Œå·´å·´ä¸­å°æˆ˜ç•¥æ€æƒ³ä¸æ¶æ„å®æˆ˜</a> - é˜è¿°é˜¿é‡Œå·´å·´ä¸­å°ç³»ç»Ÿå‘å±•ï¼Œæ›´å¤šçš„æ˜¯è®²è§£åº”ç”¨åœºæ™¯å’Œèƒ½åŠ›ï¼Œæ²¡æœ‰è®²è§£æŠ€æœ¯ç»†èŠ‚ã€‚</li>
<li><a href="https://item.jd.com/12238227.html" target="_blank" rel="noopener">é€†æµè€Œä¸Šï¼šé˜¿é‡Œå·´å·´æŠ€æœ¯æˆé•¿ä¹‹è·¯</a> - ä¸»è¦ä»¥è¿ç»´çš„è§†è§’é˜è¿°ç³»ç»Ÿè¿ç»´ä¸­é‡åˆ°çš„å›°éš¾ï¼Œå®šä½æ€è·¯ä»¥åŠè§£å†³æ–¹æ³•ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ•™ç¨‹</strong></p>
<ul>
<li><a href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md" target="_blank" rel="noopener">system-design-primer</a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
      </tags>
  </entry>
  <entry>
    <title>UML æ•™ç¨‹</title>
    <url>/blog/tools/uml/</url>
    <content><![CDATA[<blockquote>
<p>å…³é”®è¯ï¼š<code>éƒ¨ç½²å›¾</code>, <code>ç»„ä»¶å›¾</code>, <code>åŒ…å›¾</code>, <code>ç±»å›¾</code>, <code>å¤åˆç»“æ„å›¾</code>, <code>å¯¹è±¡å›¾</code>, <code>æ´»åŠ¨å›¾</code>, <code>çŠ¶æ€æœºå›¾</code>, <code>ç”¨ä¾‹å›¾</code>, <code>é€šä¿¡å›¾</code>, <code>äº¤äº’æ¦‚è¿°å›¾</code>, <code>æ—¶åºå›¾</code>, <code>æ—¶é—´å›¾</code></p>
</blockquote>
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<h3 id="uml-å›¾ç±»å‹"><a class="markdownIt-Anchor" href="#uml-å›¾ç±»å‹"></a> UML å›¾ç±»å‹</h3>
<p>UML å›¾ç±»å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-diagrams.png"/></div>
<h4 id="ç»“æ„å¼å»ºæ¨¡å›¾"><a class="markdownIt-Anchor" href="#ç»“æ„å¼å»ºæ¨¡å›¾"></a> <a href="UML%E7%BB%93%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9B%BE.md">ç»“æ„å¼å»ºæ¨¡å›¾</a></h4>
<blockquote>
<p>ç»“æ„å¼å»ºæ¨¡å›¾ï¼ˆStructure diagramsï¼‰å¼ºè°ƒçš„æ˜¯ç³»ç»Ÿå¼çš„å»ºæ¨¡ã€‚ç»“æ„å›¾å®šä¹‰äº†ä¸€ä¸ªæ¨¡å‹çš„é™æ€æ¶æ„ã€‚å®ƒä»¬é€šå¸¸è¢«ç”¨æ¥å¯¹é‚£äº›æ„æˆæ¨¡å‹çš„â€˜è¦ç´ â€™å»ºæ¨¡ï¼Œè¯¸å¦‚ï¼šç±»ï¼Œå¯¹è±¡ï¼Œæ¥å£å’Œç‰©ç†ç»„ä»¶ã€‚å¦å¤–ï¼Œå®ƒä»¬ä¹Ÿè¢«ç”¨æ¥å¯¹å…ƒç´ é—´å…³è”å’Œä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡ã€‚</p>
</blockquote>
<ul>
<li><a href="#%E7%B1%BB%E5%9B%BE">ç±»å›¾</a></li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E5%9B%BE">å¯¹è±¡å›¾</a></li>
<li><a href="#%E5%8C%85%E5%9B%BE">åŒ…å›¾</a></li>
<li><a href="#%E7%BB%84%E4%BB%B6%E5%9B%BE">ç»„ä»¶å›¾</a></li>
<li><a href="#%E9%83%A8%E7%BD%B2%E5%9B%BE">éƒ¨ç½²å›¾</a></li>
<li><a href="#%E5%A4%8D%E5%90%88%E7%BB%93%E6%9E%84%E5%9B%BE">å¤åˆç»“æ„å›¾</a></li>
</ul>
<h4 id="è¡Œä¸ºå¼å»ºæ¨¡å›¾"><a class="markdownIt-Anchor" href="#è¡Œä¸ºå¼å»ºæ¨¡å›¾"></a> <a href="UML%E8%A1%8C%E4%B8%BA%E5%BB%BA%E6%A8%A1%E5%9B%BE.md">è¡Œä¸ºå¼å»ºæ¨¡å›¾</a></h4>
<blockquote>
<p>è¡Œä¸ºå¼å»ºæ¨¡å›¾ï¼ˆBehavior diagramsï¼‰å¼ºè°ƒç³»ç»Ÿæ¨¡å‹ä¸­è§¦å‘çš„äº‹ã€‚è¡Œä¸ºå›¾ç”¨æ¥è®°å½•åœ¨ä¸€ä¸ªæ¨¡å‹å†…éƒ¨ï¼Œéšæ—¶é—´çš„å˜åŒ–ï¼Œæ¨¡å‹æ‰§è¡Œçš„äº¤äº’å˜åŒ–å’Œç¬é—´çš„çŠ¶æ€ï¼›å¹¶è·Ÿè¸ªç³»ç»Ÿåœ¨çœŸå®ç¯å¢ƒä¸‹å¦‚ä½•è¡¨ç°ï¼Œä»¥åŠè§‚å¯Ÿç³»ç»Ÿå¯¹ä¸€ä¸ªæ“ä½œæˆ–äº‹ä»¶çš„ååº”ï¼Œä»¥åŠå®ƒçš„ç»“æœã€‚</p>
</blockquote>
<ul>
<li><a href="#%E6%B4%BB%E5%8A%A8%E5%9B%BE">æ´»åŠ¨å›¾</a></li>
<li><a href="#%E7%8A%B6%E6%80%81%E5%9B%BE">çŠ¶æ€å›¾</a></li>
<li><a href="#%E7%94%A8%E4%BE%8B%E5%9B%BE">ç”¨ä¾‹å›¾</a></li>
<li><a href="#%E9%80%9A%E4%BF%A1%E5%9B%BE">é€šä¿¡å›¾</a></li>
<li><a href="#%E4%BA%A4%E4%BA%92%E6%A6%82%E8%BF%B0%E5%9B%BE">äº¤äº’æ¦‚è¿°å›¾</a></li>
<li><a href="#%E6%97%B6%E5%BA%8F%E5%9B%BE">æ—¶åºå›¾</a></li>
<li><a href="#%E6%97%B6%E9%97%B4%E5%9B%BE">æ—¶é—´å›¾</a></li>
</ul>
<h3 id="uml-æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#uml-æ¦‚å¿µ"></a> UML æ¦‚å¿µ</h3>
<p>UML ä»æ¥æºä¸­ä½¿ç”¨ç›¸å½“å¤šçš„æ¦‚å¿µã€‚æˆ‘ä»¬å°†ä¹‹å®šä¹‰äºç»Ÿä¸€å»ºæ¨¡è¯­è¨€æœ¯è¯­æ±‡è¡¨ã€‚ä¸‹é¢ä»…åˆ—ä»£è¡¨æ€§çš„æ¦‚å¿µã€‚</p>
<ul>
<li>å¯¹äºç»“æ„è€Œè¨€ - æ‰§è¡Œè€…ï¼Œå±æ€§ï¼Œç±»ï¼Œå…ƒä»¶ï¼Œæ¥å£ï¼Œå¯¹è±¡ï¼ŒåŒ…ã€‚</li>
<li>å¯¹äºè¡Œä¸ºè€Œè¨€ - æ´»åŠ¨ï¼ˆUMLï¼‰ï¼Œäº‹ä»¶ï¼ˆUMLï¼‰ï¼Œæ¶ˆæ¯ï¼ˆUMLï¼‰ï¼Œæ–¹æ³•ï¼ˆUMLï¼‰ï¼Œæ“ä½œï¼ˆUMLï¼‰ï¼ŒçŠ¶æ€ï¼ˆUMLï¼‰ï¼Œç”¨ä¾‹ï¼ˆUMLï¼‰ã€‚</li>
<li>å¯¹äºå…³ç³»è€Œè¨€ - èšåˆï¼Œå…³è”ï¼Œç»„åˆï¼Œç›¸ä¾ï¼Œå¹¿ä¹‰åŒ–ï¼ˆor ç»§æ‰¿ï¼‰ã€‚</li>
<li>å…¶ä»–æ¦‚å¿µ
<ul>
<li>æ„é€ å‹â€”è¿™è§„èŒƒç¬¦å·åº”ç”¨åˆ°çš„æ¨¡å‹</li>
<li>å¤šé‡æ€§â€”å¤šé‡æ€§æ ‡è®°æ³•ä¸èµ„æ–™åº“å»ºæ¨¡åŸºæ•°å¯¹åº”ï¼Œä¾‹å¦‚ï¼š<code>1, 0..1, 1..*</code></li>
</ul>
</li>
</ul>
<h2 id="éƒ¨ç½²å›¾"><a class="markdownIt-Anchor" href="#éƒ¨ç½²å›¾"></a> éƒ¨ç½²å›¾</h2>
<blockquote>
<p><strong>éƒ¨ç½²å›¾ï¼ˆDeployment Diagramï¼‰ç”¨äºå¯¹ç³»ç»Ÿçš„ç‰©ç†ç»“æ„å»ºæ¨¡</strong>ã€‚éƒ¨ç½²å›¾å°†æ˜¾ç¤ºç³»ç»Ÿä¸­çš„è½¯ä»¶ç»„ä»¶å’Œç¡¬ä»¶ç»„ä»¶ä¹‹é—´çš„å…³ç³»ä»¥åŠå¤„ç†å·¥ä½œçš„ç‰©ç†åˆ†å¸ƒã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-deployment-diagram-example.png"/></div>
<h3 id="èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#èŠ‚ç‚¹"></a> èŠ‚ç‚¹</h3>
<p>èŠ‚ç‚¹æ—¢å¯ä»¥æ˜¯ç¡¬ä»¶å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ˜¯è½¯ä»¶å…ƒç´ ã€‚å®ƒæ˜¾ç¤ºä¸ºä¸€ä¸ªç«‹æ–¹ä½“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-node.gif"/></div>
<h3 id="èŠ‚ç‚¹å®ä¾‹"><a class="markdownIt-Anchor" href="#èŠ‚ç‚¹å®ä¾‹"></a> èŠ‚ç‚¹å®ä¾‹</h3>
<p>å›¾å¯ä»¥æ˜¾ç¤ºèŠ‚ç‚¹å®ä¾‹ï¼Œå®ä¾‹ä¸èŠ‚ç‚¹çš„åŒºåˆ†æ˜¯ï¼šå®ä¾‹çš„åç§°å¸¦ä¸‹åˆ’çº¿ï¼Œå†’å·æ”¾åœ¨å®ƒçš„åŸºæœ¬èŠ‚ç‚¹ç±»å‹ä¹‹å‰ã€‚å®ä¾‹åœ¨å†’å·ä¹‹å‰å¯ä»¥æœ‰åç§°ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰åç§°ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªå…·åçš„è®¡ç®—æœºå®ä¾‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-node-instance.gif"/></div>
<h3 id="èŠ‚ç‚¹æ„é€ å‹"><a class="markdownIt-Anchor" href="#èŠ‚ç‚¹æ„é€ å‹"></a> èŠ‚ç‚¹æ„é€ å‹</h3>
<p>ä¸ºèŠ‚ç‚¹æä¾›äº†è®¸å¤šæ ‡å‡†çš„æ„é€ å‹ï¼Œåˆ†åˆ«å‘½åä¸º Â«cdromÂ»ï¼Œ Â«cd-romÂ»ï¼Œ Â«computerÂ»ï¼Œ Â«disk arrayÂ»ï¼Œ Â«pcÂ»ï¼Œ Â«pc clientÂ»ï¼Œ Â«pc serverÂ»ï¼Œ Â«secureÂ»ï¼Œ Â«serverÂ»ï¼Œ Â«storageÂ»ï¼Œ Â«unix serverÂ»ï¼Œ Â«user pcÂ»ã€‚ å¹¶åœ¨èŠ‚ç‚¹ç¬¦å·çš„å³ä¸Šè§’æ˜¾ç¤ºé€‚å½“çš„å›¾æ ‡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-node-stereotype.gif"/></div>
<h3 id="å·¥ä»¶"><a class="markdownIt-Anchor" href="#å·¥ä»¶"></a> å·¥ä»¶</h3>
<p>å·¥ä»¶æ˜¯<a href="http://www.sparxsystems.cn/platforms/software_development.html" target="_blank" rel="noopener">è½¯ä»¶å¼€å‘</a>è¿‡ç¨‹ä¸­çš„äº§å“ã€‚åŒ…æ‹¬è¿‡ç¨‹æ¨¡å‹ï¼ˆå¦‚ï¼šç”¨ä¾‹æ¨¡å‹ï¼Œè®¾è®¡æ¨¡å‹ç­‰ï¼‰ï¼Œæºæ–‡ä»¶ï¼Œæ‰§è¡Œæ–‡ä»¶ï¼Œè®¾è®¡æ–‡æ¡£ï¼Œæµ‹è¯•æŠ¥å‘Šï¼Œæ„é€ å‹ï¼Œç”¨æˆ·æ‰‹å†Œç­‰ç­‰ã€‚</p>
<p>å·¥ä»¶è¡¨ç¤ºä¸ºå¸¦æœ‰å·¥ä»¶åç§°çš„çŸ©å½¢ï¼Œå¹¶æ˜¾ç¤ºÂ«artifactÂ»å…³é”®å­—å’Œæ–‡æ¡£ç¬¦å·ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-artifact.gif"/></div>
<h3 id="å…³è”"><a class="markdownIt-Anchor" href="#å…³è”"></a> å…³è”</h3>
<p>åœ¨éƒ¨ç½²å›¾çš„ä¸Šä¸‹æ–‡è”ç³»ä¸­ï¼Œå…³è”ä»£è¡¨èŠ‚ç‚¹é—´çš„è”ç³»é€šé“ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªç½‘ç»œç³»ç»Ÿçš„éƒ¨ç½²å›¾ï¼Œæè¿°äº†ç½‘ç»œåè®®ä¸ºæ„é€ å‹å’Œå…³è”ç»ˆç«¯çš„å¤šé‡æ€§ï¼Œ</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-network-model.gif"/></div>
<h3 id="ä½œä¸ºå®¹å™¨çš„èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#ä½œä¸ºå®¹å™¨çš„èŠ‚ç‚¹"></a> ä½œä¸ºå®¹å™¨çš„èŠ‚ç‚¹</h3>
<p>èŠ‚ç‚¹å¯ä»¥åŒ…å«å…¶ä»–å…ƒç´ ï¼Œå¦‚ç»„ä»¶å’Œå·¥ä»¶ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªåµŒå…¥å¼ç³»ç»ŸæŸä¸ªéƒ¨åˆ†çš„éƒ¨ç½²å›¾ã€‚æå†™äº†ä¸€ä¸ªè¢«ä¸»æ¿èŠ‚ç‚¹åŒ…å«çš„å¯æ‰§è¡Œå·¥ä»¶ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-embedded-model.gif"/></div>
<h2 id="ç»„ä»¶å›¾"><a class="markdownIt-Anchor" href="#ç»„ä»¶å›¾"></a> ç»„ä»¶å›¾</h2>
<blockquote>
<p><strong>ç»„ä»¶å›¾ï¼ˆComponent Diagramï¼‰æç»˜äº†ç»„æˆä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿçš„æ¨¡å—å’ŒåµŒå…¥æ§ä»¶</strong>ã€‚ç»„ä»¶å›¾æ¯”ç±»å›¾å…·æœ‰æ›´é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼é€šå¸¸è¿è¡Œæ—¶ä¸€ä¸ªç»„ä»¶è¢«ä¸€ä¸ªæˆ–å¤šä¸ªç±»ï¼ˆæˆ–å¯¹è±¡ï¼‰å®ç°ã€‚å®ƒä»¬è±¡ç§¯æœ¨é‚£æ ·ä½¿å¾—ç»„ä»¶èƒ½æœ€ç»ˆæ„æˆç³»ç»Ÿçš„ç»å¤§éƒ¨åˆ†ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-component-diagram.gif"/></div>
<p>ä¸Šå›¾æ¼”ç¤ºäº†ä¸€äº›ç»„ä»¶å’Œå®ƒä»¬çš„å†…éƒ¨å…³ç³»ã€‚è£…é…è¿æ¥å™¨ï¼ˆAssembly connectorsï¼‰â€œè¿æ¥â€ç”±&quot;Product&quot;å’Œ&quot;Customer&quot;çš„æä¾›æ¥å£åˆ°ç”± &quot;Order&quot;æŒ‡å®šçš„éœ€æ±‚æ¥å£ã€‚ ä¸€ä¸ªä¾èµ–å…³ç³»æ˜ å°„äº†å®¢æˆ·ç›¸å…³çš„å¸æˆ·ä¿¡æ¯åˆ°â€œOrderâ€éœ€è¦çš„ &quot;Payment&quot;éœ€æ±‚æ¥å£ã€‚</p>
<p>å®é™…ä¸Šï¼Œç»„ä»¶å›¾åŒåŒ…å›¾å¾ˆç›¸ä¼¼ï¼Œå®ƒä»¬éƒ½æœ‰æ˜ç¡®çš„ç•Œé™ï¼ŒæŠŠå…ƒç´ åˆ†ç»„åˆ°é€»è¾‘ç»“æ„ä¸­ã€‚ä»–ä»¬ä¹‹é—´çš„ä¸åŒæ˜¯ï¼šç»„ä»¶å›¾æä¾›äº†è¯­ä¹‰æ›´ä¸°å¯Œçš„åˆ†ç»„æœºåˆ¶ï¼Œåœ¨ç»„ä»¶å›¾ä¸­ï¼Œæ‰€æœ‰çš„æ¨¡å‹å…ƒç´ éƒ½æ˜¯ç§æœ‰çš„ï¼Œè€ŒåŒ…å›¾åªæ˜¾ç¤ºå…¬æœ‰çš„æˆå‘˜ã€‚</p>
<h3 id="è¡¨ç°ç»„ä»¶"><a class="markdownIt-Anchor" href="#è¡¨ç°ç»„ä»¶"></a> è¡¨ç°ç»„ä»¶</h3>
<p>ç»„ä»¶å¯è¡¨ç¤ºä¸ºå¸¦å…³é”®å­— Â«componentÂ»çš„çŸ©å½¢ç±»å…ƒï¼›ä¹Ÿå¯ç”¨å³ä¸Šè§’æœ‰ç»„ä»¶å›¾æ ‡çš„çŸ©å½¢è¡¨ç¤ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-representing-components.gif"/></div>
<h3 id="è£…é…è¿æ¥å™¨"><a class="markdownIt-Anchor" href="#è£…é…è¿æ¥å™¨"></a> è£…é…è¿æ¥å™¨</h3>
<p>è£…é…è¿æ¥å™¨åœ¨ç»„ä»¶ â€œComponent1â€çš„éœ€æ±‚æ¥å£å’Œå¦ä¸€ä¸ªç»„ä»¶ â€œComponent2â€çš„æä¾›æ¥å£ä¹‹é—´å»ºç«‹æ¡¥æ¢; è¿™ä¸ªæ¡¥æ¢ä½¿å¾—ä¸€ä¸ªç»„ä»¶èƒ½æä¾›å¦ä¸€ä¸ªç»„ä»¶æ‰€éœ€è¦çš„æœåŠ¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-required-interfaces.gif"/></div>
<h3 id="å¸¦ç«¯å£ç»„ä»¶"><a class="markdownIt-Anchor" href="#å¸¦ç«¯å£ç»„ä»¶"></a> å¸¦ç«¯å£ç»„ä»¶</h3>
<p>ä½¿ç”¨ç«¯å£çš„ç»„ä»¶å›¾å…è®¸åœ¨å®ƒçš„ç¯å¢ƒæŒ‡å®šä¸€ä¸ªæœåŠ¡å’Œè¡Œä¸ºï¼ŒåŒæ—¶è¿™ä¸ªæœåŠ¡å’Œè¡Œä¸ºä¹Ÿæ˜¯ç»„ä»¶éœ€è¦çš„ã€‚å½“ç«¯å£è¿›è¡ŒåŒå‘æ“ä½œçš„æ—¶å€™ï¼Œå®ƒå¯ä»¥æŒ‡å®šè¾“å…¥å’Œè¾“å‡ºã€‚ä¸‹å›¾è¯¦è¿°äº†ç”¨äºåœ¨çº¿æœåŠ¡çš„å¸¦ç«¯å£ç»„ä»¶ï¼Œå®ƒæœ‰ä¸¤ä¸ªæä¾›æ¥å£ â€œorder entryâ€å’Œ â€œtrackingâ€ï¼Œä¹Ÿæœ‰ â€œpaymentâ€ éœ€æ±‚æ¥å£ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-component-with-ports.gif"/></div>
<h2 id="åŒ…å›¾"><a class="markdownIt-Anchor" href="#åŒ…å›¾"></a> åŒ…å›¾</h2>
<blockquote>
<p><strong>åŒ…å›¾ï¼ˆPackage Diagramï¼‰ç”¨æ¥è¡¨ç°åŒ…å’Œå®ƒæ‰€åŒ…å«å…ƒç´ çš„ç»„ç»‡</strong>ã€‚å½“ç”¨æ¥ä»£è¡¨ç±»å…ƒç´ æ—¶ï¼ŒåŒ…å›¾æä¾›äº†å‘½åç©ºé—´çš„å¯è§†åŒ–ã€‚åŒ…å›¾æœ€å¸¸ç”¨çš„ç”¨é€”æ˜¯ç”¨æ¥ç»„ç»‡ç”¨ä¾‹å›¾å’Œç±»å›¾ï¼Œå°½ç®¡å®ƒä¸å±€é™äºè¿™äº› UML å…ƒç´ ã€‚</p>
</blockquote>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŒ…å›¾çš„ä¾‹å­ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-package-diagram.gif"/></div>
<p>åŒ…ä¸­çš„å…ƒç´ å…±äº«ç›¸åŒçš„å‘½åç©ºé—´ï¼Œå› æ­¤ï¼Œä¸€ä¸ªæŒ‡å®šå‘½åç©ºé—´çš„å…ƒç´ å¿…é¡»æœ‰å”¯ä¸€çš„åç§°ã€‚</p>
<p>åŒ…å¯ä»¥ç”¨æ¥ä»£è¡¨ç‰©ç†æˆ–é€»è¾‘å…³ç³»ã€‚é€‰æ‹©æŠŠç±»åŒ…æ‹¬åœ¨æŒ‡å®šçš„åŒ…é‡Œï¼Œæœ‰åŠ©äºåœ¨åŒä¸€ä¸ªåŒ…é‡Œèµ‹äºˆè¿™äº›ç±»ç›¸åŒç»§æ‰¿å±‚æ¬¡ã€‚é€šå¸¸è®¤ä¸ºæŠŠé€šè¿‡å¤åˆç›¸å…³è”çš„ç±»ï¼Œä»¥åŠä¸å®ƒä»¬ç›¸åä½œçš„ç±»æ”¾åœ¨åŒä¸€ä¸ªåŒ…é‡Œã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-package.gif"/></div>
<p>åœ¨ UML2.5 ä¸­ï¼ŒåŒ…ç”¨æ–‡ä»¶å¤¹æ¥è¡¨ç¤ºï¼ŒåŒ…ä¸­çš„å…ƒç´ å…±äº«åŒä¸€ä¸ªå‘½åç©ºé—´ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯å¯è¯†åˆ«çš„ï¼Œå› æ­¤è¦æœ‰å”¯ä¸€çš„åç§°æˆ–ç±»å‹ã€‚åŒ…å¿…é¡»æ˜¾ç¤ºåŒ…åï¼Œåœ¨é™„å±æ–¹æ¡†éƒ¨åˆ†æœ‰é€‰æ‹©çš„æ˜¾ç¤ºåŒ…å†…çš„å…ƒç´ ã€‚</p>
<ul>
<li><strong>åŒ…çš„åˆå¹¶</strong> - åŒ…ä¹‹é—´çš„åˆå¹¶è¿æ¥ç¬¦Â«mergeÂ»å®šä¹‰äº†æºåŒ…å…ƒç´ ä¸ç›®æ ‡åŒ…åŒåå…ƒç´ ä¹‹é—´çš„æ³›åŒ–å…³ç³»ã€‚æºåŒ…å…ƒç´ çš„å®šä¹‰è¢«æ‰©å±•æ¥åŒ…å«ç›®æ ‡åŒ…å…ƒç´ å®šä¹‰ã€‚å½“æºåŒ…å…ƒç´ ä¸ç›®æ ‡åŒ…å†…æ²¡æœ‰åŒåå…ƒç´ æ—¶ï¼Œç›®æ ‡åŒ…å…ƒç´ çš„å®šä¹‰ä¸å—å½±å“ã€‚</li>
<li><strong>åŒ…çš„å¯¼å…¥</strong> - å¯¼å…¥è¿æ¥ç¬¦ Â«importÂ»è¡¨æ˜ç›®æ ‡åŒ…çš„å…ƒç´ ï¼Œåœ¨è¯¥ä¾‹ä¸­æ˜¯ä¸€ä¸ªç±» ï¼Œåœ¨æºåŒ…ä¸­è¢«å¼•ç”¨è¦ç”¨éé™å®šä¿®é¥°åã€‚æºåŒ…çš„å‘½åç©ºé—´è·å¾—ç›®æ ‡ç±»çš„æ¥å£ï¼Œç›®æ ‡åŒ…çš„å‘½åç©ºé—´åˆ™ä¸å—å½±å“ã€‚</li>
<li><strong>åµŒå¥—è¿æ¥ç¬¦</strong> - æºåŒ…å’Œç›®æ ‡åŒ…é—´çš„åµŒå¥—è¿æ¥ç¬¦è¯´æ˜ç›®æ ‡åŒ…å®Œå…¨åŒ…å«æºåŒ…ã€‚</li>
</ul>
<h2 id="ç±»å›¾"><a class="markdownIt-Anchor" href="#ç±»å›¾"></a> ç±»å›¾</h2>
<blockquote>
<p><strong>ç±»å›¾ï¼ˆClass Diagramï¼‰å±•ç¤ºäº†é¢å‘å¯¹è±¡ç³»ç»Ÿçš„æ„é€ æ¨¡å—</strong>ã€‚æç»˜äº†æ¨¡å‹æˆ–éƒ¨åˆ†æ¨¡å‹çš„é™æ€è§†å›¾ï¼Œæ˜¾ç¤ºå®ƒåŒ…å«çš„å±æ€§å’Œè¡Œä¸ºï¼Œè€Œä¸æ˜¯è¯¦ç»†æè¿°æ“ä½œçš„åŠŸèƒ½æˆ–å®Œå–„æ–¹æ³•ã€‚ç±»å›¾æœ€å¸¸ç”¨æ¥è¡¨è¾¾å¤šä¸ªç±»å’Œæ¥å£ä¹‹é—´çš„å…³ç³»ã€‚æ³›åŒ–ï¼ˆGeneralizationsï¼‰ï¼Œèšåˆï¼ˆaggregationsï¼‰å’Œå…³è”ï¼ˆassociationsï¼‰åˆ†åˆ«æ˜¯ç±»ä¹‹é—´ç»§æ‰¿ï¼Œå¤åˆæˆ–åº”ç”¨ï¼ŒåŠè¿æ¥çš„è¡¨ç°ã€‚</p>
</blockquote>
<p>ä¸‹é¢çš„å›¾æ˜¾ç¤ºäº†ç±»ä¹‹é—´çš„èšåˆå…³ç³»ã€‚å¼±èšåˆï¼ˆæµ…è‰²ç®­å¤´ï¼‰è¡¨ç°åœ¨ç±» â€œAccountâ€ ä½¿ç”¨ â€œAddressBookâ€ï¼Œä½†æ˜¯ä¸å¿…è¦åŒ…å«å®ƒçš„ä¸€ä¸ªå®ä¾‹ã€‚å¼ºèšåˆï¼ˆå›¾ä¸­çš„é»‘è‰²ç®­å¤´ï¼‰è¡¨ç¤ºäº†ç›®æ ‡ç±»åŒ…å«æºç±»ï¼Œä¾‹å¦‚ï¼Œâ€œContactâ€ å’Œ &quot;ContactGroup&quot;å€¼è¢«åŒ…å«åœ¨ &quot;AddressBook&quot;ä¸­ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-class-diagram.png"/></div>
<h3 id="ç±»classes"><a class="markdownIt-Anchor" href="#ç±»classes"></a> ç±»ï¼ˆClassesï¼‰</h3>
<p>ç±»æ˜¯å®šä¹‰å¯¹è±¡æ‰€å…·æœ‰çš„å±æ€§å’Œè¡Œä¸ºçš„å…ƒç´ ã€‚è¡Œä¸ºç”¨ç±»èƒ½ç†è§£çš„åˆé€‚æ¶ˆæ¯å’Œé€‚åˆæ¯æ¡æ¶ˆæ¯çš„æ“ä½œæ¥æè¿°ã€‚ ç±»ä¸­ä¹Ÿå¯èƒ½å®šä¹‰çº¦æŸï¼Œæ ‡è®°å€¼ï¼Œæ„é€ å‹ã€‚</p>
<h3 id="ç±»çš„æ ‡æŸ±class-notation"><a class="markdownIt-Anchor" href="#ç±»çš„æ ‡æŸ±class-notation"></a> ç±»çš„æ ‡æŸ±ï¼ˆClass Notationï¼‰</h3>
<p>ç±»ç”¨çŸ©å½¢è¡¨ç¤ºã€‚é™¤ç±»çš„åç§°å¤–ï¼Œè¿˜å¯ä»¥é€‰æ‹©æ€§åœ°æ˜¾ç¤ºå±æ€§å’Œæ“ä½œã€‚ åˆ†æ åˆ†åˆ«ç”¨æ¥æ˜¾ç¤ºç±»çš„åç§°ï¼Œå±æ€§å’Œæ“ä½œã€‚</p>
<p>åœ¨ä¸‹é¢å›¾ä¸­ï¼Œç±»çš„ç±»åæ˜¾ç¤ºåœ¨æœ€ä¸Šé¢çš„åˆ†æ ï¼Œå®ƒä¸‹é¢çš„åˆ†æ æ˜¾ç¤ºè¯¦ç»†å±æ€§ï¼Œå¦‚ï¼šâ€œcenterâ€ å±æ€§æ˜¾ç¤ºåˆå§‹åŒ–çš„å€¼ã€‚æœ€åé¢çš„åˆ†æ æ˜¾ç¤ºæ“ä½œï¼Œå¦‚ï¼š setWidthï¼ŒsetLength å’Œ setPosition ä»¥åŠä»–ä»¬çš„å‚æ•°ã€‚ å±æ€§å’Œæ“ä½œåå‰çš„æ ‡æ³¨è¡¨ç¤ºäº†è¯¥å±æ€§æˆ–æ“ä½œçš„å¯è§æ€§: å¦‚æœä½¿ç”¨ &quot;+&quot;å·ï¼Œè¿™ä¸ªå±æ€§æˆ–æ“ä½œæ˜¯å…¬å…±çš„ ; â€œ-â€ å·åˆ™ä»£è¡¨è¿™ä¸ªå±æ€§æˆ–æ“ä½œæ˜¯ç§æœ‰çš„ã€‚ â€œ#â€œå·æ˜¯è¿™ä¸ªå±æ€§æˆ–æ“ä½œè¢«å®šä¹‰ä¸ºä¿æŠ¤çš„ï¼Œâ€ ~â€ å·ä»£è¡¨åŒ…çš„å¯è§æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-class.gif"/></div>
<h3 id="æ¥å£interfaces"><a class="markdownIt-Anchor" href="#æ¥å£interfaces"></a> æ¥å£ï¼ˆInterfacesï¼‰</h3>
<p>æ¥å£æ˜¯å®æ–½è€…åŒæ„æ»¡è¶³çš„è¡Œä¸ºè§„èŒƒï¼Œæ˜¯ä¸€ç§çº¦å®šã€‚å®ç°ä¸€ä¸ªæ¥å£ï¼Œç±»å¿…éœ€æ”¯æŒå…¶è¦æ±‚çš„è¡Œä¸ºï¼Œä½¿ç³»ç»ŸæŒ‰ç…§åŒæ ·çš„æ–¹å¼ï¼Œå³å…¬å…±çš„æ¥å£ï¼Œå¤„ç†ä¸ç›¸å…³çš„å…ƒç´ ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-class-interface.gif"/></div>
<p>æ¥å£æœ‰ç›¸ä¼¼äºç±»çš„å¤–å½¢é£æ ¼ï¼Œå«æœ‰æŒ‡å®šçš„æ“ä½œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¦‚æœæ²¡æœ‰æ˜ç¡®çš„è¯¦ç»†æ“ä½œï¼Œä¹Ÿå¯ä»¥ç”»æˆä¸€ä¸ªåœ†ç¯ã€‚å½“ç”»æˆåœ†ç¯çš„æ—¶å€™ï¼Œåˆ°è¿™ä¸ªç¯å½¢æ ‡æŸ±çš„å®ç°è¿æ¥æ²¡æœ‰ç›®æ ‡ç®­å¤´ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-interface.gif"/></div>
<h3 id="è¡¨tables"><a class="markdownIt-Anchor" href="#è¡¨tables"></a> è¡¨ï¼ˆTablesï¼‰</h3>
<p>è¡¨å°½ç®¡ä¸æ˜¯åŸºæœ¬ UML çš„ä¸€éƒ¨åˆ†ï¼Œä»ç„¶æ˜¯â€œå›¾å‹â€èƒ½å®Œæˆçš„å®ä¾‹ç”¨ã€‚åœ¨å³ä¸Šè§’ç”»ä¸€ä¸ªè¡¨çš„å°å›¾æ ‡æ¥è¡¨ç¤ºã€‚è¡¨å±æ€§ç”¨â€œå›¾å‹â€ Â«columnÂ»è¡¨ç¤ºã€‚ ç»å¤§å¤šæ•°è¡¨å•æœ‰ä¸€ä¸ªä¸»é”®ï¼Œæ˜¯ç”±ä¸€ä¸ªæˆ–å‡ ä¸ªå­—æ®µç»„æˆçš„ä¸€ä¸ªå”¯ä¸€çš„å­—ç ç»„åˆåŠ ä¸»é”®æ“ä½œæ¥è®¿é—®è¡¨æ ¼ï¼Œä¸»é”®æ“ä½œâ€œå›¾å‹â€ä¸ºÂ«PKÂ»ã€‚ ä¸€äº›è¡¨æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå¤–é”®ï¼Œä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µåŠ ä¸€ä¸ªå¤–é”®æ“ä½œï¼Œæ˜ å°„åˆ°ç›¸å…³è¡¨çš„ä¸»é”®ä¸Šå»ï¼Œå¤–é”®æ“ä½œâ€œå›¾å‹â€ä¸ºÂ«FKÂ»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-table.gif"/></div>
<h3 id="å…³è”associations"><a class="markdownIt-Anchor" href="#å…³è”associations"></a> å…³è”ï¼ˆAssociationsï¼‰</h3>
<p>å…³è”è¡¨æ˜ä¸¤ä¸ªæ¨¡å‹å…ƒç´ ä¹‹é—´æœ‰å…³ç³»ï¼Œé€šå¸¸ç”¨åœ¨ä¸€ä¸ªç±»ä¸­è¢«å®ç°ä¸ºä¸€ä¸ªå®ä¾‹å˜é‡ã€‚è¿æ¥ç¬¦å¯ä»¥åŒ…å«ä¸¤ç«¯çš„å‘½åçš„è§’è‰²ï¼ŒåŸºæ•°æ€§ï¼Œæ–¹å‘å’Œçº¦æŸã€‚å…³è”æ˜¯å…ƒç´ ä¹‹é—´æ™®é€šçš„å…³ç³»ã€‚å¦‚æœå¤šäºä¸¤ä¸ªå…ƒç´ ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è±å½¢çš„å…³è”å…³ç³»ã€‚å½“ä»ç±»å›¾ç”Ÿæˆä»£ç æ—¶ï¼Œå…³è”æœ«ç«¯çš„å¯¹è±¡å°†å˜æˆç›®æ ‡ç±»ä¸­å®ä¾‹å˜é‡ã€‚è§ä¸‹å›¾ç¤ºä¾‹ â€œplaysForâ€ å°†å˜æˆ&quot;Player&quot;ç±»ä¸­çš„å®ä¾‹å˜é‡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-associations.gif"/></div>
<h3 id="æ³›åŒ–generalizations"><a class="markdownIt-Anchor" href="#æ³›åŒ–generalizations"></a> æ³›åŒ–ï¼ˆGeneralizationsï¼‰</h3>
<p>æ³›åŒ–è¢«ç”¨æ¥è¯´æ˜ç»§æ‰¿å…³ç³»ã€‚è¿æ¥ä»ç‰¹å®šç±»å…ƒåˆ°ä¸€èˆ¬ç±»å…ƒã€‚æ³›åŒ–çš„å«ä¹‰æ˜¯æºç±»ç»§æ‰¿äº†ç›®æ ‡ç±»çš„ç‰¹æ€§ã€‚ä¸‹å›¾çš„å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªçˆ¶ç±»æ³›åŒ–ä¸€ä¸ªå­ç±»ï¼Œ ç±»â€œCircleâ€çš„ä¸€ä¸ªå®ä¾‹å°†ä¼šæœ‰å±æ€§ â€œ x_positionâ€ï¼Œâ€œ y_positionâ€ ï¼Œ â€œradiusâ€ å’Œ æ–¹æ³• â€œdisplay()â€ã€‚ æ³¨æ„ï¼šç±» â€œShapeâ€ æ˜¯æŠ½è±¡çš„ï¼Œç±»åæ˜¾ç¤ºä¸ºæ–œä½“ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-generalizations.gif"/></div>
<p>ä¸‹å›¾æ˜¾ç¤ºäº†ä¸ä¸Šå›¾ç›¸åŒä¿¡æ¯çš„è§†å›¾ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-generalizations-02.gif"/></div>
<h3 id="èšåˆaggregations"><a class="markdownIt-Anchor" href="#èšåˆaggregations"></a> èšåˆï¼ˆAggregationsï¼‰</h3>
<p>èšåˆé€šå¸¸è¢«ç”¨æ¥æè¿°ç”±æ›´å°çš„ç»„ä»¶æ‰€æ„æˆçš„å…ƒç´ ã€‚èšåˆå…³ç³»è¡¨ç¤ºä¸ºç™½è‰²è±å½¢ç®­å¤´æŒ‡å‘ç›®æ ‡ç±»æˆ–çˆ¶ç±»ã€‚</p>
<p>èšåˆçš„æ›´å¼ºå½¢å¼ -ç»„åˆèšåˆï¼ˆå¼ºèšåˆï¼‰ - æ˜¾ç¤ºä¸ºé»‘è‰²è±å½¢ç®­å¤´ï¼Œç”¨æ¥ç»„åˆæ¯æ¬¡æœ€å¤§åŒ–çš„åŒ…å«ç»„ä»¶ã€‚å¦‚æœä¸€ä¸ªç»„åˆèšåˆçš„çˆ¶ç±»è¢«åˆ é™¤ï¼Œé€šå¸¸ä¸ä»–ç›¸å…³çš„æ‰€æœ‰éƒ¨åˆ†éƒ½ä¼šè¢«åˆ é™¤ï¼Œä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªéƒ¨ä»¶ä»ç»„åˆä¸­å»æ‰ï¼Œå°†ä¸ç”¨åˆ é™¤æ•´ä¸ªç»„åˆã€‚ç»„åˆæ˜¯å¯è¿ï¼Œéå¯¹ç§°çš„å…³ç³»å’Œé€’å½’çš„ã€‚</p>
<p>ä¸‹é¢çš„å›¾ç¤ºï¼šæ˜¾ç¤ºäº†å¼±èšåˆå’Œå¼ºèšåˆçš„ä¸åŒã€‚â€œ address bookâ€ ç”±è®¸å¤š â€œcontactsâ€ å’Œ â€œcontact groupsâ€ç»„æˆã€‚ â€œcontact groupâ€ æ˜¯ä¸€ä¸ªâ€œcontactsâ€çš„è™šåˆ†ç»„; â€œcontactâ€å¯ä»¥è¢«åŒ…å«åœ¨ä¸æ­¢ä¸€ä¸ª â€œ contact groupâ€ã€‚ å¦‚æœä½ åˆ é™¤ä¸€ä¸ªâ€œ address bookâ€ï¼Œæ‰€æœ‰çš„ â€œcontactsâ€ å’Œ â€œcontact groupsâ€ ä¹Ÿå°†ä¼šè¢«åˆ é™¤ï¼›å¦‚æœä½ åˆ é™¤â€œ contact groupâ€ï¼Œ æ²¡æœ‰ â€œcontactsâ€ä¼šè¢«åˆ é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-aggregations.gif"/></div>
<h3 id="å…³è”ç±»association-classes"><a class="markdownIt-Anchor" href="#å…³è”ç±»association-classes"></a> å…³è”ç±»ï¼ˆAssociation Classesï¼‰</h3>
<p>å…³è”ç±»æ˜¯ä¸€ä¸ªå…è®¸å…³è”è¿æ¥æœ‰å±æ€§å’Œæ“ä½œçš„æ„é€ ã€‚ä¸‹é¢çš„ç¤ºä¾‹ï¼šæ˜¾ç¤ºäº†è¿œä¸æ­¢ç®€å•è¿æ¥ä¸¤ä¸ªç±»çš„è¿æ¥ï¼Œå¦‚ç»™â€œemployeeâ€åˆ†é…é¡¹ç›®ã€‚â€œ employeeâ€åœ¨é¡¹ç›®ä¸­æ‰€èµ·çš„ä½œç”¨æ˜¯ä¸€ä¸ªå¤æ‚çš„å®ä½“ï¼Œæ—¢æœ‰è‡ªèº«çš„ä¹Ÿæœ‰ä¸å±äºâ€œemployeeâ€ æˆ– â€œprojectâ€ ç±»çš„ç»†èŠ‚ã€‚ ä¾‹å¦‚ï¼Œâ€œ employeeâ€å¯ä»¥åŒæ—¶ä¸ºå‡ ä¸ªé¡¹ç›®å·¥ä½œï¼Œæœ‰ä¸åŒçš„èŒåŠ¡å¤´è¡”å’Œå¯¹åº”çš„å®‰å…¨æƒé™ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-association-classes.gif"/></div>
<h3 id="ä¾èµ–dependencies"><a class="markdownIt-Anchor" href="#ä¾èµ–dependencies"></a> ä¾èµ–ï¼ˆDependenciesï¼‰</h3>
<p>ä¾èµ–è¢«ç”¨æ¥æè¿°æ¨¡å‹å…ƒç´ é—´å¹¿æ³›çš„ä¾èµ–å…³ç³»ã€‚é€šå¸¸åœ¨è®¾è®¡è¿‡ç¨‹æ—©æœŸæ˜¾ç¤ºä¸¤ä¸ªå…ƒç´ ä¹‹é—´å­˜åœ¨æŸç§å…³ç³»ï¼Œå› ä¸ºæ˜¯åˆæœŸè€Œä¸èƒ½ç¡®å®šå…·ä½“æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œåœ¨è®¾è®¡è¿‡ç¨‹æœ«æœŸï¼Œè¯¥ç»§æ‰¿å…³ç³»ä¼šè¢«å½’å…¥å·²æœ‰æ„é€ å‹ (æ„é€ å‹ å¯ä»¥æ˜¯å®ä¾‹åŒ– Â«instantiateÂ»ï¼Œè·Ÿè¸ª Â«traceÂ»ï¼Œå¯¼å…¥ Â«importÂ»ï¼Œ å’Œå…¶å®ƒçš„å…³ç³»)ï¼Œæˆ–è¢«æ›¿æ¢æˆä¸€ä¸ªæ›´æ˜ç¡®ç±»å‹çš„è¿æ¥ç¬¦ã€‚</p>
<h3 id="è·Ÿè¸ªtraces"><a class="markdownIt-Anchor" href="#è·Ÿè¸ªtraces"></a> è·Ÿè¸ªï¼ˆTracesï¼‰</h3>
<p>è·Ÿè¸ªå…³ç³»æ˜¯ä¸€ç§ç‰¹æ®ŠåŒ–çš„ä¾èµ–å…³ç³»ã€‚è¿æ¥æ¨¡å‹å…ƒç´ æˆ–è·¨æ¨¡å‹ä½†æ˜¯å…·æœ‰ç›¸åŒæ¦‚å¿µçš„æ¨¡å‹å…ƒç´ é›†ã€‚è·Ÿè¸ªè¢«ç»å¸¸ç”¨æ¥è¿½è¸ªéœ€æ±‚å’Œæ¨¡å‹çš„å˜åŒ–ã€‚ç”±äºå˜åŒ–æ˜¯åŒå‘çš„ï¼Œè¿™ç§ä¾èµ–å…³ç³»çš„é¡ºåºé€šå¸¸è¢«å¿½ç•¥ã€‚è¿™ç§å…³ç³»çš„å±æ€§å¯ä»¥è¢«æŒ‡å®šä¸ºå•å‘æ˜ å°„ï¼Œä½†è·Ÿè¸ªæ˜¯åŒå‘çš„ï¼Œéæ­£å¼çš„å’Œå¾ˆå°‘å¯è®¡ç®—çš„ã€‚</p>
<h3 id="å®ç°realizations"><a class="markdownIt-Anchor" href="#å®ç°realizations"></a> å®ç°ï¼ˆRealizationsï¼‰</h3>
<p>æ˜¯æºå¯¹è±¡æ‰§è¡Œæˆ–å®ç°ç›®æ ‡ï¼Œå®ç°è¢«ç”¨æ¥è¡¨è¾¾æ¨¡å‹çš„å¯è·Ÿè¸ªæ€§å’Œå®Œæ•´æ€§ï¼ä¸šåŠ¡æ¨¡å‹æˆ–éœ€æ±‚è¢«ä¸€ä¸ªæˆ–å¤šä¸ªç”¨ä¾‹å®ç°ï¼Œç”¨ä¾‹åˆ™è¢«ç±»å®ç°ï¼Œç±»è¢«ç»„ä»¶å®ç°ï¼Œç­‰ç­‰ã€‚è¿™ç§å®ç°è´¯ç©¿äºç³»ç»Ÿè®¾è®¡çš„æ˜ å°„éœ€æ±‚å’Œç±»ç­‰ï¼Œç›´è‡³æŠ½è±¡å»ºæ¨¡æ°´å¹³çº§ã€‚ä»è€Œç¡®ä¿æ•´ä¸ªç³»ç»Ÿçš„ä¸€å¼ å®å›¾ï¼Œå®ƒä¹Ÿåæ˜ ç³»ç»Ÿçš„æ‰€æœ‰å¾®å°ç»„æˆï¼Œä»¥åŠçº¦æŸå’Œå®šä¹‰å®ƒçš„ç»†èŠ‚ã€‚å®ç°å…³ç³»ç”¨å¸¦è™šçº¿çš„å®ç®­å¤´è¡¨ç¤ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-realizations.gif"/></div>
<h3 id="åµŒå¥—nestings"><a class="markdownIt-Anchor" href="#åµŒå¥—nestings"></a> åµŒå¥—ï¼ˆNestingsï¼‰</h3>
<p>åµŒå¥—è¿æ¥ç¬¦ç”¨æ¥è¡¨ç¤ºæºå…ƒç´ åµŒå¥—åœ¨ç›®æ ‡å…ƒç´ ä¸­ã€‚ä¸‹å›¾æ˜¾ç¤ºâ€œ inner classâ€çš„å®šä¹‰ï¼Œå°½ç®¡åœ¨ EA ä¸­ï¼Œæ›´å¤šåœ°æŒ‰ç…§ç€ä»–ä»¬åœ¨é¡¹ç›®å±‚æ¬¡è§†å›¾ä¸­çš„ä½ç½®æ¥æ˜¾ç¤ºè¿™ç§å…³ç³»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-nestings.gif"/></div>
<h2 id="å¤åˆç»“æ„å›¾"><a class="markdownIt-Anchor" href="#å¤åˆç»“æ„å›¾"></a> å¤åˆç»“æ„å›¾</h2>
<blockquote>
<p><strong>å¤åˆç»“æ„å›¾æ˜¾ç¤ºç±»çš„å†…éƒ¨ç»“æ„ï¼ŒåŒ…æ‹¬å®ƒä¸ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†çš„äº¤äº’ç‚¹ã€‚ä¹Ÿæ˜¾ç¤ºå„éƒ¨åˆ†çš„é…ç½®ä¸å…³ç³»ï¼Œè¿™äº›éƒ¨åˆ†ä¸€èµ·æ‰§è¡Œç±»å…ƒçš„è¡Œä¸ºã€‚</strong></p>
</blockquote>
<p>ç±»å…ƒç´ å·²ç»åœ¨ç±»å›¾éƒ¨åˆ†è¢«è¯¦ç»†åœ°é˜è¿°ï¼Œè¿™éƒ¨åˆ†ç”¨æ¥è¯´æ˜ç±»è¡¨ç°å¤åˆå…ƒç´ çš„æ–¹å¼ï¼Œå¦‚ï¼šæš´éœ²æ¥å£ï¼ŒåŒ…å«ç«¯å£å’Œéƒ¨ä»¶ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-composite-structure-diagram.gif"/></div>
<h3 id="éƒ¨ä»¶"><a class="markdownIt-Anchor" href="#éƒ¨ä»¶"></a> éƒ¨ä»¶</h3>
<p>éƒ¨ä»¶æ˜¯ä»£è¡¨ä¸€ç»„ï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰å®ä¾‹çš„å…ƒç´ ï¼Œè¿™ç»„å®ä¾‹çš„æ‹¥æœ‰è€…æ˜¯ä¸€ç±»å…ƒå®ä¾‹ï¼Œä¾‹å¦‚ï¼šå¦‚æœä¸€ä¸ªå›¾çš„å®ä¾‹æœ‰ä¸€ç»„å›¾å½¢å…ƒç´ ï¼Œåˆ™è¿™äº›å›¾å½¢å…ƒç´ å¯ä»¥è¢«è¡¨ç¤ºä¸ºéƒ¨ä»¶ï¼Œå¹¶å¯ä»¥å¯¹ä»–ä»¬ä¹‹é—´çš„æŸç§å…³ç³»å»ºæ¨¡ã€‚æ³¨æ„ï¼šä¸€ä¸ªéƒ¨ä»¶å¯ä»¥åœ¨å®ƒçš„çˆ¶ç±»è¢«åˆ é™¤ä¹‹å‰ä»çˆ¶ç±»ä¸­è¢«å»æ‰ï¼Œè¿™æ ·éƒ¨ä»¶å°±ä¸ä¼šè¢«åŒæ—¶åˆ é™¤äº†ã€‚<br />
éƒ¨ä»¶åœ¨ç±»æˆ–ç»„ä»¶å†…éƒ¨æ˜¾ç¤ºä¸ºä¸åŠ ä¿®é¥°çš„æ–¹æ¡†ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-part.gif"/></div>
<h3 id="ç«¯å£"><a class="markdownIt-Anchor" href="#ç«¯å£"></a> ç«¯å£</h3>
<p>ç«¯å£æ˜¯ç±»å‹åŒ–çš„å…ƒç´ ï¼Œä»£è¡¨ä¸€ä¸ªåŒ…å«ç±»å…ƒå®ä¾‹çš„å¤–éƒ¨å¯è§†çš„éƒ¨åˆ†ã€‚ç«¯å£å®šä¹‰äº†ç±»å…ƒå’Œå®ƒçš„ç¯å¢ƒä¹‹é—´çš„äº¤äº’ã€‚ç«¯å£æ˜¾ç¤ºåœ¨åŒ…å«å®ƒçš„éƒ¨ä»¶ï¼Œç±»æˆ–ç»„åˆç»“æ„çš„è¾¹ç¼˜ä¸Šã€‚ç«¯å£æŒ‡å®šäº†ç±»å…ƒæä¾›çš„æœåŠ¡ï¼Œä»¥åŠç±»å…ƒè¦æ±‚ç¯å¢ƒæä¾›çš„æœåŠ¡ã€‚<br />
ç«¯å£æ˜¾ç¤ºä¸ºæ‰€å±ç±»å…ƒè¾¹ç•ŒæŒ‡å®šçš„æ–¹æ¡†ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-port.gif"/></div>
<h3 id="æ¥å£"><a class="markdownIt-Anchor" href="#æ¥å£"></a> æ¥å£</h3>
<p>æ¥å£ä¸ç±»ç›¸ä¼¼ï¼Œä½†æ˜¯æœ‰ä¸€äº›é™åˆ¶ï¼Œæ‰€æœ‰çš„æ¥å£æ“ä½œéƒ½æ˜¯å…¬å…±å’ŒæŠ½è±¡çš„ï¼Œä¸æä¾›ä»»ä½•é»˜è®¤çš„å®ç°ã€‚æ‰€æœ‰çš„æ¥å£å±æ€§éƒ½å¿…é¡»æ˜¯å¸¸é‡ã€‚ç„¶è€Œï¼Œå½“ä¸€ä¸ªç±»ä»ä¸€ä¸ªå•ç‹¬çš„è¶…çº§ç±»ç»§æ‰¿è€Œæ¥ï¼Œå®ƒå¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚<br />
å½“ä¸€ä¸ªæ¥å£åœ¨å›¾ä¸­å•åˆ—å‡ºæ¥ï¼Œå®ƒæ—¢å¯ä»¥æ˜¾ç¤ºä¸ºç±»å…ƒç´ çš„æ–¹æ¡†ï¼Œå¸¦ Â«interfaceÂ» å…³é”®å­—å’Œè¡¨æ˜å®ƒæ˜¯æŠ½è±¡çš„æ–œä½“åç§°ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºä¸ºåœ†ç¯ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-interface.gif"/></div>
<p>æ³¨æ„ï¼šåœ†ç¯æ ‡æ³¨ä¸æ˜¾ç¤ºæ¥å£æ“ä½œã€‚å½“æ¥å£æ˜¾ç¤ºä¸ºç±»æ‰€æœ‰çš„æ¥å£ï¼Œå®ƒä»¬ä¼šè¢«å½“ä½œæš´éœ²æ¥å£å¼•ç”¨ã€‚æš´éœ²æ¥å£å¯ä»¥å®šä¹‰ä¸ºæ˜¯æä¾›çš„ï¼Œè¿˜æ˜¯éœ€æ±‚çš„ã€‚æä¾›æ¥å£ç¡®è®¤åŒ…å«å®ƒçš„ç±»å…ƒæä¾›æŒ‡å®šæ¥å£å…ƒç´ å®šä¹‰çš„æ“ä½œï¼Œå¯é€šè¿‡ç±»å’Œæ¥å£é—´å®ç°çš„è¿æ¥æ¥å®šä¹‰ã€‚éœ€æ±‚æ¥å£è¯´æ˜è¯¥ç±»å…ƒèƒ½ä¸å…¶ä»–ç±»å…ƒè¿›è¡Œé€šä¿¡ï¼Œè¿™äº›ç±»å…ƒæä¾›äº†æŒ‡å®šæ¥å£å…ƒç´ æ‰€å®šä¹‰çš„æ“ä½œã€‚éœ€æ±‚æ¥å£å¯é€šè¿‡åœ¨ç±»å’Œæ¥å£é—´å»ºç«‹ä¾èµ–è¿æ¥æ¥å®šä¹‰ã€‚<br />
æä¾›æ¥å£æ˜¾ç¤ºä¸ºâ€œå¸¦æ£’çƒä½“â€ï¼Œä¾é™„åœ¨ç±»å…ƒè¾¹ç¼˜ã€‚éœ€æ±‚æ¥å£æ˜¾ç¤ºä¸ºâ€œå¸¦æ£’æ¯ä½“â€ï¼Œä¹Ÿæ˜¯ä¾é™„åœ¨ç±»å…ƒè¾¹ç¼˜ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-interface-02.gif"/></div>
<h3 id="å§”æ‰˜"><a class="markdownIt-Anchor" href="#å§”æ‰˜"></a> å§”æ‰˜</h3>
<p>å§”æ‰˜è¿æ¥å™¨ç”¨æ¥å®šä¹‰ç»„ä»¶å¤–éƒ¨ç«¯å£å’Œæ¥å£çš„å†…éƒ¨å·¥ä½œæ–¹å¼ã€‚å§”æ‰˜è¿æ¥å™¨è¡¨ç¤ºä¸ºå¸¦æœ‰ Â«delegateÂ» å…³é”®å­—çš„ç®­å¤´ã€‚å®ƒè¿æ¥ç»„ä»¶çš„å¤–éƒ¨çº¦å®šï¼Œè¡¨ç°ä¸ºå®ƒçš„ç«¯å£ï¼Œåˆ°ç»„ä»¶éƒ¨ä»¶è¡Œä¸ºçš„å†…éƒ¨å®ç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-delegate.gif"/></div>
<h3 id="åä½œ"><a class="markdownIt-Anchor" href="#åä½œ"></a> åä½œ</h3>
<p>åä½œå®šä¹‰äº†ä¸€ç³»åˆ—å…±åŒåä½œçš„è§’è‰²ï¼Œå®ƒä»¬é›†ä½“å±•ç¤ºä¸€ä¸ªæŒ‡å®šçš„è®¾è®¡åŠŸèƒ½ã€‚åä½œå›¾åº”ä»…ä»…æ˜¾ç¤ºå®ŒæˆæŒ‡å®šä»»åŠ¡æˆ–åŠŸèƒ½çš„è§’è‰²ä¸å±æ€§ã€‚éš”ç¦»ä¸»è¦è§’è‰²æ˜¯ç”¨æ¥ç®€åŒ–ç»“æ„å’Œæ¾„æ¸…è¡Œä¸ºï¼Œä¹Ÿç”¨äºé‡ç”¨ã€‚ä¸€ä¸ªåä½œé€šå¸¸å®ç°ä¸€ä¸ªæ¨¡å¼ã€‚<br />
åä½œå…ƒç´ æ˜¾ç¤ºä¸ºæ¤­åœ†ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-collaboration.gif"/></div>
<h3 id="è§’è‰²ç»‘å®š"><a class="markdownIt-Anchor" href="#è§’è‰²ç»‘å®š"></a> è§’è‰²ç»‘å®š</h3>
<p>è§’è‰²ç»‘å®šè¿æ¥å™¨æ˜¯ä¸€æ¡ä»è¿æ¥åä½œåˆ°æ‰€è¦å®Œæˆè¯¥ä»»åŠ¡ç±»å…ƒçš„è¿çº¿ã€‚å®ƒæ˜¾ç¤ºä¸ºè™šçº¿ï¼Œå¹¶åœ¨ç±»å…ƒç«¯æ˜¾ç¤ºä½œç”¨åã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-role-binding.gif"/></div>
<h3 id="è¡¨ç°"><a class="markdownIt-Anchor" href="#è¡¨ç°"></a> è¡¨ç°</h3>
<p>è¡¨ç°è¿æ¥å™¨ç”¨äºè¿æ¥åä½œåˆ°ç±»å…ƒæ¥è¡¨ç¤ºæ­¤ç±»å…ƒä¸­ä½¿ç”¨äº†è¯¥åä½œã€‚æ˜¾ç¤ºä¸ºå¸¦å…³é”®å­— Â«representsÂ»çš„è™šçº¿ç®­å¤´ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-represent.gif"/></div>
<p>å‘ç”Ÿ<br />
å‘ç”Ÿè¿æ¥å™¨ç”¨äºè¿æ¥åä½œåˆ°ç±»å…ƒæ¥è¡¨ç¤ºæ­¤åä½œè¡¨ç°äº†ï¼ˆåŒåŸæ–‡ï¼‰è¯¥ç±»å…ƒï¼›æ˜¾ç¤ºä¸ºå¸¦å…³é”®å­—Â«occurrenceÂ»çš„è™šçº¿ç®­å¤´ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-occurrence.gif"/></div>
<h2 id="å¯¹è±¡å›¾"><a class="markdownIt-Anchor" href="#å¯¹è±¡å›¾"></a> å¯¹è±¡å›¾</h2>
<blockquote>
<p><strong>å¯¹è±¡å›¾ï¼ˆObject Diagramï¼‰å¯ä»¥è®¤ä¸ºæ˜¯ç±»å›¾çš„ç‰¹æ®Šæƒ…å½¢ï¼Œæ˜¯ç±»å›¾å…ƒç´ å­é›†ï¼Œè¢«ç”¨æ¥åŠæ—¶å¼ºè°ƒåœ¨æŸäº›ç‚¹ï¼Œç±»çš„å®ä¾‹é—´çš„å…³ç³»</strong>ã€‚è¿™å¯¹ç†è§£ç±»å›¾å¾ˆæœ‰å¸®åŠ©ã€‚ä»–ä»¬åœ¨æ„é€ ä¸Šä¸ç±»å›¾æ˜¾ç¤ºæ²¡æœ‰ä¸åŒï¼Œä½†æ˜¯åæ˜ å‡ºå¤šæ ·æ€§å’Œä½œç”¨ã€‚</p>
</blockquote>
<h3 id="ç±»å’Œå¯¹è±¡å…ƒç´ "><a class="markdownIt-Anchor" href="#ç±»å’Œå¯¹è±¡å…ƒç´ "></a> ç±»å’Œå¯¹è±¡å…ƒç´ </h3>
<p>ä¸‹é¢çš„å›¾æ˜¾ç¤ºäº†ç±»å…ƒç´ å’Œå¯¹è±¡å…ƒç´ å¤–è§‚ä¸Šçš„ä¸åŒã€‚æ³¨æ„ï¼šç±»å…ƒç´ åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯åå­—æ ï¼Œå±æ€§æ å’Œæ“ä½œæ ï¼›å¯¹è±¡å…ƒç´ é»˜è®¤ä¸ºæ²¡æœ‰åˆ†æ ã€‚åç§°æ˜¾ç¤ºä¹Ÿæœ‰ä¸åŒï¼šå¯¹è±¡åç§°æœ‰ä¸‹åˆ’çº¿ï¼Œå¹¶å¯èƒ½æ˜¾ç¤ºè¯¥å¯¹è±¡å®ä¾‹åŒ–æ‰€ç”¨ç±»å…ƒçš„åç§°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-object.gif"/></div>
<h3 id="è¿è¡ŒçŠ¶æ€"><a class="markdownIt-Anchor" href="#è¿è¡ŒçŠ¶æ€"></a> è¿è¡ŒçŠ¶æ€</h3>
<p>ç±»å…ƒå…ƒç´ å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„å±æ€§å’Œæ“ä½œã€‚åœ¨å¯¹è±¡å®ä¾‹ä¸­ä¸ä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ã€‚ä½†å¯èƒ½å®šä¹‰å¯¹è±¡çš„è¿è¡ŒçŠ¶æ€ï¼Œæ˜¾ç¤ºç‰¹æ®Šå®ä¾‹çš„å±æ€§è®¾ç½®å€¼ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-run-time-state.gif"/></div>
<h3 id="ç±»å’Œå¯¹è±¡å›¾ç¤ºä¾‹"><a class="markdownIt-Anchor" href="#ç±»å’Œå¯¹è±¡å›¾ç¤ºä¾‹"></a> ç±»å’Œå¯¹è±¡å›¾ç¤ºä¾‹</h3>
<p>ä¸‹å›¾æ˜¯ä¸€ä¸ªå¯¹è±¡å›¾ï¼Œå…¶ä¸­æ’å…¥äº†ç±»å®šä¹‰å›¾ã€‚å®ƒä¾‹ç¤ºå¦‚ä½•ç”¨å¯¹è±¡å›¾æ¥æµ‹è¯•ç±»å›¾ä¸­ä»»åŠ¡å¤šé‡æ€§çš„æ–¹æ³•ã€‚â€œcarâ€ ç±»å¯¹ â€œwheelâ€ ç±»æœ‰â€œ1 å¯¹å¤šâ€ çš„å¤šé‡æ€§ï¼Œä½†æ˜¯å¦‚æœå·²ç»é€‰æ‹©ç”¨â€œ1 å¯¹ 4â€ æ¥æ›¿ä»£ï¼Œé‚£æ ·å°±ä¸ä¼šåœ¨å¯¹è±¡å›¾æ˜¾ç¤ºâ€œ3 ä¸ªè½®å­â€çš„æ±½è½¦ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-object-diagram.gif"/></div>
<h2 id="æ´»åŠ¨å›¾"><a class="markdownIt-Anchor" href="#æ´»åŠ¨å›¾"></a> æ´»åŠ¨å›¾</h2>
<blockquote>
<p>UML ä¸­ï¼Œæ´»åŠ¨å›¾ç”¨æ¥å±•ç¤ºæ´»åŠ¨çš„é¡ºåºã€‚<strong>æ˜¾ç¤ºäº†ä»èµ·å§‹ç‚¹åˆ°ç»ˆç‚¹çš„å·¥ä½œæµï¼Œæè¿°äº†æ´»åŠ¨å›¾ä¸­å­˜åœ¨äºäº‹ä»¶è¿›ç¨‹çš„åˆ¤æ–­è·¯å¾„</strong>ã€‚æ´»åŠ¨å›¾å¯ä»¥ç”¨æ¥è¯¦ç»†é˜è¿°æŸäº›æ´»åŠ¨æ‰§è¡Œä¸­å‘ç”Ÿå¹¶è¡Œå¤„ç†çš„æƒ…å†µã€‚æ´»åŠ¨å›¾å¯¹ä¸šåŠ¡å»ºæ¨¡ä¹Ÿæ¯”è¾ƒæœ‰ç”¨ï¼Œç”¨æ¥è¯¦ç»†æè¿°å‘ç”Ÿåœ¨ä¸šåŠ¡æ´»åŠ¨ä¸­çš„è¿‡ç¨‹ã€‚<br />
ä¸€ä¸ªæ´»åŠ¨å›¾çš„ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-diagram.gif"/></div>
<p>ä¸‹é¢æè¿°ç»„æˆæ´»åŠ¨å›¾çš„å…ƒç´ ã€‚</p>
<h3 id="æ´»åŠ¨"><a class="markdownIt-Anchor" href="#æ´»åŠ¨"></a> æ´»åŠ¨</h3>
<p>æ´»åŠ¨æ˜¯è¡Œä¸ºå‚æ•°åŒ–é¡ºåºçš„è§„èŒƒã€‚æ´»åŠ¨è¢«è¡¨ç¤ºä¸ºåœ†è§’çŸ©å½¢ï¼Œå†…å«å…¨éƒ¨çš„åŠ¨ä½œï¼Œå·¥ä½œæµå’Œå…¶ä»–ç»„æˆæ´»åŠ¨çš„å…ƒç´ ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity.gif"/></div>
<h3 id="åŠ¨ä½œ"><a class="markdownIt-Anchor" href="#åŠ¨ä½œ"></a> åŠ¨ä½œ</h3>
<p>ä¸€ä¸ªåŠ¨ä½œä»£è¡¨æ´»åŠ¨ä¸­çš„ä¸€ä¸ªæ­¥éª¤ã€‚åŠ¨ä½œç”¨åœ†è§’çŸ©å½¢è¡¨ç¤ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-action.gif"/></div>
<h3 id="åŠ¨ä½œçº¦æŸ"><a class="markdownIt-Anchor" href="#åŠ¨ä½œçº¦æŸ"></a> åŠ¨ä½œçº¦æŸ</h3>
<p>åŠ¨ä½œå¯ä»¥é™„å¸¦çº¦æŸï¼Œä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªå¸¦å‰ç½®æ¡ä»¶å’Œåç½®æ¡ä»¶çš„åŠ¨ä½œã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-conditions.gif"/></div>
<h3 id="æ§åˆ¶æµ"><a class="markdownIt-Anchor" href="#æ§åˆ¶æµ"></a> æ§åˆ¶æµ</h3>
<p>æ§åˆ¶æµæ˜¾ç¤ºä¸€ä¸ªåŠ¨ä½œåˆ°ä¸‹ä¸€ä¸ªåŠ¨ä½œçš„æµã€‚è¡¨ç¤ºä¸ºå¸¦ç®­å¤´å®çº¿</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-edge.gif"/></div>
<h3 id="åˆå§‹èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#åˆå§‹èŠ‚ç‚¹"></a> åˆå§‹èŠ‚ç‚¹</h3>
<p>ä¸€ä¸ªå¼€å§‹æˆ–èµ·å§‹ç‚¹ç”¨å¤§é»‘åœ†ç‚¹è¡¨ç¤ºï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-initial.gif"/></div>
<h3 id="ç»“æŸèŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#ç»“æŸèŠ‚ç‚¹"></a> ç»“æŸèŠ‚ç‚¹</h3>
<p>ç»“æŸèŠ‚ç‚¹æœ‰ä¸¤ç§ç±»å‹ï¼šæ´»åŠ¨ç»“æŸèŠ‚ç‚¹å’Œæµç»“æŸèŠ‚ç‚¹ã€‚æ´»åŠ¨ç»“æŸèŠ‚ç‚¹è¡¨ç¤ºä¸ºä¸­å¿ƒå¸¦é»‘ç‚¹çš„åœ†ç¯ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-final.gif"/></div>
<p>æµç»“æŸèŠ‚ç‚¹è¡¨ç¤ºä¸ºå†…éƒ¨ä¸ºå‰å·çš„åœ†ç¯ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-flow-final.gif"/></div>
<p>è¿™ä¸¤ç§ä¸åŒç±»å‹èŠ‚ç‚¹çš„åŒºåˆ«ä¸ºï¼šæµç»“æŸèŠ‚ç‚¹è¡¨æ˜å•ç‹¬çš„æ§åˆ¶æµçš„ç»ˆç‚¹ã€‚æ´»åŠ¨ç»“æŸç»ˆç‚¹æ˜¯æ´»åŠ¨å›¾å†…æ‰€æœ‰æ§åˆ¶æµçš„ç»“æŸã€‚</p>
<h3 id="å¯¹è±¡å’Œå¯¹è±¡æµ"><a class="markdownIt-Anchor" href="#å¯¹è±¡å’Œå¯¹è±¡æµ"></a> å¯¹è±¡å’Œå¯¹è±¡æµ</h3>
<p>å¯¹è±¡æµæ˜¯å¯¹è±¡å’Œæ•°æ®è½¬é€’çš„é€šé“ã€‚å¯¹è±¡æ˜¾ç¤ºä¸ºçŸ©å½¢ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-object.gif"/></div>
<p>å¯¹è±¡æµæ˜¾ç¤ºä¸ºå¸¦ç®­å¤´çš„è¿æ¥å™¨ï¼Œè¡¨æ˜æ–¹å‘å’Œé€šè¿‡çš„å¯¹è±¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-object-flow.gif"/></div>
<p>ä¸€ä¸ªå¯¹è±¡æµåœ¨å®ƒçš„è‡³å°‘ä¸€ä¸ªç»ˆç«¯æœ‰ä¸€ä¸ªå¯¹è±¡ã€‚åœ¨ä¸Šå›¾ä¸­ï¼Œå¯ä»¥é‡‡ç”¨å¸¦è¾“å…¥è¾“å‡ºå¼•è„šçš„é€Ÿè®°æ ‡æŸ±è¡¨ç¤ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-object-flow-alt.gif"/></div>
<p>æ•°æ®å­˜å‚¨æ˜¾ç¤ºä¸ºå¸¦ Â«datastoreÂ» å…³é”®å­—çš„å¯¹è±¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-data-store.gif"/></div>
<h3 id="åˆ¤æ–­èŠ‚ç‚¹å’Œåˆå¹¶èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#åˆ¤æ–­èŠ‚ç‚¹å’Œåˆå¹¶èŠ‚ç‚¹"></a> åˆ¤æ–­èŠ‚ç‚¹å’Œåˆå¹¶èŠ‚ç‚¹</h3>
<p>åˆ¤æ–­èŠ‚ç‚¹å’Œåˆå¹¶èŠ‚ç‚¹æ˜¯ç›¸åŒæ ‡æ³¨ï¼šè±å½¢ã€‚å®ƒä»¬å¯ä»¥è¢«å‘½åã€‚ä»åˆ¤æ–­èŠ‚ç‚¹å‡ºæ¥çš„æ§åˆ¶æµæœ‰ç›‘æŠ¤æ¡ä»¶ï¼Œå½“ç›‘æŠ¤æ¡ä»¶æ»¡è¶³æ—¶ï¼Œå¯ä»¥å¯¹æµæ§åˆ¶ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†åˆ¤æ–­èŠ‚ç‚¹å’Œåˆå¹¶èŠ‚ç‚¹çš„ä½¿ç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-decision-or-merge.gif"/></div>
<h3 id="åˆ†å‰å’Œç»“åˆèŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#åˆ†å‰å’Œç»“åˆèŠ‚ç‚¹"></a> åˆ†å‰å’Œç»“åˆèŠ‚ç‚¹</h3>
<p>åˆ†å‰å’Œç»“åˆèŠ‚ç‚¹æœ‰åŒæ ·çš„æ ‡æŸ±ï¼šå‚ç›´æˆ–æ°´å¹³æ¡ï¼ˆæ–¹å‘å–å†³äºå·¥ä½œæµä»å·¦åˆ°å³ï¼Œè¿˜æ˜¯ä»ä¸Šåˆ°ä¸‹ï¼‰ã€‚å®ƒä»¬è¯´æ˜äº†æ§åˆ¶çš„å¹¶å‘çº¿ç¨‹çš„èµ·å§‹å’Œç»ˆç‚¹ï¼Œä¸‹å›¾æ˜¾ç¤ºä»–ä»¬çš„ä½¿ç”¨ç¤ºä¾‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-fork-and-join.gif"/></div>
<p>ç»“åˆèŠ‚ç‚¹ä¸åˆå¹¶èŠ‚ç‚¹ä¸åŒä¹‹å¤„åœ¨äºï¼šç»“åˆèŠ‚ç‚¹åŒæ­¥ä¸¤ä¸ªè¾“å…¥é‡ï¼Œäº§ç”Ÿä¸€ä¸ªå•ç‹¬çš„è¾“å‡ºé‡ã€‚æ¥è‡ªç»“åˆèŠ‚ç‚¹çš„è¾“å‡ºé‡è¦æ¥æ”¶åˆ°æ‰€æœ‰çš„è¾“å…¥é‡åæ‰èƒ½æ‰§è¡Œã€‚åˆå¹¶èŠ‚ç‚¹ç›´æ¥å°†æ§åˆ¶æµä¼ é€’é€šè¿‡ã€‚å¦‚æœä¸¤ä¸ªæˆ–æ›´å¤šçš„è¾“å…¥é‡åˆ°è¾¾åˆå¹¶èŠ‚ç‚¹ã€‚åˆ™å®ƒçš„è¾“å‡ºæµæŒ‡å®šçš„åŠ¨ä½œä¼šè¢«æ‰§è¡Œä¸¤æ¬¡æˆ–æ›´å¤šæ¬¡ã€‚</p>
<h3 id="æ‰©å±•åŸŸ"><a class="markdownIt-Anchor" href="#æ‰©å±•åŸŸ"></a> æ‰©å±•åŸŸ</h3>
<p>æ‰©å±•åŸŸæ˜¯ä¼šæ‰§è¡Œå¤šæ¬¡çš„ç»“æ„æ´»åŠ¨åŸŸã€‚è¾“å…¥è¾“å‡ºæ‰©å±•èŠ‚ç‚¹è¡¨ç¤ºä¸ºä¸€ç»„â€œ3 å¢â€ ï¼Œä»£è¡¨å¤šä¸ªé€‰æ‹©é¡¹ã€‚å…³é”®è¯ â€œiterativeâ€ï¼Œ â€œparallelâ€ æˆ– &quot;stream&quot;æ˜¾ç¤ºåœ¨åŒºåŸŸçš„å·¦ä¸Šè§’</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-expansion-region.gif"/></div>
<h3 id="å¼‚å¸¸å¤„ç†å™¨"><a class="markdownIt-Anchor" href="#å¼‚å¸¸å¤„ç†å™¨"></a> å¼‚å¸¸å¤„ç†å™¨</h3>
<p>å¼‚å¸¸å¤„ç†å™¨åœ¨æ´»åŠ¨å›¾ä¸­å¯ä»¥å»ºæ¨¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-exception-handler.gif"/></div>
<h3 id="å¯ä¸­æ–­æ´»åŠ¨åŒº"><a class="markdownIt-Anchor" href="#å¯ä¸­æ–­æ´»åŠ¨åŒº"></a> å¯ä¸­æ–­æ´»åŠ¨åŒº</h3>
<p>å¯ä¸­æ–­æ´»åŠ¨åŒºç¯ç»•ä¸€ç»„å¯ä»¥ä¸­æ–­çš„åŠ¨ä½œã€‚åœ¨ä¸‹é¢éå¸¸ç®€å•çš„ä¾‹å­ä¸­ï¼š å½“æ§åˆ¶è¢«ä¼ é€’åˆ°ç»“æŸè®¢å• â€œClose Orderâ€ åŠ¨ä½œï¼Œå®šå•å¤„ç†&quot;Process Order&quot; åŠ¨ä½œä¼šæ‰§è¡Œç›´åˆ°å®Œæˆï¼Œé™¤é&quot;Cancel Request&quot;å–æ¶ˆè¯·æ±‚ä¸­æ–­è¢«æ¥å—ï¼Œè¿™ä¼šå°†æ§åˆ¶ä¼ é€’ç»™&quot;Cancel Order&quot;åŠ¨ä½œã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-interruptible-activity-region.gif"/></div>
<h3 id="åˆ†å‰²"><a class="markdownIt-Anchor" href="#åˆ†å‰²"></a> åˆ†å‰²</h3>
<p>ä¸€ä¸ªæ´»åŠ¨åˆ†å‰²æ˜¾ç¤ºä¸ºå‚ç›´æˆ–æ°´å¹³æ³³é“ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œåˆ†å‰²è¢«ç”¨æ¥åœ¨æ´»åŠ¨å›¾ä¸­åˆ†éš”åŠ¨ä½œï¼Œæœ‰åœ¨ &quot;accounting department&quot;ä¸­æ‰§è¡Œçš„ï¼Œæœ‰åœ¨ &quot;customer&quot;ä¸­æ‰§è¡Œçš„ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-activity-partitions.gif"/></div>
<h2 id="çŠ¶æ€æœºå›¾"><a class="markdownIt-Anchor" href="#çŠ¶æ€æœºå›¾"></a> çŠ¶æ€æœºå›¾</h2>
<blockquote>
<p><strong>çŠ¶æ€æœºå›¾ï¼ˆstate-machine-diagramï¼‰å¯¹ä¸€ä¸ªå•ç‹¬å¯¹è±¡çš„è¡Œä¸ºå»ºæ¨¡ï¼ŒæŒ‡æ˜å¯¹è±¡åœ¨å®ƒçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œï¼Œå“åº”ä¸åŒäº‹ä»¶æ—¶ï¼Œæ‰§è¡Œç›¸å…³äº‹ä»¶çš„é¡ºåºã€‚</strong></p>
</blockquote>
<p>å¦‚ä¸‹ç¤ºä¾‹ï¼Œ ä¸‹åˆ—çš„çŠ¶æ€æœºå›¾æ˜¾ç¤ºäº†é—¨åœ¨å®ƒçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œå¦‚ä½•è¿ä½œã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-diagram.gif"/></div>
<p>é—¨å¯ä»¥å¤„äºä»¥ä¸‹çš„ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼š &quot;Opened&quot;æ‰“å¼€çŠ¶æ€ï¼Œ &quot;Closed&quot;å…³é—­çŠ¶æ€ï¼Œæˆ–è€…&quot;Locked&quot;é”å®šçŠ¶æ€ã€‚ å®ƒåˆ†åˆ«å“åº”äº‹ä»¶ï¼šâ€œOpenâ€å¼€é—¨ï¼Œ â€œCloseâ€å…³é—¨ï¼Œ â€œLockâ€é”é—¨ å’Œ â€œUnlockâ€è§£é”ã€‚ æ³¨æ„ï¼šä¸æ˜¯æ‰€æœ‰çš„äº‹ä»¶ï¼Œåœ¨æ‰€æœ‰çš„çŠ¶æ€ä¸‹éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚å¦‚ï¼šä¸€ä¸ªé—¨æ‰“å¼€çš„æ—¶å€™æ˜¯ä¸å¯èƒ½é”å®šçš„ï¼Œé™¤éä½ å…³ä¸Šé—¨ã€‚å¹¶ä¸”ï¼ŒçŠ¶æ€è½¬ç§»å¯èƒ½æœ‰é™„åŠ ç›‘æŠ¤æ¡ä»¶ï¼šå‡è®¾é—¨æ˜¯å¼€çš„ï¼Œå¦‚æœâ€œdoorWay-&gt;isEmptyâ€ï¼ˆé—¨æ˜¯ç©ºçš„ï¼‰è¢«æ»¡è¶³ï¼Œé‚£ä¹ˆå®ƒåªèƒ½å“åº”å…³é—¨äº‹ä»¶ã€‚çŠ¶æ€æœºå›¾ä½¿ç”¨çš„è¯­æ³•å’Œçº¦å®šå°†åœ¨ä¸‹é¢çš„éƒ¨åˆ†è¿›è¡Œè®¨è®ºã€‚</p>
<h3 id="çŠ¶æ€"><a class="markdownIt-Anchor" href="#çŠ¶æ€"></a> çŠ¶æ€</h3>
<p>çŠ¶æ€è¢«è¡¨ç¤ºä¸ºåœ†è§’çŸ©å½¢ï¼ŒçŠ¶æ€åå†™åœ¨é‡Œé¢ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state.gif"/></div>
<h3 id="èµ·å§‹å’Œç»“æŸçŠ¶æ€"><a class="markdownIt-Anchor" href="#èµ·å§‹å’Œç»“æŸçŠ¶æ€"></a> èµ·å§‹å’Œç»“æŸçŠ¶æ€</h3>
<p>åˆå§‹çŠ¶æ€è¡¨ç¤ºä¸ºå®å¿ƒé»‘åœ†ç¯ï¼Œå¯ä»¥æ ‡æ³¨åç§°ã€‚ç»“æŸçŠ¶æ€è¡¨ç¤ºä¸ºä¸­å¿ƒå¸¦é»‘ç‚¹åœ†ç¯ï¼Œä¹Ÿå¯ä»¥è¢«æ ‡æ³¨åç§°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-initial-and-final.gif"/></div>
<h3 id="è½¬ç§»"><a class="markdownIt-Anchor" href="#è½¬ç§»"></a> è½¬ç§»</h3>
<p>ä¸€ä¸ªçŠ¶æ€åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€çš„è½¬ç§»è¡¨ç¤ºä¸ºå¸¦ç®­å¤´å®çº¿ã€‚è½¬ç§»å¯ä»¥æœ‰ä¸€ä¸ªâ€œTriggerâ€è§¦å‘å™¨ï¼Œä¸€ä¸ªâ€œGuardâ€ç›‘æŠ¤æ¡ä»¶å’Œä¸€ä¸ªâ€œeffectâ€æ•ˆæœã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-transition.gif"/></div>
<p>&quot;Trigger&quot;è§¦å‘å™¨æ˜¯è½¬ç§»çš„èµ·å› ï¼Œå®ƒå¯ä»¥æ˜¯æŸä¸ªæ¡ä»¶ä¸‹çš„ä¸€ä¸ªä¿¡å·ï¼Œä¸€ä¸ªäº‹ä»¶ï¼Œä¸€ä¸ªå˜åŒ–æˆ–ä¸€ä¸ªæ—¶é—´é€šè·¯ã€‚&quot;Guard&quot;ç›‘æŠ¤æ˜¯ä¸€ä¸ªæ¡ä»¶ï¼Œè€Œä¸”å¿…é¡»ä¸ºçœŸï¼Œä»¥ä¾¿äºè®©è§¦å‘å™¨å¼•èµ·è½¬ç§»ã€‚æ•ˆæœ&quot;Effect&quot;æ˜¯ç›´æ¥ä½œç”¨åˆ°å¯¹è±¡ä¸Šçš„ä¸€ä¸ªåŠ¨ä½œï¼Œè¯¥å¯¹è±¡å…·æœ‰åšä¸ºè½¬ç§»ç»“æœçš„çŠ¶æ€æœºã€‚</p>
<h3 id="çŠ¶æ€æ´»åŠ¨"><a class="markdownIt-Anchor" href="#çŠ¶æ€æ´»åŠ¨"></a> çŠ¶æ€æ´»åŠ¨</h3>
<p>åœ¨ä¸Šé¢çš„çŠ¶æ€è½¬ç§»ç¤ºä¾‹ä¸­ï¼Œä¸€ä¸ªæ•ˆæœä¸è¯¥è½¬ç§»ç›¸å…³è”ã€‚å¦‚æœç›®æ ‡çŠ¶æ€æœ‰å¤šä¸ªè½¬ç§»åˆ°è¾¾ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªè½¬ç§»éƒ½æœ‰ç›¸åŒçš„æ•ˆæœä¸å®ƒç›¸å…³è”ï¼Œé‚£æœ€å¥½å°†è¯¥æ•ˆæœä¸ç›®æ ‡çŠ¶æ€ç›¸å…³è”ï¼Œè€Œä¸ä¸è½¬ç§»ç›¸å…³è”ã€‚ä½ å¯ä»¥é€šè¿‡ä¸ºè¿™ä¸ªçŠ¶æ€å®šä¹‰åˆå§‹åŠ¨ä½œæ¥å®ç°ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªå¸¦å…¥å£åŠ¨ä½œå’Œå‡ºå£åŠ¨ä½œçš„çŠ¶æ€ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-entry-and-exit.gif"/></div>
<p>å¯ä»¥å®šä¹‰å‘ç”Ÿåœ¨äº‹ä»¶ä¸Šçš„åŠ¨ä½œæˆ–ä¸€ç›´å‘ç”Ÿçš„åŠ¨ä½œã€‚æ¯ä¸€ç§ç±»å‹çš„åŠ¨ä½œæ˜¯å¯ä»¥å®šä¹‰ä»»æ„æ•°é‡çš„ã€‚</p>
<h3 id="è‡ªè½¬ç§»"><a class="markdownIt-Anchor" href="#è‡ªè½¬ç§»"></a> è‡ªè½¬ç§»</h3>
<p>ä¸€ä¸ªçŠ¶æ€å¯èƒ½æœ‰ä¸€ä¸ªè¿”å›åˆ°è‡ªèº«çš„è½¬ç§»ï¼Œå¦‚ä¸‹å›¾ã€‚æ•ˆæœä¸è½¬ç§»å…³è”æ˜¯ååˆ†æœ‰å¸®åŠ©ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-self-transition.gif"/></div>
<h3 id="å¤åˆçŠ¶æ€"><a class="markdownIt-Anchor" href="#å¤åˆçŠ¶æ€"></a> å¤åˆçŠ¶æ€</h3>
<p>ä¸€ä¸ªçŠ¶æ€æœºå›¾å¯ä»¥æœ‰å­çŠ¶æ€æœºå›¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-compound.gif"/></div>
<p>å¯é€‰æ‹©ä¸åŒæ–¹å¼æ˜¾ç¤ºç›¸åŒä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-composite.gif"/></div>
<p>ä¸Šé¢ç‰ˆæœ¬çš„æ ‡æ³¨è¯´æ˜&quot;Check PIN&quot;çš„å­çŠ¶æ€æœºå›¾æ˜¾ç¤ºåœ¨å•ç‹¬çš„å›¾ä¸­ã€‚</p>
<h3 id="å…¥å£ç‚¹"><a class="markdownIt-Anchor" href="#å…¥å£ç‚¹"></a> å…¥å£ç‚¹</h3>
<p>æœ‰æ—¶ï¼Œä½ ä¸æƒ³åœ¨æ­£å¸¸çš„åˆå§‹çŠ¶æ€è¿›å…¥å­çŠ¶æ€æœºã€‚ä¾‹å¦‚ä¸‹é¢çš„å­çŠ¶æ€æœºï¼Œå®ƒé€šå¸¸ä»&quot;åˆå§‹åŒ–&quot;çŠ¶æ€å¼€å§‹ï¼Œä½†æ˜¯å¦‚æœå› ä¸ºæŸäº›åŸå› ï¼Œå®ƒä¸å¿…æ‰§è¡Œåˆå§‹åŒ–ï¼Œå¯èƒ½é è½¬ç§»åˆ°æŒ‡å®šçš„å…¥å£ç‚¹æ¥ä» â€œReadyâ€ çŠ¶æ€å¼€å§‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-entry-point.gif"/></div>
<p>ä¸‹å›¾æ˜¾ç¤ºäº†çŠ¶æ€æœºçš„ä¸Šä¸€å±‚ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-entry-point-higher.gif"/></div>
<h3 id="å‡ºå£ç‚¹"><a class="markdownIt-Anchor" href="#å‡ºå£ç‚¹"></a> å‡ºå£ç‚¹</h3>
<p>æœ‰ä¸å…¥å£ç‚¹ç›¸ç±»ä¼¼çš„æ–¹å¼ï¼Œå®ƒå¯èƒ½ä¹ŸæŒ‡å®šå¯é€‰æ‹©çš„å‡ºå£ç‚¹ã€‚ä¸‹å›¾ç»™å‡ºäº†ä¸»å¤„ç†çŠ¶æ€æ‰§è¡Œåï¼Œæ‰€æ‰§è¡ŒçŠ¶æ€çš„å»å‘å°†å–å†³äºè¯¥çŠ¶æ€è½¬ç§»æ—¶æ‰€ä½¿ç”¨çš„è·¯å¾„ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-exit-point.gif"/></div>
<h3 id="é€‰æ‹©ä¼ªçŠ¶æ€"><a class="markdownIt-Anchor" href="#é€‰æ‹©ä¼ªçŠ¶æ€"></a> é€‰æ‹©ä¼ªçŠ¶æ€</h3>
<p>é€‰æ‹©ä¼ªçŠ¶æ€æ˜¾ç¤ºä¸ºè±å½¢ï¼Œæœ‰ä¸€ä¸ªè½¬ç§»è¾“å…¥ï¼Œä¸¤ä¸ªæˆ–å¤šä¸ªè¾“å‡ºã€‚ä¸‹å›¾æ˜¾ç¤ºä¸ç®¡åˆ°è¾¾å“ªä¸€ä¸ªçŠ¶æ€ï¼Œç»è¿‡é€‰æ‹©ä¼ªçŠ¶æ€åçš„å»å‘ï¼Œå–å†³äºåœ¨ä¼ªçŠ¶æ€ä¸­æ‰§è¡Œæ—¶æ‰€é€‰æ‹©çš„æ¶ˆæ¯æ ¼å¼ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-choice.gif"/></div>
<h3 id="è¿æ¥ä¼ªçŠ¶æ€"><a class="markdownIt-Anchor" href="#è¿æ¥ä¼ªçŠ¶æ€"></a> è¿æ¥ä¼ªçŠ¶æ€</h3>
<p>è¿æ¥ä¼ªçŠ¶æ€ç”¨æ¥å°†å¤šä¸ªçŠ¶æ€è½¬ç§»é“¾æ¥åœ¨ä¸€èµ·ã€‚ä¸€ä¸ªå•ç‹¬çš„è¿æ¥ä¼ªçŠ¶æ€å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥å’Œä¸€ä¸ªæˆ–å¤šä¸ªè¾“å‡ºï¼Œç›‘æŠ¤å¯èƒ½åº”ç”¨äºæ¯ä¸€ä¸ªè½¬ç§»ï¼Œè¿æ¥æ˜¯æ²¡æœ‰è¯­ä¹‰çš„ã€‚è¿æ¥å¯ä»¥æŠŠä¸€ä¸ªè¾“å…¥è½¬ç§»åˆ†æˆå¤šä¸ªè¾“å‡ºè½¬ç§»æ¥å®ç°ä¸€ä¸ªé™æ€åˆ†æ”¯ã€‚ä¸ä¹‹å¯¹ç…§çš„æ˜¯é€‰æ‹©ä¼ªçŠ¶æ€å®ç°ä¸€ä¸ªåŠ¨æ€æ¡ä»¶åˆ†æ”¯ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-junction.gif"/></div>
<h3 id="ç»ˆæ­¢ä¼ªçŠ¶æ€"><a class="markdownIt-Anchor" href="#ç»ˆæ­¢ä¼ªçŠ¶æ€"></a> ç»ˆæ­¢ä¼ªçŠ¶æ€</h3>
<p>è¿›å…¥ç»ˆæ­¢ä¼ªçŠ¶æ€æ˜¯æŒ‡çŠ¶æ€æœºç”Ÿå‘½çº¿å·²ç»ç»ˆæ­¢ã€‚ç»ˆæ­¢ä¼ªçŠ¶æ€è¡¨ç¤ºä¸ºå‰å·ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-terminate.gif"/></div>
<h3 id="å†å²çŠ¶æ€"><a class="markdownIt-Anchor" href="#å†å²çŠ¶æ€"></a> å†å²çŠ¶æ€</h3>
<p>å†å²çŠ¶æ€ç”¨æ¥å½“çŠ¶æ€æœºä¸­æ–­æ—¶ï¼Œæ¢å¤çŠ¶æ€æœºä¹‹å‰çŠ¶æ€ã€‚ä¸‹é¢ä¾‹å›¾è¯´æ˜äº†å†å²çŠ¶æ€çš„ä½¿ç”¨ã€‚è¿™ä¸ªä¾‹å­æ˜¯å…³äºæ´—è¡£æœºçš„çŠ¶æ€æœºã€‚</p>
<p>åœ¨è¿™ä¸ªçŠ¶æ€æœºä¸­ï¼Œå½“æ´—è¡£æœºè¿è¡Œæ—¶ï¼Œå®ƒä¼šæŒ‰ç…§&quot;Washing&quot; åˆ° Rinsing&quot;å†åˆ°&quot;Spinning&quot;æ¥è¿›è¡Œã€‚å¦‚æœç”µæºè¢«åˆ‡æ–­ ï¼Œæ´—è¡£æœºä¼šåœæ­¢è¿è¡Œå¹¶è¿›å…¥&quot;Power Off&quot; çŠ¶æ€ã€‚å½“ç”µæºæ¢å¤ï¼Œè¿è¡ŒçŠ¶æ€åœ¨&quot;History State&quot;ç¬¦å·å¤„è¿›å…¥ï¼Œè¡¨ç¤ºå®ƒä¼šä»ä¸Šæ¬¡ç¦»å¼€çš„åœ°æ–¹æ¢å¤ã€‚</p>
<h3 id="å¹¶å‘åŒº"><a class="markdownIt-Anchor" href="#å¹¶å‘åŒº"></a> å¹¶å‘åŒº</h3>
<p>ä¸€ä¸ªçŠ¶æ€å¯ä»¥è¢«åˆ†æˆå‡ ä¸ªä¸åŒçš„åŒºï¼ŒåŒ…å«åŒæ—¶å­˜åœ¨å’Œæ‰§è¡Œçš„å­çŠ¶æ€ã€‚ä¸‹é¢çš„ä¾‹å­æ˜¾ç¤ºçŠ¶æ€ â€œApplying Brakesâ€ï¼Œ â€œfront brake&quot;å’Œ&quot;rear brakesâ€ å°†åŒæ—¶ç‹¬ç«‹è¿ä½œã€‚æ³¨æ„ä½¿ç”¨äº†åˆ†å‰å’Œç»“åˆä¼ªçŠ¶æ€è€Œä¸æ˜¯é€‰æ‹©å’Œåˆå¹¶ä¼ªçŠ¶æ€ã€‚è¿™äº›ç¬¦å·ç”¨æ¥åŒæ­¥å¹¶å‘çš„çº¿ç¨‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-concurrent-regions.gif"/></div>
<h2 id="ç”¨ä¾‹å›¾"><a class="markdownIt-Anchor" href="#ç”¨ä¾‹å›¾"></a> ç”¨ä¾‹å›¾</h2>
<blockquote>
<p><strong>ç”¨ä¾‹å›¾ç”¨æ¥è®°å½•ç³»ç»Ÿçš„éœ€æ±‚ï¼Œå®ƒæä¾›ç³»ç»Ÿä¸ç”¨æˆ·åŠå…¶ä»–å‚ä¸è€…çš„ä¸€ç§é€šä¿¡æ‰‹æ®µã€‚</strong></p>
</blockquote>
<h3 id="æ‰§è¡Œè€…"><a class="markdownIt-Anchor" href="#æ‰§è¡Œè€…"></a> æ‰§è¡Œè€…</h3>
<p>ç”¨ä¾‹å›¾æ˜¾ç¤ºäº†ç³»ç»Ÿå’Œç³»ç»Ÿå¤–å®ä½“ä¹‹é—´çš„äº¤äº’ã€‚è¿™äº›å®ä½“è¢«å¼•ç”¨ä¸ºæ‰§è¡Œè€…ã€‚æ‰§è¡Œè€…ä»£è¡¨è§’è‰²ï¼Œå¯ä»¥åŒ…æ‹¬ï¼šç”¨æˆ·ï¼Œå¤–éƒ¨ç¡¬ä»¶å’Œå…¶ä»–ç³»ç»Ÿã€‚æ‰§è¡Œè€…å¾€å¾€è¢«ç”»æˆç®€ç¬”ç”»å°äººã€‚ä¹Ÿå¯ä»¥ç”¨å¸¦Â«actorÂ»å…³é”®å­—çš„ç±»çŸ©å½¢è¡¨ç¤ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case-actor.gif"/></div>
<p>åœ¨ä¸‹å›¾ä¸­ï¼Œæ‰§è¡Œè€…å¯ä»¥è¯¦ç»†çš„æ³›åŒ–å…¶ä»–æ‰§è¡Œè€…:</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case-generalize.gif"/></div>
<h3 id="ç”¨ä¾‹"><a class="markdownIt-Anchor" href="#ç”¨ä¾‹"></a> ç”¨ä¾‹</h3>
<p>ç”¨ä¾‹æ˜¯æœ‰æ„ä¹‰çš„å•ç‹¬å·¥ä½œå•å…ƒã€‚å®ƒå‘ç³»ç»Ÿå¤–éƒ¨çš„äººæˆ–äº‹æä¾›ä¸€ä¸ªæ˜“äºè§‚å¯Ÿçš„é«˜å±‚æ¬¡è¡Œä¸ºè§†å›¾ã€‚ ç”¨ä¾‹çš„æ ‡æ³¨ç¬¦å·æ˜¯ä¸€ä¸ªæ¤­åœ†ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case.gif"/></div>
<p>ä½¿ç”¨ç”¨ä¾‹çš„ç¬¦å·æ˜¯å¸¦å¯é€‰æ‹©ç®­å¤´çš„è¿æ¥çº¿ï¼Œç®­å¤´æ˜¾ç¤ºæ§åˆ¶çš„æ–¹å‘ã€‚ä¸‹å›¾è¯´æ˜æ‰§è¡Œè€… &quot;Customer&quot;ä½¿ç”¨ &quot;Withdraw&quot;ç”¨ä¾‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case-use.gif"/></div>
<p>ç”¨é€”è¿æ¥å™¨ï¼ˆuses connectorï¼‰å¯ä»¥æœ‰é€‰æ‹©æ€§çš„åœ¨æ¯ä¸€ä¸ªç«¯ç‚¹æœ‰å¤šé‡æ€§å€¼ï¼Œå¦‚ä¸‹å›¾ï¼Œæ˜¾ç¤ºå®¢æˆ·ä¸€æ¬¡å¯èƒ½åªæ‰§è¡Œä¸€æ¬¡å–æ¬¾äº¤æ˜“ã€‚ä½†æ˜¯é“¶è¡Œå¯ä»¥åŒæ—¶æ‰§è¡Œè®¸å¤šå–æ¬¾äº¤æ˜“ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case-multiplicity-use.gif"/></div>
<h3 id="ç”¨ä¾‹å®šä¹‰"><a class="markdownIt-Anchor" href="#ç”¨ä¾‹å®šä¹‰"></a> ç”¨ä¾‹å®šä¹‰</h3>
<p>ä¸€ä¸ªå…¸å‹çš„ç”¨ä¾‹åŒ…æ‹¬:</p>
<ul>
<li><strong>åç§°å’Œæè¿°</strong> - ç”¨ä¾‹é€šå¸¸ç”¨ä¸€ä¸ªåŠ¨è¯è¯ç»„å®šä¹‰ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªç®€çŸ­çš„æ–‡å­—è¯´æ˜ã€‚</li>
<li><strong>éœ€æ±‚</strong> - éœ€æ±‚å®šä¹‰äº†ä¸€ä¸ªç”¨ä¾‹å¿…é¡»æä¾›ç»™ç»ˆç«¯ç”¨æˆ·çš„æ­£å¼åŠŸèƒ½æ€§éœ€æ±‚ã€‚å®ƒä»¬ç¬¦åˆæ„é€ æ–¹æ³•å»ºç«‹çš„åŠŸèƒ½æ€§è§„èŒƒã€‚ä¸€ä¸ªéœ€æ±‚æ˜¯ç”¨ä¾‹å°†æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œæˆ–æä¾›å¤šä¸ªå€¼ç»™ç³»ç»Ÿçš„çº¦å®šæˆ–æ‰¿è¯ºã€‚</li>
<li><strong>çº¦æŸ</strong> - ä¸€ä¸ªçº¦æŸæ˜¯ä¸€ä¸ªç”¨ä¾‹è¿è¡Œçš„æ¡ä»¶æˆ–é™åˆ¶ã€‚å®ƒåŒ…æ‹¬ï¼šå‰ç½®æ¡ä»¶ï¼Œåç½®æ¡ä»¶å’Œä¸å˜åŒ–æ¡ä»¶ ã€‚å‰ç½®æ¡ä»¶æŒ‡æ˜äº†ç”¨ä¾‹åœ¨å‘ç”Ÿä¹‹å‰éœ€è¦ç¬¦åˆçš„æ¡ä»¶ã€‚åç½®æ¡ä»¶ç”¨æ¥è¯´æ˜åœ¨ç”¨ä¾‹æ‰§è¡Œä¹‹åä¸€äº›æ¡ä»¶å¿…é¡»ä¸º&quot;çœŸ&quot;ã€‚ä¸å˜åŒ–æ¡ä»¶è¯´æ˜ç”¨ä¾‹æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ä¸­è¯¥æ¡ä»¶å§‹ç»ˆä¸º&quot;çœŸ&quot;ã€‚</li>
<li><strong>æƒ…å½¢</strong> - æƒ…å½¢æ˜¯ç”¨ä¾‹çš„å®ä¾‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œäº‹ä»¶å‘ç”Ÿæµç¨‹çš„å½¢å¼æè¿°ã€‚å®ƒå®šä¹‰äº†ç³»ç»Ÿå’Œå¤–éƒ¨æ‰§è¡Œè€…ä¹‹é—´çš„äº‹ä»¶æŒ‡å®šé¡ºåºã€‚é€šå¸¸ç”¨æ–‡æœ¬æ–¹å¼æ¥è¡¨ç¤ºï¼Œå¹¶å¯¹åº”æ—¶åºå›¾ä¸­çš„æ–‡å­—æè¿°ã€‚</li>
<li><strong>æƒ…å½¢å›¾</strong></li>
<li><strong>é™„åŠ ä¿¡æ¯</strong></li>
</ul>
<h3 id="åŒ…å«ç”¨ä¾‹"><a class="markdownIt-Anchor" href="#åŒ…å«ç”¨ä¾‹"></a> åŒ…å«ç”¨ä¾‹</h3>
<p>ç”¨ä¾‹å¯èƒ½åŒ…å«å…¶ä»–ç”¨ä¾‹çš„åŠŸèƒ½æ¥ä½œä¸ºå®ƒæ­£å¸¸å¤„ç†çš„ä¸€éƒ¨åˆ†ã€‚é€šå¸¸å®ƒå‡è®¾ï¼Œä»»ä½•è¢«åŒ…å«çš„ç”¨ä¾‹åœ¨åŸºæœ¬ç¨‹åºè¿è¡Œæ—¶æ¯ä¸€æ¬¡éƒ½ä¼šè¢«è°ƒç”¨ã€‚ä¸‹é¢ä¾‹å­ï¼šç”¨ä¾‹â€œå¡çš„ç¡®è®¤â€<Card Identification> åœ¨è¿è¡Œæ—¶ï¼Œè¢«ç”¨ä¾‹â€œå–é’±â€<Withdraw>å½“ä½œä¸€ä¸ªå­éƒ¨åˆ†ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case-include.gif"/></div>
<p>ç”¨ä¾‹å¯ä»¥è¢«ä¸€ä¸ªæˆ–å¤šä¸ªç”¨ä¾‹åŒ…å«ã€‚é€šè¿‡æç‚¼é€šç”¨çš„è¡Œä¸ºï¼Œå°†å®ƒå˜æˆå¯ä»¥å¤šæ¬¡é‡å¤ä½¿ç”¨çš„ç”¨ä¾‹ã€‚æœ‰åŠ©äºé™ä½åŠŸèƒ½é‡å¤çº§åˆ«ã€‚</p>
<h3 id="æ‰©å±•ç”¨ä¾‹"><a class="markdownIt-Anchor" href="#æ‰©å±•ç”¨ä¾‹"></a> æ‰©å±•ç”¨ä¾‹</h3>
<p>ä¸€ä¸ªç”¨ä¾‹å¯ä»¥è¢«ç”¨æ¥æ‰©å±•å¦ä¸€ä¸ªç”¨ä¾‹çš„è¡Œä¸ºï¼Œé€šå¸¸ä½¿ç”¨åœ¨ç‰¹åˆ«æƒ…å†µä¸‹ã€‚ä¾‹å¦‚ï¼šå‡è®¾åœ¨ä¿®æ”¹ä¸€ä¸ªç‰¹åˆ«ç±»å‹çš„å®¢æˆ·è®¢å•ä¹‹å‰ï¼Œç”¨æˆ·å¿…é¡»å¾—åˆ°æŸç§æ›´é«˜çº§åˆ«çš„è®¸å¯ï¼Œç„¶åâ€œè·å¾—è®¸å¯â€<Get Approval>ç”¨ä¾‹å°†æœ‰é€‰æ‹©çš„æ‰©å±•å¸¸è§„çš„â€œä¿®æ”¹è®¢å•â€<Modify Order>ç”¨ä¾‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case-extend.gif"/></div>
<p><strong>æ‰©å±•ç‚¹</strong> - æ‰©å±•ç”¨ä¾‹çš„åŠ å…¥ç‚¹è¢«å®šä¹‰ä¸ºæ‰©å±•ç‚¹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case-extend-with-condition.gif"/></div>
<p><strong>ç³»ç»Ÿè¾¹ç•Œ</strong> - å®ƒç”¨æ¥æ˜¾ç¤ºç”¨ä¾‹åœ¨ç³»ç»Ÿå†…éƒ¨ï¼Œæ‰§è¡Œè€…åœ¨ç³»ç»Ÿçš„å¤–éƒ¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-use-case-system-boundary.gif"/></div>
<h2 id="é€šä¿¡å›¾"><a class="markdownIt-Anchor" href="#é€šä¿¡å›¾"></a> é€šä¿¡å›¾</h2>
<blockquote>
<p>é€šä¿¡å›¾ï¼Œä»¥å‰ç§°ä¹‹ä¸ºåä½œå›¾ï¼Œæ˜¯ä¸€ç§äº¤äº’å›¾ï¼Œ<strong>æ‰€æ˜¾ç¤ºæ¶ˆæ¯ä¸æ—¶åºå›¾ç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒæ›´ä¾§é‡äºå¯¹è±¡é—´çš„è”ç³»</strong>ã€‚</p>
</blockquote>
<p>åœ¨é€šä¿¡å›¾ä¸­ï¼Œå¯¹è±¡ä¹‹é—´æ˜¾ç¤ºå…³è”è¿æ¥å™¨ã€‚æ¶ˆæ¯é™„åŠ åˆ°è¿™äº›å…³è”ä¸Šï¼Œæ˜¾ç¤ºçŸ­ç®­å¤´æŒ‡å‘æ¶ˆæ¯æµçš„æ–¹å‘ã€‚æ¶ˆæ¯çš„é¡ºåºé€šè¿‡ç¼–å·ç æ˜¾ç¤ºã€‚</p>
<p>ä¸‹é¢çš„ä¸¤ä¸ªå›¾ç”¨é€šä¿¡å›¾å’Œæ—¶åºå›¾åˆ†åˆ«æ˜¾ç¤ºç›¸åŒçš„ä¿¡æ¯ã€‚å°½ç®¡æˆ‘ä»¬å¯èƒ½ä»é€šä¿¡å›¾çš„ç¼–å·ç å¾—åˆ°æ¶ˆæ¯é¡ºåºï¼Œä½†å®ƒä¸æ˜¯ç«‹å³å¯è§çš„ã€‚é€šä¿¡å›¾ååˆ†æ¸…æ¥šçš„æ˜¾ç¤ºäº†é‚»è¿‘å¯¹è±¡é—´å…¨éƒ¨å®Œæ•´çš„æ¶ˆæ¯ä¼ é€’ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-communications-diagram.gif"/></div>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-diagram.gif"/></div>
<h2 id="äº¤äº’æ¦‚è¿°å›¾"><a class="markdownIt-Anchor" href="#äº¤äº’æ¦‚è¿°å›¾"></a> äº¤äº’æ¦‚è¿°å›¾</h2>
<blockquote>
<p><strong>ä¸€ä¸ªäº¤äº’æ¦‚è§ˆå›¾æ˜¯æ´»åŠ¨å›¾çš„ä¸€ç§å½¢å¼ï¼Œå®ƒçš„èŠ‚ç‚¹ä»£è¡¨äº¤äº’å›¾ã€‚äº¤äº’å›¾åŒ…å«æ—¶åºå›¾ï¼Œé€šä¿¡å›¾ï¼Œäº¤äº’æ¦‚è§ˆå›¾å’Œæ—¶é—´å›¾ã€‚ å¤§å¤šæ•°äº¤äº’æ¦‚è§ˆå›¾æ ‡æ³¨ä¸æ´»åŠ¨å›¾ä¸€æ ·ã€‚ä¾‹å¦‚ï¼šèµ·å§‹ï¼Œç»“æŸï¼Œåˆ¤æ–­ï¼Œåˆå¹¶ï¼Œåˆ†å‰å’Œç»“åˆèŠ‚ç‚¹æ˜¯å®Œå…¨ç›¸åŒã€‚å¹¶ä¸”ï¼Œäº¤äº’æ¦‚è§ˆå›¾ä»‹ç»äº†ä¸¤ç§æ–°çš„å…ƒç´ ï¼šäº¤äº’å‘ç”Ÿå’Œäº¤äº’å…ƒç´ ã€‚</strong></p>
</blockquote>
<h3 id="äº¤äº’å‘ç”Ÿ"><a class="markdownIt-Anchor" href="#äº¤äº’å‘ç”Ÿ"></a> äº¤äº’å‘ç”Ÿ</h3>
<p>äº¤äº’å‘ç”Ÿå¼•ç”¨ç°æœ‰çš„äº¤äº’å›¾ã€‚æ˜¾ç¤ºä¸ºä¸€ä¸ªå¼•ç”¨æ¡†ï¼Œå·¦ä¸Šè§’æ˜¾ç¤º â€œrefâ€ ã€‚è¢«å¼•ç”¨çš„å›¾åæ˜¾ç¤ºåœ¨æ¡†çš„ä¸­å¤®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-interaction-overview-01.gif"/></div>
<h3 id="äº¤äº’å…ƒç´ "><a class="markdownIt-Anchor" href="#äº¤äº’å…ƒç´ "></a> äº¤äº’å…ƒç´ </h3>
<p>äº¤äº’å…ƒç´ ä¸äº¤äº’å‘ç”Ÿç›¸ä¼¼ä¹‹å¤„åœ¨äºéƒ½æ˜¯åœ¨ä¸€ä¸ªçŸ©å½¢æ¡†ä¸­æ˜¾ç¤ºä¸€ä¸ªç°æœ‰çš„äº¤äº’å›¾ã€‚ä¸åŒä¹‹å¤„åœ¨å†…éƒ¨æ˜¾ç¤ºå‚è€ƒå›¾çš„å†…å®¹ä¸åŒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-interaction-overview-02.gif"/></div>
<h3 id="å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·"><a class="markdownIt-Anchor" href="#å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·"></a> å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·</h3>
<p>æ‰€æœ‰çš„æ´»åŠ¨å›¾æ§ä»¶ï¼Œéƒ½å¯ä»¥ç›¸åŒåœ°è¢«ä½¿ç”¨äºäº¤äº’æ¦‚è§ˆå›¾ï¼Œå¦‚ï¼šåˆ†å‰ï¼Œç»“åˆï¼Œåˆå¹¶ç­‰ç­‰ã€‚å®ƒæŠŠæ§åˆ¶é€»è¾‘æ”¾å…¥è¾ƒä½ä¸€çº§çš„å›¾ä¸­ã€‚ä¸‹é¢çš„ä¾‹å­å°±è¯´æ˜äº†ä¸€ä¸ªå…¸å‹çš„é”€å”®è¿‡ç¨‹ã€‚å­è¿‡ç¨‹æ˜¯ä»äº¤äº’å‘ç”ŸæŠ½è±¡è€Œæ¥ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-interaction-overview-diagram.gif"/></div>
<h2 id="æ—¶åºå›¾"><a class="markdownIt-Anchor" href="#æ—¶åºå›¾"></a> æ—¶åºå›¾</h2>
<blockquote>
<p><strong>æ—¶åºå›¾æ˜¯äº¤äº’å›¾çš„ä¸€ç§å½¢å¼ï¼Œå®ƒæ˜¾ç¤ºå¯¹è±¡æ²¿ç”Ÿå‘½çº¿å‘å±•ï¼Œå¯¹è±¡ä¹‹é—´éšæ—¶é—´çš„äº¤äº’è¡¨ç¤ºä¸ºä»æºç”Ÿå‘½çº¿æŒ‡å‘ç›®æ ‡ç”Ÿå‘½çº¿çš„æ¶ˆæ¯ã€‚æ—¶åºå›¾èƒ½å¾ˆå¥½åœ°æ˜¾ç¤ºé‚£äº›å¯¹è±¡ä¸å…¶å®ƒé‚£äº›å¯¹è±¡é€šä¿¡ï¼Œä»€ä¹ˆæ¶ˆæ¯è§¦å‘äº†è¿™äº›é€šä¿¡ï¼Œæ—¶åºå›¾ä¸èƒ½å¾ˆå¥½æ˜¾ç¤ºå¤æ‚è¿‡ç¨‹çš„é€»è¾‘ã€‚</strong></p>
</blockquote>
<h3 id="ç”Ÿå‘½çº¿"><a class="markdownIt-Anchor" href="#ç”Ÿå‘½çº¿"></a> ç”Ÿå‘½çº¿</h3>
<p>ä¸€æ¡ç”Ÿå‘½çº¿åœ¨æ—¶åºå›¾ä¸­ä»£è¡¨ä¸€ä¸ªç‹¬ç«‹çš„å‚ä¸è€…ã€‚è¡¨ç¤ºä¸ºåŒ…å«å¯¹è±¡åçš„çŸ©å½¢ï¼Œå¦‚æœå®ƒçš„åå­—æ˜¯&quot;self&quot;ï¼Œåˆ™è¯´æ˜è¯¥ç”Ÿå‘½çº¿ä»£è¡¨æ§åˆ¶å¸¦æ—¶åºå›¾çš„ç±»å…ƒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-lifelines.gif"/></div>
<p>æœ‰æ—¶ï¼Œæ—¶åºå›¾ä¼šåŒ…å«ä¸€ä¸ªé¡¶ç«¯æ˜¯æ‰§è¡Œè€…çš„ç”Ÿå‘½çº¿ã€‚è¿™æƒ…å†µè¯´æ˜æŒæ¡è¿™ä¸ªæ—¶åºå›¾çš„æ˜¯ç”¨ä¾‹ã€‚å¥å£®å›¾ä¸­çš„è¾¹ç•Œï¼Œæ§åˆ¶å’Œå®ä½“å…ƒç´ ä¹Ÿå¯ä»¥æœ‰ç”Ÿå‘½çº¿ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-more-lifelines.gif"/></div>
<h3 id="æ¶ˆæ¯"><a class="markdownIt-Anchor" href="#æ¶ˆæ¯"></a> æ¶ˆæ¯</h3>
<p>æ¶ˆæ¯æ˜¾ç¤ºä¸ºç®­å¤´ã€‚æ¶ˆæ¯å¯ä»¥å®Œæˆä¼ è¾“ï¼Œä¹Ÿå¯èƒ½ä¸¢å¤±å’Œæ‰¾å›ï¼Œå®ƒå¯ä»¥æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œå³å¯ä»¥æ˜¯è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¿¡å·ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œç¬¬ä¸€æ¡æ¶ˆæ¯æ˜¯åŒæ­¥æ¶ˆæ¯(æ ‡ä¸ºå®ç®­å¤´)å®Œæˆä¼ è¾“ï¼Œå¹¶éšå«ä¸€æ¡è¿”å›æ¶ˆæ¯ã€‚ç¬¬äºŒæ¡æ¶ˆæ¯æ˜¯å¼‚æ­¥æ¶ˆæ¯ (æ ‡ä¸ºå®çº¿ç®­å¤´)ï¼Œç¬¬ä¸‰æ¡æ˜¯å¼‚æ­¥è¿”å›æ¶ˆæ¯(æ ‡ä¸ºè™šçº¿)ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-messages.gif"/></div>
<h3 id="æ‰§è¡Œå‘ç”Ÿ"><a class="markdownIt-Anchor" href="#æ‰§è¡Œå‘ç”Ÿ"></a> æ‰§è¡Œå‘ç”Ÿ</h3>
<p>å‘ä¸‹å»¶ä¼¸çš„ç»†æ¡çŠ¶çŸ©å½¢è¡¨ç¤ºæ‰§è¡Œäº‹ä»¶æˆ–æ§åˆ¶ç„¦ç‚¹çš„æ¿€æ´»ã€‚åœ¨ä¸Šå›¾ä¸­æœ‰ä¸‰ä¸ªæ‰§è¡Œäº‹ä»¶ã€‚ç¬¬ä¸€ä¸ªæ˜¯æºå¯¹è±¡å‘é€ä¸¤æ¡æ¶ˆæ¯å’Œæ”¶åˆ°ä¸¤æ¡å›å¤ã€‚ç¬¬äºŒä¸ªæ˜¯ç›®æ ‡å¯¹è±¡æ”¶åˆ°ä¸€æ¡åŒæ­¥æ¶ˆæ¯å¹¶è¿”å›ä¸€æ¡å›å¤ã€‚ç¬¬ä¸‰ä¸ªæ˜¯ç›®æ ‡å¯¹è±¡æ”¶åˆ°ä¸€æ¡å¼‚æ­¥æ¶ˆæ¯å¹¶è¿”å›ä¸€æ¡å›å¤ã€‚</p>
<h3 id="å†…éƒ¨é€šä¿¡"><a class="markdownIt-Anchor" href="#å†…éƒ¨é€šä¿¡"></a> å†…éƒ¨é€šä¿¡</h3>
<p>å†…éƒ¨æ¶ˆæ¯è¡¨ç°ä¸ºä¸€ä¸ªæ“ä½œçš„é€’å½’è°ƒç”¨ï¼Œæˆ–ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å±äºåŒä¸€ä¸ªå¯¹è±¡çš„å…¶ä»–æ–¹æ³•ã€‚æ˜¾ç¤ºä¸ºç”Ÿå‘½çº¿ä¸Šæ‰§è¡Œäº‹ä»¶çš„åµŒå¥—æ§åˆ¶ç„¦ç‚¹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-recursion.gif"/></div>
<h3 id="è¿·è·¯æ¶ˆæ¯å’Œæ‹¾å–æ¶ˆæ¯"><a class="markdownIt-Anchor" href="#è¿·è·¯æ¶ˆæ¯å’Œæ‹¾å–æ¶ˆæ¯"></a> è¿·è·¯æ¶ˆæ¯å’Œæ‹¾å–æ¶ˆæ¯</h3>
<p>è¿·è·¯æ¶ˆæ¯æ˜¯é‚£äº›å‘é€äº†å´æ²¡æœ‰åˆ°è¾¾æŒ‡å®šæ¥æ”¶è€…ï¼Œæˆ–è€…åˆ°è¾¾çš„æ¥æ”¶è€…ä¸å†å½“å‰å›¾ä¸­ã€‚æ‹¾å–æ¶ˆæ¯æ˜¯æ”¶åˆ°æ¥è‡ªé‚£äº›æœªçŸ¥çš„å‘é€è€…ï¼Œæˆ–è€…æ¥è‡ªæ²¡æœ‰æ˜¾ç¤ºåœ¨å½“å‰å›¾çš„å‘é€è€…çš„æ¶ˆæ¯ã€‚å®ƒä»¬éƒ½è¡¨æ˜æ˜¯å»å¾€æˆ–æ¥è‡ªä¸€ä¸ªç»ˆç‚¹å…ƒç´ ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-lost-and-found.gif"/></div>
<h3 id="ç”Ÿå‘½çº¿å¼€å§‹ä¸ç»“æŸ"><a class="markdownIt-Anchor" href="#ç”Ÿå‘½çº¿å¼€å§‹ä¸ç»“æŸ"></a> ç”Ÿå‘½çº¿å¼€å§‹ä¸ç»“æŸ</h3>
<p>ç”Ÿå‘½çº¿å¯ä»¥åœ¨æ—¶åºå›¾æ—¶é—´åˆ»åº¦èŒƒå›´å†…åˆ›å»ºå’Œé”€æ¯ï¼Œåœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç”Ÿå‘½çº¿è¢«åœæ­¢ç¬¦å·ï¼ˆå‰å·ï¼‰ç»ˆæ­¢ã€‚åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œç”Ÿå‘½çº¿é¡¶ç«¯çš„ç¬¦å·ï¼ˆChildï¼‰æ˜¾ç¤ºåœ¨æ¯”åˆ›å»ºå®ƒçš„å¯¹è±¡ç¬¦å·ï¼ˆparentï¼‰æ²¿é¡µé¢è¦ä½çš„ä½ç½®ä¸Šã€‚ä¸‹å›¾æ˜¾ç¤ºåˆ›å»ºå’Œç»ˆæ­¢å¯¹è±¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-lost-and-found.gif"/></div>
<h3 id="æ—¶é—´å’ŒæœŸé™çº¦æŸ"><a class="markdownIt-Anchor" href="#æ—¶é—´å’ŒæœŸé™çº¦æŸ"></a> æ—¶é—´å’ŒæœŸé™çº¦æŸ</h3>
<p>æ¶ˆæ¯é»˜è®¤æ˜¾ç¤ºä¸ºæ°´å¹³çº¿ã€‚å› ä¸ºç”Ÿå‘½çº¿æ˜¾ç¤ºä¸ºæ²¿å±å¹•å‘ä¸‹çš„æ—¶é—´é€šé“ï¼Œæ‰€ä»¥å½“ç»™å®æ—¶ç³»ç»Ÿå»ºæ¨¡ï¼Œæˆ–æ˜¯æœ‰æ—¶é—´çº¦æŸçš„ä¸šåŠ¡è¿‡ç¨‹å»ºæ¨¡ï¼Œè€ƒè™‘æ‰§è¡ŒåŠ¨ä½œæ‰€éœ€æ—¶é—´é•¿åº¦æ˜¯å¾ˆé‡è¦çš„ã€‚å› æ­¤å¯ä»¥ç»™æ¶ˆæ¯è®¾ç½®ä¸€ä¸ªæœŸé™çº¦æŸï¼Œè¿™æ ·çš„æ¶ˆæ¯æ˜¾ç¤ºä¸ºä¸‹æ–œçº¿ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-time.gif"/></div>
<h3 id="å¤åˆç‰‡æ®µ"><a class="markdownIt-Anchor" href="#å¤åˆç‰‡æ®µ"></a> å¤åˆç‰‡æ®µ</h3>
<p>å¦‚å‰é¢æ‰€è¯´ï¼Œæ—¶åºå›¾ä¸é€‚åˆè¡¨è¾¾å¤æ‚çš„è¿‡ç¨‹é€»è¾‘ã€‚åœ¨ä¸€ç§æƒ…å†µä¸‹ï¼Œæœ‰è®¸å¤šæœºåˆ¶å…è®¸æŠŠä¸€å®šç¨‹åº¦çš„è¿‡ç¨‹é€»è¾‘åŠ å…¥åˆ°å›¾ä¸­ï¼Œå¹¶æŠŠå®ƒä»¬æ”¾åˆ°å¤åˆç‰‡æ®µçš„æ ‡é¢˜ä¸‹ã€‚å¤åˆç‰‡æ®µæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªå¤„ç†é¡ºåºè¢«åŒ…å«åœ¨ä¸€ä¸ªæ¡†æ¶ä¸­ï¼Œå¹¶åœ¨æŒ‡å®šåç§°çš„ç¯å¢ƒä¸‹æ‰§è¡Œã€‚ç‰‡æ®µå¯ä»¥æ˜¯:</p>
<ul>
<li>é€‰æ‹©æ€§ç‰‡æ®µ (æ˜¾ç¤º â€œaltâ€) ä¸º ifâ€¦thenâ€¦else ç»“æ„å»ºæ¨¡ã€‚</li>
<li>é€‰é¡¹ç‰‡æ®µ (æ˜¾ç¤º â€œoptâ€) ä¸º â€œswitchâ€(å¼€å…³) ç»“æ„å»ºæ¨¡ã€‚</li>
<li>ä¸­æ–­ç‰‡æ®µå¯¹è¢«å¤„ç†äº‹ä»¶çš„å¯é€‰æ‹©é¡ºåºå»ºæ¨¡ï¼Œè€Œä¸æ˜¯è¯¥å›¾çš„å…¶ä»–éƒ¨åˆ†ã€‚</li>
<li>å¹¶è¡Œç‰‡æ®µ(æ˜¾ç¤º â€œparâ€) ä¸ºå¹¶å‘å¤„ç†å»ºæ¨¡ã€‚</li>
<li>å¼±é¡ºåºç‰‡æ®µ (æ˜¾ç¤º â€œseqâ€) åŒ…å«äº†ä¸€ç»„æ¶ˆæ¯ï¼Œè¿™ç»„æ¶ˆæ¯å¿…é¡»åœ¨åç»§ç‰‡æ®µå¼€å§‹ä¹‹å‰è¢«å¤„ç†ã€‚ä½†ä¸ä¼šæŠŠç‰‡æ®µå†…æ¶ˆæ¯çš„å…ˆåé¡ºåºå¼ºåŠ åˆ°ä¸å…±äº«åŒä¸€æ¡ç”Ÿå‘½çº¿çš„æ¶ˆæ¯ä¸Šã€‚</li>
<li>ä¸¥æ ¼é¡ºåºç‰‡æ®µ (æ˜¾ç¤º â€œstrictâ€) åŒ…å«äº†ä¸€ç³»åˆ—éœ€è¦æŒ‰ç…§ç»™å®šé¡ºåºå¤„ç†çš„æ¶ˆæ¯ã€‚</li>
<li>éç‰‡æ®µ (æ˜¾ç¤º â€œnegâ€) åŒ…å«äº†ä¸€ç³»åˆ—ä¸å¯ç”¨çš„æ¶ˆæ¯ã€‚</li>
<li>å…³é”®ç‰‡æ®µ å…·æœ‰å…³é”®éƒ¨åˆ†ã€‚</li>
<li>å¿½ç•¥ç‰‡æ®µ å£°æ˜ä¸€ä¸ªæ²¡æœ‰æ„ä¹‰çš„æ¶ˆæ¯ï¼Œå¦‚æœå®ƒå‡ºç°åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­ã€‚</li>
<li>è€ƒè™‘ç‰‡æ®µä¸å¿½ç•¥ç‰‡æ®µç›¸åï¼Œä¸åŒ…å«åœ¨è€ƒè™‘ç‰‡æ®µå†…çš„æ¶ˆæ¯éƒ½åº”è¯¥è¢«å¿½ç•¥ã€‚</li>
<li>æ–­è¨€ç‰‡æ®µ (æ˜¾ç¤º â€œassertâ€)æ ‡æ˜ä»»ä½•æ²¡æœ‰æ˜¾ç¤ºä¸ºå£°æ˜æ“ä½œæ•°çš„é¡ºåºéƒ½æ˜¯æ— æ•ˆçš„ã€‚</li>
<li>å¾ªç¯ç‰‡æ®µ åŒ…å«ä¸€ç³»åˆ—è¢«é‡å¤çš„æ¶ˆæ¯ã€‚</li>
</ul>
<p>ä¸‹å›¾æ˜¾ç¤ºçš„æ˜¯å¾ªç¯ç‰‡æ®µï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-fragment.gif"/></div>
<p>è¿™ä¹Ÿæ˜¯ä¸€ä¸ªç±»ä¼¼äºå¤åˆç‰‡æ®µçš„äº¤äº’å‘ç”Ÿã€‚ äº¤äº’å‘ç”Ÿè¢«å…¶ä»–å›¾å‚è€ƒï¼Œæ˜¾ç¤ºä¸ºå·¦ä¸Šè§’å¸¦&quot;ref&quot;ï¼Œå°†è¢«å‚è€ƒå›¾åæ˜¾ç¤ºåœ¨æ–¹æ¡†çš„ä¸­é—´ã€‚</p>
<h3 id="é—¨"><a class="markdownIt-Anchor" href="#é—¨"></a> é—¨</h3>
<p>é—¨æ˜¯è¿æ¥ç‰‡æ®µå†…æ¶ˆæ¯å’Œç‰‡æ®µå¤–æ¶ˆæ¯çš„è¿æ¥ç‚¹ã€‚ åœ¨ EA ä¸­ï¼Œé—¨æ˜¾ç¤ºä¸ºç‰‡æ®µæ¡†æ¶ä¸Šçš„å°æ­£æ–¹å½¢ã€‚ä½œç”¨ä¸ºæ—¶åºå›¾ä¸é¡µé¢å¤–çš„è¿æ¥å™¨ã€‚ ç”¨æ¥è¡¨ç¤ºè¿›æ¥çš„æ¶ˆæ¯æºï¼Œæˆ–è€…å‡ºå»æ¶ˆæ¯çš„ç»ˆç‚¹ã€‚ä¸‹é¢ä¸¤ä¸ªå›¾æ˜¾ç¤ºå®ƒä»¬åœ¨å®è·µä¸­çš„ä½¿ç”¨ã€‚æ³¨æ„ï¼š&quot; top level diagram&quot;ä¸­çš„é—¨ç”¨æ¶ˆæ¯ç®­å¤´æŒ‡å‘å‚è€ƒç‰‡æ®µï¼Œåœ¨è¿™é‡Œæ²¡æœ‰å¿…è¦æŠŠå®ƒç”»æˆæ–¹å—ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-top-level-diagram.gif"/></div>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-nested-diagram.gif"/></div>
<h3 id="éƒ¨åˆ†åˆ†è§£"><a class="markdownIt-Anchor" href="#éƒ¨åˆ†åˆ†è§£"></a> éƒ¨åˆ†åˆ†è§£</h3>
<p>ä¸€ä¸ªå¯¹è±¡å¯ä»¥å¼•å‡ºå¤šæ¡ç”Ÿå‘½çº¿ï¼Œä½¿å¾—å¯¹è±¡å†…éƒ¨å’Œå¯¹è±¡ä¹‹é—´çš„æ¶ˆæ¯æ˜¾ç¤ºåœ¨åŒä¸€å›¾ä¸Šã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-part-decomposition.gif"/></div>
<h3 id="çŠ¶æ€å¸¸é‡å»¶ç»­"><a class="markdownIt-Anchor" href="#çŠ¶æ€å¸¸é‡å»¶ç»­"></a> çŠ¶æ€å¸¸é‡/å»¶ç»­</h3>
<p>çŠ¶æ€å¸¸é‡æ˜¯ç”Ÿå‘½çº¿çš„çº¦æŸï¼Œè¿è¡Œæ—¶å§‹ç»ˆä¸º&quot;çœŸ&quot;ã€‚æ˜¾ç¤ºä¸ºä¸¤ä¾§åŠåœ†çš„çŸ©å½¢ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-sequence-state-invariant.gif"/></div>
<p>å»¶ç»­è™½ä¸çŠ¶æ€å¸¸é‡æœ‰åŒæ ·çš„æ ‡æ³¨ï¼Œä½†æ˜¯è¢«ç”¨äºå¤åˆç‰‡æ®µï¼Œå¹¶å¯ä»¥å»¶ä¼¸è·¨è¶Šå¤šæ¡ç”Ÿå‘½çº¿ã€‚</p>
<h2 id="æ—¶é—´å›¾"><a class="markdownIt-Anchor" href="#æ—¶é—´å›¾"></a> æ—¶é—´å›¾</h2>
<blockquote>
<p><strong>UML æ—¶é—´å›¾è¢«ç”¨æ¥æ˜¾ç¤ºéšæ—¶é—´å˜åŒ–ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ çš„å€¼æˆ–çŠ¶æ€çš„æ›´æ”¹ã€‚ä¹Ÿæ˜¾ç¤ºæ—¶æ§äº‹ä»¶ä¹‹é—´çš„äº¤äº’å’Œç®¡ç†å®ƒä»¬çš„æ—¶é—´å’ŒæœŸé™çº¦æŸã€‚</strong></p>
</blockquote>
<h3 id="çŠ¶æ€ç”Ÿå‘½çº¿"><a class="markdownIt-Anchor" href="#çŠ¶æ€ç”Ÿå‘½çº¿"></a> çŠ¶æ€ç”Ÿå‘½çº¿</h3>
<p>çŠ¶æ€ç”Ÿå‘½çº¿æ˜¾ç¤ºéšæ—¶é—´å˜åŒ–ï¼Œä¸€ä¸ªå•é¡¹çŠ¶æ€çš„æ”¹å˜ã€‚ä¸è®ºæ—¶é—´å•ä½å¦‚ä½•é€‰æ‹©ï¼ŒX è½´æ˜¾ç¤ºç»è¿‡çš„æ—¶é—´ï¼ŒY è½´è¢«æ ‡ä¸ºç»™å‡ºçŠ¶æ€çš„åˆ—è¡¨ã€‚çŠ¶æ€ç”Ÿå‘½çº¿å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-state-lifeline.gif"/></div>
<h3 id="å€¼ç”Ÿå‘½çº¿"><a class="markdownIt-Anchor" href="#å€¼ç”Ÿå‘½çº¿"></a> å€¼ç”Ÿå‘½çº¿</h3>
<p>å€¼ç”Ÿå‘½çº¿æ˜¾ç¤ºéšæ—¶é—´å˜åŒ–ï¼Œä¸€ä¸ªå•é¡¹çš„å€¼çš„å˜åŒ–ã€‚X è½´æ˜¾ç¤ºç»è¿‡çš„æ—¶é—´ï¼Œæ—¶é—´å•ä½ä¸ºä»»æ„ï¼Œå’ŒçŠ¶æ€ç”Ÿå‘½çº¿ä¸€æ ·ã€‚å¹³è¡Œçº¿ä¹‹é—´æ˜¾ç¤ºå€¼ï¼Œæ¯æ¬¡å€¼å˜åŒ–ï¼Œå¹³è¡Œçº¿äº¤å‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-value-lifeline.gif"/></div>
<h3 id="å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·-2"><a class="markdownIt-Anchor" href="#å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·-2"></a> å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·</h3>
<p>çŠ¶æ€å’Œå€¼çš„ç”Ÿå‘½çº¿èƒ½å åŠ ç»„åˆã€‚å®ƒä»¬å¿…é¡»æœ‰ç›¸åŒçš„ X è½´ã€‚ æ¶ˆæ¯å¯ä»¥ä»ä¸€ä¸ªç”Ÿå‘½çº¿ä¼ é€’åˆ°å¦ä¸€ä¸ªã€‚æ¯ä¸€ä¸ªçŠ¶æ€å’Œå€¼çš„å˜æ¢èƒ½æœ‰ä¸€ä¸ªå®šä¹‰çš„äº‹ä»¶ï¼Œä¸€ä¸ªæ—¶é—´é™åˆ¶æ˜¯æŒ‡ä¸€ä¸ªäº‹ä»¶ä½•æ—¶å¿…é¡»å‘ç”Ÿï¼Œå’Œä¸€ä¸ªæœŸé™é™åˆ¶è¯´æ˜çŠ¶æ€æˆ–å€¼å¤šé•¿æ—¶é—´å¿…é¡»æœ‰æ•ˆã€‚ä¸€æ—¦è¿™äº›å·²ç»è¢«åº”ç”¨ï¼Œå…¶æ—¶é—´å›¾å¯èƒ½æ˜¾ç¤ºå¦‚ä¸‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/uml/uml-timing-diagram.gif"/></div>
<h2 id="uml-å·¥å…·"><a class="markdownIt-Anchor" href="#uml-å·¥å…·"></a> UML å·¥å…·</h2>
<p>UML å·¥å…·éå¸¸å¤šï¼Œåˆ°åº•å“ªç§å·¥å…·å¥½ï¼ŒçœŸçš„æ˜¯ä»è€…è§ä»æ™ºè€…è§æ™ºã€‚è¿™é‡Œåˆ—ä¸¾ä¸€äº›æˆ‘æ¥è§¦è¿‡çš„ UML å·¥å…·ï¼š</p>
<h3 id="äº¿å›¾"><a class="markdownIt-Anchor" href="#äº¿å›¾"></a> äº¿å›¾</h3>
<blockquote>
<p>å›½å†…å¼€å‘çš„ã€æ”¶è´¹çš„ç»˜å›¾å·¥å…·ã€‚å›¾å½¢æ¨¡æ¿ã€ç´ æéå¸¸å…¨é¢ï¼Œæ ·å¼ä¹Ÿå¾ˆç²¾ç¾ï¼Œå¯ä»¥å¯¼å‡ºä¸º wordã€pdfã€å›¾ç‰‡ã€‚</p>
<p><a href="http://www.edrawsoft.cn/" target="_blank" rel="noopener">äº¿å›¾å®˜ç½‘</a></p>
</blockquote>
<div align="center"><img src="http://www.edrawsoft.cn/images/software/createsoftware.png"/></div>
<h3 id="visio"><a class="markdownIt-Anchor" href="#visio"></a> Visio</h3>
<blockquote>
<p>Office çš„ç»˜å›¾å·¥å…·ï¼Œç‰¹ç‚¹æ˜¯ç®€å•ã€æ¸…æ™°ã€‚</p>
<p><a href="https://products.office.com/zh-cn/visio/flowchart-software" target="_blank" rel="noopener">Visio å®˜ç½‘</a></p>
</blockquote>
<div align="center"><img src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE2jMC4?ver=5361&q=90&h=675&w=830&b=%23FFFFFFFF&aim=true"/></div>
<h3 id="staruml"><a class="markdownIt-Anchor" href="#staruml"></a> StarUML</h3>
<blockquote>
<p>æ ·å¼ç²¾ç¾ï¼ŒåŠŸèƒ½å…¨é¢çš„ UML å·¥å…·ã€‚</p>
<p><a href="http://staruml.io/" target="_blank" rel="noopener">StarUML å®˜ç½‘</a></p>
</blockquote>
<div align="center"><img src="http://staruml.io/image/screenshot_jumbotron.png"/></div>
<h3 id="astah"><a class="markdownIt-Anchor" href="#astah"></a> Astah</h3>
<blockquote>
<p>æ ·å¼ä¸é”™ï¼ŒåŠŸèƒ½å…¨é¢çš„ç»˜å›¾å·¥å…·ã€‚</p>
<p><a href="http://astah.net/" target="_blank" rel="noopener">Astah å®˜ç½‘</a></p>
</blockquote>
<div align="center"><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1539757904141&di=7e4f71d0a00ffcd87e0e5aa62f0ed168&imgtype=jpg&src=http%3A%2F%2Fimg4.imgtn.bdimg.com%2Fit%2Fu%3D3525476819%2C2924170461%26fm%3D214%26gp%3D0.jpg"/></div>
<h3 id="argouml"><a class="markdownIt-Anchor" href="#argouml"></a> ArgoUML</h3>
<blockquote>
<p>UML å·¥å…·ã€‚</p>
<p><a href="https://argouml.en.softonic.com/?ex=CAT-759.2" target="_blank" rel="noopener">ArgoUML å®˜ç½‘</a></p>
</blockquote>
<div align="center"><img src="https://gss0.bdstatic.com/-4o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike80%2C5%2C5%2C80%2C26/sign=f4e8a7c6923df8dcb23087c3ac7819ee/8b13632762d0f70315a83ced05fa513d2697c5ed.jpg"/></div>
<h3 id="processon"><a class="markdownIt-Anchor" href="#processon"></a> ProcessOn</h3>
<blockquote>
<p>åœ¨çº¿ç»˜å›¾å·¥å…·ï¼Œç‰¹ç‚¹æ˜¯ç®€æ´ã€æ¸…æ™°ã€‚</p>
<p><a href="https://www.processon.com/" target="_blank" rel="noopener">ProcessOn å®˜ç½‘</a></p>
</blockquote>
<h3 id="drawio"><a class="markdownIt-Anchor" href="#drawio"></a> drawio</h3>
<blockquote>
<p>å¼€æºçš„åœ¨çº¿ç»˜å›¾å·¥å…·ï¼Œç‰¹ç‚¹æ˜¯ç®€æ´ã€æ¸…æ™°ã€‚</p>
<p><a href="https://www.draw.io/" target="_blank" rel="noopener">drawio å®˜ç½‘</a></p>
</blockquote>
<h2 id="æ›´å¤šå†…å®¹"><a class="markdownIt-Anchor" href="#æ›´å¤šå†…å®¹"></a> æ›´å¤šå†…å®¹</h2>
<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E7%BB%9F%E4%B8%80%E5%BB%BA%E6%A8%A1%E8%AF%AD%E8%A8%80" target="_blank" rel="noopener">Wiki-UML</a></li>
<li><a href="https://sparxsystems.cn/resources/uml2_tutorial/index.html" target="_blank" rel="noopener">Sparx UML æ•™ç¨‹</a></li>
<li><a href="https://www.omg.org/spec/UML" target="_blank" rel="noopener">OMG UML</a></li>
<li><a href="https://www.tutorialspoint.com/uml/index.htm" target="_blank" rel="noopener">UML Tutorial</a></li>
<li><a href="https://www.w3cschool.cn/uml_tutorial/" target="_blank" rel="noopener">W3Cschool UML æ•™ç¨‹</a></li>
<li><a href="https://blog.csdn.net/soft_zzti/article/details/79811923" target="_blank" rel="noopener">UML å­¦ä¹ å…¥é—¨å°±è¿™ä¸€ç¯‡æ–‡ç« </a></li>
<li><a href="http://www.cnblogs.com/ywqu/category/223486.html" target="_blank" rel="noopener">http://www.cnblogs.com/ywqu/category/223486.html</a></li>
</ul>
]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>UML</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œä¹‹ä¼ è¾“å±‚</title>
    <url>/blog/communication/network-transport/</url>
    <content><![CDATA[<blockquote>
<p>ç½‘ç»œå±‚åªæŠŠåˆ†ç»„å‘é€åˆ°ç›®çš„ä¸»æœºï¼Œä½†æ˜¯çœŸæ­£é€šä¿¡çš„å¹¶ä¸æ˜¯ä¸»æœºè€Œæ˜¯ä¸»æœºä¸­çš„è¿›ç¨‹ã€‚ä¼ è¾“å±‚æä¾›äº†è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡ï¼Œä¼ è¾“å±‚å‘é«˜å±‚ç”¨æˆ·å±è”½äº†ä¸‹é¢ç½‘ç»œå±‚çš„æ ¸å¿ƒç»†èŠ‚ï¼Œä½¿åº”ç”¨ç¨‹åºçœ‹èµ·æ¥åƒæ˜¯åœ¨ä¸¤ä¸ªä¼ è¾“å±‚å®ä½“ä¹‹é—´æœ‰ä¸€æ¡ç«¯åˆ°ç«¯çš„é€»è¾‘é€šä¿¡ä¿¡é“ã€‚</p>
</blockquote>
<h2 id="udp-å’Œ-tcp-çš„ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#udp-å’Œ-tcp-çš„ç‰¹ç‚¹"></a> UDP å’Œ TCP çš„ç‰¹ç‚¹</h2>
<ul>
<li>
<p>ç”¨æˆ·æ•°æ®æŠ¥åè®® UDPï¼ˆUser Datagram Protocolï¼‰æ˜¯æ— è¿æ¥çš„ï¼Œå°½æœ€å¤§å¯èƒ½äº¤ä»˜ï¼Œæ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œé¢å‘æŠ¥æ–‡ï¼ˆå¯¹äºåº”ç”¨ç¨‹åºä¼ ä¸‹æ¥çš„æŠ¥æ–‡ä¸åˆå¹¶ä¹Ÿä¸æ‹†åˆ†ï¼Œåªæ˜¯æ·»åŠ  UDP é¦–éƒ¨ï¼‰ï¼Œæ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡ã€‚</p>
</li>
<li>
<p>ä¼ è¾“æ§åˆ¶åè®® TCPï¼ˆTransmission Control Protocolï¼‰æ˜¯é¢å‘è¿æ¥çš„ï¼Œæä¾›å¯é äº¤ä»˜ï¼Œæœ‰æµé‡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶ï¼Œæä¾›å…¨åŒå·¥é€šä¿¡ï¼Œé¢å‘å­—èŠ‚æµï¼ˆæŠŠåº”ç”¨å±‚ä¼ ä¸‹æ¥çš„æŠ¥æ–‡çœ‹æˆå­—èŠ‚æµï¼ŒæŠŠå­—èŠ‚æµç»„ç»‡æˆå¤§å°ä¸ç­‰çš„æ•°æ®å—ï¼‰ï¼Œæ¯ä¸€æ¡ TCP è¿æ¥åªèƒ½æ˜¯ç‚¹å¯¹ç‚¹çš„ï¼ˆä¸€å¯¹ä¸€ï¼‰ã€‚</p>
</li>
</ul>
<h2 id="udp-é¦–éƒ¨æ ¼å¼"><a class="markdownIt-Anchor" href="#udp-é¦–éƒ¨æ ¼å¼"></a> UDP é¦–éƒ¨æ ¼å¼</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/1551092392065.png!zp"/></div>
<p>é¦–éƒ¨å­—æ®µåªæœ‰ 8 ä¸ªå­—èŠ‚ï¼ŒåŒ…æ‹¬æºç«¯å£ã€ç›®çš„ç«¯å£ã€é•¿åº¦ã€æ£€éªŒå’Œã€‚12 å­—èŠ‚çš„ä¼ªé¦–éƒ¨æ˜¯ä¸ºäº†è®¡ç®—æ£€éªŒå’Œä¸´æ—¶æ·»åŠ çš„ã€‚</p>
<h2 id="tcp-é¦–éƒ¨æ ¼å¼"><a class="markdownIt-Anchor" href="#tcp-é¦–éƒ¨æ ¼å¼"></a> TCP é¦–éƒ¨æ ¼å¼</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/1551092419042.png!zp"/></div>
<ul>
<li>
<p><strong>åºå·</strong> ï¼šç”¨äºå¯¹å­—èŠ‚æµè¿›è¡Œç¼–å·ï¼Œä¾‹å¦‚åºå·ä¸º 301ï¼Œè¡¨ç¤ºç¬¬ä¸€ä¸ªå­—èŠ‚çš„ç¼–å·ä¸º 301ï¼Œå¦‚æœæºå¸¦çš„æ•°æ®é•¿åº¦ä¸º 100 å­—èŠ‚ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºå·åº”ä¸º 401ã€‚</p>
</li>
<li>
<p><strong>ç¡®è®¤å·</strong> ï¼šæœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºå·ã€‚ä¾‹å¦‚ B æ­£ç¡®æ”¶åˆ° A å‘é€æ¥çš„ä¸€ä¸ªæŠ¥æ–‡æ®µï¼Œåºå·ä¸º 501ï¼Œæºå¸¦çš„æ•°æ®é•¿åº¦ä¸º 200 å­—èŠ‚ï¼Œå› æ­¤ B æœŸæœ›ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºå·ä¸º 701ï¼ŒB å‘é€ç»™ A çš„ç¡®è®¤æŠ¥æ–‡æ®µä¸­ç¡®è®¤å·å°±ä¸º 701ã€‚</p>
</li>
<li>
<p><strong>æ•°æ®åç§»</strong> ï¼šæŒ‡çš„æ˜¯æ•°æ®éƒ¨åˆ†è·ç¦»æŠ¥æ–‡æ®µèµ·å§‹å¤„çš„åç§»é‡ï¼Œå®é™…ä¸ŠæŒ‡çš„æ˜¯é¦–éƒ¨çš„é•¿åº¦ã€‚</p>
</li>
<li>
<p><strong>ç¡®è®¤ ACK</strong> ï¼šå½“ ACK=1 æ—¶ç¡®è®¤å·å­—æ®µæœ‰æ•ˆï¼Œå¦åˆ™æ— æ•ˆã€‚TCP è§„å®šï¼Œåœ¨è¿æ¥å»ºç«‹åæ‰€æœ‰ä¼ é€çš„æŠ¥æ–‡æ®µéƒ½å¿…é¡»æŠŠ ACK ç½® 1ã€‚</p>
</li>
<li>
<p><strong>åŒæ­¥ SYN</strong> ï¼šåœ¨è¿æ¥å»ºç«‹æ—¶ç”¨æ¥åŒæ­¥åºå·ã€‚å½“ SYN=1ï¼ŒACK=0 æ—¶è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚è‹¥å¯¹æ–¹åŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å“åº”æŠ¥æ–‡ä¸­ SYN=1ï¼ŒACK=1ã€‚</p>
</li>
<li>
<p><strong>ç»ˆæ­¢ FIN</strong> ï¼šç”¨æ¥é‡Šæ”¾ä¸€ä¸ªè¿æ¥ï¼Œå½“ FIN=1 æ—¶ï¼Œè¡¨ç¤ºæ­¤æŠ¥æ–‡æ®µçš„å‘é€æ–¹çš„æ•°æ®å·²å‘é€å®Œæ¯•ï¼Œå¹¶è¦æ±‚é‡Šæ”¾è¿æ¥ã€‚</p>
</li>
<li>
<p><strong>çª—å£</strong> ï¼šçª—å£å€¼ä½œä¸ºæ¥æ”¶æ–¹è®©å‘é€æ–¹è®¾ç½®å…¶å‘é€çª—å£çš„ä¾æ®ã€‚ä¹‹æ‰€ä»¥è¦æœ‰è¿™ä¸ªé™åˆ¶ï¼Œæ˜¯å› ä¸ºæ¥æ”¶æ–¹çš„æ•°æ®ç¼“å­˜ç©ºé—´æ˜¯æœ‰é™çš„ã€‚</p>
</li>
</ul>
<h2 id="tcp-çš„ä¸‰æ¬¡æ¡æ‰‹"><a class="markdownIt-Anchor" href="#tcp-çš„ä¸‰æ¬¡æ¡æ‰‹"></a> TCP çš„ä¸‰æ¬¡æ¡æ‰‹</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/1551092794258.png!zp"/></div>
<p>å‡è®¾ A ä¸ºå®¢æˆ·ç«¯ï¼ŒB ä¸ºæœåŠ¡å™¨ç«¯ã€‚</p>
<ul>
<li>
<p>é¦–å…ˆ B å¤„äº LISTENï¼ˆç›‘å¬ï¼‰çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·çš„è¿æ¥è¯·æ±‚ã€‚</p>
</li>
<li>
<p>A å‘ B å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡ï¼ŒSYN=1ï¼ŒACK=0ï¼Œé€‰æ‹©ä¸€ä¸ªåˆå§‹çš„åºå· xã€‚</p>
</li>
<li>
<p>B æ”¶åˆ°è¿æ¥è¯·æ±‚æŠ¥æ–‡ï¼Œå¦‚æœåŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å‘ A å‘é€è¿æ¥ç¡®è®¤æŠ¥æ–‡ï¼ŒSYN=1ï¼ŒACK=1ï¼Œç¡®è®¤å·ä¸º x+1ï¼ŒåŒæ—¶ä¹Ÿé€‰æ‹©ä¸€ä¸ªåˆå§‹çš„åºå· yã€‚</p>
</li>
<li>
<p>A æ”¶åˆ° B çš„è¿æ¥ç¡®è®¤æŠ¥æ–‡åï¼Œè¿˜è¦å‘ B å‘å‡ºç¡®è®¤ï¼Œç¡®è®¤å·ä¸º y+1ï¼Œåºå·ä¸º x+1ã€‚</p>
</li>
<li>
<p>B æ”¶åˆ° A çš„ç¡®è®¤åï¼Œè¿æ¥å»ºç«‹ã€‚</p>
</li>
</ul>
<p><strong>ä¸‰æ¬¡æ¡æ‰‹çš„åŸå› </strong></p>
<p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹æ˜¯ä¸ºäº†é˜²æ­¢å¤±æ•ˆçš„è¿æ¥è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼Œè®©æœåŠ¡å™¨é”™è¯¯æ‰“å¼€è¿æ¥ã€‚</p>
<p>å®¢æˆ·ç«¯å‘é€çš„è¿æ¥è¯·æ±‚å¦‚æœåœ¨ç½‘ç»œä¸­æ»ç•™ï¼Œé‚£ä¹ˆå°±ä¼šéš”å¾ˆé•¿ä¸€æ®µæ—¶é—´æ‰èƒ½æ”¶åˆ°æœåŠ¡å™¨ç«¯å‘å›çš„è¿æ¥ç¡®è®¤ã€‚å®¢æˆ·ç«¯ç­‰å¾…ä¸€ä¸ªè¶…æ—¶é‡ä¼ æ—¶é—´ä¹‹åï¼Œå°±ä¼šé‡æ–°è¯·æ±‚è¿æ¥ã€‚ä½†æ˜¯è¿™ä¸ªæ»ç•™çš„è¿æ¥è¯·æ±‚æœ€åè¿˜æ˜¯ä¼šåˆ°è¾¾æœåŠ¡å™¨ï¼Œå¦‚æœä¸è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šæ‰“å¼€ä¸¤ä¸ªè¿æ¥ã€‚å¦‚æœæœ‰ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯ä¼šå¿½ç•¥æœåŠ¡å™¨ä¹‹åå‘é€çš„å¯¹æ»ç•™è¿æ¥è¯·æ±‚çš„è¿æ¥ç¡®è®¤ï¼Œä¸è¿›è¡Œç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œå› æ­¤å°±ä¸ä¼šå†æ¬¡æ‰“å¼€è¿æ¥ã€‚</p>
<h2 id="tcp-çš„å››æ¬¡æŒ¥æ‰‹"><a class="markdownIt-Anchor" href="#tcp-çš„å››æ¬¡æŒ¥æ‰‹"></a> TCP çš„å››æ¬¡æŒ¥æ‰‹</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/1551092825974.png!zp"/></div>
<p>ä»¥ä¸‹æè¿°ä¸è®¨è®ºåºå·å’Œç¡®è®¤å·ï¼Œå› ä¸ºåºå·å’Œç¡®è®¤å·çš„è§„åˆ™æ¯”è¾ƒç®€å•ã€‚å¹¶ä¸”ä¸è®¨è®º ACKï¼Œå› ä¸º ACK åœ¨è¿æ¥å»ºç«‹ä¹‹åéƒ½ä¸º 1ã€‚</p>
<ul>
<li>
<p>A å‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼ŒFIN=1ã€‚</p>
</li>
<li>
<p>B æ”¶åˆ°ä¹‹åå‘å‡ºç¡®è®¤ï¼Œæ­¤æ—¶ TCP å±äºåŠå…³é—­çŠ¶æ€ï¼ŒB èƒ½å‘ A å‘é€æ•°æ®ä½†æ˜¯ A ä¸èƒ½å‘ B å‘é€æ•°æ®ã€‚</p>
</li>
<li>
<p>å½“ B ä¸å†éœ€è¦è¿æ¥æ—¶ï¼Œå‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼ŒFIN=1ã€‚</p>
</li>
<li>
<p>A æ”¶åˆ°åå‘å‡ºç¡®è®¤ï¼Œè¿›å…¥ TIME-WAIT çŠ¶æ€ï¼Œç­‰å¾… 2 MSLï¼ˆæœ€å¤§æŠ¥æ–‡å­˜æ´»æ—¶é—´ï¼‰åé‡Šæ”¾è¿æ¥ã€‚</p>
</li>
<li>
<p>B æ”¶åˆ° A çš„ç¡®è®¤åé‡Šæ”¾è¿æ¥ã€‚</p>
</li>
</ul>
<p><strong>å››æ¬¡æŒ¥æ‰‹çš„åŸå› </strong></p>
<p>å®¢æˆ·ç«¯å‘é€äº† FIN è¿æ¥é‡Šæ”¾æŠ¥æ–‡ä¹‹åï¼ŒæœåŠ¡å™¨æ”¶åˆ°äº†è¿™ä¸ªæŠ¥æ–‡ï¼Œå°±è¿›å…¥äº† CLOSE-WAIT çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€æ˜¯ä¸ºäº†è®©æœåŠ¡å™¨ç«¯å‘é€è¿˜æœªä¼ é€å®Œæ¯•çš„æ•°æ®ï¼Œä¼ é€å®Œæ¯•ä¹‹åï¼ŒæœåŠ¡å™¨ä¼šå‘é€ FIN è¿æ¥é‡Šæ”¾æŠ¥æ–‡ã€‚</p>
<p><strong>TIME_WAIT</strong></p>
<p>å®¢æˆ·ç«¯æ¥æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„ FIN æŠ¥æ–‡åè¿›å…¥æ­¤çŠ¶æ€ï¼Œæ­¤æ—¶å¹¶ä¸æ˜¯ç›´æ¥è¿›å…¥ CLOSED çŠ¶æ€ï¼Œè¿˜éœ€è¦ç­‰å¾…ä¸€ä¸ªæ—¶é—´è®¡æ—¶å™¨è®¾ç½®çš„æ—¶é—´ 2MSLã€‚è¿™ä¹ˆåšæœ‰ä¸¤ä¸ªç†ç”±ï¼š</p>
<ul>
<li>
<p>ç¡®ä¿æœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾ã€‚å¦‚æœ B æ²¡æ”¶åˆ° A å‘é€æ¥çš„ç¡®è®¤æŠ¥æ–‡ï¼Œé‚£ä¹ˆå°±ä¼šé‡æ–°å‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚æŠ¥æ–‡ï¼ŒA ç­‰å¾…ä¸€æ®µæ—¶é—´å°±æ˜¯ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚</p>
</li>
<li>
<p>ç­‰å¾…ä¸€æ®µæ—¶é—´æ˜¯ä¸ºäº†è®©æœ¬è¿æ¥æŒç»­æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡éƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ï¼Œä½¿å¾—ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ä¸ä¼šå‡ºç°æ—§çš„è¿æ¥è¯·æ±‚æŠ¥æ–‡ã€‚</p>
</li>
</ul>
<h2 id="tcp-å¯é ä¼ è¾“"><a class="markdownIt-Anchor" href="#tcp-å¯é ä¼ è¾“"></a> TCP å¯é ä¼ è¾“</h2>
<p>TCP ä½¿ç”¨è¶…æ—¶é‡ä¼ æ¥å®ç°å¯é ä¼ è¾“ï¼šå¦‚æœä¸€ä¸ªå·²ç»å‘é€çš„æŠ¥æ–‡æ®µåœ¨è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå°±é‡ä¼ è¿™ä¸ªæŠ¥æ–‡æ®µã€‚</p>
<p>ä¸€ä¸ªæŠ¥æ–‡æ®µä»å‘é€å†åˆ°æ¥æ”¶åˆ°ç¡®è®¤æ‰€ç»è¿‡çš„æ—¶é—´ç§°ä¸ºå¾€è¿”æ—¶é—´ RTTï¼ŒåŠ æƒå¹³å‡å¾€è¿”æ—¶é—´ RTTs è®¡ç®—å¦‚ä¸‹ï¼š</p>
<div align="center"><img src="https://latex.codecogs.com/gif.latex?RTTs=(1-a)*(RTTs)+a*RTT"/></div> <br>
<p>å…¶ä¸­ï¼Œ0 â‰¤ a ï¼œ 1ï¼ŒRTTs éšç€ a çš„å¢åŠ æ›´å®¹æ˜“å—åˆ° RTT çš„å½±å“ã€‚</p>
<p>è¶…æ—¶æ—¶é—´ RTO åº”è¯¥ç•¥å¤§äº RTTsï¼ŒTCP ä½¿ç”¨çš„è¶…æ—¶æ—¶é—´è®¡ç®—å¦‚ä¸‹ï¼š</p>
<div align="center"><img src="https://latex.codecogs.com/gif.latex?RTO=RTTs+4*RTT_d"/></div> <br>
<p>å…¶ä¸­ RTT<sub>d</sub> ä¸ºåå·®çš„åŠ æƒå¹³å‡å€¼ã€‚</p>
<h2 id="tcp-æ»‘åŠ¨çª—å£"><a class="markdownIt-Anchor" href="#tcp-æ»‘åŠ¨çª—å£"></a> TCP æ»‘åŠ¨çª—å£</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/1551092841802.png!zp"/></div>
<p>çª—å£æ˜¯ç¼“å­˜çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æš‚æ—¶å­˜æ”¾å­—èŠ‚æµã€‚å‘é€æ–¹å’Œæ¥æ”¶æ–¹å„æœ‰ä¸€ä¸ªçª—å£ï¼Œæ¥æ”¶æ–¹é€šè¿‡ TCP æŠ¥æ–‡æ®µä¸­çš„çª—å£å­—æ®µå‘Šè¯‰å‘é€æ–¹è‡ªå·±çš„çª—å£å¤§å°ï¼Œå‘é€æ–¹æ ¹æ®è¿™ä¸ªå€¼å’Œå…¶å®ƒä¿¡æ¯è®¾ç½®è‡ªå·±çš„çª—å£å¤§å°ã€‚</p>
<p>å‘é€çª—å£å†…çš„å­—èŠ‚éƒ½å…è®¸è¢«å‘é€ï¼Œæ¥æ”¶çª—å£å†…çš„å­—èŠ‚éƒ½å…è®¸è¢«æ¥æ”¶ã€‚å¦‚æœå‘é€çª—å£å·¦éƒ¨çš„å­—èŠ‚å·²ç»å‘é€å¹¶ä¸”æ”¶åˆ°äº†ç¡®è®¤ï¼Œé‚£ä¹ˆå°±å°†å‘é€çª—å£å‘å³æ»‘åŠ¨ä¸€å®šè·ç¦»ï¼Œç›´åˆ°å·¦éƒ¨ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸æ˜¯å·²å‘é€å¹¶ä¸”å·²ç¡®è®¤çš„çŠ¶æ€ï¼›æ¥æ”¶çª—å£çš„æ»‘åŠ¨ç±»ä¼¼ï¼Œæ¥æ”¶çª—å£å·¦éƒ¨å­—èŠ‚å·²ç»å‘é€ç¡®è®¤å¹¶äº¤ä»˜ä¸»æœºï¼Œå°±å‘å³æ»‘åŠ¨æ¥æ”¶çª—å£ã€‚</p>
<p>æ¥æ”¶çª—å£åªä¼šå¯¹çª—å£å†…æœ€åä¸€ä¸ªæŒ‰åºåˆ°è¾¾çš„å­—èŠ‚è¿›è¡Œç¡®è®¤ï¼Œä¾‹å¦‚æ¥æ”¶çª—å£å·²ç»æ”¶åˆ°çš„å­—èŠ‚ä¸º {31, 34, 35}ï¼Œå…¶ä¸­ {31} æŒ‰åºåˆ°è¾¾ï¼Œè€Œ {34, 35} å°±ä¸æ˜¯ï¼Œå› æ­¤åªå¯¹å­—èŠ‚ 31 è¿›è¡Œç¡®è®¤ã€‚å‘é€æ–¹å¾—åˆ°ä¸€ä¸ªå­—èŠ‚çš„ç¡®è®¤ä¹‹åï¼Œå°±çŸ¥é“è¿™ä¸ªå­—èŠ‚ä¹‹å‰çš„æ‰€æœ‰å­—èŠ‚éƒ½å·²ç»è¢«æ¥æ”¶ã€‚</p>
<h2 id="tcp-æµé‡æ§åˆ¶"><a class="markdownIt-Anchor" href="#tcp-æµé‡æ§åˆ¶"></a> TCP æµé‡æ§åˆ¶</h2>
<p>æµé‡æ§åˆ¶æ˜¯ä¸ºäº†æ§åˆ¶å‘é€æ–¹å‘é€é€Ÿç‡ï¼Œä¿è¯æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚</p>
<p>æ¥æ”¶æ–¹å‘é€çš„ç¡®è®¤æŠ¥æ–‡ä¸­çš„çª—å£å­—æ®µå¯ä»¥ç”¨æ¥æ§åˆ¶å‘é€æ–¹çª—å£å¤§å°ï¼Œä»è€Œå½±å“å‘é€æ–¹çš„å‘é€é€Ÿç‡ã€‚å°†çª—å£å­—æ®µè®¾ç½®ä¸º 0ï¼Œåˆ™å‘é€æ–¹ä¸èƒ½å‘é€æ•°æ®ã€‚</p>
<h2 id="tcp-æ‹¥å¡æ§åˆ¶"><a class="markdownIt-Anchor" href="#tcp-æ‹¥å¡æ§åˆ¶"></a> TCP æ‹¥å¡æ§åˆ¶</h2>
<p>å¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡ï¼Œåˆ†ç»„å°†ä¼šä¸¢å¤±ï¼Œæ­¤æ—¶å‘é€æ–¹ä¼šç»§ç»­é‡ä¼ ï¼Œä»è€Œå¯¼è‡´ç½‘ç»œæ‹¥å¡ç¨‹åº¦æ›´é«˜ã€‚å› æ­¤å½“å‡ºç°æ‹¥å¡æ—¶ï¼Œåº”å½“æ§åˆ¶å‘é€æ–¹çš„é€Ÿç‡ã€‚è¿™ä¸€ç‚¹å’Œæµé‡æ§åˆ¶å¾ˆåƒï¼Œä½†æ˜¯å‡ºå‘ç‚¹ä¸åŒã€‚æµé‡æ§åˆ¶æ˜¯ä¸ºäº†è®©æ¥æ”¶æ–¹èƒ½æ¥å¾—åŠæ¥æ”¶ï¼Œè€Œæ‹¥å¡æ§åˆ¶æ˜¯ä¸ºäº†é™ä½æ•´ä¸ªç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/1551092981695.png!zp"/></div>
<p>TCP ä¸»è¦é€šè¿‡å››ä¸ªç®—æ³•æ¥è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼šæ…¢å¼€å§‹ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ã€å¿«æ¢å¤ã€‚</p>
<p>å‘é€æ–¹éœ€è¦ç»´æŠ¤ä¸€ä¸ªå«åšæ‹¥å¡çª—å£ï¼ˆcwndï¼‰çš„çŠ¶æ€å˜é‡ï¼Œæ³¨æ„æ‹¥å¡çª—å£ä¸å‘é€æ–¹çª—å£çš„åŒºåˆ«ï¼šæ‹¥å¡çª—å£åªæ˜¯ä¸€ä¸ªçŠ¶æ€å˜é‡ï¼Œå®é™…å†³å®šå‘é€æ–¹èƒ½å‘é€å¤šå°‘æ•°æ®çš„æ˜¯å‘é€æ–¹çª—å£ã€‚</p>
<p>ä¸ºäº†ä¾¿äºè®¨è®ºï¼Œåšå¦‚ä¸‹å‡è®¾ï¼š</p>
<ul>
<li>æ¥æ”¶æ–¹æœ‰è¶³å¤Ÿå¤§çš„æ¥æ”¶ç¼“å­˜ï¼Œå› æ­¤ä¸ä¼šå‘ç”Ÿæµé‡æ§åˆ¶ï¼›</li>
<li>è™½ç„¶ TCP çš„çª—å£åŸºäºå­—èŠ‚ï¼Œä½†æ˜¯è¿™é‡Œè®¾çª—å£çš„å¤§å°å•ä½ä¸ºæŠ¥æ–‡æ®µã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/1551093119265.png!zp"/></div>
<h3 id="1-æ…¢å¼€å§‹ä¸æ‹¥å¡é¿å…"><a class="markdownIt-Anchor" href="#1-æ…¢å¼€å§‹ä¸æ‹¥å¡é¿å…"></a> 1. æ…¢å¼€å§‹ä¸æ‹¥å¡é¿å…</h3>
<p>å‘é€çš„æœ€åˆæ‰§è¡Œæ…¢å¼€å§‹ï¼Œä»¤ cwnd = 1ï¼Œå‘é€æ–¹åªèƒ½å‘é€ 1 ä¸ªæŠ¥æ–‡æ®µï¼›å½“æ”¶åˆ°ç¡®è®¤åï¼Œå°† cwnd åŠ å€ï¼Œå› æ­¤ä¹‹åå‘é€æ–¹èƒ½å¤Ÿå‘é€çš„æŠ¥æ–‡æ®µæ•°é‡ä¸ºï¼š2ã€4ã€8 â€¦</p>
<p>æ³¨æ„åˆ°æ…¢å¼€å§‹æ¯ä¸ªè½®æ¬¡éƒ½å°† cwnd åŠ å€ï¼Œè¿™æ ·ä¼šè®© cwnd å¢é•¿é€Ÿåº¦éå¸¸å¿«ï¼Œä»è€Œä½¿å¾—å‘é€æ–¹å‘é€çš„é€Ÿåº¦å¢é•¿é€Ÿåº¦è¿‡å¿«ï¼Œç½‘ç»œæ‹¥å¡çš„å¯èƒ½æ€§ä¹Ÿå°±æ›´é«˜ã€‚è®¾ç½®ä¸€ä¸ªæ…¢å¼€å§‹é—¨é™ ssthreshï¼Œå½“ cwnd &gt;= ssthresh æ—¶ï¼Œè¿›å…¥æ‹¥å¡é¿å…ï¼Œæ¯ä¸ªè½®æ¬¡åªå°† cwnd åŠ  1ã€‚</p>
<p>å¦‚æœå‡ºç°äº†è¶…æ—¶ï¼Œåˆ™ä»¤ ssthresh = cwnd / 2ï¼Œç„¶åé‡æ–°æ‰§è¡Œæ…¢å¼€å§‹ã€‚</p>
<h3 id="2-å¿«é‡ä¼ ä¸å¿«æ¢å¤"><a class="markdownIt-Anchor" href="#2-å¿«é‡ä¼ ä¸å¿«æ¢å¤"></a> 2. å¿«é‡ä¼ ä¸å¿«æ¢å¤</h3>
<p>åœ¨æ¥æ”¶æ–¹ï¼Œè¦æ±‚æ¯æ¬¡æ¥æ”¶åˆ°æŠ¥æ–‡æ®µéƒ½åº”è¯¥å¯¹æœ€åä¸€ä¸ªå·²æ”¶åˆ°çš„æœ‰åºæŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤ã€‚ä¾‹å¦‚å·²ç»æ¥æ”¶åˆ° M<sub>1</sub> å’Œ M<sub>2</sub>ï¼Œæ­¤æ—¶æ”¶åˆ° M<sub>4</sub>ï¼Œåº”å½“å‘é€å¯¹ M<sub>2</sub> çš„ç¡®è®¤ã€‚</p>
<p>åœ¨å‘é€æ–¹ï¼Œå¦‚æœæ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤ï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µä¸¢å¤±ï¼Œæ­¤æ—¶æ‰§è¡Œå¿«é‡ä¼ ï¼Œç«‹å³é‡ä¼ ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µã€‚ä¾‹å¦‚æ”¶åˆ°ä¸‰ä¸ª M<sub>2</sub>ï¼Œåˆ™ M<sub>3</sub> ä¸¢å¤±ï¼Œç«‹å³é‡ä¼  M<sub>3</sub>ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªæ˜¯ä¸¢å¤±ä¸ªåˆ«æŠ¥æ–‡æ®µï¼Œè€Œä¸æ˜¯ç½‘ç»œæ‹¥å¡ã€‚å› æ­¤æ‰§è¡Œå¿«æ¢å¤ï¼Œä»¤ ssthresh = cwnd / 2 ï¼Œcwnd = ssthreshï¼Œæ³¨æ„åˆ°æ­¤æ—¶ç›´æ¥è¿›å…¥æ‹¥å¡é¿å…ã€‚</p>
<p>æ…¢å¼€å§‹å’Œå¿«æ¢å¤çš„å¿«æ…¢æŒ‡çš„æ˜¯ cwnd çš„è®¾å®šå€¼ï¼Œè€Œä¸æ˜¯ cwnd çš„å¢é•¿é€Ÿç‡ã€‚æ…¢å¼€å§‹ cwnd è®¾å®šä¸º 1ï¼Œè€Œå¿«æ¢å¤ cwnd è®¾å®šä¸º ssthreshã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/transport/1551093167163.png!zp"/></div>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>HBase Java API</title>
    <url>/blog/bigdata/hbase/hbase-api-java/</url>
    <content><![CDATA[<h1 id="hbase-java-api"><a class="markdownIt-Anchor" href="#hbase-java-api"></a> HBase Java API</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E6%9B%B4%E5%A4%9A%E5%86%85%E5%AE%B9">æ›´å¤šå†…å®¹</a>
<ul>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="æ›´å¤šå†…å®¹"><a class="markdownIt-Anchor" href="#æ›´å¤šå†…å®¹"></a> æ›´å¤šå†…å®¹</h2>
<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h3>
<p><a href="https://blog.csdn.net/jiyiqinlovexx/article/details/36526433" target="_blank" rel="noopener">https://blog.csdn.net/jiyiqinlovexx/article/details/36526433</a><br />
<a href="https://blog.csdn.net/u010967382/article/details/38046821" target="_blank" rel="noopener">https://blog.csdn.net/u010967382/article/details/38046821</a></p>
]]></content>
  </entry>
  <entry>
    <title>HDFS å‘½ä»¤</title>
    <url>/blog/bigdata/hdfs/hdfs-cli/</url>
    <content><![CDATA[<h1 id="hdfs-å‘½ä»¤"><a class="markdownIt-Anchor" href="#hdfs-å‘½ä»¤"></a> HDFS å‘½ä»¤</h1>
<ul>
<li>åˆ—å‡ºç›®å½•çš„å†…å®¹ï¼š</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>hdfs dfs -ls /</span><br></pre></td></tr></table></figure>
<ul>
<li>å°†æ–‡ä»¶ä»æœ¬åœ°æ–‡ä»¶ç³»ç»ŸåŠ è½½åˆ°HDFSï¼š</li>
</ul>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="symbol">$</span> hdfs dfs -<span class="keyword">put</span> songs.txt /user/adam</span><br></pre></td></tr></table></figure>
<ul>
<li>ä»HDFSè¯»å–æ–‡ä»¶å†…å®¹ï¼š</li>
</ul>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">$ hdfs dfs -cat <span class="regexp">/user/</span>adam<span class="regexp">/songs.txt</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ›´æ”¹æ–‡ä»¶çš„æƒé™ï¼š</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">$ hdfs dfs -chmod <span class="number">700</span> /user/adam/songs.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>å°†æ–‡ä»¶çš„å¤åˆ¶å› å­è®¾ç½®ä¸º4ï¼š</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">$ hdfs dfs -setrep -w <span class="number">4</span> /user/adam/songs.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>æ£€æŸ¥æ–‡ä»¶çš„å¤§å°ï¼š</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">$ hdfs dfs -du -h /user/adam/songs.txt Create a subdirectory in your <span class="built_in">home</span> directory.</span><br><span class="line">$ hdfs dfs -<span class="built_in">mkdir</span> songs</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œç›¸å¯¹è·¯å¾„æ€»æ˜¯å¼•ç”¨æ‰§è¡Œå‘½ä»¤çš„ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚HDFSä¸Šæ²¡æœ‰â€œå½“å‰â€ç›®å½•çš„æ¦‚å¿µï¼ˆæ¢å¥è¯è¯´ï¼Œæ²¡æœ‰â€œCDâ€å‘½ä»¤ï¼‰ï¼š</p>
<ul>
<li>
<p>å°†æ–‡ä»¶ç§»åˆ°æ–°åˆ›å»ºçš„å­ç›®å½•ï¼š</p>
<p>$ hdfs dfs -mv songs.txt songs</p>
</li>
<li>
<p>ä»HDFSä¸­åˆ é™¤ä¸€ä¸ªç›®å½•ï¼š</p>
<p>$ hdfs dfs -rm -r songs</p>
</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>HBase</title>
    <url>/blog/bigdata/hbase/README/</url>
    <content><![CDATA[<h1 id="hbase"><a class="markdownIt-Anchor" href="#hbase"></a> HBase</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E7%AE%80%E4%BB%8B">ç®€ä»‹</a></li>
<li><a href="#%E5%9F%BA%E7%A1%80">åŸºç¡€</a></li>
<li><a href="#%E5%8E%9F%E7%90%86">åŸç†</a>
<ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B">æ•°æ®æ¨¡å‹</a></li>
<li><a href="#hbase-%E6%9E%B6%E6%9E%84">HBase æ¶æ„</a></li>
</ul>
</li>
<li><a href="#hbase-%E5%92%8C-rdbms">HBase å’Œ RDBMS</a></li>
<li><a href="#api">API</a></li>
<li><a href="#%E9%99%84%E5%BD%95">é™„å½•</a>
<ul>
<li><a href="#%E5%91%BD%E4%BB%A4%E8%A1%8C">å‘½ä»¤è¡Œ</a></li>
</ul>
</li>
<li><a href="#%E6%9B%B4%E5%A4%9A%E5%86%85%E5%AE%B9">æ›´å¤šå†…å®¹</a>
<ul>
<li><a href="#%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB">æ‰©å±•é˜…è¯»</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<p>HBase æ˜¯å»ºç«‹åœ¨ HDFS åŸºç¡€ä¸Šçš„é¢å‘åˆ—çš„åˆ†å¸ƒå¼æ•°æ®åº“ã€‚</p>
<ul>
<li>HBase å‚è€ƒäº†è°·æ­Œçš„ BigTable å»ºæ¨¡ï¼Œå®ç°çš„ç¼–ç¨‹è¯­è¨€ä¸º Javaã€‚</li>
<li>å®ƒæ˜¯ Hadoop é¡¹ç›®çš„å­é¡¹ç›®ï¼Œè¿è¡Œäº HDFS æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šã€‚</li>
</ul>
<p>HBase é€‚ç”¨åœºæ™¯ï¼šå®æ—¶åœ°éšæœºè®¿é—®è¶…å¤§æ•°æ®é›†ã€‚</p>
<p>åœ¨ <a href="https://zh.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86" target="_blank" rel="noopener">CAP ç†è®º</a>ä¸­ï¼ŒHBase å±äº CP ç±»å‹çš„ç³»ç»Ÿã€‚</p>
<h2 id="åŸºç¡€"><a class="markdownIt-Anchor" href="#åŸºç¡€"></a> åŸºç¡€</h2>
<p><a href="hbase-ops.md">HBase ç»´æŠ¤</a></p>
<h2 id="åŸç†"><a class="markdownIt-Anchor" href="#åŸç†"></a> åŸç†</h2>
<h3 id="æ•°æ®æ¨¡å‹"><a class="markdownIt-Anchor" href="#æ•°æ®æ¨¡å‹"></a> æ•°æ®æ¨¡å‹</h3>
<p>HBase æ˜¯ä¸€ä¸ªé¢å‘åˆ—çš„æ•°æ®åº“ï¼Œåœ¨è¡¨ä¸­å®ƒç”±è¡Œæ’åºã€‚</p>
<p>HBase è¡¨æ¨¡å‹ç»“æ„ä¸ºï¼š</p>
<ul>
<li>è¡¨ï¼ˆtableï¼‰æ˜¯è¡Œçš„é›†åˆã€‚</li>
<li>è¡Œï¼ˆrowï¼‰æ˜¯åˆ—æ—çš„é›†åˆã€‚</li>
<li>åˆ—æ—ï¼ˆcolumn familyï¼‰æ˜¯åˆ—çš„é›†åˆã€‚</li>
<li>åˆ—ï¼ˆrowï¼‰æ˜¯é”®å€¼å¯¹çš„é›†åˆã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hbase/1551164163369.png"/></div>
<p>HBase è¡¨çš„å•å…ƒæ ¼ï¼ˆcellï¼‰ç”±è¡Œå’Œåˆ—çš„åæ ‡äº¤å‰å†³å®šï¼Œæ˜¯æœ‰ç‰ˆæœ¬çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç‰ˆæœ¬å·æ˜¯è‡ªåŠ¨åˆ†é…çš„ï¼Œä¸º HBase æ’å…¥å•å…ƒæ ¼æ—¶çš„æ—¶é—´æˆ³ã€‚å•å…ƒæ ¼çš„å†…å®¹æ˜¯æœªè§£é‡Šçš„å­—èŠ‚æ•°ç»„ã€‚</p>
<p>è¡Œçš„é”®ä¹Ÿæ˜¯æœªè§£é‡Šçš„å­—èŠ‚æ•°ç»„ï¼Œæ‰€ä»¥ç†è®ºä¸Šï¼Œä»»ä½•æ•°æ®éƒ½å¯ä»¥é€šè¿‡åºåˆ—åŒ–è¡¨ç¤ºæˆå­—ç¬¦ä¸²æˆ–äºŒè¿›åˆ¶ï¼Œä»è€Œå­˜ä¸º HBase çš„é”®å€¼ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hbase/1551164224778.png"/></div>
<h3 id="hbase-æ¶æ„"><a class="markdownIt-Anchor" href="#hbase-æ¶æ„"></a> HBase æ¶æ„</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hbase/1551164744748.png"/></div>
<p>å’Œ HDFSã€YARN ä¸€æ ·ï¼ŒHBase ä¹Ÿé‡‡ç”¨ master / slave æ¶æ„ï¼š</p>
<ul>
<li>HBase æœ‰ä¸€ä¸ª master èŠ‚ç‚¹ã€‚master èŠ‚ç‚¹è´Ÿè´£å°†åŒºåŸŸï¼ˆregionï¼‰åˆ†é…ç»™ region èŠ‚ç‚¹ï¼›æ¢å¤ region èŠ‚ç‚¹çš„æ•…éšœã€‚</li>
<li>HBase æœ‰å¤šä¸ª region èŠ‚ç‚¹ã€‚region èŠ‚ç‚¹è´Ÿè´£é›¶ä¸ªæˆ–å¤šä¸ªåŒºåŸŸï¼ˆregionï¼‰çš„ç®¡ç†å¹¶ç›¸åº”å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ã€‚region èŠ‚ç‚¹è¿˜è´Ÿè´£åŒºåŸŸçš„åˆ’åˆ†å¹¶é€šçŸ¥ master èŠ‚ç‚¹æœ‰äº†æ–°çš„å­åŒºåŸŸã€‚</li>
</ul>
<p>HBase ä¾èµ– ZooKeeper æ¥å®ç°æ•…éšœæ¢å¤ã€‚</p>
<h4 id="regin"><a class="markdownIt-Anchor" href="#regin"></a> Regin</h4>
<p>HBase è¡¨æŒ‰è¡Œé”®èŒƒå›´æ°´å¹³è‡ªåŠ¨åˆ’åˆ†ä¸ºåŒºåŸŸï¼ˆregionï¼‰ã€‚æ¯ä¸ªåŒºåŸŸç”±è¡¨ä¸­è¡Œçš„å­é›†æ„æˆã€‚æ¯ä¸ªåŒºåŸŸç”±å®ƒæ‰€å±çš„è¡¨ã€å®ƒæ‰€å«çš„ç¬¬ä¸€è¡ŒåŠæœ€åä¸€è¡Œæ¥è¡¨ç¤ºã€‚</p>
<p><strong>åŒºåŸŸåªä¸è¿‡æ˜¯è¡¨è¢«æ‹†åˆ†ï¼Œå¹¶åˆ†å¸ƒåœ¨åŒºåŸŸæœåŠ¡å™¨ã€‚</strong></p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hbase/1551165887616.png"/></div>
<h4 id="master-æœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#master-æœåŠ¡å™¨"></a> Master æœåŠ¡å™¨</h4>
<p>åŒºåŸŸåˆ†é…ã€DDL(createã€delete)æ“ä½œç”± HBase master æœåŠ¡å™¨å¤„ç†ã€‚</p>
<ul>
<li>master æœåŠ¡å™¨è´Ÿè´£åè°ƒ region æœåŠ¡å™¨
<ul>
<li>ååŠ©åŒºåŸŸå¯åŠ¨ï¼Œå‡ºç°æ•…éšœæ¢å¤æˆ–è´Ÿè½½å‡è¡¡æƒ…å†µæ—¶ï¼Œé‡æ–°åˆ†é… region æœåŠ¡å™¨</li>
<li>ç›‘æ§é›†ç¾¤ä¸­çš„æ‰€æœ‰ region æœåŠ¡å™¨</li>
</ul>
</li>
<li>æ”¯æŒ DDL æ¥å£ï¼ˆåˆ›å»ºã€åˆ é™¤ã€æ›´æ–°è¡¨ï¼‰</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hbase/1551166513572.png"/></div>
<h4 id="regin-æœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#regin-æœåŠ¡å™¨"></a> Regin æœåŠ¡å™¨</h4>
<p>åŒºåŸŸæœåŠ¡å™¨è¿è¡Œåœ¨ HDFS æ•°æ®èŠ‚ç‚¹ä¸Šï¼Œå…·æœ‰ä»¥ä¸‹ç»„ä»¶</p>
<ul>
<li>
<p><code>WAL</code> - Write Ahead Log æ˜¯ HDFS ä¸Šçš„æ–‡ä»¶ã€‚WAL å­˜å‚¨å°šæœªæŒä¹…å­˜å‚¨åˆ°æ°¸ä¹…å­˜å‚¨çš„æ–°æ•°æ®ï¼Œå®ƒç”¨äºåœ¨å‘ç”Ÿæ•…éšœæ—¶è¿›è¡Œæ¢å¤ã€‚</p>
</li>
<li>
<p><code>BlockCache</code> - æ˜¯è¯»ç¼“å­˜ã€‚å®ƒå°†é¢‘ç¹è¯»å–çš„æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚è‡³å°‘æœ€è¿‘ä½¿ç”¨çš„æ•°æ®åœ¨å®Œæ•´æ—¶è¢«é€å‡ºã€‚</p>
</li>
<li>
<p><code>MemStore</code> - æ˜¯å†™ç¼“å­˜ã€‚å®ƒå­˜å‚¨å°šæœªå†™å…¥ç£ç›˜çš„æ–°æ•°æ®ã€‚åœ¨å†™å…¥ç£ç›˜ä¹‹å‰å¯¹å…¶è¿›è¡Œæ’åºã€‚æ¯ä¸ªåŒºåŸŸæ¯ä¸ªåˆ—æ—æœ‰ä¸€ä¸ª MemStoreã€‚</p>
</li>
<li>
<p><code>Hfiles</code> - å°†è¡Œå­˜å‚¨ä¸ºç£ç›˜ä¸Šçš„æ’åºé”®å€¼å¯¹ã€‚</p>
</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hbase/1551166602999.png"/></div>
<h4 id="zookeeper"><a class="markdownIt-Anchor" href="#zookeeper"></a> ZooKeeper</h4>
<p>HBase ä½¿ç”¨ ZooKeeper ä½œä¸ºåˆ†å¸ƒå¼åè°ƒæœåŠ¡æ¥ç»´æŠ¤é›†ç¾¤ä¸­çš„æœåŠ¡å™¨çŠ¶æ€ã€‚Zookeeper ç»´æŠ¤å“ªäº›æœåŠ¡å™¨æ˜¯æ´»åŠ¨çš„å’Œå¯ç”¨çš„ï¼Œå¹¶æä¾›æœåŠ¡å™¨æ•…éšœé€šçŸ¥ã€‚é›†ç¾¤è‡³å°‘åº”è¯¥æœ‰ 3 ä¸ªèŠ‚ç‚¹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hbase/1551166447147.png"/></div>
<h2 id="hbase-å’Œ-rdbms"><a class="markdownIt-Anchor" href="#hbase-å’Œ-rdbms"></a> HBase å’Œ RDBMS</h2>
<table>
<thead>
<tr>
<th>HBase</th>
<th>RDBMS</th>
</tr>
</thead>
<tbody>
<tr>
<td>HBase æ— æ¨¡å¼ï¼Œå®ƒä¸å…·æœ‰å›ºå®šåˆ—æ¨¡å¼çš„æ¦‚å¿µ;ä»…å®šä¹‰åˆ—æ—ã€‚</td>
<td>RDBMS æœ‰å®ƒçš„æ¨¡å¼ï¼Œæè¿°è¡¨çš„æ•´ä½“ç»“æ„çš„çº¦æŸã€‚</td>
</tr>
<tr>
<td>å®ƒä¸“é—¨åˆ›å»ºä¸ºå®½è¡¨ã€‚ HBase æ˜¯æ¨ªå‘æ‰©å±•ã€‚</td>
<td>è¿™äº›éƒ½æ˜¯ç»†è€Œä¸“ä¸ºå°è¡¨ã€‚å¾ˆéš¾å½¢æˆè§„æ¨¡ã€‚</td>
</tr>
<tr>
<td>æ²¡æœ‰ä»»ä½•äº‹åŠ¡å­˜åœ¨äº HBaseã€‚</td>
<td>RDBMS æ˜¯äº‹åŠ¡æ€§çš„ã€‚</td>
</tr>
<tr>
<td>å®ƒåè§„èŒƒåŒ–çš„æ•°æ®ã€‚</td>
<td>å®ƒå…·æœ‰è§„èŒƒåŒ–çš„æ•°æ®ã€‚</td>
</tr>
<tr>
<td>å®ƒç”¨äºåŠç»“æ„ä»¥åŠç»“æ„åŒ–æ•°æ®æ˜¯éå¸¸å¥½çš„ã€‚</td>
<td>ç”¨äºç»“æ„åŒ–æ•°æ®éå¸¸å¥½ã€‚</td>
</tr>
</tbody>
</table>
<h2 id="api"><a class="markdownIt-Anchor" href="#api"></a> API</h2>
<p>Java API å½’çº³æ€»ç»“åœ¨è¿™é‡Œï¼š<a href="hbase-api-java.md">Hbase Java API</a></p>
<h2 id="é™„å½•"><a class="markdownIt-Anchor" href="#é™„å½•"></a> é™„å½•</h2>
<h3 id="å‘½ä»¤è¡Œ"><a class="markdownIt-Anchor" href="#å‘½ä»¤è¡Œ"></a> å‘½ä»¤è¡Œ</h3>
<p>HBase å‘½ä»¤è¡Œå¯ä»¥å‚è€ƒè¿™é‡Œï¼š<a href="hbase-cli.md">HBase å‘½ä»¤è¡Œ</a></p>
<h2 id="æ›´å¤šå†…å®¹"><a class="markdownIt-Anchor" href="#æ›´å¤šå†…å®¹"></a> æ›´å¤šå†…å®¹</h2>
<h3 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h3>
<ul>
<li><a href="hbase-cli.md">HBase å‘½ä»¤</a></li>
<li><a href="hbase-ops.md">HBase é…ç½®</a></li>
</ul>
<h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h3>
<h4 id="å®˜æ–¹"><a class="markdownIt-Anchor" href="#å®˜æ–¹"></a> å®˜æ–¹</h4>
<ul>
<li><a href="http://hbase.apache.org/" target="_blank" rel="noopener">HBase å®˜ç½‘</a></li>
<li><a href="https://hbase.apache.org/book.html" target="_blank" rel="noopener">HBase å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="http://abloz.com/hbase/book.html" target="_blank" rel="noopener">HBase å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆ</a></li>
<li><a href="https://hbase.apache.org/apidocs/index.html" target="_blank" rel="noopener">HBase API</a></li>
</ul>
<h4 id="æ–‡ç« "><a class="markdownIt-Anchor" href="#æ–‡ç« "></a> æ–‡ç« </h4>
<ul>
<li><a href="https://static.googleusercontent.com/media/research.google.com/zh-CN//archive/bigtable-osdi06.pdf" target="_blank" rel="noopener">Bigtable: A Distributed Storage System for Structured Data</a></li>
<li><a href="https://mapr.com/blog/in-depth-look-hbase-architecture/" target="_blank" rel="noopener">https://mapr.com/blog/in-depth-look-hbase-architecture/</a></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>HBase å‘½ä»¤</title>
    <url>/blog/bigdata/hbase/hbase-cli/</url>
    <content><![CDATA[<h1 id="hbase-å‘½ä»¤"><a class="markdownIt-Anchor" href="#hbase-å‘½ä»¤"></a> HBase å‘½ä»¤</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#1-%E8%BF%9E%E6%8E%A5-hbase">1. è¿æ¥ HBase</a></li>
<li><a href="#2-%E6%9F%A5%E8%AF%A2%E5%B8%AE%E5%8A%A9">2. æŸ¥è¯¢å¸®åŠ©</a></li>
<li><a href="#3-%E5%88%9B%E5%BB%BA%E8%A1%A8">3. åˆ›å»ºè¡¨</a></li>
<li><a href="#4-%E6%9F%A5%E7%9C%8B%E8%A1%A8%E4%BF%A1%E6%81%AF">4. æŸ¥çœ‹è¡¨ä¿¡æ¯</a></li>
<li><a href="#5-%E6%9F%A5%E7%9C%8B%E8%A1%A8%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF">5. æŸ¥çœ‹è¡¨è¯¦ç»†ä¿¡æ¯</a></li>
<li><a href="#6-%E5%90%91%E8%A1%A8%E4%B8%AD%E5%86%99%E6%95%B0%E6%8D%AE">6. å‘è¡¨ä¸­å†™æ•°æ®</a></li>
<li><a href="#7-%E6%89%AB%E6%8F%8F%E8%A1%A8">7. æ‰«æè¡¨</a></li>
<li><a href="#8-%E6%9F%A5%E8%AF%A2-row">8. æŸ¥è¯¢ row</a></li>
<li><a href="#9-%E7%A6%81%E7%94%A8%E5%90%AF%E7%94%A8%E8%A1%A8">9. ç¦ç”¨ã€å¯ç”¨è¡¨</a></li>
<li><a href="#10-%E5%88%A0%E9%99%A4%E8%A1%A8">10. åˆ é™¤è¡¨</a></li>
<li><a href="#11-%E5%81%9C%E6%AD%A2-hbase">11. åœæ­¢ HBase</a></li>
</ul>
<!-- /TOC -->
<h2 id="1-è¿æ¥-hbase"><a class="markdownIt-Anchor" href="#1-è¿æ¥-hbase"></a> 1. è¿æ¥ HBase</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./bin/hbase shell</span><br><span class="line">hbase(main):001:0&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-æŸ¥è¯¢å¸®åŠ©"><a class="markdownIt-Anchor" href="#2-æŸ¥è¯¢å¸®åŠ©"></a> 2. æŸ¥è¯¢å¸®åŠ©</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">help</span></span><br></pre></td></tr></table></figure>
<h2 id="3-åˆ›å»ºè¡¨"><a class="markdownIt-Anchor" href="#3-åˆ›å»ºè¡¨"></a> 3. åˆ›å»ºè¡¨</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">create <span class="string">'table1'</span>,<span class="string">'columnFamliy1'</span>,<span class="string">'columnFamliy2'</span></span><br></pre></td></tr></table></figure>
<p>è¯´æ˜ï¼š</p>
<p>åˆ›å»ºä¸€å¼ åä¸º table1 çš„ HBase è¡¨ï¼ŒcolumnFamliy1ã€columnFamliy2 æ˜¯ table1 è¡¨çš„åˆ—æ—ã€‚</p>
<h2 id="4-æŸ¥çœ‹è¡¨ä¿¡æ¯"><a class="markdownIt-Anchor" href="#4-æŸ¥çœ‹è¡¨ä¿¡æ¯"></a> 4. æŸ¥çœ‹è¡¨ä¿¡æ¯</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">list <span class="string">'table1'</span></span><br></pre></td></tr></table></figure>
<h2 id="5-æŸ¥çœ‹è¡¨è¯¦ç»†ä¿¡æ¯"><a class="markdownIt-Anchor" href="#5-æŸ¥çœ‹è¡¨è¯¦ç»†ä¿¡æ¯"></a> 5. æŸ¥çœ‹è¡¨è¯¦ç»†ä¿¡æ¯</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">describe <span class="string">'table1'</span></span><br></pre></td></tr></table></figure>
<h2 id="6-å‘è¡¨ä¸­å†™æ•°æ®"><a class="markdownIt-Anchor" href="#6-å‘è¡¨ä¸­å†™æ•°æ®"></a> 6. å‘è¡¨ä¸­å†™æ•°æ®</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">put <span class="string">'table1'</span>, <span class="string">'row1'</span>, <span class="string">'columnFamliy1:a'</span>, <span class="string">'valueA'</span></span><br><span class="line">put <span class="string">'table1'</span>, <span class="string">'row1'</span>, <span class="string">'columnFamliy1:b'</span>, <span class="string">'valueB'</span></span><br><span class="line">put <span class="string">'table1'</span>, <span class="string">'row1'</span>, <span class="string">'columnFamliy1:c'</span>, <span class="string">'valueC'</span></span><br><span class="line"></span><br><span class="line">put <span class="string">'table1'</span>, <span class="string">'row2'</span>, <span class="string">'columnFamliy1:a'</span>, <span class="string">'valueA'</span></span><br><span class="line">put <span class="string">'table1'</span>, <span class="string">'row2'</span>, <span class="string">'columnFamliy1:b'</span>, <span class="string">'valueB'</span></span><br><span class="line">put <span class="string">'table1'</span>, <span class="string">'row2'</span>, <span class="string">'columnFamliy1:c'</span>, <span class="string">'valueC'</span></span><br><span class="line"></span><br><span class="line">put <span class="string">'table1'</span>, <span class="string">'row1'</span>, <span class="string">'columnFamliy2:a'</span>, <span class="string">'valueA'</span></span><br><span class="line">put <span class="string">'table1'</span>, <span class="string">'row1'</span>, <span class="string">'columnFamliy2:b'</span>, <span class="string">'valueB'</span></span><br><span class="line">put <span class="string">'table1'</span>, <span class="string">'row1'</span>, <span class="string">'columnFamliy2:c'</span>, <span class="string">'valueC'</span></span><br></pre></td></tr></table></figure>
<h2 id="7-æ‰«æè¡¨"><a class="markdownIt-Anchor" href="#7-æ‰«æè¡¨"></a> 7. æ‰«æè¡¨</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hbase&gt; scan <span class="string">'hbase:meta'</span></span><br><span class="line">hbase&gt; scan <span class="string">'hbase:meta'</span>, &#123;COLUMNS =&gt; <span class="string">'info:regioninfo'</span>&#125;</span><br><span class="line">hbase&gt; scan <span class="string">'ns1:</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;COLUMNS =&gt; ['</span>c1<span class="string">', '</span>c2<span class="string">'], LIMIT =&gt; 10, STARTROW =&gt; '</span>xyz<span class="string">'&#125;</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;COLUMNS =&gt; '</span>c1<span class="string">', TIMERANGE =&gt; [1303668804, 1303668904]&#125;</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;REVERSED =&gt; true&#125;</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;ALL_METRICS =&gt; true&#125;</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;METRICS =&gt; ['</span>RPC_RETRIES<span class="string">', '</span>ROWS_FILTERED<span class="string">']&#125;</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;ROWPREFIXFILTER =&gt; '</span>row2<span class="string">', FILTER =&gt; "</span></span><br><span class="line"><span class="string">  (QualifierFilter (&gt;=, '</span>binary:xyz<span class="string">')) AND (TimestampsFilter ( 123, 456))"&#125;</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;FILTER =&gt;</span></span><br><span class="line"><span class="string">  org.apache.hadoop.hbase.filter.ColumnPaginationFilter.new(1, 0)&#125;</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;CONSISTENCY =&gt; '</span>TIMELINE<span class="string">'&#125;</span></span><br><span class="line"><span class="string">For setting the Operation Attributes </span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123; COLUMNS =&gt; ['</span>c1<span class="string">', '</span>c2<span class="string">'], ATTRIBUTES =&gt; &#123;'</span>mykey<span class="string">' =&gt; '</span>myvalue<span class="string">'&#125;&#125;</span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123; COLUMNS =&gt; ['</span>c1<span class="string">', '</span>c2<span class="string">'], AUTHORIZATIONS =&gt; ['</span>PRIVATE<span class="string">','</span>SECRET<span class="string">']&#125;</span></span><br><span class="line"><span class="string">For experts, there is an additional option -- CACHE_BLOCKS -- which</span></span><br><span class="line"><span class="string">switches block caching for the scanner on (true) or off (false).  By</span></span><br><span class="line"><span class="string">default it is enabled.  Examples:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">hbase&gt; scan '</span>t1<span class="string">', &#123;COLUMNS =&gt; ['</span>c1<span class="string">', '</span>c2<span class="string">'], CACHE_BLOCKS =&gt; false&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="8-æŸ¥è¯¢-row"><a class="markdownIt-Anchor" href="#8-æŸ¥è¯¢-row"></a> 8. æŸ¥è¯¢ row</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">get <span class="string">'table1'</span>, <span class="string">'row1'</span></span><br><span class="line">get <span class="string">'table1'</span>, <span class="string">'row1'</span>, <span class="string">'columnFamliy1'</span></span><br><span class="line">get <span class="string">'table1'</span>, <span class="string">'row1'</span>, <span class="string">'columnFamliy1:a'</span></span><br></pre></td></tr></table></figure>
<h2 id="9-ç¦ç”¨-å¯ç”¨è¡¨"><a class="markdownIt-Anchor" href="#9-ç¦ç”¨-å¯ç”¨è¡¨"></a> 9. ç¦ç”¨ã€å¯ç”¨è¡¨</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hbase(main):008:0&gt; <span class="built_in">disable</span> <span class="string">'test'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 1.1820 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):009:0&gt; <span class="built_in">enable</span> <span class="string">'test'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.1770 seconds</span><br></pre></td></tr></table></figure>
<h2 id="10-åˆ é™¤è¡¨"><a class="markdownIt-Anchor" href="#10-åˆ é™¤è¡¨"></a> 10. åˆ é™¤è¡¨</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hbase(main):011:0&gt; drop <span class="string">'test'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.1370 seconds</span><br></pre></td></tr></table></figure>
<h2 id="11-åœæ­¢-hbase"><a class="markdownIt-Anchor" href="#11-åœæ­¢-hbase"></a> 11. åœæ­¢ HBase</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./bin/stop-hbase.sh</span><br><span class="line">stopping hbase....................</span><br><span class="line">$</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>HBase ç»´æŠ¤</title>
    <url>/blog/bigdata/hbase/hbase-ops/</url>
    <content><![CDATA[<h1 id="hbase-ç»´æŠ¤"><a class="markdownIt-Anchor" href="#hbase-ç»´æŠ¤"></a> HBase ç»´æŠ¤</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">é…ç½®æ–‡ä»¶</a></li>
<li><a href="#%E7%8E%AF%E5%A2%83%E8%A6%81%E6%B1%82">ç¯å¢ƒè¦æ±‚</a></li>
<li><a href="#%E5%BC%95%E7%94%A8%E5%92%8C%E5%BC%95%E7%94%B3">å¼•ç”¨å’Œå¼•ç”³</a>
<ul>
<li><a href="#%E5%BC%95%E7%94%B3">å¼•ç”³</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="é…ç½®æ–‡ä»¶"><a class="markdownIt-Anchor" href="#é…ç½®æ–‡ä»¶"></a> é…ç½®æ–‡ä»¶</h2>
<ul>
<li><code>backup-masters</code> - é»˜è®¤æƒ…å†µä¸‹ä¸å­˜åœ¨ã€‚åˆ—å‡ºä¸»æœåŠ¡å™¨åº”åœ¨å…¶ä¸Šå¯åŠ¨å¤‡ä»½ä¸»è¿›ç¨‹çš„ä¸»æœºï¼Œæ¯è¡Œä¸€ä¸ªä¸»æœºã€‚</li>
<li><code>hadoop-metrics2-hbase.properties</code> - ç”¨äºè¿æ¥ HBase Hadoop çš„ Metrics2 æ¡†æ¶ã€‚</li>
<li><code>hbase-env.cmd</code> and <a href="http://hbase-env.sh" target="_blank" rel="noopener">hbase-env.sh</a> - ç”¨äº Windows å’Œ Linux / Unix ç¯å¢ƒçš„è„šæœ¬ï¼Œç”¨äºè®¾ç½® HBase çš„å·¥ä½œç¯å¢ƒï¼ŒåŒ…æ‹¬ Javaï¼ŒJava é€‰é¡¹å’Œå…¶ä»–ç¯å¢ƒå˜é‡çš„ä½ç½®ã€‚</li>
<li><code>hbase-policy.xml</code> - RPC æœåŠ¡å™¨ç”¨äºå¯¹å®¢æˆ·ç«¯è¯·æ±‚è¿›è¡Œæˆæƒå†³ç­–çš„é»˜è®¤ç­–ç•¥é…ç½®æ–‡ä»¶ã€‚ä»…åœ¨å¯ç”¨ HBase å®‰å…¨æ€§æ—¶ä½¿ç”¨ã€‚</li>
<li><code>hbase-site.xml</code> - ä¸»è¦çš„ HBase é…ç½®æ–‡ä»¶ã€‚æ­¤æ–‡ä»¶æŒ‡å®šè¦†ç›– HBase é»˜è®¤é…ç½®çš„é…ç½®é€‰é¡¹ã€‚æ‚¨å¯ä»¥åœ¨ docs / hbase-default.xml ä¸­æŸ¥çœ‹ï¼ˆä½†ä¸è¦ç¼–è¾‘ï¼‰é»˜è®¤é…ç½®æ–‡ä»¶ã€‚æ‚¨è¿˜å¯ä»¥åœ¨ HBase Web UI çš„ HBase é…ç½®é€‰é¡¹å¡ä¸­æŸ¥çœ‹ç¾¤é›†çš„æ•´ä¸ªæœ‰æ•ˆé…ç½®ï¼ˆé»˜è®¤å€¼å’Œè¦†ç›–ï¼‰ã€‚</li>
<li><code>log4j.properties</code> - log4j æ—¥å¿—é…ç½®ã€‚</li>
<li><code>regionservers</code> - åŒ…å«åº”åœ¨ HBase é›†ç¾¤ä¸­è¿è¡Œ RegionServer çš„ä¸»æœºåˆ—è¡¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤æ–‡ä»¶åŒ…å«å•ä¸ªæ¡ç›® localhostã€‚å®ƒåº”åŒ…å«ä¸»æœºåæˆ– IP åœ°å€åˆ—è¡¨ï¼Œæ¯è¡Œä¸€ä¸ªï¼Œå¹¶ä¸”å¦‚æœç¾¤é›†ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å°†åœ¨å…¶ localhost æ¥å£ä¸Šè¿è¡Œ RegionServerï¼Œåˆ™åº”ä»…åŒ…å« localhostã€‚</li>
</ul>
<h2 id="ç¯å¢ƒè¦æ±‚"><a class="markdownIt-Anchor" href="#ç¯å¢ƒè¦æ±‚"></a> ç¯å¢ƒè¦æ±‚</h2>
<ul>
<li>Java
<ul>
<li>HBase 2.0+ è¦æ±‚ JDK8+</li>
<li>HBase 1.2+ è¦æ±‚ JDK7+</li>
</ul>
</li>
<li>SSH - ç¯å¢ƒè¦æ”¯æŒ SSH</li>
<li>DNS - ç¯å¢ƒä¸­è¦åœ¨ hosts é…ç½®æœ¬æœº hostname å’Œæœ¬æœº IP</li>
<li>NTP - HBase é›†ç¾¤çš„æ—¶é—´è¦åŒæ­¥ï¼Œå¯ä»¥é…ç½®ç»Ÿä¸€çš„ NTP</li>
<li>å¹³å° - ç”Ÿäº§ç¯å¢ƒä¸æ¨èéƒ¨ç½²åœ¨ Windows ç³»ç»Ÿä¸­</li>
<li>Hadoop - ä¾èµ– Hadoop é…å¥—ç‰ˆæœ¬</li>
<li>Zookeeper - ä¾èµ– Zookeeper é…å¥—ç‰ˆæœ¬</li>
</ul>
<h2 id="è¿è¡Œæ¨¡å¼"><a class="markdownIt-Anchor" href="#è¿è¡Œæ¨¡å¼"></a> è¿è¡Œæ¨¡å¼</h2>
<h3 id="å•ç‚¹"><a class="markdownIt-Anchor" href="#å•ç‚¹"></a> å•ç‚¹</h3>
<p>hbase-site.xml é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://namenode.example.org:8020/hbase<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.cluster.distributed<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ†å¸ƒå¼"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼"></a> åˆ†å¸ƒå¼</h3>
<p>hbase-site.xm é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://namenode.example.org:8020/hbase<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.cluster.distributed<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>node-a.example.com,node-b.example.com,node-c.example.com<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="å¼•ç”¨å’Œå¼•ç”³"><a class="markdownIt-Anchor" href="#å¼•ç”¨å’Œå¼•ç”³"></a> å¼•ç”¨å’Œå¼•ç”³</h2>
<h3 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h3>
<ul>
<li><a href="http://hbase.apache.org/book.html#configuration" target="_blank" rel="noopener">Apache HBase Configuration</a></li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œä¹‹ç‰©ç†å±‚</title>
    <url>/blog/communication/network-physical/</url>
    <content><![CDATA[<blockquote>
<p><strong>æ‘˜è¦</strong></p>
<p><strong>ç‰©ç†å±‚ï¼ˆPhysical Layerï¼‰</strong> - ç‰©ç†å±‚åªæ¥æ”¶å’Œå‘é€ä¸€ä¸²æ¯”ç‰¹(bit)æµï¼Œä¸è€ƒè™‘ä¿¡æ¯çš„æ„ä¹‰å’Œä¿¡æ¯ç»“æ„ã€‚</p>
<ul>
<li>æ•°æ®å•å…ƒï¼šæ¯”ç‰¹æµã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šå…‰çº¤ã€åŒè½´ç”µç¼†ã€åŒç»çº¿ã€ä¸­ç»§å™¨å’Œé›†çº¿å™¨ã€‚</li>
</ul>
</blockquote>
<h2 id="é€šä¿¡ç³»ç»Ÿæ¨¡å‹"><a class="markdownIt-Anchor" href="#é€šä¿¡ç³»ç»Ÿæ¨¡å‹"></a> é€šä¿¡ç³»ç»Ÿæ¨¡å‹</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/physical/æ•°æ®é€šä¿¡ç³»ç»Ÿçš„æ¨¡å‹.png!zp"/></div>
<p>é€šä¿¡ç³»ç»Ÿæ¨¡å‹åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼šæºç³»ç»Ÿï¼ˆåŒ…æ‹¬ä¿¡æºå’Œå‘é€å™¨ï¼‰ã€ä¼ è¾“ç³»ç»Ÿã€ç›®çš„ç³»ç»Ÿï¼ˆåŒ…æ‹¬ä¿¡å®¿æ¥æ”¶å™¨ï¼‰ã€‚</p>
<p>é‡è¦æ¦‚å¿µï¼š</p>
<ul>
<li><strong>ä¿¡æº</strong> - ä¹Ÿå«æºç‚¹ã€‚äº§ç”Ÿå„ç±»ä¿¡æ¯çš„å®ä½“ã€‚</li>
<li><strong>ä¿¡é“</strong> - é€šä¿¡çš„é€šé“ï¼Œæ˜¯ä¿¡å·ä¼ è¾“çš„åª’ä»‹ã€‚</li>
<li><strong>ä¿¡å®¿</strong> - ä¼ è¾“ä¿¡æ¯çš„å½’å®¿ã€‚</li>
<li><strong>ç å…ƒ</strong> - åœ¨æ•°å­—é€šä¿¡ä¸­å¸¸å¸¸ç”¨æ—¶é—´é—´éš”ç›¸åŒçš„ç¬¦å·æ¥è¡¨ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ•°å­—ï¼Œè¿™æ ·çš„æ—¶é—´é—´éš”å†…çš„ä¿¡å·ç§°ä¸º(äºŒè¿›åˆ¶ï¼‰ç å…ƒã€‚</li>
</ul>
<h2 id="é€šä¿¡æ–¹å¼"><a class="markdownIt-Anchor" href="#é€šä¿¡æ–¹å¼"></a> é€šä¿¡æ–¹å¼</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/physical/é€šä¿¡æ–¹å¼.jpg!zp"/></div>
<p>æœ‰ä¸‰ç§é€šä¿¡æ–¹å¼ï¼š</p>
<ul>
<li>å•å·¥é€šä¿¡ï¼šå•å‘ä¼ è¾“</li>
<li>åŠåŒå·¥é€šä¿¡ï¼šåŒå‘äº¤æ›¿ä¼ è¾“</li>
<li>å…¨åŒå·¥é€šä¿¡ï¼šåŒå‘åŒæ—¶ä¼ è¾“</li>
</ul>
<h2 id="é€šä¿¡ä¿¡å·"><a class="markdownIt-Anchor" href="#é€šä¿¡ä¿¡å·"></a> é€šä¿¡ä¿¡å·</h2>
<p>é€šä¿¡çš„ç›®çš„æ˜¯ä¼ é€æ¶ˆæ¯ã€‚å¦‚è¯­éŸ³ã€æ–‡å­—ã€å›¾åƒã€è§†é¢‘éƒ½æ˜¯æ¶ˆæ¯ã€‚æ•°æ®æ—¶ä¼ é€æ¶ˆæ¯çš„å®ä½“ã€‚ä¿¡å·æ˜¯æ•°æ®çš„ç”µæ°”æˆ–ç”µç£çš„è¡¨ç°ã€‚</p>
<p>æ¨¡æ‹Ÿä¿¡å·å’Œæ•°å­—ä¿¡å·</p>
<ul>
<li><strong>æ¨¡æ‹Ÿä¿¡å·</strong> - æ¨¡æ‹Ÿä¿¡å·æ˜¯è¿ç»­çš„ä¿¡å·ã€‚</li>
<li><strong>æ•°å­—ä¿¡å·</strong> - æ•°å­—ä¿¡å·æ˜¯ç¦»æ•£çš„ä¿¡å·ã€‚</li>
</ul>
<h2 id="è°ƒåˆ¶è§£è°ƒ"><a class="markdownIt-Anchor" href="#è°ƒåˆ¶è§£è°ƒ"></a> è°ƒåˆ¶è§£è°ƒ</h2>
<p>é‡è¦æ¦‚å¿µï¼š</p>
<ul>
<li><strong>åŸºå¸¦ä¿¡å·</strong> - æ¥è‡ªä¿¡æºçš„ä¿¡å·å«åšåŸºå¸¦ä¿¡å·ã€‚</li>
<li><strong>è°ƒåˆ¶</strong> - å°†å„ç§æ•°å­—åŸºå¸¦ä¿¡å·è½¬æ¢æˆé€‚äºä¿¡é“ä¼ è¾“çš„æ•°å­—è°ƒåˆ¶ä¿¡å·(å·²è°ƒä¿¡å·æˆ–é¢‘å¸¦ä¿¡å·)ã€‚ç®€å•æ¥è¯´ï¼šè°ƒåˆ¶å³ï¼Œæ•°å­— -&gt; æ¨¡æ‹Ÿã€‚</li>
<li><strong>è§£è°ƒ</strong> - åœ¨æ¥æ”¶ç«¯å°†æ”¶åˆ°çš„æ•°å­—é¢‘å¸¦ä¿¡å·è¿˜åŸæˆæ•°å­—åŸºå¸¦ä¿¡å·ã€‚ç®€å•æ¥è¯´ï¼šè§£è°ƒå³ï¼Œæ¨¡æ‹Ÿ -&gt; æ•°å­—ã€‚</li>
</ul>
<blockquote>
<p>ğŸ“Œ æç¤ºï¼šæˆ‘ä»¬ä¸Šç½‘æ—¶æ‰€ç”¨åˆ°çš„è°ƒåˆ¶è§£è°ƒå™¨ï¼ˆä¿—ç§°â€œçŒ«â€ï¼‰ï¼ŒæŒ‡çš„å°±æ˜¯è½¬æ¢æ•°å­—å’Œæ¨¡æ‹Ÿä¿¡å·çš„æœºå™¨ã€‚</p>
</blockquote>
<p>ä¿¡å·è¦åœ¨ä¿¡é“ä¸Šä¼ è¾“å°±è¦ç»è¿‡è°ƒåˆ¶ã€‚</p>
<p>è°ƒåˆ¶åˆ†ä¸ºï¼šåŸºå¸¦è°ƒåˆ¶å’Œå¸¦é€šè°ƒåˆ¶</p>
<h3 id="åŸºæœ¬å¸¦é€šè°ƒåˆ¶æ–¹æ³•"><a class="markdownIt-Anchor" href="#åŸºæœ¬å¸¦é€šè°ƒåˆ¶æ–¹æ³•"></a> åŸºæœ¬å¸¦é€šè°ƒåˆ¶æ–¹æ³•</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/physical/åŸºæœ¬è°ƒåˆ¶æ–¹æ³•.png!zp"/></div>
<p>å¦‚æœä½ æ”¶å¬è¿‡å¹¿æ’­ï¼Œä¸€å®šç»å¸¸å¬åˆ° AMã€FM è¿™ä¸¤ä¸ªå…³é”®è¯ï¼Œè¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿç­”æ¡ˆå¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>è°ƒå¹…ï¼ˆAMï¼‰</strong> - å³è½½æ³¢çš„<strong>æŒ¯å¹…</strong>éšåŸºå¸¦æ•°å­—ä¿¡å·è€Œå˜åŒ–ã€‚</li>
<li><strong>è°ƒé¢‘ï¼ˆFMï¼‰</strong> - å³è½½æ³¢çš„<strong>é¢‘ç‡</strong>éšåŸºå¸¦æ•°å­—ä¿¡å·è€Œå˜åŒ–ã€‚</li>
<li><strong>è°ƒç›¸ï¼ˆPMï¼‰</strong> - å³è½½æ³¢çš„<strong>åˆå§‹ç›¸ä½</strong>éšåŸºå¸¦æ•°å­—ä¿¡å·è€Œå˜åŒ–ã€‚</li>
</ul>
<blockquote>
<p>ğŸ“Œ æç¤ºï¼šæˆ‘ä»¬æ”¶å¬å¹¿æ’­æ—¶ï¼Œä¸ºäº†æ¥æ”¶ä¸åŒå¹¿æ’­å°çš„ä¿¡å·ï¼Œå°±è¦è°ƒæ•´ AM æˆ– FMï¼ŒæŒ‡çš„å°±æ˜¯è¿™é‡Œçš„è°ƒåˆ¶æ–¹æ³•ã€‚</p>
</blockquote>
<h2 id="é€šä¿¡åª’ä»‹"><a class="markdownIt-Anchor" href="#é€šä¿¡åª’ä»‹"></a> é€šä¿¡åª’ä»‹</h2>
<p>é€šä¿¡åª’ä»‹åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p>
<ul>
<li>å¯¼å¼•å‹ - åŒç»çº¿ã€ç”µç¼†ã€å…‰çº¤</li>
<li>éå¯¼å¼•å‹ - æ— çº¿ã€çº¢å¤–çº¿ã€å¤§æ°”ã€æ¿€å…‰</li>
</ul>
<h2 id="ä¿¡é“å¤ç”¨"><a class="markdownIt-Anchor" href="#ä¿¡é“å¤ç”¨"></a> ä¿¡é“å¤ç”¨</h2>
<p>ä¿¡é“å¤ç”¨å°±æ˜¯å°†ç”¨äºä¼ è¾“ä¿¡é“çš„æ€»å¸¦å®½åˆ’åˆ†æˆè‹¥å¹²ä¸ªå­é¢‘å¸¦ï¼ˆæˆ–ç§°å­ä¿¡é“ï¼‰ï¼Œæ¯ä¸€ä¸ªå­ä¿¡é“ä¼ è¾“ä¸€è·¯ä¿¡å·ã€‚</p>
<ul>
<li>é¢‘åˆ†å¤ç”¨</li>
<li>æ—¶åˆ†å¤ç”¨</li>
<li>æ³¢åˆ†å¤ç”¨</li>
<li>ç åˆ†å¤ç”¨</li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œä¹‹ç½‘ç»œå±‚</title>
    <url>/blog/communication/network-network/</url>
    <content><![CDATA[<blockquote>
<p><strong>ç½‘ç»œå±‚ï¼ˆnetwork layerï¼‰</strong> - ä¸ºåˆ†ç»„äº¤æ¢ç½‘ä¸Šçš„ä¸åŒä¸»æœºæä¾›é€šä¿¡æœåŠ¡ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„æˆ–åŒ…è¿›è¡Œä¼ é€ã€‚</p>
<ul>
<li>ä¸»è¦åè®®ï¼š<code>IP</code>ã€<code>ICMP</code>ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šIP æ•°æ®æŠ¥ï¼ˆpacketï¼‰ã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šç½‘å…³ã€è·¯ç”±å™¨ã€‚</li>
</ul>
</blockquote>
<h2 id="æ¦‚è¿°"><a class="markdownIt-Anchor" href="#æ¦‚è¿°"></a> æ¦‚è¿°</h2>
<p>ç½‘ç»œå±‚å‘ä¸Šåªæä¾›ç®€å•çµæ´»çš„ã€æ— è¿æ¥çš„ã€å°½æœ€å¤§åŠªåŠ›äº¤ä»˜çš„æ•°æ®æŠ¥æœåŠ¡ã€‚ç½‘ç»œå±‚ä¸æä¾›æœåŠ¡è´¨é‡çš„æ‰¿è¯ºï¼Œä¸ä¿è¯åˆ†ç»„äº¤ä»˜çš„æ—¶é™ï¼Œæ‰€ä¼ é€çš„åˆ†ç»„å¯èƒ½å‡ºé”™ã€ä¸¢å¤±ã€é‡å¤å’Œå¤±åºã€‚è¿›ç¨‹é—´é€šä¿¡çš„å¯é æ€§ç”±è¿è¾“å±‚è´Ÿè´£ã€‚</p>
<h2 id="ip-åè®®"><a class="markdownIt-Anchor" href="#ip-åè®®"></a> IP åè®®</h2>
<p>ç½‘é™…åè®® IP (Internet Protocol) å®šä¹‰äº†ä¸‰ç§åŠŸèƒ½ï¼š</p>
<ol>
<li>IP å®šä¹‰äº†åœ¨ TCP/IP äº’è”ç½‘ä¸Šæ•°æ®ä¼ é€çš„åŸºæœ¬å•å…ƒå’Œæ•°æ®æ ¼å¼ã€‚</li>
<li>IP è½¯ä»¶å®Œæˆè·¯ç”±é€‰æ‹©åŠŸèƒ½ï¼Œé€‰æ‹©æ•°æ®ä¼ é€çš„è·¯å¾„ã€‚</li>
<li>IP åŒ…å«äº†ä¸€ç»„ä¸å¯é åˆ†ç»„ä¼ é€çš„è§„åˆ™ï¼ŒæŒ‡æ˜äº†åˆ†ç»„å¤„ç†ã€å·®é”™ä¿¡æ¯å‘ç”Ÿä»¥åŠåˆ†ç»„çš„è§„åˆ™ã€‚</li>
</ol>
<h3 id="ç›¸å…³åè®®"><a class="markdownIt-Anchor" href="#ç›¸å…³åè®®"></a> ç›¸å…³åè®®</h3>
<p>ä¸ IP åè®®é…å¥—ä½¿ç”¨çš„è¿˜æœ‰ä¸‰ä¸ªåè®®ï¼š</p>
<ul>
<li>åœ°å€è§£æåè®® ARPï¼ˆAddress Resolution Protocolï¼‰</li>
<li>ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®® ICMPï¼ˆInternet Control Message Protocolï¼‰</li>
<li>ç½‘é™…ç»„ç®¡ç†åè®® IGMPï¼ˆInternet Group Management Protocolï¼‰</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1550912617336.png!zp"/></div>
<h3 id="åˆ†ç±»çš„-ip-åœ°å€"><a class="markdownIt-Anchor" href="#åˆ†ç±»çš„-ip-åœ°å€"></a> åˆ†ç±»çš„ IP åœ°å€</h3>
<p>IP åœ°å€çš„ç¼–å€æ–¹å¼ç»å†äº†ä¸‰ä¸ªå†å²é˜¶æ®µï¼š</p>
<ul>
<li>åˆ†ç±»</li>
<li>å­ç½‘åˆ’åˆ†</li>
<li>æ— åˆ†ç±»</li>
</ul>
<h4 id="1-åˆ†ç±»"><a class="markdownIt-Anchor" href="#1-åˆ†ç±»"></a> 1. åˆ†ç±»</h4>
<p>ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç½‘ç»œå·å’Œä¸»æœºå·ï¼Œå…¶ä¸­ä¸åŒåˆ†ç±»å…·æœ‰ä¸åŒçš„ç½‘ç»œå·é•¿åº¦ï¼Œå¹¶ä¸”æ˜¯å›ºå®šçš„ã€‚</p>
<figure class="highlight bnf"><table><tr><td class="code"><pre><span class="line">IP åœ°å€ ::= &#123;&lt; ç½‘ç»œå· &gt;, &lt; ä¸»æœºå· &gt;&#125;</span><br></pre></td></tr></table></figure>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086738403.png!zp"/></div>
<h4 id="2-å­ç½‘åˆ’åˆ†"><a class="markdownIt-Anchor" href="#2-å­ç½‘åˆ’åˆ†"></a> 2. å­ç½‘åˆ’åˆ†</h4>
<p>é€šè¿‡åœ¨ä¸»æœºå·å­—æ®µä¸­æ‹¿ä¸€éƒ¨åˆ†ä½œä¸ºå­ç½‘å·ï¼ŒæŠŠä¸¤çº§ IP åœ°å€åˆ’åˆ†ä¸ºä¸‰çº§ IP åœ°å€ã€‚</p>
<figure class="highlight bnf"><table><tr><td class="code"><pre><span class="line">IP åœ°å€ ::= &#123;&lt; ç½‘ç»œå· &gt;, &lt; å­ç½‘å· &gt;, &lt; ä¸»æœºå· &gt;&#125;</span><br></pre></td></tr></table></figure>
<p>è¦ä½¿ç”¨å­ç½‘ï¼Œå¿…é¡»é…ç½®å­ç½‘æ©ç ã€‚ä¸€ä¸ª B ç±»åœ°å€çš„é»˜è®¤å­ç½‘æ©ç ä¸º 255.255.0.0ï¼Œå¦‚æœ B ç±»åœ°å€çš„å­ç½‘å ä¸¤ä¸ªæ¯”ç‰¹ï¼Œé‚£ä¹ˆå­ç½‘æ©ç ä¸º 11111111 11111111 11000000 00000000ï¼Œä¹Ÿå°±æ˜¯ 255.255.192.0ã€‚</p>
<p>æ³¨æ„ï¼Œå¤–éƒ¨ç½‘ç»œçœ‹ä¸åˆ°å­ç½‘çš„å­˜åœ¨ã€‚</p>
<h4 id="3-æ— åˆ†ç±»"><a class="markdownIt-Anchor" href="#3-æ— åˆ†ç±»"></a> 3. æ— åˆ†ç±»</h4>
<p>æ— åˆ†ç±»ç¼–å€ CIDR æ¶ˆé™¤äº†ä¼ ç»Ÿ A ç±»ã€B ç±»å’Œ C ç±»åœ°å€ä»¥åŠåˆ’åˆ†å­ç½‘çš„æ¦‚å¿µï¼Œä½¿ç”¨ç½‘ç»œå‰ç¼€å’Œä¸»æœºå·æ¥å¯¹ IP åœ°å€è¿›è¡Œç¼–ç ï¼Œç½‘ç»œå‰ç¼€çš„é•¿åº¦å¯ä»¥æ ¹æ®éœ€è¦å˜åŒ–ã€‚</p>
<figure class="highlight bnf"><table><tr><td class="code"><pre><span class="line">IP åœ°å€ ::= &#123;&lt; ç½‘ç»œå‰ç¼€å· &gt;, &lt; ä¸»æœºå· &gt;&#125;</span><br></pre></td></tr></table></figure>
<p>CIDR çš„è®°æ³•ä¸Šé‡‡ç”¨åœ¨ IP åœ°å€åé¢åŠ ä¸Šç½‘ç»œå‰ç¼€é•¿åº¦çš„æ–¹æ³•ï¼Œä¾‹å¦‚ 128.14.35.7/20 è¡¨ç¤ºå‰ 20 ä½ä¸ºç½‘ç»œå‰ç¼€ã€‚</p>
<p>CIDR çš„åœ°å€æ©ç å¯ä»¥ç»§ç»­ç§°ä¸ºå­ç½‘æ©ç ï¼Œå­ç½‘æ©ç é¦– 1 é•¿åº¦ä¸ºç½‘ç»œå‰ç¼€çš„é•¿åº¦ã€‚</p>
<p>ä¸€ä¸ª CIDR åœ°å€å—ä¸­æœ‰å¾ˆå¤šåœ°å€ï¼Œä¸€ä¸ª CIDR è¡¨ç¤ºçš„ç½‘ç»œå°±å¯ä»¥è¡¨ç¤ºåŸæ¥çš„å¾ˆå¤šä¸ªç½‘ç»œï¼Œå¹¶ä¸”åœ¨è·¯ç”±è¡¨ä¸­åªéœ€è¦ä¸€ä¸ªè·¯ç”±å°±å¯ä»¥ä»£æ›¿åŸæ¥çš„å¤šä¸ªè·¯ç”±ï¼Œå‡å°‘äº†è·¯ç”±è¡¨é¡¹çš„æ•°é‡ã€‚æŠŠè¿™ç§é€šè¿‡ä½¿ç”¨ç½‘ç»œå‰ç¼€æ¥å‡å°‘è·¯ç”±è¡¨é¡¹çš„æ–¹å¼ç§°ä¸ºè·¯ç”±èšåˆï¼Œä¹Ÿç§°ä¸º <strong>æ„æˆè¶…ç½‘</strong> ã€‚</p>
<p>åœ¨è·¯ç”±è¡¨ä¸­çš„é¡¹ç›®ç”±â€œç½‘ç»œå‰ç¼€â€å’Œâ€œä¸‹ä¸€è·³åœ°å€â€ç»„æˆï¼Œåœ¨æŸ¥æ‰¾æ—¶å¯èƒ½ä¼šå¾—åˆ°ä¸æ­¢ä¸€ä¸ªåŒ¹é…ç»“æœï¼Œåº”å½“é‡‡ç”¨æœ€é•¿å‰ç¼€åŒ¹é…æ¥ç¡®å®šåº”è¯¥åŒ¹é…å“ªä¸€ä¸ªã€‚</p>
<h3 id="ip-åœ°å€ä¸ç‰©ç†åœ°å€"><a class="markdownIt-Anchor" href="#ip-åœ°å€ä¸ç‰©ç†åœ°å€"></a> IP åœ°å€ä¸ç‰©ç†åœ°å€</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551088476626.png!zp"/></div>
<ul>
<li>ç‰©ç†åœ°å€æ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€ã€‚</li>
<li>IP åœ°å€æ˜¯ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„åœ°å€ï¼Œæ˜¯ä¸€ç§é€»è¾‘åœ°å€ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551088631948.png!zp"/></div>
<h3 id="ip-æ•°æ®æŠ¥æ ¼å¼"><a class="markdownIt-Anchor" href="#ip-æ•°æ®æŠ¥æ ¼å¼"></a> IP æ•°æ®æŠ¥æ ¼å¼</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1550913213250.png!zp"/></div>
<ul>
<li><strong>ç‰ˆæœ¬</strong> - æœ‰ 4ï¼ˆIPv4ï¼‰å’Œ 6ï¼ˆIPv6ï¼‰ä¸¤ä¸ªå€¼ã€‚</li>
<li><strong>é¦–éƒ¨é•¿åº¦</strong> - å  4 ä½ï¼Œå› æ­¤æœ€å¤§åè¿›åˆ¶æ•°å€¼ä¸º 15ã€‚å€¼ä¸º 1 è¡¨ç¤ºçš„æ˜¯ 1 ä¸ª 32 ä½å­—çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯ 4 å­—èŠ‚ã€‚å› ä¸ºé¦–éƒ¨å›ºå®šé•¿åº¦ä¸º 20 å­—èŠ‚ï¼Œå› æ­¤è¯¥å€¼æœ€å°ä¸º 5ã€‚å¦‚æœå¯é€‰å­—æ®µçš„é•¿åº¦ä¸æ˜¯ 4 å­—èŠ‚çš„æ•´æ•°å€ï¼Œå°±ç”¨å°¾éƒ¨çš„å¡«å……éƒ¨åˆ†æ¥å¡«å……ã€‚</li>
<li><strong>åŒºåˆ†æœåŠ¡</strong> - ç”¨æ¥è·å¾—æ›´å¥½çš„æœåŠ¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸ä½¿ç”¨ã€‚</li>
<li><strong>æ€»é•¿åº¦</strong> - åŒ…æ‹¬é¦–éƒ¨é•¿åº¦å’Œæ•°æ®éƒ¨åˆ†é•¿åº¦ã€‚å  16 ä½ï¼Œå› æ­¤æ•°æ®æŠ¥çš„æœ€å¤§é•¿åº¦ä¸º 2 <sup>16</sup> - 1 = 65535 å­—èŠ‚ã€‚</li>
<li><strong>ç”Ÿå­˜æ—¶é—´</strong> - TTLï¼Œå®ƒçš„å­˜åœ¨æ˜¯ä¸ºäº†é˜²æ­¢æ— æ³•äº¤ä»˜çš„æ•°æ®æŠ¥åœ¨äº’è”ç½‘ä¸­ä¸æ–­å…œåœˆå­ã€‚ä»¥è·¯ç”±å™¨è·³æ•°ä¸ºå•ä½ï¼Œå½“ TTL ä¸º 0 æ—¶å°±ä¸¢å¼ƒæ•°æ®æŠ¥ã€‚</li>
<li><strong>åè®®</strong> - æŒ‡å‡ºæºå¸¦çš„æ•°æ®åº”è¯¥ä¸Šäº¤ç»™å“ªä¸ªåè®®è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚ ICMPã€TCPã€UDP ç­‰ã€‚</li>
<li><strong>é¦–éƒ¨æ£€éªŒå’Œ</strong> - å› ä¸ºæ•°æ®æŠ¥æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨ï¼Œéƒ½è¦é‡æ–°è®¡ç®—æ£€éªŒå’Œï¼Œå› æ­¤æ£€éªŒå’Œä¸åŒ…å«æ•°æ®éƒ¨åˆ†å¯ä»¥å‡å°‘è®¡ç®—çš„å·¥ä½œé‡ã€‚</li>
<li><strong>æ ‡è¯†</strong> - åœ¨æ•°æ®æŠ¥é•¿åº¦è¿‡é•¿ä»è€Œå‘ç”Ÿåˆ†ç‰‡çš„æƒ…å†µä¸‹ï¼Œç›¸åŒæ•°æ®æŠ¥çš„ä¸åŒåˆ†ç‰‡å…·æœ‰ç›¸åŒçš„æ ‡è¯†ç¬¦ã€‚</li>
<li><strong>ç‰‡åç§»</strong> - å’Œæ ‡è¯†ç¬¦ä¸€èµ·ï¼Œç”¨äºå‘ç”Ÿåˆ†ç‰‡çš„æƒ…å†µã€‚ç‰‡åç§»çš„å•ä½ä¸º 8 å­—èŠ‚ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1550913364479.png!zp"/></div>
<h2 id="åœ°å€è§£æåè®®-arp"><a class="markdownIt-Anchor" href="#åœ°å€è§£æåè®®-arp"></a> åœ°å€è§£æåè®® ARP</h2>
<p>ç½‘ç»œå±‚å®ç°ä¸»æœºä¹‹é—´çš„é€šä¿¡ï¼Œè€Œé“¾è·¯å±‚å®ç°å…·ä½“æ¯æ®µé“¾è·¯ä¹‹é—´çš„é€šä¿¡ã€‚å› æ­¤åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼ŒIP æ•°æ®æŠ¥çš„æºåœ°å€å’Œç›®çš„åœ°å€å§‹ç»ˆä¸å˜ï¼Œè€Œ MAC åœ°å€éšç€é“¾è·¯çš„æ”¹å˜è€Œæ”¹å˜ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086787261.png!zp"/></div>
<p>ARP å®ç°ç”± IP åœ°å€å¾—åˆ° MAC åœ°å€ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086769846.png!zp"/></div>
<p>æ¯ä¸ªä¸»æœºéƒ½æœ‰ä¸€ä¸ª ARP é«˜é€Ÿç¼“å­˜ï¼Œé‡Œé¢æœ‰æœ¬å±€åŸŸç½‘ä¸Šçš„å„ä¸»æœºå’Œè·¯ç”±å™¨çš„ IP åœ°å€åˆ° MAC åœ°å€çš„æ˜ å°„è¡¨ã€‚</p>
<p>å¦‚æœä¸»æœº A çŸ¥é“ä¸»æœº B çš„ IP åœ°å€ï¼Œä½†æ˜¯ ARP é«˜é€Ÿç¼“å­˜ä¸­æ²¡æœ‰è¯¥ IP åœ°å€åˆ° MAC åœ°å€çš„æ˜ å°„ï¼Œæ­¤æ—¶ä¸»æœº A é€šè¿‡å¹¿æ’­çš„æ–¹å¼å‘é€ ARP è¯·æ±‚åˆ†ç»„ï¼Œä¸»æœº B æ”¶åˆ°è¯¥è¯·æ±‚åä¼šå‘é€ ARP å“åº”åˆ†ç»„ç»™ä¸»æœº A å‘ŠçŸ¥å…¶ MAC åœ°å€ï¼Œéšåä¸»æœº A å‘å…¶é«˜é€Ÿç¼“å­˜ä¸­å†™å…¥ä¸»æœº B çš„ IP åœ°å€åˆ° MAC åœ°å€çš„æ˜ å°„ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086833117.png!zp"/></div>
<h2 id="ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®-icmp"><a class="markdownIt-Anchor" href="#ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®-icmp"></a> ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®® ICMP</h2>
<p>ICMP æ˜¯ä¸ºäº†æ›´æœ‰æ•ˆåœ°è½¬å‘ IP æ•°æ®æŠ¥å’Œæé«˜äº¤ä»˜æˆåŠŸçš„æœºä¼šã€‚å®ƒå°è£…åœ¨ IP æ•°æ®æŠ¥ä¸­ï¼Œä½†æ˜¯ä¸å±äºé«˜å±‚åè®®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086857345.png!zp"/></div>
<p>ICMP æŠ¥æ–‡åˆ†ä¸ºå·®é”™æŠ¥å‘ŠæŠ¥æ–‡å’Œè¯¢é—®æŠ¥æ–‡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086870897.png!zp"/></div>
<h3 id="1-ping"><a class="markdownIt-Anchor" href="#1-ping"></a> 1. Ping</h3>
<p>Ping æ˜¯ ICMP çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œä¸»è¦ç”¨æ¥æµ‹è¯•ä¸¤å°ä¸»æœºä¹‹é—´çš„è¿é€šæ€§ã€‚</p>
<p>Ping çš„åŸç†æ˜¯é€šè¿‡å‘ç›®çš„ä¸»æœºå‘é€ ICMP Echo è¯·æ±‚æŠ¥æ–‡ï¼Œç›®çš„ä¸»æœºæ”¶åˆ°ä¹‹åä¼šå‘é€ Echo å›ç­”æŠ¥æ–‡ã€‚Ping ä¼šæ ¹æ®æ—¶é—´å’ŒæˆåŠŸå“åº”çš„æ¬¡æ•°ä¼°ç®—å‡ºæ•°æ®åŒ…å¾€è¿”æ—¶é—´ä»¥åŠä¸¢åŒ…ç‡ã€‚</p>
<h3 id="2-traceroute"><a class="markdownIt-Anchor" href="#2-traceroute"></a> 2. Traceroute</h3>
<p>Traceroute æ˜¯ ICMP çš„å¦ä¸€ä¸ªåº”ç”¨ï¼Œç”¨æ¥è·Ÿè¸ªä¸€ä¸ªåˆ†ç»„ä»æºç‚¹åˆ°ç»ˆç‚¹çš„è·¯å¾„ã€‚</p>
<p>Traceroute å‘é€çš„ IP æ•°æ®æŠ¥å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„ UDP ç”¨æˆ·æ•°æ®æŠ¥ï¼Œå¹¶ç”±ç›®çš„ä¸»æœºå‘é€ç»ˆç‚¹ä¸å¯è¾¾å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚</p>
<ul>
<li>æºä¸»æœºå‘ç›®çš„ä¸»æœºå‘é€ä¸€è¿ä¸²çš„ IP æ•°æ®æŠ¥ã€‚ç¬¬ä¸€ä¸ªæ•°æ®æŠ¥ P1 çš„ç”Ÿå­˜æ—¶é—´ TTL è®¾ç½®ä¸º 1ï¼Œå½“ P1 åˆ°è¾¾è·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªè·¯ç”±å™¨ R1 æ—¶ï¼ŒR1 æ”¶ä¸‹å®ƒå¹¶æŠŠ TTL å‡ 1ï¼Œæ­¤æ—¶ TTL ç­‰äº 0ï¼ŒR1 å°±æŠŠ P1 ä¸¢å¼ƒï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ª ICMP æ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ï¼›</li>
<li>æºä¸»æœºæ¥ç€å‘é€ç¬¬äºŒä¸ªæ•°æ®æŠ¥ P2ï¼Œå¹¶æŠŠ TTL è®¾ç½®ä¸º 2ã€‚P2 å…ˆåˆ°è¾¾ R1ï¼ŒR1 æ”¶ä¸‹åæŠŠ TTL å‡ 1 å†è½¬å‘ç»™ R2ï¼ŒR2 æ”¶ä¸‹åä¹ŸæŠŠ TTL å‡ 1ï¼Œç”±äºæ­¤æ—¶ TTL ç­‰äº 0ï¼ŒR2 å°±ä¸¢å¼ƒ P2ï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ª ICMP æ—¶é—´è¶…è¿‡å·®é”™æŠ¥æ–‡ã€‚</li>
<li>ä¸æ–­æ‰§è¡Œè¿™æ ·çš„æ­¥éª¤ï¼Œç›´åˆ°æœ€åä¸€ä¸ªæ•°æ®æŠ¥åˆšåˆšåˆ°è¾¾ç›®çš„ä¸»æœºï¼Œä¸»æœºä¸è½¬å‘æ•°æ®æŠ¥ï¼Œä¹Ÿä¸æŠŠ TTL å€¼å‡ 1ã€‚ä½†æ˜¯å› ä¸ºæ•°æ®æŠ¥å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„ UDPï¼Œå› æ­¤ç›®çš„ä¸»æœºè¦å‘æºä¸»æœºå‘é€ ICMP ç»ˆç‚¹ä¸å¯è¾¾å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚</li>
<li>ä¹‹åæºä¸»æœºçŸ¥é“äº†åˆ°è¾¾ç›®çš„ä¸»æœºæ‰€ç»è¿‡çš„è·¯ç”±å™¨ IP åœ°å€ä»¥åŠåˆ°è¾¾æ¯ä¸ªè·¯ç”±å™¨çš„å¾€è¿”æ—¶é—´ã€‚</li>
</ul>
<h2 id="è™šæ‹Ÿä¸“ç”¨ç½‘-vpn"><a class="markdownIt-Anchor" href="#è™šæ‹Ÿä¸“ç”¨ç½‘-vpn"></a> è™šæ‹Ÿä¸“ç”¨ç½‘ VPN</h2>
<p>ç”±äº IP åœ°å€çš„ç´§ç¼ºï¼Œä¸€ä¸ªæœºæ„èƒ½ç”³è¯·åˆ°çš„ IP åœ°å€æ•°å¾€å¾€è¿œå°äºæœ¬æœºæ„æ‰€æ‹¥æœ‰çš„ä¸»æœºæ•°ã€‚å¹¶ä¸”ä¸€ä¸ªæœºæ„å¹¶ä¸éœ€è¦æŠŠæ‰€æœ‰çš„ä¸»æœºæ¥å…¥åˆ°å¤–éƒ¨çš„äº’è”ç½‘ä¸­ï¼Œæœºæ„å†…çš„è®¡ç®—æœºå¯ä»¥ä½¿ç”¨ä»…åœ¨æœ¬æœºæ„æœ‰æ•ˆçš„ IP åœ°å€ï¼ˆä¸“ç”¨åœ°å€ï¼‰ã€‚</p>
<p>æœ‰ä¸‰ä¸ªä¸“ç”¨åœ°å€å—ï¼š</p>
<ul>
<li>10.0.0.0 ~ 10.255.255.255</li>
<li>172.16.0.0 ~ 172.31.255.255</li>
<li>192.168.0.0 ~ 192.168.255.255</li>
</ul>
<p>VPN ä½¿ç”¨å…¬ç”¨çš„äº’è”ç½‘ä½œä¸ºæœ¬æœºæ„å„ä¸“ç”¨ç½‘ä¹‹é—´çš„é€šä¿¡è½½ä½“ã€‚ä¸“ç”¨æŒ‡æœºæ„å†…çš„ä¸»æœºåªä¸æœ¬æœºæ„å†…çš„å…¶å®ƒä¸»æœºé€šä¿¡ï¼›è™šæ‹ŸæŒ‡å¥½åƒæ˜¯ï¼Œè€Œå®é™…ä¸Šå¹¶ä¸æ˜¯ï¼Œå®ƒæœ‰ç»è¿‡å…¬ç”¨çš„äº’è”ç½‘ã€‚</p>
<p>ä¸‹å›¾ä¸­ï¼Œåœºæ‰€ A å’Œ B çš„é€šä¿¡ç»è¿‡äº’è”ç½‘ï¼Œå¦‚æœåœºæ‰€ A çš„ä¸»æœº X è¦å’Œå¦ä¸€ä¸ªåœºæ‰€ B çš„ä¸»æœº Y é€šä¿¡ï¼ŒIP æ•°æ®æŠ¥çš„æºåœ°å€æ˜¯ 10.1.0.1ï¼Œç›®çš„åœ°å€æ˜¯ 10.2.0.3ã€‚æ•°æ®æŠ¥å…ˆå‘é€åˆ°ä¸äº’è”ç½‘ç›¸è¿çš„è·¯ç”±å™¨ R1ï¼ŒR1 å¯¹å†…éƒ¨æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œç„¶åé‡æ–°åŠ ä¸Šæ•°æ®æŠ¥çš„é¦–éƒ¨ï¼Œæºåœ°å€æ˜¯è·¯ç”±å™¨ R1 çš„å…¨çƒåœ°å€ 125.1.2.3ï¼Œç›®çš„åœ°å€æ˜¯è·¯ç”±å™¨ R2 çš„å…¨çƒåœ°å€ 194.4.5.6ã€‚è·¯ç”±å™¨ R2 æ”¶åˆ°æ•°æ®æŠ¥åå°†æ•°æ®éƒ¨åˆ†è¿›è¡Œè§£å¯†ï¼Œæ¢å¤åŸæ¥çš„æ•°æ®æŠ¥ï¼Œæ­¤æ—¶ç›®çš„åœ°å€ä¸º 10.2.0.3ï¼Œå°±äº¤ä»˜ç»™ Yã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086901339.png!zp"/></div>
<h2 id="ç½‘ç»œåœ°å€è½¬æ¢-nat"><a class="markdownIt-Anchor" href="#ç½‘ç»œåœ°å€è½¬æ¢-nat"></a> ç½‘ç»œåœ°å€è½¬æ¢ NAT</h2>
<p>ä¸“ç”¨ç½‘å†…éƒ¨çš„ä¸»æœºä½¿ç”¨æœ¬åœ° IP åœ°å€åˆæƒ³å’Œäº’è”ç½‘ä¸Šçš„ä¸»æœºé€šä¿¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ NAT æ¥å°†æœ¬åœ° IP è½¬æ¢ä¸ºå…¨çƒ IPã€‚</p>
<p>åœ¨ä»¥å‰ï¼ŒNAT å°†æœ¬åœ° IP å’Œå…¨çƒ IP ä¸€ä¸€å¯¹åº”ï¼Œè¿™ç§æ–¹å¼ä¸‹æ‹¥æœ‰ n ä¸ªå…¨çƒ IP åœ°å€çš„ä¸“ç”¨ç½‘å†…æœ€å¤šåªå¯ä»¥åŒæ—¶æœ‰ n å°ä¸»æœºæ¥å…¥äº’è”ç½‘ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°åˆ©ç”¨å…¨çƒ IP åœ°å€ï¼Œç°åœ¨å¸¸ç”¨çš„ NAT è½¬æ¢è¡¨æŠŠä¼ è¾“å±‚çš„ç«¯å£å·ä¹Ÿç”¨ä¸Šäº†ï¼Œä½¿å¾—å¤šä¸ªä¸“ç”¨ç½‘å†…éƒ¨çš„ä¸»æœºå…±ç”¨ä¸€ä¸ªå…¨çƒ IP åœ°å€ã€‚ä½¿ç”¨ç«¯å£å·çš„ NAT ä¹Ÿå«åšç½‘ç»œåœ°å€ä¸ç«¯å£è½¬æ¢ NAPTã€‚</p>
<h2 id="è·¯ç”±å™¨çš„ç»“æ„"><a class="markdownIt-Anchor" href="#è·¯ç”±å™¨çš„ç»“æ„"></a> è·¯ç”±å™¨çš„ç»“æ„</h2>
<p>è·¯ç”±å™¨ä»åŠŸèƒ½ä¸Šå¯ä»¥åˆ’åˆ†ä¸ºï¼šè·¯ç”±é€‰æ‹©å’Œåˆ†ç»„è½¬å‘ã€‚</p>
<p>åˆ†ç»„è½¬å‘ç»“æ„ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šäº¤æ¢ç»“æ„ã€ä¸€ç»„è¾“å…¥ç«¯å£å’Œä¸€ç»„è¾“å‡ºç«¯å£ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086930371.png!zp"/></div>
<h2 id="è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹"><a class="markdownIt-Anchor" href="#è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹"></a> è·¯ç”±å™¨åˆ†ç»„è½¬å‘æµç¨‹</h2>
<ul>
<li>ä»æ•°æ®æŠ¥çš„é¦–éƒ¨æå–ç›®çš„ä¸»æœºçš„ IP åœ°å€ Dï¼Œå¾—åˆ°ç›®çš„ç½‘ç»œåœ°å€ Nã€‚</li>
<li>è‹¥ N å°±æ˜¯ä¸æ­¤è·¯ç”±å™¨ç›´æ¥ç›¸è¿çš„æŸä¸ªç½‘ç»œåœ°å€ï¼Œåˆ™è¿›è¡Œç›´æ¥äº¤ä»˜ï¼›</li>
<li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ç›®çš„åœ°å€ä¸º D çš„ç‰¹å®šä¸»æœºè·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è¡¨ä¸­æ‰€æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›</li>
<li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰åˆ°è¾¾ç½‘ç»œ N çš„è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›</li>
<li>è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„é»˜è®¤è·¯ç”±å™¨ï¼›</li>
<li>æŠ¥å‘Šè½¬å‘åˆ†ç»„å‡ºé”™ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086952828.png!zp"/></div>
<h2 id="è·¯ç”±é€‰æ‹©åè®®"><a class="markdownIt-Anchor" href="#è·¯ç”±é€‰æ‹©åè®®"></a> è·¯ç”±é€‰æ‹©åè®®</h2>
<p>è·¯ç”±é€‰æ‹©åè®®éƒ½æ˜¯è‡ªé€‚åº”çš„ï¼Œèƒ½éšç€ç½‘ç»œé€šä¿¡é‡å’Œæ‹“æ‰‘ç»“æ„çš„å˜åŒ–è€Œè‡ªé€‚åº”åœ°è¿›è¡Œè°ƒæ•´ã€‚</p>
<p>äº’è”ç½‘å¯ä»¥åˆ’åˆ†ä¸ºè®¸å¤šè¾ƒå°çš„è‡ªæ²»ç³»ç»Ÿ ASï¼Œä¸€ä¸ª AS å¯ä»¥ä½¿ç”¨ä¸€ç§å’Œåˆ«çš„ AS ä¸åŒçš„è·¯ç”±é€‰æ‹©åè®®ã€‚</p>
<p>å¯ä»¥æŠŠè·¯ç”±é€‰æ‹©åè®®åˆ’åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p>
<ul>
<li>è‡ªæ²»ç³»ç»Ÿå†…éƒ¨çš„è·¯ç”±é€‰æ‹©ï¼šRIP å’Œ OSPF</li>
<li>è‡ªæ²»ç³»ç»Ÿé—´çš„è·¯ç”±é€‰æ‹©ï¼šBGP</li>
</ul>
<h3 id="1-å†…éƒ¨ç½‘å…³åè®®-rip"><a class="markdownIt-Anchor" href="#1-å†…éƒ¨ç½‘å…³åè®®-rip"></a> 1. å†…éƒ¨ç½‘å…³åè®® RIP</h3>
<p>RIP æ˜¯ä¸€ç§åŸºäºè·ç¦»å‘é‡çš„è·¯ç”±é€‰æ‹©åè®®ã€‚è·ç¦»æ˜¯æŒ‡è·³æ•°ï¼Œç›´æ¥ç›¸è¿çš„è·¯ç”±å™¨è·³æ•°ä¸º 1ã€‚è·³æ•°æœ€å¤šä¸º 15ï¼Œè¶…è¿‡ 15 è¡¨ç¤ºä¸å¯è¾¾ã€‚</p>
<p>RIP æŒ‰å›ºå®šçš„æ—¶é—´é—´éš”ä»…å’Œç›¸é‚»è·¯ç”±å™¨äº¤æ¢è‡ªå·±çš„è·¯ç”±è¡¨ï¼Œç»è¿‡è‹¥å¹²æ¬¡äº¤æ¢ä¹‹åï¼Œæ‰€æœ‰è·¯ç”±å™¨æœ€ç»ˆä¼šçŸ¥é“åˆ°è¾¾æœ¬è‡ªæ²»ç³»ç»Ÿä¸­ä»»ä½•ä¸€ä¸ªç½‘ç»œçš„æœ€çŸ­è·ç¦»å’Œä¸‹ä¸€è·³è·¯ç”±å™¨åœ°å€ã€‚</p>
<p>è·ç¦»å‘é‡ç®—æ³•ï¼š</p>
<ul>
<li>å¯¹åœ°å€ä¸º X çš„ç›¸é‚»è·¯ç”±å™¨å‘æ¥çš„ RIP æŠ¥æ–‡ï¼Œå…ˆä¿®æ”¹æŠ¥æ–‡ä¸­çš„æ‰€æœ‰é¡¹ç›®ï¼ŒæŠŠä¸‹ä¸€è·³å­—æ®µä¸­çš„åœ°å€æ”¹ä¸º Xï¼Œå¹¶æŠŠæ‰€æœ‰çš„è·ç¦»å­—æ®µåŠ  1ï¼›</li>
<li>å¯¹ä¿®æ”¹åçš„ RIP æŠ¥æ–‡ä¸­çš„æ¯ä¸€ä¸ªé¡¹ç›®ï¼Œè¿›è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</li>
<li>è‹¥åŸæ¥çš„è·¯ç”±è¡¨ä¸­æ²¡æœ‰ç›®çš„ç½‘ç»œ Nï¼Œåˆ™æŠŠè¯¥é¡¹ç›®æ·»åŠ åˆ°è·¯ç”±è¡¨ä¸­ï¼›</li>
<li>å¦åˆ™ï¼šè‹¥ä¸‹ä¸€è·³è·¯ç”±å™¨åœ°å€æ˜¯ Xï¼Œåˆ™æŠŠæ”¶åˆ°çš„é¡¹ç›®æ›¿æ¢åŸæ¥è·¯ç”±è¡¨ä¸­çš„é¡¹ç›®ï¼›å¦åˆ™ï¼šè‹¥æ”¶åˆ°çš„é¡¹ç›®ä¸­çš„è·ç¦» d å°äºè·¯ç”±è¡¨ä¸­çš„è·ç¦»ï¼Œåˆ™è¿›è¡Œæ›´æ–°ï¼ˆä¾‹å¦‚åŸå§‹è·¯ç”±è¡¨é¡¹ä¸º Net2, 5, Pï¼Œæ–°è¡¨é¡¹ä¸º Net2, 4, Xï¼Œåˆ™æ›´æ–°ï¼‰ï¼›å¦åˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚</li>
<li>è‹¥ 3 åˆ†é’Ÿè¿˜æ²¡æœ‰æ”¶åˆ°ç›¸é‚»è·¯ç”±å™¨çš„æ›´æ–°è·¯ç”±è¡¨ï¼Œåˆ™æŠŠè¯¥ç›¸é‚»è·¯ç”±å™¨æ ‡ä¸ºä¸å¯è¾¾ï¼Œå³æŠŠè·ç¦»ç½®ä¸º 16ã€‚</li>
</ul>
<p>RIP åè®®å®ç°ç®€å•ï¼Œå¼€é”€å°ã€‚ä½†æ˜¯ RIP èƒ½ä½¿ç”¨çš„æœ€å¤§è·ç¦»ä¸º 15ï¼Œé™åˆ¶äº†ç½‘ç»œçš„è§„æ¨¡ã€‚å¹¶ä¸”å½“ç½‘ç»œå‡ºç°æ•…éšœæ—¶ï¼Œè¦ç»è¿‡æ¯”è¾ƒé•¿çš„æ—¶é—´æ‰èƒ½å°†æ­¤æ¶ˆæ¯ä¼ é€åˆ°æ‰€æœ‰è·¯ç”±å™¨ã€‚</p>
<h3 id="2-å†…éƒ¨ç½‘å…³åè®®-ospf"><a class="markdownIt-Anchor" href="#2-å†…éƒ¨ç½‘å…³åè®®-ospf"></a> 2. å†…éƒ¨ç½‘å…³åè®® OSPF</h3>
<p>å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆ OSPFï¼Œæ˜¯ä¸ºäº†å…‹æœ RIP çš„ç¼ºç‚¹è€Œå¼€å‘å‡ºæ¥çš„ã€‚</p>
<p>å¼€æ”¾è¡¨ç¤º OSPF ä¸å—æŸä¸€å®¶å‚å•†æ§åˆ¶ï¼Œè€Œæ˜¯å…¬å¼€å‘è¡¨çš„ï¼›æœ€çŸ­è·¯å¾„ä¼˜å…ˆè¡¨ç¤ºä½¿ç”¨äº† Dijkstra æå‡ºçš„æœ€çŸ­è·¯å¾„ç®—æ³• SPFã€‚</p>
<p>OSPF å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å‘æœ¬è‡ªæ²»ç³»ç»Ÿä¸­çš„æ‰€æœ‰è·¯ç”±å™¨å‘é€ä¿¡æ¯ï¼Œè¿™ç§æ–¹æ³•æ˜¯æ´ªæ³›æ³•ã€‚</li>
<li>å‘é€çš„ä¿¡æ¯å°±æ˜¯ä¸ç›¸é‚»è·¯ç”±å™¨çš„é“¾è·¯çŠ¶æ€ï¼Œé“¾è·¯çŠ¶æ€åŒ…æ‹¬ä¸å“ªäº›è·¯ç”±å™¨ç›¸è¿ä»¥åŠé“¾è·¯çš„åº¦é‡ï¼Œåº¦é‡ç”¨è´¹ç”¨ã€è·ç¦»ã€æ—¶å»¶ã€å¸¦å®½ç­‰æ¥è¡¨ç¤ºã€‚</li>
<li>åªæœ‰å½“é“¾è·¯çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè·¯ç”±å™¨æ‰ä¼šå‘é€ä¿¡æ¯ã€‚</li>
</ul>
<p>æ‰€æœ‰è·¯ç”±å™¨éƒ½å…·æœ‰å…¨ç½‘çš„æ‹“æ‰‘ç»“æ„å›¾ï¼Œå¹¶ä¸”æ˜¯ä¸€è‡´çš„ã€‚ç›¸æ¯”äº RIPï¼ŒOSPF çš„æ›´æ–°è¿‡ç¨‹æ”¶æ•›çš„å¾ˆå¿«ã€‚</p>
<h3 id="3-å¤–éƒ¨ç½‘å…³åè®®-bgp"><a class="markdownIt-Anchor" href="#3-å¤–éƒ¨ç½‘å…³åè®®-bgp"></a> 3. å¤–éƒ¨ç½‘å…³åè®® BGP</h3>
<p>BGPï¼ˆBorder Gateway Protocolï¼Œè¾¹ç•Œç½‘å…³åè®®ï¼‰</p>
<p>AS ä¹‹é—´çš„è·¯ç”±é€‰æ‹©å¾ˆå›°éš¾ï¼Œä¸»è¦æ˜¯ç”±äºï¼š</p>
<ul>
<li>äº’è”ç½‘è§„æ¨¡å¾ˆå¤§ï¼›</li>
<li>å„ä¸ª AS å†…éƒ¨ä½¿ç”¨ä¸åŒçš„è·¯ç”±é€‰æ‹©åè®®ï¼Œæ— æ³•å‡†ç¡®å®šä¹‰è·¯å¾„çš„åº¦é‡ï¼›</li>
<li>AS ä¹‹é—´çš„è·¯ç”±é€‰æ‹©å¿…é¡»è€ƒè™‘æœ‰å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æœ‰äº› AS ä¸æ„¿æ„è®©å…¶å®ƒ AS ç»è¿‡ã€‚</li>
</ul>
<p>BGP åªèƒ½å¯»æ‰¾ä¸€æ¡æ¯”è¾ƒå¥½çš„è·¯ç”±ï¼Œè€Œä¸æ˜¯æœ€ä½³è·¯ç”±ã€‚</p>
<p>æ¯ä¸ª AS éƒ½å¿…é¡»é…ç½® BGP å‘è¨€äººï¼Œé€šè¿‡åœ¨ä¸¤ä¸ªç›¸é‚» BGP å‘è¨€äººä¹‹é—´å»ºç«‹ TCP è¿æ¥æ¥äº¤æ¢è·¯ç”±ä¿¡æ¯ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network/1551086977310.png!zp"/></div>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å†›äº‹</title>
    <url>/blog/minds/%E4%BA%BA%E6%96%87/%E5%86%9B%E4%BA%8B/README/</url>
    <content><![CDATA[<h1 id="å†›äº‹"><a class="markdownIt-Anchor" href="#å†›äº‹"></a> å†›äº‹</h1>
<blockquote>
<p>å†›äº‹æ˜¯ä¸æˆ˜äº‰ã€å†›é˜Ÿã€å†›äººç­‰æœ‰å…³äº‹åŠ¡çš„æ€»ç§°ã€‚</p>
</blockquote>
<h2 id="å…³é”®è¯"><a class="markdownIt-Anchor" href="#å…³é”®è¯"></a> å…³é”®è¯</h2>
<p>æˆ˜äº‰ã€æˆ˜å½¹ã€æˆ˜æ–—ã€æˆ˜å£«ã€æˆ˜ç•¥ã€æˆ˜æœ¯ã€æ­¦å™¨ã€å…µç§ã€è¿›æ”»ã€é˜²å¾¡ã€æŒ‡æŒ¥ã€å…µæ³•ã€å†›è¡”</p>
]]></content>
  </entry>
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œä¹‹æ•°æ®é“¾è·¯å±‚</title>
    <url>/blog/communication/network-data-link/</url>
    <content><![CDATA[<blockquote>
<p><strong>æ•°æ®é“¾è·¯å±‚ï¼ˆData Link Layerï¼‰</strong> - ç½‘ç»œå±‚é’ˆå¯¹çš„è¿˜æ˜¯ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œè€Œä¸»æœºä¹‹é—´å¯ä»¥æœ‰å¾ˆå¤šé“¾è·¯ï¼Œé“¾è·¯å±‚åè®®å°±æ˜¯ä¸ºåŒä¸€é“¾è·¯çš„ä¸»æœºæä¾›æ•°æ®ä¼ è¾“æœåŠ¡ã€‚æ•°æ®é“¾è·¯å±‚æŠŠç½‘ç»œå±‚ä¼ ä¸‹æ¥çš„åˆ†ç»„å°è£…æˆå¸§ã€‚</p>
<ul>
<li>ä¸»è¦åè®®ï¼š<code>PPP</code>ã€<code>CSMA/CD</code> ç­‰ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šå¸§ï¼ˆframeï¼‰ã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šäºŒå±‚äº¤æ¢æœºã€ç½‘æ¡¥ã€ç½‘å¡ã€‚</li>
</ul>
</blockquote>
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<ul>
<li>é“¾è·¯æ˜¯ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°ç›¸é‚»èŠ‚ç‚¹çš„ä¸€æ®µç‰©ç†çº¿è·¯ï¼Œæ•°æ®é“¾è·¯åˆ™æ˜¯åœ¨é“¾è·¯çš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›å¿…è¦çš„ç¡¬ä»¶ï¼ˆç½‘ç»œé€‚é…å™¨ï¼‰å’Œè½¯ä»¶ï¼ˆåè®®ï¼‰ã€‚</li>
<li>æ•°æ®é“¾è·¯å±‚ä¸‰ä¸ªåŸºæœ¬é—®é¢˜ï¼šå°è£…æˆå¸§ã€é€æ˜ä¼ è¾“ã€å·®é”™æ£€æµ‹ã€‚</li>
<li>æ•°æ®é“¾è·¯å±‚æœ‰ä¸¤ç§ä¿¡é“ç±»å‹ï¼šç‚¹å¯¹ç‚¹ä¿¡é“ï¼ˆä¸»è¦ä½¿ç”¨ <code>PPP</code>ï¼‰å’Œå¹¿æ’­ä¿¡é“ï¼ˆä¸»è¦ä½¿ç”¨ <code>CSMA/CD</code>ï¼‰ã€‚</li>
<li>ä»¥å¤ªç½‘ MAC å±‚çš„åœ°å€ã€‚</li>
<li>é€‚é…å™¨ã€è½¬å‘å™¨ã€é›†çº¿å™¨ã€ç½‘æ¡¥ã€ä»¥å¤ªç½‘äº¤æ¢æœºçš„ä½œç”¨åŠä½¿ç”¨åœºåˆã€‚</li>
</ul>
<h2 id="åŸºæœ¬é—®é¢˜"><a class="markdownIt-Anchor" href="#åŸºæœ¬é—®é¢˜"></a> åŸºæœ¬é—®é¢˜</h2>
<h3 id="å°è£…æˆå¸§"><a class="markdownIt-Anchor" href="#å°è£…æˆå¸§"></a> å°è£…æˆå¸§</h3>
<p>ä¸ºç½‘ç»œå±‚ä¼ ä¸‹æ¥çš„ IP æ•°æ®æŠ¥æ·»åŠ é¦–éƒ¨å’Œå°¾éƒ¨ï¼Œç”¨äºæ ‡è®°å¸§çš„å¼€å§‹å’Œç»“æŸã€‚</p>
<p>ä¸ºäº†æé«˜ä¼ è¾“æ•ˆç‡ï¼Œåº”è¯¥è®©æ•°æ®éƒ¨åˆ†é•¿åº¦å°½å¯èƒ½å¤§äºé¦–éƒ¨å’Œå°¾éƒ¨ã€‚ä½†æ˜¯ï¼Œæ¯ç§é“¾è·¯å±‚åè®®éƒ½é™åˆ¶äº†å¸§çš„æ•°æ®éƒ¨åˆ†é•¿åº¦ä¸Šçº¿â€”â€”æœ€å¤§ä¼ é€å•å…ƒ MTUï¼ˆMaximum Transfer Unitï¼‰</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/data-link/æ•°æ®é“¾è·¯å¸§.png!zp"/></div>
<h3 id="é€æ˜ä¼ è¾“"><a class="markdownIt-Anchor" href="#é€æ˜ä¼ è¾“"></a> é€æ˜ä¼ è¾“</h3>
<p><strong>é€æ˜</strong>è¡¨ç¤ºï¼šæŸä¸€ä¸ªå®é™…å­˜åœ¨çš„äº‹ç‰©çœ‹èµ·æ¥å¥½åƒä¸å­˜åœ¨ä¸€æ ·ã€‚</p>
<p>å¸§ä½¿ç”¨é¦–éƒ¨å’Œå°¾éƒ¨è¿›è¡Œå®šç•Œï¼Œå¦‚æœå¸§çš„æ•°æ®éƒ¨åˆ†å«æœ‰å’Œé¦–éƒ¨å°¾éƒ¨ç›¸åŒçš„å†…å®¹ï¼Œé‚£ä¹ˆå¸§çš„å¼€å§‹å’Œç»“æŸä½ç½®å°±ä¼šè¢«é”™è¯¯çš„åˆ¤å®šã€‚éœ€è¦åœ¨æ•°æ®éƒ¨åˆ†å‡ºç°é¦–éƒ¨å°¾éƒ¨ç›¸åŒçš„å†…å®¹å‰é¢æ’å…¥è½¬ä¹‰å­—ç¬¦ã€‚å¦‚æœæ•°æ®éƒ¨åˆ†å‡ºç°è½¬ä¹‰å­—ç¬¦ï¼Œé‚£ä¹ˆå°±åœ¨è½¬ä¹‰å­—ç¬¦å‰é¢å†åŠ ä¸ªè½¬ä¹‰å­—ç¬¦ã€‚åœ¨æ¥æ”¶ç«¯è¿›è¡Œå¤„ç†ä¹‹åå¯ä»¥è¿˜åŸå‡ºåŸå§‹æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹é€æ˜ä¼ è¾“çš„å†…å®¹æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œç”¨æˆ·å¯Ÿè§‰ä¸åˆ°è½¬ä¹‰å­—ç¬¦çš„å­˜åœ¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/data-link/ç»è¿‡å­—èŠ‚å¡«å……åå‘é€çš„æ•°æ®.png!zp"/></div>
<h3 id="å·®é”™æ£€æµ‹"><a class="markdownIt-Anchor" href="#å·®é”™æ£€æµ‹"></a> å·®é”™æ£€æµ‹</h3>
<p>ç›®å‰æ•°æ®é“¾è·¯å±‚å¹¿æ³›ä½¿ç”¨äº†<a href="https://zh.wikipedia.org/wiki/%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A3%80%E9%AA%8C" target="_blank" rel="noopener"><strong>å¾ªç¯å†—ä½™æ£€éªŒ CRCï¼ˆCyclic redundancy checkï¼‰</strong></a>æ¥æ£€æŸ¥æ¯”ç‰¹å·®é”™ã€‚</p>
<h2 id="ç‚¹å¯¹ç‚¹ä¿¡é“"><a class="markdownIt-Anchor" href="#ç‚¹å¯¹ç‚¹ä¿¡é“"></a> ç‚¹å¯¹ç‚¹ä¿¡é“</h2>
<p>ç‚¹å¯¹ç‚¹ä¿¡é“ä½¿ç”¨ä¸€å¯¹ä¸€çš„ç‚¹å¯¹ç‚¹é€šä¿¡æ–¹å¼ã€‚</p>
<p>å¯¹äºç‚¹å¯¹ç‚¹çš„é“¾è·¯ï¼Œç‚¹å¯¹ç‚¹åè®® PPPï¼ˆPoint-to-Point Protocolï¼‰æ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„æ•°æ®é“¾è·¯å±‚åè®®ã€‚</p>
<h3 id="ppp-åè®®"><a class="markdownIt-Anchor" href="#ppp-åè®®"></a> PPP åè®®</h3>
<p>äº’è”ç½‘ç”¨æˆ·é€šå¸¸éƒ½è¦è¿æ¥åˆ°æŸä¸ª ISP ä¹‹åæ‰èƒ½æ¥å…¥åˆ°äº’è”ç½‘ï¼ŒPPP åè®®æ˜¯ç”¨æˆ·è®¡ç®—æœºå’Œ ISP è¿›è¡Œé€šä¿¡æ—¶æ‰€ä½¿ç”¨çš„æ•°æ®é“¾è·¯å±‚åè®®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/data-link/PPPåè®®.png!zp"/></div>
<p>PPPï¼ˆç‚¹åˆ°ç‚¹åè®®ï¼‰æ˜¯ä¸ºåœ¨åŒç­‰å•å…ƒä¹‹é—´ä¼ è¾“æ•°æ®åŒ…è¿™æ ·çš„ç®€å•é“¾è·¯è®¾è®¡çš„é“¾è·¯å±‚åè®®ã€‚è¿™ç§é“¾è·¯æä¾›å…¨åŒå·¥æ“ä½œï¼Œå¹¶æŒ‰ç…§é¡ºåºä¼ é€’æ•°æ®åŒ…ã€‚è®¾è®¡ç›®çš„ä¸»è¦æ˜¯ç”¨æ¥é€šè¿‡æ‹¨å·æˆ–ä¸“çº¿æ–¹å¼å»ºç«‹ç‚¹å¯¹ç‚¹è¿æ¥å‘é€æ•°æ®ï¼Œä½¿å…¶æˆä¸ºå„ç§ä¸»æœºã€ç½‘æ¡¥å’Œè·¯ç”±å™¨ä¹‹é—´ç®€å•è¿æ¥çš„ä¸€ç§å…±é€šçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/data-link/PPPå¸§.png!zp"/></div>
<p>PPP çš„å¸§æ ¼å¼ï¼š</p>
<ul>
<li>F å­—æ®µä¸ºå¸§çš„å®šç•Œç¬¦</li>
<li>A å’Œ C å­—æ®µæš‚æ—¶æ²¡æœ‰æ„ä¹‰</li>
<li>FCS å­—æ®µæ˜¯ä½¿ç”¨ CRC çš„æ£€éªŒåºåˆ—</li>
<li>ä¿¡æ¯éƒ¨åˆ†çš„é•¿åº¦ä¸è¶…è¿‡ 1500</li>
</ul>
<h2 id="å¹¿æ’­ä¿¡é“"><a class="markdownIt-Anchor" href="#å¹¿æ’­ä¿¡é“"></a> å¹¿æ’­ä¿¡é“</h2>
<p>å¹¿æ’­ä¿¡é“(broadcast channel)æ˜¯é€šè¿‡å¹¿æ’­çš„æ–¹å¼ä¼ è¾“ä¿¡æ¯çš„ä¿¡æ¯é€šé“ã€‚</p>
<p>æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½åœ¨åŒä¸€ä¸ªå¹¿æ’­ä¿¡é“ä¸Šå‘é€æ•°æ®ï¼Œå› æ­¤éœ€è¦æœ‰ä¸“é—¨çš„æ§åˆ¶æ–¹æ³•è¿›è¡Œåè°ƒï¼Œé¿å…å‘ç”Ÿå†²çªï¼ˆå†²çªä¹Ÿå«ç¢°æ’ï¼‰ã€‚</p>
<p>ä¸»è¦æœ‰ä¸¤ç§æ§åˆ¶æ–¹æ³•è¿›è¡Œåè°ƒï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨ä¿¡é“å¤ç”¨æŠ€æœ¯ï¼Œä¸€æ˜¯ä½¿ç”¨ CSMA/CD åè®®ã€‚</p>
<h3 id="csmacd-åè®®"><a class="markdownIt-Anchor" href="#csmacd-åè®®"></a> CSMA/CD åè®®</h3>
<p>CSMA/CDï¼ˆCarrier Sense Multiple Access with Collision Detectionï¼‰å³å¸¦å†²çªæ£€æµ‹çš„è½½æ³¢ç›‘å¬å¤šè·¯è®¿é—®æŠ€æœ¯(è½½æ³¢ç›‘å¬å¤šç‚¹æ¥å…¥/ç¢°æ’æ£€æµ‹)ã€‚</p>
<ul>
<li><strong>å¤šç‚¹æ¥å…¥</strong> ï¼šè¯´æ˜è¿™æ˜¯æ€»çº¿å‹ç½‘ç»œï¼Œè®¸å¤šè®¡ç®—æœºä»¥å¤šç‚¹æ¥å…¥çš„æ–¹å¼è¿æ¥åœ¨ä¸€æ ¹æ€»çº¿ä¸Šã€‚</li>
<li><strong>è½½æ³¢ç›‘å¬</strong> ï¼šæ¯ä¸ªä¸»æœºéƒ½å¿…é¡»ä¸åœåœ°ç›‘å¬ä¿¡é“ã€‚å‘é€å‰ç›‘å¬ï¼Œå¦‚æœå¿™åˆ™ç­‰å¾…ï¼Œå¦‚æœç©ºé—²åˆ™å‘é€ã€‚</li>
<li><strong>ç¢°æ’æ£€æµ‹</strong> ï¼šå³è¾¹å‘é€è¾¹æ£€æµ‹ã€‚è‹¥æ£€æµ‹åˆ°ä¿¡é“æœ‰å¹²æ‰°ä¿¡å·ï¼Œåˆ™è¡¨ç¤ºäº§ç”Ÿäº†ç¢°æ’ï¼Œäºæ˜¯å°±è¦åœæ­¢å‘é€æ•°æ®ï¼Œè®¡ç®—å‡ºé€€é¿ç­‰å¾…æ—¶é—´ï¼Œç„¶åä½¿ç”¨ CSMA æ–¹æ³•ç»§ç»­å°è¯•å‘é€ã€‚è®¡ç®—é€€é¿ç­‰å¾…æ—¶é—´é‡‡ç”¨çš„æ˜¯<a href="https://baike.baidu.com/item/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%8C%87%E6%95%B0%E9%80%80%E9%81%BF%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">äºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•</a>ã€‚</li>
</ul>
<h2 id="å±€åŸŸç½‘"><a class="markdownIt-Anchor" href="#å±€åŸŸç½‘"></a> å±€åŸŸç½‘</h2>
<p>å±€åŸŸç½‘ LANï¼ˆLocal Area Networkï¼‰æ˜¯æŒ‡åœ¨æŸä¸€åŒºåŸŸå†…ç”±å¤šå°è®¡ç®—æœºäº’è”æˆçš„è®¡ç®—æœºç»„ã€‚</p>
<p>å±€åŸŸç½‘çš„æ‹“æ‰‘ç»“æ„é€šå¸¸ä¸ºæ€»çº¿å‹å’Œç¯å‹ã€‚</p>
<p>å±€åŸŸç½‘æŠ€æœ¯ä¸»è¦æœ‰ï¼šä»¥å¤ªç½‘ã€ä»¤ç‰Œç¯ç½‘ã€FDDI ç½‘å’Œæ— çº¿å±€åŸŸç½‘ç­‰ã€‚</p>
<h2 id="ä»¥å¤ªç½‘"><a class="markdownIt-Anchor" href="#ä»¥å¤ªç½‘"></a> ä»¥å¤ªç½‘</h2>
<p>ä»¥å¤ªç½‘ï¼ˆEthernetï¼‰æ˜¯ä¸€ç§æ˜Ÿå‹æ‹“æ‰‘ç»“æ„å±€åŸŸç½‘ã€‚</p>
<p>ä»¥å¤ªç½‘æ˜¯ç›®å‰åº”ç”¨æœ€å¹¿æ³›çš„å±€åŸŸç½‘ã€‚</p>
<p>ä»¥å¤ªç½‘ä½¿ç”¨ CSMA/CD åè®®ã€‚</p>
<h2 id="mac-åœ°å€"><a class="markdownIt-Anchor" href="#mac-åœ°å€"></a> MAC åœ°å€</h2>
<p>MAC åœ°å€ï¼ˆMedia Access Control Addressï¼‰ï¼Œä¹Ÿç§°ä¸ºä»¥å¤ªç½‘åœ°å€æˆ–ç‰©ç†åœ°å€ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨æ¥ç¡®è®¤ç½‘ä¸Šè®¾å¤‡ä½ç½®çš„åœ°å€ã€‚</p>
<p>MAC åœ°å€é•¿åº¦ä¸º 6 å­—èŠ‚ï¼ˆ48 ä½ï¼‰ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ç½‘ç»œé€‚é…å™¨ï¼ˆç½‘å¡ï¼‰ã€‚</p>
<p>ä¸€å°ä¸»æœºæ‹¥æœ‰å¤šå°‘ä¸ªç½‘ç»œé€‚é…å™¨å°±æœ‰å¤šå°‘ä¸ª MAC åœ°å€ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/data-link/MACå¸§.png!zp"/></div>
<h2 id="è®¾å¤‡"><a class="markdownIt-Anchor" href="#è®¾å¤‡"></a> è®¾å¤‡</h2>
<h3 id="é€‚é…å™¨"><a class="markdownIt-Anchor" href="#é€‚é…å™¨"></a> é€‚é…å™¨</h3>
<p>ç½‘ç»œé€‚é…å™¨ä¸€èˆ¬æŒ‡ç½‘å¡ã€‚</p>
<p>ç½‘å¡æ˜¯å·¥ä½œåœ¨é“¾è·¯å±‚çš„ç½‘ç»œç»„ä»¶ï¼Œæ˜¯å±€åŸŸç½‘ä¸­è¿æ¥è®¡ç®—æœºå’Œä¼ è¾“ä»‹è´¨çš„æ¥å£ï¼Œä¸ä»…èƒ½å®ç°ä¸å±€åŸŸç½‘ä¼ è¾“ä»‹è´¨ä¹‹é—´çš„ç‰©ç†è¿æ¥å’Œç”µä¿¡å·åŒ¹é…ï¼Œè¿˜æ¶‰åŠå¸§çš„å‘é€ä¸æ¥æ”¶ã€å¸§çš„å°è£…ä¸æ‹†å°ã€ä»‹è´¨è®¿é—®æ§åˆ¶ã€æ•°æ®çš„ç¼–ç ä¸è§£ç ä»¥åŠæ•°æ®ç¼“å­˜çš„åŠŸèƒ½ç­‰ã€‚</p>
<p>ç½‘å¡å’Œå±€åŸŸç½‘ä¹‹é—´çš„é€šä¿¡æ˜¯é€šè¿‡ç”µç¼†æˆ–åŒç»çº¿ä»¥ä¸²è¡Œä¼ è¾“æ–¹å¼è¿›è¡Œçš„ã€‚è€Œç½‘å¡å’Œè®¡ç®—æœºä¹‹é—´çš„é€šä¿¡åˆ™æ˜¯é€šè¿‡è®¡ç®—æœºä¸»æ¿ä¸Šçš„ I/O æ€»çº¿ä»¥å¹¶è¡Œä¼ è¾“æ–¹å¼è¿›è¡Œã€‚</p>
<h3 id="é›†çº¿å™¨"><a class="markdownIt-Anchor" href="#é›†çº¿å™¨"></a> é›†çº¿å™¨</h3>
<p>é›†çº¿å™¨ï¼ˆHubï¼‰çš„ä¸»è¦åŠŸèƒ½æ˜¯å¯¹æ¥æ”¶åˆ°çš„ä¿¡å·è¿›è¡Œå†ç”Ÿæ•´å½¢æ”¾å¤§ï¼Œä»¥æ‰©å¤§ç½‘ç»œçš„ä¼ è¾“è·ç¦»ï¼ŒåŒæ—¶æŠŠæ‰€æœ‰èŠ‚ç‚¹é›†ä¸­åœ¨ä»¥å®ƒä¸ºä¸­å¿ƒçš„èŠ‚ç‚¹ä¸Šã€‚</p>
<p>ä½¿ç”¨é›†çº¿å™¨å¯ä»¥åœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘ã€‚</p>
<h3 id="ç½‘æ¡¥"><a class="markdownIt-Anchor" href="#ç½‘æ¡¥"></a> ç½‘æ¡¥</h3>
<p>ç½‘æ¡¥ï¼ˆBridgeï¼‰æ˜¯æ—©æœŸçš„ä¸¤ç«¯å£äºŒå±‚ç½‘ç»œè®¾å¤‡ï¼Œç”¨æ¥è¿æ¥ä¸åŒç½‘æ®µã€‚ç½‘æ¡¥çš„ä¸¤ä¸ªç«¯å£åˆ†åˆ«æœ‰ä¸€æ¡ç‹¬ç«‹çš„äº¤æ¢ä¿¡é“ï¼Œä¸æ˜¯å…±äº«ä¸€æ¡èƒŒæ¿æ€»çº¿ï¼Œå¯éš”ç¦»å†²çªåŸŸã€‚ç½‘æ¡¥æ¯”é›†çº¿å™¨ï¼ˆHubï¼‰æ€§èƒ½æ›´å¥½ï¼Œé›†çº¿å™¨ä¸Šå„ç«¯å£éƒ½æ˜¯å…±äº«åŒä¸€æ¡èƒŒæ¿æ€»çº¿çš„ã€‚åæ¥ï¼Œç½‘æ¡¥è¢«å…·æœ‰æ›´å¤šç«¯å£ã€åŒæ—¶ä¹Ÿå¯éš”ç¦»å†²çªåŸŸçš„äº¤æ¢æœºï¼ˆSwitchï¼‰æ‰€å–ä»£ã€‚</p>
<h3 id="ä»¥å¤ªç½‘äº¤æ¢æœº"><a class="markdownIt-Anchor" href="#ä»¥å¤ªç½‘äº¤æ¢æœº"></a> ä»¥å¤ªç½‘äº¤æ¢æœº</h3>
<p>ä»¥å¤ªç½‘äº¤æ¢æœºæ˜¯åŸºäºä»¥å¤ªç½‘ä¼ è¾“æ•°æ®çš„äº¤æ¢æœºï¼Œä»¥å¤ªç½‘é‡‡ç”¨å…±äº«æ€»çº¿å‹ä¼ è¾“åª’ä½“æ–¹å¼çš„å±€åŸŸç½‘ã€‚ä»¥å¤ªç½‘äº¤æ¢æœºçš„ç»“æ„æ˜¯æ¯ä¸ªç«¯å£éƒ½ç›´æ¥ä¸ä¸»æœºç›¸è¿ï¼Œå¹¶ä¸”ä¸€èˆ¬éƒ½å·¥ä½œåœ¨å…¨åŒå·¥æ–¹å¼ã€‚äº¤æ¢æœºèƒ½åŒæ—¶è¿é€šè®¸å¤šå¯¹ç«¯å£ï¼Œä½¿æ¯ä¸€å¯¹ç›¸äº’é€šä¿¡çš„ä¸»æœºéƒ½èƒ½åƒç‹¬å é€šä¿¡åª’ä½“é‚£æ ·ï¼Œè¿›è¡Œæ— å†²çªåœ°ä¼ è¾“æ•°æ®ã€‚</p>
<ul>
<li>ä»¥å¤ªç½‘äº¤æ¢æœºçš„æ¯ä¸ªç«¯å£éƒ½ç›´æ¥ä¸ä¸»æœºç›¸è¿ï¼Œå¹¶ä¸”ä¸€èˆ¬éƒ½å·¥ä½œåœ¨å…¨åŒå·¥æ–¹å¼ã€‚</li>
<li>äº¤æ¢æœºèƒ½åŒæ—¶è¿é€šè®¸å¤šå¯¹çš„ç«¯å£ï¼Œä½¿æ¯ä¸€å¯¹ç›¸äº’é€šä¿¡çš„ä¸»æœºéƒ½èƒ½åƒç‹¬å é€šä¿¡åª’ä½“é‚£æ ·ï¼Œè¿›è¡Œæ— å†²çªåœ°ä¼ è¾“æ•°æ®ã€‚</li>
<li>ç”¨æˆ·ç‹¬å ä¼ è¾“åª’ä½“çš„å¸¦å®½ï¼Œè‹¥ä¸€ä¸ªæ¥å£åˆ°ä¸»æœºçš„å¸¦å®½æ˜¯ 10Mbit æ¯ç§’ï¼Œé‚£ä¹ˆæœ‰ 10 ä¸ªæ¥å£çš„äº¤æ¢æœºçš„æ€»å®¹é‡æ˜¯ 100Mbit æ¯ç§’ã€‚è¿™æ˜¯äº¤æ¢æœºçš„æœ€å¤§ä¼˜ç‚¹ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œä¹‹åº”ç”¨å±‚</title>
    <url>/blog/communication/network-application/</url>
    <content><![CDATA[<h2 id="http"><a class="markdownIt-Anchor" href="#http"></a> HTTP</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/application/1551096916007.png!zp"/></div>
<p>è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆè‹±è¯­ï¼šHyperText Transfer Protocolï¼Œç¼©å†™ï¼šHTTPï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼å’Œè¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿçš„åº”ç”¨å±‚åè®®ã€‚HTTP æ˜¯ä¸‡ç»´ç½‘çš„æ•°æ®é€šä¿¡çš„åŸºç¡€ã€‚</p>
<p>è®¾è®¡ HTTP æœ€åˆçš„ç›®çš„æ˜¯ä¸ºäº†æä¾›ä¸€ç§å‘å¸ƒå’Œæ¥æ”¶ HTML é¡µé¢çš„æ–¹æ³•ã€‚é€šè¿‡ HTTP æˆ–è€… HTTPS åè®®è¯·æ±‚çš„èµ„æºç”±ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifiersï¼ŒURIï¼‰æ¥æ ‡è¯†ã€‚</p>
<p>å®‰å…¨å¥—æ¥å­—å±‚è¶…æ–‡æœ¬ä¼ è¾“åè®® HTTPS ä¸ºäº†æ•°æ®ä¼ è¾“çš„å®‰å…¨ï¼ŒHTTPS åœ¨ HTTP çš„åŸºç¡€ä¸ŠåŠ å…¥äº† SSL åè®®ï¼ŒSSL ä¾é è¯ä¹¦æ¥éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ï¼Œå¹¶ä¸ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡åŠ å¯†ã€‚</p>
<blockquote>
<p>ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š<a href="HTTP.md">HTTP</a></p>
</blockquote>
<h2 id="dns"><a class="markdownIt-Anchor" href="#dns"></a> DNS</h2>
<p>åŸŸåæœåŠ¡å™¨ DNS æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæä¾›äº†ä¸»æœºåå’Œ IP åœ°å€ä¹‹é—´ç›¸äº’è½¬æ¢çš„æœåŠ¡ã€‚è¿™é‡Œçš„åˆ†å¸ƒå¼æ•°æ®åº“æ˜¯æŒ‡ï¼Œæ¯ä¸ªç«™ç‚¹åªä¿ç•™å®ƒè‡ªå·±çš„é‚£éƒ¨åˆ†æ•°æ®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/application/1551094759786.png!zp"/></div>
<p>åŸŸåå…·æœ‰å±‚æ¬¡ç»“æ„ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡ä¸ºï¼šæ ¹åŸŸåã€é¡¶çº§åŸŸåã€äºŒçº§åŸŸåã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/application/1551094954067.png!zp"/></div>
<p>DNS å¯ä»¥ä½¿ç”¨ UDP æˆ–è€… TCP è¿›è¡Œä¼ è¾“ï¼Œä½¿ç”¨çš„ç«¯å£å·éƒ½ä¸º 53ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ DNS ä½¿ç”¨ UDP è¿›è¡Œä¼ è¾“ï¼Œè¿™å°±è¦æ±‚åŸŸåè§£æå™¨å’ŒåŸŸåæœåŠ¡å™¨éƒ½å¿…é¡»è‡ªå·±å¤„ç†è¶…æ—¶å’Œé‡ä¼ æ¥ä¿è¯å¯é æ€§ã€‚åœ¨ä¸¤ç§æƒ…å†µä¸‹ä¼šä½¿ç”¨ TCP è¿›è¡Œä¼ è¾“ï¼š</p>
<ul>
<li>å¦‚æœè¿”å›çš„å“åº”è¶…è¿‡çš„ 512 å­—èŠ‚ï¼ˆUDP æœ€å¤§åªæ”¯æŒ 512 å­—èŠ‚çš„æ•°æ®ï¼‰ã€‚</li>
<li>åŒºåŸŸä¼ é€ï¼ˆåŒºåŸŸä¼ é€æ˜¯ä¸»åŸŸåæœåŠ¡å™¨å‘è¾…åŠ©åŸŸåæœåŠ¡å™¨ä¼ é€å˜åŒ–çš„é‚£éƒ¨åˆ†æ•°æ®ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>ğŸ‘‰ æ‰©å±•é˜…è¯»ï¼š<a href="DNS.md">DNS</a></p>
</blockquote>
<h2 id="ftp"><a class="markdownIt-Anchor" href="#ftp"></a> FTP</h2>
<p>æ–‡ä»¶ä¼ é€åè®® FTP ä½¿ç”¨ TCP è¿›è¡Œè¿æ¥ï¼Œå®ƒéœ€è¦ä¸¤ä¸ªè¿æ¥æ¥ä¼ é€ä¸€ä¸ªæ–‡ä»¶ï¼š</p>
<ul>
<li>æ§åˆ¶è¿æ¥ï¼šæœåŠ¡å™¨æ‰“å¼€ç«¯å£å· 21 ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå®¢æˆ·ç«¯ä¸»åŠ¨å»ºç«‹è¿æ¥åï¼Œä½¿ç”¨è¿™ä¸ªè¿æ¥å°†å®¢æˆ·ç«¯çš„å‘½ä»¤ä¼ é€ç»™æœåŠ¡å™¨ï¼Œå¹¶ä¼ å›æœåŠ¡å™¨çš„åº”ç­”ã€‚</li>
<li>æ•°æ®è¿æ¥ï¼šç”¨æ¥ä¼ é€ä¸€ä¸ªæ–‡ä»¶æ•°æ®ã€‚</li>
</ul>
<p>æ ¹æ®æ•°æ®è¿æ¥æ˜¯å¦æ˜¯æœåŠ¡å™¨ç«¯ä¸»åŠ¨å»ºç«‹ï¼ŒFTP æœ‰ä¸»åŠ¨å’Œè¢«åŠ¨ä¸¤ç§æ¨¡å¼ï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/application/1551095440002.png!zp"/></div>
<ul>
<li>ä¸»åŠ¨æ¨¡å¼ï¼šæœåŠ¡å™¨ç«¯ä¸»åŠ¨å»ºç«‹æ•°æ®è¿æ¥ï¼Œå…¶ä¸­æœåŠ¡å™¨ç«¯çš„ç«¯å£å·ä¸º 20ï¼Œå®¢æˆ·ç«¯çš„ç«¯å£å·éšæœºï¼Œä½†æ˜¯å¿…é¡»å¤§äº 1024ï¼Œå› ä¸º 0~1023 æ˜¯ç†ŸçŸ¥ç«¯å£å·ã€‚</li>
<li>è¢«åŠ¨æ¨¡å¼ï¼šå®¢æˆ·ç«¯ä¸»åŠ¨å»ºç«‹æ•°æ®è¿æ¥ï¼Œå…¶ä¸­å®¢æˆ·ç«¯çš„ç«¯å£å·ç”±å®¢æˆ·ç«¯è‡ªå·±æŒ‡å®šï¼ŒæœåŠ¡å™¨ç«¯çš„ç«¯å£å·éšæœºã€‚</li>
</ul>
<p>ä¸»åŠ¨æ¨¡å¼è¦æ±‚å®¢æˆ·ç«¯å¼€æ”¾ç«¯å£å·ç»™æœåŠ¡å™¨ç«¯ï¼Œéœ€è¦å»é…ç½®å®¢æˆ·ç«¯çš„é˜²ç«å¢™ã€‚è¢«åŠ¨æ¨¡å¼åªéœ€è¦æœåŠ¡å™¨ç«¯å¼€æ”¾ç«¯å£å·å³å¯ï¼Œæ— éœ€å®¢æˆ·ç«¯é…ç½®é˜²ç«å¢™ã€‚ä½†æ˜¯è¢«åŠ¨æ¨¡å¼ä¼šå¯¼è‡´æœåŠ¡å™¨ç«¯çš„å®‰å…¨æ€§å‡å¼±ï¼Œå› ä¸ºå¼€æ”¾äº†è¿‡å¤šçš„ç«¯å£å·ã€‚</p>
<p>FTPS æ˜¯ä¸€ç§å¯¹å¸¸ç”¨çš„æ–‡ä»¶ä¼ è¾“åè®®ï¼ˆFTPï¼‰æ·»åŠ ä¼ è¾“å±‚å®‰å…¨ï¼ˆTLSï¼‰å’Œå®‰å…¨å¥—æ¥å±‚ï¼ˆSSLï¼‰åŠ å¯†åè®®æ”¯æŒçš„æ‰©å±•åè®®ã€‚</p>
<h2 id="dhcp"><a class="markdownIt-Anchor" href="#dhcp"></a> DHCP</h2>
<p>åŠ¨æ€ä¸»æœºé…ç½®åè®® DHCP (Dynamic Host Configuration Protocol) æä¾›äº†å³æ’å³ç”¨çš„è¿ç½‘æ–¹å¼ï¼Œç”¨æˆ·ä¸å†éœ€è¦å»æ‰‹åŠ¨é…ç½® IP åœ°å€ç­‰ä¿¡æ¯ã€‚</p>
<p>DHCP é…ç½®çš„å†…å®¹ä¸ä»…æ˜¯ IP åœ°å€ï¼Œè¿˜åŒ…æ‹¬å­ç½‘æ©ç ã€ç½‘å…³ IP åœ°å€ã€‚</p>
<p>DHCP å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘é€ Discover æŠ¥æ–‡ï¼Œè¯¥æŠ¥æ–‡çš„ç›®çš„åœ°å€ä¸º 255.255.255.255:67ï¼Œæºåœ°å€ä¸º 0.0.0.0:68ï¼Œè¢«æ”¾å…¥ UDP ä¸­ï¼Œè¯¥æŠ¥æ–‡è¢«å¹¿æ’­åˆ°åŒä¸€ä¸ªå­ç½‘çš„æ‰€æœ‰ä¸»æœºä¸Šã€‚å¦‚æœå®¢æˆ·ç«¯å’Œ DHCP æœåŠ¡å™¨ä¸åœ¨åŒä¸€ä¸ªå­ç½‘ï¼Œå°±éœ€è¦ä½¿ç”¨ä¸­ç»§ä»£ç†ã€‚</li>
<li>DHCP æœåŠ¡å™¨æ”¶åˆ° Discover æŠ¥æ–‡ä¹‹åï¼Œå‘é€ Offer æŠ¥æ–‡ç»™å®¢æˆ·ç«¯ï¼Œè¯¥æŠ¥æ–‡åŒ…å«äº†å®¢æˆ·ç«¯æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚å› ä¸ºå®¢æˆ·ç«¯å¯èƒ½æ”¶åˆ°å¤šä¸ª DHCP æœåŠ¡å™¨æä¾›çš„ä¿¡æ¯ï¼Œå› æ­¤å®¢æˆ·ç«¯éœ€è¦è¿›è¡Œé€‰æ‹©ã€‚</li>
<li>å¦‚æœå®¢æˆ·ç«¯é€‰æ‹©äº†æŸä¸ª DHCP æœåŠ¡å™¨æä¾›çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å‘é€ Request æŠ¥æ–‡ç»™è¯¥ DHCP æœåŠ¡å™¨ã€‚</li>
<li>DHCP æœåŠ¡å™¨å‘é€ Ack æŠ¥æ–‡ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯æ­¤æ—¶å¯ä»¥ä½¿ç”¨æä¾›ç»™å®ƒçš„ä¿¡æ¯ã€‚</li>
</ol>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/application/1551095610521.png!zp"/></div>
<h2 id="telnet"><a class="markdownIt-Anchor" href="#telnet"></a> TELNET</h2>
<p>è¿œç¨‹ç™»å½•åè®® TELNET ç”¨äºç™»å½•åˆ°è¿œç¨‹ä¸»æœºä¸Šï¼Œå¹¶ä¸”è¿œç¨‹ä¸»æœºä¸Šçš„è¾“å‡ºä¹Ÿä¼šè¿”å›ã€‚</p>
<p>TELNET å¯ä»¥é€‚åº”è®¸å¤šè®¡ç®—æœºå’Œæ“ä½œç³»ç»Ÿçš„å·®å¼‚ï¼Œä¾‹å¦‚ä¸åŒæ“ä½œç³»ç»Ÿç³»ç»Ÿçš„æ¢è¡Œç¬¦å®šä¹‰ã€‚</p>
<h2 id="ç”µå­é‚®ä»¶åè®®"><a class="markdownIt-Anchor" href="#ç”µå­é‚®ä»¶åè®®"></a> ç”µå­é‚®ä»¶åè®®</h2>
<p>ä¸€ä¸ªç”µå­é‚®ä»¶ç³»ç»Ÿç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šç”¨æˆ·ä»£ç†ã€é‚®ä»¶æœåŠ¡å™¨ä»¥åŠé‚®ä»¶åè®®ã€‚</p>
<p>é‚®ä»¶åè®®åŒ…å«å‘é€åè®®å’Œè¯»å–åè®®ï¼Œå‘é€åè®®å¸¸ç”¨ SMTPï¼Œè¯»å–åè®®å¸¸ç”¨ POP3 å’Œ IMAPã€‚</p>
<h3 id="1-smtp"><a class="markdownIt-Anchor" href="#1-smtp"></a> 1. SMTP</h3>
<p>SMTP åªèƒ½å‘é€ ASCII ç ï¼Œè€Œäº’è”ç½‘é‚®ä»¶æ‰©å…… MIME å¯ä»¥å‘é€äºŒè¿›åˆ¶æ–‡ä»¶ã€‚MIME å¹¶æ²¡æœ‰æ”¹åŠ¨æˆ–è€…å–ä»£ SMTPï¼Œè€Œæ˜¯å¢åŠ é‚®ä»¶ä¸»ä½“çš„ç»“æ„ï¼Œå®šä¹‰äº†é ASCII ç çš„ç¼–ç è§„åˆ™ã€‚</p>
<h3 id="2-pop3"><a class="markdownIt-Anchor" href="#2-pop3"></a> 2. POP3</h3>
<p>POP3 çš„ç‰¹ç‚¹æ˜¯åªè¦ç”¨æˆ·ä»æœåŠ¡å™¨ä¸Šè¯»å–äº†é‚®ä»¶ï¼Œå°±æŠŠè¯¥é‚®ä»¶åˆ é™¤ã€‚</p>
<h3 id="3-imap"><a class="markdownIt-Anchor" href="#3-imap"></a> 3. IMAP</h3>
<p>IMAP åè®®ä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸Šçš„é‚®ä»¶ä¿æŒåŒæ­¥ï¼Œå¦‚æœä¸æ‰‹åŠ¨åˆ é™¤é‚®ä»¶ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¸Šçš„é‚®ä»¶ä¹Ÿä¸ä¼šè¢«åˆ é™¤ã€‚IMAP è¿™ç§åšæ³•å¯ä»¥è®©ç”¨æˆ·éšæ—¶éšåœ°å»è®¿é—®æœåŠ¡å™¨ä¸Šçš„é‚®ä»¶ã€‚</p>
<h2 id="å¸¸ç”¨ç«¯å£"><a class="markdownIt-Anchor" href="#å¸¸ç”¨ç«¯å£"></a> å¸¸ç”¨ç«¯å£</h2>
<table>
<thead>
<tr>
<th style="text-align:center">åº”ç”¨</th>
<th style="text-align:center">åº”ç”¨å±‚åè®®</th>
<th style="text-align:center">ç«¯å£å·</th>
<th style="text-align:center">ä¼ è¾“å±‚åè®®</th>
<th style="text-align:center">å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">åŸŸåè§£æ</td>
<td style="text-align:center">DNS</td>
<td style="text-align:center">53</td>
<td style="text-align:center">UDP/TCP</td>
<td style="text-align:center">é•¿åº¦è¶…è¿‡ 512 å­—èŠ‚æ—¶ä½¿ç”¨ TCP</td>
</tr>
<tr>
<td style="text-align:center">åŠ¨æ€ä¸»æœºé…ç½®åè®®</td>
<td style="text-align:center">DHCP</td>
<td style="text-align:center">67/68</td>
<td style="text-align:center">UDP</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ç®€å•ç½‘ç»œç®¡ç†åè®®</td>
<td style="text-align:center">SNMP</td>
<td style="text-align:center">161/162</td>
<td style="text-align:center">UDP</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">æ–‡ä»¶ä¼ é€åè®®</td>
<td style="text-align:center">FTP</td>
<td style="text-align:center">20/21</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">æ§åˆ¶è¿æ¥ 21ï¼Œæ•°æ®è¿æ¥ 20</td>
</tr>
<tr>
<td style="text-align:center">è¿œç¨‹ç»ˆç«¯åè®®</td>
<td style="text-align:center">TELNET</td>
<td style="text-align:center">23</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">è¶…æ–‡æœ¬ä¼ é€åè®®</td>
<td style="text-align:center">HTTP</td>
<td style="text-align:center">80</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ç®€å•é‚®ä»¶ä¼ é€åè®®</td>
<td style="text-align:center">SMTP</td>
<td style="text-align:center">25</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">é‚®ä»¶è¯»å–åè®®</td>
<td style="text-align:center">POP3</td>
<td style="text-align:center">110</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ç½‘é™…æŠ¥æ–‡å­˜å–åè®®</td>
<td style="text-align:center">IMAP</td>
<td style="text-align:center">143</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2 id="web-é¡µé¢è¯·æ±‚è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#web-é¡µé¢è¯·æ±‚è¿‡ç¨‹"></a> Web é¡µé¢è¯·æ±‚è¿‡ç¨‹</h2>
<h3 id="1-dhcp-é…ç½®ä¸»æœºä¿¡æ¯"><a class="markdownIt-Anchor" href="#1-dhcp-é…ç½®ä¸»æœºä¿¡æ¯"></a> 1. DHCP é…ç½®ä¸»æœºä¿¡æ¯</h3>
<ul>
<li>å‡è®¾ä¸»æœºæœ€å¼€å§‹æ²¡æœ‰ IP åœ°å€ä»¥åŠå…¶å®ƒä¿¡æ¯ï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆä½¿ç”¨ DHCP æ¥è·å–ã€‚</li>
<li>ä¸»æœºç”Ÿæˆä¸€ä¸ª DHCP è¯·æ±‚æŠ¥æ–‡ï¼Œå¹¶å°†è¿™ä¸ªæŠ¥æ–‡æ”¾å…¥å…·æœ‰ç›®çš„ç«¯å£ 67 å’Œæºç«¯å£ 68 çš„ UDP æŠ¥æ–‡æ®µä¸­ã€‚</li>
<li>è¯¥æŠ¥æ–‡æ®µåˆ™è¢«æ”¾å…¥åœ¨ä¸€ä¸ªå…·æœ‰å¹¿æ’­ IP ç›®çš„åœ°å€(255.255.255.255) å’Œæº IP åœ°å€ï¼ˆ0.0.0.0ï¼‰çš„ IP æ•°æ®æŠ¥ä¸­ã€‚</li>
<li>è¯¥æ•°æ®æŠ¥åˆ™è¢«æ”¾ç½®åœ¨ MAC å¸§ä¸­ï¼Œè¯¥å¸§å…·æœ‰ç›®çš„åœ°å€ FF:FF:FF:FF:FF:FFï¼Œå°†å¹¿æ’­åˆ°ä¸äº¤æ¢æœºè¿æ¥çš„æ‰€æœ‰è®¾å¤‡ã€‚</li>
<li>è¿æ¥åœ¨äº¤æ¢æœºçš„ DHCP æœåŠ¡å™¨æ”¶åˆ°å¹¿æ’­å¸§ä¹‹åï¼Œä¸æ–­åœ°å‘ä¸Šåˆ†è§£å¾—åˆ° IP æ•°æ®æŠ¥ã€UDP æŠ¥æ–‡æ®µã€DHCP è¯·æ±‚æŠ¥æ–‡ï¼Œä¹‹åç”Ÿæˆ DHCP ACK æŠ¥æ–‡ï¼Œè¯¥æŠ¥æ–‡åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šIP åœ°å€ã€DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€é»˜è®¤ç½‘å…³è·¯ç”±å™¨çš„ IP åœ°å€å’Œå­ç½‘æ©ç ã€‚è¯¥æŠ¥æ–‡è¢«æ”¾å…¥ UDP æŠ¥æ–‡æ®µä¸­ï¼ŒUDP æŠ¥æ–‡æ®µæœ‰è¢«æ”¾å…¥ IP æ•°æ®æŠ¥ä¸­ï¼Œæœ€åæ”¾å…¥ MAC å¸§ä¸­ã€‚</li>
<li>è¯¥å¸§çš„ç›®çš„åœ°å€æ˜¯è¯·æ±‚ä¸»æœºçš„ MAC åœ°å€ï¼Œå› ä¸ºäº¤æ¢æœºå…·æœ‰è‡ªå­¦ä¹ èƒ½åŠ›ï¼Œä¹‹å‰ä¸»æœºå‘é€äº†å¹¿æ’­å¸§ä¹‹åå°±è®°å½•äº† MAC åœ°å€åˆ°å…¶è½¬å‘æ¥å£çš„äº¤æ¢è¡¨é¡¹ï¼Œå› æ­¤ç°åœ¨äº¤æ¢æœºå°±å¯ä»¥ç›´æ¥çŸ¥é“åº”è¯¥å‘å“ªä¸ªæ¥å£å‘é€è¯¥å¸§ã€‚</li>
<li>ä¸»æœºæ”¶åˆ°è¯¥å¸§åï¼Œä¸æ–­åˆ†è§£å¾—åˆ° DHCP æŠ¥æ–‡ã€‚ä¹‹åå°±é…ç½®å®ƒçš„ IP åœ°å€ã€å­ç½‘æ©ç å’Œ DNS æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œå¹¶åœ¨å…¶ IP è½¬å‘è¡¨ä¸­å®‰è£…é»˜è®¤ç½‘å…³ã€‚</li>
</ul>
<h3 id="2-arp-è§£æ-mac-åœ°å€"><a class="markdownIt-Anchor" href="#2-arp-è§£æ-mac-åœ°å€"></a> 2. ARP è§£æ MAC åœ°å€</h3>
<ul>
<li>ä¸»æœºé€šè¿‡æµè§ˆå™¨ç”Ÿæˆä¸€ä¸ª TCP å¥—æ¥å­—ï¼Œå¥—æ¥å­—å‘ HTTP æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ã€‚ä¸ºäº†ç”Ÿæˆè¯¥å¥—æ¥å­—ï¼Œä¸»æœºéœ€è¦çŸ¥é“ç½‘ç«™çš„åŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚</li>
<li>ä¸»æœºç”Ÿæˆä¸€ä¸ª DNS æŸ¥è¯¢æŠ¥æ–‡ï¼Œè¯¥æŠ¥æ–‡å…·æœ‰ 53 å·ç«¯å£ï¼Œå› ä¸º DNS æœåŠ¡å™¨çš„ç«¯å£å·æ˜¯ 53ã€‚</li>
<li>è¯¥ DNS æŸ¥è¯¢æŠ¥æ–‡è¢«æ”¾å…¥ç›®çš„åœ°å€ä¸º DNS æœåŠ¡å™¨ IP åœ°å€çš„ IP æ•°æ®æŠ¥ä¸­ã€‚</li>
<li>è¯¥ IP æ•°æ®æŠ¥è¢«æ”¾å…¥ä¸€ä¸ªä»¥å¤ªç½‘å¸§ä¸­ï¼Œè¯¥å¸§å°†å‘é€åˆ°ç½‘å…³è·¯ç”±å™¨ã€‚</li>
<li>DHCP è¿‡ç¨‹åªçŸ¥é“ç½‘å…³è·¯ç”±å™¨çš„ IP åœ°å€ï¼Œä¸ºäº†è·å–ç½‘å…³è·¯ç”±å™¨çš„ MAC åœ°å€ï¼Œéœ€è¦ä½¿ç”¨ ARP åè®®ã€‚</li>
<li>ä¸»æœºç”Ÿæˆä¸€ä¸ªåŒ…å«ç›®çš„åœ°å€ä¸ºç½‘å…³è·¯ç”±å™¨ IP åœ°å€çš„ ARP æŸ¥è¯¢æŠ¥æ–‡ï¼Œå°†è¯¥ ARP æŸ¥è¯¢æŠ¥æ–‡æ”¾å…¥ä¸€ä¸ªå…·æœ‰å¹¿æ’­ç›®çš„åœ°å€ï¼ˆFF:FF:FF:FF:FF:FFï¼‰çš„ä»¥å¤ªç½‘å¸§ä¸­ï¼Œå¹¶å‘äº¤æ¢æœºå‘é€è¯¥ä»¥å¤ªç½‘å¸§ï¼Œäº¤æ¢æœºå°†è¯¥å¸§è½¬å‘ç»™æ‰€æœ‰çš„è¿æ¥è®¾å¤‡ï¼ŒåŒ…æ‹¬ç½‘å…³è·¯ç”±å™¨ã€‚</li>
<li>ç½‘å…³è·¯ç”±å™¨æ¥æ”¶åˆ°è¯¥å¸§åï¼Œä¸æ–­å‘ä¸Šåˆ†è§£å¾—åˆ° ARP æŠ¥æ–‡ï¼Œå‘ç°å…¶ä¸­çš„ IP åœ°å€ä¸å…¶æ¥å£çš„ IP åœ°å€åŒ¹é…ï¼Œå› æ­¤å°±å‘é€ä¸€ä¸ª ARP å›ç­”æŠ¥æ–‡ï¼ŒåŒ…å«äº†å®ƒçš„ MAC åœ°å€ï¼Œå‘å›ç»™ä¸»æœºã€‚</li>
</ul>
<h3 id="3-dns-è§£æåŸŸå"><a class="markdownIt-Anchor" href="#3-dns-è§£æåŸŸå"></a> 3. DNS è§£æåŸŸå</h3>
<ul>
<li>çŸ¥é“äº†ç½‘å…³è·¯ç”±å™¨çš„ MAC åœ°å€ä¹‹åï¼Œå°±å¯ä»¥ç»§ç»­ DNS çš„è§£æè¿‡ç¨‹äº†ã€‚</li>
<li>ç½‘å…³è·¯ç”±å™¨æ¥æ”¶åˆ°åŒ…å« DNS æŸ¥è¯¢æŠ¥æ–‡çš„ä»¥å¤ªç½‘å¸§åï¼ŒæŠ½å–å‡º IP æ•°æ®æŠ¥ï¼Œå¹¶æ ¹æ®è½¬å‘è¡¨å†³å®šè¯¥ IP æ•°æ®æŠ¥åº”è¯¥è½¬å‘çš„è·¯ç”±å™¨ã€‚</li>
<li>å› ä¸ºè·¯ç”±å™¨å…·æœ‰å†…éƒ¨ç½‘å…³åè®®ï¼ˆRIPã€OSPFï¼‰å’Œå¤–éƒ¨ç½‘å…³åè®®ï¼ˆBGPï¼‰è¿™ä¸¤ç§è·¯ç”±é€‰æ‹©åè®®ï¼Œå› æ­¤è·¯ç”±è¡¨ä¸­å·²ç»é…ç½®äº†ç½‘å…³è·¯ç”±å™¨åˆ°è¾¾ DNS æœåŠ¡å™¨çš„è·¯ç”±è¡¨é¡¹ã€‚</li>
<li>åˆ°è¾¾ DNS æœåŠ¡å™¨ä¹‹åï¼ŒDNS æœåŠ¡å™¨æŠ½å–å‡º DNS æŸ¥è¯¢æŠ¥æ–‡ï¼Œå¹¶åœ¨ DNS æ•°æ®åº“ä¸­æŸ¥æ‰¾å¾…è§£æçš„åŸŸåã€‚</li>
<li>æ‰¾åˆ° DNS è®°å½•ä¹‹åï¼Œå‘é€ DNS å›ç­”æŠ¥æ–‡ï¼Œå°†è¯¥å›ç­”æŠ¥æ–‡æ”¾å…¥ UDP æŠ¥æ–‡æ®µä¸­ï¼Œç„¶åæ”¾å…¥ IP æ•°æ®æŠ¥ä¸­ï¼Œé€šè¿‡è·¯ç”±å™¨åå‘è½¬å‘å›ç½‘å…³è·¯ç”±å™¨ï¼Œå¹¶ç»è¿‡ä»¥å¤ªç½‘äº¤æ¢æœºåˆ°è¾¾ä¸»æœºã€‚</li>
</ul>
<h3 id="4-http-è¯·æ±‚é¡µé¢"><a class="markdownIt-Anchor" href="#4-http-è¯·æ±‚é¡µé¢"></a> 4. HTTP è¯·æ±‚é¡µé¢</h3>
<ul>
<li>æœ‰äº† HTTP æœåŠ¡å™¨çš„ IP åœ°å€ä¹‹åï¼Œä¸»æœºå°±èƒ½å¤Ÿç”Ÿæˆ TCP å¥—æ¥å­—ï¼Œè¯¥å¥—æ¥å­—å°†ç”¨äºå‘ Web æœåŠ¡å™¨å‘é€ HTTP GET æŠ¥æ–‡ã€‚</li>
<li>åœ¨ç”Ÿæˆ TCP å¥—æ¥å­—ä¹‹å‰ï¼Œå¿…é¡»å…ˆä¸ HTTP æœåŠ¡å™¨è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹æ¥å»ºç«‹è¿æ¥ã€‚ç”Ÿæˆä¸€ä¸ªå…·æœ‰ç›®çš„ç«¯å£ 80 çš„ TCP SYN æŠ¥æ–‡æ®µï¼Œå¹¶å‘ HTTP æœåŠ¡å™¨å‘é€è¯¥æŠ¥æ–‡æ®µã€‚</li>
<li>HTTP æœåŠ¡å™¨æ”¶åˆ°è¯¥æŠ¥æ–‡æ®µä¹‹åï¼Œç”Ÿæˆ TCP SYN ACK æŠ¥æ–‡æ®µï¼Œå‘å›ç»™ä¸»æœºã€‚</li>
<li>è¿æ¥å»ºç«‹ä¹‹åï¼Œæµè§ˆå™¨ç”Ÿæˆ HTTP GET æŠ¥æ–‡ï¼Œå¹¶äº¤ä»˜ç»™ HTTP æœåŠ¡å™¨ã€‚</li>
<li>HTTP æœåŠ¡å™¨ä» TCP å¥—æ¥å­—è¯»å– HTTP GET æŠ¥æ–‡ï¼Œç”Ÿæˆä¸€ä¸ª HTTP å“åº”æŠ¥æ–‡ï¼Œå°† Web é¡µé¢å†…å®¹æ”¾å…¥æŠ¥æ–‡ä¸»ä½“ä¸­ï¼Œå‘å›ç»™ä¸»æœºã€‚</li>
<li>æµè§ˆå™¨æ”¶åˆ° HTTP å“åº”æŠ¥æ–‡åï¼ŒæŠ½å–å‡º Web é¡µé¢å†…å®¹ï¼Œä¹‹åè¿›è¡Œæ¸²æŸ“ï¼Œæ˜¾ç¤º Web é¡µé¢ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆç†ç¼–æ’æŠ€æœ¯æ–‡æ¡£</title>
    <url>/blog/efficiency/style/doc-style/</url>
    <content><![CDATA[<blockquote>
<p>æ–‡æ¡£é‡‡ç”¨ Markdown è¯­æ³•ä¹¦å†™ã€‚</p>
<p>ğŸ“š ã€Œå‚è€ƒã€Markdown è¯­æ³•å¯ä»¥å‚è€ƒï¼š</p>
<ul>
<li><a href="https://github.com/guodongxiaren/README" target="_blank" rel="noopener">https://github.com/guodongxiaren/README</a></li>
<li><a href="https://github.com/tchapi/markdown-cheatsheet" target="_blank" rel="noopener">https://github.com/tchapi/markdown-cheatsheet</a></li>
</ul>
</blockquote>
<h2 id="1-æ ‡é¢˜"><a class="markdownIt-Anchor" href="#1-æ ‡é¢˜"></a> 1. æ ‡é¢˜</h2>
<h3 id="11-æ ‡é¢˜å±‚çº§"><a class="markdownIt-Anchor" href="#11-æ ‡é¢˜å±‚çº§"></a> 1.1. æ ‡é¢˜å±‚çº§</h3>
<p>æ ‡é¢˜åˆ†ä¸ºå››çº§ã€‚</p>
<ol>
<li>ä¸€çº§æ ‡é¢˜ï¼šæ–‡ç« çš„æ ‡é¢˜</li>
<li>äºŒçº§æ ‡é¢˜ï¼šæ–‡ç« å†…å®¹çš„å¤§æ ‡é¢˜</li>
<li>ä¸‰çº§æ ‡é¢˜ï¼šäºŒçº§æ ‡é¢˜ä¸‹ä¸€çº§çš„æ ‡é¢˜</li>
<li>å››çº§æ ‡é¢˜ï¼šä¸‰çº§æ ‡é¢˜ä¸‹ä¸€çº§çš„æ ‡é¢˜</li>
</ol>
<h3 id="12-æ ‡é¢˜åŸåˆ™"><a class="markdownIt-Anchor" href="#12-æ ‡é¢˜åŸåˆ™"></a> 1.2. æ ‡é¢˜åŸåˆ™</h3>
<ul>
<li>ä¸€ç¯‡æ–‡ç« ä¸­åº”è¯¥å°½åŠ›é¿å…åŒåæ ‡é¢˜ã€‚</li>
<li>ä¸€çº§æ ‡é¢˜ä¸‹ï¼Œä¸èƒ½ç›´æ¥å‡ºç°ä¸‰çº§æ ‡é¢˜ã€‚</li>
<li>æ ‡é¢˜è¦é¿å…å­¤ç«‹ç¼–å·ï¼ˆå³åŒçº§æ ‡é¢˜åªæœ‰ä¸€ä¸ªï¼‰ã€‚</li>
<li>ä¸‹çº§æ ‡é¢˜ä¸é‡å¤ä¸Šä¸€çº§æ ‡é¢˜çš„å†…å®¹ã€‚</li>
<li>è°¨æ…ä½¿ç”¨å››çº§æ ‡é¢˜ï¼Œå°½é‡é¿å…å‡ºç°ï¼Œä¿æŒå±‚çº§çš„ç®€å•å’Œé˜²æ­¢å‡ºç°è¿‡äºå¤æ‚çš„ç« èŠ‚ã€‚å¦‚æœä¸‰çº§æ ‡é¢˜ä¸‹æœ‰å¹¶åˆ—æ€§çš„å†…å®¹ï¼Œå»ºè®®åªä½¿ç”¨é¡¹ç›®åˆ—è¡¨ï¼ˆItem listï¼‰ã€‚</li>
</ul>
<h2 id="2-æ–‡æœ¬"><a class="markdownIt-Anchor" href="#2-æ–‡æœ¬"></a> 2. æ–‡æœ¬</h2>
<h3 id="21-å­—é—´è·"><a class="markdownIt-Anchor" href="#21-å­—é—´è·"></a> 2.1. å­—é—´è·</h3>
<p>å…¨è§’ä¸­æ–‡å­—ç¬¦ä¸åŠè§’è‹±æ–‡å­—ç¬¦ä¹‹é—´ï¼Œåº”æœ‰ä¸€ä¸ªåŠè§’ç©ºæ ¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šæœ¬æ–‡ä»‹ç»å¦‚ä½•å¿«é€Ÿå¯åŠ¨Windowsç³»ç»Ÿã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šæœ¬æ–‡ä»‹ç»å¦‚ä½•å¿«é€Ÿå¯åŠ¨ Windows ç³»ç»Ÿã€‚</span><br></pre></td></tr></table></figure>
<p>å…¨è§’ä¸­æ–‡å­—ç¬¦ä¸åŠè§’é˜¿æ‹‰ä¼¯æ•°å­—ä¹‹é—´ï¼Œæœ‰æ²¡æœ‰åŠè§’ç©ºæ ¼éƒ½å¯ï¼Œä½†å¿…é¡»ä¿è¯é£æ ¼ç»Ÿä¸€ï¼Œä¸èƒ½ä¸¤ç§é£æ ¼æ··æ‚ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">æ­£ä¾‹ï¼š<span class="number">2011</span>å¹´<span class="number">5</span>æœˆ<span class="number">15</span>æ—¥ï¼Œæˆ‘è®¢è´­äº†<span class="number">5</span>å°ç¬”è®°æœ¬ç”µè„‘ä¸<span class="number">10</span>å°å¹³æ¿ç”µè„‘ã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼š<span class="number">2011</span> å¹´ <span class="number">5</span> æœˆ <span class="number">15</span> æ—¥ï¼Œæˆ‘è®¢è´­äº† <span class="number">5</span> å°ç¬”è®°æœ¬ç”µè„‘ä¸ <span class="number">10</span> å°å¹³æ¿ç”µè„‘ã€‚</span><br></pre></td></tr></table></figure>
<p>åŠè§’çš„ç™¾åˆ†å·ï¼Œè§†åŒé˜¿æ‹‰ä¼¯æ•°å­—ã€‚</p>
<p>è‹±æ–‡å•ä½è‹¥ä¸ç¿»è¯‘ï¼Œå•ä½å‰çš„é˜¿æ‹‰ä¼¯æ•°å­—ä¸å•ä½é—´ä¸ç•™ç©ºæ ¼ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šä¸€éƒ¨å®¹é‡ä¸º <span class="number">16</span> GB çš„æ™ºèƒ½æ‰‹æœº</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šä¸€éƒ¨å®¹é‡ä¸º <span class="number">16</span>GB çš„æ™ºèƒ½æ‰‹æœº</span><br></pre></td></tr></table></figure>
<p>åŠè§’è‹±æ–‡å­—ç¬¦å’ŒåŠè§’é˜¿æ‹‰ä¼¯æ•°å­—ï¼Œä¸å…¨è§’æ ‡ç‚¹ç¬¦å·ä¹‹é—´ä¸ç•™ç©ºæ ¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šä»–çš„ç”µè„‘æ˜¯ MacBook Air ã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šä»–çš„ç”µè„‘æ˜¯ MacBook Airã€‚</span><br></pre></td></tr></table></figure>
<h3 id="22-å¥å­"><a class="markdownIt-Anchor" href="#22-å¥å­"></a> 2.2. å¥å­</h3>
<ul>
<li>é¿å…ä½¿ç”¨é•¿å¥ã€‚ä¸€ä¸ªå¥å­å»ºè®®ä¸è¶…è¿‡ 100 å­—æˆ–è€…æ­£æ–‡çš„ 3 è¡Œã€‚</li>
<li>å°½é‡ä½¿ç”¨ç®€å•å¥å’Œå¹¶åˆ—å¥ï¼Œé¿å…ä½¿ç”¨å¤åˆå¥ã€‚</li>
</ul>
<h3 id="23-å†™ä½œé£æ ¼"><a class="markdownIt-Anchor" href="#23-å†™ä½œé£æ ¼"></a> 2.3. å†™ä½œé£æ ¼</h3>
<p>å°½é‡ä¸ä½¿ç”¨è¢«åŠ¨è¯­æ€ï¼Œæ”¹ä¸ºä½¿ç”¨ä¸»åŠ¨è¯­æ€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šå‡å¦‚æ­¤è½¯ä»¶å°šæœªè¢«å®‰è£…ï¼Œ</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šå‡å¦‚å°šæœªå®‰è£…è¿™ä¸ªè½¯ä»¶ï¼Œ</span><br></pre></td></tr></table></figure>
<p>ä¸ä½¿ç”¨éæ­£å¼çš„è¯­è¨€é£æ ¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šLady Gaga çš„æ¼”å”±ä¼šçœŸæ˜¯é…·æ¯™äº†ï¼Œä»æ²¡çœ‹è¿‡è¿™ä¹ˆç»™åŠ›çš„è¡¨æ¼”ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šæ— æ³•å‚åŠ æœ¬æ¬¡æ´»åŠ¨ï¼Œæˆ‘æ·±æ„Ÿé—æ†¾ã€‚</span><br></pre></td></tr></table></figure>
<p>ç”¨å¯¹â€œçš„â€ã€â€œåœ°â€ã€â€œå¾—â€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¥¹éœ²å‡ºäº†å¼€å¿ƒçš„ç¬‘å®¹ã€‚</span><br><span class="line">ï¼ˆå½¢å®¹è¯ï¼‹çš„ï¼‹åè¯ï¼‰</span><br><span class="line"></span><br><span class="line">å¥¹å¼€å¿ƒåœ°ç¬‘äº†ã€‚</span><br><span class="line">ï¼ˆå‰¯è¯ï¼‹åœ°ï¼‹åŠ¨è¯ï¼‰</span><br><span class="line"></span><br><span class="line">å¥¹ç¬‘å¾—å¾ˆå¼€å¿ƒã€‚</span><br><span class="line">ï¼ˆåŠ¨è¯ï¼‹å¾—ï¼‹å‰¯è¯ï¼‰</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ä»£è¯æ—¶ï¼ˆæ¯”å¦‚â€œå…¶â€ã€â€œè¯¥â€ã€â€œæ­¤â€ã€â€œè¿™â€ç­‰è¯ï¼‰ï¼Œå¿…é¡»æ˜ç¡®æŒ‡ä»£çš„å†…å®¹ï¼Œä¿è¯åªæœ‰ä¸€ä¸ªå«ä¹‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šä»ç®¡ç†ç³»ç»Ÿå¯ä»¥ç›‘è§†ä¸­ç»§ç³»ç»Ÿå’Œå—å…¶ç›´æ¥æ§åˆ¶çš„åˆ†é…ç³»ç»Ÿã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šä»ç®¡ç†ç³»ç»Ÿå¯ä»¥ç›‘è§†ä¸¤ä¸ªç³»ç»Ÿï¼šä¸­ç»§ç³»ç»Ÿå’Œå—ä¸­ç»§ç³»ç»Ÿç›´æ¥æ§åˆ¶çš„åˆ†é…ç³»ç»Ÿã€‚</span><br></pre></td></tr></table></figure>
<p>åè¯å‰ä¸è¦ä½¿ç”¨è¿‡å¤šçš„å½¢å®¹è¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šæ­¤è®¾å¤‡çš„ä½¿ç”¨å¿…é¡»åœ¨æ¥å—è¿‡æœ¬å…¬å¸ä¸¾åŠçš„æ­£å¼çš„è®¾å¤‡åŸ¹è®­çš„æŠ€å¸ˆçš„æŒ‡å¯¼ä¸‹è¿›è¡Œã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šæ­¤è®¾å¤‡å¿…é¡»åœ¨æŠ€å¸ˆçš„æŒ‡å¯¼ä¸‹ä½¿ç”¨ï¼Œä¸”æŒ‡å¯¼æŠ€å¸ˆå¿…é¡»æ¥å—è¿‡ç”±æœ¬å…¬å¸ä¸¾åŠçš„æ­£å¼è®¾å¤‡åŸ¹è®­ã€‚</span><br></pre></td></tr></table></figure>
<p>å•ä¸ªå¥å­çš„é•¿åº¦å°½é‡ä¿æŒåœ¨ 20 ä¸ªå­—ä»¥å†…ï¼›20 ï½ 29 ä¸ªå­—çš„å¥å­ï¼Œå¯ä»¥æ¥å—ï¼›30 ï½ 39 ä¸ªå­—çš„å¥å­ï¼Œè¯­ä¹‰å¿…é¡»æ˜ç¡®ï¼Œæ‰èƒ½æ¥å—ï¼›å¤šäº 40 ä¸ªå­—çš„å¥å­ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸èƒ½æ¥å—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šæœ¬äº§å“é€‚ç”¨äºä»ç”±ä¸€å°æœåŠ¡å™¨è¿›è¡ŒåŠ¨ä½œæ§åˆ¶çš„å•ä¸€èŠ‚ç‚¹ç»“æ„åˆ°ç”±å¤šå°æœåŠ¡å™¨è¿›è¡ŒåŠ¨ä½œæ§åˆ¶çš„å¹¶è¡Œå¤„ç†ç¨‹åºç»“æ„ç­‰å¤šç§ä½“ç³»ç»“æ„ã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šæœ¬äº§å“é€‚ç”¨äºå¤šç§ä½“ç³»ç»“æ„ã€‚æ— è®ºæ˜¯ç”±ä¸€å°æœåŠ¡å™¨ï¼ˆå•ä¸€èŠ‚ç‚¹ç»“æ„ï¼‰ï¼Œè¿˜æ˜¯ç”±å¤šå°æœåŠ¡å™¨ï¼ˆå¹¶è¡Œå¤„ç†ç»“æ„ï¼‰è¿›è¡ŒåŠ¨ä½œæ§åˆ¶ï¼Œå‡å¯ä»¥ä½¿ç”¨æœ¬äº§å“ã€‚</span><br></pre></td></tr></table></figure>
<p>åŒæ ·ä¸€ä¸ªæ„æ€ï¼Œå°½é‡ä½¿ç”¨è‚¯å®šå¥è¡¨è¾¾ï¼Œä¸ä½¿ç”¨å¦å®šå¥è¡¨è¾¾ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šè¯·ç¡®è®¤æ²¡æœ‰æ¥é€šè£…ç½®çš„ç”µæºã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šè¯·ç¡®è®¤è£…ç½®çš„ç”µæºå·²å…³é—­ã€‚</span><br></pre></td></tr></table></figure>
<p>é¿å…ä½¿ç”¨åŒé‡å¦å®šå¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šæ²¡æœ‰åˆ é™¤æƒé™çš„ç”¨æˆ·ï¼Œä¸èƒ½åˆ é™¤æ­¤æ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šç”¨æˆ·å¿…é¡»æ‹¥æœ‰åˆ é™¤æƒé™ï¼Œæ‰èƒ½åˆ é™¤æ­¤æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="24-è‹±æ–‡å¤„ç†"><a class="markdownIt-Anchor" href="#24-è‹±æ–‡å¤„ç†"></a> 2.4. è‹±æ–‡å¤„ç†</h3>
<p>è‹±æ–‡åŸæ–‡å¦‚æœä½¿ç”¨äº†å¤æ•°å½¢å¼ï¼Œç¿»è¯‘æˆä¸­æ–‡æ—¶ï¼Œåº”è¯¥å°†å…¶è¿˜åŸä¸ºå•æ•°å½¢å¼ã€‚</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">è‹±æ–‡ï¼šâ‹¯information stored <span class="keyword">in</span> random <span class="keyword">access</span> memory (RAMs)â‹¯</span><br><span class="line"></span><br><span class="line">ä¸­æ–‡ï¼šâ€¦â€¦å­˜å‚¨åœ¨éšæœºå­˜å–å­˜å‚¨å™¨ï¼ˆRAMï¼‰é‡Œçš„ä¿¡æ¯â€¦â€¦</span><br></pre></td></tr></table></figure>
<p>å¤–æ–‡ç¼©å†™å¯ä»¥ä½¿ç”¨åŠè§’åœ†ç‚¹(<code>.</code>)è¡¨ç¤ºç¼©å†™ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">U</span><span class="selector-class">.S</span><span class="selector-class">.A</span>.</span><br><span class="line"><span class="selector-tag">Apple</span>, <span class="selector-tag">Inc</span>.</span><br></pre></td></tr></table></figure>
<p>è¡¨ç¤ºä¸­æ–‡æ—¶ï¼Œè‹±æ–‡çœç•¥å·ï¼ˆ<code>â‹¯</code>ï¼‰åº”æ”¹ä¸ºä¸­æ–‡çœç•¥å·ï¼ˆ<code>â€¦â€¦</code>ï¼‰ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">è‹±æ–‡ï¼š<span class="number">5</span> minutes laterâ‹¯</span><br><span class="line"></span><br><span class="line">ä¸­æ–‡ï¼š<span class="number">5</span> åˆ†é’Ÿè¿‡å»äº†â‹¯â‹¯</span><br></pre></td></tr></table></figure>
<p>è‹±æ–‡ä¹¦åæˆ–ç”µå½±åæ”¹ç”¨ä¸­æ–‡è¡¨è¾¾æ—¶ï¼ŒåŒå¼•å·åº”æ”¹ä¸ºä¹¦åå·ã€‚</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">è‹±æ–‡ï¼š<span class="keyword">He</span> published <span class="keyword">an</span> article entitled <span class="string">"The Future of the Aviation"</span>.</span><br><span class="line"></span><br><span class="line">ä¸­æ–‡ï¼šä»–å‘è¡¨äº†ä¸€ç¯‡åä¸ºã€Šèˆªç©ºä¸šçš„æœªæ¥ã€‹çš„æ–‡ç« ã€‚</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€æ¬¡å‡ºç°è‹±æ–‡è¯æ±‡æ—¶ï¼Œåœ¨æ‹¬å·ä¸­ç»™å‡ºä¸­æ–‡æ ‡æ³¨ã€‚æ­¤åå†æ¬¡å‡ºç°æ—¶ï¼Œç›´æ¥ä½¿ç”¨è‹±æ–‡ç¼©å†™å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">IOCï¼ˆInternational Olympic Committeeï¼Œå›½é™…å¥¥æ—åŒ¹å…‹å§”å‘˜ä¼šï¼‰ã€‚è¿™æ ·å®šä¹‰åï¼Œä¾¿å¯ä»¥ç›´æ¥ä½¿ç”¨â€œIOCâ€äº†ã€‚</span><br></pre></td></tr></table></figure>
<p>ä¸“æœ‰åè¯ä¸­æ¯ä¸ªè¯ç¬¬ä¸€ä¸ªå­—æ¯å‡åº”å¤§å†™ï¼Œéä¸“æœ‰åè¯åˆ™ä¸éœ€è¦å¤§å†™ã€‚</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">â€œAmerican Association <span class="keyword">of</span> Physicists <span class="keyword">in</span> Medicineâ€ï¼ˆç¾å›½åŒ»å­¦ç‰©ç†å­¦å®¶åä¼šï¼‰æ˜¯ä¸“æœ‰åè¯ï¼Œéœ€è¦å¤§å†™ã€‚</span><br><span class="line"></span><br><span class="line">â€œonline <span class="keyword">transaction</span> processingâ€ï¼ˆåœ¨çº¿äº‹åŠ¡å¤„ç†ï¼‰ä¸æ˜¯ä¸“æœ‰åè¯ï¼Œä¸åº”å¤§å†™ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="3-æ®µè½"><a class="markdownIt-Anchor" href="#3-æ®µè½"></a> 3. æ®µè½</h2>
<h3 id="31-æ®µè½åŸåˆ™"><a class="markdownIt-Anchor" href="#31-æ®µè½åŸåˆ™"></a> 3.1. æ®µè½åŸåˆ™</h3>
<ul>
<li>ä¸€ä¸ªæ®µè½åªèƒ½æœ‰ä¸€ä¸ªä¸»é¢˜ï¼Œæˆ–ä¸€ä¸ªä¸­å¿ƒå¥å­ã€‚</li>
<li>æ®µè½çš„ä¸­å¿ƒå¥å­æ”¾åœ¨æ®µé¦–ï¼Œå¯¹å…¨æ®µå†…å®¹è¿›è¡Œæ¦‚è¿°ã€‚åé¢é™ˆè¿°çš„å¥å­ä¸ºæ ¸å¿ƒå¥æœåŠ¡ã€‚</li>
<li>ä¸€ä¸ªæ®µè½çš„é•¿åº¦ä¸èƒ½è¶…è¿‡ä¸ƒè¡Œï¼Œæœ€ä½³æ®µè½é•¿åº¦å°äºç­‰äºå››è¡Œã€‚</li>
<li>æ®µè½çš„å¥å­è¯­æ°”è¦ä½¿ç”¨é™ˆè¿°å’Œè‚¯å®šè¯­æ°”ï¼Œé¿å…ä½¿ç”¨æ„Ÿå¹è¯­æ°”ã€‚</li>
<li>æ®µè½ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªç©ºè¡Œéš”å¼€ã€‚</li>
<li>æ®µè½å¼€å¤´ä¸è¦ç•™å‡ºç©ºç™½å­—ç¬¦ã€‚</li>
</ul>
<h3 id="32-å¼•ç”¨"><a class="markdownIt-Anchor" href="#32-å¼•ç”¨"></a> 3.2. å¼•ç”¨</h3>
<p>å¼•ç”¨ç¬¬ä¸‰æ–¹å†…å®¹æ—¶ï¼Œåº”æ³¨æ˜å‡ºå¤„ã€‚</p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">One <span class="keyword">man</span>â€™s constant <span class="keyword">is</span> another <span class="keyword">man</span>â€™s variable. â€” Alan Perlis</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯å…¨ç¯‡è½¬è½½ï¼Œè¯·åœ¨å…¨æ–‡å¼€å¤´æ˜¾è‘—ä½ç½®æ³¨æ˜ä½œè€…å’Œå‡ºå¤„ï¼Œå¹¶é“¾æ¥è‡³åŸæ–‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æœ¬æ–‡è½¬è½½è‡ª WikiQuote</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨å¤–éƒ¨å›¾ç‰‡æ—¶ï¼Œå¿…é¡»åœ¨å›¾ç‰‡ä¸‹æ–¹æˆ–æ–‡æœ«æ ‡æ˜æ¥æºã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æœ¬æ–‡éƒ¨åˆ†å›¾ç‰‡æ¥è‡ª Wikipedia</span><br></pre></td></tr></table></figure>
<h3 id="33-å¼ºè°ƒ"><a class="markdownIt-Anchor" href="#33-å¼ºè°ƒ"></a> 3.3. å¼ºè°ƒ</h3>
<p>ä¸€äº›ç‰¹æ®Šçš„å¼ºè°ƒå†…å®¹å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼ä¹¦å†™ï¼š</p>
<blockquote>
<p>ğŸ”” ã€æ³¨æ„ã€</p>
</blockquote>
<blockquote>
<p>ğŸ’¡ ã€æç¤ºã€</p>
</blockquote>
<blockquote>
<p>ğŸ“š ã€å‚è€ƒã€</p>
</blockquote>
<h2 id="4-æ•°å€¼"><a class="markdownIt-Anchor" href="#4-æ•°å€¼"></a> 4. æ•°å€¼</h2>
<h3 id="41-åŠè§’æ•°å­—"><a class="markdownIt-Anchor" href="#41-åŠè§’æ•°å­—"></a> 4.1. åŠè§’æ•°å­—</h3>
<p>æ•°å­—ä¸€å¾‹ä½¿ç”¨åŠè§’å½¢å¼ï¼Œä¸å¾—ä½¿ç”¨å…¨è§’å½¢å¼ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼š è¿™ä»¶å•†å“çš„ä»·æ ¼æ˜¯ï¼‘ï¼ï¼ï¼å…ƒã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼š è¿™ä»¶å•†å“çš„ä»·æ ¼æ˜¯ <span class="number">1000</span> å…ƒã€‚</span><br></pre></td></tr></table></figure>
<h3 id="42-åƒåˆ†å·"><a class="markdownIt-Anchor" href="#42-åƒåˆ†å·"></a> 4.2. åƒåˆ†å·</h3>
<p>æ•°å€¼ä¸ºåƒä½ä»¥ä¸Šï¼Œåº”æ·»åŠ åƒåˆ†å·ï¼ˆåŠè§’é€—å·ï¼‰ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">XXX å…¬å¸çš„å®æ”¶èµ„æœ¬ä¸º RMB1,<span class="number">258</span>,<span class="number">000</span>ã€‚</span><br></pre></td></tr></table></figure>
<p>å¯¹äº 4 ï½ 6 ä½çš„æ•°å€¼ï¼Œåƒåˆ†å·æ˜¯é€‰ç”¨çš„ï¼Œæ¯”å¦‚<code>1000</code>å’Œ<code>1,000</code>éƒ½å¯ä»¥æ¥å—ã€‚å¯¹äº 7 ä½åŠä»¥ä¸Šçš„æ•°å€¼ï¼Œåƒåˆ†å·æ˜¯å¿…é¡»çš„ã€‚</p>
<p>å¤šä½å°æ•°è¦ä»å°æ•°ç‚¹åä»å·¦å‘å³æ·»åŠ åƒåˆ†å·ï¼Œæ¯”å¦‚<code>4.234,345</code>ã€‚</p>
<h3 id="43-è´§å¸"><a class="markdownIt-Anchor" href="#43-è´§å¸"></a> 4.3. è´§å¸</h3>
<p>è´§å¸åº”ä¸ºé˜¿æ‹‰ä¼¯æ•°å­—ï¼Œå¹¶åœ¨æ•°å­—å‰å†™å‡ºè´§å¸ç¬¦å·ï¼Œæˆ–åœ¨æ•°å­—åå†™å‡ºè´§å¸ä¸­æ–‡åç§°ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">$<span class="number">1</span>,<span class="number">000</span></span><br><span class="line"><span class="number">1</span>,<span class="number">000</span> ç¾å…ƒ</span><br></pre></td></tr></table></figure>
<h3 id="44-æ•°å€¼èŒƒå›´"><a class="markdownIt-Anchor" href="#44-æ•°å€¼èŒƒå›´"></a> 4.4. æ•°å€¼èŒƒå›´</h3>
<p>è¡¨ç¤ºæ•°å€¼èŒƒå›´æ—¶ï¼Œç”¨<code>ï½</code>è¿æ¥ã€‚å‚è§ã€Šæ ‡ç‚¹ç¬¦å·ã€‹ä¸€èŠ‚çš„â€œè¿æ¥å·â€éƒ¨åˆ†ã€‚</p>
<p>å¸¦æœ‰å•ä½æˆ–ç™¾åˆ†å·æ—¶ï¼Œä¸¤ä¸ªæ•°å­—éƒ½è¦åŠ ä¸Šå•ä½æˆ–ç™¾åˆ†å·ï¼Œä¸èƒ½åªåŠ åé¢ä¸€ä¸ªã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼š<span class="number">132</span>ï½<span class="number">234</span>kg</span><br><span class="line">æ­£ä¾‹ï¼š<span class="number">132</span>kgï½<span class="number">234</span>kg</span><br><span class="line"></span><br><span class="line">åä¾‹ï¼š<span class="number">67</span>ï½<span class="number">89</span>%</span><br><span class="line">æ­£ä¾‹ï¼š<span class="number">67</span>%ï½<span class="number">89</span>%</span><br></pre></td></tr></table></figure>
<h3 id="45-å˜åŒ–ç¨‹åº¦çš„è¡¨ç¤ºæ³•"><a class="markdownIt-Anchor" href="#45-å˜åŒ–ç¨‹åº¦çš„è¡¨ç¤ºæ³•"></a> 4.5. å˜åŒ–ç¨‹åº¦çš„è¡¨ç¤ºæ³•</h3>
<p>æ•°å­—çš„å¢åŠ è¦ä½¿ç”¨â€œå¢åŠ äº†â€ã€â€œå¢åŠ åˆ°â€ã€‚â€œäº†â€è¡¨ç¤ºå¢é‡ï¼Œâ€œåˆ°â€è¡¨ç¤ºå®šé‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¢åŠ åˆ°è¿‡å»çš„ä¸¤å€</span><br><span class="line">ï¼ˆè¿‡å»ä¸ºä¸€ï¼Œç°åœ¨ä¸ºäºŒï¼‰</span><br><span class="line"></span><br><span class="line">å¢åŠ äº†ä¸¤å€</span><br><span class="line">ï¼ˆè¿‡å»ä¸ºä¸€ï¼Œç°åœ¨ä¸ºä¸‰ï¼‰</span><br></pre></td></tr></table></figure>
<p>æ•°å­—çš„å‡å°‘è¦ä½¿ç”¨â€œé™ä½äº†â€ã€â€œé™ä½åˆ°â€ã€‚â€œäº†â€è¡¨ç¤ºå¢é‡ï¼Œâ€œåˆ°â€è¡¨ç¤ºå®šé‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é™ä½åˆ°ç™¾åˆ†ä¹‹å…«å</span><br><span class="line">ï¼ˆå®šé¢æ˜¯ä¸€ç™¾ï¼Œç°åœ¨æ˜¯å…«åï¼‰</span><br><span class="line"></span><br><span class="line">é™ä½äº†ç™¾åˆ†ä¹‹å…«å</span><br><span class="line">ï¼ˆåŸæ¥æ˜¯ä¸€ç™¾ï¼Œç°åœ¨æ˜¯äºŒåï¼‰</span><br></pre></td></tr></table></figure>
<p>ä¸èƒ½ç”¨â€œé™ä½ N å€â€æˆ–â€œå‡å°‘ N å€â€çš„è¡¨ç¤ºæ³•ï¼Œè¦ç”¨â€œé™ä½ç™¾åˆ†ä¹‹å‡ â€æˆ–â€œå‡å°‘ç™¾åˆ†ä¹‹å‡ â€ã€‚å› ä¸ºå‡å°‘ï¼ˆæˆ–é™ä½ï¼‰ä¸€å€è¡¨ç¤ºæ•°å€¼åŸæ¥ä¸ºä¸€ç™¾ï¼Œç°åœ¨ç­‰äºé›¶ã€‚</p>
<h2 id="5-ç¬¦å·"><a class="markdownIt-Anchor" href="#5-ç¬¦å·"></a> 5. ç¬¦å·</h2>
<h3 id="51-ç¬¦å·åŸåˆ™"><a class="markdownIt-Anchor" href="#51-ç¬¦å·åŸåˆ™"></a> 5.1. ç¬¦å·åŸåˆ™</h3>
<ul>
<li>ä¸­æ–‡è¯­å¥çš„æ ‡ç‚¹ç¬¦å·ï¼Œå‡åº”è¯¥é‡‡å–å…¨è§’ç¬¦å·ï¼Œè¿™æ ·å¯ä»¥ä¿è¯è§†è§‰çš„ä¸€è‡´ã€‚</li>
<li>å¦‚æœæ•´å¥ä¸ºè‹±æ–‡ï¼Œåˆ™è¯¥å¥ä½¿ç”¨è‹±æ–‡/åŠè§’æ ‡ç‚¹ã€‚</li>
<li>å¥å·ã€é—®å·ã€å¹å·ã€é€—å·ã€é¡¿å·ã€åˆ†å·å’Œå†’å·ä¸å¾—å‡ºç°åœ¨ä¸€è¡Œä¹‹é¦–ã€‚</li>
</ul>
<h3 id="52-å¥å·"><a class="markdownIt-Anchor" href="#52-å¥å·"></a> 5.2. å¥å·</h3>
<p>ä¸­æ–‡è¯­å¥ä¸­çš„ç»“å°¾å¤„åº”è¯¥ç”¨å…¨è§’å¥å·ï¼ˆ<code>ã€‚</code>ï¼‰ã€‚</p>
<p>å¥å­æœ«å°¾ç”¨æ‹¬å·åŠ æ³¨æ—¶ï¼Œå¥å·åº”åœ¨æ‹¬å·ä¹‹å¤–ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šå…³äºæ–‡ä»¶çš„è¾“å‡ºï¼Œè¯·å‚ç…§ç¬¬ <span class="number">1.3</span> èŠ‚ï¼ˆè§ç¬¬ <span class="number">26</span> é¡µã€‚ï¼‰</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šå…³äºæ–‡ä»¶çš„è¾“å‡ºï¼Œè¯·å‚ç…§ç¬¬ <span class="number">1.3</span> èŠ‚ï¼ˆè§ç¬¬ <span class="number">26</span> é¡µï¼‰ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="53-é€—å·"><a class="markdownIt-Anchor" href="#53-é€—å·"></a> 5.3. é€—å·</h3>
<p>é€—å·<code>ï¼Œ</code>è¡¨ç¤ºå¥å­å†…éƒ¨çš„ä¸€èˆ¬æ€§åœé¡¿ã€‚</p>
<p>æ³¨æ„é¿å…â€œä¸€é€—åˆ°åº•â€ï¼Œå³æ•´ä¸ªæ®µè½é™¤äº†ç»“å°¾ï¼Œå…¨éƒ¨åœé¡¿éƒ½ä½¿ç”¨é€—å·ã€‚</p>
<h3 id="54-é¡¿å·"><a class="markdownIt-Anchor" href="#54-é¡¿å·"></a> 5.4. é¡¿å·</h3>
<p>å¥å­å†…éƒ¨çš„å¹¶åˆ—è¯ï¼Œåº”è¯¥ç”¨å…¨è§’é¡¿å·(<code>ã€</code>) åˆ†éš”ï¼Œè€Œä¸ç”¨é€—å·ï¼Œå³ä½¿å¹¶åˆ—è¯æ˜¯è‹±è¯­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šæˆ‘æœ€æ¬£èµçš„ç§‘æŠ€å…¬å¸æœ‰ Google, Facebook, è…¾è®¯, é˜¿é‡Œå’Œç™¾åº¦ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šæˆ‘æœ€æ¬£èµçš„ç§‘æŠ€å…¬å¸æœ‰ Googleã€Facebookã€è…¾è®¯ã€é˜¿é‡Œå’Œç™¾åº¦ç­‰ã€‚</span><br></pre></td></tr></table></figure>
<p>è‹±æ–‡å¥å­ä¸­ï¼Œå¹¶åˆ—è¯è¯­ä¹‹é—´ä½¿ç”¨åŠè§’é€—å·ï¼ˆ<code>,</code>ï¼‰åˆ†éš”ã€‚</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šMicrosoft Office includes Word, Excel, PowerPoint, Outlook <span class="keyword">and </span>other components.</span><br></pre></td></tr></table></figure>
<h3 id="55-åˆ†å·"><a class="markdownIt-Anchor" href="#55-åˆ†å·"></a> 5.5. åˆ†å·</h3>
<p>åˆ†å·<code>ï¼›</code>è¡¨ç¤ºå¤å¥å†…éƒ¨å¹¶åˆ—åˆ†å¥ä¹‹é—´çš„åœé¡¿ã€‚</p>
<h3 id="56-å¼•å·"><a class="markdownIt-Anchor" href="#56-å¼•å·"></a> 5.6. å¼•å·</h3>
<p>å¼•ç”¨æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å…¨è§’åŒå¼•å·ï¼ˆ<code>â€œ â€</code>ï¼‰ï¼Œæ³¨æ„å‰ååŒå¼•å·ä¸åŒã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šè®¸å¤šäººéƒ½è®¤ä¸ºå®¢æˆ·æœåŠ¡çš„æ ¸å¿ƒæ˜¯â€œå‹å¥½â€å’Œâ€œä¸“ä¸šâ€ã€‚</span><br></pre></td></tr></table></figure>
<p>å¼•å·é‡Œé¢è¿˜è¦ç”¨å¼•å·æ—¶ï¼Œå¤–é¢ä¸€å±‚ç”¨åŒå¼•å·ï¼Œé‡Œé¢ä¸€å±‚ç”¨å•å¼•å·ï¼ˆ<code>â€˜ â€™</code>ï¼‰ï¼Œæ³¨æ„å‰åå•å¼•å·ä¸åŒã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šé²å‹ƒè§£é‡Šé“ï¼šâ€œæˆ‘è¦æ”¾éŸ³ä¹ï¼Œå¯è¨åˆ©è¯´ï¼Œâ€˜ä¸è¡Œï¼â€™ã€‚â€</span><br></pre></td></tr></table></figure>
<h3 id="57-åœ†æ‹¬å·"><a class="markdownIt-Anchor" href="#57-åœ†æ‹¬å·"></a> 5.7. åœ†æ‹¬å·</h3>
<p>è¡¥å……è¯´æ˜æ—¶ï¼Œä½¿ç”¨å…¨è§’åœ†æ‹¬å·<code>ï¼ˆï¼‰</code>ï¼Œæ‹¬å·å‰åä¸åŠ ç©ºæ ¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šè¯·ç¡®è®¤æ‰€æœ‰çš„è¿æ¥ï¼ˆç”µç¼†å’Œæ¥æ’ä»¶ï¼‰å‡å®‰è£…ç‰¢å›ºã€‚</span><br></pre></td></tr></table></figure>
<h3 id="58-å†’å·"><a class="markdownIt-Anchor" href="#58-å†’å·"></a> 5.8. å†’å·</h3>
<p>å…¨è§’å†’å·ï¼ˆ<code>ï¼š</code>ï¼‰å¸¸ç”¨åœ¨éœ€è¦è§£é‡Šçš„è¯è¯­åè¾¹ï¼Œå¼•å‡ºè§£é‡Šå’Œè¯´æ˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šè¯·ç¡®è®¤ä»¥ä¸‹å‡ é¡¹å†…å®¹ï¼šæ—¶é—´ã€åœ°ç‚¹ã€æ´»åŠ¨åç§°ï¼Œä»¥åŠæ¥å®¾æ•°é‡ã€‚</span><br></pre></td></tr></table></figure>
<p>è¡¨ç¤ºæ—¶é—´æ—¶ï¼Œåº”ä½¿ç”¨åŠè§’å†’å·ï¼ˆ<code>:</code>ï¼‰ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šæ—©ä¸Š <span class="number">8</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure>
<h3 id="59-çœç•¥å·"><a class="markdownIt-Anchor" href="#59-çœç•¥å·"></a> 5.9. çœç•¥å·</h3>
<p>çœç•¥å·<code>â€¦â€¦</code>è¡¨ç¤ºè¯­å¥æœªå®Œã€æˆ–è€…è¯­æ°”çš„ä¸è¿ç»­ã€‚å®ƒå ä¸¤ä¸ªæ±‰å­—ç©ºé—´ã€åŒ…å«å…­ä¸ªçœç•¥ç‚¹ï¼Œä¸è¦ä½¿ç”¨<code>ã€‚ã€‚ã€‚</code>æˆ–<code>...</code>ç­‰éæ ‡å‡†å½¢å¼ã€‚</p>
<p>çœç•¥å·ä¸åº”ä¸â€œç­‰â€è¿™ä¸ªè¯ä¸€èµ·ä½¿ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼šæˆ‘ä»¬ä¸ºä¼šé¤å‡†å¤‡äº†é¦™è•‰ã€è‹¹æœã€æ¢¨â€¦ç­‰å„è‰²æ°´æœã€‚</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šæˆ‘ä»¬ä¸ºä¼šé¤å‡†å¤‡äº†å„è‰²æ°´æœï¼Œæœ‰é¦™è•‰ã€è‹¹æœã€æ¢¨â€¦â€¦</span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼šæˆ‘ä»¬ä¸ºä¼šé¤å‡†å¤‡äº†é¦™è•‰ã€è‹¹æœã€æ¢¨ç­‰å„è‰²æ°´æœã€‚</span><br></pre></td></tr></table></figure>
<h3 id="510-æ„Ÿå¹å·"><a class="markdownIt-Anchor" href="#510-æ„Ÿå¹å·"></a> 5.10. æ„Ÿå¹å·</h3>
<p>åº”è¯¥ä½¿ç”¨å¹³é™çš„è¯­æ°”å™è¿°ï¼Œå°½é‡é¿å…ä½¿ç”¨æ„Ÿå¹å·<code>ï¼</code>ã€‚</p>
<p>ä¸å¾—å¤šä¸ªæ„Ÿå¹å·è¿ç”¨ï¼Œæ¯”å¦‚<code>ï¼ï¼</code>å’Œ<code>!!!</code>ã€‚</p>
<h3 id="511-ç ´æŠ˜å·"><a class="markdownIt-Anchor" href="#511-ç ´æŠ˜å·"></a> 5.11. ç ´æŠ˜å·</h3>
<p>ç ´æŠ˜å·<code>â€”â€”â€”â€”</code>ä¸€èˆ¬ç”¨äºåšè¿›ä¸€æ­¥è§£é‡Šã€‚ç ´æŠ˜å·åº”å ä¸¤ä¸ªæ±‰å­—çš„ä½ç½®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šç›´è§‰â€”â€”â€”â€”å°½ç®¡å®ƒå¹¶ä¸æ€»æ˜¯å¯é çš„â€”â€”â€”â€”å‘Šè¯‰æˆ‘ï¼Œè¿™äº‹å¯èƒ½å‡ºäº†äº›é—®é¢˜ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="512-è¿æ¥å·"><a class="markdownIt-Anchor" href="#512-è¿æ¥å·"></a> 5.12. è¿æ¥å·</h3>
<p>è¿æ¥å·ç”¨äºè¿æ¥ä¸¤ä¸ªç±»ä¼¼çš„è¯ã€‚</p>
<p>ä»¥ä¸‹åœºåˆåº”è¯¥ä½¿ç”¨ç›´çº¿è¿æ¥å·ï¼ˆ<code>-</code>ï¼‰ï¼Œå ä¸€ä¸ªåŠè§’å­—ç¬¦çš„ä½ç½®ã€‚</p>
<ul>
<li>ä¸¤ä¸ªåè¯çš„å¤åˆ</li>
<li>å›¾è¡¨ç¼–å·</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šæ°§åŒ–-è¿˜åŸååº”</span><br><span class="line"></span><br><span class="line">ä¾‹å¥ï¼šå›¾ <span class="number">1</span><span class="number">-1</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹åœºåˆåº”è¯¥ä½¿ç”¨æ³¢æµªè¿æ¥å·ï¼ˆ<code>ï½</code>ï¼‰ï¼Œå ä¸€ä¸ªå…¨è§’å­—ç¬¦çš„ä½ç½®ã€‚</p>
<ul>
<li>æ•°å€¼èŒƒå›´ï¼ˆä¾‹å¦‚æ—¥æœŸã€æ—¶é—´æˆ–æ•°å­—ï¼‰</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼š<span class="number">2009</span> å¹´ï½<span class="number">2011</span> å¹´</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œæ³¢æµªè¿æ¥å·å‰åä¸¤ä¸ªå€¼éƒ½åº”è¯¥åŠ ä¸Šå•ä½ã€‚</p>
<p>æ³¢æµªè¿æ¥å·ä¹Ÿå¯ä»¥ç”¨æ±‰å­—â€œè‡³â€ä»£æ›¿ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">ä¾‹å¥ï¼šå‘¨å›´æ¸©åº¦ï¼š<span class="number">-20</span>Â°C è‡³ <span class="number">-10</span>Â°C</span><br></pre></td></tr></table></figure>
<h2 id="6-ç»“æ„"><a class="markdownIt-Anchor" href="#6-ç»“æ„"></a> 6. ç»“æ„</h2>
<h3 id="61-ç›®å½•ç»“æ„"><a class="markdownIt-Anchor" href="#61-ç›®å½•ç»“æ„"></a> 6.1. ç›®å½•ç»“æ„</h3>
<p>æŠ€æœ¯æ‰‹å†Œç›®å½•ç»“æ„æ˜¯ä¸€éƒ¨å®Œæ•´çš„ä¹¦ï¼Œå»ºè®®é‡‡ç”¨ä¸‹é¢çš„ç»“æ„ã€‚</p>
<ul>
<li><strong>ç®€ä»‹</strong>ï¼ˆIntroductionï¼‰ - [å¿…é€‰][ç›®å½•|æ–‡ä»¶] æä¾›å¯¹äº§å“å’Œæ–‡æ¡£æœ¬èº«çš„æ€»ä½“çš„ã€æ‰¼è¦çš„è¯´æ˜</li>
<li><strong>å…¥é—¨ç¯‡</strong>ï¼ˆQuickstartï¼‰ - [å¯é€‰][æ–‡ä»¶] å¦‚ä½•æœ€å¿«é€Ÿåœ°ä½¿ç”¨äº§å“</li>
<li><strong>åŸºç¡€ç¯‡</strong>ï¼ˆBasicsï¼‰ - [å¿…é€‰][ç›®å½•] åˆç§°â€ä½¿ç”¨ç¯‡â€œï¼Œæä¾›åˆçº§çš„ä½¿ç”¨æ•™ç¨‹
<ul>
<li><strong>ç¯å¢ƒå‡†å¤‡</strong>ï¼ˆPrerequisiteï¼‰ - [å¯é€‰][æ–‡ä»¶] è½¯ä»¶ä½¿ç”¨éœ€è¦æ»¡è¶³çš„å‰ç½®æ¡ä»¶</li>
<li><strong>å®‰è£…</strong>ï¼ˆInstallationï¼‰ - [å¯é€‰][æ–‡ä»¶] è½¯ä»¶çš„å®‰è£…æ–¹æ³•</li>
<li><strong>é…ç½®</strong>ï¼ˆConfigurationï¼‰ - [å¯é€‰][ç›®å½•|æ–‡ä»¶] è½¯ä»¶çš„é…ç½®</li>
<li><strong>ç‰¹æ€§</strong>ï¼ˆFeatureï¼‰ - [å¿…é€‰][ç›®å½•|æ–‡ä»¶] è½¯ä»¶çš„åŠŸèƒ½ç‰¹æ€§</li>
</ul>
</li>
<li><strong>è¿›é˜¶ç¯‡</strong>ï¼ˆAdvancedï¼‰ - [å¯é€‰][ç›®å½•] åˆç§°â€å¼€å‘ç¯‡â€œï¼Œæä¾›ä¸­é«˜çº§çš„å¼€å‘æ•™ç¨‹
<ul>
<li><strong>åŸç†</strong>ï¼ˆPrincipleï¼‰ - [å¯é€‰][ç›®å½•|æ–‡ä»¶] è½¯ä»¶çš„åŸç†</li>
<li><strong>è®¾è®¡</strong>ï¼ˆDesignï¼‰ - [å¯é€‰][ç›®å½•|æ–‡ä»¶] è½¯ä»¶çš„è®¾è®¡ï¼Œå¦‚ï¼šæ¶æ„ã€è®¾è®¡æ€æƒ³ç­‰</li>
</ul>
</li>
<li><strong>å®æˆ˜ç¯‡</strong>ï¼ˆActionï¼‰ - [å¯é€‰][ç›®å½•] æä¾›ä¸€äº›å…·æœ‰å®æˆ˜æ„ä¹‰çš„ç¤ºä¾‹è¯´æ˜</li>
<li><strong>API</strong>ï¼ˆAPIï¼‰ - [å¯é€‰][ç›®å½•|æ–‡ä»¶] è½¯ä»¶ API çš„é€ä¸€ä»‹ç»</li>
<li><strong>å¸¸è§é—®é¢˜</strong>ï¼ˆFAQï¼‰ - [å¯é€‰][ç›®å½•|æ–‡ä»¶] å¸¸è§é—®é¢˜è§£ç­”</li>
<li><strong>é™„å½•</strong>ï¼ˆAppendixï¼‰ - [å¯é€‰][ç›®å½•] ä¸å±äºæ•™ç¨‹æœ¬èº«ã€ä½†å¯¹é˜…è¯»æ•™ç¨‹æœ‰å¸®åŠ©çš„å†…å®¹
<ul>
<li><strong>å‘½ä»¤</strong>ï¼ˆCommandï¼‰ - [å¯é€‰][ç›®å½•] å‘½ä»¤</li>
<li><strong>èµ„æº</strong>ï¼ˆResourceï¼‰ - [å¿…é€‰][æ–‡ä»¶] èµ„æº</li>
<li><strong>æœ¯è¯­</strong>ï¼ˆGlossaryï¼‰ - [å¯é€‰][æ–‡ä»¶] åè¯è§£é‡Š</li>
<li><strong>æŠ€å·§</strong>ï¼ˆRecipeï¼‰ - [å¯é€‰][æ–‡ä»¶] æœ€ä½³å®è·µ</li>
<li><strong>ç‰ˆæœ¬</strong>ï¼ˆChangelogï¼‰ - [å¯é€‰][æ–‡ä»¶] ç‰ˆæœ¬è¯´æ˜</li>
<li><strong>åé¦ˆ</strong>ï¼ˆFeedbackï¼‰ - [å¯é€‰][æ–‡ä»¶] åé¦ˆæ–¹å¼</li>
</ul>
</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸¤ä¸ªçœŸå®èŒƒä¾‹ï¼Œå¯å‚è€ƒã€‚</p>
<ul>
<li><a href="http://redux.js.org/index.html" target="_blank" rel="noopener">Redux æ‰‹å†Œ</a></li>
<li><a href="http://flight-manual.atom.io/" target="_blank" rel="noopener">Atom æ‰‹å†Œ</a></li>
</ul>
<h3 id="62-æ–‡ä»¶å"><a class="markdownIt-Anchor" href="#62-æ–‡ä»¶å"></a> 6.2. æ–‡ä»¶å</h3>
<p>æ–‡æ¡£çš„æ–‡ä»¶åä¸å¾—å«æœ‰ç©ºæ ¼ã€‚</p>
<p>æ–‡ä»¶åå¿…é¡»ä½¿ç”¨åŠè§’å­—ç¬¦ï¼Œä¸å¾—ä½¿ç”¨å…¨è§’å­—ç¬¦ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œä¸­æ–‡ä¸èƒ½ç”¨äºæ–‡ä»¶åã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼š åè¯è§£é‡Š<span class="selector-class">.md</span></span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼š <span class="selector-tag">glossary</span><span class="selector-class">.md</span></span><br></pre></td></tr></table></figure>
<p>æ–‡ä»¶åå»ºè®®åªä½¿ç”¨å°å†™å­—æ¯ï¼Œä¸ä½¿ç”¨å¤§å†™å­—æ¯ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼š<span class="selector-tag">TroubleShooting</span><span class="selector-class">.md</span></span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼š<span class="selector-tag">troubleshooting</span><span class="selector-class">.md</span></span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†é†’ç›®ï¼ŒæŸäº›è¯´æ˜æ–‡ä»¶çš„æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨å¤§å†™å­—æ¯ï¼Œæ¯”å¦‚<code>README</code>ã€<code>LICENSE</code>ã€‚</p>
<p>æ–‡ä»¶ååŒ…å«å¤šä¸ªå•è¯æ—¶ï¼Œå•è¯ä¹‹é—´å»ºè®®ä½¿ç”¨åŠè§’çš„è¿è¯çº¿ï¼ˆ<code>-</code>ï¼‰åˆ†éš”ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">åä¾‹ï¼š<span class="selector-tag">advanced_usage</span><span class="selector-class">.md</span></span><br><span class="line"></span><br><span class="line">æ­£ä¾‹ï¼š<span class="selector-tag">advanced-usage</span><span class="selector-class">.md</span></span><br></pre></td></tr></table></figure>
<h2 id="7-emoji"><a class="markdownIt-Anchor" href="#7-emoji"></a> 7. Emoji</h2>
<p>åœ¨ markdown æ–‡æ¡£ä¸­ï¼Œæ™®éä¼šä½¿ç”¨ emojiï¼Œå¸®åŠ©ç†è§£å†…å®¹ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ»¥ç”¨ emojiï¼Œå¯èƒ½ä¼šé€‚å¾—å…¶åã€‚</p>
<p>è¿™é‡Œï¼Œå°†ä¸€äº›æ¯”è¾ƒçº¦å®šä¿—æˆçš„ emoji è¡¨æƒ…ä½¿ç”¨åœºæ™¯åˆ—ä¸¾ä¸€ä¸‹ï¼š</p>
<ul>
<li>ğŸ’¡ æç¤º - [æ¨è]</li>
<li>ğŸ”” æ³¨æ„ã€è­¦å‘Š - [æ¨è]</li>
<li>â­• æ­£ç¡® - [æ¨è]</li>
<li>âŒ é”™è¯¯ - [æ¨è]</li>
<li>â“ é—®é¢˜ - [æ¨è]</li>
<li>â›” ç¦æ­¢ - [æ¨è]</li>
<li>ğŸš§ æœªå®Œå¾…ç»­ã€æœ‰å¾…è¡¥å…… - [æ¨è]</li>
<li>ğŸ“š å‚è€ƒã€å‚è€ƒèµ„æ–™ - [å¯é€‰]</li>
<li>âŒ¨ æºç  - [å¯é€‰]</li>
</ul>
<h2 id="8-å‚è€ƒ"><a class="markdownIt-Anchor" href="#8-å‚è€ƒ"></a> 8. å‚è€ƒ</h2>
<ul>
<li><a href="http://wenku.baidu.com/view/23cc1a6527d3240c8447efbf.html" target="_blank" rel="noopener">äº§å“æ‰‹å†Œä¸­æ–‡å†™ä½œè§„èŒƒ</a>, by åä¸º</li>
<li><a href="http://docs.daocloud.io/write-docs/format" target="_blank" rel="noopener">å†™ä½œè§„èŒƒå’Œæ ¼å¼è§„èŒƒ</a>, by DaoCloud</li>
<li><a href="http://www.hitachi-tc.co.jp/company/thesis/thesis.pdf" target="_blank" rel="noopener">æŠ€æœ¯å†™ä½œæŠ€å·§åœ¨æ—¥æ±‰ç¿»è¯‘ä¸­çš„åº”ç”¨</a>, by åˆ˜æ–¹</li>
<li><a href="https://www.lengoo.de/documents/styleguides/lengoo_styleguide_ZH.pdf" target="_blank" rel="noopener">ç®€ä½“ä¸­æ–‡è§„èŒƒæŒ‡å—</a>, by lengoo</li>
<li><a href="https://open.leancloud.cn/copywriting-style-guide.html" target="_blank" rel="noopener">æ–‡æ¡£é£æ ¼æŒ‡å—</a>, by LeanCloud</li>
<li><a href="https://docs.google.com/document/d/1R8lMCPf6zCD5KEA8ekZ5knK77iw9J-vJ6vEopPemqZM/edit" target="_blank" rel="noopener">è±Œè±†èšæ–‡æ¡ˆé£æ ¼æŒ‡å—</a>, by è±Œè±†èš</li>
<li><a href="https://github.com/sparanoid/chinese-copywriting-guidelines" target="_blank" rel="noopener">ä¸­æ–‡æ–‡æ¡ˆæ’ç‰ˆæŒ‡åŒ—</a>, by sparanoid</li>
<li><a href="http://w3c.github.io/clreq/" target="_blank" rel="noopener">ä¸­æ–‡æ’ç‰ˆéœ€æ±‚</a>, by W3C</li>
<li><a href="http://www.ruanyifeng.com/blog/2017/02/filename-should-be-lowercase.html" target="_blank" rel="noopener">ä¸ºä»€ä¹ˆæ–‡ä»¶åè¦å°å†™ï¼Ÿ</a>, by é˜®ä¸€å³°</li>
</ul>
]]></content>
      <categories>
        <category>æ•ˆç‡æå‡</category>
        <category>è§„èŒƒ</category>
      </categories>
      <tags>
        <tag>æ•ˆç‡æå‡</tag>
        <tag>è§„èŒƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆç†å¯¹æ–‡æ¡£è¿›è¡Œå½’ç±»</title>
    <url>/blog/efficiency/style/dir-style/</url>
    <content><![CDATA[<blockquote>
<p>ä½œä¸ºç¨‹åºå‘˜ï¼Œæƒ³å¿…æ¯ä¸ªäººéƒ½ä¼šæœ‰å¤§é‡çš„èµ„æ–™ã€æ•°æ®ã€‚æŒ‰ç…§æ¡ç†æ¸…æ™°çš„ç›®å½•ç»“æ„å»åˆ†ç±»åŒ–å­˜å‚¨ï¼Œååˆ†æœ‰åŠ©äºç®¡ç†æ–‡ä»¶ã€‚</p>
</blockquote>
<h2 id="ç›®å½•ç»“æ„"><a class="markdownIt-Anchor" href="#ç›®å½•ç»“æ„"></a> ç›®å½•ç»“æ„</h2>
<p>ä»¥ä¸‹æ˜¯æˆ‘ä¸ªäººæ•´ç†çš„ç›®å½•ç»“æ„ï¼š</p>
<figure class="highlight capnproto"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ Codes           <span class="comment">#ä»£ç ç›®å½•</span></span><br><span class="line">â”‚   â”œâ”€â”€ Other       <span class="comment">#ç¬¬ä¸‰æ–¹ä»£ç ç›®å½•</span></span><br><span class="line">â”‚   â”œâ”€â”€ My          <span class="comment">#ä¸ªäººä»£ç ç›®å½•</span></span><br><span class="line">â”‚   â””â”€â”€ Work        <span class="comment">#å·¥ä½œä»£ç ç›®å½•</span></span><br><span class="line">â”œâ”€â”€ <span class="built_in">Data</span>            <span class="comment">#æ•°æ®ç›®å½•</span></span><br><span class="line">â”œâ”€â”€ Downloads       <span class="comment">#ä¸‹è½½æ–‡ä»¶ç›®å½•</span></span><br><span class="line">â”œâ”€â”€ Docs            <span class="comment">#æ–‡æ¡£ç›®å½•</span></span><br><span class="line">â”‚   â”œâ”€â”€ Books       <span class="comment">#ç”µå­ä¹¦ç›®å½•</span></span><br><span class="line">â”‚   â”œâ”€â”€ My          <span class="comment">#ä¸ªäººæ–‡æ¡£ç›®å½•</span></span><br><span class="line">â”‚   â””â”€â”€ Work        <span class="comment">#å·¥ä½œæ–‡æ¡£ç›®å½•</span></span><br><span class="line">â”œâ”€â”€ Movies          <span class="comment">#è§†é¢‘ç›®å½•</span></span><br><span class="line">â”œâ”€â”€ Music           <span class="comment">#éŸ³ä¹ç›®å½•</span></span><br><span class="line">â”œâ”€â”€ Pictures        <span class="comment">#å›¾ç‰‡ç›®å½•</span></span><br><span class="line">â”œâ”€â”€ Public          <span class="comment">#å…±äº«ç›®å½•</span></span><br><span class="line">â”œâ”€â”€ Temp            <span class="comment">#ä¸´æ—¶æ–‡ä»¶ç›®å½•</span></span><br><span class="line">â””â”€â”€ Tools           <span class="comment">#å·¥å…·è½¯ä»¶ç›®å½•</span></span><br><span class="line">    â””â”€â”€ Packages    <span class="comment">#å®‰è£…åŒ…ç›®å½•</span></span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šå¦‚æœæ‚¨ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿæ˜¯ Mac è¿™ç§å¯ä»¥ä¸ºç›®å½•æˆ–æ–‡ä»¶æ·»åŠ  tag çš„æ“ä½œç³»ç»Ÿï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½æ›´ç»†è‡´åŒ–çš„ç®¡ç†ã€‚</p>
<h2 id="2-æ–‡ä»¶ç®¡ç†è½¯ä»¶"><a class="markdownIt-Anchor" href="#2-æ–‡ä»¶ç®¡ç†è½¯ä»¶"></a> 2. æ–‡ä»¶ç®¡ç†è½¯ä»¶</h2>
<blockquote>
<p>é€‰ç”¨ä¾¿åˆ©çš„æ–‡ä»¶ç®¡ç†è½¯ä»¶ï¼Œå¯ä»¥è®©ä½ çš„æ–‡ä»¶ç®¡ç†å¦‚è™æ·»ç¿¼ã€‚è¿™é‡Œæ¨èå‡ æ¬¾ç»å…¸çš„æ–‡ä»¶ç®¡ç†å·¥å…·ã€‚</p>
</blockquote>
<h3 id="21-clover"><a class="markdownIt-Anchor" href="#21-clover"></a> 2.1. Clover</h3>
<blockquote>
<p><a href="http://cn.ejie.me/" target="_blank" rel="noopener">Clover</a> æ˜¯ Windows Explorer èµ„æºç®¡ç†å™¨çš„ä¸€ä¸ªæ‰©å±•ï¼Œä¸ºå…¶å¢åŠ ç±»ä¼¼è°·æ­Œ Chrome æµè§ˆå™¨çš„å¤šæ ‡ç­¾é¡µåŠŸèƒ½ã€‚</p>
</blockquote>
<div align="center">
<img src="http://cn.ejie.me/images/clover.jpg" width="640" />
</div>
<h3 id="22-everything"><a class="markdownIt-Anchor" href="#22-everything"></a> 2.2. Everything</h3>
<blockquote>
<p><a href="http://www.voidtools.com/" target="_blank" rel="noopener">Everything</a> å¯ä»¥ç«‹å³åœ¨ windows ç³»ç»Ÿä¸­æ‰¾åˆ°åˆ¶å®šåç§°çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚</p>
</blockquote>
<div align="center">
<img src="http://www.voidtools.com/sssmall2.gif" width="640" />
</div>
<h3 id="23-wox"><a class="markdownIt-Anchor" href="#23-wox"></a> 2.3. Wox</h3>
<blockquote>
<p><a href="https://github.com/Wox-launcher/Wox" target="_blank" rel="noopener">Wox</a> æ˜¯ä¸€æ¬¾ç®€å•æ˜“ç”¨çš„ Windows å¯åŠ¨å™¨ã€‚å¯ä»¥æŠŠå®ƒè§†ä¸º windows ç‰ˆçš„ Alfredã€‚</p>
</blockquote>
<div align="center">
<img src="https://camo.githubusercontent.com/9db33546d3a905a9ad915e0948d3ba3f47f57b64/687474703a2f2f692e696d6775722e636f6d2f4474784e424a692e676966" width="640" />
</div>
<h3 id="24-q-dir"><a class="markdownIt-Anchor" href="#24-q-dir"></a> 2.4. Q-dir</h3>
<blockquote>
<p><a href="http://www.softpedia.com/get/File-managers/Q-Dir.shtml" target="_blank" rel="noopener">Q-dir</a> æ˜¯è½»é‡çš„æ–‡ä»¶ç®¡ç†å™¨,ç‰¹ç‚¹é²œæ˜,å„ç§å¸ƒå±€è§†å›¾åˆ‡æ¢çµæ´»,é»˜è®¤å››ä¸ªå°çª—å£ç»„æˆä¸€ä¸ªå¤§çª—å£,æ“ä½œå¿«æ·ã€‚</p>
</blockquote>
<div align="center">
<img src="http://i1-win.softpedia-static.com/screenshots/q-dir_1.png" width="640" />
</div>
]]></content>
      <categories>
        <category>æ•ˆç‡æå‡</category>
        <category>è§„èŒƒ</category>
      </categories>
      <tags>
        <tag>æ•ˆç‡æå‡</tag>
        <tag>è§„èŒƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆç†è§„åˆ’é¡¹ç›®</title>
    <url>/blog/efficiency/style/project-style/</url>
    <content><![CDATA[<blockquote>
<p>è½¯ä»¶é¡¹ç›®å¼€å‘è§„èŒƒã€‚</p>
</blockquote>
<h2 id="é¡¹ç›®ç»“æ„"><a class="markdownIt-Anchor" href="#é¡¹ç›®ç»“æ„"></a> é¡¹ç›®ç»“æ„</h2>
<p>ä»¥ä¸‹ä¸ºé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œç›®å½•çš„ç»„ç»‡ç»“æ„ï¼š</p>
<h3 id="ç›®å½•"><a class="markdownIt-Anchor" href="#ç›®å½•"></a> ç›®å½•</h3>
<p><strong>codes</strong> - ä»£ç ç›®å½•ã€‚<br />
<strong>configurations</strong> - é…ç½®ç›®å½•ã€‚ä¸€èˆ¬å­˜æ”¾é¡¹ç›®ç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚å¦‚ maven çš„ settings.xmlï¼Œnginx çš„ nginx.conf ç­‰ã€‚<br />
<strong>demos</strong> - ç¤ºä¾‹ç›®å½•ã€‚<br />
<strong>docs</strong> - æ–‡æ¡£ç›®å½•ã€‚<br />
<strong>libs</strong> - ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶ã€‚<br />
<strong>scripts</strong> - è„šæœ¬ç›®å½•ã€‚ä¸€èˆ¬å­˜æ”¾ç”¨äºå¯åŠ¨ã€æ„å»ºé¡¹ç›®çš„å¯æ‰§è¡Œè„šæœ¬æ–‡ä»¶ã€‚<br />
<strong>packages</strong> - æ‰“åŒ…æ–‡ä»¶ç›®å½•ã€‚Java é¡¹ç›®ä¸­å¯èƒ½æ˜¯ jarã€war ç­‰ï¼›å‰ç«¯é¡¹ç›®ä¸­å¯èƒ½æ˜¯ zipã€rar ç­‰ï¼›ç”µå­ä¹¦é¡¹ç›®ä¸­å¯èƒ½æ˜¯ pdf ç­‰ã€‚</p>
<h3 id="æ–‡ä»¶"><a class="markdownIt-Anchor" href="#æ–‡ä»¶"></a> æ–‡ä»¶</h3>
<p><strong>.gitignore</strong> - git å¿½ç•¥è§„åˆ™ã€‚<br />
<strong>.gitattributes</strong> - git å±æ€§è§„åˆ™ã€‚<br />
<strong>.editorconfig</strong> - ç¼–è¾‘å™¨ä¹¦å†™è§„åˆ™ã€‚<br />
<strong><a href="http://README.md" target="_blank" rel="noopener">README.md</a></strong> - é¡¹ç›®è¯´æ˜æ–‡ä»¶ã€‚<br />
<strong>LICENSE</strong> - å¼€æºåè®®ã€‚å¦‚æœé¡¹ç›®æ˜¯å¼€æºæ–‡ä»¶ï¼Œéœ€è¦æ·»åŠ ã€‚</p>
<h2 id="å‘½åè§„åˆ™"><a class="markdownIt-Anchor" href="#å‘½åè§„åˆ™"></a> å‘½åè§„åˆ™</h2>
<h3 id="ç›®å½•å"><a class="markdownIt-Anchor" href="#ç›®å½•å"></a> ç›®å½•å</h3>
<p>ç›®å½•åå¿…é¡»ä½¿ç”¨åŠè§’å­—ç¬¦ï¼Œä¸å¾—ä½¿ç”¨å…¨è§’å­—ç¬¦ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œä¸­æ–‡ä¸èƒ½ç”¨äºæ–‡ä»¶åã€‚</p>
<p>ç›®å½•åå»ºè®®åªä½¿ç”¨å°å†™å­—æ¯ï¼Œä¸ä½¿ç”¨å¤§å†™å­—æ¯ã€‚</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">ä¸ä½³ï¼š <span class="keyword">Test</span></span><br><span class="line">æ­£ç¡®ï¼š <span class="keyword">test</span></span><br></pre></td></tr></table></figure>
<p>ç›®å½•åå¯ä»¥ä½¿ç”¨æ•°å­—ï¼Œä½†ä¸åº”è¯¥æ˜¯é¦–å­—ç¬¦ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">ä¸ä½³ï¼š <span class="number">1</span>-demo</span><br><span class="line">æ­£ç¡®ï¼š demo1</span><br></pre></td></tr></table></figure>
<p>ç›®å½•ååŒ…å«å¤šä¸ªå•è¯æ—¶ï¼Œå•è¯ä¹‹é—´å»ºè®®ä½¿ç”¨åŠè§’çš„è¿è¯çº¿ï¼ˆ<code>-</code>ï¼‰åˆ†éš”ã€‚</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">ä¸ä½³ï¼š common_demo</span><br><span class="line">æ­£ç¡®ï¼š <span class="meta">common</span>-demo</span><br></pre></td></tr></table></figure>
<h3 id="æ–‡ä»¶å"><a class="markdownIt-Anchor" href="#æ–‡ä»¶å"></a> æ–‡ä»¶å</h3>
<p>æ–‡æ¡£çš„æ–‡ä»¶åä¸å¾—å«æœ‰ç©ºæ ¼ã€‚</p>
<p>æ–‡ä»¶åå¿…é¡»ä½¿ç”¨åŠè§’å­—ç¬¦ï¼Œä¸å¾—ä½¿ç”¨å…¨è§’å­—ç¬¦ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œä¸­æ–‡ä¸èƒ½ç”¨äºæ–‡ä»¶åã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">é”™è¯¯ï¼š åè¯è§£é‡Š<span class="selector-class">.md</span></span><br><span class="line">æ­£ç¡®ï¼š <span class="selector-tag">glossary</span><span class="selector-class">.md</span></span><br></pre></td></tr></table></figure>
<p>æ–‡ä»¶åå»ºè®®åªä½¿ç”¨å°å†™å­—æ¯ï¼Œä¸ä½¿ç”¨å¤§å†™å­—æ¯ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">é”™è¯¯ï¼š<span class="selector-tag">TroubleShooting</span><span class="selector-class">.md</span></span><br><span class="line">æ­£ç¡®ï¼š<span class="selector-tag">troubleshooting</span><span class="selector-class">.md</span></span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†é†’ç›®ï¼ŒæŸäº›è¯´æ˜æ–‡ä»¶çš„æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨å¤§å†™å­—æ¯ï¼Œæ¯”å¦‚<code>README</code>ã€<code>LICENSE</code>ã€‚</p>
<p>ä¸€äº›çº¦å®šä¿—æˆçš„ä¹ æƒ¯å¯ä»¥ä¿æŒä¼ ç»Ÿå†™æ³•ï¼Œå¦‚ï¼šJava çš„æ–‡ä»¶åä¸€èˆ¬ä½¿ç”¨é©¼å³°å‘½åæ³•ï¼Œä¸”é¦–å­—æ¯å¤§å†™ï¼›é…ç½®æ–‡ä»¶ <code>applicationContext.xml</code> ï¼›React ä¸­çš„ JSX ç»„ä»¶æ–‡ä»¶åä¸€èˆ¬ä½¿ç”¨é©¼å³°å‘½åæ³•ï¼Œä¸”é¦–å­—æ¯å¤§å†™ç­‰ã€‚</p>
<p>æ–‡ä»¶ååŒ…å«å¤šä¸ªå•è¯æ—¶ï¼Œå•è¯ä¹‹é—´å»ºè®®ä½¿ç”¨åŠè§’çš„è¿è¯çº¿ï¼ˆ<code>-</code>ï¼‰åˆ†éš”ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">ä¸ä½³ï¼š<span class="selector-tag">advanced_usage</span><span class="selector-class">.md</span></span><br><span class="line">æ­£ç¡®ï¼š<span class="selector-tag">advanced-usage</span><span class="selector-class">.md</span></span><br></pre></td></tr></table></figure>
<h2 id="java-æ—¥å¿—è§„èŒƒ"><a class="markdownIt-Anchor" href="#java-æ—¥å¿—è§„èŒƒ"></a> Java æ—¥å¿—è§„èŒƒ</h2>
<blockquote>
<p>è¿™é‡ŒåŸºäº<a href="https://yq.aliyun.com/attachment/download/?id=4942" target="_blank" rel="noopener">é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œ</a>æ—¥å¿—è§„çº¦ç« èŠ‚ï¼Œç»“åˆè‡ªå·±çš„å¼€å‘ç»éªŒåšäº†ä¸€äº›å¢åˆ å’Œè°ƒæ•´ã€‚</p>
</blockquote>
<ol>
<li>ã€å¼ºåˆ¶ã€‘åº”ç”¨ä¸­ä¸å¯ç›´æ¥ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿï¼ˆLog4jã€Logbackï¼‰ä¸­çš„ APIï¼Œè€Œåº”ä¾èµ–ä½¿ç”¨æ—¥å¿—æ¡†æ¶ SLF4J ä¸­çš„ APIï¼Œä½¿ç”¨é—¨é¢æ¨¡å¼çš„æ—¥å¿—æ¡†æ¶ï¼Œæœ‰åˆ©äºç»´æŠ¤å’Œå„ä¸ªç±»çš„æ—¥å¿—å¤„ç†æ–¹å¼ç»Ÿä¸€ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(Abc<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>
<p>ã€å¼ºåˆ¶ã€‘æ—¥å¿—æ–‡ä»¶æ¨èè‡³å°‘ä¿å­˜ <code>30</code> å¤©ï¼Œå› ä¸ºæœ‰äº›å¼‚å¸¸å…·å¤‡ä»¥â€œå‘¨â€ä¸ºé¢‘æ¬¡å‘ç”Ÿçš„ç‰¹ç‚¹ã€‚</p>
</li>
<li>
<p>ã€å¼ºåˆ¶ã€‘åº”ç”¨ä¸­çš„æ‰©å±•æ—¥å¿—ï¼ˆå¦‚æ‰“ç‚¹ã€ä¸´æ—¶ç›‘æ§ã€è®¿é—®æ—¥å¿—ç­‰ï¼‰å‘½åæ–¹å¼ï¼š<code>appName_logType_logName.log</code>ã€‚logType:æ—¥å¿—ç±»å‹ï¼Œæ¨èåˆ†ç±»æœ‰ stats/desc/monitor/visit ç­‰ï¼›logName:æ—¥å¿—æè¿°ã€‚è¿™ç§å‘½åçš„å¥½å¤„ï¼šé€šè¿‡æ–‡ä»¶åå°±å¯çŸ¥é“æ—¥å¿—æ–‡ä»¶å±äºä»€ä¹ˆåº”ç”¨ï¼Œä»€ä¹ˆç±»å‹ï¼Œä»€ä¹ˆç›®çš„ï¼Œä¹Ÿæœ‰åˆ©äºå½’ç±»æŸ¥æ‰¾ã€‚</p>
</li>
</ol>
<p><strong>æ­£ä¾‹</strong>ï¼šmppserver åº”ç”¨ä¸­å•ç‹¬ç›‘æ§æ—¶åŒºè½¬æ¢å¼‚å¸¸ï¼Œå¦‚ï¼š<code>mppserver_monitor_timeZoneConvert.log</code></p>
<p><strong>è¯´æ˜</strong>ï¼šæ¨èå¯¹æ—¥å¿—è¿›è¡Œåˆ†ç±»ï¼Œå¦‚å°†é”™è¯¯æ—¥å¿—å’Œä¸šåŠ¡æ—¥å¿—åˆ†å¼€å­˜æ”¾ï¼Œä¾¿äºå¼€å‘äººå‘˜æŸ¥çœ‹ï¼Œä¹Ÿä¾¿äºé€šè¿‡æ—¥å¿—å¯¹ç³»ç»Ÿè¿›è¡ŒåŠæ—¶ç›‘æ§ã€‚</p>
<ol start="4">
<li>ã€å¼ºåˆ¶ã€‘å¯¹ <code>trace/debug/info</code> çº§åˆ«çš„æ—¥å¿—è¾“å‡ºï¼Œå¿…é¡»ä½¿ç”¨æ¡ä»¶è¾“å‡ºå½¢å¼æˆ–è€…ä½¿ç”¨å ä½ç¬¦çš„æ–¹å¼ã€‚</li>
</ol>
<p>è¯´æ˜ï¼š<code>logger.debug(&quot;Processing trade with id: &quot; + id + &quot; and symbol: &quot; + symbol);</code> å¦‚æœæ—¥å¿—çº§åˆ«æ˜¯ warnï¼Œä¸Šè¿°æ—¥å¿—ä¸ä¼šæ‰“å°ï¼Œä½†æ˜¯ä¼šæ‰§è¡Œå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œï¼Œå¦‚æœ symbol æ˜¯å¯¹è±¡ï¼Œä¼šæ‰§è¡Œ toString()æ–¹æ³•ï¼Œæµªè´¹äº†ç³»ç»Ÿèµ„æºï¼Œæ‰§è¡Œäº†ä¸Šè¿°æ“ä½œï¼Œæœ€ç»ˆæ—¥å¿—å´æ²¡æœ‰æ‰“å°ã€‚</p>
<p><strong>æ­£ä¾‹ï¼šï¼ˆæ¡ä»¶ï¼‰</strong></p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class="line"><span class="selector-tag">logger</span><span class="selector-class">.debug</span>(<span class="string">"Processing trade with id: "</span> + id + <span class="string">" and symbol: "</span> + symbol);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ­£ä¾‹ï¼šï¼ˆå ä½ç¬¦ï¼‰</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">logger</span><span class="selector-class">.debug</span>("<span class="selector-tag">Processing</span> <span class="selector-tag">trade</span> <span class="selector-tag">with</span> <span class="selector-tag">id</span>: &#123;&#125; <span class="selector-tag">and</span> <span class="selector-tag">symbol</span> : &#123;&#125; ", <span class="selector-tag">id</span>, <span class="selector-tag">symbol</span>);</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>ã€å¼ºåˆ¶ã€‘é¿å…é‡å¤æ‰“å°æ—¥å¿—ï¼Œæµªè´¹ç£ç›˜ç©ºé—´ã€‚åŠ¡å¿…åœ¨ <code>log4j.xml</code> æˆ– <code>logback.xml</code> ä¸­è®¾ç½® <code>additivity=false</code>ã€‚</li>
</ol>
<p><strong>æ­£ä¾‹</strong>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"com.taobao.dubbo.config"</span> <span class="attr">additivity</span>=<span class="string">"false"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="6">
<li>ã€å¼ºåˆ¶ã€‘å¼‚å¸¸ä¿¡æ¯åº”è¯¥åŒ…æ‹¬ä¸¤ç±»ä¿¡æ¯ï¼šæ¡ˆå‘ç°åœºä¿¡æ¯å’Œå¼‚å¸¸å †æ ˆä¿¡æ¯ã€‚å¦‚æœä¸å¤„ç†ï¼Œé‚£ä¹ˆé€šè¿‡å…³é”®å­— throws å¾€ä¸ŠæŠ›å‡ºã€‚</li>
</ol>
<p><strong>æ­£ä¾‹</strong>ï¼šlogger.error(å„ç±»å‚æ•°æˆ–è€…å¯¹è±¡ toString + â€œ_â€ + e.getMessage(), e);</p>
<ol start="9">
<li>ã€å¼ºåˆ¶ã€‘æ—¥å¿—æ ¼å¼éµå¾ªå¦‚ä¸‹æ ¼å¼ï¼š</li>
</ol>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javalib/log/logback/log-pattern.png"/></div>
<p>æ‰“å°å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">2018<span class="selector-tag">-03-29</span> 15<span class="selector-pseudo">:06</span><span class="selector-pseudo">:57.277</span> <span class="selector-attr">[javalib]</span> <span class="selector-attr">[main]</span> <span class="selector-attr">[TRACE]</span> <span class="selector-tag">i</span><span class="selector-class">.g</span><span class="selector-class">.dunwu</span><span class="selector-class">.javalib</span><span class="selector-class">.log</span><span class="selector-class">.LogbackDemo</span><span class="selector-id">#main</span> <span class="selector-tag">-</span> è¿™æ˜¯ä¸€æ¡ <span class="selector-tag">trace</span> æ—¥å¿—è®°å½•</span><br><span class="line">2018<span class="selector-tag">-03-29</span> 15<span class="selector-pseudo">:06</span><span class="selector-pseudo">:57.282</span> <span class="selector-attr">[javalib]</span> <span class="selector-attr">[main]</span> <span class="selector-attr">[DEBUG]</span> <span class="selector-tag">i</span><span class="selector-class">.g</span><span class="selector-class">.dunwu</span><span class="selector-class">.javalib</span><span class="selector-class">.log</span><span class="selector-class">.LogbackDemo</span><span class="selector-id">#main</span> <span class="selector-tag">-</span> è¿™æ˜¯ä¸€æ¡ <span class="selector-tag">debug</span> æ—¥å¿—è®°å½•</span><br><span class="line">2018<span class="selector-tag">-03-29</span> 15<span class="selector-pseudo">:06</span><span class="selector-pseudo">:57.282</span> <span class="selector-attr">[javalib]</span> <span class="selector-attr">[main]</span> <span class="selector-attr">[INFO]</span> <span class="selector-tag">i</span><span class="selector-class">.g</span><span class="selector-class">.dunwu</span><span class="selector-class">.javalib</span><span class="selector-class">.log</span><span class="selector-class">.LogbackDemo</span><span class="selector-id">#main</span> <span class="selector-tag">-</span> è¿™æ˜¯ä¸€æ¡ <span class="selector-tag">info</span> æ—¥å¿—è®°å½•</span><br><span class="line">2018<span class="selector-tag">-03-29</span> 15<span class="selector-pseudo">:06</span><span class="selector-pseudo">:57.282</span> <span class="selector-attr">[javalib]</span> <span class="selector-attr">[main]</span> <span class="selector-attr">[WARN]</span> <span class="selector-tag">i</span><span class="selector-class">.g</span><span class="selector-class">.dunwu</span><span class="selector-class">.javalib</span><span class="selector-class">.log</span><span class="selector-class">.LogbackDemo</span><span class="selector-id">#main</span> <span class="selector-tag">-</span> è¿™æ˜¯ä¸€æ¡ <span class="selector-tag">warn</span> æ—¥å¿—è®°å½•</span><br><span class="line">2018<span class="selector-tag">-03-29</span> 15<span class="selector-pseudo">:06</span><span class="selector-pseudo">:57.282</span> <span class="selector-attr">[javalib]</span> <span class="selector-attr">[main]</span> <span class="selector-attr">[ERROR]</span> <span class="selector-tag">i</span><span class="selector-class">.g</span><span class="selector-class">.dunwu</span><span class="selector-class">.javalib</span><span class="selector-class">.log</span><span class="selector-class">.LogbackDemo</span><span class="selector-id">#main</span> <span class="selector-tag">-</span> è¿™æ˜¯ä¸€æ¡ <span class="selector-tag">error</span> æ—¥å¿—è®°å½•</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>ã€å‚è€ƒã€‘slf4j æ”¯æŒçš„æ—¥å¿—çº§åˆ«ï¼ŒæŒ‰ç…§çº§åˆ«ä»ä½åˆ°é«˜ï¼Œåˆ†åˆ«ä¸ºï¼š<code>trace &lt; debug &lt; info &lt; warn &lt; error</code>ã€‚</li>
</ol>
<p>å»ºè®®åªä½¿ç”¨ <code>debug &lt; info &lt; warn &lt; error</code> å››ä¸ªçº§åˆ«ã€‚</p>
<ul>
<li><code>error</code> æ—¥å¿—çº§åˆ«åªè®°å½•ç³»ç»Ÿé€»è¾‘å‡ºé”™ã€å¼‚å¸¸ç­‰é‡è¦çš„é”™è¯¯ä¿¡æ¯ã€‚å¦‚éå¿…è¦ï¼Œè¯·ä¸è¦åœ¨æ­¤åœºæ™¯æ‰“å‡º error çº§åˆ«ã€‚</li>
<li><code>warn</code> æ—¥å¿—çº§åˆ«è®°å½•ç”¨æˆ·è¾“å…¥å‚æ•°é”™è¯¯çš„æƒ…å†µï¼Œé¿å…ç”¨æˆ·æŠ•è¯‰æ—¶ï¼Œæ— æ‰€é€‚ä»ã€‚</li>
<li><code>info</code> æ—¥å¿—çº§åˆ«è®°å½•ä¸šåŠ¡é€»è¾‘ä¸­ä¸€äº›é‡è¦æ­¥éª¤ä¿¡æ¯ã€‚</li>
<li><code>debug</code> æ—¥å¿—çº§åˆ«è®°å½•ä¸€äº›ç”¨äºè°ƒè¯•çš„ä¿¡æ¯ã€‚</li>
</ul>
<ol start="10">
<li>ã€å‚è€ƒã€‘æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹æ¡†æ¶æˆ–åº“çš„æ—¥å¿—å¯¹äºæ’æŸ¥é—®é¢˜å…·æœ‰ä¸€å®šçš„å¸®åŠ©ï¼Œå¦‚ Springã€Dubboã€Mybatis ç­‰ã€‚è¿™äº›æ¡†æ¶æ‰€ä½¿ç”¨çš„æ—¥å¿—åº“æœªå¿…å’Œæœ¬é¡¹ç›®ä¸€æ ·ï¼Œä¸ºäº†é¿å…å‡ºç°æ—¥å¿—æ— æ³•è¾“å‡ºçš„é—®é¢˜ï¼Œè¯·å¼•å…¥å¯¹åº”çš„æ¡¥æ¥ jar åŒ…ã€‚</li>
</ol>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://yq.aliyun.com/attachment/download/?id=4942" target="_blank" rel="noopener">é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œ</a>æ—¥å¿—è§„çº¦ç« èŠ‚</li>
</ul>
]]></content>
      <categories>
        <category>æ•ˆç‡æå‡</category>
        <category>è§„èŒƒ</category>
      </categories>
      <tags>
        <tag>æ•ˆç‡æå‡</tag>
        <tag>è§„èŒƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œæŒ‡å—</title>
    <url>/blog/communication/network-guide/</url>
    <content><![CDATA[<blockquote>
<p>è®¡ç®—æœºç½‘ç»œæ˜¯æŒ‡å°†åœ°ç†ä½ç½®ä¸åŒçš„å…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„å¤šå°è®¡ç®—æœºåŠå…¶å¤–éƒ¨è®¾å¤‡ï¼Œé€šè¿‡é€šä¿¡çº¿è·¯è¿æ¥èµ·æ¥ï¼Œåœ¨ç½‘ç»œæ“ä½œç³»ç»Ÿï¼Œç½‘ç»œç®¡ç†è½¯ä»¶åŠç½‘ç»œé€šä¿¡åè®®çš„ç®¡ç†å’Œåè°ƒä¸‹ï¼Œå®ç°èµ„æºå…±äº«å’Œä¿¡æ¯ä¼ é€’çš„è®¡ç®—æœºç³»ç»Ÿã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/network.jpg!zp"/></div>
<h2 id="æŒ‡å—"><a class="markdownIt-Anchor" href="#æŒ‡å—"></a> ğŸ’¡ æŒ‡å—</h2>
<p>å­¦ä¹ ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸‹å…¥é—¨ä¸‰é—®ï¼š</p>
<blockquote>
<p><strong>ä¸€ã€ä»€ä¹ˆæ˜¯è®¡ç®—æœºç½‘ç»œï¼Ÿ</strong></p>
<p>è®¡ç®—æœºç½‘ç»œæ˜¯æŒ‡å°†åœ°ç†ä½ç½®ä¸åŒçš„å…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„å¤šå°è®¡ç®—æœºåŠå…¶å¤–éƒ¨è®¾å¤‡ï¼Œé€šè¿‡é€šä¿¡çº¿è·¯è¿æ¥èµ·æ¥ï¼Œåœ¨ç½‘ç»œæ“ä½œç³»ç»Ÿï¼Œç½‘ç»œç®¡ç†è½¯ä»¶åŠç½‘ç»œé€šä¿¡åè®®çš„ç®¡ç†å’Œåè°ƒä¸‹ï¼Œå®ç°èµ„æºå…±äº«å’Œä¿¡æ¯ä¼ é€’çš„è®¡ç®—æœºç³»ç»Ÿã€‚</p>
<p>â€”â€”æ‘˜è‡ªç™¾åº¦ç™¾ç§‘</p>
</blockquote>
<blockquote>
<p><strong>äºŒã€ä¸ºä»€ä¹ˆå­¦ä¹ è®¡ç®—æœºç½‘ç»œï¼Ÿ</strong></p>
<p>è®¡ç®—æœºç½‘ç»œæ˜¯è®¡ç®—æœºç§‘å­¦çš„åŸºç¡€è¯¾ç¨‹ï¼Œä¹Ÿæ˜¯è®¡ç®—æœºä¸“ä¸šè€ƒç ”å¿…è€ƒç§‘ç›®ï¼Œå¯è§å…¶é‡è¦æ€§ã€‚ä½œä¸ºä¸€åç¨‹åºå‘˜ï¼Œäº†è§£è®¡ç®—æœºç½‘ç»œï¼Œå¯¹äº Web é¢†åŸŸï¼Œé€šä¿¡é¢†åŸŸçš„å¼€å‘æœ‰è«å¤§çš„å¸®åŠ©ã€‚</p>
<p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®ç½‘é¡µçš„åŸç†æ˜¯ä»€ä¹ˆï¼ŸWifi æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿé˜²ç«å¢™æ˜¯å¦‚ä½•ä¿éšœç½‘ç»œå®‰å…¨çš„ï¼Ÿä»€ä¹ˆæ˜¯å®‰å…¨è¯ä¹¦ï¼ŸCookie å’Œ Session æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿã€‚ã€‚ã€‚</p>
<p>å¦‚æœä½ æ¥è§¦è¿‡è¿™äº›æŠ€æœ¯ï¼Œå¦‚æœä½ æƒ³äº†è§£è¿™äº›æŠ€æœ¯çš„åŸç†ï¼Œé‚£ä¹ˆä½ å°±æœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹è®¡ç®—æœºç½‘ç»œäº†ã€‚</p>
</blockquote>
<blockquote>
<p><strong>ä¸‰ã€å¦‚ä½•å­¦ä¹ è®¡ç®—æœºç½‘ç»œï¼Ÿ</strong></p>
<p>æœ¬äººæœ‰ 2 å¹´é€šä¿¡é¢†åŸŸå¼€å‘ç»éªŒï¼Œä»äº‹é€šä¿¡è®¾å¤‡ä¸Šçš„åè®®å¼€å‘ã€‚å°±æˆ‘ä¸ªäººçš„å­¦ä¹ ç»éªŒæ¥çœ‹ï¼Œå­¦ä¹ è®¡ç®—æœºç½‘ç»œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹é˜¶æ®µï¼š</p>
<ul>
<li><strong>åŸºç¡€é˜¶æ®µâ€”â€”ä¸€èˆ¬æ€§çš„äº†è§£ç½‘ç»œåè®®åˆ†å±‚åŠå„å±‚åŠŸèƒ½</strong>
<ul>
<li>äº†è§£è®¡ç®—æœºç½‘ç»œåè®®åˆ†å±‚ï¼ˆOSIï¼‰æœ‰å“ªäº›å±‚ï¼Œåˆ†å±‚çš„ä¾æ®æ˜¯ä»€ä¹ˆï¼ˆå³æ¯å±‚çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼‰</li>
<li>äº†è§£æ¯å±‚çš„ä¸»è¦é€šä¿¡è®¾å¤‡æœ‰å“ªäº›ï¼›</li>
<li>äº†è§£æ¯å±‚æœ‰å“ªäº›é‡è¦ç½‘ç»œåè®®ï¼Œè¿™äº›åè®®æœ‰ä»€ä¹ˆä½œç”¨ï¼ŒåŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>äº†è§£æ¯å±‚çš„ä¼ è¾“æ•°æ®å½¢å¼ï¼ˆå¦‚ï¼šæŠ¥æ–‡ã€å¸§ç­‰ï¼‰</li>
</ul>
</li>
<li><strong>è¿›é˜¶é˜¶æ®µâ€”â€”ç³»ç»Ÿå­¦ä¹ è®¡ç®—æœºç½‘ç»œçŸ¥è¯†ï¼Œå°†å„å±‚ä¸»è¦åè®®åŠŸèƒ½ä¸²è”èµ·æ¥</strong>
<ul>
<li>å­¦ä¹  TCP/IP è¯¦è§£ å· 1ã€å· 2ã€å· 3ï¼ˆå†…å®¹è¯¦å®ï¼Œä½†æ–‡å­—è¾ƒä¸ºæ™¦æ¶©ï¼Œä¸é€‚åˆåˆå­¦è€…ï¼‰</li>
</ul>
</li>
<li><strong>ä¸“ä¸šé˜¶æ®µâ€”â€”æ ¹æ®ä¸šåŠ¡é¢†åŸŸï¼Œæœ‰é’ˆå¯¹æ€§çš„å­¦ä¹ </strong>
<ul>
<li>ç½‘ç»œåè®®å¾ˆå¤šï¼Œè€Œä¸”ä¸“ä¸šæ€§éå¸¸å¼ºã€‚ç²¾é€šæ‰€æœ‰åè®®ï¼Œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œæ‰€ä»¥æœ‰å¿…è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡é¢†åŸŸï¼Œæœ‰é’ˆå¯¹æ€§çš„æ·±å…¥å­¦ä¹ åè®®ã€‚å¦‚æœä½ æ˜¯åš web å¼€å‘ï¼Œé‚£ä¹ˆä½ å¾ˆæœ‰å¿…è¦è®¤çœŸå­¦ä¹ ä¸€ä¸‹ HTTPã€DNS åè®®ï¼›å¦‚æœä½ æ˜¯åšè·¯ç”±å™¨ã€äº¤æ¢æœºé¢†åŸŸé€šä¿¡å¼€å‘ï¼Œé‚£ä¹ˆä½ åº”è¯¥æ›´æ·±å…¥å­¦ä¹ ä¸€ä¸‹ IP/TCP/UDP åè®®ã€‚ã€‚ã€‚</li>
<li>å¦‚ä½•æ·±å…¥å­¦ä¹ åè®®ï¼Œæœ€å¥½çš„å­¦ä¹ æ–¹å¼ï¼Œå°±æ˜¯æ·±å…¥å­¦ä¹  RFCï¼Œå¹¶ç»“åˆå®é™…çš„åè®®æŠ¥æ–‡å»äº†è§£ã€‚</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="æ ¸å¿ƒæ¦‚å¿µ"><a class="markdownIt-Anchor" href="#æ ¸å¿ƒæ¦‚å¿µ"></a> æ ¸å¿ƒæ¦‚å¿µ</h3>
<ul>
<li><strong>è®¡ç®—æœºç½‘ç»œ</strong> - è®¡ç®—æœºç½‘ç»œï¼ˆcomputer networkï¼‰ï¼Œé€šå¸¸ä¹Ÿç®€ç§°ç½‘ç»œï¼Œæ˜¯åˆ©ç”¨é€šä¿¡è®¾å¤‡å’Œçº¿è·¯å°†åœ°ç†ä½ç½®ä¸åŒçš„ã€åŠŸèƒ½ç‹¬ç«‹çš„å¤šä¸ª<a href="https://zh.wikipedia.org/wiki/%E9%9B%BB%E5%AD%90%E8%A8%88%E7%AE%97%E6%A9%9F" target="_blank" rel="noopener">è®¡ç®—æœº</a>ç³»ç»Ÿè¿æ¥èµ·æ¥ï¼Œä»¥åŠŸèƒ½å®Œå–„çš„ç½‘ç»œ<a href="https://zh.wikipedia.org/wiki/%E8%BD%AF%E4%BB%B6" target="_blank" rel="noopener">è½¯ä»¶</a>å®ç°ç½‘ç»œçš„<a href="https://zh.wikipedia.org/wiki/%E7%A1%AC%E4%BB%B6" target="_blank" rel="noopener">ç¡¬ä»¶</a>ã€<a href="https://zh.wikipedia.org/wiki/%E8%BB%9F%E4%BB%B6" target="_blank" rel="noopener">è½¯ä»¶</a>åŠèµ„æº<a href="https://zh.wikipedia.org/wiki/%E5%85%B1%E4%BA%AB" target="_blank" rel="noopener">å…±äº«</a>å’Œ<a href="https://zh.wikipedia.org/wiki/%E4%BF%A1%E6%81%AF" target="_blank" rel="noopener">ä¿¡æ¯</a>ä¼ é€’çš„ç³»ç»Ÿã€‚ç®€å•çš„è¯´å³è¿æ¥ä¸¤å°æˆ–å¤šå°è®¡ç®—æœºè¿›è¡Œ<a href="https://zh.wikipedia.org/wiki/%E9%80%9A%E4%BF%A1" target="_blank" rel="noopener">é€šä¿¡</a>çš„ç³»ç»Ÿã€‚</li>
<li><strong>äº’è”ç½‘</strong> - äº’è”ç½‘ï¼ˆInternetï¼‰ï¼Œå³ç½‘ç»œçš„ç½‘ç»œã€‚</li>
</ul>
<h3 id="æ‹“æ‰‘ç»“æ„"><a class="markdownIt-Anchor" href="#æ‹“æ‰‘ç»“æ„"></a> æ‹“æ‰‘ç»“æ„</h3>
<p>è®¡ç®—æœºç½‘ç»œçš„æ‹“æ‰‘ç»“æ„å¯åˆ†ä¸ºï¼š</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/overview/network-topological-structure.gif!zp"/></div>
<ul>
<li>ç½‘å‹æ‹“æ‰‘ç½‘å‹ç½‘ï¼ˆMesh networkï¼‰</li>
<li>ç¯å‹æ‹“æ‰‘ç¯å‹ç½‘ï¼ˆRing networkï¼‰</li>
<li>æ˜Ÿå‹æ‹“æ‰‘æ˜Ÿå‹ç½‘ï¼ˆStar networkï¼‰</li>
<li>æ ‘çŠ¶æ‹“æ‰‘æ ‘å‹ç½‘ï¼ˆTree networkï¼‰</li>
<li>æ€»çº¿æ‹“æ‰‘æ€»çº¿ç½‘ï¼ˆBus networkï¼‰</li>
</ul>
<h3 id="ä½œç”¨èŒƒå›´"><a class="markdownIt-Anchor" href="#ä½œç”¨èŒƒå›´"></a> ä½œç”¨èŒƒå›´</h3>
<ul>
<li>å¹¿åŸŸç½‘ WANï¼ˆWide Area Networkï¼‰</li>
<li>åŸåŸŸç½‘ MANï¼ˆMetropolitan Area Networkï¼‰</li>
<li>å±€åŸŸç½‘ LANï¼ˆLocal Area Networkï¼‰</li>
<li>ä¸ªäººåŒºåŸŸç½‘ PANï¼ˆPersonal Area Networkï¼‰</li>
</ul>
<h3 id="æ€§èƒ½æŒ‡æ ‡"><a class="markdownIt-Anchor" href="#æ€§èƒ½æŒ‡æ ‡"></a> æ€§èƒ½æŒ‡æ ‡</h3>
<ul>
<li><strong>é€Ÿç‡</strong> - é€Ÿç‡çš„å•ä½æ˜¯ bit/sï¼ˆæ¯”ç‰¹æ¯ç§’ï¼‰ã€‚</li>
<li><strong>å¸¦å®½ï¼ˆbandwidthï¼‰</strong> - å¸¦å®½æœ‰ä»¥ä¸‹ä¸¤ç§ä¸åŒçš„æ„ä¹‰ã€‚
<ul>
<li>ä¿¡å·çš„å¸¦å®½æ˜¯æŒ‡è¯¥ä¿¡å·æ‰€åŒ…å«çš„å„ç§ä¸åŒé¢‘ç‡æˆåˆ†æ‰€å æ®çš„é¢‘ç‡èŒƒå›´ã€‚è¿™ç§æ„ä¹‰çš„å¸¦å®½çš„å•ä½æ˜¯èµ« ï¼ˆæˆ–åƒèµ«ï¼Œå…†èµ«ï¼Œå‰èµ«ç­‰ï¼‰ã€‚</li>
<li>ç½‘ç»œçš„å¸¦å®½è¡¨ç¤ºåœ¨å•ä½æ—¶é—´å†…ä»ç½‘ç»œä¸­çš„æŸä¸€ç‚¹åˆ°å¦ä¸€ç‚¹æ‰€èƒ½é€šè¿‡çš„<strong>æœ€é«˜æ•°æ®ç‡</strong>ã€‚è¿™ç§æ„ä¹‰çš„å¸¦å®½çš„å•ä½æ˜¯ bit/sï¼ˆæ¯”ç‰¹æ¯ç§’ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>ååé‡ï¼ˆthroughputï¼‰</strong> - ååé‡è¡¨ç¤ºåœ¨å•ä½æ—¶é—´å†…é€šè¿‡æŸä¸ªç½‘ç»œï¼ˆæˆ–ä¿¡é“ã€æ¥å£ï¼‰çš„æ•°æ®é‡ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ª 100 Mbit/s çš„ä»¥å¤ªç½‘ï¼Œå…¶é¢å®šé€Ÿç‡æ˜¯ 100 Mbit/sã€‚</li>
<li><strong>æ—¶å»¶ï¼ˆdelayï¼‰</strong>
<ul>
<li>æ€»æ—¶å»¶ = æ’é˜Ÿæ—¶å»¶ + å¤„ç†æ—¶å»¶ + ä¼ è¾“æ—¶å»¶ + ä¼ æ’­æ—¶å»¶</li>
</ul>
</li>
</ul>
<h2 id="ç½‘ç»œåˆ†å±‚"><a class="markdownIt-Anchor" href="#ç½‘ç»œåˆ†å±‚"></a> ç½‘ç»œåˆ†å±‚</h2>
<blockquote>
<p>è®¡ç®—æœºç½‘ç»œå¦‚ä½•åˆ†å±‚ï¼Ÿå„å±‚çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå„å±‚çš„ä¸»è¦åè®®ã€è®¾å¤‡åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>è¿™æ˜¯å­¦ä¹ è®¡ç®—æœºç½‘ç»œçŸ¥è¯†å®è§‚å±‚é¢å¿…é¡»è¦äº†è§£çš„æ ¸å¿ƒç‚¹ã€‚çŸ¥é“äº†è¿™äº›ï¼Œå¯¹äºç½‘ç»œçš„ä½“ç³»ç»“æ„å°±åŸºæœ¬ä¸Šäº†è§£äº†ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/overview/network-layers.png!zp"/></div>
<p>è®¡ç®—æœºç½‘ç»œåˆ†å±‚ä¸€èˆ¬æœ‰ä¸‰ç§åˆ’åˆ†ä½“ç³»ï¼šOSI åˆ†å±‚ï¼›äº”å±‚åè®®åˆ†å±‚ï¼›TCP/IP åè®®åˆ†å±‚ã€‚</p>
<ul>
<li>OSI çš„ä¸ƒå±‚ä½“ç³»ç»“æ„æ¦‚å¿µæ¸…æ¥šï¼Œç†è®ºå®Œæ•´ï¼Œä½†æ˜¯æ¯”è¾ƒå¤æ‚ä¸”ä¸å®ç”¨ï¼Œæ‰€ä»¥å¹¶ä¸æµè¡Œã€‚</li>
<li>äº”å±‚åè®®åˆ†å±‚æ˜¯ä¸€ç§æŠ˜ä¸­æ–¹æ¡ˆï¼Œåœ¨ç°å®ä¸­æ›´ä¸ºæµè¡Œã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/overview/ç½‘ç»œåˆ†å±‚æ¶æ„å›¾.png!zp"/></div>
<h3 id="ç‰©ç†å±‚"><a class="markdownIt-Anchor" href="#ç‰©ç†å±‚"></a> ç‰©ç†å±‚</h3>
<blockquote>
<p>ç‰©ç†å±‚ï¼ˆPhysical Layerï¼‰åªæ¥æ”¶å’Œå‘é€ä¸€ä¸²æ¯”ç‰¹(bit)æµï¼Œä¸è€ƒè™‘ä¿¡æ¯çš„æ„ä¹‰å’Œä¿¡æ¯ç»“æ„ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-physical.md">è®¡ç®—æœºç½‘ç»œä¹‹ç‰©ç†å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼šè°ƒåˆ¶ã€è§£è°ƒã€æ•°å­—ä¿¡å·ã€æ¨¡æ‹Ÿä¿¡å·ã€é€šä¿¡åª’ä»‹ã€ä¿¡é“å¤ç”¨</li>
<li>æ•°æ®å•å…ƒï¼šæ¯”ç‰¹æµã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šå…‰çº¤ã€åŒè½´ç”µç¼†ã€åŒç»çº¿ã€ä¸­ç»§å™¨å’Œé›†çº¿å™¨ã€‚</li>
</ul>
<h3 id="æ•°æ®é“¾è·¯å±‚"><a class="markdownIt-Anchor" href="#æ•°æ®é“¾è·¯å±‚"></a> æ•°æ®é“¾è·¯å±‚</h3>
<blockquote>
<p>ç½‘ç»œå±‚é’ˆå¯¹çš„è¿˜æ˜¯ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œè€Œä¸»æœºä¹‹é—´å¯ä»¥æœ‰å¾ˆå¤šé“¾è·¯ï¼Œæ•°æ®é“¾è·¯å±‚ï¼ˆData Link Layerï¼‰å°±æ˜¯ä¸ºåŒä¸€é“¾è·¯çš„ä¸»æœºæä¾›æ•°æ®ä¼ è¾“æœåŠ¡ã€‚æ•°æ®é“¾è·¯å±‚æŠŠç½‘ç»œå±‚ä¼ ä¸‹æ¥çš„åˆ†ç»„å°è£…æˆå¸§ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-data-link.md">è®¡ç®—æœºç½‘ç»œä¹‹æ•°æ®é“¾è·¯å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼šç‚¹å¯¹ç‚¹ä¿¡é“ã€å¹¿æ’­ä¿¡é“ã€<code>PPP</code>ã€<code>CSMA/CD</code>ã€å±€åŸŸç½‘ã€ä»¥å¤ªç½‘ã€<code>MAC</code>ã€é€‚é…å™¨ã€é›†çº¿å™¨ã€ç½‘æ¡¥ã€äº¤æ¢æœº</li>
<li>ä¸»è¦åè®®ï¼š<code>PPP</code>ã€<code>CSMA/CD</code> ç­‰ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šå¸§ï¼ˆframeï¼‰ã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šäºŒå±‚äº¤æ¢æœºã€ç½‘æ¡¥ã€ç½‘å¡ã€‚</li>
</ul>
<h3 id="ç½‘ç»œå±‚"><a class="markdownIt-Anchor" href="#ç½‘ç»œå±‚"></a> ç½‘ç»œå±‚</h3>
<blockquote>
<p>ç½‘ç»œå±‚ï¼ˆnetwork layerï¼‰ä¸ºåˆ†ç»„äº¤æ¢ç½‘ä¸Šçš„ä¸åŒä¸»æœºæä¾›é€šä¿¡æœåŠ¡ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„æˆ–åŒ…è¿›è¡Œä¼ é€ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-network.md">è®¡ç®—æœºç½‘ç»œä¹‹ç½‘ç»œå±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>IP</code>ã€<code>ICMP</code>ã€<code>ARP</code>ã€è·¯ç”±</li>
<li>ä¸»è¦åè®®ï¼š<code>IP</code>ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šIP æ•°æ®æŠ¥ï¼ˆpacketï¼‰ã€‚</li>
<li>å…¸å‹è®¾å¤‡ï¼šç½‘å…³ã€è·¯ç”±å™¨ã€‚</li>
</ul>
<h3 id="ä¼ è¾“å±‚"><a class="markdownIt-Anchor" href="#ä¼ è¾“å±‚"></a> ä¼ è¾“å±‚</h3>
<blockquote>
<p>ä¼ è¾“å±‚ï¼ˆtransport layerï¼‰ä¸ºä¸¤å°ä¸»æœºä¸­è¿›ç¨‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-network.md">è®¡ç®—æœºç½‘ç»œä¹‹ç½‘ç»œå±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>UDP</code>ã€<code>TCP</code>ã€æ»‘åŠ¨çª—å£ã€æ‹¥å¡æ§åˆ¶ã€ä¸‰æ¬¡æ¡æ‰‹</li>
<li>ä¸»è¦åè®®ï¼š<code>TCP</code>ã€<code>UDP</code>ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šæŠ¥æ–‡æ®µï¼ˆsegmentï¼‰æˆ–ç”¨æˆ·æ•°æ®æŠ¥ã€‚</li>
</ul>
<h3 id="~ä¼šè¯å±‚~"><a class="markdownIt-Anchor" href="#~ä¼šè¯å±‚~"></a> ~<sub>ä¼šè¯å±‚~</sub></h3>
<blockquote>
<p>~~ä¼šè¯å±‚ï¼ˆSession Layerï¼‰ä¸å‚ä¸å…·ä½“çš„ä¼ è¾“ï¼Œå®ƒæä¾›åŒ…æ‹¬è®¿é—®éªŒè¯å’Œä¼šè¯ç®¡ç†åœ¨å†…çš„å»ºç«‹å’Œç»´æŠ¤åº”ç”¨ä¹‹é—´é€šä¿¡çš„æœºåˆ¶ã€‚~~</p>
</blockquote>
<h3 id="~è¡¨ç¤ºå±‚~"><a class="markdownIt-Anchor" href="#~è¡¨ç¤ºå±‚~"></a> ~<sub>è¡¨ç¤ºå±‚~</sub></h3>
<blockquote>
<p>~~è¡¨ç¤ºå±‚ï¼ˆPresentation Layerï¼‰æ˜¯ä¸ºåœ¨åº”ç”¨è¿‡ç¨‹ä¹‹é—´ä¼ é€çš„ä¿¡æ¯æä¾›è¡¨ç¤ºæ–¹æ³•çš„æœåŠ¡ï¼Œå®ƒå…³å¿ƒçš„åªæ˜¯å‘å‡ºä¿¡æ¯çš„è¯­æ³•ä¸è¯­ä¹‰ã€‚è¡¨ç¤ºå±‚è¦å®ŒæˆæŸäº›ç‰¹å®šçš„åŠŸèƒ½ï¼Œä¸»è¦æœ‰ä¸åŒæ•°æ®ç¼–ç æ ¼å¼çš„è½¬æ¢ï¼Œæä¾›æ•°æ®å‹ç¼©ã€è§£å‹ç¼©æœåŠ¡ï¼Œå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ã€è§£å¯†ã€‚~~</p>
</blockquote>
<h3 id="åº”ç”¨å±‚"><a class="markdownIt-Anchor" href="#åº”ç”¨å±‚"></a> åº”ç”¨å±‚</h3>
<blockquote>
<p>åº”ç”¨å±‚ï¼ˆapplication layerï¼‰é€šè¿‡åº”ç”¨è¿›ç¨‹é—´çš„äº¤äº’æ¥å®Œæˆç‰¹å®šç½‘ç»œåº”ç”¨ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹é—´é€šä¿¡å’Œäº¤äº’çš„è§„åˆ™ã€‚</p>
<p>æ‰©å±•é˜…è¯»ï¼š<a href="network-application.md">è®¡ç®—æœºç½‘ç»œä¹‹åº”ç”¨å±‚</a></p>
</blockquote>
<ul>
<li>å…³é”®è¯ï¼š<code>HTTP</code>ã€<code>DNS</code>ã€<code>FTP</code>ã€<code>TELNET</code>ã€<code>DHCP</code></li>
<li>ä¸»è¦åè®®ï¼š<code>HTTP</code>ã€<code>DNS</code>ã€<code>SMTP</code>ã€<code>Telnet</code>ã€<code>FTP</code>ã€<code>SNMP</code> ç­‰ã€‚</li>
<li>æ•°æ®å•å…ƒï¼šæŠ¥æ–‡ï¼ˆmessageï¼‰ã€‚</li>
</ul>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
<ul>
<li>ä¹¦
<ul>
<li><a href="https://book.douban.com/subject/10746113/" target="_blank" rel="noopener">HTTP æƒå¨æŒ‡å—</a></li>
<li><a href="https://book.douban.com/subject/1088054/" target="_blank" rel="noopener">TCP/IP è¯¦è§£ å· 1ï¼šåè®®</a></li>
<li><a href="https://book.douban.com/subject/1087767/" target="_blank" rel="noopener">TCP/IP è¯¦è§£ å· 2ï¼šå®ç°</a></li>
<li><a href="https://book.douban.com/subject/1058634/" target="_blank" rel="noopener">TCP/IP è¯¦è§£ å· 3ï¼šTCP äº‹åŠ¡åè®®ã€HTTPã€NNTP å’Œ UNIX åŸŸåè®®</a></li>
<li><a href="https://book.douban.com/subject/25856314/" target="_blank" rel="noopener">Webæ€§èƒ½æƒå¨æŒ‡å—</a></li>
<li><a href="https://book.douban.com/subject/25863515/" target="_blank" rel="noopener">å›¾è§£ HTTP</a></li>
<li><a href="https://book.douban.com/subject/24737674/" target="_blank" rel="noopener">å›¾è§£TCP/IP</a></li>
<li><a href="https://book.douban.com/subject/26960678/" target="_blank" rel="noopener">è®¡ç®—æœºç½‘ç»œï¼ˆç¬¬7ç‰ˆï¼‰</a> - è°¢å¸Œä»</li>
</ul>
</li>
<li>ç«™ç‚¹
<ul>
<li><a href="https://www.rfc-editor.org/" target="_blank" rel="noopener">https://www.rfc-editor.org/</a> - åœ¨çº¿æŸ¥é˜…ã€ä¸‹è½½ RFC æ–‡æ¡£</li>
</ul>
</li>
<li>å·¥å…·
<ul>
<li><a href="https://www.wireshark.org/" target="_blank" rel="noopener">WireShark</a></li>
<li><a href="https://www.getpostman.com/" target="_blank" rel="noopener">Postman</a></li>
</ul>
</li>
</ul>
<h2 id="ä¼ é€é—¨"><a class="markdownIt-Anchor" href="#ä¼ é€é—¨"></a> ğŸšª ä¼ é€é—¨</h2>
<p>| <a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">å›é¦–é </a> |</p>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œåè®®ä¹‹ DNS</title>
    <url>/blog/communication/dns/</url>
    <content><![CDATA[<blockquote>
<p>åŸŸåç³»ç»Ÿï¼ˆè‹±æ–‡ï¼šDomain Name Systemï¼Œç¼©å†™ï¼šDNSï¼‰æ˜¯äº’è”ç½‘çš„ä¸€é¡¹æœåŠ¡ã€‚å®ƒä½œä¸ºå°†åŸŸåå’Œ IP åœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œèƒ½å¤Ÿä½¿äººæ›´æ–¹ä¾¿åœ°è®¿é—®äº’è”ç½‘ã€‚DNS ä½¿ç”¨ TCP å’Œ UDP ç«¯å£ 53ã€‚å½“å‰ï¼Œå¯¹äºæ¯ä¸€çº§åŸŸåé•¿åº¦çš„é™åˆ¶æ˜¯ 63 ä¸ªå­—ç¬¦ï¼ŒåŸŸåæ€»é•¿åº¦åˆ™ä¸èƒ½è¶…è¿‡ 253 ä¸ªå­—ç¬¦ã€‚</p>
<p>å…³é”®è¯ï¼šDNS, åŸŸåè§£æ</p>
</blockquote>
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯-dns"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-dns"></a> ä»€ä¹ˆæ˜¯ DNS</h3>
<p>DNS æ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®®ã€‚</p>
<p>åŸŸåç³»ç»Ÿ (DNS) çš„ä½œç”¨æ˜¯å°†äººç±»å¯è¯»çš„åŸŸå (å¦‚ï¼Œ<a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a>) è½¬æ¢ä¸ºæœºå™¨å¯è¯»çš„ IP åœ°å€ (å¦‚ï¼Œ192.0.2.44)ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯åŸŸå"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯åŸŸå"></a> ä»€ä¹ˆæ˜¯åŸŸå</h3>
<p>åŸŸåæ˜¯ç”±ä¸€ä¸²ç”¨ç‚¹åˆ†éš”ç¬¦ <code>.</code> ç»„æˆçš„äº’è”ç½‘ä¸ŠæŸä¸€å°è®¡ç®—æœºæˆ–è®¡ç®—æœºç»„çš„åç§°ï¼Œç”¨äºåœ¨æ•°æ®ä¼ è¾“æ—¶æ ‡è¯†è®¡ç®—æœºçš„æ–¹ä½ã€‚åŸŸåå¯ä»¥è¯´æ˜¯ä¸€ä¸ª IP åœ°å€çš„ä»£ç§°ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¾¿äºè®°å¿†åè€…ã€‚ä¾‹å¦‚ï¼Œ<a href="http://wikipedia.org" target="_blank" rel="noopener">wikipedia.org</a> æ˜¯ä¸€ä¸ªåŸŸåï¼Œå’Œ IP åœ°å€ 208.80.152.2 ç›¸å¯¹åº”ã€‚äººä»¬å¯ä»¥ç›´æ¥è®¿é—® <a href="http://wikipedia.org" target="_blank" rel="noopener">wikipedia.org</a> æ¥ä»£æ›¿ IP åœ°å€ï¼Œç„¶ååŸŸåç³»ç»Ÿï¼ˆDNSï¼‰å°±ä¼šå°†å®ƒè½¬åŒ–æˆä¾¿äºæœºå™¨è¯†åˆ«çš„ IP åœ°å€ã€‚è¿™æ ·ï¼Œäººä»¬åªéœ€è¦è®°å¿† <a href="http://wikipedia.org" target="_blank" rel="noopener">wikipedia.org</a> è¿™ä¸€ä¸²å¸¦æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ï¼Œè€Œä¸éœ€è¦è®°å¿†æ²¡æœ‰å«ä¹‰çš„æ•°å­—ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/application/dns/dns-domain.png!zp"/></div>
<h3 id="dns-çš„åˆ†å±‚"><a class="markdownIt-Anchor" href="#dns-çš„åˆ†å±‚"></a> DNS çš„åˆ†å±‚</h3>
<p><strong>åŸŸåç³»ç»Ÿæ˜¯åˆ†å±‚æ¬¡çš„ã€‚</strong></p>
<p>åœ¨åŸŸåç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„ä¸­ï¼Œå„ç§åŸŸåéƒ½éš¶å±äºåŸŸåç³»ç»Ÿæ ¹åŸŸçš„ä¸‹çº§ã€‚åŸŸåçš„ç¬¬ä¸€çº§æ˜¯é¡¶çº§åŸŸï¼Œå®ƒåŒ…æ‹¬é€šç”¨é¡¶çº§åŸŸï¼Œä¾‹å¦‚ <code>.com</code>ã€<code>.net</code> å’Œ <code>.org</code>ï¼›ä»¥åŠå›½å®¶å’Œåœ°åŒºé¡¶çº§åŸŸï¼Œä¾‹å¦‚ <code>.us</code>ã€<code>.cn</code> å’Œ <code>.tk</code>ã€‚é¡¶çº§åŸŸåä¸‹ä¸€å±‚æ˜¯äºŒçº§åŸŸåï¼Œä¸€çº§ä¸€çº§åœ°å¾€ä¸‹ã€‚è¿™äº›åŸŸåå‘äººä»¬æä¾›æ³¨å†ŒæœåŠ¡ï¼Œäººä»¬å¯ä»¥ç”¨å®ƒåˆ›å»ºå…¬å¼€çš„äº’è”ç½‘èµ„æºæˆ–è¿è¡Œç½‘ç«™ã€‚é¡¶çº§åŸŸåçš„ç®¡ç†æœåŠ¡ç”±å¯¹åº”çš„åŸŸåæ³¨å†Œç®¡ç†æœºæ„ï¼ˆåŸŸåæ³¨å†Œå±€ï¼‰è´Ÿè´£ï¼Œæ³¨å†ŒæœåŠ¡é€šå¸¸ç”±åŸŸåæ³¨å†Œå•†è´Ÿè´£ã€‚</p>
<h3 id="dns-æœåŠ¡ç±»å‹"><a class="markdownIt-Anchor" href="#dns-æœåŠ¡ç±»å‹"></a> DNS æœåŠ¡ç±»å‹</h3>
<ul>
<li><strong>æˆæƒå‹ DNS</strong> - ä¸€ç§æˆæƒå‹ DNS æœåŠ¡æä¾›ä¸€ç§æ›´æ–°æœºåˆ¶ï¼Œä¾›å¼€å‘äººå‘˜ç”¨äºç®¡ç†å…¶å…¬ç”¨ DNS åç§°ã€‚ç„¶åï¼Œå®ƒå“åº” DNS æŸ¥è¯¢ï¼Œå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€ï¼Œä»¥ä¾¿è®¡ç®—æœºå¯ä»¥ç›¸äº’é€šä¿¡ã€‚æˆæƒå‹ DNS å¯¹åŸŸæœ‰æœ€ç»ˆæˆæƒä¸”è´Ÿè´£æä¾›é€’å½’å‹ DNS æœåŠ¡å™¨å¯¹ IP åœ°å€ä¿¡æ¯çš„å“åº”ã€‚Amazon Route 53 æ˜¯ä¸€ç§æˆæƒå‹ DNS ç³»ç»Ÿã€‚</li>
<li><strong>é€’å½’å‹ DNS</strong> - å®¢æˆ·ç«¯é€šå¸¸ä¸ä¼šå¯¹æˆæƒå‹ DNS æœåŠ¡ç›´æ¥è¿›è¡ŒæŸ¥è¯¢ã€‚è€Œæ˜¯é€šå¸¸è¿æ¥åˆ°ç§°ä¸ºè§£æç¨‹åºçš„å…¶ä»–ç±»å‹ DNS æœåŠ¡ï¼Œæˆ–é€’å½’å‹ DNS æœåŠ¡ã€‚é€’å½’å‹ DNS æœåŠ¡å°±åƒæ˜¯æ—…é¦†çš„é—¨ç«¥ï¼šå°½ç®¡æ²¡æœ‰ä»»ä½•è‡ªèº«çš„ DNS è®°å½•ï¼Œä½†æ˜¯å¯å……å½“ä»£è¡¨æ‚¨è·å¾— DNS ä¿¡æ¯çš„ä¸­é—´ç¨‹åºã€‚å¦‚æœé€’å½’å‹ DNS æ‹¥æœ‰å·²ç¼“å­˜æˆ–å­˜å‚¨ä¸€æ®µæ—¶é—´çš„ DNS å‚è€ƒï¼Œé‚£ä¹ˆå®ƒä¼šé€šè¿‡æä¾›æºæˆ– IP ä¿¡æ¯æ¥å“åº” DNS æŸ¥è¯¢ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™å®ƒä¼šå°†æŸ¥è¯¢ä¼ é€’åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæˆæƒå‹ DNS æœåŠ¡å™¨ä»¥æŸ¥æ‰¾ä¿¡æ¯ã€‚</li>
</ul>
<h3 id="è®°å½•ç±»å‹"><a class="markdownIt-Anchor" href="#è®°å½•ç±»å‹"></a> è®°å½•ç±»å‹</h3>
<p>DNS ä¸­ï¼Œå¸¸è§çš„èµ„æºè®°å½•ç±»å‹æœ‰ï¼š</p>
<ul>
<li><strong>NS è®°å½•ï¼ˆåŸŸåæœåŠ¡ï¼‰</strong> â”€ æŒ‡å®šè§£æåŸŸåæˆ–å­åŸŸåçš„ DNS æœåŠ¡å™¨ã€‚</li>
<li><strong>MX è®°å½•ï¼ˆé‚®ä»¶äº¤æ¢ï¼‰</strong> â”€ æŒ‡å®šæ¥æ”¶ä¿¡æ¯çš„é‚®ä»¶æœåŠ¡å™¨ã€‚</li>
<li><strong>A è®°å½•ï¼ˆåœ°å€ï¼‰</strong> â”€ æŒ‡å®šåŸŸåå¯¹åº”çš„ IPv4 åœ°å€è®°å½•ã€‚</li>
<li><strong>AAAA è®°å½•ï¼ˆåœ°å€ï¼‰</strong> â”€ æŒ‡å®šåŸŸåå¯¹åº”çš„ IPv6 åœ°å€è®°å½•ã€‚</li>
<li><strong>CNAMEï¼ˆè§„èŒƒï¼‰</strong> â”€ ä¸€ä¸ªåŸŸåæ˜ å°„åˆ°å¦ä¸€ä¸ªåŸŸåæˆ– <code>CNAME</code> è®°å½•ï¼ˆ <a href="http://example.com" target="_blank" rel="noopener">example.com</a> æŒ‡å‘ <a href="http://www.example.com/" target="_blank" rel="noopener">www.example.com</a> ï¼‰æˆ–æ˜ å°„åˆ°ä¸€ä¸ª <code>A</code>è®°å½•ã€‚</li>
<li><strong>PTR è®°å½•ï¼ˆåå‘è®°å½•ï¼‰</strong> â”€ PTR è®°å½•ç”¨äºå®šä¹‰ä¸ IP åœ°å€ç›¸å…³è”çš„åç§°ã€‚ PTR è®°å½•æ˜¯ A æˆ– AAAA è®°å½•çš„é€†ã€‚ PTR è®°å½•æ˜¯å”¯ä¸€çš„ï¼Œå› ä¸ºå®ƒä»¬ä»¥ .arpa æ ¹å¼€å§‹å¹¶è¢«å§”æ´¾ç»™ IP åœ°å€çš„æ‰€æœ‰è€…ã€‚</li>
</ul>
<blockquote>
<p>è¯¦ç»†å¯ä»¥å‚è€ƒï¼š<a href="https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%B0%E5%BD%95%E7%B1%BB%E5%9E%8B%E5%88%97%E8%A1%A8" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘ - åŸŸåæœåŠ¡å™¨è®°å½•ç±»å‹åˆ—è¡¨</a></p>
</blockquote>
<h2 id="åŸŸåè§£æ"><a class="markdownIt-Anchor" href="#åŸŸåè§£æ"></a> åŸŸåè§£æ</h2>
<p>ä¸»æœºååˆ° IP åœ°å€çš„æ˜ å°„æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li><strong>é™æ€æ˜ å°„</strong> - åœ¨æœ¬æœºä¸Šé…ç½®åŸŸåå’Œ IP çš„æ˜ å°„ï¼Œæ—¨åœ¨æœ¬æœºä¸Šä½¿ç”¨ã€‚Windows å’Œ Linux çš„ hosts æ–‡ä»¶ä¸­çš„å†…å®¹å°±å±äºé™æ€æ˜ å°„ã€‚</li>
<li><strong>åŠ¨æ€æ˜ å°„</strong> - å»ºç«‹ä¸€å¥—åŸŸåè§£æç³»ç»Ÿï¼ˆDNSï¼‰ï¼Œåªåœ¨ä¸“é—¨çš„ DNS æœåŠ¡å™¨ä¸Šé…ç½®ä¸»æœºåˆ° IP åœ°å€çš„æ˜ å°„ï¼Œç½‘ç»œä¸Šéœ€è¦ä½¿ç”¨ä¸»æœºåé€šä¿¡çš„è®¾å¤‡ï¼Œé¦–å…ˆéœ€è¦åˆ° DNS æœåŠ¡å™¨æŸ¥è¯¢ä¸»æœºæ‰€å¯¹åº”çš„ IP åœ°å€ã€‚</li>
</ul>
<p>é€šè¿‡åŸŸåå»æŸ¥è¯¢åŸŸåæœåŠ¡å™¨ï¼Œå¾—åˆ° IP åœ°å€çš„è¿‡ç¨‹å«åšåŸŸåè§£æã€‚åœ¨è§£æåŸŸåæ—¶ï¼Œä¸€èˆ¬å…ˆé™æ€åŸŸåè§£æï¼Œå†åŠ¨æ€è§£æåŸŸåã€‚å¯ä»¥å°†ä¸€äº›å¸¸ç”¨çš„åŸŸåæ”¾å…¥é™æ€åŸŸåè§£æè¡¨ä¸­ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜åŸŸåè§£ææ•ˆç‡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/network/application/dns/dns-resolve.png!zp"/></div>
<p>ä¸Šå›¾å±•ç¤ºäº†ä¸€ä¸ªåŠ¨æ€åŸŸåè§£æçš„æµç¨‹ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç”¨æˆ·æ‰“å¼€ Web æµè§ˆå™¨ï¼Œåœ¨åœ°å€æ ä¸­è¾“å…¥ <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a>ï¼Œç„¶åæŒ‰ Enter é”®ã€‚</li>
<li><a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> çš„è¯·æ±‚è¢«è·¯ç”±åˆ° DNS è§£æç¨‹åºï¼Œè¿™ä¸€èˆ¬ç”±ç”¨æˆ·çš„ Internet æœåŠ¡æä¾›å•† (ISP) è¿›è¡Œç®¡ç†ï¼Œä¾‹å¦‚æœ‰çº¿ Internet æœåŠ¡æä¾›å•†ã€DSL å®½å¸¦æä¾›å•†æˆ–å…¬å¸ç½‘ç»œã€‚</li>
<li>ISP çš„ DNS è§£æç¨‹åºå°† <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> çš„è¯·æ±‚è½¬å‘åˆ° DNS æ ¹åç§°æœåŠ¡å™¨ã€‚</li>
<li>ISP çš„ DNS è§£æç¨‹åºå†æ¬¡è½¬å‘ <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> çš„è¯·æ±‚ï¼Œè¿™æ¬¡è½¬å‘åˆ° .com åŸŸçš„ä¸€ä¸ª TLD åç§°æœåŠ¡å™¨ã€‚.com åŸŸçš„åç§°æœåŠ¡å™¨ä½¿ç”¨ä¸ <a href="http://example.com" target="_blank" rel="noopener">example.com</a> åŸŸç›¸å…³çš„å››ä¸ª Amazon Route 53 åç§°æœåŠ¡å™¨çš„åç§°æ¥å“åº”è¯¥è¯·æ±‚ã€‚</li>
<li>ISP çš„ DNS è§£æç¨‹åºé€‰æ‹©ä¸€ä¸ª Amazon Route 53 åç§°æœåŠ¡å™¨ï¼Œå¹¶å°† <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> çš„è¯·æ±‚è½¬å‘åˆ°è¯¥åç§°æœåŠ¡å™¨ã€‚</li>
<li>Amazon Route 53 åç§°æœåŠ¡å™¨åœ¨ <a href="http://example.com" target="_blank" rel="noopener">example.com</a> æ‰˜ç®¡åŒºåŸŸä¸­æŸ¥æ‰¾ <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> è®°å½•ï¼Œè·å¾—ç›¸å…³å€¼ï¼Œä¾‹å¦‚ï¼ŒWeb æœåŠ¡å™¨çš„ IP åœ°å€ (192.0.2.44)ï¼Œå¹¶å°† IP åœ°å€è¿”å›è‡³ DNS è§£æç¨‹åºã€‚</li>
<li>ISP çš„ DNS è§£æç¨‹åºæœ€ç»ˆè·å¾—ç”¨æˆ·éœ€è¦çš„ IP åœ°å€ã€‚è§£æç¨‹åºå°†æ­¤å€¼è¿”å›è‡³ Web æµè§ˆå™¨ã€‚DNS è§£æç¨‹åºè¿˜ä¼šå°† <a href="http://example.com" target="_blank" rel="noopener">example.com</a> çš„ IP åœ°å€ç¼“å­˜ (å­˜å‚¨) æ‚¨æŒ‡å®šçš„æ—¶é•¿ï¼Œä»¥ä¾¿å®ƒèƒ½å¤Ÿåœ¨ä¸‹æ¬¡æœ‰äººæµè§ˆ <a href="http://example.com" target="_blank" rel="noopener">example.com</a> æ—¶æ›´å¿«åœ°ä½œå‡ºå“åº”ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…å­˜æ´»æœŸ (TTL)ã€‚</li>
<li>Web æµè§ˆå™¨å°† <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> çš„è¯·æ±‚å‘é€åˆ°ä» DNS è§£æç¨‹åºä¸­è·å¾—çš„ IP åœ°å€ã€‚è¿™æ˜¯æ‚¨çš„å†…å®¹æ‰€å¤„ä½ç½®ï¼Œä¾‹å¦‚ï¼Œåœ¨ Amazon EC2 å®ä¾‹ä¸­æˆ–é…ç½®ä¸ºç½‘ç«™ç»ˆç«¯èŠ‚ç‚¹çš„ Amazon S3 å­˜å‚¨æ¡¶ä¸­è¿è¡Œçš„ Web æœåŠ¡å™¨ã€‚</li>
<li>192.0.2.44 ä¸Šçš„ Web æœåŠ¡å™¨æˆ–å…¶ä»–èµ„æºå°† <a href="http://www.example.com" target="_blank" rel="noopener">www.example.com</a> çš„ Web é¡µé¢è¿”å›åˆ° Web æµè§ˆå™¨ï¼Œä¸” Web æµè§ˆå™¨ä¼šæ˜¾ç¤ºè¯¥é¡µé¢ã€‚</li>
</ol>
<blockquote>
<p>ğŸ”” æ³¨æ„ï¼šåªæœ‰é…ç½®äº†åŸŸåæœåŠ¡å™¨ï¼Œæ‰èƒ½æ‰§è¡ŒåŸŸåè§£æã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ Linux ä¸­æ‰§è¡Œ <code>vim /etc/resolv.conf</code> å‘½ä»¤ï¼Œåœ¨å…¶ä¸­æ·»åŠ ä¸‹é¢çš„å†…å®¹æ¥é…ç½®åŸŸåæœåŠ¡å™¨åœ°å€ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">nameserver <span class="number">218.2</span><span class="number">.135</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="linux-ä¸Šçš„åŸŸåç›¸å…³å‘½ä»¤"><a class="markdownIt-Anchor" href="#linux-ä¸Šçš„åŸŸåç›¸å…³å‘½ä»¤"></a> Linux ä¸Šçš„åŸŸåç›¸å…³å‘½ä»¤</h2>
<h3 id="hostname"><a class="markdownIt-Anchor" href="#hostname"></a> hostname</h3>
<blockquote>
<p>hostname å‘½ä»¤ç”¨äºæŸ¥çœ‹å’Œè®¾ç½®ç³»ç»Ÿçš„ä¸»æœºåç§°ã€‚ç¯å¢ƒå˜é‡ HOSTNAME ä¹Ÿä¿å­˜äº†å½“å‰çš„ä¸»æœºåã€‚åœ¨ä½¿ç”¨ hostname å‘½ä»¤è®¾ç½®ä¸»æœºååï¼Œç³»ç»Ÿå¹¶ä¸ä¼šæ°¸ä¹…ä¿å­˜æ–°çš„ä¸»æœºåï¼Œé‡æ–°å¯åŠ¨æœºå™¨ä¹‹åè¿˜æ˜¯åŸæ¥çš„ä¸»æœºåã€‚å¦‚æœéœ€è¦æ°¸ä¹…ä¿®æ”¹ä¸»æœºåï¼Œéœ€è¦åŒæ—¶ä¿®æ”¹ <code>/etc/hosts</code> å’Œ <code>/etc/sysconfig/network</code> çš„ç›¸å…³å†…å®¹ã€‚</p>
<p>å‚è€ƒï¼š<a href="http://man.linuxde.net/hostname" target="_blank" rel="noopener">http://man.linuxde.net/hostname</a></p>
</blockquote>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hostname</span><br><span class="line">AY1307311912260196fcZ</span><br></pre></td></tr></table></figure>
<h3 id="nslookup"><a class="markdownIt-Anchor" href="#nslookup"></a> nslookup</h3>
<blockquote>
<p>nslookup å‘½ä»¤æ˜¯å¸¸ç”¨åŸŸåæŸ¥è¯¢å·¥å…·ï¼Œå°±æ˜¯æŸ¥ DNS ä¿¡æ¯ç”¨çš„å‘½ä»¤ã€‚</p>
<p>å‚è€ƒï¼š<a href="http://man.linuxde.net/nslookup" target="_blank" rel="noopener">http://man.linuxde.net/nslookup</a></p>
</blockquote>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nslookup www.jsdig.com</span></span><br><span class="line">Server:         202.96.104.15</span><br><span class="line">Address:        202.96.104.15<span class="comment">#53</span></span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">www.jsdig.com canonical name = host.1.jsdig.com.</span><br><span class="line">Name:   host.1.jsdig.com</span><br><span class="line">Address: 100.42.212.8</span><br></pre></td></tr></table></figure>
<h2 id="æ›´å¤šå†…å®¹"><a class="markdownIt-Anchor" href="#æ›´å¤šå†…å®¹"></a> æ›´å¤šå†…å®¹</h2>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘ - åŸŸå</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘ - åŸŸåç³»ç»Ÿ</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%B0%E5%BD%95%E7%B1%BB%E5%9E%8B%E5%88%97%E8%A1%A8" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘ - åŸŸåæœåŠ¡å™¨è®°å½•ç±»å‹åˆ—è¡¨</a></li>
<li><a href="https://aws.amazon.com/cn/route53/what-is-dns/" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯ DNSï¼Ÿ</a></li>
<li><a href="https://tools.ietf.org/html/rfc1034" target="_blank" rel="noopener">RFC 1034</a></li>
<li><a href="https://tools.ietf.org/html/rfc1035" target="_blank" rel="noopener">RFC 1035</a></li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
        <tag>åè®®</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</title>
    <url>/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/dispensables" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/dispensables</a></p>
<p><strong>éå¿…è¦çš„(Dispensables)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šè¿™æ ·çš„ä»£ç å¯æœ‰å¯æ— ï¼Œå®ƒçš„å­˜åœ¨åè€Œå½±å“æ•´ä½“ä»£ç çš„æ•´æ´å’Œå¯è¯»æ€§ã€‚</strong></p>
</blockquote>
<h2 id="å†—ä½™ç±»"><a class="markdownIt-Anchor" href="#å†—ä½™ç±»"></a> å†—ä½™ç±»</h2>
<blockquote>
<p>å†—ä½™ç±»(Lazy Class)</p>
<p>ç†è§£å’Œç»´æŠ¤æ€»æ˜¯è´¹æ—¶è´¹åŠ›çš„ã€‚å¦‚æœä¸€ä¸ªç±»ä¸å€¼å¾—ä½ èŠ±è´¹ç²¾åŠ›ï¼Œå®ƒå°±åº”è¯¥è¢«åˆ é™¤ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/lazy-class-1.png"/></div>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>ä¹Ÿè®¸ä¸€ä¸ªç±»çš„åˆå§‹è®¾è®¡æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå…¨çš„ç±»ï¼Œç„¶è€Œéšç€ä»£ç çš„å˜è¿ï¼Œå˜å¾—æ²¡ä»€ä¹ˆç”¨äº†ã€‚<br />
åˆæˆ–è€…ç±»èµ·åˆçš„è®¾è®¡æ˜¯ä¸ºäº†æ”¯æŒæœªæ¥çš„åŠŸèƒ½æ‰©å±•ï¼Œç„¶è€Œå´ä¸€ç›´æœªæ´¾ä¸Šç”¨åœºã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>æ²¡ä»€ä¹ˆç”¨çš„ç±»å¯ä»¥è¿ç”¨ <code>å°†ç±»å†…è”åŒ–(Inline Class)</code> æ¥å¹²æ‰ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/lazy-class-2.png"/></div>
<ul>
<li>å¦‚æœå­ç±»ç”¨å¤„ä¸å¤§ï¼Œè¯•è¯• <code>æŠ˜å ç»§æ‰¿ä½“ç³»(Collapse Hierarchy)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘ä»£ç é‡</li>
<li>æ˜“äºç»´æŠ¤</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶ï¼Œåˆ›å»ºå†—ä½™ç±»æ˜¯ä¸ºäº†æè¿°æœªæ¥å¼€å‘çš„æ„å›¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°è¯•åœ¨ä»£ç ä¸­ä¿æŒæ¸…æ™°å’Œç®€å•ä¹‹é—´çš„å¹³è¡¡ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="å°†ç±»å†…è”åŒ–inline-class"><a class="markdownIt-Anchor" href="#å°†ç±»å†…è”åŒ–inline-class"></a> å°†ç±»å†…è”åŒ–(Inline Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»æ²¡æœ‰åšå¤ªå¤šäº‹æƒ…ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªç±»çš„æ‰€æœ‰ç‰¹æ€§æ¬ç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­ï¼Œç„¶åç§»é™¤åŸç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-after.png"/></div>
<h4 id="æŠ˜å ç»§æ‰¿ä½“ç³»collapse-hierarchy"><a class="markdownIt-Anchor" href="#æŠ˜å ç»§æ‰¿ä½“ç³»collapse-hierarchy"></a> æŠ˜å ç»§æ‰¿ä½“ç³»(Collapse Hierarchy)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>è¶…ç±»å’Œå­ç±»ä¹‹é—´æ— å¤ªå¤§åŒºåˆ«ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/collapse-hierarchy-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†å®ƒä»¬åˆä¸ºä¸€ä½“ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/collapse-hierarchy-after.png"/></div>
<h2 id="å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§"><a class="markdownIt-Anchor" href="#å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§"></a> å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§</h2>
<blockquote>
<p>å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§(Speculative Generality)</p>
<p>å­˜åœ¨æœªè¢«ä½¿ç”¨çš„ç±»ã€å‡½æ•°ã€å­—æ®µæˆ–å‚æ•°ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/speculative-generality-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>æœ‰æ—¶ï¼Œä»£ç ä»…ä»…ä¸ºäº†æ”¯æŒæœªæ¥çš„ç‰¹æ€§è€Œäº§ç”Ÿï¼Œç„¶è€Œå´ä¸€ç›´æœªå®ç°ã€‚ç»“æœï¼Œä»£ç å˜å¾—éš¾ä»¥ç†è§£å’Œç»´æŠ¤ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä½ çš„æŸä¸ªæŠ½è±¡ç±»å…¶å®æ²¡æœ‰å¤ªå¤§ä½œç”¨ï¼Œè¯·è¿ç”¨ <code>æŠ˜å ç»§æ‰¿ä½“ç³»(Collapse Hierarch)</code> ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/speculative-generality-2.png"/></div>
<ul>
<li>ä¸å¿…è¦çš„å§”æ‰˜å¯è¿ç”¨ <code>å°†ç±»å†…è”åŒ–(Inline Class)</code> æ¶ˆé™¤ã€‚</li>
<li>æ— ç”¨çš„å‡½æ•°å¯è¿ç”¨ <code>å†…è”å‡½æ•°(Inline Method)</code> æ¶ˆé™¤ã€‚</li>
<li>å‡½æ•°ä¸­æœ‰æ— ç”¨çš„å‚æ•°åº”è¯¥è¿ç”¨ <code>ç§»é™¤å‚æ•°(Remove Parameter)</code> æ¶ˆé™¤ã€‚</li>
<li>æ— ç”¨å­—æ®µå¯ä»¥ç›´æ¥åˆ é™¤ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘ä»£ç é‡ã€‚</li>
<li>æ›´æ˜“ç»´æŠ¤ã€‚</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥-2"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-2"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>å¦‚æœä½ åœ¨ä¸€ä¸ªæ¡†æ¶ä¸Šå·¥ä½œï¼Œåˆ›å»ºæ¡†æ¶æœ¬èº«æ²¡æœ‰ä½¿ç”¨çš„åŠŸèƒ½æ˜¯éå¸¸åˆç†çš„ï¼Œåªè¦æ¡†æ¶çš„ç”¨æˆ·éœ€è¦è¿™ä¸ªåŠŸèƒ½ã€‚</li>
<li>åˆ é™¤å…ƒç´ ä¹‹å‰ï¼Œè¯·ç¡®ä¿å®ƒä»¬ä¸åœ¨å•å…ƒæµ‹è¯•ä¸­ä½¿ç”¨ã€‚å¦‚æœæµ‹è¯•éœ€è¦ä»ç±»ä¸­è·å–æŸäº›å†…éƒ¨ä¿¡æ¯æˆ–æ‰§è¡Œç‰¹æ®Šçš„æµ‹è¯•ç›¸å…³æ“ä½œï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æŠ˜å ç»§æ‰¿ä½“ç³»collapse-hierarchy-2"><a class="markdownIt-Anchor" href="#æŠ˜å ç»§æ‰¿ä½“ç³»collapse-hierarchy-2"></a> æŠ˜å ç»§æ‰¿ä½“ç³»(Collapse Hierarchy)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>è¶…ç±»å’Œå­ç±»ä¹‹é—´æ— å¤ªå¤§åŒºåˆ«ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/collapse-hierarchy-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†å®ƒä»¬åˆä¸ºä¸€ä½“ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/collapse-hierarchy-after.png"/></div>
<h4 id="å°†ç±»å†…è”åŒ–inline-class-2"><a class="markdownIt-Anchor" href="#å°†ç±»å†…è”åŒ–inline-class-2"></a> å°†ç±»å†…è”åŒ–(Inline Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»æ²¡æœ‰åšå¤ªå¤šäº‹æƒ…ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªç±»çš„æ‰€æœ‰ç‰¹æ€§æ¬ç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­ï¼Œç„¶åç§»é™¤åŸç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-after.png"/></div>
<h4 id="å†…è”å‡½æ•°inline-method"><a class="markdownIt-Anchor" href="#å†…è”å‡½æ•°inline-method"></a> å†…è”å‡½æ•°(Inline Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸€ä¸ªå‡½æ•°çš„æœ¬ä½“æ¯”å‡½æ•°åæ›´æ¸…æ¥šæ˜“æ‡‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PizzaDelivery</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">getRating</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> moreThanFiveLateDeliveries() ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">moreThanFiveLateDeliveries</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> numberOfLateDeliveries &gt; <span class="number">5</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>åœ¨å‡½æ•°è°ƒç”¨ç‚¹æ’å…¥å‡½æ•°æœ¬ä½“ï¼Œç„¶åç§»é™¤è¯¥å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PizzaDelivery</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">getRating</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> numberOfLateDeliveries &gt; <span class="number">5</span> ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç§»é™¤å‚æ•°remove-parameter"><a class="markdownIt-Anchor" href="#ç§»é™¤å‚æ•°remove-parameter"></a> ç§»é™¤å‚æ•°(Remove Parameter)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å‡½æ•°æœ¬ä½“ä¸å†éœ€è¦æŸä¸ªå‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-parameter-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¯¥å‚æ•°å»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-parameter-after.png"/></div>
<h2 id="çº¯ç¨šçš„æ•°æ®ç±»"><a class="markdownIt-Anchor" href="#çº¯ç¨šçš„æ•°æ®ç±»"></a> çº¯ç¨šçš„æ•°æ®ç±»</h2>
<blockquote>
<p><code>çº¯ç¨šçš„æ•°æ®ç±»(Data Class)</code> æŒ‡çš„æ˜¯åªåŒ…å«å­—æ®µå’Œè®¿é—®å®ƒä»¬çš„ getter å’Œ setter å‡½æ•°çš„ç±»ã€‚è¿™äº›ä»…ä»…æ˜¯ä¾›å…¶ä»–ç±»ä½¿ç”¨çš„æ•°æ®å®¹å™¨ã€‚è¿™äº›ç±»ä¸åŒ…å«ä»»ä½•é™„åŠ åŠŸèƒ½ï¼Œå¹¶ä¸”ä¸èƒ½å¯¹è‡ªå·±æ‹¥æœ‰çš„æ•°æ®è¿›è¡Œç‹¬ç«‹æ“ä½œã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/data-class-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>å½“ä¸€ä¸ªæ–°åˆ›å»ºçš„ç±»åªåŒ…å«å‡ ä¸ªå…¬å…±å­—æ®µï¼ˆç”šè‡³å¯èƒ½å‡ ä¸ª getters / settersï¼‰æ˜¯å¾ˆæ­£å¸¸çš„ã€‚ä½†æ˜¯å¯¹è±¡çš„çœŸæ­£åŠ›é‡åœ¨äºå®ƒä»¬å¯ä»¥åŒ…å«ä½œç”¨äºæ•°æ®çš„è¡Œä¸ºç±»å‹æˆ–æ“ä½œã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-3"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-3"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä¸€ä¸ªç±»æœ‰å…¬å…±å­—æ®µï¼Œä½ åº”è¯¥è¿ç”¨ <code>å°è£…å­—æ®µ(Encapsulated Field)</code> æ¥éšè—å­—æ®µçš„ç›´æ¥è®¿é—®æ–¹å¼ã€‚</li>
<li>å¦‚æœè¿™äº›ç±»å«å®¹å™¨ç±»çš„å­—æ®µï¼Œä½ åº”è¯¥æ£€æŸ¥å®ƒä»¬æ˜¯ä¸æ˜¯å¾—åˆ°äº†æ°å½“çš„å°è£…ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±è¿ç”¨ <code>å°è£…é›†åˆ(Encapsulated Collection)</code> æŠŠå®ƒä»¬å°è£…èµ·æ¥ã€‚</li>
<li>æ‰¾å‡ºè¿™äº› getter/setter å‡½æ•°è¢«å…¶ä»–ç±»è¿ç”¨çš„åœ°ç‚¹ã€‚å°è¯•ä»¥ <code>æ¬ç§»å‡½æ•°(Move Method)</code> æŠŠé‚£äº›è°ƒç”¨è¡Œä¸ºæ¬ç§»åˆ° <code>çº¯ç¨šçš„æ•°æ®ç±»(Data Class)</code> æ¥ã€‚å¦‚æœæ— æ³•æ¬ç§»è¿™ä¸ªå‡½æ•°ï¼Œå°±è¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> äº§ç”Ÿä¸€ä¸ªå¯æ¬ç§»çš„å‡½æ•°ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/data-class-2.png"/></div>
<ul>
<li>åœ¨ç±»å·²ç»å……æ»¡äº†æ·±æ€ç†Ÿè™‘çš„å‡½æ•°ä¹‹åï¼Œä½ å¯èƒ½æƒ³è¦æ‘†è„±æ—§çš„æ•°æ®è®¿é—®æ–¹æ³•ï¼Œä»¥æä¾›é€‚åº”é¢è¾ƒå¹¿çš„ç±»æ•°æ®è®¿é—®æ¥å£ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥è¿ç”¨ <code>ç§»é™¤è®¾ç½®å‡½æ•°(Remove Setting Method)</code> å’Œ <code>éšè—å‡½æ•°(Hide Method)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç çš„å¯è¯»æ€§å’Œç»„ç»‡æ€§ã€‚ç‰¹å®šæ•°æ®çš„æ“ä½œç°åœ¨è¢«é›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œè€Œä¸æ˜¯åœ¨åˆ†æ•£åœ¨ä»£ç å„å¤„ã€‚</li>
<li>å¸®åŠ©ä½ å‘ç°å®¢æˆ·ç«¯ä»£ç çš„é‡å¤å¤„ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="å°è£…å­—æ®µencapsulated-field"><a class="markdownIt-Anchor" href="#å°è£…å­—æ®µencapsulated-field"></a> å°è£…å­—æ®µ(Encapsulated Field)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç±»ä¸­å­˜åœ¨ public å­—æ®µã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="symbol">Person</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†å®ƒå£°æ˜ä¸º privateï¼Œå¹¶æä¾›ç›¸åº”çš„è®¿é—®å‡½æ•°ã€‚</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(<span class="keyword">String</span> arg)</span> </span>&#123;</span><br><span class="line">    name = arg;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å°è£…é›†åˆencapsulated-collection"><a class="markdownIt-Anchor" href="#å°è£…é›†åˆencapsulated-collection"></a> å°è£…é›†åˆ(Encapsulated Collection)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æœ‰ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªé›†åˆã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/encapsulate-collection-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>è®©è¯¥å‡½æ•°è¿”å›è¯¥é›†åˆçš„ä¸€ä¸ªåªè¯»å‰¯æœ¬ï¼Œå¹¶åœ¨è¿™ä¸ªç±»ä¸­æä¾›æ·»åŠ ã€ç§»é™¤é›†åˆå…ƒç´ çš„å‡½æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/encapsulate-collection-after.png"/></div>
<h4 id="æ¬ç§»å‡½æ•°move-method"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æç‚¼å‡½æ•°extract-method"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç§»é™¤è®¾ç½®å‡½æ•°remove-setting-method"><a class="markdownIt-Anchor" href="#ç§»é™¤è®¾ç½®å‡½æ•°remove-setting-method"></a> ç§»é™¤è®¾ç½®å‡½æ•°(Remove Setting Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ç±»ä¸­çš„æŸä¸ªå­—æ®µåº”è¯¥åœ¨å¯¹è±¡åˆ›å»ºæ—¶è¢«è®¾å€¼ï¼Œç„¶åå°±ä¸å†æ”¹å˜ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-setting-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»æ‰è¯¥å­—æ®µçš„æ‰€æœ‰è®¾å€¼å‡½æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-setting-method-after.png"/></div>
<h4 id="éšè—å‡½æ•°hide-method"><a class="markdownIt-Anchor" href="#éšè—å‡½æ•°hide-method"></a> éšè—å‡½æ•°(Hide Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œä»æ¥æ²¡æœ‰è¢«å…¶ä»–ä»»ä½•ç±»ç”¨åˆ°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªå‡½æ•°ä¿®æ”¹ä¸º privateã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-method-after.png"/></div>
<h2 id="è¿‡å¤šçš„æ³¨é‡Š"><a class="markdownIt-Anchor" href="#è¿‡å¤šçš„æ³¨é‡Š"></a> è¿‡å¤šçš„æ³¨é‡Š</h2>
<blockquote>
<p>è¿‡å¤šçš„æ³¨é‡Š(Comments)</p>
<p>æ³¨é‡Šæœ¬èº«å¹¶ä¸æ˜¯åäº‹ã€‚ä½†æ˜¯å¸¸å¸¸æœ‰è¿™æ ·çš„æƒ…å†µï¼šä¸€æ®µä»£ç ä¸­å‡ºç°é•¿é•¿çš„æ³¨é‡Šï¼Œè€Œå®ƒä¹‹æ‰€ä»¥å­˜åœ¨ï¼Œæ˜¯å› ä¸ºä»£ç å¾ˆç³Ÿç³•ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/comments-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -4"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -4"></a> é—®é¢˜åŸå› </h3>
<p>æ³¨é‡Šçš„ä½œè€…æ„è¯†åˆ°è‡ªå·±çš„ä»£ç ä¸ç›´è§‚æˆ–ä¸æ˜æ˜¾ï¼Œæ‰€ä»¥æƒ³ä½¿ç”¨æ³¨é‡Šæ¥è¯´æ˜è‡ªå·±çš„æ„å›¾ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ³¨é‡Šå°±åƒæ˜¯çƒ‚ä»£ç çš„é™¤è‡­å‰‚ã€‚</p>
<blockquote>
<p>æœ€å¥½çš„æ³¨é‡Šæ˜¯ä¸ºå‡½æ•°æˆ–ç±»èµ·ä¸€ä¸ªæ°å½“çš„åå­—ã€‚</p>
</blockquote>
<p>å¦‚æœä½ è§‰å¾—ä¸€ä¸ªä»£ç ç‰‡æ®µæ²¡æœ‰æ³¨é‡Šå°±æ— æ³•ç†è§£ï¼Œè¯·å…ˆå°è¯•é‡æ„ï¼Œè¯•ç€è®©æ‰€æœ‰æ³¨é‡Šéƒ½å˜å¾—å¤šä½™ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-4"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-4"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä¸€ä¸ªæ³¨é‡Šæ˜¯ä¸ºäº†è§£é‡Šä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥è¿ç”¨ <code>æç‚¼å˜é‡(Extract Variable)</code> å°†è¡¨è¾¾å¼åˆ‡åˆ†ä¸ºæ˜“ç†è§£çš„å­è¡¨è¾¾å¼ã€‚</li>
<li>å¦‚æœä½ éœ€è¦é€šè¿‡æ³¨é‡Šæ¥è§£é‡Šä¸€æ®µä»£ç åšäº†ä»€ä¹ˆï¼Œè¯·è¯•è¯• <code>æç‚¼å‡½æ•°(Extract Method)</code> ã€‚</li>
<li>å¦‚æœå‡½æ•°å·²ç»è¢«æç‚¼ï¼Œä½†ä»éœ€è¦æ³¨é‡Šå‡½æ•°åšäº†ä»€ä¹ˆï¼Œè¯•è¯•è¿ç”¨ <code>å‡½æ•°æ”¹å(Rename Method)</code> æ¥ä¸ºå‡½æ•°èµ·ä¸€ä¸ªå¯ä»¥è‡ªè§£é‡Šçš„åå­—ã€‚</li>
<li>å¦‚æœéœ€è¦å¯¹ç³»ç»ŸæŸçŠ¶æ€è¿›è¡Œæ–­è¨€ï¼Œè¯·è¿ç”¨ <code>å¼•å…¥æ–­è¨€(Introduce Assertion)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-4"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-4"></a> æ”¶ç›Š</h3>
<ul>
<li>ä»£ç å˜å¾—æ›´ç›´è§‚å’Œæ˜æ˜¾ã€‚</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥-3"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-3"></a> ä½•æ—¶å¿½ç•¥</h3>
<p>æ³¨é‡Šæœ‰æ—¶å€™å¾ˆæœ‰ç”¨ï¼š</p>
<ul>
<li>å½“è§£é‡Šä¸ºä»€ä¹ˆæŸäº‹ç‰©è¦ä»¥ç‰¹æ®Šæ–¹å¼å®ç°æ—¶ã€‚</li>
<li>å½“è§£é‡ŠæŸç§å¤æ‚ç®—æ³•æ—¶ã€‚</li>
<li>å½“ä½ å®åœ¨ä¸çŸ¥å¯ä»¥åšäº›ä»€ä¹ˆæ—¶ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-4"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-4"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼å˜é‡extract-variable"><a class="markdownIt-Anchor" href="#æç‚¼å˜é‡extract-variable"></a> æç‚¼å˜é‡(Extract Variable)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸ªéš¾ä»¥ç†è§£çš„è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">renderBanner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ((platform.toUpperCase().indexOf(<span class="string">"MAC"</span>) &gt; -<span class="number">1</span>) &amp;&amp;</span><br><span class="line">       (browser.toUpperCase().indexOf(<span class="string">"IE"</span>) &gt; -<span class="number">1</span>) &amp;&amp;</span><br><span class="line">        wasInitialized() &amp;&amp; resize &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†è¡¨è¾¾å¼çš„ç»“æœæˆ–å®ƒçš„å­è¡¨è¾¾å¼çš„ç»“æœç”¨ä¸è¨€è‡ªæ˜çš„å˜é‡æ¥æ›¿ä»£ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">renderBanner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">boolean</span> isMacOs = platform.toUpperCase().indexOf(<span class="string">"MAC"</span>) &gt; -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">boolean</span> isIE = browser.toUpperCase().indexOf(<span class="string">"IE"</span>) &gt; -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">boolean</span> wasResized = resize &gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isMacOs &amp;&amp; isIE &amp;&amp; wasInitialized() &amp;&amp; wasResized) &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æç‚¼å‡½æ•°extract-method-2"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method-2"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‡½æ•°æ”¹årename-method"><a class="markdownIt-Anchor" href="#å‡½æ•°æ”¹årename-method"></a> å‡½æ•°æ”¹å(Rename Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å‡½æ•°çš„åç§°æœªèƒ½æ°å½“çš„æ­ç¤ºå‡½æ•°çš„ç”¨é€”ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getsnm</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ä¿®æ”¹å‡½æ•°åã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getSecondName</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥æ–­è¨€introduce-assertion"><a class="markdownIt-Anchor" href="#å¼•å…¥æ–­è¨€introduce-assertion"></a> å¼•å…¥æ–­è¨€(Introduce Assertion)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸€æ®µä»£ç éœ€è¦å¯¹ç¨‹åºçŠ¶æ€åšå‡ºæŸç§å‡è®¾ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getExpenseLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// should have either expense limit or a primary project</span></span><br><span class="line">  <span class="keyword">return</span> (expenseLimit != NULL_EXPENSE) ?</span><br><span class="line">    expenseLimit:</span><br><span class="line">    primaryProject.getMemberExpenseLimit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ä»¥æ–­è¨€æ˜ç¡®è¡¨ç°è¿™ç§å‡è®¾ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getExpenseLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Assert.isTrue(expenseLimit != NULL_EXPENSE || primaryProject != <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (expenseLimit != NULL_EXPENSE) ?</span><br><span class="line">    expenseLimit:</span><br><span class="line">    primaryProject.getMemberExpenseLimit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>æ³¨ï¼šè¯·ä¸è¦æ»¥ç”¨æ–­è¨€ã€‚ä¸è¦ä½¿ç”¨å®ƒæ¥æ£€æŸ¥â€åº”è¯¥ä¸ºçœŸâ€œçš„æ¡ä»¶ï¼Œåªèƒ½ä½¿ç”¨å®ƒæ¥æ£€æŸ¥â€œä¸€å®šå¿…é¡»ä¸ºçœŸâ€çš„æ¡ä»¶ã€‚å®é™…ä¸Šï¼Œæ–­è¨€æ›´å¤šæ˜¯ç”¨äºè‡ªæˆ‘æ£€æµ‹ä»£ç çš„ä¸€ç§æ‰‹æ®µã€‚åœ¨äº§å“çœŸæ­£äº¤ä»˜æ—¶ï¼Œå¾€å¾€éƒ½ä¼šæ¶ˆé™¤æ‰€æœ‰æ–­è¨€ã€‚</em></p>
<h2 id="é‡å¤ä»£ç "><a class="markdownIt-Anchor" href="#é‡å¤ä»£ç "></a> é‡å¤ä»£ç </h2>
<blockquote>
<p>é‡å¤ä»£ç (Duplicate Code)</p>
<p>é‡å¤ä»£ç å ªç§°ä¸ºä»£ç åå‘³é“ä¹‹é¦–ã€‚æ¶ˆé™¤é‡å¤ä»£ç æ€»æ˜¯æœ‰åˆ©æ— å®³çš„ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/duplicate-code-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -5"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -5"></a> é—®é¢˜åŸå› </h3>
<p>é‡å¤ä»£ç é€šå¸¸å‘ç”Ÿåœ¨å¤šä¸ªç¨‹åºå‘˜åŒæ—¶åœ¨åŒä¸€ç¨‹åºçš„ä¸åŒéƒ¨åˆ†ä¸Šå·¥ä½œæ—¶ã€‚ç”±äºä»–ä»¬æ­£åœ¨å¤„ç†ä¸åŒçš„ä»»åŠ¡ï¼Œä»–ä»¬å¯èƒ½ä¸çŸ¥é“ä»–ä»¬çš„åŒäº‹å·²ç»å†™äº†ç±»ä¼¼çš„ä»£ç ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æ›´éšæ™¦çš„é‡å¤ï¼Œç‰¹å®šéƒ¨åˆ†çš„ä»£ç çœ‹ä¸Šå»ä¸åŒä½†å®é™…åœ¨åšåŒä¸€ä»¶äº‹ã€‚è¿™ç§é‡å¤ä»£ç å¾€å¾€éš¾ä»¥æ‰¾åˆ°å’Œæ¶ˆé™¤ã€‚</p>
<p>æœ‰æ—¶é‡å¤æ˜¯æœ‰ç›®çš„æ€§çš„ã€‚å½“æ€¥äºæ»¡è¶³ deadlineï¼Œå¹¶ä¸”ç°æœ‰ä»£ç å¯¹äºè¦äº¤ä»˜çš„ä»»åŠ¡æ˜¯â€œå‡ ä¹æ­£ç¡®çš„â€æ—¶ï¼Œæ–°æ‰‹ç¨‹åºå‘˜å¯èƒ½æ— æ³•æŠµæŠ—å¤åˆ¶å’Œç²˜è´´ç›¸å…³ä»£ç çš„è¯±æƒ‘ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¨‹åºå‘˜åªæ˜¯å¤ªæ‡’æƒ°ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-5"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-5"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>åŒä¸€ä¸ªç±»çš„ä¸¤ä¸ªå‡½æ•°å«æœ‰ç›¸åŒçš„è¡¨è¾¾å¼ï¼Œè¿™æ—¶å¯ä»¥é‡‡ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> æç‚¼å‡ºé‡å¤çš„ä»£ç ï¼Œç„¶åè®©è¿™ä¸¤ä¸ªåœ°ç‚¹éƒ½è°ƒç”¨è¢«æç‚¼å‡ºæ¥çš„é‚£æ®µä»£ç ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/duplicate-code-2.png"/></div>
<ul>
<li>å¦‚æœä¸¤ä¸ªäº’ä¸ºå…„å¼Ÿçš„å­ç±»å«æœ‰é‡å¤ä»£ç ï¼š
<ul>
<li>é¦–å…ˆå¯¹ä¸¤ä¸ªç±»éƒ½è¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> ï¼Œç„¶åå¯¹è¢«æç‚¼å‡ºæ¥çš„å‡½æ•°è¿ç”¨ <code>å‡½æ•°ä¸Šç§»(Pull Up Method)</code> ï¼Œå°†å®ƒæ¨å…¥è¶…ç±»ã€‚</li>
<li>å¦‚æœé‡å¤ä»£ç åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œè¿ç”¨ <code>æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»(Pull Up Constructor Body)</code> ã€‚</li>
<li>å¦‚æœé‡å¤ä»£ç åªæ˜¯ç›¸ä¼¼ä½†ä¸æ˜¯å®Œå…¨ç›¸åŒï¼Œè¿ç”¨ <code>å¡‘é€ æ¨¡æ¿å‡½æ•°(Form Template Method)</code> è·å¾—ä¸€ä¸ª <strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼(Template Method)</strong> ã€‚</li>
<li>å¦‚æœæœ‰äº›å‡½æ•°ä»¥ä¸åŒçš„ç®—æ³•åšç›¸åŒçš„äº‹ï¼Œä½ å¯ä»¥é€‰æ‹©å…¶ä¸­è¾ƒæ¸…æ™°åœ°ä¸€ä¸ªï¼Œå¹¶è¿ç”¨ <code>æ›¿æ¢ç®—æ³•(Substitute Algorithm)</code> å°†å…¶ä»–å‡½æ•°çš„ç®—æ³•æ›¿æ¢æ‰ã€‚</li>
</ul>
</li>
<li>å¦‚æœä¸¤ä¸ªæ¯«ä¸ç›¸å…³çš„ç±»ä¸­æœ‰é‡å¤ä»£ç ï¼š
<ul>
<li>è¯·å°è¯•è¿ç”¨ <code>æç‚¼è¶…ç±»(Extract Superclass)</code> ï¼Œä»¥ä¾¿ä¸ºç»´æŠ¤æ‰€æœ‰å…ˆå‰åŠŸèƒ½çš„è¿™äº›ç±»åˆ›å»ºä¸€ä¸ªè¶…ç±»ã€‚</li>
<li>å¦‚æœåˆ›å»ºè¶…ç±»ååˆ†å›°éš¾ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªç±»ä¸­è¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code> ï¼Œå¹¶åœ¨å¦ä¸€ä¸ªç±»ä¸­ä½¿ç”¨è¿™ä¸ªæ–°çš„ç»„ä»¶ã€‚</li>
</ul>
</li>
<li>å¦‚æœå­˜åœ¨å¤§é‡çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œå¹¶ä¸”å®ƒä»¬æ‰§è¡Œå®Œå…¨ç›¸åŒçš„ä»£ç ï¼ˆä»…ä»…æ˜¯å®ƒä»¬çš„æ¡ä»¶ä¸åŒï¼‰ï¼Œå¯ä»¥è¿ç”¨ <code>åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼(Consolidate Conditional Expression)</code> å°†è¿™äº›æ“ä½œåˆå¹¶ä¸ºå•ä¸ªæ¡ä»¶ï¼Œå¹¶è¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°†è¯¥æ¡ä»¶æ”¾å…¥ä¸€ä¸ªåå­—å®¹æ˜“ç†è§£çš„ç‹¬ç«‹å‡½æ•°ä¸­ã€‚</li>
<li>å¦‚æœæ¡ä»¶è¡¨è¾¾å¼çš„æ‰€æœ‰åˆ†æ”¯éƒ½æœ‰éƒ¨åˆ†ç›¸åŒçš„ä»£ç ç‰‡æ®µï¼šå¯ä»¥è¿ç”¨ <code>åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ(Consolidate Duplicate Conditional Fragments)</code> å°†å®ƒä»¬éƒ½å­˜åœ¨çš„ä»£ç ç‰‡æ®µç½®äºæ¡ä»¶è¡¨è¾¾å¼å¤–éƒ¨ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-5"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-5"></a> æ”¶ç›Š</h3>
<ul>
<li>åˆå¹¶é‡å¤ä»£ç ä¼šç®€åŒ–ä»£ç çš„ç»“æ„ï¼Œå¹¶å‡å°‘ä»£ç é‡ã€‚</li>
<li>ä»£ç æ›´ç®€åŒ–ã€æ›´æ˜“ç»´æŠ¤ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-5"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-5"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼å‡½æ•°extract-method-3"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method-3"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‡½æ•°ä¸Šç§»pull-up-method"><a class="markdownIt-Anchor" href="#å‡½æ•°ä¸Šç§»pull-up-method"></a> å‡½æ•°ä¸Šç§»(Pull Up Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æœ‰äº›å‡½æ•°ï¼Œåœ¨å„ä¸ªå­ç±»ä¸­äº§ç”Ÿå®Œå…¨ç›¸åŒçš„ç»“æœã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/pull-up-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¯¥å‡½æ•°ç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/pull-up-method-after.png"/></div>
<h4 id="æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»pull-up-constructor-body"><a class="markdownIt-Anchor" href="#æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»pull-up-constructor-body"></a> æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»(Pull Up Constructor Body)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ åœ¨å„ä¸ªå­ç±»ä¸­æ‹¥æœ‰ä¸€äº›æ„é€ å‡½æ•°ï¼Œå®ƒä»¬çš„æœ¬ä½“å‡ ä¹å®Œå…¨ä¸€è‡´ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">(String name, String id, <span class="keyword">int</span> grade)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">    <span class="keyword">this</span>.grade = grade;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¶…ç±»ä¸­æ–°å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨å®ƒã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">(String name, String id, <span class="keyword">int</span> grade)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(name, id);</span><br><span class="line">    <span class="keyword">this</span>.grade = grade;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¡‘é€ æ¨¡æ¿å‡½æ•°form-template-method"><a class="markdownIt-Anchor" href="#å¡‘é€ æ¨¡æ¿å‡½æ•°form-template-method"></a> å¡‘é€ æ¨¡æ¿å‡½æ•°(Form Template Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€äº›å­ç±»ï¼Œå…¶ä¸­ç›¸åº”çš„æŸäº›å‡½æ•°ä»¥ç›¸åŒçš„é¡ºåºæ‰§è¡Œç±»ä¼¼çš„æ“ä½œï¼Œä½†å„ä¸ªæ“ä½œçš„ç»†èŠ‚ä¸Šæœ‰æ‰€ä¸åŒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/form-template-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™äº›æ“ä½œåˆ†åˆ«æ”¾è¿›ç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå¹¶ä¿æŒå®ƒä»¬éƒ½æœ‰ç›¸åŒçš„ç­¾åï¼Œäºæ˜¯åŸå‡½æ•°ä¹Ÿå°±å˜å¾—ç›¸åŒäº†ã€‚ç„¶åå°†åŸå‡½æ•°ä¸Šç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/form-template-method-after.png"/></div>
<p><em>æ³¨ï¼šè¿™é‡Œåªæåˆ°å…·ä½“åšæ³•ï¼Œå»ºè®®äº†è§£ä¸€ä¸‹æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ã€‚</em></p>
<h4 id="æ›¿æ¢ç®—æ³•substitute-algorithm"><a class="markdownIt-Anchor" href="#æ›¿æ¢ç®—æ³•substitute-algorithm"></a> æ›¿æ¢ç®—æ³•(Substitute Algorithm)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æƒ³è¦æŠŠæŸä¸ªç®—æ³•æ›¿æ¢ä¸ºå¦ä¸€ä¸ªæ›´æ¸…æ™°çš„ç®—æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">String <span class="title">foundPerson</span><span class="params">(String[] people)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; people.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">"Don"</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"Don"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">"John"</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"John"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">"Kent"</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"Kent"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†å‡½æ•°æœ¬ä½“æ›¿æ¢ä¸ºå¦ä¸€ä¸ªç®—æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">String <span class="title">foundPerson</span><span class="params">(String[] people)</span></span>&#123;</span><br><span class="line">  List candidates =</span><br><span class="line">    Arrays.asList(<span class="keyword">new</span> String[] &#123;<span class="string">"Don"</span>, <span class="string">"John"</span>, <span class="string">"Kent"</span>&#125;);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; people.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (candidates.contains(people[i])) &#123;</span><br><span class="line">      <span class="keyword">return</span> people[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æç‚¼è¶…ç±»extract-superclass"><a class="markdownIt-Anchor" href="#æç‚¼è¶…ç±»extract-superclass"></a> æç‚¼è¶…ç±»(Extract Superclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸¤ä¸ªç±»æœ‰ç›¸ä¼¼ç‰¹æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä¸ºè¿™ä¸¤ä¸ªç±»å»ºç«‹ä¸€ä¸ªè¶…ç±»ï¼Œå°†ç›¸åŒç‰¹æ€§ç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-after.png"/></div>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼consolidate-conditional-expression"><a class="markdownIt-Anchor" href="#åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼consolidate-conditional-expression"></a> åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼(Consolidate Conditional Expression)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ç³»åˆ—æ¡ä»¶åˆ†æ”¯ï¼Œéƒ½å¾—åˆ°ç›¸åŒç»“æœã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">disabilityAmount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (seniority &lt; <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (monthsDisabled &gt; <span class="number">12</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (isPartTime) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// compute the disability amount</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™äº›æ¡ä»¶åˆ†æ”¯åˆå¹¶ä¸ºä¸€ä¸ªæ¡ä»¶ï¼Œå¹¶å°†è¿™ä¸ªæ¡ä»¶æç‚¼ä¸ºä¸€ä¸ªç‹¬ç«‹å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">disabilityAmount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotEligableForDisability()) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// compute the disability amount</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µconsolidate-duplicate-conditional-fragments"><a class="markdownIt-Anchor" href="#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µconsolidate-duplicate-conditional-fragments"></a> åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ(Consolidate Duplicate Conditional Fragments)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>åœ¨æ¡ä»¶è¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯ä¸Šæœ‰ç€ç›¸åŒçš„ä¸€æ®µä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSpecialDeal()) &#123;</span><br><span class="line">  total = price * <span class="number">0.95</span>;</span><br><span class="line">  send();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  total = price * <span class="number">0.98</span>;</span><br><span class="line">  send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™æ®µé‡å¤ä»£ç æ¬ç§»åˆ°æ¡ä»¶è¡¨è¾¾å¼ä¹‹å¤–ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSpecialDeal()) &#123;</span><br><span class="line">  total = price * <span class="number">0.95</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  total = price * <span class="number">0.98</span>;</span><br><span class="line">&#125;</span><br><span class="line">send();</span><br></pre></td></tr></table></figure>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>é‡æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>é‡æ„</tag>
        <tag>ä»£ç åå‘³é“</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</title>
    <url>/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/oo-abusers" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/oo-abusers</a></p>
<p><strong>æ»¥ç”¨é¢å‘å¯¹è±¡(Object-Orientation Abusers)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä»£ç éƒ¨åˆ†æˆ–å®Œå…¨åœ°è¿èƒŒäº†é¢å‘å¯¹è±¡ç¼–ç¨‹åŸåˆ™ã€‚</strong></p>
</blockquote>
<h2 id="switch-å£°æ˜"><a class="markdownIt-Anchor" href="#switch-å£°æ˜"></a> Switch å£°æ˜</h2>
<blockquote>
<p>Switch å£°æ˜(Switch Statements)</p>
<p>ä½ æœ‰ä¸€ä¸ªå¤æ‚çš„ <code>switch</code> è¯­å¥æˆ– <code>if</code> åºåˆ—è¯­å¥ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/switch-statements-1.png"/></div>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>é¢å‘å¯¹è±¡ç¨‹åºçš„ä¸€ä¸ªæœ€æ˜æ˜¾ç‰¹å¾å°±æ˜¯ï¼šå°‘ç”¨ <code>switch</code> å’Œ <code>case</code> è¯­å¥ã€‚ä»æœ¬è´¨ä¸Šè¯´ï¼Œ<code>switch</code> è¯­å¥çš„é—®é¢˜åœ¨äºé‡å¤ï¼ˆ<code>if</code> åºåˆ—ä¹ŸåŒæ ·å¦‚æ­¤ï¼‰ã€‚ä½ å¸¸ä¼šå‘ç° <code>switch</code> è¯­å¥æ•£å¸ƒäºä¸åŒåœ°ç‚¹ã€‚å¦‚æœè¦ä¸ºå®ƒæ·»åŠ ä¸€ä¸ªæ–°çš„ <code>case</code> å­å¥ï¼Œå°±å¿…é¡»æ‰¾åˆ°æ‰€æœ‰ <code>switch</code> è¯­å¥å¹¶ä¿®æ”¹å®ƒä»¬ã€‚é¢å‘å¯¹è±¡ä¸­çš„å¤šæ€æ¦‚å¿µå¯ä¸ºæ­¤å¸¦æ¥ä¼˜é›…çš„è§£å†³åŠæ³•ã€‚</p>
<p>å¤§å¤šæ•°æ—¶å€™ï¼Œä¸€çœ‹åˆ° <code>switch</code> è¯­å¥ï¼Œå°±åº”è¯¥è€ƒè™‘ä»¥å¤šæ€æ¥æ›¿æ¢å®ƒã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>é—®é¢˜æ˜¯å¤šæ€è¯¥å‡ºç°åœ¨å“ªï¼Ÿswitch è¯­å¥å¸¸å¸¸æ ¹æ®ç±»å‹ç è¿›è¡Œé€‰æ‹©ï¼Œä½ è¦çš„æ˜¯â€œä¸è¯¥ç±»å‹ç ç›¸å…³çš„å‡½æ•°æˆ–ç±»â€ï¼Œæ‰€ä»¥åº”è¯¥è¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°† <code>switch</code> è¯­å¥æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå†ä»¥ <code>æ¬ç§»å‡½æ•°(Move Method)</code> å°†å®ƒæ¬ç§»åˆ°éœ€è¦å¤šæ€æ€§çš„é‚£ä¸ªç±»é‡Œã€‚</li>
<li>å¦‚æœä½ çš„ <code>switch</code> æ˜¯åŸºäºç±»å‹ç æ¥è¯†åˆ«åˆ†æ”¯ï¼Œè¿™æ—¶å¯ä»¥è¿ç”¨ <code>ä»¥å­ç±»å–ä»£ç±»å‹ç (Replace Type Code with Subclass)</code> æˆ– <code>ä»¥çŠ¶æ€/ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç (Replace Type Code with State/Strategy)</code> ã€‚</li>
<li>ä¸€æ—¦å®Œæˆè¿™æ ·çš„ç»§æ‰¿ç»“æ„åï¼Œå°±å¯ä»¥è¿ç”¨ <code>ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼(Replace Conditional with Polymorphism)</code> äº†ã€‚</li>
<li>å¦‚æœæ¡ä»¶åˆ†æ”¯å¹¶ä¸å¤šå¹¶ä¸”å®ƒä»¬ä½¿ç”¨ä¸åŒå‚æ•°è°ƒç”¨ç›¸åŒçš„å‡½æ•°ï¼Œå¤šæ€å°±æ²¡å¿…è¦äº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥è¿ç”¨ <code>ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°(Replace Parameter with Explicit Methods)</code> ã€‚</li>
<li>å¦‚æœä½ çš„é€‰æ‹©æ¡ä»¶ä¹‹ä¸€æ˜¯ nullï¼Œå¯ä»¥è¿ç”¨ <code>å¼•å…¥ Null å¯¹è±¡(Introduce Null Object)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>æå‡ä»£ç ç»„ç»‡æ€§ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/switch-statements-2.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>å¦‚æœä¸€ä¸ª <code>switch</code> æ“ä½œåªæ˜¯æ‰§è¡Œç®€å•çš„è¡Œä¸ºï¼Œå°±æ²¡æœ‰é‡æ„çš„å¿…è¦äº†ã€‚</li>
<li><code>switch</code> å¸¸è¢«å·¥å‚è®¾è®¡æ¨¡å¼æ—ï¼ˆ<code>å·¥å‚æ–¹æ³•æ¨¡å¼(Factory Method)</code>å’Œ<code>æŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory)</code>ï¼‰æ‰€ä½¿ç”¨ï¼Œè¿™ç§æƒ…å†µä¸‹ä¹Ÿæ²¡å¿…è¦é‡æ„ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼å‡½æ•°extract-method"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¬ç§»å‡½æ•°move-method"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="ä»¥å­ç±»å–ä»£ç±»å‹ç replace-type-code-with-subclass"><a class="markdownIt-Anchor" href="#ä»¥å­ç±»å–ä»£ç±»å‹ç replace-type-code-with-subclass"></a> ä»¥å­ç±»å–ä»£ç±»å‹ç (Replace Type Code with Subclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªä¸å¯å˜çš„ç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-subclasses-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥å­ç±»å–ä»£è¿™ä¸ªç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-subclasses-after.png"/></div>
<h4 id="ä»¥çŠ¶æ€ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç replace-type-code-with-statestrategy"><a class="markdownIt-Anchor" href="#ä»¥çŠ¶æ€ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç replace-type-code-with-statestrategy"></a> ä»¥çŠ¶æ€/ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç (Replace Type Code with State/Strategy)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºï¼Œä½†ä½ æ— æ³•é€šè¿‡ç»§æ‰¿æ¶ˆé™¤å®ƒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-state-strategy-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥çŠ¶æ€å¯¹è±¡å–ä»£ç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-state-strategy-after.png"/></div>
<h4 id="ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼replace-conditional-with-polymorphism"><a class="markdownIt-Anchor" href="#ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼replace-conditional-with-polymorphism"></a> ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼(Replace Conditional with Polymorphism)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æ‰‹ä¸Šæœ‰ä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œå®ƒæ ¹æ®å¯¹è±¡ç±»å‹çš„ä¸åŒè€Œé€‰æ‹©ä¸åŒçš„è¡Œä¸ºã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">      <span class="keyword">case</span> EUROPEAN:</span><br><span class="line">        <span class="keyword">return</span> getBaseSpeed();</span><br><span class="line">      <span class="keyword">case</span> AFRICAN:</span><br><span class="line">        <span class="keyword">return</span> getBaseSpeed() - getLoadFactor() * numberOfCoconuts;</span><br><span class="line">      <span class="keyword">case</span> NORWEGIAN_BLUE:</span><br><span class="line">        <span class="keyword">return</span> (isNailed) ? <span class="number">0</span> : getBaseSpeed(voltage);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Should be unreachable"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªæ¡ä»¶è¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯æ”¾è¿›ä¸€ä¸ªå­ç±»å†…çš„è¦†å†™å‡½æ•°ä¸­ï¼Œç„¶åå°†åŸå§‹å‡½æ•°å£°æ˜ä¸ºæŠ½è±¡å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">abstract</span> <span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">European</span> <span class="keyword">extends</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getBaseSpeed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">African</span> <span class="keyword">extends</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getBaseSpeed() - getLoadFactor() * numberOfCoconuts;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NorwegianBlue</span> <span class="keyword">extends</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (isNailed) ? <span class="number">0</span> : getBaseSpeed(voltage);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Somewhere in client code</span></span><br><span class="line">speed = bird.getSpeed();</span><br></pre></td></tr></table></figure>
<h4 id="ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°replace-parameter-with-explicit-methods"><a class="markdownIt-Anchor" href="#ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°replace-parameter-with-explicit-methods"></a> ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°(Replace Parameter with Explicit Methods)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä¸­å®Œå…¨å–å†³äºå‚æ•°å€¼è€Œé‡‡å–ä¸åŒçš„è¡Œä¸ºã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setValue</span><span class="params">(String name, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (name.equals(<span class="string">"height"</span>)) &#123;</span><br><span class="line">    height = value;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (name.equals(<span class="string">"width"</span>)) &#123;</span><br><span class="line">    width = value;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  Assert.shouldNeverReachHere();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>é’ˆå¯¹è¯¥å‚æ•°çš„æ¯ä¸€ä¸ªå¯èƒ½å€¼ï¼Œå»ºç«‹ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123;</span><br><span class="line">  height = arg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123;</span><br><span class="line">  width = arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥-null-å¯¹è±¡introduce-null-object"><a class="markdownIt-Anchor" href="#å¼•å…¥-null-å¯¹è±¡introduce-null-object"></a> å¼•å…¥ Null å¯¹è±¡(Introduce Null Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ éœ€è¦å†ä¸‰æ£€æŸ¥æŸå¯¹è±¡æ˜¯å¦ä¸º nullã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (customer == <span class="keyword">null</span>) &#123;</span><br><span class="line">  plan = BillingPlan.basic();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  plan = customer.getPlan();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°† null å€¼æ›¿æ¢ä¸º null å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NullCustomer</span> <span class="keyword">extends</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">  <span class="function">Plan <span class="title">getPlan</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> NullPlan();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Some other NULL functionality.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replace null values with Null-object.</span></span><br><span class="line">customer = (order.customer != <span class="keyword">null</span>) ? order.customer : <span class="keyword">new</span> NullCustomer();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use Null-object as if it's normal subclass.</span></span><br><span class="line">plan = customer.getPlan();</span><br></pre></td></tr></table></figure>
<h2 id="ä¸´æ—¶å­—æ®µ"><a class="markdownIt-Anchor" href="#ä¸´æ—¶å­—æ®µ"></a> ä¸´æ—¶å­—æ®µ</h2>
<blockquote>
<p>ä¸´æ—¶å­—æ®µ(Temporary Field)çš„å€¼åªåœ¨ç‰¹å®šç¯å¢ƒä¸‹æœ‰æ„ä¹‰ï¼Œç¦»å¼€è¿™ä¸ªç¯å¢ƒï¼Œå®ƒä»¬å°±ä»€ä¹ˆä¹Ÿä¸æ˜¯äº†ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/temporary-field-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>æœ‰æ—¶ä½ ä¼šçœ‹åˆ°è¿™æ ·çš„å¯¹è±¡ï¼šå…¶å†…æŸä¸ªå®ä¾‹å˜é‡ä»…ä¸ºæŸç§ç‰¹å®šæƒ…å†µè€Œè®¾ã€‚è¿™æ ·çš„ä»£ç è®©äººä¸æ˜“ç†è§£ï¼Œå› ä¸ºä½ é€šå¸¸è®¤ä¸ºå¯¹è±¡åœ¨æ‰€æœ‰æ—¶å€™éƒ½éœ€è¦å®ƒçš„æ‰€æœ‰å˜é‡ã€‚åœ¨å˜é‡æœªè¢«ä½¿ç”¨çš„æƒ…å†µä¸‹çŒœæµ‹å½“åˆè®¾ç½®ç›®çš„ï¼Œä¼šè®©ä½ å‘ç–¯ã€‚<br />
é€šå¸¸ï¼Œä¸´æ—¶å­—æ®µæ˜¯åœ¨æŸä¸€ç®—æ³•éœ€è¦å¤§é‡è¾“å…¥æ—¶è€Œåˆ›å»ºã€‚å› æ­¤ï¼Œä¸ºäº†é¿å…å‡½æ•°æœ‰è¿‡å¤šå‚æ•°ï¼Œç¨‹åºå‘˜å†³å®šåœ¨ç±»ä¸­åˆ›å»ºè¿™äº›æ•°æ®çš„ä¸´æ—¶å­—æ®µã€‚è¿™äº›ä¸´æ—¶å­—æ®µä»…ä»…åœ¨ç®—æ³•ä¸­ä½¿ç”¨ï¼Œå…¶ä»–æ—¶å€™å´æ¯«æ— ç”¨å¤„ã€‚<br />
è¿™ç§ä»£ç ä¸å¥½ç†è§£ã€‚ä½ æœŸæœ›æŸ¥çœ‹å¯¹è±¡å­—æ®µçš„æ•°æ®ï¼Œä½†æ˜¯å‡ºäºæŸç§åŸå› ï¼Œå®ƒä»¬æ€»æ˜¯ä¸ºç©ºã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¯ä»¥é€šè¿‡ <code>æç‚¼ç±»(Extract Class)</code> å°†ä¸´æ—¶å­—æ®µå’Œæ“ä½œå®ƒä»¬çš„æ‰€æœ‰ä»£ç æç‚¼åˆ°ä¸€ä¸ªå•ç‹¬çš„ç±»ä¸­ã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥è¿ç”¨ <code>ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°(Replace Method with Method Object)</code> æ¥å®ç°åŒæ ·çš„ç›®çš„ã€‚</li>
<li><code>å¼•å…¥ Null å¯¹è±¡(Introduce Null Object)</code> åœ¨â€œå˜é‡ä¸åˆæ³•â€çš„æƒ…å†µä¸‹åˆ›å»ºä¸€ä¸ª null å¯¹è±¡ï¼Œä»è€Œé¿å…å†™å‡ºæ¡ä»¶è¡¨è¾¾å¼ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/temporary-field-2.png"/></div>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>æ›´å¥½çš„ä»£ç æ¸…æ™°åº¦å’Œç»„ç»‡æ€§ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/temporary-field-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°replace-method-with-method-object"><a class="markdownIt-Anchor" href="#ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°replace-method-with-method-object"></a> ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°(Replace Method with Method Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªè¿‡é•¿å‡½æ•°ï¼Œå®ƒçš„å±€éƒ¨å˜é‡äº¤ç»‡åœ¨ä¸€èµ·ï¼Œä»¥è‡´äºä½ æ— æ³•åº”ç”¨æç‚¼å‡½æ•°(Extract Method) ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">price</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> primaryBasePrice;</span><br><span class="line">    <span class="keyword">double</span> secondaryBasePrice;</span><br><span class="line">    <span class="keyword">double</span> tertiaryBasePrice;</span><br><span class="line">    <span class="comment">// long computation.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†å‡½æ•°ç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç±»ä¸­ï¼Œä½¿å¾—å±€éƒ¨å˜é‡æˆäº†è¿™ä¸ªç±»çš„å­—æ®µã€‚ç„¶åï¼Œä½ å¯ä»¥å°†å‡½æ•°åˆ†å‰²æˆè¿™ä¸ªç±»ä¸­çš„å¤šä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">price</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> PriceCalculator(<span class="keyword">this</span>).compute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriceCalculator</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> primaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> secondaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> tertiaryBasePrice;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PriceCalculator</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// copy relevant information from order object.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">compute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// long computation.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥-null-å¯¹è±¡introduce-null-object-2"><a class="markdownIt-Anchor" href="#å¼•å…¥-null-å¯¹è±¡introduce-null-object-2"></a> å¼•å…¥ Null å¯¹è±¡(Introduce Null Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ éœ€è¦å†ä¸‰æ£€æŸ¥æŸå¯¹è±¡æ˜¯å¦ä¸º nullã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (customer == <span class="keyword">null</span>) &#123;</span><br><span class="line">  plan = BillingPlan.basic();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  plan = customer.getPlan();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°† null å€¼æ›¿æ¢ä¸º null å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NullCustomer</span> <span class="keyword">extends</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">  <span class="function">Plan <span class="title">getPlan</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> NullPlan();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Some other NULL functionality.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replace null values with Null-object.</span></span><br><span class="line">customer = (order.customer != <span class="keyword">null</span>) ? order.customer : <span class="keyword">new</span> NullCustomer();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use Null-object as if it's normal subclass.</span></span><br><span class="line">plan = customer.getPlan();</span><br></pre></td></tr></table></figure>
<h2 id="å¼‚æ›²åŒå·¥çš„ç±»"><a class="markdownIt-Anchor" href="#å¼‚æ›²åŒå·¥çš„ç±»"></a> å¼‚æ›²åŒå·¥çš„ç±»</h2>
<blockquote>
<p>å¼‚æ›²åŒå·¥çš„ç±»(Alternative Classes with Different Interfaces)</p>
<p>ä¸¤ä¸ªç±»ä¸­æœ‰ç€ä¸åŒçš„å‡½æ•°ï¼Œå´åœ¨åšç€åŒä¸€ä»¶äº‹ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/alternative-classes-with-different-interfaces-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>è¿™ç§æƒ…å†µå¾€å¾€æ˜¯å› ä¸ºï¼šåˆ›å»ºè¿™ä¸ªç±»çš„ç¨‹åºå‘˜å¹¶ä¸çŸ¥é“å·²ç»æœ‰å®ç°è¿™ä¸ªåŠŸèƒ½çš„ç±»å­˜åœ¨äº†ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-3"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-3"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä¸¤ä¸ªå‡½æ•°åšåŒä¸€ä»¶äº‹ï¼Œå´æœ‰ç€ä¸åŒçš„ç­¾åï¼Œè¯·è¿ç”¨ <code>å‡½æ•°æ”¹å(Rename Method)</code> æ ¹æ®å®ƒä»¬çš„ç”¨é€”é‡æ–°å‘½åã€‚</li>
<li>è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> ã€ <code>æ·»åŠ å‚æ•°(Add Parameter)</code> å’Œ <code>ä»¤å‡½æ•°æºå¸¦å‚æ•°(Parameterize Method)</code> æ¥ä½¿å¾—æ–¹æ³•çš„åç§°å’Œå®ç°ä¸€è‡´ã€‚</li>
<li>å¦‚æœä¸¤ä¸ªç±»ä»…æœ‰éƒ¨åˆ†åŠŸèƒ½æ˜¯é‡å¤çš„ï¼Œå°è¯•è¿ç”¨ <code>æç‚¼è¶…ç±»(Extract Superclass)</code> ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå·²å­˜åœ¨çš„ç±»å°±æˆäº†è¶…ç±»ã€‚</li>
<li>å½“æœ€ç»ˆé€‰æ‹©å¹¶è¿ç”¨æŸç§æ–¹æ³•æ¥é‡æ„åï¼Œä¹Ÿè®¸ä½ å°±èƒ½åˆ é™¤å…¶ä¸­ä¸€ä¸ªç±»äº†ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>æ¶ˆé™¤äº†ä¸å¿…è¦çš„é‡å¤ä»£ç ï¼Œä¸ºä»£ç ç˜¦èº«äº†ã€‚</li>
<li>ä»£ç æ›´æ˜“è¯»ï¼ˆä¸å†éœ€è¦çŒœæµ‹ä¸ºä»€ä¹ˆè¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ç›¸åŒçš„ç±»ï¼‰ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/alternative-classes-with-different-interfaces-2.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥-2"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-2"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶åˆå¹¶ç±»æ˜¯ä¸å¯èƒ½çš„ï¼Œæˆ–è€…æ˜¯å¦‚æ­¤å›°éš¾ä»¥è‡³äºæ²¡æœ‰æ„ä¹‰ã€‚ä¾‹å¦‚ï¼šä¸¤ä¸ªåŠŸèƒ½ç›¸ä¼¼çš„ç±»å­˜åœ¨äºä¸åŒçš„ lib åº“ä¸­ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="å‡½æ•°æ”¹årename-method"><a class="markdownIt-Anchor" href="#å‡½æ•°æ”¹årename-method"></a> å‡½æ•°æ”¹å(Rename Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å‡½æ•°çš„åç§°æœªèƒ½æ°å½“çš„æ­ç¤ºå‡½æ•°çš„ç”¨é€”ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getsnm</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ä¿®æ”¹å‡½æ•°åã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getSecondName</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¬ç§»å‡½æ•°move-method-2"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method-2"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æ·»åŠ å‚æ•°add-parameter"><a class="markdownIt-Anchor" href="#æ·»åŠ å‚æ•°add-parameter"></a> æ·»åŠ å‚æ•°(Add Parameter)</h4>
<p><strong>é—®é¢˜</strong><br />
æŸä¸ªå‡½æ•°éœ€è¦ä»è°ƒç”¨ç«¯å¾—åˆ°æ›´å¤šä¿¡æ¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Contact <span class="title">getContact</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong><br />
ä¸ºæ­¤å‡½æ•°æ·»åŠ ä¸€ä¸ªå¯¹è±¡å‡½æ•°ï¼Œè®©æ”¹å¯¹è±¡å¸¦è¿›å‡½æ•°æ‰€éœ€ä¿¡æ¯ã€‚</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">class<span class="built_in"> Customer </span>&#123;</span><br><span class="line">  public Contact getContact(Date date);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä»¤å‡½æ•°æºå¸¦å‚æ•°parameterize-method"><a class="markdownIt-Anchor" href="#ä»¤å‡½æ•°æºå¸¦å‚æ•°parameterize-method"></a> ä»¤å‡½æ•°æºå¸¦å‚æ•°(Parameterize Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>è‹¥å¹²å‡½æ•°åšäº†ç±»ä¼¼çš„å·¥ä½œï¼Œä½†åœ¨å‡½æ•°æœ¬ä½“ä¸­å´åŒ…å«äº†ä¸åŒçš„å€¼ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/parameterize-method-before.png"/></div>
**è§£å†³**
<p>å»ºç«‹å•ä¸€å‡½æ•°ï¼Œä»¥å‚æ•°è¡¨è¾¾å“ªäº›ä¸åŒçš„å€¼ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/parameterize-method-after.png"/></div>
<h4 id="æç‚¼è¶…ç±»extract-superclass"><a class="markdownIt-Anchor" href="#æç‚¼è¶…ç±»extract-superclass"></a> æç‚¼è¶…ç±»(Extract Superclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸¤ä¸ªç±»æœ‰ç›¸ä¼¼ç‰¹æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä¸ºè¿™ä¸¤ä¸ªç±»å»ºç«‹ä¸€ä¸ªè¶…ç±»ï¼Œå°†ç›¸åŒç‰¹æ€§ç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-after.png"/></div>
<h2 id="è¢«æ‹’ç»çš„é¦ˆèµ "><a class="markdownIt-Anchor" href="#è¢«æ‹’ç»çš„é¦ˆèµ "></a> è¢«æ‹’ç»çš„é¦ˆèµ </h2>
<blockquote>
<p>è¢«æ‹’ç»çš„é¦ˆèµ (Refused Bequest)</p>
<p>å­ç±»ä»…ä»…ä½¿ç”¨çˆ¶ç±»ä¸­çš„éƒ¨åˆ†æ–¹æ³•å’Œå±æ€§ã€‚å…¶ä»–æ¥è‡ªçˆ¶ç±»çš„é¦ˆèµ æˆä¸ºäº†ç´¯èµ˜ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/refused-bequest-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -4"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -4"></a> é—®é¢˜åŸå› </h3>
<p>æœ‰äº›äººä»…ä»…æ˜¯æƒ³é‡ç”¨è¶…ç±»ä¸­çš„éƒ¨åˆ†ä»£ç è€Œåˆ›å»ºäº†å­ç±»ã€‚ä½†å®é™…ä¸Šè¶…ç±»å’Œå­ç±»å®Œå…¨ä¸åŒã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-4"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-4"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœç»§æ‰¿æ²¡æœ‰æ„ä¹‰å¹¶ä¸”å­ç±»å’Œçˆ¶ç±»ä¹‹é—´ç¡®å®æ²¡æœ‰å…±åŒç‚¹ï¼Œå¯ä»¥è¿ç”¨ <code>ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿(Replace Inheritance with Delegation)</code> æ¶ˆé™¤ç»§æ‰¿ã€‚</li>
<li>å¦‚æœç»§æ‰¿æ˜¯é€‚å½“çš„ï¼Œåˆ™å»é™¤å­ç±»ä¸­ä¸éœ€è¦çš„å­—æ®µå’Œæ–¹æ³•ã€‚è¿ç”¨ <code>æç‚¼è¶…ç±»(Extract Superclass)</code> å°†æ‰€æœ‰è¶…ç±»ä¸­å¯¹äºå­ç±»æœ‰ç”¨çš„å­—æ®µå’Œå‡½æ•°æå–å‡ºæ¥ï¼Œç½®å…¥ä¸€ä¸ªæ–°çš„è¶…ç±»ä¸­ï¼Œç„¶åè®©ä¸¤ä¸ªç±»éƒ½ç»§æ‰¿è‡ªå®ƒã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/refused-bequest-2.png"/></div>
<h3 id="æ”¶ç›Š-4"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-4"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç çš„æ¸…æ™°åº¦å’Œç»„ç»‡æ€§ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/refused-bequest-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-4"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-4"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿replace-inheritance-with-delegation"><a class="markdownIt-Anchor" href="#ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿replace-inheritance-with-delegation"></a> ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿(Replace Inheritance with Delegation)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªå­ç±»åªä½¿ç”¨è¶…ç±»æ¥å£ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–æ˜¯æ ¹æœ¬ä¸éœ€è¦ç»§æ‰¿è€Œæ¥çš„æ•°æ®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-inheritance-with-delegation-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<ol>
<li>åœ¨å­ç±»ä¸­æ–°å»ºä¸€ä¸ªå­—æ®µç”¨ä»¥ä¿å­˜è¶…ç±»ï¼›</li>
<li>è°ƒæ•´å­ç±»å‡½æ•°ï¼Œä»¤å®ƒæ”¹è€Œå§”æ‰˜è¶…ç±»ï¼›</li>
<li>ç„¶åå»æ‰ä¸¤è€…ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚</li>
</ol>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-inheritance-with-delegation-after.png"/></div>
<h4 id="æç‚¼è¶…ç±»extract-superclass-2"><a class="markdownIt-Anchor" href="#æç‚¼è¶…ç±»extract-superclass-2"></a> æç‚¼è¶…ç±»(Extract Superclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸¤ä¸ªç±»æœ‰ç›¸ä¼¼ç‰¹æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä¸ºè¿™ä¸¤ä¸ªç±»å»ºç«‹ä¸€ä¸ªè¶…ç±»ï¼Œå°†ç›¸åŒç‰¹æ€§ç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-after.png"/></div>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>é‡æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>é‡æ„</tag>
        <tag>ä»£ç åå‘³é“</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</title>
    <url>/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/change-preventers" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/change-preventers</a></p>
<p><strong>å˜é©çš„éšœç¢(Change Preventers)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šå½“ä½ éœ€è¦æ”¹å˜ä¸€å¤„ä»£ç æ—¶ï¼Œå´å‘ç°ä¸å¾—ä¸æ”¹å˜å…¶ä»–çš„åœ°æ–¹ã€‚è¿™ä½¿å¾—ç¨‹åºå¼€å‘å˜å¾—å¤æ‚ã€ä»£ä»·é«˜æ˜‚ã€‚</strong></p>
</blockquote>
<h2 id="å‘æ•£å¼å˜åŒ–"><a class="markdownIt-Anchor" href="#å‘æ•£å¼å˜åŒ–"></a> å‘æ•£å¼å˜åŒ–</h2>
<blockquote>
<p><code>å‘æ•£å¼å˜åŒ–(Divergent Change)</code> ç±»ä¼¼äº <code>éœ°å¼¹å¼ä¿®æ”¹(Shotgun Surgery)</code> ï¼Œä½†å®é™…ä¸Šå®Œå…¨ä¸åŒã€‚<code>å‘æ•£å¼å˜åŒ–(Divergent Change)</code> æ˜¯æŒ‡ä¸€ä¸ªç±»å—å¤šç§å˜åŒ–çš„å½±å“ã€‚<code>éœ°å¼¹å¼ä¿®æ”¹(Shotgun Surgery)</code> æ˜¯æŒ‡å¤šç§å˜åŒ–å¼•å‘å¤šä¸ªç±»ç›¸åº”çš„ä¿®æ”¹ã€‚</p>
</blockquote>
<h3 id="ç‰¹å¾"><a class="markdownIt-Anchor" href="#ç‰¹å¾"></a> ç‰¹å¾</h3>
<p>ä½ å‘ç°ä½ æƒ³è¦ä¿®æ”¹ä¸€ä¸ªå‡½æ•°ï¼Œå´å¿…é¡»è¦åŒæ—¶ä¿®æ”¹è®¸å¤šä¸ç›¸å…³çš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œå½“ä½ æƒ³è¦æ·»åŠ ä¸€ä¸ªæ–°çš„äº§å“ç±»å‹æ—¶ï¼Œä½ éœ€è¦åŒæ­¥ä¿®æ”¹å¯¹äº§å“è¿›è¡ŒæŸ¥æ‰¾ã€æ˜¾ç¤ºã€æ’åºçš„å‡½æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/divergent-change-1.png"/></div>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>é€šå¸¸ï¼Œè¿™ç§å‘æ•£å¼ä¿®æ”¹æ˜¯ç”±äºç¼–ç¨‹ç»“æ„ä¸åˆç†æˆ–è€…â€œå¤åˆ¶-ç²˜è´´å¼ç¼–ç¨‹â€ã€‚</p>
<h3 id="è§£å†³åŠæ³•"><a class="markdownIt-Anchor" href="#è§£å†³åŠæ³•"></a> è§£å†³åŠæ³•</h3>
<ul>
<li>è¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code> æ‹†åˆ†ç±»çš„è¡Œä¸ºã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç ç»„ç»‡ç»“æ„</li>
<li>å‡å°‘é‡å¤ä»£ç </li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h2 id="å¹³è¡Œç»§æ‰¿ä½“ç³»"><a class="markdownIt-Anchor" href="#å¹³è¡Œç»§æ‰¿ä½“ç³»"></a> å¹³è¡Œç»§æ‰¿ä½“ç³»</h2>
<blockquote>
<p><code>å¹³è¡Œç»§æ‰¿ä½“ç³»(Parallel Inheritance Hierarchies)</code> å…¶å®æ˜¯ <code>éœ°å¼¹å¼ä¿®æ”¹(Shotgun Surgery)</code> çš„ç‰¹æ®Šæƒ…å†µã€‚</p>
</blockquote>
<h3 id="ç‰¹å¾-2"><a class="markdownIt-Anchor" href="#ç‰¹å¾-2"></a> ç‰¹å¾</h3>
<p>æ¯å½“ä½ ä¸ºæŸä¸ªç±»æ·»åŠ ä¸€ä¸ªå­ç±»ï¼Œå¿…é¡»åŒæ—¶ä¸ºå¦ä¸€ä¸ªç±»ç›¸åº”æ·»åŠ ä¸€ä¸ªå­ç±»ã€‚è¿™ç§æƒ…å†µçš„å…¸å‹ç‰¹å¾æ˜¯ï¼šæŸä¸ªç»§æ‰¿ä½“ç³»çš„ç±»åå‰ç¼€æˆ–ç±»ååç¼€å®Œå…¨ç›¸åŒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/parallel-inheritance-hierarchies-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>èµ·åˆçš„ç»§æ‰¿ä½“ç³»å¾ˆå°ï¼Œéšç€ä¸æ–­æ·»åŠ æ–°ç±»ï¼Œç»§æ‰¿ä½“ç³»è¶Šæ¥è¶Šå¤§ï¼Œä¹Ÿè¶Šæ¥è¶Šéš¾ä¿®æ”¹ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>ä¸€èˆ¬ç­–ç•¥æ˜¯ï¼šè®©ä¸€ä¸ªç»§æ‰¿ä½“ç³»çš„å®ä¾‹å¼•ç”¨å¦ä¸€ä¸ªç»§æ‰¿ä½“ç³»çš„å®ä¾‹ã€‚å¦‚æœå†æ¥å†å‰è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> å’Œ <code>æ¬ç§»å­—æ®µ(Move Field)</code>ï¼Œå°±å¯ä»¥æ¶ˆé™¤å¼•ç”¨ç«¯çš„ç»§æ‰¿ä½“ç³»ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>æ›´å¥½çš„ä»£ç ç»„ç»‡</li>
<li>å‡å°‘é‡å¤ä»£ç </li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶å…·æœ‰å¹¶è¡Œç±»å±‚æ¬¡ç»“æ„åªæ˜¯ä¸€ç§ä¸ºäº†é¿å…ç¨‹åºä½“ç³»ç»“æ„æ›´æ··ä¹±çš„æ–¹æ³•ã€‚å¦‚æœä½ å‘ç°å°è¯•æ¶ˆé™¤å¹³è¡Œç»§æ‰¿ä½“ç³»å¯¼è‡´ä»£ç æ›´åŠ ä¸‘é™‹ï¼Œé‚£ä¹ˆä½ åº”è¯¥å›æ»šä½ çš„ä¿®æ”¹ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æ¬ç§»å‡½æ•°move-method"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æ¬ç§»å­—æ®µmove-field"><a class="markdownIt-Anchor" href="#æ¬ç§»å­—æ®µmove-field"></a> æ¬ç§»å­—æ®µ(Move Field)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>åœ¨ä½ çš„ç¨‹åºä¸­ï¼ŒæŸä¸ªå­—æ®µè¢«å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»æ›´å¤šåœ°ç”¨åˆ°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-field-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨ç›®æ ‡ç±»æ–°å»ºä¸€ä¸ªå­—æ®µï¼Œä¿®æ”¹æºå­—æ®µçš„æ‰€æœ‰ç”¨æˆ·ï¼Œä»¤ä»–ä»¬æ”¹ç”¨æ–°å­—æ®µã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-field-after.png"/></div>
<h2 id="éœ°å¼¹å¼ä¿®æ”¹"><a class="markdownIt-Anchor" href="#éœ°å¼¹å¼ä¿®æ”¹"></a> éœ°å¼¹å¼ä¿®æ”¹</h2>
<blockquote>
<p><code>éœ°å¼¹å¼ä¿®æ”¹(Shotgun Surgery)</code> ç±»ä¼¼äº <code>å‘æ•£å¼å˜åŒ–(Divergent Change)</code> ï¼Œä½†å®é™…ä¸Šå®Œå…¨ä¸åŒã€‚<code>å‘æ•£å¼å˜åŒ–(Divergent Change)</code> æ˜¯æŒ‡ä¸€ä¸ªç±»å—å¤šç§å˜åŒ–çš„å½±å“ã€‚<code>éœ°å¼¹å¼ä¿®æ”¹(Shotgun Surgery)</code> æ˜¯æŒ‡å¤šç§å˜åŒ–å¼•å‘å¤šä¸ªç±»ç›¸åº”çš„ä¿®æ”¹ã€‚</p>
</blockquote>
<h3 id="ç‰¹å¾-3"><a class="markdownIt-Anchor" href="#ç‰¹å¾-3"></a> ç‰¹å¾</h3>
<p>ä»»ä½•ä¿®æ”¹éƒ½éœ€è¦åœ¨è®¸å¤šä¸åŒç±»ä¸Šåšå°å¹…åº¦ä¿®æ”¹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/shotgun-surgery-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>ä¸€ä¸ªå•ä¸€çš„èŒè´£è¢«æ‹†åˆ†æˆå¤§é‡çš„ç±»ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>è¿ç”¨<code>æ¬ç§»å‡½æ•°(Move Method)</code> å’Œ <code>æ¬ç§»å­—æ®µ(Move Field)</code> æ¥æ¬ç§»ä¸åŒç±»ä¸­ç›¸åŒçš„è¡Œä¸ºåˆ°ä¸€ä¸ªç‹¬ç«‹ç±»ä¸­ã€‚å¦‚æœæ²¡æœ‰é€‚åˆå­˜æ”¾æ¬ç§»å‡½æ•°æˆ–å­—æ®µçš„ç±»ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°ç±»ã€‚</li>
<li>é€šå¸¸ï¼Œå¯ä»¥è¿ç”¨ <code>å°†ç±»å†…è”åŒ–(Inline Class)</code> å°†ä¸€äº›åˆ—ç›¸å…³è¡Œä¸ºæ”¾è¿›åŒä¸€ä¸ªç±»ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/shotgun-surgery-2.png"/></div>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>æ›´å¥½çš„ä»£ç ç»„ç»‡</li>
<li>å‡å°‘é‡å¤ä»£ç </li>
<li>æ›´æ˜“ç»´æŠ¤</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/shotgun-surgery-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æ¬ç§»å‡½æ•°move-method-2"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method-2"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æ¬ç§»å­—æ®µmove-field-2"><a class="markdownIt-Anchor" href="#æ¬ç§»å­—æ®µmove-field-2"></a> æ¬ç§»å­—æ®µ(Move Field)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>åœ¨ä½ çš„ç¨‹åºä¸­ï¼ŒæŸä¸ªå­—æ®µè¢«å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»æ›´å¤šåœ°ç”¨åˆ°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-field-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨ç›®æ ‡ç±»æ–°å»ºä¸€ä¸ªå­—æ®µï¼Œä¿®æ”¹æºå­—æ®µçš„æ‰€æœ‰ç”¨æˆ·ï¼Œä»¤ä»–ä»¬æ”¹ç”¨æ–°å­—æ®µã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-field-after.png"/></div>
<h4 id="å°†ç±»å†…è”åŒ–inline-class"><a class="markdownIt-Anchor" href="#å°†ç±»å†…è”åŒ–inline-class"></a> å°†ç±»å†…è”åŒ–(Inline Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»æ²¡æœ‰åšå¤ªå¤šäº‹æƒ…ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªç±»çš„æ‰€æœ‰ç‰¹æ€§æ¬ç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­ï¼Œç„¶åç§»é™¤åŸç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-after.png"/></div>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>é‡æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>é‡æ„</tag>
        <tag>ä»£ç åå‘³é“</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</title>
    <url>/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/bloaters" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/bloaters</a></p>
<p><strong>ä»£ç è‡ƒè‚¿(Bloated)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä»£ç ä¸­çš„ç±»ã€å‡½æ•°ã€å­—æ®µæ²¡æœ‰ç»è¿‡åˆç†çš„ç»„ç»‡ï¼Œåªæ˜¯ç®€å•çš„å †ç Œèµ·æ¥ã€‚è¿™ä¸€ç±»å‹çš„é—®é¢˜é€šå¸¸åœ¨ä»£ç çš„åˆæœŸå¹¶ä¸æ˜æ˜¾ï¼Œä½†æ˜¯éšç€ä»£ç è§„æ¨¡çš„å¢é•¿è€Œé€æ¸ç§¯ç´¯ï¼ˆç‰¹åˆ«æ˜¯å½“æ²¡æœ‰äººåŠªåŠ›å»æ ¹é™¤å®ƒä»¬æ—¶ï¼‰ã€‚</strong></p>
</blockquote>
<h2 id="åŸºæœ¬ç±»å‹åæ‰§"><a class="markdownIt-Anchor" href="#åŸºæœ¬ç±»å‹åæ‰§"></a> åŸºæœ¬ç±»å‹åæ‰§</h2>
<blockquote>
<p>åŸºæœ¬ç±»å‹åæ‰§(Primitive Obsession)</p>
<ul>
<li>ä½¿ç”¨åŸºæœ¬ç±»å‹è€Œä¸æ˜¯å°å¯¹è±¡æ¥å®ç°ç®€å•ä»»åŠ¡ï¼ˆä¾‹å¦‚è´§å¸ã€èŒƒå›´ã€ç”µè¯å·ç å­—ç¬¦ä¸²ç­‰ï¼‰ã€‚</li>
<li>ä½¿ç”¨å¸¸é‡ç¼–ç ä¿¡æ¯ï¼ˆä¾‹å¦‚ä¸€ä¸ªç”¨äºå¼•ç”¨ç®¡ç†å‘˜æƒé™çš„å¸¸é‡<code>USER_ADMIN_ROLE = 1</code> ï¼‰ã€‚</li>
<li>ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡ä½œä¸ºå­—æ®µååœ¨æ•°ç»„ä¸­ä½¿ç”¨ã€‚</li>
</ul>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/primitive-obsession-1.png"/></div>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>ç±»ä¼¼å…¶ä»–å¤§éƒ¨åˆ†åå‘³é“ï¼ŒåŸºæœ¬ç±»å‹åæ‰§è¯ç”Ÿäºç±»åˆå»ºçš„æ—¶å€™ã€‚ä¸€å¼€å§‹ï¼Œå¯èƒ½åªæ˜¯ä¸å¤šçš„å­—æ®µï¼Œéšç€è¡¨ç¤ºçš„ç‰¹æ€§è¶Šæ¥è¶Šå¤šï¼ŒåŸºæœ¬æ•°æ®ç±»å‹å­—æ®µä¹Ÿè¶Šæ¥è¶Šå¤šã€‚</p>
<p>åŸºæœ¬ç±»å‹å¸¸å¸¸è¢«ç”¨äºè¡¨ç¤ºæ¨¡å‹çš„ç±»å‹ã€‚ä½ æœ‰ä¸€ç»„æ•°å­—æˆ–å­—ç¬¦ä¸²ç”¨æ¥è¡¨ç¤ºæŸä¸ªå®ä½“ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªåœºæ™¯ï¼šåœ¨æ¨¡æ‹Ÿåœºæ™¯ï¼Œå¤§é‡çš„å­—ç¬¦ä¸²å¸¸é‡è¢«ç”¨äºæ•°ç»„çš„ç´¢å¼•ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/primitive-obsession-2.png"/></div>
<p>å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹å’Œç»“æ„ç±»å‹ï¼ˆç±»ã€ç»“æ„ä½“ç­‰ï¼‰ã€‚ç»“æ„ç±»å‹å…è®¸ç¨‹åºå‘˜å°†åŸºæœ¬æ•°æ®ç±»å‹ç»„ç»‡èµ·æ¥ï¼Œä»¥ä»£è¡¨æŸä¸€äº‹ç‰©çš„æ¨¡å‹ã€‚</p>
<p>åŸºæœ¬æ•°æ®ç±»å‹å¯ä»¥çœ‹æˆæ˜¯æœºæ„ç±»å‹çš„ç§¯æœ¨å—ã€‚å½“åŸºæœ¬æ•°æ®ç±»å‹æ•°é‡æˆè§„æ¨¡åï¼Œå°†å®ƒä»¬æœ‰ç»„ç»‡åœ°ç»“åˆèµ·æ¥ï¼Œå¯ä»¥æ›´æ–¹ä¾¿çš„ç®¡ç†è¿™äº›æ•°æ®ã€‚</p>
<ul>
<li>å¦‚æœä½ æœ‰å¤§é‡çš„åŸºæœ¬æ•°æ®ç±»å‹å­—æ®µï¼Œå°±æœ‰å¯èƒ½å°†å…¶ä¸­éƒ¨åˆ†å­˜åœ¨é€»è¾‘è”ç³»çš„å­—æ®µç»„ç»‡èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªç±»ã€‚æ›´è¿›ä¸€æ­¥çš„æ˜¯ï¼Œå°†ä¸è¿™äº›æ•°æ®æœ‰å…³è”çš„æ–¹æ³•ä¹Ÿä¸€å¹¶ç§»å…¥ç±»ä¸­ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼Œå¯ä»¥å°è¯• <code>ä»¥ç±»å–ä»£ç±»å‹ç (Replace Type Code with Class)</code> ã€‚</li>
<li>å¦‚æœåŸºæœ¬æ•°æ®ç±»å‹å­—æ®µçš„å€¼æ˜¯ç”¨äºæ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</code> æˆ– <code>ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</code> ã€‚</li>
<li>å¦‚æœæƒ³è¦æ›¿æ¢çš„æ•°æ®å€¼æ˜¯ç±»å‹ç ï¼Œè€Œå®ƒå¹¶ä¸å½±å“è¡Œä¸ºï¼Œåˆ™å¯ä»¥è¿ç”¨ <code>ä»¥ç±»å–ä»£ç±»å‹ç (Replace Type Code with Class)</code> å°†å®ƒæ›¿æ¢æ‰ã€‚å¦‚æœä½ æœ‰ä¸ç±»å‹ç ç›¸å…³çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œå¯è¿ç”¨ <code>ä»¥å­ç±»å–ä»£ç±»å‹ç (Replace Type Code with Subclass)</code> æˆ– <code>ä»¥çŠ¶æ€/ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç (Replace Type Code with State/Strategy)</code> åŠ ä»¥å¤„ç†ã€‚</li>
<li>å¦‚æœä½ å‘ç°è‡ªå·±æ­£ä»æ•°ç»„ä¸­æŒ‘é€‰æ•°æ®ï¼Œå¯è¿ç”¨ <code>ä»¥å¯¹è±¡å–ä»£æ•°ç»„(Replace Array with Object)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>å¤šäºäº†ä½¿ç”¨å¯¹è±¡æ›¿ä»£åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä½¿å¾—ä»£ç å˜å¾—æ›´åŠ çµæ´»ã€‚</li>
<li>ä»£ç å˜å¾—æ›´åŠ æ˜“è¯»å’Œæ›´åŠ æœ‰ç»„ç»‡ã€‚ç‰¹æ®Šæ•°æ®å¯ä»¥é›†ä¸­è¿›è¡Œæ“ä½œï¼Œè€Œä¸åƒä¹‹å‰é‚£æ ·åˆ†æ•£ã€‚ä¸ç”¨å†çŒœæµ‹è¿™äº›é™Œç”Ÿçš„å¸¸é‡çš„æ„ä¹‰ä»¥åŠå®ƒä»¬ä¸ºä»€ä¹ˆåœ¨æ•°ç»„ä¸­ã€‚</li>
<li>æ›´å®¹æ˜“å‘ç°é‡å¤ä»£ç ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/primitive-obsession-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="ä»¥ç±»å–ä»£ç±»å‹ç replace-type-code-with-class"><a class="markdownIt-Anchor" href="#ä»¥ç±»å–ä»£ç±»å‹ç replace-type-code-with-class"></a> ä»¥ç±»å–ä»£ç±»å‹ç (Replace Type Code with Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ç±»ä¹‹ä¸­æœ‰ä¸€ä¸ªæ•°å€¼ç±»å‹ç ï¼Œä½†å®ƒå¹¶ä¸å½±å“ç±»çš„è¡Œä¸ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªæ–°çš„ç±»æ›¿æ¢è¯¥æ•°å€¼ç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-class-after.png"/></div>
<h4 id="å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object"><a class="markdownIt-Anchor" href="#å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object"></a> å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªå¯¹è±¡æ¥å–ä»£è¿™äº›å‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-after.png"/></div>
<h4 id="ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object"><a class="markdownIt-Anchor" href="#ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object"></a> ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange.getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange.getHigh();</span><br><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>
<h4 id="ä»¥å­ç±»å–ä»£ç±»å‹ç replace-type-code-with-subclass"><a class="markdownIt-Anchor" href="#ä»¥å­ç±»å–ä»£ç±»å‹ç replace-type-code-with-subclass"></a> ä»¥å­ç±»å–ä»£ç±»å‹ç (Replace Type Code with Subclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªä¸å¯å˜çš„ç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-subclasses-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥å­ç±»å–ä»£è¿™ä¸ªç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-subclasses-after.png"/></div>
<h4 id="ä»¥çŠ¶æ€ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç replace-type-code-with-statestrategy"><a class="markdownIt-Anchor" href="#ä»¥çŠ¶æ€ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç replace-type-code-with-statestrategy"></a> ä»¥çŠ¶æ€/ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç (Replace Type Code with State/Strategy)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºï¼Œä½†ä½ æ— æ³•é€šè¿‡ç»§æ‰¿æ¶ˆé™¤å®ƒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-state-strategy-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥çŠ¶æ€å¯¹è±¡å–ä»£ç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-state-strategy-after.png"/></div>
<h4 id="ä»¥å¯¹è±¡å–ä»£æ•°ç»„replace-array-with-object"><a class="markdownIt-Anchor" href="#ä»¥å¯¹è±¡å–ä»£æ•°ç»„replace-array-with-object"></a> ä»¥å¯¹è±¡å–ä»£æ•°ç»„(Replace Array with Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­çš„å…ƒç´ å„è‡ªä»£è¡¨ä¸åŒçš„ä¸œè¥¿ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String[] row = <span class="keyword">new</span> String[<span class="number">3</span>];</span><br><span class="line">row[<span class="number">0</span>] = <span class="string">"Liverpool"</span>;</span><br><span class="line">row[<span class="number">1</span>] = <span class="string">"15"</span>;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ä»¥å¯¹è±¡æ›¿æ¢æ•°ç»„ã€‚å¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œä»¥ä¸€ä¸ªå­—æ®µæ¥è¡¨ç¤ºã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Performance row = <span class="keyword">new</span> Performance();</span><br><span class="line">row.setName(<span class="string">"Liverpool"</span>);</span><br><span class="line">row.setWins(<span class="string">"15"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®æ³¥å›¢"><a class="markdownIt-Anchor" href="#æ•°æ®æ³¥å›¢"></a> æ•°æ®æ³¥å›¢</h2>
<blockquote>
<p>æ•°æ®æ³¥å›¢(Data Clumps)</p>
<p>æœ‰æ—¶ï¼Œä»£ç çš„ä¸åŒéƒ¨åˆ†åŒ…å«ç›¸åŒçš„å˜é‡ç»„ï¼ˆä¾‹å¦‚ç”¨äºè¿æ¥åˆ°æ•°æ®åº“çš„å‚æ•°ï¼‰ã€‚è¿™äº›ç»‘åœ¨ä¸€èµ·å‡ºç°çš„æ•°æ®åº”è¯¥æ‹¥æœ‰è‡ªå·±çš„å¯¹è±¡ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/data-clumps-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>é€šå¸¸ï¼Œæ•°æ®æ³¥å›¢çš„å‡ºç°æ—¶å› ä¸ºç³Ÿç³•çš„ç¼–ç¨‹ç»“æ„æˆ–â€œå¤åˆ¶-ç²˜è´´å¼ç¼–ç¨‹â€ã€‚</p>
<p>æœ‰ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦æ˜¯æ•°æ®æ³¥å›¢çš„å¥½åŠæ³•ï¼šåˆ æ‰ä¼—å¤šæ•°æ®ä¸­çš„ä¸€é¡¹ã€‚è¿™ä¹ˆåšï¼Œå…¶ä»–æ•°æ®æœ‰æ²¡æœ‰å› è€Œå¤±å»æ„ä¹‰ï¼Ÿå¦‚æœå®ƒä»¬ä¸å†æœ‰æ„ä¹‰ï¼Œè¿™å°±æ˜¯ä¸ªæ˜ç¡®çš„ä¿¡å·ï¼šä½ åº”è¯¥ä¸ºå®ƒä»¬äº§ç”Ÿä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>é¦–å…ˆæ‰¾å‡ºè¿™äº›æ•°æ®ä»¥å­—æ®µå½¢å¼å‡ºç°çš„åœ°æ–¹ï¼Œè¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code> å°†å®ƒä»¬æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å¯¹è±¡ä¸­ã€‚</li>
<li>å¦‚æœæ•°æ®æ³¥å›¢åœ¨å‡½æ•°çš„å‚æ•°åˆ—ä¸­å‡ºç°ï¼Œè¿ç”¨ <code>å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</code> å°†å®ƒä»¬ç»„ç»‡æˆä¸€ä¸ªç±»ã€‚</li>
<li>å¦‚æœæ•°æ®æ³¥å›¢çš„éƒ¨åˆ†æ•°æ®å‡ºç°åœ¨å…¶ä»–å‡½æ•°ä¸­ï¼Œè€ƒè™‘è¿ç”¨ <code>ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</code> å°†æ•´ä¸ªæ•°æ®å¯¹è±¡ä¼ å…¥åˆ°å‡½æ•°ä¸­ã€‚</li>
<li>æ£€è§†ä¸€ä¸‹ä½¿ç”¨è¿™äº›å­—æ®µçš„ä»£ç ï¼Œä¹Ÿè®¸ï¼Œå°†å®ƒä»¬ç§»å…¥ä¸€ä¸ªæ•°æ®ç±»æ˜¯ä¸ªä¸é”™çš„ä¸»æ„ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç æ˜“è¯»æ€§å’Œç»„ç»‡æ€§ã€‚å¯¹äºç‰¹æ®Šæ•°æ®çš„æ“ä½œï¼Œå¯ä»¥é›†ä¸­è¿›è¡Œå¤„ç†ï¼Œè€Œä¸åƒä»¥å‰é‚£æ ·åˆ†æ•£ã€‚</li>
<li>å‡å°‘ä»£ç é‡ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/data-clumps-3.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶ä¸ºäº†å¯¹è±¡ä¸­çš„éƒ¨åˆ†æ•°æ®è€Œå°†æ•´ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œå¯èƒ½ä¼šäº§ç”Ÿè®©ä¸¤ä¸ªç±»ä¹‹é—´ä¸æ”¶æ¬¢è¿çš„ä¾èµ–å…³ç³»ï¼Œè¿™ä¸­æƒ…å†µä¸‹å¯ä»¥ä¸ä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-2"><a class="markdownIt-Anchor" href="#å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-2"></a> å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªå¯¹è±¡æ¥å–ä»£è¿™äº›å‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-after.png"/></div>
<h4 id="ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-2"><a class="markdownIt-Anchor" href="#ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-2"></a> ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange.getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange.getHigh();</span><br><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>
<h2 id="è¿‡å¤§çš„ç±»"><a class="markdownIt-Anchor" href="#è¿‡å¤§çš„ç±»"></a> è¿‡å¤§çš„ç±»</h2>
<blockquote>
<p>è¿‡å¤§çš„ç±»(Large Class)</p>
<p>ä¸€ä¸ªç±»å«æœ‰è¿‡å¤šå­—æ®µã€å‡½æ•°ã€ä»£ç è¡Œã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/large-class-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>ç±»é€šå¸¸ä¸€å¼€å§‹å¾ˆå°ï¼Œä½†æ˜¯éšç€ç¨‹åºçš„å¢é•¿è€Œé€æ¸è†¨èƒ€ã€‚</p>
<p>ç±»ä¼¼äºè¿‡é•¿å‡½æ•°ï¼Œç¨‹åºå‘˜é€šå¸¸è§‰å¾—åœ¨ä¸€ä¸ªç°å­˜ç±»ä¸­æ·»åŠ æ–°ç‰¹æ€§æ¯”åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»è¦å®¹æ˜“ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-3"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-3"></a> è§£å†³æ–¹æ³•</h3>
<p>è®¾è®¡æ¨¡å¼ä¸­æœ‰ä¸€æ¡é‡è¦åŸåˆ™ï¼šèŒè´£å•ä¸€åŸåˆ™ã€‚ä¸€ä¸ªç±»åº”è¯¥åªèµ‹äºˆå®ƒä¸€ä¸ªèŒè´£ã€‚å¦‚æœå®ƒæ‰€æ‰¿æ‹…çš„èŒè´£å¤ªå¤šï¼Œå°±è¯¥è€ƒè™‘ä¸ºå®ƒå‡å‡è´Ÿã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/large-class-2.png"/></div>
<ul>
<li>å¦‚æœè¿‡å¤§ç±»ä¸­çš„éƒ¨åˆ†è¡Œä¸ºå¯ä»¥æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç»„ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code>ã€‚</li>
<li>å¦‚æœè¿‡å¤§ç±»ä¸­çš„éƒ¨åˆ†è¡Œä¸ºå¯ä»¥ç”¨ä¸åŒæ–¹å¼å®ç°æˆ–ä½¿ç”¨äºç‰¹æ®Šåœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>æç‚¼å­ç±»(Extract Subclass)</code>ã€‚</li>
<li>å¦‚æœæœ‰å¿…è¦ä¸ºå®¢æˆ·ç«¯æä¾›ä¸€ç»„æ“ä½œå’Œè¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨ <code>æç‚¼æ¥å£(Extract Interface)</code>ã€‚</li>
<li>å¦‚æœä½ çš„è¿‡å¤§ç±»æ˜¯ä¸ª GUI ç±»ï¼Œå¯èƒ½éœ€è¦æŠŠæ•°æ®å’Œè¡Œä¸ºç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„é¢†åŸŸå¯¹è±¡å»ã€‚ä½ å¯èƒ½éœ€è¦ä¸¤è¾¹å„ä¿ç•™ä¸€äº›é‡å¤æ•°æ®ï¼Œå¹¶ä¿æŒä¸¤è¾¹åŒæ­¥ã€‚ <code>å¤åˆ¶è¢«ç›‘è§†æ•°æ®(Duplicate Observed Data)</code> å¯ä»¥å‘Šè¯‰ä½ æ€ä¹ˆåšã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>é‡æ„è¿‡å¤§çš„ç±»å¯ä»¥ä½¿ç¨‹åºå‘˜ä¸å¿…è®°ä½ä¸€ä¸ªç±»ä¸­å¤§é‡çš„å±æ€§ã€‚</li>
<li>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåˆ†å‰²è¿‡å¤§çš„ç±»å¯ä»¥é¿å…ä»£ç å’ŒåŠŸèƒ½çš„é‡å¤ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/large-class-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼ç±»extract-class-2"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class-2"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="æç‚¼å­ç±»extract-subclass"><a class="markdownIt-Anchor" href="#æç‚¼å­ç±»extract-subclass"></a> æç‚¼å­ç±»(Extract Subclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸€ä¸ªç±»ä¸­æœ‰äº›ç‰¹æ€§ä»…ç”¨äºç‰¹å®šåœºæ™¯ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-subclass-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åˆ›å»ºä¸€ä¸ªå­ç±»ï¼Œå¹¶å°†ç”¨äºç‰¹æ®Šåœºæ™¯çš„ç‰¹æ€§ç½®å…¥å…¶ä¸­ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-subclass-after.png"/></div>
<h4 id="æç‚¼æ¥å£extract-interface"><a class="markdownIt-Anchor" href="#æç‚¼æ¥å£extract-interface"></a> æç‚¼æ¥å£(Extract Interface)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å¤šä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ä¸€ä¸ªç±»éƒ¨åˆ†ç›¸åŒçš„å‡½æ•°ã€‚å¦ä¸€ä¸ªåœºæ™¯æ˜¯ä¸¤ä¸ªç±»ä¸­çš„éƒ¨åˆ†å‡½æ•°ç›¸åŒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-interface-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨ç›¸åŒçš„éƒ¨åˆ†å‡½æ•°åˆ°æ¥å£ä¸­ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-interface-after.png"/></div>
<h4 id="å¤åˆ¶è¢«ç›‘è§†æ•°æ®duplicate-observed-data"><a class="markdownIt-Anchor" href="#å¤åˆ¶è¢«ç›‘è§†æ•°æ®duplicate-observed-data"></a> å¤åˆ¶è¢«ç›‘è§†æ•°æ®(Duplicate Observed Data)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å¦‚æœå­˜å‚¨åœ¨ç±»ä¸­çš„æ•°æ®æ˜¯è´Ÿè´£ GUI çš„ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/duplicate-observed-data-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯å°†è´Ÿè´£ GUI çš„æ•°æ®æ”¾å…¥ä¸€ä¸ªç‹¬ç«‹çš„ç±»ï¼Œä»¥ç¡®ä¿ GUI æ•°æ®ä¸åŸŸç±»ä¹‹é—´çš„è¿æ¥å’ŒåŒæ­¥ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/duplicate-observed-data-after.png"/></div>
<h2 id="è¿‡é•¿å‡½æ•°"><a class="markdownIt-Anchor" href="#è¿‡é•¿å‡½æ•°"></a> è¿‡é•¿å‡½æ•°</h2>
<blockquote>
<p>è¿‡é•¿å‡½æ•°(Long Method)</p>
<p>ä¸€ä¸ªå‡½æ•°å«æœ‰å¤ªå¤šè¡Œä»£ç ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä»»ä½•å‡½æ•°è¶…è¿‡ 10 è¡Œæ—¶ï¼Œä½ å°±å¯ä»¥è€ƒè™‘æ˜¯ä¸æ˜¯è¿‡é•¿äº†ã€‚<br />
å‡½æ•°ä¸­çš„ä»£ç è¡Œæ•°åŸåˆ™ä¸Šä¸è¦è¶…è¿‡ 100 è¡Œã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-method-1.png"/></div>
<h3 id="é—®é¢˜çš„åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜çš„åŸå› "></a> é—®é¢˜çš„åŸå› </h3>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°çš„éš¾åº¦è¦å¤§äºæ·»åŠ åŠŸèƒ½åˆ°ä¸€ä¸ªå·²å­˜åœ¨çš„å‡½æ•°ã€‚å¤§éƒ¨åˆ†äººéƒ½è§‰å¾—ï¼šâ€œæˆ‘å°±æ·»åŠ è¿™ä¹ˆä¸¤è¡Œä»£ç ï¼Œä¸ºæ­¤æ–°å»ºä¸€ä¸ªå‡½æ•°å®åœ¨æ˜¯å°é¢˜å¤§åšäº†ã€‚â€äºæ˜¯ï¼Œå¼ ä¸‰åŠ ä¸¤è¡Œï¼Œæå››åŠ ä¸¤è¡Œï¼Œç‹äº”åŠ ä¸¤è¡Œã€‚ã€‚ã€‚å‡½æ•°æ—¥ç›Šåºå¤§ï¼Œæœ€ç»ˆçƒ‚çš„åƒä¸€é”…æµ†ç³Šï¼Œå†ä¹Ÿæ²¡äººèƒ½å®Œå…¨çœ‹æ‡‚äº†ã€‚äºæ˜¯å¤§å®¶å°±æ›´ä¸æ•¢è½»æ˜“åŠ¨è¿™ä¸ªå‡½æ•°äº†ï¼Œåªèƒ½æ¶æ€§å¾ªç¯çš„å¾€å…¶ä¸­æ·»åŠ ä»£ç ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ çœ‹åˆ°ä¸€ä¸ªè¶…è¿‡ 200 è¡Œçš„å‡½æ•°ï¼Œé€šå¸¸éƒ½æ˜¯å¤šä¸ªç¨‹åºå‘˜ä¸œæ‹¼è¥¿å‡‘å‡ºæ¥çš„ã€‚</p>
<h3 id="è§£å†³å‡½æ•°"><a class="markdownIt-Anchor" href="#è§£å†³å‡½æ•°"></a> è§£å†³å‡½æ•°</h3>
<p>ä¸€ä¸ªå¾ˆå¥½çš„æŠ€å·§æ˜¯ï¼š<strong>å¯»æ‰¾æ³¨é‡Š</strong>ã€‚æ·»åŠ æ³¨é‡Šï¼Œä¸€èˆ¬æœ‰è¿™ä¹ˆå‡ ä¸ªåŸå› ï¼šä»£ç é€»è¾‘è¾ƒä¸ºæ™¦æ¶©æˆ–å¤æ‚ï¼›è¿™æ®µä»£ç åŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹ï¼›ç‰¹æ®Šå¤„ç†ã€‚<br />
å¦‚æœä»£ç å‰æ–¹æœ‰ä¸€è¡Œæ³¨é‡Šï¼Œå°±æ˜¯åœ¨æé†’ä½ ï¼šå¯ä»¥å°†è¿™æ®µä»£ç æ›¿æ¢æˆä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸”å¯ä»¥åœ¨æ³¨é‡Šçš„åŸºç¡€ä¸Šç»™è¿™ä¸ªå‡½æ•°å‘½åã€‚å¦‚æœå‡½æ•°æœ‰ä¸€ä¸ªæè¿°æ°å½“çš„åå­—ï¼Œå°±ä¸éœ€è¦å»çœ‹å†…éƒ¨ä»£ç ç©¶ç«Ÿæ˜¯å¦‚ä½•å®ç°çš„ã€‚å°±ç®—åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¦‚æœå®ƒéœ€è¦ä»¥æ³¨é‡Šæ¥è¯´æ˜ï¼Œé‚£ä¹Ÿå€¼å¾—å°†å®ƒæç‚¼åˆ°ç‹¬ç«‹å‡½æ•°ä¸­ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-method-2.png"/></div>
<ul>
<li>ä¸ºäº†ç»™ä¸€ä¸ªå‡½æ•°ç˜¦èº«ï¼Œå¯ä»¥ä½¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code>ã€‚</li>
<li>å¦‚æœå±€éƒ¨å˜é‡å’Œå‚æ•°å¹²æ‰°æç‚¼å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡(Replace Temp with Query)</code>ï¼Œ<code>å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</code> æˆ– <code>ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</code> ã€‚</li>
<li>å¦‚æœå‰é¢ä¸¤æ¡æ²¡æœ‰å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡ <code>ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°(Replace Method with Method Object)</code> å°è¯•ç§»åŠ¨æ•´ä¸ªå‡½æ•°åˆ°ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ä¸­ã€‚</li>
<li>æ¡ä»¶è¡¨è¾¾å¼å’Œå¾ªç¯å¸¸å¸¸ä¹Ÿæ˜¯æç‚¼çš„ä¿¡å·ã€‚å¯¹äºæ¡ä»¶è¡¨è¾¾å¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼(Decompose Conditional)</code> ã€‚è‡³äºå¾ªç¯ï¼Œåº”è¯¥ä½¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°†å¾ªç¯å’Œå…¶å†…çš„ä»£ç æç‚¼åˆ°ç‹¬ç«‹å‡½æ•°ä¸­ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-4"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-4"></a> æ”¶ç›Š</h3>
<ul>
<li>åœ¨æ‰€æœ‰ç±»å‹çš„é¢å‘å¯¹è±¡ä»£ç ä¸­ï¼Œå‡½æ•°æ¯”è¾ƒçŸ­å°ç²¾æ‚çš„ç±»å¾€å¾€ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿ã€‚ä¸€ä¸ªå‡½æ•°è¶Šé•¿ï¼Œå°±è¶Šä¸å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚</li>
<li>æ­¤å¤–ï¼Œè¿‡é•¿å‡½æ•°ä¸­å¾€å¾€å«æœ‰éš¾ä»¥å‘ç°çš„é‡å¤ä»£ç ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-method-3.png"/></div>
<h3 id="æ€§èƒ½"><a class="markdownIt-Anchor" href="#æ€§èƒ½"></a> æ€§èƒ½</h3>
<p>æ˜¯å¦åƒè®¸å¤šäººè¯´çš„é‚£æ ·ï¼Œå¢åŠ å‡½æ•°çš„æ•°é‡ä¼šå½±å“æ€§èƒ½ï¼Ÿåœ¨å‡ ä¹ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ç§å½±å“æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒã€‚<br />
æ­¤å¤–ï¼Œç°åœ¨æœ‰äº†æ¸…æ™°å’Œæ˜“è¯»çš„ä»£ç ï¼Œåœ¨éœ€è¦çš„æ—¶å€™ï¼Œä½ å°†æ›´å®¹æ˜“æ‰¾åˆ°çœŸæ­£æœ‰æ•ˆçš„å‡½æ•°æ¥é‡ç»„ä»£ç å’Œæé«˜æ€§èƒ½ã€‚</p>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-4"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-4"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼å‡½æ•°extract-method"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡replace-temp-with-query"><a class="markdownIt-Anchor" href="#ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡replace-temp-with-query"></a> ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡(Replace Temp with Query)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å°†è¡¨è¾¾å¼çš„ç»“æœæ”¾åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œç„¶ååœ¨ä»£ç ä¸­ä½¿ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">calculateTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">double</span> basePrice = quantity * itemPrice;</span><br><span class="line">  <span class="keyword">if</span> (basePrice &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice * <span class="number">0.95</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice * <span class="number">0.98</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†æ•´ä¸ªè¡¨è¾¾å¼ç§»åŠ¨åˆ°ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ä¸­å¹¶è¿”å›ç»“æœã€‚ä½¿ç”¨æŸ¥è¯¢å‡½æ•°æ¥æ›¿ä»£ä½¿ç”¨å˜é‡ã€‚å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨å…¶ä»–å‡½æ•°ä¸­åˆå¹¶æ–°å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">calculateTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (basePrice() &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice() * <span class="number">0.95</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice() * <span class="number">0.98</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">basePrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> quantity * itemPrice;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-3"><a class="markdownIt-Anchor" href="#å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-3"></a> å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªå¯¹è±¡æ¥å–ä»£è¿™äº›å‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-after.png"/></div>
<h4 id="ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-3"><a class="markdownIt-Anchor" href="#ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-3"></a> ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange.getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange.getHigh();</span><br><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>
<h4 id="ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°replace-method-with-method-object"><a class="markdownIt-Anchor" href="#ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°replace-method-with-method-object"></a> ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°(Replace Method with Method Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªè¿‡é•¿å‡½æ•°ï¼Œå®ƒçš„å±€éƒ¨å˜é‡äº¤ç»‡åœ¨ä¸€èµ·ï¼Œä»¥è‡´äºä½ æ— æ³•åº”ç”¨æç‚¼å‡½æ•°(Extract Method) ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">price</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> primaryBasePrice;</span><br><span class="line">    <span class="keyword">double</span> secondaryBasePrice;</span><br><span class="line">    <span class="keyword">double</span> tertiaryBasePrice;</span><br><span class="line">    <span class="comment">// long computation.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†å‡½æ•°ç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç±»ä¸­ï¼Œä½¿å¾—å±€éƒ¨å˜é‡æˆäº†è¿™ä¸ªç±»çš„å­—æ®µã€‚ç„¶åï¼Œä½ å¯ä»¥å°†å‡½æ•°åˆ†å‰²æˆè¿™ä¸ªç±»ä¸­çš„å¤šä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">price</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> PriceCalculator(<span class="keyword">this</span>).compute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriceCalculator</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> primaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> secondaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> tertiaryBasePrice;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PriceCalculator</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// copy relevant information from order object.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">compute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// long computation.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼decompose-conditional"><a class="markdownIt-Anchor" href="#åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼decompose-conditional"></a> åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼(Decompose Conditional)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰å¤æ‚çš„æ¡ä»¶è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (date.before(SUMMER_START) || date.after(SUMMER_END)) &#123;</span><br><span class="line">  charge = quantity * winterRate + winterServiceCharge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  charge = quantity * summerRate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ ¹æ®æ¡ä»¶åˆ†æ”¯å°†æ•´ä¸ªæ¡ä»¶è¡¨è¾¾å¼åˆ†è§£æˆå‡ ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (notSummer(date)) &#123;</span><br><span class="line">  charge = winterCharge(quantity);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  charge = summerCharge(quantity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="è¿‡é•¿å‚æ•°åˆ—"><a class="markdownIt-Anchor" href="#è¿‡é•¿å‚æ•°åˆ—"></a> è¿‡é•¿å‚æ•°åˆ—</h2>
<blockquote>
<p>è¿‡é•¿å‚æ•°åˆ—(Long Parameter List)</p>
<p>ä¸€ä¸ªå‡½æ•°æœ‰è¶…è¿‡ 3ã€4 ä¸ªå…¥å‚ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-parameter-list-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -4"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -4"></a> é—®é¢˜åŸå› </h3>
<p>è¿‡é•¿å‚æ•°åˆ—å¯èƒ½æ˜¯å°†å¤šä¸ªç®—æ³•å¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­æ—¶å‘ç”Ÿçš„ã€‚å‡½æ•°ä¸­çš„å…¥å‚å¯ä»¥ç”¨æ¥æ§åˆ¶æœ€ç»ˆé€‰ç”¨å“ªä¸ªç®—æ³•å»æ‰§è¡Œã€‚</p>
<p>è¿‡é•¿å‚æ•°åˆ—ä¹Ÿå¯èƒ½æ˜¯è§£è€¦ç±»ä¹‹é—´ä¾èµ–å…³ç³»æ—¶çš„å‰¯äº§å“ã€‚ä¾‹å¦‚ï¼Œç”¨äºåˆ›å»ºå‡½æ•°ä¸­æ‰€éœ€çš„ç‰¹å®šå¯¹è±¡çš„ä»£ç å·²ä»å‡½æ•°ç§»åŠ¨åˆ°è°ƒç”¨å‡½æ•°çš„ä»£ç å¤„ï¼Œä½†åˆ›å»ºçš„å¯¹è±¡æ˜¯ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚å› æ­¤ï¼ŒåŸå§‹ç±»ä¸å†çŸ¥é“å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶ä¸”ä¾èµ–æ€§ä¹Ÿå·²ç»å‡å°‘ã€‚ä½†æ˜¯å¦‚æœåˆ›å»ºçš„è¿™äº›å¯¹è±¡ï¼Œæ¯ä¸€ä¸ªéƒ½å°†éœ€è¦å®ƒè‡ªå·±çš„å‚æ•°ï¼Œè¿™æ„å‘³ç€è¿‡é•¿å‚æ•°åˆ—ã€‚</p>
<p>å¤ªé•¿çš„å‚æ•°åˆ—éš¾ä»¥ç†è§£ï¼Œå¤ªå¤šå‚æ•°ä¼šé€ æˆå‰åä¸ä¸€è‡´ã€ä¸æ˜“ä½¿ç”¨ï¼Œè€Œä¸”ä¸€æ—¦éœ€è¦æ›´å¤šæ•°æ®ï¼Œå°±ä¸å¾—ä¸ä¿®æ”¹å®ƒã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ¡ˆ"></a> è§£å†³æ–¹æ¡ˆ</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-parameter-list-2.png"/></div>
<ul>
<li>å¦‚æœå‘å·²æœ‰çš„å¯¹è±¡å‘å‡ºä¸€æ¡è¯·æ±‚å°±å¯ä»¥å–ä»£ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆä½ åº”è¯¥ä½¿ç”¨ <code>ä»¥å‡½æ•°å–ä»£å‚æ•°(Replace Parameter with Methods)</code> ã€‚åœ¨è¿™é‡Œï¼Œï¼Œâ€œå·²æœ‰çš„å¯¹è±¡â€å¯èƒ½æ˜¯å‡½æ•°æ‰€å±ç±»é‡Œçš„ä¸€ä¸ªå­—æ®µï¼Œä¹Ÿå¯èƒ½æ˜¯å¦ä¸€ä¸ªå‚æ•°ã€‚</li>
<li>ä½ è¿˜å¯ä»¥è¿ç”¨ <code>ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</code> å°†æ¥è‡ªåŒä¸€å¯¹è±¡çš„ä¸€å †æ•°æ®æ”¶é›†èµ·æ¥ï¼Œå¹¶ä»¥è¯¥å¯¹è±¡æ›¿æ¢å®ƒä»¬ã€‚</li>
<li>å¦‚æœæŸäº›æ•°æ®ç¼ºä¹åˆç†çš„å¯¹è±¡å½’å±ï¼Œå¯ä½¿ç”¨ <code>å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</code> ä¸ºå®ƒä»¬åˆ¶é€ å‡ºä¸€ä¸ªâ€œå‚æ•°å¯¹è±¡â€ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-5"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-5"></a> æ”¶ç›Š</h3>
<ul>
<li>æ›´æ˜“è¯»ï¼Œæ›´ç®€çŸ­çš„ä»£ç ã€‚</li>
<li>é‡æ„å¯èƒ½ä¼šæš´éœ²å‡ºä¹‹å‰æœªæ³¨æ„åˆ°çš„é‡å¤ä»£ç ã€‚</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥-2"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-2"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>è¿™é‡Œæœ‰ä¸€ä¸ªé‡è¦çš„ä¾‹å¤–ï¼šæœ‰æ—¶å€™ä½ æ˜æ˜¾ä¸æƒ³é€ æˆ&quot;è¢«è°ƒç”¨å¯¹è±¡&quot;ä¸&quot;è¾ƒå¤§å¯¹è±¡&quot;é—´çš„æŸç§ä¾èµ–å…³ç³»ã€‚è¿™æ—¶å€™å°†æ•°æ®ä»å¯¹è±¡ä¸­æ‹†è§£å‡ºæ¥å•ç‹¬ä½œä¸ºå‚æ•°ï¼Œä¹Ÿå¾ˆåˆæƒ…ç†ã€‚ä½†æ˜¯è¯·æ³¨æ„å…¶æ‰€å¼•å‘çš„ä»£ä»·ã€‚å¦‚æœå‚æ•°åˆ—å¤ªé•¿æˆ–å˜åŒ–å¤ªé¢‘ç¹ï¼Œå°±éœ€è¦é‡æ–°è€ƒè™‘è‡ªå·±çš„ä¾èµ–ç»“æ„äº†ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-5"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-5"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="ä»¥å‡½æ•°å–ä»£å‚æ•°replace-parameter-with-methods"><a class="markdownIt-Anchor" href="#ä»¥å‡½æ•°å–ä»£å‚æ•°replace-parameter-with-methods"></a> ä»¥å‡½æ•°å–ä»£å‚æ•°(Replace Parameter with Methods)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å¯¹è±¡è°ƒç”¨æŸä¸ªå‡½æ•°ï¼Œå¹¶å°†æ‰€å¾—ç»“æœä½œä¸ºå‚æ•°ï¼Œä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚è€Œæ¥å—è¯¥å‚æ•°çš„å‡½æ•°æœ¬èº«ä¹Ÿèƒ½å¤Ÿè°ƒç”¨å‰ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> basePrice = quantity * itemPrice;</span><br><span class="line"><span class="keyword">double</span> seasonDiscount = <span class="keyword">this</span>.getSeasonalDiscount();</span><br><span class="line"><span class="keyword">double</span> fees = <span class="keyword">this</span>.getFees();</span><br><span class="line"><span class="keyword">double</span> finalPrice = discountedPrice(basePrice, seasonDiscount, fees);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>è®©å‚æ•°æ¥å—è€…å»é™¤è¯¥é¡¹å‚æ•°ï¼Œå¹¶ç›´æ¥è°ƒç”¨å‰ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> basePrice = quantity * itemPrice;</span><br><span class="line"><span class="keyword">double</span> finalPrice = discountedPrice(basePrice);</span><br></pre></td></tr></table></figure>
<h4 id="ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-4"><a class="markdownIt-Anchor" href="#ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-4"></a> ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange.getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange.getHigh();</span><br><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-4"><a class="markdownIt-Anchor" href="#å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-4"></a> å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªå¯¹è±¡æ¥å–ä»£è¿™äº›å‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-after.png"/></div>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>é‡æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>é‡æ„</tag>
        <tag>ä»£ç åå‘³é“</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»£ç åå‘³é“ä¹‹è€¦åˆ</title>
    <url>/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/couplers" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/couplers</a></p>
<p><strong>è€¦åˆ(Couplers)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä¸åŒç±»ä¹‹é—´è¿‡åº¦è€¦åˆã€‚</strong></p>
</blockquote>
<h2 id="ä¸å®Œç¾çš„åº“ç±»"><a class="markdownIt-Anchor" href="#ä¸å®Œç¾çš„åº“ç±»"></a> ä¸å®Œç¾çš„åº“ç±»</h2>
<blockquote>
<p>ä¸å®Œç¾çš„åº“ç±»(Incomplete Library Class)</p>
<p>å½“ä¸€ä¸ªç±»åº“å·²ç»ä¸èƒ½æ»¡è¶³å®é™…éœ€è¦æ—¶ï¼Œä½ å°±ä¸å¾—ä¸æ”¹å˜è¿™ä¸ªåº“ï¼ˆå¦‚æœè¿™ä¸ªåº“æ˜¯åªè¯»çš„ï¼Œé‚£å°±æ²¡è¾™äº†ï¼‰ã€‚</p>
</blockquote>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>è®¸å¤šç¼–ç¨‹æŠ€æœ¯éƒ½å»ºç«‹åœ¨åº“ç±»çš„åŸºç¡€ä¸Šã€‚åº“ç±»çš„ä½œè€…æ²¡ç”¨æœªåœå…ˆçŸ¥çš„èƒ½åŠ›ï¼Œä¸èƒ½å› æ­¤è´£æ€ªä»–ä»¬ã€‚éº»çƒ¦çš„æ˜¯åº“å¾€å¾€æ„é€ çš„ä¸å¤Ÿå¥½ï¼Œè€Œä¸”å¾€å¾€ä¸å¯èƒ½è®©æˆ‘ä»¬ä¿®æ”¹å…¶ä¸­çš„ç±»ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä½ åªæƒ³ä¿®æ”¹ç±»åº“çš„ä¸€ä¸¤ä¸ªå‡½æ•°ï¼Œå¯ä»¥è¿ç”¨ <code>å¼•å…¥å¤–åŠ å‡½æ•°(Introduce Foreign Method)</code>ï¼›</li>
<li>å¦‚æœæƒ³è¦æ·»åŠ ä¸€å¤§å †é¢å¤–è¡Œä¸ºï¼Œå°±å¾—è¿ç”¨ <code>å¼•å…¥æœ¬åœ°æ‰©å±•(Introduce Local Extension)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘ä»£ç é‡å¤ï¼ˆä½ ä¸ç”¨ä¸€è¨€ä¸åˆå°±è‡ªå·±åŠ¨æ‰‹å®ç°ä¸€ä¸ªåº“çš„å…¨éƒ¨åŠŸèƒ½ï¼Œä»£ä»·å¤ªé«˜ï¼‰</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>å¦‚æœæ‰©å±•åº“ä¼šå¸¦æ¥é¢å¤–çš„å·¥ä½œé‡ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="å¼•å…¥å¤–åŠ å‡½æ•°introduce-foreign-method"><a class="markdownIt-Anchor" href="#å¼•å…¥å¤–åŠ å‡½æ•°introduce-foreign-method"></a> å¼•å…¥å¤–åŠ å‡½æ•°(Introduce Foreign Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ éœ€è¦ä¸ºæä¾›æœåŠ¡çš„ç±»å¢åŠ ä¸€ä¸ªå‡½æ•°ï¼Œä½†ä½ æ— æ³•ä¿®æ”¹è¿™ä¸ªç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Report</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sendReport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Date nextDay = <span class="keyword">new</span> Date(previousEnd.getYear(),</span><br><span class="line">      previousEnd.getMonth(), previousEnd.getDate() + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>åœ¨å®¢æˆ·ç±»ä¸­å»ºç«‹ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸€ä¸ªç¬¬ä¸€ä¸ªå‚æ•°å½¢å¼ä¼ å…¥ä¸€ä¸ªæœåŠ¡ç±»å®ä¾‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Report</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sendReport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Date newStart = nextDay(previousEnd);</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Date <span class="title">nextDay</span><span class="params">(Date arg)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date(arg.getYear(), arg.getMonth(), arg.getDate() + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥æœ¬åœ°æ‰©å±•introduce-local-extension"><a class="markdownIt-Anchor" href="#å¼•å…¥æœ¬åœ°æ‰©å±•introduce-local-extension"></a> å¼•å…¥æœ¬åœ°æ‰©å±•(Introduce Local Extension)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ éœ€è¦ä¸ºæœåŠ¡ç±»æä¾›ä¸€äº›é¢å¤–å‡½æ•°ï¼Œä½†ä½ æ— æ³•ä¿®æ”¹è¿™ä¸ªç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-local-extension-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œä½¿å®ƒåŒ…å«è¿™äº›é¢å¤–å‡½æ•°ï¼Œè®©è¿™ä¸ªæ‰©å±•å“æˆä¸ºæºç±»çš„å­ç±»æˆ–åŒ…è£…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-local-extension-after.png"/></div>
<h2 id="ä¸­é—´äºº"><a class="markdownIt-Anchor" href="#ä¸­é—´äºº"></a> ä¸­é—´äºº</h2>
<blockquote>
<p>ä¸­é—´äºº(Middle Man)</p>
<p>å¦‚æœä¸€ä¸ªç±»çš„ä½œç”¨ä»…ä»…æ˜¯æŒ‡å‘å¦ä¸€ä¸ªç±»çš„å§”æ‰˜ï¼Œä¸ºä»€ä¹ˆè¦å­˜åœ¨å‘¢ï¼Ÿ</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/middle-man-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>å¯¹è±¡çš„åŸºæœ¬ç‰¹å¾ä¹‹ä¸€å°±æ˜¯å°è£…ï¼šå¯¹å¤–éƒ¨ä¸–ç•Œéšè—å…¶å†…éƒ¨ç»†èŠ‚ã€‚å°è£…å¾€å¾€ä¼´éšå§”æ‰˜ã€‚ä½†æ˜¯äººä»¬å¯èƒ½è¿‡åº¦è¿ç”¨å§”æ‰˜ã€‚æ¯”å¦‚ï¼Œä½ ä¹Ÿè®¸ä¼šçœ‹åˆ°ä¸€ä¸ªç±»çš„å¤§éƒ¨åˆ†æœ‰ç”¨å·¥ä½œéƒ½å§”æ‰˜ç»™äº†å…¶ä»–ç±»ï¼Œç±»æœ¬èº«æˆäº†ä¸€ä¸ªç©ºå£³ï¼Œé™¤äº†å§”æ‰˜ä¹‹å¤–ä¸åšä»»ä½•äº‹æƒ…ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<p>åº”è¯¥è¿ç”¨ <code>ç§»é™¤ä¸­é—´äºº(Remove Middle Man)</code>ï¼Œç›´æ¥å’ŒçœŸæ­£è´Ÿè´£çš„å¯¹è±¡æ‰“äº¤é“ã€‚</p>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘ç¬¨é‡çš„ä»£ç ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/middle-man-2.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥-2"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-2"></a> ä½•æ—¶å¿½ç•¥</h3>
<p>å¦‚æœæ˜¯ä»¥ä¸‹æƒ…å†µï¼Œä¸è¦åˆ é™¤å·²åˆ›å»ºçš„ä¸­é—´äººï¼š</p>
<ul>
<li>æ·»åŠ ä¸­é—´äººæ˜¯ä¸ºäº†é¿å…ç±»ä¹‹é—´ä¾èµ–å…³ç³»ã€‚</li>
<li>ä¸€äº›è®¾è®¡æ¨¡å¼æœ‰ç›®çš„åœ°åˆ›å»ºä¸­é—´äººï¼ˆä¾‹å¦‚ä»£ç†æ¨¡å¼å’Œè£…é¥°å™¨æ¨¡å¼ï¼‰ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="ç§»é™¤ä¸­é—´äººremove-middle-man"><a class="markdownIt-Anchor" href="#ç§»é™¤ä¸­é—´äººremove-middle-man"></a> ç§»é™¤ä¸­é—´äºº(Remove Middle Man)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†è¿‡å¤šçš„ç®€å•å§”æ‰˜åŠ¨ä½œã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-middle-man-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>è®©å®¢æˆ·ç›´æ¥è°ƒç”¨å§”æ‰˜ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-middle-man-after.png"/></div>
<h2 id="ä¾æ‹æƒ…ç»“"><a class="markdownIt-Anchor" href="#ä¾æ‹æƒ…ç»“"></a> ä¾æ‹æƒ…ç»“</h2>
<blockquote>
<p>ä¾æ‹æƒ…ç»“(Feature Envy)</p>
<p>ä¸€ä¸ªå‡½æ•°è®¿é—®å…¶å®ƒå¯¹è±¡çš„æ•°æ®æ¯”è®¿é—®è‡ªå·±çš„æ•°æ®æ›´å¤šã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/feature-envy-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>è¿™ç§æ°”å‘³å¯èƒ½å‘ç”Ÿåœ¨å­—æ®µç§»åŠ¨åˆ°æ•°æ®ç±»ä¹‹åã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œä½ å¯èƒ½æƒ³å°†æ•°æ®ç±»çš„æ“ä½œç§»åŠ¨åˆ°è¿™ä¸ªç±»ä¸­ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-3"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-3"></a> è§£å†³æ–¹æ³•</h3>
<p>As a basic rule, if things change at the same time, you should keep them in the same place. Usually data and functions that use this data are changed together (although exceptions are possible).</p>
<p>æœ‰ä¸€ä¸ªåŸºæœ¬åŸåˆ™ï¼šåŒæ—¶ä¼šå‘ç”Ÿæ”¹å˜çš„äº‹æƒ…åº”è¯¥è¢«æ”¾åœ¨åŒä¸€ä¸ªåœ°æ–¹ã€‚é€šå¸¸ï¼Œæ•°æ®å’Œä½¿ç”¨è¿™äº›æ•°æ®çš„å‡½æ•°æ˜¯ä¸€èµ·æ”¹å˜çš„ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/feature-envy-2.png"/></div>
<ul>
<li>å¦‚æœä¸€ä¸ªå‡½æ•°æ˜æ˜¾åº”è¯¥è¢«ç§»åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œå¯è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> ã€‚</li>
<li>å¦‚æœä»…ä»…æ˜¯å‡½æ•°çš„éƒ¨åˆ†ä»£ç è®¿é—®å¦ä¸€ä¸ªå¯¹è±¡çš„æ•°æ®ï¼Œè¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°†è¿™éƒ¨åˆ†ä»£ç ç§»åˆ°ç‹¬ç«‹çš„å‡½æ•°ä¸­ã€‚</li>
<li>å¦‚æœä¸€ä¸ªæ–¹æ³•ä½¿ç”¨æ¥è‡ªå…¶ä»–å‡ ä¸ªç±»çš„å‡½æ•°ï¼Œé¦–å…ˆç¡®å®šå“ªä¸ªç±»åŒ…å«å¤§å¤šæ•°ä½¿ç”¨çš„æ•°æ®ã€‚ç„¶åï¼Œå°†è¯¥æ–¹æ³•ä¸å…¶ä»–æ•°æ®ä¸€èµ·æ”¾åœ¨æ­¤ç±»ä¸­ã€‚æˆ–è€…ï¼Œä½¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°†æ–¹æ³•æ‹†åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œå¯ä»¥æ”¾ç½®åœ¨ä¸åŒç±»ä¸­çš„ä¸åŒä½ç½®ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘é‡å¤ä»£ç ï¼ˆå¦‚æœæ•°æ®å¤„ç†çš„ä»£ç æ”¾åœ¨ä¸­å¿ƒä½ç½®ï¼‰ã€‚</li>
<li>æ›´å¥½çš„ä»£ç ç»„ç»‡æ€§ï¼ˆå¤„ç†æ•°æ®çš„å‡½æ•°é è¿‘å®é™…æ•°æ®ï¼‰ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/feature-envy-3.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥-3"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-3"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶ï¼Œè¡Œä¸ºè¢«æœ‰æ„åœ°ä¸ä¿å­˜æ•°æ®çš„ç±»åˆ†å¼€ã€‚è¿™é€šå¸¸çš„ä¼˜ç‚¹æ˜¯èƒ½å¤ŸåŠ¨æ€åœ°æ”¹å˜è¡Œä¸ºï¼ˆè§ç­–ç•¥è®¾è®¡æ¨¡å¼ï¼Œè®¿é—®è€…è®¾è®¡æ¨¡å¼å’Œå…¶ä»–æ¨¡å¼ï¼‰ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æ¬ç§»å‡½æ•°move-method"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æç‚¼å‡½æ•°extract-method"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç‹æ˜µå…³ç³»"><a class="markdownIt-Anchor" href="#ç‹æ˜µå…³ç³»"></a> ç‹æ˜µå…³ç³»</h2>
<blockquote>
<p>ç‹æ˜µå…³ç³»(Inappropriate Intimacy)</p>
<p>ä¸€ä¸ªç±»å¤§é‡ä½¿ç”¨å¦ä¸€ä¸ªç±»çš„å†…éƒ¨å­—æ®µå’Œæ–¹æ³•ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inappropriate-intimacy-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -4"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -4"></a> é—®é¢˜åŸå› </h3>
<p>ç±»å’Œç±»ä¹‹é—´åº”è¯¥å°½é‡å°‘çš„æ„ŸçŸ¥å½¼æ­¤ï¼ˆå‡å°‘è€¦åˆï¼‰ã€‚è¿™æ ·çš„ç±»æ›´å®¹æ˜“ç»´æŠ¤å’Œå¤ç”¨ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-4"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-4"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>æœ€ç®€å•çš„è§£å†³æ–¹æ³•æ˜¯è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> å’Œ <code>æ¬ç§»å­—æ®µ(Move Field)</code> æ¥è®©ç±»ä¹‹é—´æ–©æ–­ç¾ç»Šã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inappropriate-intimacy-2.png"/></div>
<ul>
<li>
<p>ä½ ä¹Ÿå¯ä»¥çœ‹çœ‹æ˜¯å¦èƒ½è¿ç”¨ <code>å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”(Change Bidirectional Association to Unidirectional)</code> è®©å…¶ä¸­ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªè¯´åˆ†æ‰‹ã€‚</p>
</li>
<li>
<p>å¦‚æœè¿™ä¸¤ä¸ªç±»å®åœ¨æ˜¯æƒ…æ¯”é‡‘åšï¼Œéš¾åˆ†éš¾èˆï¼Œå¯ä»¥è¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code> æŠŠäºŒè€…å…±åŒç‚¹æç‚¼åˆ°ä¸€ä¸ªæ–°ç±»ä¸­ï¼Œè®©å®ƒä»¬äº§ç”Ÿçˆ±çš„ç»“æ™¶ã€‚æˆ–è€…ï¼Œå¯ä»¥å°è¯•è¿ç”¨ <code>éšè—å§”æ‰˜å…³ç³»(Hide Delegate)</code> è®©å¦ä¸€ä¸ªç±»æ¥ä¸ºå®ƒä»¬ç‰µçº¿æ­æ¡¥ã€‚</p>
</li>
<li>
<p>ç»§æ‰¿å¾€å¾€é€ æˆç±»ä¹‹é—´è¿‡åˆ†ç´§å¯†ï¼Œå› ä¸ºå­ç±»å¯¹è¶…ç±»çš„äº†è§£æ€»æ˜¯è¶…è¿‡åè€…çš„ä¸»è§‚æ„¿æœ›ï¼Œå¦‚æœä½ è§‰å¾—è¯¥è®©è¿™ä¸ªå­ç±»è‡ªå·±é—¯è¡ï¼Œè¯·è¿ç”¨ <code>ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿(Replace Inheritance with Delegation)</code> æ¥è®©è¶…ç±»å’Œå­ç±»åˆ†å®¶ã€‚</p>
</li>
</ul>
<h3 id="æ”¶ç›Š-4"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-4"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç ç»„ç»‡æ€§ã€‚</li>
<li>æé«˜ä»£ç å¤ç”¨æ€§ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inappropriate-intimacy-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-4"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-4"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æ¬ç§»å‡½æ•°move-method-2"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method-2"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æ¬ç§»å­—æ®µmove-field"><a class="markdownIt-Anchor" href="#æ¬ç§»å­—æ®µmove-field"></a> æ¬ç§»å­—æ®µ(Move Field)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>åœ¨ä½ çš„ç¨‹åºä¸­ï¼ŒæŸä¸ªå­—æ®µè¢«å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»æ›´å¤šåœ°ç”¨åˆ°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-field-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨ç›®æ ‡ç±»æ–°å»ºä¸€ä¸ªå­—æ®µï¼Œä¿®æ”¹æºå­—æ®µçš„æ‰€æœ‰ç”¨æˆ·ï¼Œä»¤ä»–ä»¬æ”¹ç”¨æ–°å­—æ®µã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-field-after.png"/></div>
<h4 id="å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”change-bidirectional-association-to-unidirectional"><a class="markdownIt-Anchor" href="#å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”change-bidirectional-association-to-unidirectional"></a> å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”(Change Bidirectional Association to Unidirectional)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸¤ä¸ªç±»ä¹‹é—´æœ‰åŒå‘å…³è”ï¼Œä½†å…¶ä¸­ä¸€ä¸ªç±»å¦‚ä»Šä¸å†éœ€è¦å¦ä¸€ä¸ªç±»çš„ç‰¹æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/change-bidirectional-association-to-unidirectional-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»é™¤ä¸å¿…è¦çš„å…³è”ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/change-bidirectional-association-to-unidirectional-after.png"/></div>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="éšè—å§”æ‰˜å…³ç³»hide-delegate"><a class="markdownIt-Anchor" href="#éšè—å§”æ‰˜å…³ç³»hide-delegate"></a> éšè—å§”æ‰˜å…³ç³»(Hide Delegate)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å®¢æˆ·é€šè¿‡ä¸€ä¸ªå§”æ‰˜ç±»æ¥è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-delegate-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨æœåŠ¡ç±»ä¸Šå»ºç«‹å®¢æˆ·æ‰€éœ€çš„æ‰€æœ‰å‡½æ•°ï¼Œç”¨ä»¥éšè—å§”æ‰˜å…³ç³»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-delegate-after.png"/></div>
<h4 id="ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿replace-inheritance-with-delegation"><a class="markdownIt-Anchor" href="#ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿replace-inheritance-with-delegation"></a> ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿(Replace Inheritance with Delegation)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªå­ç±»åªä½¿ç”¨è¶…ç±»æ¥å£ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–æ˜¯æ ¹æœ¬ä¸éœ€è¦ç»§æ‰¿è€Œæ¥çš„æ•°æ®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-delegation-with-inheritance-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨å­ç±»ä¸­æ–°å»ºä¸€ä¸ªå­—æ®µç”¨ä»¥ä¿å­˜è¶…ç±»ï¼›è°ƒæ•´å­ç±»å‡½æ•°ï¼Œä»¤å®ƒæ”¹è€Œå§”æ‰˜è¶…ç±»ï¼›ç„¶åå»æ‰ä¸¤è€…ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-delegation-with-inheritance-after.png"/></div>
<h2 id="è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾"><a class="markdownIt-Anchor" href="#è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾"></a> è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾</h2>
<blockquote>
<p>è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾(Message Chains)</p>
<p>æ¶ˆæ¯é“¾çš„å½¢å¼ç±»ä¼¼äºï¼š<code>obj.getA().getB().getC()</code>ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/message-chains-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -5"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -5"></a> é—®é¢˜åŸå› </h3>
<p>å¦‚æœä½ çœ‹åˆ°ç”¨æˆ·å‘ä¸€ä¸ªå¯¹è±¡è¯·æ±‚å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå†å‘åè€…è¯·æ±‚å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå†è¯·æ±‚å¦ä¸€ä¸ªå¯¹è±¡â€¦â€¦è¿™å°±æ˜¯æ¶ˆæ¯é“¾ã€‚å®é™…ä»£ç ä¸­ä½ çœ‹åˆ°çš„å¯èƒ½æ˜¯ä¸€é•¿ä¸² getThis()æˆ–ä¸€é•¿ä¸²ä¸´æ—¶å˜é‡ã€‚é‡‡å–è¿™ç§æ–¹å¼ï¼Œæ„å‘³å®¢æˆ·ä»£ç å°†ä¸æŸ¥æ‰¾è¿‡ç¨‹ä¸­çš„å¯¼èˆªç´§å¯†è€¦åˆã€‚ä¸€æ—¦å¯¹è±¡é—´å…³ç³»å‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œå®¢æˆ·ç«¯å°±ä¸å¾—ä¸åšå‡ºç›¸åº”çš„ä¿®æ”¹ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-5"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-5"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¯ä»¥è¿ç”¨ <code>éšè—å§”æ‰˜å…³ç³»(Hide Delegate)</code> åˆ é™¤ä¸€ä¸ªæ¶ˆæ¯é“¾ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/message-chains-2.png"/></div>
<ul>
<li>æœ‰æ—¶æ›´å¥½çš„é€‰æ‹©æ˜¯ï¼šå…ˆè§‚å¯Ÿæ¶ˆæ¯é“¾æœ€ç»ˆå¾—åˆ°çš„å¯¹è±¡æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ã€‚çœ‹çœ‹èƒ½å¦ä»¥ <code>æç‚¼å‡½æ•°(Extract Method)</code>æŠŠä½¿ç”¨è¯¥å¯¹è±¡çš„ä»£ç æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå†è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> æŠŠè¿™ä¸ªå‡½æ•°æ¨å…¥æ¶ˆæ¯é“¾ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-5"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-5"></a> æ”¶ç›Š</h3>
<ul>
<li>èƒ½å‡å°‘é“¾ä¸­ç±»ä¹‹é—´çš„ä¾èµ–ã€‚</li>
<li>èƒ½å‡å°‘ä»£ç é‡ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/message-chains-3.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥-4"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-4"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>è¿‡äºä¾µç•¥æ€§çš„å§”æ‰˜å¯èƒ½ä¼šä½¿ç¨‹åºå‘˜éš¾ä»¥ç†è§£åŠŸèƒ½æ˜¯å¦‚ä½•è§¦å‘çš„ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-5"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-5"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="éšè—å§”æ‰˜å…³ç³»hide-delegate-2"><a class="markdownIt-Anchor" href="#éšè—å§”æ‰˜å…³ç³»hide-delegate-2"></a> éšè—å§”æ‰˜å…³ç³»(Hide Delegate)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å®¢æˆ·é€šè¿‡ä¸€ä¸ªå§”æ‰˜ç±»æ¥è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-delegate-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨æœåŠ¡ç±»ä¸Šå»ºç«‹å®¢æˆ·æ‰€éœ€çš„æ‰€æœ‰å‡½æ•°ï¼Œç”¨ä»¥éšè—å§”æ‰˜å…³ç³»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-delegate-after.png"/></div>
<h4 id="æç‚¼å‡½æ•°extract-method-2"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method-2"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¬ç§»å‡½æ•°move-method-3"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method-3"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>é‡æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>é‡æ„</tag>
        <tag>ä»£ç åå‘³é“</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»£ç çš„åå‘³é“å’Œé‡æ„</title>
    <url>/blog/design/refactor/%E4%BB%A3%E7%A0%81%E7%9A%84%E5%9D%8F%E5%91%B3%E9%81%93%E5%92%8C%E9%87%8D%E6%9E%84/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<p>ç¬¬ä¸€æ¬¡è¯»ã€Šé‡æ„:æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹æ—¶ï¼Œæˆ‘æ›¾æ•´ç†è¿‡ä¸€ä¸ªç®€å•çš„ç¬”è®°ã€‚æœ€è¿‘ï¼Œå› ä¸ºå‚ä¸ä¸€ä¸ªé‡æ„é¡¹ç›®ï¼Œå†ä¸€æ¬¡æ¸©ä¹ äº†ã€Šé‡æ„:æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹ã€‚è¿‡ç¨‹ä¸­ï¼ŒèŒå‘äº†è®¤çœŸæ€»ç»“ã€æ•´ç†é‡æ„æ–¹æ³•çš„å†²åŠ¨ï¼Œäºæ˜¯æœ‰äº†è¿™ç³»åˆ—æ–‡å­—ã€‚</p>
<p>ä»£ç çš„åå‘³é“è¿˜æœ‰å‡ ç¯‡æ²¡æœ‰å®Œç¨¿ï¼Œåé¢æˆ‘ä¼šé™†ç»­è¡¥å……ã€‚ã€‚ã€‚</p>
<h2 id="ç—‡ä¸è¯"><a class="markdownIt-Anchor" href="#ç—‡ä¸è¯"></a> ç—‡ä¸è¯</h2>
<h3 id="å¯¹ä»£ç çš„åå‘³é“çš„æ€è€ƒ"><a class="markdownIt-Anchor" href="#å¯¹ä»£ç çš„åå‘³é“çš„æ€è€ƒ"></a> å¯¹ä»£ç çš„åå‘³é“çš„æ€è€ƒ</h3>
<p>â€œæœ‰ç—…è¦æ—©æ²»ï¼Œä¸è¦æ”¾å¼ƒæ²»ç–—â€ã€‚å¤šä¹ˆæœ´ç´ çš„é“ç† ï¼Œäººäººéƒ½æ‡‚ã€‚</p>
<p>ç—…ï¼Œå°±æ˜¯ä¸å¥åº·ã€‚</p>
<p>äººæœ‰ç—…ï¼Œå¯ä»¥é€šè¿‡æ‰“é’ˆã€åƒè¯ã€åšæ‰‹æœ¯æ¥è¿›è¡Œæ²»ç–—ã€‚</p>
<p><strong>å¦‚æœæŠŠä»£ç çš„åå‘³é“ï¼ˆä»£ç è´¨é‡é—®é¢˜ï¼‰æ¯”ä½œç—…ç—‡ï¼Œé‚£ä¹ˆé‡æ„å°±æ˜¯æ²»ç–—ä»£ç çš„åå‘³é“çš„è¯ã€‚</strong></p>
<p>ä¸ªäººè®¤ä¸ºï¼Œåœ¨é‡æ„è¿™ä»¶äº‹ä¸Šï¼Œä¹Ÿå¯ä»¥åº”ç”¨æ²»ç—…çš„é“ç†ï¼š</p>
<ul>
<li>
<p><strong>é˜²ç—…äºæœªç„¶ã€‚</strong><br />
â€”â€” æ˜¥ç§‹æˆ˜å›½æ—¶æœŸçš„ä¸€ä»£ååŒ»æ‰é¹Šï¼Œæ›¾ç»æœ‰ä¸ªå¾ˆè‘—åçš„åŒ»å­¦ä¸»å¼ ï¼š<strong>é˜²ç—…äºæœªç„¶</strong>ã€‚ æˆ‘è§‰å¾—è¿™ä¸ªé“ç†åº”ç”¨äºè½¯ä»¶ä»£ç çš„é‡æ„äº¦ç„¶ã€‚ç¼–ç¨‹å‰è¦æœ‰åˆç†çš„è®¾è®¡ã€ç¼–ç¨‹æ—¶è¦æœ‰è‰¯å¥½çš„ç¼–ç¨‹é£æ ¼ï¼Œå°½é‡å‡å°‘é—®é¢˜ã€‚ä»è¿™ä¸ªå±‚é¢ä¸Šè¯´ï¼Œäº†è§£ä»£ç çš„åå‘³é“ï¼Œä¸ä»…ä»…æ˜¯ä¸ºäº†å‘ç°é—®é¢˜ã€è§£å†³é—®é¢˜ã€‚æ›´é‡è¦çš„ä½œç”¨æ˜¯ï¼šæŒ‡å¯¼æˆ‘ä»¬åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­æœ‰æ„è¯†çš„å»è§„é¿è¿™äº›é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>å°ç—…ä¸åŒ»ï¼Œæ˜“å¾—å¤§ç—…ã€‚</strong><br />
â€”â€” åˆ˜å¤‡è¯´è¿‡ï¼šâ€œå‹¿ä»¥å–„å°è€Œä¸ä¸ºï¼Œå‹¿ä»¥æ¶å°è€Œä¸ºä¹‹â€ã€‚å‘ç°é—®é¢˜å°±åŠæ—¶ä¿®æ”¹ï¼Œä»£ç è´¨é‡è‡ªç„¶å®¹æ˜“è¿›å…¥è‰¯æ€§å¾ªç¯ï¼›åä¹‹ï¼Œäº¦ç„¶ã€‚è¦é‡è§†ç§¯ç´¯çš„åŠ›é‡ï¼Œåˆ«æ€»ä»¥ä¸ºä»£ç å‡ºç°ç‚¹å°é—®é¢˜ï¼Œé‚£éƒ½ä¸æ˜¯äº‹å„¿ã€‚</p>
</li>
<li>
<p><strong>å¯¹ç—‡ä¸‹è¯ã€‚</strong><br />
â€”â€” ç¨‹åºå‡ºç°äº†é—®é¢˜ï¼Œè¦åˆ†æå‡ºé—®é¢˜çš„æ ¹æœ¬ï¼Œæœ‰é’ˆå¯¹æ€§çš„åˆ¶å®šåˆç†çš„é‡æ„æ–¹æ¡ˆã€‚å¤§å®¶éƒ½çŸ¥é“åƒé”™è¯çš„åæœï¼ŒåŒæ ·çš„ï¼Œ<strong>çæ”¹è¿˜ä¸å¦‚ä¸æ”¹</strong>ã€‚</p>
</li>
<li>
<p><strong>å¿ŒçŒ›è¯</strong><br />
â€”â€” åŒ»ç—…ç”¨çŒ›è¯å®¹æ˜“äº§ç”Ÿå‰¯ä½œç”¨ã€‚æ¢ä¸€å¥ä¿—è¯­ï¼šæ­¥å­å¤§äº†å®¹æ˜“æ‰¯ç€è›‹ã€‚é‡æ„å¦‚æœå¤§åˆ€é˜”æ–§çš„å¹²ï¼Œé‚£ä½ å°±è¦æœ‰éšæ—¶å¯èƒ½æ‰‘è¡—çš„å¿ƒç†å‡†å¤‡ã€‚æ¨å€’é‡æ¥ä¸æ˜¯é‡æ„ï¼Œè€Œæ˜¯é‡å†™ã€‚é‡æ„åº”è¯¥æ˜¯å¾ªåºæ¸è¿›ï¼Œæ­¥æ­¥ä¸ºè¥çš„è¿‡ç¨‹ã€‚å½“ä½ å‘ç°é‡å†™ä»£ç æ¯”é‡æ„ä»£ç æ›´ç®€å•ï¼Œå¾€å¾€è¯´æ˜ä½ æ—©å°±è¯¥é‡æ„äº†ã€‚</p>
</li>
</ul>
<h3 id="é‡æ„çš„åŸåˆ™"><a class="markdownIt-Anchor" href="#é‡æ„çš„åŸåˆ™"></a> é‡æ„çš„åŸåˆ™</h3>
<p>å‰é¢æŠŠä»£ç è´¨é‡é—®é¢˜æ¯”ä½œç—…ç—‡ï¼Œè€ŒæŠŠé‡æ„æ¯”ä½œè¯ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å†è¿›ä¸€æ­¥è®¨è®ºä¸€ä¸‹é‡æ„çš„åŸåˆ™ã€‚</p>
<h4 id="ä½•è°“é‡æ„what"><a class="markdownIt-Anchor" href="#ä½•è°“é‡æ„what"></a> ä½•è°“é‡æ„(What)</h4>
<p><code>é‡æ„ï¼ˆRefactoringï¼‰</code> çš„å¸¸è§å®šä¹‰æ˜¯ï¼šä¸æ”¹å˜è½¯ä»¶ç³»ç»Ÿå¤–éƒ¨è¡Œä¸ºçš„å‰æä¸‹ï¼Œæ”¹å–„å®ƒçš„å†…éƒ¨ç»“æ„ã€‚</p>
<p>ä¸ªäººè§‰å¾—è¿™ä¸ªå®šä¹‰æœ‰ç‚¹ç”Ÿæ¶©ã€‚ä¸å¦¨ç†è§£ä¸ºï¼šé‡æ„æ˜¯ç»™ä»£ç æ²»ç—…çš„è¡Œä¸ºã€‚è€Œä»£ç æœ‰ç—…æ˜¯æŒ‡ä»£ç çš„è´¨é‡ï¼ˆå¯é æ€§ã€å®‰å…¨æ€§ã€å¯å¤ç”¨æ€§ã€å¯ç»´æŠ¤æ€§ï¼‰å’Œæ€§èƒ½æœ‰é—®é¢˜ã€‚</p>
<p><strong>é‡æ„çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜ä»£ç çš„è´¨é‡å’Œæ€§èƒ½</strong>ã€‚</p>
<p><em>æ³¨ï¼šåŠŸèƒ½ä¸å…¨æˆ–è€…ä¸æ­£ç¡®ï¼Œé‚£æ˜¯æ®‹ç–¾ä»£ç ã€‚å°±åƒæ²»ç—…æ²»ä¸äº†æ®‹ç–¾ï¼Œé‡æ„ä¹Ÿè§£å†³ä¸äº†åŠŸèƒ½é—®é¢˜ã€‚</em></p>
<h4 id="ä¸ºä½•é‡æ„why"><a class="markdownIt-Anchor" href="#ä¸ºä½•é‡æ„why"></a> ä¸ºä½•é‡æ„(Why)</h4>
<p>ç¿»ç¿»ä¹¦ï¼Œä¸Šç½‘æœä¸€ä¸‹ï¼Œè°ˆåˆ°é‡æ„çš„ç†ç”±å¤§ä½“ç›¸åŒï¼š</p>
<ul>
<li>é‡æ„æ”¹è¿›è½¯ä»¶è®¾è®¡</li>
<li>é‡æ„ä½¿è½¯ä»¶æ›´å®¹æ˜“ç†è§£</li>
<li>é‡æ„å¸®åŠ©æ‰¾åˆ° bug</li>
<li>é‡æ„æé«˜ç¼–ç¨‹é€Ÿåº¦</li>
</ul>
<p>æ€»ä¹‹å°±æ˜¯ï¼Œ<strong>é‡æ„å¯ä»¥æé«˜ä»£ç è´¨é‡</strong>ã€‚</p>
<h4 id="ä½•æ—¶é‡æ„when"><a class="markdownIt-Anchor" href="#ä½•æ—¶é‡æ„when"></a> ä½•æ—¶é‡æ„(When)</h4>
<p>å…³äºä½•æ—¶é‡æ„ï¼Œæˆ‘å…ˆå¼•ç”¨ä¸€ä¸‹ <a href="http://mt.sohu.com/20160812/n463980993.shtml" target="_blank" rel="noopener"><u>é‡æ„å¹¶ééš¾åœ¨å¦‚ä½•åšï¼Œè€Œæ˜¯éš¾åœ¨ä½•æ—¶å¼€å§‹åš</u></a> ä¸€æ–‡çš„è§‚ç‚¹ã€‚</p>
<blockquote>
<p>å¯¹äºä¸€ä¸ªé«˜é€Ÿå‘å±•çš„å…¬å¸æ¥è¯´ï¼Œåœæ­¢ä¸šåŠ¡å¼€å‘ï¼Œä¸“é—¨æ¥åšé‡æ„é¡¹ç›®ï¼Œ<strong>ä»æ¥å°±ä¸æ˜¯ä¸€ä¸ªå¯æ¥å—çš„é€‰é¡¹</strong>ï¼Œâ€œè¾¹å¼€é£æœºè¾¹æ¢å¼•æ“â€æ‰æ˜¯è¿™ç§å…¬å¸æƒ³è¦çš„ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬ä¸å¦¨æ¥è¡¡é‡ä¸€ä¸‹é‡æ„çš„æˆæœ¬å’Œæ”¶ç›Šã€‚</p>
<ul>
<li>
<p><strong>é‡æ„çš„æˆæœ¬</strong></p>
<p>é‡æ„æ˜¯æœ‰æˆæœ¬çš„ï¼Œè´¹æ—¶è´¹åŠ›ï¼ˆæ—¶é—´ã€äººåŠ›ï¼‰ä¸è¯´ï¼Œè¿˜æœ‰å¯èƒ½ä¼šä½¿æœ¬æ¥æ­£å¸¸è¿è¡Œçš„ç¨‹åºå‡ºé”™ã€‚æ‰€ä»¥ï¼Œå¾ˆå¤šäººéƒ½æŠ±ç€â€œä¸æ±‚æœ‰åŠŸï¼Œä½†æ±‚æ— è¿‡â€çš„å¿ƒç†å¾—è¿‡ä¸”è¿‡ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æˆæœ¬ï¼šé‡æ„ä½¿ç”¨è¾ƒæ–°ä¸”è¾ƒä¸ºå¤æ‚çš„æŠ€æœ¯ï¼Œå­¦ä¹ æ›²çº¿ä¸å¹³æ»‘ï¼Œå›¢é˜Ÿæˆå‘˜æŠ€æœ¯åˆ‡æ¢å›°éš¾ï¼ŒçŸ­æœŸå†…å¼€å‘æ•ˆç‡å¯èƒ½ä¸å‡åé™ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœä¸€ç›´æ”¾ä»»ä»£ç è…æœ½ä¸‹å»ï¼ŒæŠ€æœ¯å€ºåŠ¡ä¼šè¶Šæ¥è¶Šæ²‰é‡ã€‚å½“ä»£ç æœ€ç»ˆå¿«è¦è·‘ä¸åŠ¨æ—¶ï¼Œæ¶æ„å¸ˆä»¬å¾€å¾€è¿˜æ˜¯ä¸å¾—ä¸ä½¿ç”¨æ¿€è¿›çš„æ‰‹æ®µæ¥æ²»ç–—ä»£ç çš„é¡½ç–¾ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªè¿‡ç¨‹é€šå¸¸éƒ½æ˜¯éå¸¸ç—›è‹¦çš„ï¼Œè€Œä¸”æœ‰ç€å¾ˆé«˜çš„å¤±è´¥é£é™©ã€‚</p>
</li>
<li>
<p><strong>é‡æ„çš„æ”¶ç›Š</strong></p>
<p>é‡æ„çš„æ”¶ç›Šæ˜¯æé«˜ä»£ç çš„è´¨é‡å’Œæ€§èƒ½ï¼Œå¹¶æé«˜æœªæ¥çš„å¼€å‘æ•ˆç‡ã€‚ä½†æ˜¯ï¼Œåº”å½“çœ‹åˆ°ï¼Œé‡æ„å¾€å¾€å¹¶ä¸èƒ½åœ¨çŸ­æœŸå†…å¸¦æ¥å®é™…çš„æ•ˆç›Šï¼Œæˆ–è€…å¾ˆéš¾ç›´è§‚çœ‹å‡ºæ•ˆç›Šã€‚è€Œå¯¹äºä¸€ä¸ªä¼ä¸šæ¥è¯´ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”æ•ˆç›Šæ›´é‡è¦ã€‚æ¢å¥è¯è¯´ï¼Œæ²¡æœ‰å®é™…æ•ˆç›Šçš„äº‹ï¼Œé€šå¸¸ä¹Ÿæ²¡æœ‰ä»·å€¼ã€‚å¾ˆå¤šé¢†å¯¼ï¼Œå°¤å…¶æ˜¯éæŠ€æœ¯æ–¹å‘çš„é¢†å¯¼ï¼Œå¹¶ä¸å…³å¿ƒä½ åº”ç”¨äº†ä»€ä¹ˆæ–°æŠ€æœ¯ï¼Œè®©ä»£ç å˜å¾—å¤šä¹ˆä¼˜é›…ç­‰ç­‰ã€‚</p>
</li>
<li>
<p><strong>é‡æ„çš„åˆé€‚æ—¶æœº</strong></p>
<p>ä»ä»¥ä¸Šæ¥çœ‹ï¼Œé‡æ„å®åœ¨æ˜¯ä¸ªåƒåŠ›ä¸è®¨å¥½çš„äº‹æƒ…ã€‚</p>
<p>äºæ˜¯ï¼Œå¾ˆå¤šäººå±ˆæœäºä¸‡æ¶çš„ KPI å’Œè¦å‘½çš„ deadlineï¼Œä¸€è¾¹åæ§½ç€ä»¥å‰çš„ä»£ç æ˜¯åƒåœ¾ï¼Œä¸€è¾¹è‡ªå·±ä¹Ÿåœ¨é€ åƒåœ¾ã€‚</p>
<p>ä½†æ˜¯ï¼Œ**é‡æ„æœ¬åº”è¯¥æ˜¯ä¸ªæ¸è¿›å¼çš„è¿‡ç¨‹ï¼Œä¸æ˜¯åªæœ‰ä¼¤ç­‹åŠ¨éª¨çš„æ”¹é€ æ‰å«é‡æ„ã€‚**å¦‚æœéè¦ç­‰åˆ°ä»£ç å·²ç»çƒ‚åˆ°ç—…å…¥è†è‚“ï¼Œå†ä½¿ç”¨æ¿€è¿›æ–¹å¼æ¥é‡æ„ï¼Œé‚£å¿…ç„¶æ˜¯å›°éš¾é‡é‡ï¼Œé£é™©æé«˜ã€‚</p>
<p>ã€Šé‡æ„ã€‹ä¹¦ä¸­æåˆ°çš„é‡æ„æ—¶æœºåº”è¯¥åœ¨æ·»åŠ åŠŸèƒ½ã€ä¿®å¤åŠŸèƒ½ã€å®¡æŸ¥ä»£ç æ—¶ï¼Œä¸å»ºè®®ä¸“é—¨æŠ½å‡ºæ—¶é—´ä¸“é—¨åšé‡æ„é¡¹ç›®ã€‚</p>
<p>æˆ‘è®¤ä¸ºï¼Œå…¶æ€æƒ³å°±æ˜¯æŒ‡ï¼š<strong>é‡æ„åº”è¯¥æ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­å®æ—¶çš„ã€æ¸è¿›çš„æ¼”åŒ–è¿‡ç¨‹ã€‚</strong></p>
</li>
<li>
<p><strong>é‡æ„çš„ä¸æ°å½“æ—¶æœº</strong></p>
<p>ä½†æ˜¯ï¼Œè¿™é‡Œæˆ‘ä¹Ÿè¦å¼ºè°ƒä¸€ä¸‹ï¼š<strong>ä¸æ˜¯æ‰€æœ‰è½¯ä»¶å¼€å‘è¿‡ç¨‹éƒ½ä¸€å®šè¦é‡æ„ã€‚</strong></p>
<p>è¾ƒèƒ½<strong>å‡¸æ˜¾é‡æ„ä»·å€¼çš„åœºæ™¯</strong>æ˜¯ï¼šä»£ç è§„æ¨¡è¾ƒå¤§ã€ç”Ÿå‘½å‘¨æœŸè¿˜è¾ƒé•¿ã€æ‰¿æ‹…äº†è¾ƒå¤šè´£ä»»ã€æœ‰ä¸€ä¸ªè¾ƒå¤§ï¼ˆä¸”è¾ƒä¸ç¨³å®šï¼Œäººå‘˜æµåŠ¨é¢‘ç¹ï¼‰å›¢é˜Ÿåœ¨å…¶ä¸Šå·¥ä½œçš„å•ä¸€ä»£ç åº“ã€‚</p>
<p>ä¸ä¹‹ç›¸åï¼Œæœ‰ä¸€äº›åœºæ™¯çš„é‡æ„ä»·å€¼å°±å¾ˆå°ï¼š</p>
<ul>
<li>ä»£ç åº“ç”Ÿå‘½å‘¨æœŸå¿«è¦èµ°åˆ°å°¾å£°ï¼Œå¼€å‘é€æ¸å‡å°‘ï¼Œä»¥ç»´æŠ¤ä¸ºä¸»ã€‚</li>
<li>ä»£ç åº“å½“å‰ç‰ˆæœ¬é©¬ä¸Šè¦å‘å¸ƒäº†ï¼Œè¿™æ—¶é‡æ„æ— ç–‘æ˜¯ç»™è‡ªå·±æ‰¾éº»çƒ¦ã€‚</li>
<li>é‡æ„ä»£ä»·è¿‡äºæ²‰é‡ï¼šé‡æ„ååŠŸèƒ½çš„æ­£ç¡®æ€§ã€ç¨³å®šæ€§éš¾ä»¥ä¿éšœï¼›æŠ€æœ¯è¿‡äºè¶…å‰ï¼Œå›¢é˜Ÿæˆå‘˜æŠ€æœ¯è¿ç§»éš¾åº¦å¤ªå¤§ã€‚</li>
</ul>
</li>
</ul>
<h4 id="å¦‚ä½•é‡æ„how"><a class="markdownIt-Anchor" href="#å¦‚ä½•é‡æ„how"></a> å¦‚ä½•é‡æ„(How)</h4>
<p>é‡æ„è¡Œä¸ºåœ¨æˆ‘çœ‹æ¥ï¼Œä¹Ÿæ˜¯å¯ä»¥åˆ†å±‚çº§çš„ã€‚ç”±é«˜åˆ°ä½ï¼Œè¶Šé«˜å±‚çº§éš¾åº¦è¶Šå¤§ï¼š</p>
<ul>
<li>
<p>æœåŠ¡ã€æ•°æ®åº“<br />
ç°ä»£è½¯ä»¶å¾€å¾€ä¸šåŠ¡å¤æ‚ã€åºå¤§ã€‚ä½¿ç”¨å¾®æœåŠ¡ã€æ•°æ®è¿ç§»æ¥æ‹†åˆ†ä¸šåŠ¡ï¼Œé™ä½ä¸šåŠ¡å¤æ‚åº¦æˆä¸ºäº†ä¸»æµã€‚ä½†æ˜¯ï¼Œè¿™äº›æŠ€æœ¯çš„æµ‹è¯•ã€éƒ¨ç½²å¤æ‚ï¼ŒæŠ€æœ¯éš¾åº¦å¾ˆé«˜ã€‚</p>
</li>
<li>
<p>ç»„ä»¶ã€æ¨¡å—ã€æ¡†æ¶<br />
ç»„ä»¶ã€æ¨¡å—ã€æ¡†æ¶çš„é‡æ„ï¼Œä¸»è¦æ˜¯é’ˆå¯¹ä»£ç çš„è®¾è®¡é—®é¢˜ã€‚è§£å†³çš„æ˜¯ä»£ç çš„æ•´ä½“ç»“æ„é—®é¢˜ã€‚éœ€è¦å¯¹æ¡†æ¶ã€è®¾è®¡æ¨¡å¼ã€åˆ†å¸ƒå¼ã€å¹¶å‘ç­‰ç­‰æœ‰è¶³å¤Ÿçš„äº†è§£ã€‚</p>
</li>
<li>
<p>ç±»ã€æ¥å£ã€å‡½æ•°ã€å­—æ®µ<br />
ã€Šé‡æ„ã€‹ä¸€ä¹¦æåˆ°äº†**â€œä»£ç çš„åå‘³é“â€**ä»¥åŠç›¸å…³çš„é‡æ„æ–¹æ³•ã€‚è¿™äº›éƒ½æ˜¯å¯¹ç±»ã€æ¥å£ã€å‡½æ•°ã€å­—æ®µçº§åˆ«ä»£ç çš„é‡æ„æ‰‹æ®µã€‚ç”±äºè¿™ä¸€çº§åˆ«çš„é‡æ„æ–¹æ³•è¾ƒä¸ºç®€å•ï¼Œæ‰€ä»¥å¯æ“ä½œæ€§è¾ƒå¼ºã€‚å…·ä½“ç»†èŠ‚å¯ä»¥é˜…è¯»ã€Šä»£ç çš„åå‘³é“ã€‹ç¯‡ç« ã€‚</p>
</li>
</ul>
<p>å‰ä¸¤ç§å±‚çº§çš„é‡æ„å·²ç»æ¶‰åŠåˆ°æ¶æ„å±‚é¢ï¼Œå½±å“è¾ƒå¤§ï¼Œéš¾åº¦è¾ƒé«˜ï¼Œå¦‚æœåŠŸåŠ›ä¸å¤Ÿä¸è¦è½»æ˜“å˜åŠ¨ã€‚ç”±äºè¿™ä¸¤ä¸ªå±‚çº§æ¶‰åŠé¢†åŸŸè¾ƒå¹¿ï¼Œè¿™é‡Œä¸åšè®ºè¿°ã€‚</p>
<p><u><strong><em>æ­¤å¤„ä¸ºåˆ†å‰²çº¿ã€‚ä¸‹é¢æ˜¯ä»£ç çš„åå‘³é“ç³»åˆ—ã€‚ã€‚ã€‚</em></strong></u></p>
<h2 id="ä»£ç çš„åå‘³é“"><a class="markdownIt-Anchor" href="#ä»£ç çš„åå‘³é“"></a> ä»£ç çš„åå‘³é“</h2>
<p>ã€Šé‡æ„:æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹ä¸­ä»‹ç»äº† 22 ç§ä»£ç çš„åå‘³é“ä»¥åŠé‡æ„æ‰‹æ³•ã€‚è¿™äº›åå‘³é“å¯ä»¥è¿›ä¸€æ­¥å½’ç±»ã€‚æˆ‘æ€»è§‰å¾—å°†äº‹ç‰©åˆ†ç±»æœ‰åŠ©äºç†è§£å’Œè®°å¿†ã€‚æ‰€ä»¥æœ¬ç³»åˆ—å°†åå‘³é“æŒ‰ç…§ç‰¹æ€§åˆ†ç±»ï¼Œç„¶åé€ä¸€è®²è§£ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/code-smell.png"/></div>
<h3 id="ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿"></a> ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç è‡ƒè‚¿(Bloated)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä»£ç ä¸­çš„ç±»ã€å‡½æ•°ã€å­—æ®µæ²¡æœ‰ç»è¿‡åˆç†çš„ç»„ç»‡ï¼Œåªæ˜¯ç®€å•çš„å †ç Œèµ·æ¥ã€‚è¿™ä¸€ç±»å‹çš„é—®é¢˜é€šå¸¸åœ¨ä»£ç çš„åˆæœŸå¹¶ä¸æ˜æ˜¾ï¼Œä½†æ˜¯éšç€ä»£ç è§„æ¨¡çš„å¢é•¿è€Œé€æ¸ç§¯ç´¯ï¼ˆç‰¹åˆ«æ˜¯å½“æ²¡æœ‰äººåŠªåŠ›å»æ ¹é™¤å®ƒä»¬æ—¶ï¼‰ã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E8%BF%87%E9%95%BF%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">è¿‡é•¿å‡½æ•°</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E8%BF%87%E5%A4%A7%E7%9A%84%E7%B1%BB" target="_blank" rel="noopener">è¿‡å¤§çš„ç±»</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%81%8F%E6%89%A7" target="_blank" rel="noopener">åŸºæœ¬ç±»å‹åæ‰§</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E8%BF%87%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97" target="_blank" rel="noopener">è¿‡é•¿å‚æ•°åˆ—</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E6%95%B0%E6%8D%AE%E6%B3%A5%E5%9B%A2" target="_blank" rel="noopener">æ•°æ®æ³¥å›¢</a></li>
</ul>
<h3 id="ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡"></a> ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">æ»¥ç”¨é¢å‘å¯¹è±¡(Object-Orientation Abusers)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä»£ç éƒ¨åˆ†æˆ–å®Œå…¨åœ°è¿èƒŒäº†é¢å‘å¯¹è±¡ç¼–ç¨‹åŸåˆ™ã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md#switch-%E5%A3%B0%E6%98%8E" target="_blank" rel="noopener">switch å£°æ˜</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md#%E4%B8%B4%E6%97%B6%E5%AD%97%E6%AE%B5" target="_blank" rel="noopener">ä¸´æ—¶å­—æ®µ</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md#%E8%A2%AB%E6%8B%92%E7%BB%9D%E7%9A%84%E9%A6%88%E8%B5%A0" target="_blank" rel="noopener">è¢«æ‹’ç»çš„é¦ˆèµ </a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md#%E5%BC%82%E6%9B%B2%E5%90%8C%E5%B7%A5%E7%9A%84%E7%B1%BB" target="_blank" rel="noopener">å¼‚æ›²åŒå·¥çš„ç±»</a></li>
</ul>
<h3 id="ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢"></a> ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">å˜é©çš„éšœç¢(Change Preventers)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šå½“ä½ éœ€è¦æ”¹å˜ä¸€å¤„ä»£ç æ—¶ï¼Œå´å‘ç°ä¸å¾—ä¸æ”¹å˜å…¶ä»–çš„åœ°æ–¹ã€‚è¿™ä½¿å¾—ç¨‹åºå¼€å‘å˜å¾—å¤æ‚ã€ä»£ä»·é«˜æ˜‚ã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md#%E5%8F%91%E6%95%A3%E5%BC%8F%E5%8F%98%E5%8C%96" target="_blank" rel="noopener">å‘æ•£å¼å˜åŒ–</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md#%E9%9C%B0%E5%BC%B9%E5%BC%8F%E4%BF%AE%E6%94%B9" target="_blank" rel="noopener">éœ°å¼¹å¼ä¿®æ”¹</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md#%E5%B9%B3%E8%A1%8C%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB" target="_blank" rel="noopener">å¹³è¡Œç»§æ‰¿ä½“ç³»</a></li>
</ul>
<h3 id="ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„"></a> ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">éå¿…è¦çš„(Dispensables)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šè¿™æ ·çš„ä»£ç å¯æœ‰å¯æ— ï¼Œå®ƒçš„å­˜åœ¨åè€Œå½±å“æ•´ä½“ä»£ç çš„æ•´æ´å’Œå¯è¯»æ€§ã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E8%BF%87%E5%A4%9A%E7%9A%84%E6%B3%A8%E9%87%8A" target="_blank" rel="noopener">è¿‡å¤šçš„æ³¨é‡Š</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener">é‡å¤ä»£ç </a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E5%86%97%E4%BD%99%E7%B1%BB" target="_blank" rel="noopener">å†—ä½™ç±»</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E7%BA%AF%E7%A8%9A%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB" target="_blank" rel="noopener">çº¯ç¨šçš„æ•°æ®ç±»</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E5%A4%B8%E5%A4%B8%E5%85%B6%E8%B0%88%E6%9C%AA%E6%9D%A5%E6%80%A7" target="_blank" rel="noopener">å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§</a></li>
</ul>
<h3 id="ä»£ç åå‘³é“ä¹‹è€¦åˆ"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹è€¦åˆ"></a> ä»£ç åå‘³é“ä¹‹è€¦åˆ</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">è€¦åˆ(Couplers)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä¸åŒç±»ä¹‹é—´è¿‡åº¦è€¦åˆã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E4%BE%9D%E6%81%8B%E6%83%85%E7%BB%93" target="_blank" rel="noopener">ä¾æ‹æƒ…ç»“</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E7%8B%8E%E6%98%B5%E5%85%B3%E7%B3%BB" target="_blank" rel="noopener">ç‹æ˜µå…³ç³»</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E8%BF%87%E5%BA%A6%E8%80%A6%E5%90%88%E7%9A%84%E6%B6%88%E6%81%AF%E9%93%BE" target="_blank" rel="noopener">è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E4%B8%AD%E9%97%B4%E4%BA%BA" target="_blank" rel="noopener">ä¸­é—´äºº</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E4%B8%8D%E5%AE%8C%E7%BE%8E%E7%9A%84%E5%BA%93%E7%B1%BB" target="_blank" rel="noopener">ä¸å®Œç¾çš„åº“ç±»</a></li>
</ul>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>é‡æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>é‡æ„</tag>
        <tag>ä»£ç åå‘³é“</tag>
      </tags>
  </entry>
  <entry>
    <title>Sqoop</title>
    <url>/blog/bigdata/Sqoop/</url>
    <content><![CDATA[<h1 id="sqoop"><a class="markdownIt-Anchor" href="#sqoop"></a> Sqoop</h1>
<blockquote>
<p><strong>Sqoop æ˜¯ä¸€ä¸ªä¸»è¦åœ¨ Hadoop å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´è¿›è¡Œæ‰¹é‡æ•°æ®è¿ç§»çš„å·¥å…·ã€‚</strong></p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#sqoop-%E7%AE%80%E4%BB%8B">Sqoop ç®€ä»‹</a>
<ul>
<li><a href="#%E6%8F%90%E4%BE%9B%E5%A4%9A%E7%A7%8D-sqoop-%E8%BF%9E%E6%8E%A5%E5%99%A8">æä¾›å¤šç§ Sqoop è¿æ¥å™¨</a></li>
<li><a href="#sqoop-%E7%89%88%E6%9C%AC">Sqoop ç‰ˆæœ¬</a></li>
</ul>
</li>
<li><a href="#sqoop-%E5%8E%9F%E7%90%86">Sqoop åŸç†</a>
<ul>
<li><a href="#%E5%AF%BC%E5%85%A5">å¯¼å…¥</a></li>
<li><a href="#%E5%AF%BC%E5%87%BA">å¯¼å‡º</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="sqoop-ç®€ä»‹"><a class="markdownIt-Anchor" href="#sqoop-ç®€ä»‹"></a> Sqoop ç®€ä»‹</h2>
<p><strong>Sqoop æ˜¯ä¸€ä¸ªä¸»è¦åœ¨ Hadoop å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´è¿›è¡Œæ‰¹é‡æ•°æ®è¿ç§»çš„å·¥å…·ã€‚</strong></p>
<ul>
<li>Hadoopï¼šHDFSã€Hiveã€HBaseã€Inceptorã€Hyperbase</li>
<li>é¢å‘å¤§æ•°æ®é›†çš„æ‰¹é‡å¯¼å…¥å¯¼å‡º</li>
<li>å°†è¾“å…¥æ•°æ®é›†åˆ†ä¸º N ä¸ªåˆ‡ç‰‡ï¼Œç„¶åå¯åŠ¨ N ä¸ª Map ä»»åŠ¡å¹¶è¡Œä¼ è¾“</li>
<li>æ”¯æŒå…¨é‡ã€å¢é‡ä¸¤ç§ä¼ è¾“æ–¹å¼</li>
</ul>
<h3 id="æä¾›å¤šç§-sqoop-è¿æ¥å™¨"><a class="markdownIt-Anchor" href="#æä¾›å¤šç§-sqoop-è¿æ¥å™¨"></a> æä¾›å¤šç§ Sqoop è¿æ¥å™¨</h3>
<h4 id="å†…ç½®è¿æ¥å™¨"><a class="markdownIt-Anchor" href="#å†…ç½®è¿æ¥å™¨"></a> å†…ç½®è¿æ¥å™¨</h4>
<ul>
<li>ç»è¿‡ä¼˜åŒ–çš„ä¸“ç”¨ RDBMS è¿æ¥å™¨ï¼šMySQLã€PostgreSQLã€Oracleã€DB2ã€SQL Serverã€Netzza ç­‰</li>
<li>é€šç”¨çš„ JDBC è¿æ¥å™¨ï¼šæ”¯æŒ JDBC åè®®çš„æ•°æ®åº“</li>
</ul>
<h4 id="ç¬¬ä¸‰æ–¹è¿æ¥å™¨"><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰æ–¹è¿æ¥å™¨"></a> ç¬¬ä¸‰æ–¹è¿æ¥å™¨</h4>
<ul>
<li>æ•°æ®ä»“åº“ï¼šTeradata</li>
<li>NoSQL æ•°æ®åº“ï¼šCouchbase</li>
</ul>
<h3 id="sqoop-ç‰ˆæœ¬"><a class="markdownIt-Anchor" href="#sqoop-ç‰ˆæœ¬"></a> Sqoop ç‰ˆæœ¬</h3>
<h4 id="sqoop-1-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#sqoop-1-ä¼˜ç¼ºç‚¹"></a> Sqoop 1 ä¼˜ç¼ºç‚¹</h4>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/Sqoop/sqoop-architecture.png"/></div>
<p>ä¼˜ç‚¹</p>
<ul>
<li>æ¶æ„ç®€å•</li>
<li>éƒ¨ç½²ç®€å•</li>
<li>åŠŸèƒ½å…¨é¢</li>
<li>ç¨³å®šæ€§è¾ƒé«˜</li>
<li>é€Ÿåº¦è¾ƒå¿«</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>è®¿é—®æ–¹å¼å•ä¸€</li>
<li>å‘½ä»¤è¡Œæ–¹å¼å®¹æ˜“å‡ºé”™ï¼Œæ ¼å¼ç´§è€¦åˆ</li>
<li>å®‰å…¨æœºåˆ¶ä¸å¤Ÿå®Œå–„ï¼Œå­˜åœ¨å¯†ç æ³„éœ²é£é™©</li>
</ul>
<h4 id="sqoop-2-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#sqoop-2-ä¼˜ç¼ºç‚¹"></a> Sqoop 2 ä¼˜ç¼ºç‚¹</h4>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/Sqoop/sqoop-v2-architecture.png"/></div>
<p>ä¼˜ç‚¹</p>
<ul>
<li>è®¿é—®æ–¹å¼å¤šæ ·</li>
<li>é›†ä¸­ç®¡ç†è¿æ¥å™¨</li>
<li>å®‰å…¨æœºåˆ¶è¾ƒå®Œå–„</li>
<li>æ”¯æŒå¤šç”¨æˆ·</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>æ¶æ„è¾ƒå¤æ‚</li>
<li>éƒ¨ç½²è¾ƒç¹ç</li>
<li>ç¨³å®šæ€§ä¸€èˆ¬</li>
<li>é€Ÿåº¦ä¸€èˆ¬</li>
</ul>
<h2 id="sqoop-åŸç†"><a class="markdownIt-Anchor" href="#sqoop-åŸç†"></a> Sqoop åŸç†</h2>
<h3 id="å¯¼å…¥"><a class="markdownIt-Anchor" href="#å¯¼å…¥"></a> å¯¼å…¥</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/Sqoop/sqoop-import.png"/></div>
<h3 id="å¯¼å‡º"><a class="markdownIt-Anchor" href="#å¯¼å‡º"></a> å¯¼å‡º</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/Sqoop/sqoop-export.png"/></div>
]]></content>
      <categories>
        <category>bigdata</category>
      </categories>
      <tags>
        <tag>bigdata</tag>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Flume</title>
    <url>/blog/bigdata/Flume/</url>
    <content><![CDATA[<h1 id="flume"><a class="markdownIt-Anchor" href="#flume"></a> Flume</h1>
<blockquote>
<p><strong>Sqoop æ˜¯ä¸€ä¸ªä¸»è¦åœ¨ Hadoop å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´è¿›è¡Œæ‰¹é‡æ•°æ®è¿ç§»çš„å·¥å…·ã€‚</strong></p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#flume-%E7%AE%80%E4%BB%8B">Flume ç®€ä»‹</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-flume-">ä»€ä¹ˆæ˜¯ Flume ï¼Ÿ</a></li>
<li><a href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">åº”ç”¨åœºæ™¯</a></li>
</ul>
</li>
<li><a href="#flume-%E5%8E%9F%E7%90%86">Flume åŸç†</a>
<ul>
<li><a href="#flume-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5">Flume åŸºæœ¬æ¦‚å¿µ</a></li>
<li><a href="#flume-%E5%9F%BA%E6%9C%AC%E7%BB%84%E4%BB%B6">Flume åŸºæœ¬ç»„ä»¶</a></li>
<li><a href="#flume-%E6%95%B0%E6%8D%AE%E6%B5%81">Flume æ•°æ®æµ</a></li>
</ul>
</li>
<li><a href="#%E8%B5%84%E6%BA%90">èµ„æº</a></li>
</ul>
<!-- /TOC -->
<h2 id="flume-ç®€ä»‹"><a class="markdownIt-Anchor" href="#flume-ç®€ä»‹"></a> Flume ç®€ä»‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯-flume"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-flume"></a> ä»€ä¹ˆæ˜¯ Flume ï¼Ÿ</h3>
<p>Flume æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æµ·é‡æ•°æ®é‡‡é›†ã€èšåˆå’Œä¼ è¾“ç³»ç»Ÿã€‚</p>
<p>ç‰¹ç‚¹</p>
<ul>
<li>åŸºäºäº‹ä»¶çš„æµ·é‡æ•°æ®é‡‡é›†</li>
<li>æ•°æ®æµæ¨¡å‹ï¼šSource -&gt; Channel -&gt; Sink</li>
<li>äº‹åŠ¡æœºåˆ¶ï¼šæ”¯æŒé‡è¯»é‡å†™ï¼Œä¿è¯æ¶ˆæ¯ä¼ é€’çš„å¯é æ€§</li>
<li>å†…ç½®ä¸°å¯Œæ’ä»¶ï¼šè½»æ¾ä¸å„ç§å¤–éƒ¨ç³»ç»Ÿé›†æˆ</li>
<li>é«˜å¯ç”¨ï¼šAgent ä¸»å¤‡åˆ‡æ¢</li>
<li>Java å®ç°ï¼šå¼€æºï¼Œä¼˜ç§€çš„ç³»ç»Ÿè®¾è®¡</li>
</ul>
<h3 id="åº”ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#åº”ç”¨åœºæ™¯"></a> åº”ç”¨åœºæ™¯</h3>
<h2 id="flume-åŸç†"><a class="markdownIt-Anchor" href="#flume-åŸç†"></a> Flume åŸç†</h2>
<h3 id="flume-åŸºæœ¬æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#flume-åŸºæœ¬æ¦‚å¿µ"></a> Flume åŸºæœ¬æ¦‚å¿µ</h3>
<ul>
<li>Eventï¼šäº‹ä»¶ï¼Œæœ€å°æ•°æ®ä¼ è¾“å•å…ƒï¼Œç”± Header å’Œ Body ç»„æˆã€‚</li>
<li>Agentï¼šä»£ç†ï¼ŒJVM è¿›ç¨‹ï¼Œæœ€å°è¿è¡Œå•å…ƒï¼Œç”± Sourceã€Channelã€Sink ä¸‰ä¸ªåŸºæœ¬ç»„ä»¶æ„æˆï¼Œè´Ÿè´£å°†å¤–éƒ¨æ•°æ®æºäº§ç”Ÿçš„æ•°æ®ä»¥ Event çš„å½¢å¼ä¼ è¾“åˆ°ç›®çš„åœ°
<ul>
<li>Sourceï¼šè´Ÿè´£å¯¹æ¥å„ç§å¤–éƒ¨æ•°æ®æºï¼Œå°†é‡‡é›†åˆ°çš„æ•°æ®å°è£…æˆ Eventï¼Œç„¶åå†™å…¥ Channel</li>
<li>Channelï¼šEvent æš‚å­˜å®¹å™¨ï¼Œè´Ÿè´£ä¿å­˜ Source å‘é€çš„ Eventï¼Œç›´è‡³è¢« Sink æˆåŠŸè¯»å–</li>
<li>Sinkï¼šè´Ÿè´£ä» Channel è¯»å– Eventï¼Œç„¶åå°†å…¶å†™å…¥å¤–éƒ¨å­˜å‚¨ï¼Œæˆ–ä¼ è¾“ç»™ä¸‹ä¸€é˜¶æ®µçš„ Agent</li>
<li>æ˜ å°„å…³ç³»ï¼š1 ä¸ª Source -&gt; å¤šä¸ª Channelï¼Œ1 ä¸ª Channel -&gt; å¤šä¸ª Sinkï¼Œ1 ä¸ª Sink -&gt; 1 ä¸ª Channel</li>
</ul>
</li>
</ul>
<h3 id="flume-åŸºæœ¬ç»„ä»¶"><a class="markdownIt-Anchor" href="#flume-åŸºæœ¬ç»„ä»¶"></a> Flume åŸºæœ¬ç»„ä»¶</h3>
<h4 id="source-ç»„ä»¶"><a class="markdownIt-Anchor" href="#source-ç»„ä»¶"></a> Source ç»„ä»¶</h4>
<ul>
<li>å¯¹æ¥å„ç§å¤–éƒ¨æ•°æ®æºï¼Œå°†é‡‡é›†åˆ°çš„æ•°æ®å°è£…æˆ Eventï¼Œç„¶åå†™å…¥ Channel</li>
<li>ä¸€ä¸ª Source å¯å‘å¤šä¸ª Channel å‘é€ Event</li>
<li>Flume å†…ç½®ç±»å‹ä¸°å¯Œçš„ Sourceï¼ŒåŒæ—¶ç”¨æˆ·å¯è‡ªå®šä¹‰ Source</li>
</ul>
<h4 id="channel-ç»„ä»¶"><a class="markdownIt-Anchor" href="#channel-ç»„ä»¶"></a> Channel ç»„ä»¶</h4>
<ul>
<li>Event ä¸­è½¬æš‚å­˜åŒºï¼Œå­˜å‚¨ Source é‡‡é›†ä½†æœªè¢« Sink è¯»å–çš„ Event</li>
<li>ä¸ºäº†å¹³è¡¡ Source é‡‡é›†ã€Sink è¯»å–çš„é€Ÿåº¦ï¼Œå¯è§†ä¸º Flume å†…éƒ¨çš„æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>çº¿ç¨‹å®‰å…¨å¹¶å…·æœ‰äº‹åŠ¡æ€§ï¼Œæ”¯æŒ Source å†™å¤±è´¥é‡å†™å’Œ Sink è¯»å¤±è´¥é‡è¯»</li>
</ul>
<h4 id="sink-ç»„ä»¶"><a class="markdownIt-Anchor" href="#sink-ç»„ä»¶"></a> Sink ç»„ä»¶</h4>
<ul>
<li>ä» Channel è¯»å– Eventï¼Œå°†å…¶å†™å…¥å¤–éƒ¨å­˜å‚¨ï¼Œæˆ–ä¼ è¾“åˆ°ä¸‹ä¸€é˜¶æ®µçš„ Agent</li>
<li>ä¸€ä¸ª Sink åªèƒ½ä»ä¸€ä¸ª Channel ä¸­è¯»å– Event</li>
<li>Sink æˆåŠŸè¯»å– Event åï¼Œå‘ Channel æäº¤äº‹åŠ¡ï¼ŒEvent è¢«åˆ é™¤ï¼Œå¦åˆ™ Channel ä¼šç­‰å¾… Sink é‡æ–°è¯»å–</li>
</ul>
<h3 id="flume-æ•°æ®æµ"><a class="markdownIt-Anchor" href="#flume-æ•°æ®æµ"></a> Flume æ•°æ®æµ</h3>
<p>å•å±‚æ¶æ„</p>
<p>ä¼˜ç‚¹ï¼šæ¶æ„ç®€å•ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œå ç”¨èµ„æºè¾ƒå°‘<br />
ç¼ºç‚¹<br />
å¦‚æœé‡‡é›†çš„æ•°æ®æºæˆ–Agentè¾ƒå¤šï¼Œå°†Eventå†™å…¥åˆ°HDFSä¼šäº§ç”Ÿå¾ˆå¤šå°æ–‡ä»¶<br />
å¤–éƒ¨å­˜å‚¨å‡çº§ç»´æŠ¤æˆ–å‘ç”Ÿæ•…éšœï¼Œéœ€å¯¹é‡‡é›†å±‚çš„æ‰€æœ‰Agentåšå¤„ç†ï¼ŒäººåŠ›æˆæœ¬è¾ƒé«˜ï¼Œç³»ç»Ÿç¨³å®šæ€§è¾ƒå·®<br />
ç³»ç»Ÿå®‰å…¨æ€§è¾ƒå·®<br />
æ•°æ®æºç®¡ç†è¾ƒæ··ä¹±</p>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
]]></content>
      <categories>
        <category>bigdata</category>
      </categories>
      <tags>
        <tag>bigdata</tag>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤§æ•°æ®ç®€ä»‹</title>
    <url>/blog/bigdata/overview/</url>
    <content><![CDATA[<h1 id="å¤§æ•°æ®ç®€ä»‹"><a class="markdownIt-Anchor" href="#å¤§æ•°æ®ç®€ä»‹"></a> å¤§æ•°æ®ç®€ä»‹</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E7%AE%80%E4%BB%8B">ç®€ä»‹</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%A4%A7%E6%95%B0%E6%8D%AE">ä»€ä¹ˆæ˜¯å¤§æ•°æ®</a></li>
<li><a href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">åº”ç”¨åœºæ™¯</a></li>
<li><a href="#hadoop-%E7%BC%96%E5%B9%B4%E5%8F%B2">Hadoop ç¼–å¹´å²</a></li>
</ul>
</li>
<li><a href="#%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB">æŠ€æœ¯ä½“ç³»</a>
<ul>
<li><a href="#hdfs">HDFS</a></li>
<li><a href="#mapreduce">MapReduce</a></li>
<li><a href="#spark">Spark</a></li>
<li><a href="#yarn">YARN</a></li>
<li><a href="#hive">Hive</a></li>
<li><a href="#hbase">HBase</a></li>
<li><a href="#elasticsearch">ElasticSearch</a></li>
</ul>
</li>
<li><a href="#%E6%9C%AF%E8%AF%AD">æœ¯è¯­</a></li>
<li><a href="#%E8%B5%84%E6%BA%90">èµ„æº</a></li>
</ul>
<!-- /TOC -->
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯å¤§æ•°æ®"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯å¤§æ•°æ®"></a> ä»€ä¹ˆæ˜¯å¤§æ•°æ®</h3>
<p>å¤§æ•°æ®æ˜¯æŒ‡è¶…å‡ºä¼ ç»Ÿæ•°æ®åº“å·¥å…·æ”¶é›†ã€å­˜å‚¨ã€ç®¡ç†å’Œåˆ†æèƒ½åŠ›çš„æ•°æ®é›†ã€‚ä¸æ­¤åŒæ—¶ï¼ŒåŠæ—¶é‡‡é›†ã€å­˜å‚¨ã€èšåˆã€ç®¡ç†æ•°æ®ï¼Œä»¥åŠå¯¹æ•°æ®æ·±åº¦åˆ†æçš„æ–°æŠ€æœ¯å’Œæ–°èƒ½åŠ›ï¼Œæ­£åœ¨å¿«é€Ÿå¢é•¿ï¼Œå°±åƒé¢„æµ‹è®¡ç®—èŠ¯ç‰‡å¢é•¿é€Ÿåº¦çš„æ‘©å°”å®šå¾‹ä¸€æ ·ã€‚</p>
<ul>
<li><strong>Volume</strong> - æ•°æ®è§„æ¨¡å·¨å¤§</li>
<li><strong>Velocity</strong> - ç”Ÿæˆå’Œå¤„ç†é€Ÿåº¦æå¿«</li>
<li><strong>Variety</strong> - æ•°æ®è§„æ¨¡å·¨å¤§</li>
<li><strong>Value</strong> - ç”Ÿæˆå’Œå¤„ç†é€Ÿåº¦æå¿«</li>
</ul>
<h3 id="åº”ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#åº”ç”¨åœºæ™¯"></a> åº”ç”¨åœºæ™¯</h3>
<p>åŸºäºå¤§æ•°æ®çš„æ•°æ®ä»“åº“</p>
<p>åŸºäºå¤§æ•°æ®çš„å®æ—¶æµå¤„ç†</p>
<h3 id="hadoop-ç¼–å¹´å²"><a class="markdownIt-Anchor" href="#hadoop-ç¼–å¹´å²"></a> Hadoop ç¼–å¹´å²</h3>
<table>
<thead>
<tr>
<th style="text-align:left">æ—¶é—´</th>
<th style="text-align:left">äº‹ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2003.01</td>
<td style="text-align:left">Googleå‘è¡¨äº†Google File Systemè®ºæ–‡</td>
</tr>
<tr>
<td style="text-align:left">2004.01</td>
<td style="text-align:left">Googleå‘è¡¨äº†MapReduceè®ºæ–‡</td>
</tr>
<tr>
<td style="text-align:left">2006.02</td>
<td style="text-align:left">Apache Hadoopé¡¹ç›®æ­£å¼å¯åŠ¨ï¼Œå¹¶æ”¯æŒMapReduceå’ŒHDFSç‹¬ç«‹å‘å±•</td>
</tr>
<tr>
<td style="text-align:left">2006.11</td>
<td style="text-align:left">Googleå‘è¡¨äº†Bigtableè®ºæ–‡</td>
</tr>
<tr>
<td style="text-align:left">2008.01</td>
<td style="text-align:left">Hadoopæˆä¸ºApacheé¡¶çº§é¡¹ç›®</td>
</tr>
<tr>
<td style="text-align:left">2009.03</td>
<td style="text-align:left">Clouderaæ¨å‡ºä¸–ç•Œä¸Šé¦–ä¸ªHadoopå‘è¡Œç‰ˆâ€”â€”CDHï¼Œå¹¶å®Œå…¨å¼€æ”¾æºç </td>
</tr>
<tr>
<td style="text-align:left">2012.03</td>
<td style="text-align:left">HDFS NameNode HAåŠ å…¥Hadoopä¸»ç‰ˆæœ¬</td>
</tr>
<tr>
<td style="text-align:left">2014.02</td>
<td style="text-align:left">Sparkä»£æ›¿MapReduceæˆä¸ºHadoopçš„ç¼ºçœè®¡ç®—å¼•æ“ï¼Œå¹¶æˆä¸ºApacheé¡¶çº§é¡¹ç›®</td>
</tr>
</tbody>
</table>
<h2 id="æŠ€æœ¯ä½“ç³»"><a class="markdownIt-Anchor" href="#æŠ€æœ¯ä½“ç³»"></a> æŠ€æœ¯ä½“ç³»</h2>
<h3 id="hdfs"><a class="markdownIt-Anchor" href="#hdfs"></a> HDFS</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆHadoop Distributed File Systemï¼‰</li>
<li>åœ¨å¼€æºå¤§æ•°æ®æŠ€æœ¯ä½“ç³»ä¸­ï¼Œåœ°ä½æ— å¯æ›¿ä»£</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>é«˜å®¹é”™ï¼šæ•°æ®å¤šå‰¯æœ¬ï¼Œå‰¯æœ¬ä¸¢å¤±åè‡ªåŠ¨æ¢å¤</li>
<li>é«˜å¯ç”¨ï¼šNameNode HAï¼Œå®‰å…¨æ¨¡å¼</li>
<li>é«˜æ‰©å±•ï¼š10K èŠ‚ç‚¹è§„æ¨¡</li>
<li>ç®€å•ä¸€è‡´æ€§æ¨¡å‹ï¼šä¸€æ¬¡å†™å…¥å¤šæ¬¡è¯»å–ï¼Œæ”¯æŒè¿½åŠ ï¼Œä¸å…è®¸ä¿®æ”¹</li>
<li>æµå¼æ•°æ®è®¿é—®ï¼šæ‰¹é‡è¯»è€Œééšæœºè¯»ï¼Œå…³æ³¨ååé‡è€Œéæ—¶é—´</li>
<li>å¤§è§„æ¨¡æ•°æ®é›†ï¼šå…¸å‹æ–‡ä»¶å¤§å° GB~TB çº§ï¼Œç™¾ä¸‡ä»¥ä¸Šæ–‡ä»¶æ•°é‡ï¼Œ PB ä»¥ä¸Šæ•°æ®è§„æ¨¡</li>
<li>æ„å»ºæˆæœ¬ä½ä¸”å®‰å…¨å¯é ï¼šè¿è¡Œåœ¨å¤§é‡çš„å»‰ä»·å•†ç”¨æœºå™¨ä¸Šï¼Œç¡¬ä»¶é”™è¯¯æ˜¯å¸¸æ€ï¼Œæä¾›å®¹é”™æœºåˆ¶</li>
</ul>
<h3 id="mapreduce"><a class="markdownIt-Anchor" href="#mapreduce"></a> MapReduce</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>é¢å‘æ‰¹å¤„ç†çš„åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶</li>
<li>ç¼–ç¨‹æ¨¡å‹ï¼šå°† MapReduce ç¨‹åºåˆ†ä¸º Mapã€Reduce ä¸¤ä¸ªé˜¶æ®µ</li>
</ul>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong></p>
<ul>
<li>åˆ†è€Œæ²»ä¹‹ï¼Œåˆ†å¸ƒå¼è®¡ç®—</li>
<li>ç§»åŠ¨è®¡ç®—ï¼Œè€Œéç§»åŠ¨æ•°æ®</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>é«˜å®¹é”™ï¼šä»»åŠ¡å¤±è´¥ï¼Œè‡ªåŠ¨è°ƒåº¦åˆ°å…¶ä»–èŠ‚ç‚¹é‡æ–°æ‰§è¡Œ</li>
<li>é«˜æ‰©å±•ï¼šè®¡ç®—èƒ½åŠ›éšç€èŠ‚ç‚¹æ•°å¢åŠ ï¼Œè¿‘ä¼¼çº¿æ€§é€’å¢</li>
<li>é€‚ç”¨äºæµ·é‡æ•°æ®çš„ç¦»çº¿æ‰¹å¤„ç†</li>
<li>é™ä½äº†åˆ†å¸ƒå¼ç¼–ç¨‹çš„é—¨æ§›</li>
</ul>
<h3 id="spark"><a class="markdownIt-Anchor" href="#spark"></a> Spark</h3>
<p>é«˜æ€§èƒ½åˆ†å¸ƒå¼é€šç”¨è®¡ç®—å¼•æ“</p>
<ul>
<li>Spark Core - åŸºç¡€è®¡ç®—æ¡†æ¶ï¼ˆæ‰¹å¤„ç†ã€äº¤äº’å¼åˆ†æï¼‰</li>
<li>Spark SQL - SQL å¼•æ“ï¼ˆæµ·é‡ç»“æ„åŒ–æ•°æ®çš„é«˜æ€§èƒ½æŸ¥è¯¢ï¼‰</li>
<li>Spark Streaming - å®æ—¶æµå¤„ç†ï¼ˆå¾®æ‰¹ï¼‰</li>
<li>Spark MLlib - æœºå™¨å­¦ä¹ </li>
<li>Spark GraphX - å›¾è®¡ç®—</li>
</ul>
<p>é‡‡ç”¨ Scala è¯­è¨€å¼€å‘</p>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>è®¡ç®—é«˜æ•ˆ - å†…å­˜è®¡ç®—ã€Cache ç¼“å­˜æœºåˆ¶ã€DAG å¼•æ“ã€å¤šçº¿ç¨‹æ± æ¨¡å‹</li>
<li>é€šç”¨æ˜“ç”¨ - é€‚ç”¨äºæ‰¹å¤„ç†ã€äº¤äº’å¼è®¡ç®—ã€æµå¤„ç†ã€æœºå™¨å­¦ä¹ ã€å›¾è®¡ç®—ç­‰å¤šç§åœºæ™¯</li>
<li>è¿è¡Œæ¨¡å¼å¤šæ · - Localã€Standaloneã€YARN/Mesos</li>
</ul>
<h3 id="yarn"><a class="markdownIt-Anchor" href="#yarn"></a> YARN</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>Yet Another Resource Negotiatorï¼Œå¦ä¸€ç§èµ„æºç®¡ç†å™¨</li>
<li>ä¸ºäº†è§£å†³ Hadoop 1.x ä¸­ MapReduce çš„å…ˆå¤©ç¼ºé™·</li>
<li>åˆ†å¸ƒå¼é€šç”¨èµ„æºç®¡ç†ç³»ç»Ÿ</li>
<li>è´Ÿè´£é›†ç¾¤èµ„æºçš„ç»Ÿä¸€ç®¡ç†</li>
<li>ä» Hadoop 2.x å¼€å§‹ï¼ŒYARN æˆä¸º Hadoop çš„æ ¸å¿ƒç»„ä»¶</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>ä¸“æ³¨äºèµ„æºç®¡ç†å’Œä½œä¸šè°ƒåº¦</li>
<li>é€šç”¨ - é€‚ç”¨å„ç§è®¡ç®—æ¡†æ¶ï¼Œå¦‚ - MapReduceã€Spark</li>
<li>é«˜å¯ç”¨ - ResourceManager é«˜å¯ç”¨ã€HDFS é«˜å¯ç”¨</li>
<li>é«˜æ‰©å±•</li>
</ul>
<h3 id="hive"><a class="markdownIt-Anchor" href="#hive"></a> Hive</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>Hadoop æ•°æ®ä»“åº“ - ä¼ä¸šå†³ç­–æ”¯æŒ</li>
<li>SQL å¼•æ“ - å¯¹æµ·é‡ç»“æ„åŒ–æ•°æ®è¿›è¡Œé«˜æ€§èƒ½çš„ SQL æŸ¥è¯¢</li>
<li>é‡‡ç”¨ HDFS æˆ– HBase ä¸ºæ•°æ®å­˜å‚¨</li>
<li>é‡‡ç”¨ MapReduce æˆ– Spark ä¸ºè®¡ç®—æ¡†æ¶</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>æä¾›ç±» SQL æŸ¥è¯¢è¯­è¨€</li>
<li>æ”¯æŒå‘½ä»¤è¡Œæˆ– JDBC/ODBC</li>
<li>æä¾›çµæ´»çš„æ‰©å±•æ€§</li>
<li>æä¾›å¤æ‚æ•°æ®ç±»å‹ã€æ‰©å±•å‡½æ•°ã€è„šæœ¬ç­‰</li>
</ul>
<h3 id="hbase"><a class="markdownIt-Anchor" href="#hbase"></a> HBase</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>Hadoop Database</li>
<li>Google BigTable çš„å¼€æºå®ç°</li>
<li>åˆ†å¸ƒå¼ NoSQL æ•°æ®åº“</li>
<li>åˆ—å¼å­˜å‚¨ - ä¸»è¦ç”¨äºåŠç»“æ„åŒ–ã€éç»“æ„åŒ–æ•°æ®</li>
<li>é‡‡ç”¨ HDFS ä¸ºæ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>é«˜æ€§èƒ½ - æ”¯æŒé«˜å¹¶å‘å†™å…¥å’ŒæŸ¥è¯¢</li>
<li>é«˜å¯ç”¨ - HDFS é«˜å¯ç”¨ã€Region é«˜å¯ç”¨</li>
<li>é«˜æ‰©å±• - æ•°æ®è‡ªåŠ¨åˆ‡åˆ†å’Œåˆ†å¸ƒï¼Œå¯åŠ¨æ€æ‰©å®¹ï¼Œæ— éœ€åœæœº</li>
<li>æµ·é‡å­˜å‚¨ - å•è¡¨å¯å®¹çº³æ•°åäº¿è¡Œï¼Œä¸Šç™¾ä¸‡åˆ—</li>
</ul>
<h3 id="elasticsearch"><a class="markdownIt-Anchor" href="#elasticsearch"></a> ElasticSearch</h3>
<ul>
<li>å¼€æºçš„åˆ†å¸ƒå¼å…¨æ–‡æ£€ç´¢å¼•æ“</li>
<li>åŸºäº Lucene å®ç°å…¨æ–‡æ•°æ®çš„å¿«é€Ÿå­˜å‚¨ã€æœç´¢å’Œåˆ†æ</li>
<li>å¤„ç†å¤§è§„æ¨¡æ•°æ® - PB çº§ä»¥ä¸Š</li>
<li>å…·æœ‰è¾ƒå¼ºçš„æ‰©å±•æ€§ï¼Œé›†ç¾¤è§„æ¨¡å¯è¾¾ä¸Šç™¾å°</li>
<li>é¦–é€‰çš„åˆ†å¸ƒå¼æœç´¢å¼•æ“</li>
</ul>
<h2 id="æœ¯è¯­"><a class="markdownIt-Anchor" href="#æœ¯è¯­"></a> æœ¯è¯­</h2>
<p><strong>æ•°æ®ä»“åº“ï¼ˆData Warehouseï¼‰</strong> - æ•°æ®ä»“åº“ï¼Œæ˜¯ä¸ºä¼ä¸šæ‰€æœ‰çº§åˆ«çš„å†³ç­–åˆ¶å®šè¿‡ç¨‹ï¼Œæä¾›æ‰€æœ‰ç±»å‹æ•°æ®æ”¯æŒçš„æˆ˜ç•¥é›†åˆã€‚å®ƒæ˜¯å•ä¸ªæ•°æ®å­˜å‚¨ï¼Œå‡ºäºåˆ†ææ€§æŠ¥å‘Šå’Œå†³ç­–æ”¯æŒç›®çš„è€Œåˆ›å»ºã€‚ ä¸ºéœ€è¦ä¸šåŠ¡æ™ºèƒ½çš„ä¼ä¸šï¼Œæä¾›æŒ‡å¯¼ä¸šåŠ¡æµç¨‹æ”¹è¿›ã€ç›‘è§†æ—¶é—´ã€æˆæœ¬ã€è´¨é‡ä»¥åŠæ§åˆ¶ã€‚</p>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
<ul>
<li><a href="https://github.com/onurakpolat/awesome-bigdata" target="_blank" rel="noopener">awesome-bigdata</a></li>
<li><a href="http://hadoop.apache.org/" target="_blank" rel="noopener">Hadoop</a></li>
<li><a href="http://hbase.apache.org/" target="_blank" rel="noopener">HBase</a></li>
<li><a href="http://hive.apache.org/" target="_blank" rel="noopener">Hive</a></li>
<li><a href="http://impala.apache.org/" target="_blank" rel="noopener">Impala</a></li>
<li><a href="http://flume.apache.org/" target="_blank" rel="noopener">Flume</a></li>
<li><a href="http://kafka.apache.org/" target="_blank" rel="noopener">Kafka</a></li>
<li><a href="http://spark.apache.org/" target="_blank" rel="noopener">Spark</a></li>
<li><a href="http://sqoop.apache.org/" target="_blank" rel="noopener">Sqoop</a></li>
<li><a href="https://www.elastic.co/guide/index.html" target="_blank" rel="noopener">ElasticSearch</a></li>
</ul>
]]></content>
      <categories>
        <category>bigdata</category>
      </categories>
      <tags>
        <tag>bigdata</tag>
      </tags>
  </entry>
  <entry>
    <title>YARN</title>
    <url>/blog/bigdata/YARN/</url>
    <content><![CDATA[<h1 id="yarn"><a class="markdownIt-Anchor" href="#yarn"></a> YARN</h1>
<blockquote>
<p>YARN çš„ç›®æ ‡æ˜¯è§£å†³ MapReduce çš„ç¼ºé™·ã€‚</p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#mapreduce-%E7%9A%84%E7%BC%BA%E9%99%B7hadoop-1x">MapReduce çš„ç¼ºé™·ï¼ˆHadoop 1.xï¼‰</a></li>
<li><a href="#yarn-%E7%AE%80%E4%BB%8B">YARN ç®€ä»‹</a></li>
<li><a href="#yarn-%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84">YARN ç³»ç»Ÿæ¶æ„</a>
<ul>
<li><a href="#resourcemanagerrm">ResourceManagerï¼ˆRMï¼‰</a></li>
<li><a href="#nodemanagernm">NodeManagerï¼ˆNMï¼‰</a></li>
<li><a href="#applicationmasteram">ApplicationMasterï¼ˆAMï¼‰</a></li>
<li><a href="#container">Container</a></li>
</ul>
</li>
<li><a href="#yarn-%E9%AB%98%E5%8F%AF%E7%94%A8">YARN é«˜å¯ç”¨</a></li>
<li><a href="#yarn-%E8%B5%84%E6%BA%90%E8%B0%83%E5%BA%A6%E7%AD%96%E7%95%A5">YARN èµ„æºè°ƒåº¦ç­–ç•¥</a>
<ul>
<li><a href="#fifo-scheduler%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%E8%B0%83%E5%BA%A6%E5%99%A8">FIFO Schedulerï¼ˆå…ˆè¿›å…ˆå‡ºè°ƒåº¦å™¨ï¼‰</a></li>
<li><a href="#capacity-scheduler%E5%AE%B9%E9%87%8F%E8%B0%83%E5%BA%A6%E5%99%A8">Capacity Schedulerï¼ˆå®¹é‡è°ƒåº¦å™¨ï¼‰</a></li>
<li><a href="#fair-scheduler%E5%85%AC%E5%B9%B3%E8%B0%83%E5%BA%A6%E5%99%A8">Fair Schedulerï¼ˆå…¬å¹³è°ƒåº¦å™¨ï¼‰</a></li>
</ul>
</li>
<li><a href="#%E8%B5%84%E6%BA%90">èµ„æº</a></li>
</ul>
<!-- /TOC -->
<h2 id="mapreduce-çš„ç¼ºé™·hadoop-1x"><a class="markdownIt-Anchor" href="#mapreduce-çš„ç¼ºé™·hadoop-1x"></a> MapReduce çš„ç¼ºé™·ï¼ˆHadoop 1.xï¼‰</h2>
<ul>
<li>èº«å…¼ä¸¤èŒï¼šè®¡ç®—æ¡†æ¶ + èµ„æºç®¡ç†æ¡†æ¶</li>
<li>JobTracker
<ul>
<li>æ—¢åšèµ„æºç®¡ç†ï¼Œåˆåšä»»åŠ¡è°ƒåº¦</li>
<li>ä»»åŠ¡å¤ªé‡ï¼Œå¼€é”€è¿‡å¤§</li>
<li>å­˜åœ¨å•ç‚¹æ•…éšœ</li>
</ul>
</li>
<li>èµ„æºæè¿°æ¨¡å‹è¿‡äºç®€å•ï¼Œèµ„æºåˆ©ç”¨ç‡è¾ƒä½
<ul>
<li>ä»…æŠŠ Task æ•°é‡çœ‹ä½œèµ„æºï¼Œæ²¡æœ‰è€ƒè™‘ CPU å’Œå†…å­˜</li>
<li>å¼ºåˆ¶æŠŠèµ„æºåˆ†æˆ Map Task Slot å’Œ Reduce Task Slot</li>
</ul>
</li>
<li>æ‰©å±•æ€§è¾ƒå·®ï¼Œé›†ç¾¤è§„æ¨¡ä¸Šé™ 4K</li>
<li>æºç éš¾äºç†è§£ï¼Œå‡çº§ç»´æŠ¤å›°éš¾</li>
</ul>
<h2 id="yarn-ç®€ä»‹"><a class="markdownIt-Anchor" href="#yarn-ç®€ä»‹"></a> YARN ç®€ä»‹</h2>
<p>YARN(Yet Another Resource Negotiatorï¼Œå¦ä¸€ç§èµ„æºç®¡ç†å™¨)æ˜¯ä¸€ä¸ª<strong>åˆ†å¸ƒå¼é€šç”¨èµ„æºç®¡ç†ç³»ç»Ÿ</strong>ã€‚</p>
<p>è®¾è®¡ç›®æ ‡ï¼šèšç„¦èµ„æºç®¡ç†ã€é€šç”¨ï¼ˆé€‚ç”¨å„ç§è®¡ç®—æ¡†æ¶ï¼‰ã€é«˜å¯ç”¨ã€é«˜æ‰©å±•ã€‚</p>
<h2 id="yarn-ç³»ç»Ÿæ¶æ„"><a class="markdownIt-Anchor" href="#yarn-ç³»ç»Ÿæ¶æ„"></a> YARN ç³»ç»Ÿæ¶æ„</h2>
<ul>
<li>ä¸»ä»ç»“æ„ï¼ˆmaster/slaveï¼‰</li>
<li>å°† JobTracker çš„èµ„æºç®¡ç†ã€ä»»åŠ¡è°ƒåº¦åŠŸèƒ½åˆ†ç¦»</li>
<li>ä¸‰ç§è§’è‰²ï¼š
<ul>
<li>ResourceManagerï¼ˆMasterï¼‰ - é›†ç¾¤èµ„æºçš„ç»Ÿä¸€ç®¡ç†å’Œåˆ†é…</li>
<li>NodeManagerï¼ˆSlaveï¼‰ - ç®¡ç†èŠ‚ç‚¹èµ„æºï¼Œä»¥åŠå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸ</li>
<li>ApplicationMasterï¼ˆæ–°è§’è‰²ï¼‰ - ç®¡ç†åº”ç”¨ç¨‹åºå®ä¾‹ï¼ŒåŒ…æ‹¬ä»»åŠ¡è°ƒåº¦å’Œèµ„æºç”³è¯·</li>
</ul>
</li>
</ul>
<h3 id="resourcemanagerrm"><a class="markdownIt-Anchor" href="#resourcemanagerrm"></a> ResourceManagerï¼ˆRMï¼‰</h3>
<p><strong>ä¸»è¦åŠŸèƒ½</strong></p>
<ul>
<li>ç»Ÿä¸€ç®¡ç†é›†ç¾¤çš„æ‰€æœ‰èµ„æº</li>
<li>å°†èµ„æºæŒ‰ç…§ä¸€å®šç­–ç•¥åˆ†é…ç»™å„ä¸ªåº”ç”¨ï¼ˆApplicationMasterï¼‰</li>
<li>æ¥æ”¶ NodeManager çš„èµ„æºä¸ŠæŠ¥ä¿¡æ¯</li>
</ul>
<p><strong>æ ¸å¿ƒç»„ä»¶</strong></p>
<ul>
<li>ç”¨æˆ·äº¤äº’æœåŠ¡ï¼ˆUser Serviceï¼‰</li>
<li>NodeManager ç®¡ç†</li>
<li>ApplicationMaster ç®¡ç†</li>
<li>Application ç®¡ç†</li>
<li>å®‰å…¨ç®¡ç†</li>
<li>èµ„æºç®¡ç†</li>
</ul>
<h3 id="nodemanagernm"><a class="markdownIt-Anchor" href="#nodemanagernm"></a> NodeManagerï¼ˆNMï¼‰</h3>
<p><strong>ä¸»è¦åŠŸèƒ½</strong></p>
<ul>
<li>ç®¡ç†å•ä¸ªèŠ‚ç‚¹çš„èµ„æº</li>
<li>å‘ ResourceManager æ±‡æŠ¥èŠ‚ç‚¹èµ„æºä½¿ç”¨æƒ…å†µ</li>
<li>ç®¡ç† Container çš„ç”Ÿå‘½å‘¨æœŸ</li>
</ul>
<p><strong>æ ¸å¿ƒç»„ä»¶</strong></p>
<ul>
<li>NodeStatusUpdater</li>
<li>ContainerManager</li>
<li>ContainerExecutor</li>
<li>NodeHealthCheckerService</li>
<li>Security</li>
<li>WebServer</li>
</ul>
<h3 id="applicationmasteram"><a class="markdownIt-Anchor" href="#applicationmasteram"></a> ApplicationMasterï¼ˆAMï¼‰</h3>
<p><strong>ä¸»è¦åŠŸèƒ½</strong></p>
<ul>
<li>ç®¡ç†åº”ç”¨ç¨‹åºå®ä¾‹</li>
<li>å‘ ResourceManager ç”³è¯·ä»»åŠ¡æ‰§è¡Œæ‰€éœ€çš„èµ„æº</li>
<li>ä»»åŠ¡è°ƒåº¦å’Œç›‘ç®¡</li>
</ul>
<p><strong>å®ç°æ–¹å¼</strong></p>
<ul>
<li>éœ€è¦ä¸ºæ¯ä¸ªåº”ç”¨å¼€å‘ä¸€ä¸ª AM ç»„ä»¶</li>
<li>YARN æä¾› MapReduce çš„ ApplicationMaster å®ç°</li>
<li>é‡‡ç”¨åŸºäºäº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œç”±ä¸­å¤®äº‹ä»¶è°ƒåº¦å™¨ç»Ÿä¸€ç®¡ç†æ‰€æœ‰äº‹ä»¶</li>
<li>æ¯ç§ç»„ä»¶éƒ½æ˜¯ä¸€ç§äº‹ä»¶å¤„ç†å™¨ï¼Œåœ¨ä¸­å¤®äº‹ä»¶è°ƒåº¦å™¨ä¸­æ³¨å†Œ</li>
</ul>
<h3 id="container"><a class="markdownIt-Anchor" href="#container"></a> Container</h3>
<ul>
<li>æ¦‚å¿µï¼šContainer å°è£…äº†èŠ‚ç‚¹ä¸Šè¿›ç¨‹çš„ç›¸å…³èµ„æºï¼Œæ˜¯ YARN ä¸­èµ„æºçš„æŠ½è±¡</li>
<li>åˆ†ç±»ï¼šè¿è¡Œ ApplicationMaster çš„ Container ã€è¿è¡Œåº”ç”¨ä»»åŠ¡çš„ Container</li>
</ul>
<h2 id="yarn-é«˜å¯ç”¨"><a class="markdownIt-Anchor" href="#yarn-é«˜å¯ç”¨"></a> YARN é«˜å¯ç”¨</h2>
<p>ResourceManager é«˜å¯ç”¨</p>
<ul>
<li>1 ä¸ª Active RMã€å¤šä¸ª Standby RM</li>
<li>å®•æœºåè‡ªåŠ¨å®ç°ä¸»å¤‡åˆ‡æ¢</li>
<li>ZooKeeper çš„æ ¸å¿ƒä½œç”¨
<ul>
<li>Active èŠ‚ç‚¹é€‰ä¸¾</li>
<li>æ¢å¤ Active RM çš„åŸæœ‰çŠ¶æ€ä¿¡æ¯</li>
</ul>
</li>
<li>é‡å¯ AMï¼Œæ€æ­»æ‰€æœ‰è¿è¡Œä¸­çš„ Container</li>
<li>åˆ‡æ¢æ–¹å¼ï¼šæ‰‹åŠ¨ã€è‡ªåŠ¨</li>
</ul>
<h2 id="yarn-èµ„æºè°ƒåº¦ç­–ç•¥"><a class="markdownIt-Anchor" href="#yarn-èµ„æºè°ƒåº¦ç­–ç•¥"></a> YARN èµ„æºè°ƒåº¦ç­–ç•¥</h2>
<h3 id="fifo-schedulerå…ˆè¿›å…ˆå‡ºè°ƒåº¦å™¨"><a class="markdownIt-Anchor" href="#fifo-schedulerå…ˆè¿›å…ˆå‡ºè°ƒåº¦å™¨"></a> FIFO Schedulerï¼ˆå…ˆè¿›å…ˆå‡ºè°ƒåº¦å™¨ï¼‰</h3>
<p><strong>è°ƒåº¦ç­–ç•¥</strong></p>
<p>å°†æ‰€æœ‰ä»»åŠ¡æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…ˆè¿›é˜Ÿåˆ—çš„å…ˆè·å¾—èµ„æºï¼Œæ’åœ¨åé¢çš„ä»»åŠ¡åªæœ‰ç­‰å¾…</p>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>èµ„æºåˆ©ç”¨ç‡ä½ï¼Œæ— æ³•äº¤å‰è¿è¡Œä»»åŠ¡</li>
<li>çµæ´»æ€§å·®ï¼Œå¦‚ï¼šç´§æ€¥ä»»åŠ¡æ— æ³•æ’é˜Ÿï¼Œè€—æ—¶é•¿çš„ä»»åŠ¡æ‹–æ…¢è€—æ—¶çŸ­çš„ä»»åŠ¡</li>
</ul>
<h3 id="capacity-schedulerå®¹é‡è°ƒåº¦å™¨"><a class="markdownIt-Anchor" href="#capacity-schedulerå®¹é‡è°ƒåº¦å™¨"></a> Capacity Schedulerï¼ˆå®¹é‡è°ƒåº¦å™¨ï¼‰</h3>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong> - æå‰<strong>åšé¢„ç®—</strong>ï¼Œåœ¨é¢„ç®—æŒ‡å¯¼ä¸‹åˆ†äº«é›†ç¾¤èµ„æºã€‚</p>
<p><strong>è°ƒåº¦ç­–ç•¥</strong></p>
<ul>
<li>é›†ç¾¤èµ„æºç”±å¤šä¸ªé˜Ÿåˆ—åˆ†äº«</li>
<li>æ¯ä¸ªé˜Ÿåˆ—éƒ½è¦é¢„è®¾èµ„æºåˆ†é…çš„æ¯”ä¾‹ï¼ˆæå‰åšé¢„ç®—ï¼‰</li>
<li>ç©ºé—²èµ„æºä¼˜å…ˆåˆ†é…ç»™â€œå®é™…èµ„æº/é¢„ç®—èµ„æºâ€æ¯”å€¼æœ€ä½çš„é˜Ÿåˆ—</li>
<li>é˜Ÿåˆ—å†…éƒ¨é‡‡ç”¨ FIFO è°ƒåº¦ç­–ç•¥</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>å±‚æ¬¡åŒ–çš„é˜Ÿåˆ—è®¾è®¡ï¼šå­é˜Ÿåˆ—å¯ä½¿ç”¨çˆ¶é˜Ÿåˆ—èµ„æº</li>
<li>å®¹é‡ä¿è¯ï¼šæ¯ä¸ªé˜Ÿåˆ—éƒ½è¦é¢„è®¾èµ„æºå æ¯”ï¼Œé˜²æ­¢èµ„æºç‹¬å </li>
<li>å¼¹æ€§åˆ†é…ï¼šç©ºé—²èµ„æºå¯ä»¥åˆ†é…ç»™ä»»ä½•é˜Ÿåˆ—ï¼Œå½“å¤šä¸ªé˜Ÿåˆ—äº‰ç”¨æ—¶ï¼Œä¼šæŒ‰æ¯”ä¾‹è¿›è¡Œå¹³è¡¡</li>
<li>æ”¯æŒåŠ¨æ€ç®¡ç†ï¼šå¯ä»¥åŠ¨æ€è°ƒæ•´é˜Ÿåˆ—çš„å®¹é‡ã€æƒé™ç­‰å‚æ•°ï¼Œä¹Ÿå¯åŠ¨æ€å¢åŠ ã€æš‚åœé˜Ÿåˆ—</li>
<li>è®¿é—®æ§åˆ¶ï¼šç”¨æˆ·åªèƒ½å‘è‡ªå·±çš„é˜Ÿåˆ—ä¸­æäº¤ä»»åŠ¡ï¼Œä¸èƒ½è®¿é—®å…¶ä»–é˜Ÿåˆ—</li>
<li>å¤šç§Ÿæˆ·ï¼šå¤šç”¨æˆ·å…±äº«é›†ç¾¤èµ„æº</li>
</ul>
<h3 id="fair-schedulerå…¬å¹³è°ƒåº¦å™¨"><a class="markdownIt-Anchor" href="#fair-schedulerå…¬å¹³è°ƒåº¦å™¨"></a> Fair Schedulerï¼ˆå…¬å¹³è°ƒåº¦å™¨ï¼‰</h3>
<p><strong>è°ƒåº¦ç­–ç•¥</strong></p>
<ul>
<li>å¤šé˜Ÿåˆ—å…¬å¹³å…±äº«é›†ç¾¤èµ„æº</li>
<li>é€šè¿‡å¹³åˆ†çš„æ–¹å¼ï¼ŒåŠ¨æ€åˆ†é…èµ„æºï¼Œæ— éœ€é¢„å…ˆè®¾å®šèµ„æºåˆ†é…æ¯”ä¾‹</li>
<li>é˜Ÿåˆ—å†…éƒ¨å¯é…ç½®è°ƒåº¦ç­–ç•¥ï¼šFIFOã€Fairï¼ˆé»˜è®¤ï¼‰</li>
</ul>
<p><strong>èµ„æºæŠ¢å </strong></p>
<ul>
<li>ç»ˆæ­¢å…¶ä»–é˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œä½¿å…¶è®©å‡ºæ‰€å èµ„æºï¼Œç„¶åå°†èµ„æºåˆ†é…ç»™å ç”¨èµ„æºé‡å°‘äºæœ€å°èµ„æºé‡é™åˆ¶çš„é˜Ÿåˆ—</li>
</ul>
<p><strong>é˜Ÿåˆ—æƒé‡</strong></p>
<ul>
<li>å½“é˜Ÿåˆ—ä¸­æœ‰ä»»åŠ¡ç­‰å¾…ï¼Œå¹¶ä¸”é›†ç¾¤ä¸­æœ‰ç©ºé—²èµ„æºæ—¶ï¼Œæ¯ä¸ªé˜Ÿåˆ—å¯ä»¥æ ¹æ®æƒé‡è·å¾—ä¸åŒæ¯”ä¾‹çš„ç©ºé—²èµ„æº</li>
</ul>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
]]></content>
      <categories>
        <category>bigdata</category>
      </categories>
      <tags>
        <tag>bigdata</tag>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>HDFS</title>
    <url>/blog/bigdata/HDFS/</url>
    <content><![CDATA[<h1 id="hdfs"><a class="markdownIt-Anchor" href="#hdfs"></a> HDFS</h1>
<blockquote>
<p><strong>HDFS æ˜¯ Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚</strong></p>
<p>å…³é”®è¯ï¼šåˆ†å¸ƒå¼ã€æ–‡ä»¶ç³»ç»Ÿ</p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E6%A6%82%E8%BF%B0">æ¦‚è¿°</a>
<ul>
<li><a href="#hdfs-%E7%9A%84%E7%89%B9%E7%82%B9">HDFS çš„ç‰¹ç‚¹</a></li>
</ul>
</li>
<li><a href="#hdfs-%E7%9A%84%E6%A6%82%E5%BF%B5">HDFS çš„æ¦‚å¿µ</a>
<ul>
<li><a href="#namenode">NameNode</a></li>
<li><a href="#datanode">DataNode</a></li>
<li><a href="#block-%E6%95%B0%E6%8D%AE%E5%9D%97">Block æ•°æ®å—</a></li>
<li><a href="#client">Client</a></li>
</ul>
</li>
<li><a href="#block-%E5%89%AF%E6%9C%AC%E7%AD%96%E7%95%A5">Block å‰¯æœ¬ç­–ç•¥</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E6%B5%81">æ•°æ®æµ</a>
<ul>
<li><a href="#hdfs-%E8%AF%BB%E6%96%87%E4%BB%B6">HDFS è¯»æ–‡ä»¶</a></li>
<li><a href="#hdfs-%E5%86%99%E6%96%87%E4%BB%B6">HDFS å†™æ–‡ä»¶</a></li>
</ul>
</li>
<li><a href="#hdfs-%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F">HDFS å®‰å…¨æ¨¡å¼</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F">ä»€ä¹ˆæ˜¯å®‰å…¨æ¨¡å¼ï¼Ÿ</a></li>
<li><a href="#%E4%BD%95%E6%97%B6%E6%AD%A3%E5%B8%B8%E7%A6%BB%E5%BC%80%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F">ä½•æ—¶æ­£å¸¸ç¦»å¼€å®‰å…¨æ¨¡å¼</a></li>
<li><a href="#%E8%A7%A6%E5%8F%91%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8E%9F%E5%9B%A0">è§¦å‘å®‰å…¨æ¨¡å¼çš„åŸå› </a></li>
<li><a href="#%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5">æ•…éšœæ’æŸ¥</a></li>
</ul>
</li>
<li><a href="#hdfs-%E9%AB%98%E5%8F%AF%E7%94%A8">HDFS é«˜å¯ç”¨</a>
<ul>
<li><a href="#namenode-%E7%9A%84-ha-%E6%9C%BA%E5%88%B6">NameNode çš„ HA æœºåˆ¶</a></li>
<li><a href="#%E5%88%A9%E7%94%A8-qjm-%E5%AE%9E%E7%8E%B0%E5%85%83%E6%95%B0%E6%8D%AE%E9%AB%98%E5%8F%AF%E7%94%A8">åˆ©ç”¨ QJM å®ç°å…ƒæ•°æ®é«˜å¯ç”¨</a></li>
</ul>
</li>
<li><a href="#%E8%B5%84%E6%BA%90">èµ„æº</a></li>
</ul>
<!-- /TOC -->
<h2 id="æ¦‚è¿°"><a class="markdownIt-Anchor" href="#æ¦‚è¿°"></a> æ¦‚è¿°</h2>
<blockquote>
<p>HDFS æ˜¯ Hadoop çš„æ ¸å¿ƒå­é¡¹ç›®ã€‚</p>
<p><strong>HDFS</strong> æ˜¯ <strong>Hadoop Distributed File System</strong> çš„ç¼©å†™ï¼Œå³ Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p>HDFS æ˜¯ä¸€ç§ç”¨äºå­˜å‚¨å…·æœ‰æµæ•°æ®è®¿é—®æ¨¡å¼çš„è¶…å¤§æ–‡ä»¶çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒè¿è¡Œåœ¨å»‰ä»·çš„æœºå™¨é›†ç¾¤ä¸Šã€‚</p>
</blockquote>
<h3 id="hdfs-çš„ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#hdfs-çš„ç‰¹ç‚¹"></a> HDFS çš„ç‰¹ç‚¹</h3>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li><strong>é«˜å®¹é”™</strong> - æ•°æ®å†—ä½™å¤šå‰¯æœ¬ï¼Œå‰¯æœ¬ä¸¢å¤±åè‡ªåŠ¨æ¢å¤</li>
<li><strong>é«˜å¯ç”¨</strong> - NameNode HAã€å®‰å…¨æ¨¡å¼</li>
<li><strong>é«˜æ‰©å±•</strong> - èƒ½å¤Ÿå¤„ç† 10K èŠ‚ç‚¹çš„è§„æ¨¡ï¼›å¤„ç†æ•°æ®è¾¾åˆ° GBã€TBã€ç”šè‡³ PB çº§åˆ«çš„æ•°æ®ï¼›èƒ½å¤Ÿå¤„ç†ç™¾ä¸‡è§„æ¨¡ä»¥ä¸Šçš„æ–‡ä»¶æ•°é‡ï¼Œæ•°é‡ç›¸å½“ä¹‹å¤§ã€‚</li>
<li><strong>æ‰¹å¤„ç†</strong> - æµå¼æ•°æ®è®¿é—®ï¼›æ•°æ®ä½ç½®æš´éœ²ç»™è®¡ç®—æ¡†æ¶</li>
<li><strong>æ„å»ºåœ¨å»‰ä»·å•†ç”¨æœºå™¨ä¸Š</strong> - æä¾›äº†å®¹é”™å’Œæ¢å¤æœºåˆ¶</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li><strong>ä¸é€‚åˆä½å»¶è¿Ÿæ•°æ®è®¿é—®</strong> - é€‚åˆé«˜ååç‡çš„åœºæ™¯ï¼Œå°±æ˜¯åœ¨æŸä¸€æ—¶é—´å†…å†™å…¥å¤§é‡çš„æ•°æ®ã€‚ä½†æ˜¯å®ƒåœ¨ä½å»¶æ—¶çš„æƒ…å†µä¸‹æ˜¯ä¸è¡Œçš„ï¼Œæ¯”å¦‚æ¯«ç§’çº§ä»¥å†…è¯»å–æ•°æ®ï¼Œå®ƒæ˜¯å¾ˆéš¾åšåˆ°çš„ã€‚</li>
<li><strong>ä¸é€‚åˆå¤§é‡å°æ–‡ä»¶å­˜å‚¨</strong>
<ul>
<li>å­˜å‚¨å¤§é‡å°æ–‡ä»¶(è¿™é‡Œçš„å°æ–‡ä»¶æ˜¯æŒ‡å°äº HDFS ç³»ç»Ÿçš„ Block å¤§å°çš„æ–‡ä»¶ï¼ˆé»˜è®¤ 64Mï¼‰)çš„è¯ï¼Œå®ƒä¼šå ç”¨ NameNode å¤§é‡çš„å†…å­˜æ¥å­˜å‚¨æ–‡ä»¶ã€ç›®å½•å’Œå—ä¿¡æ¯ã€‚è¿™æ ·æ˜¯ä¸å¯å–çš„ï¼Œå› ä¸º NameNode çš„å†…å­˜æ€»æ˜¯æœ‰é™çš„ã€‚</li>
<li>ç£ç›˜å¯»é“æ—¶é—´è¶…è¿‡è¯»å–æ—¶é—´</li>
</ul>
</li>
<li><strong>ä¸æ”¯æŒå¹¶å‘å†™å…¥</strong> - ä¸€ä¸ªæ–‡ä»¶åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªå†™å…¥è€…</li>
<li><strong>ä¸æ”¯æŒæ–‡ä»¶éšæœºä¿®æ”¹</strong> - ä»…æ”¯æŒè¿½åŠ å†™å…¥</li>
</ul>
<h2 id="hdfs-çš„æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#hdfs-çš„æ¦‚å¿µ"></a> HDFS çš„æ¦‚å¿µ</h2>
<p>HDFS é‡‡ç”¨ Master/Slave æ¶æ„ã€‚</p>
<p>ä¸€ä¸ª HDFS é›†ç¾¤æ˜¯ç”±ä¸€ä¸ª Namenode å’Œä¸€å®šæ•°ç›®çš„ Datanodes ç»„æˆã€‚Namenode æ˜¯ä¸€ä¸ªä¸­å¿ƒæœåŠ¡å™¨ï¼Œè´Ÿè´£ç®¡ç†æ–‡ä»¶ç³»ç»Ÿçš„åå­—ç©ºé—´(namespace)ä»¥åŠå®¢æˆ·ç«¯å¯¹æ–‡ä»¶çš„è®¿é—®ã€‚é›†ç¾¤ä¸­çš„ Datanode ä¸€èˆ¬æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ä¸€ä¸ªï¼Œè´Ÿè´£ç®¡ç†å®ƒæ‰€åœ¨èŠ‚ç‚¹ä¸Šçš„å­˜å‚¨ã€‚HDFS æš´éœ²äº†æ–‡ä»¶ç³»ç»Ÿçš„åå­—ç©ºé—´ï¼Œç”¨æˆ·èƒ½å¤Ÿä»¥æ–‡ä»¶çš„å½¢å¼åœ¨ä¸Šé¢å­˜å‚¨æ•°æ®ã€‚ä»å†…éƒ¨çœ‹ï¼Œä¸€ä¸ªæ–‡ä»¶å…¶å®è¢«åˆ†æˆä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å—ï¼Œè¿™äº›å—å­˜å‚¨åœ¨ä¸€ç»„ Datanode ä¸Šã€‚Namenode æ‰§è¡Œæ–‡ä»¶ç³»ç»Ÿçš„åå­—ç©ºé—´æ“ä½œï¼Œæ¯”å¦‚æ‰“å¼€ã€å…³é—­ã€é‡å‘½åæ–‡ä»¶æˆ–ç›®å½•ã€‚å®ƒä¹Ÿè´Ÿè´£ç¡®å®šæ•°æ®å—åˆ°å…·ä½“ Datanode èŠ‚ç‚¹çš„æ˜ å°„ã€‚Datanode è´Ÿè´£å¤„ç†æ–‡ä»¶ç³»ç»Ÿå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ã€‚åœ¨ Namenode çš„ç»Ÿä¸€è°ƒåº¦ä¸‹è¿›è¡Œæ•°æ®å—çš„åˆ›å»ºã€åˆ é™¤å’Œå¤åˆ¶ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hdfs/hdfs-architecture.png"/></div>
<h3 id="namenode"><a class="markdownIt-Anchor" href="#namenode"></a> NameNode</h3>
<p><strong>NameNode å°±æ˜¯ master å·¥ä½œèŠ‚ç‚¹ã€‚</strong></p>
<ul>
<li>ç®¡ç†å‘½åç©ºé—´</li>
<li>ç®¡ç†å…ƒæ•°æ®ï¼šæ–‡ä»¶çš„ä½ç½®ã€æ‰€æœ‰è€…ã€æƒé™ã€æ•°æ®å—ç­‰</li>
<li>ç®¡ç† Block å‰¯æœ¬ç­–ç•¥ï¼šé»˜è®¤ 3 ä¸ªå‰¯æœ¬</li>
<li>å¤„ç†å®¢æˆ·ç«¯è¯»å†™è¯·æ±‚ï¼Œä¸º DataNode åˆ†é…ä»»åŠ¡</li>
</ul>
<h4 id="active-namenode-å’Œ-standby-namenode"><a class="markdownIt-Anchor" href="#active-namenode-å’Œ-standby-namenode"></a> Active NameNode å’Œ Standby NameNode</h4>
<p>NameNode é€šè¿‡ HA æœºåˆ¶æ¥å®¹é”™ã€‚</p>
<ul>
<li><strong>Active NameNode</strong> - æ˜¯æ­£åœ¨å·¥ä½œçš„ NameNodeï¼›</li>
<li><strong>Standby NameNode</strong> - æ˜¯å¤‡ä»½çš„ NameNodeã€‚</li>
</ul>
<p>Active NameNode å®•æœºåï¼ŒStandby NameNode å¿«é€Ÿå‡çº§ä¸ºæ–°çš„ Active NameNodeã€‚</p>
<p>Standby NameNode å‘¨æœŸæ€§åŒæ­¥ edits ç¼–è¾‘æ—¥å¿—ï¼Œå®šæœŸåˆå¹¶ fsimage ä¸ edits åˆ°æœ¬åœ°ç£ç›˜ã€‚</p>
<p>Hadoop 3.0 å…è®¸é…ç½®å¤šä¸ª Standby NameNodeã€‚</p>
<h4 id="å…ƒæ•°æ®æ–‡ä»¶"><a class="markdownIt-Anchor" href="#å…ƒæ•°æ®æ–‡ä»¶"></a> å…ƒæ•°æ®æ–‡ä»¶</h4>
<ul>
<li><strong>editsï¼ˆç¼–è¾‘æ—¥å¿—æ–‡ä»¶ï¼‰</strong> - ä¿å­˜äº†è‡ªæœ€æ–°æ£€æŸ¥ç‚¹ï¼ˆCheckpointï¼‰ä¹‹åçš„æ‰€æœ‰æ–‡ä»¶æ›´æ–°æ“ä½œã€‚</li>
<li><strong>fsimageï¼ˆå…ƒæ•°æ®æ£€æŸ¥ç‚¹é•œåƒæ–‡ä»¶ï¼‰</strong> - ä¿å­˜äº†æ–‡ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰çš„ç›®å½•å’Œæ–‡ä»¶ä¿¡æ¯ï¼Œå¦‚ï¼šæŸä¸ªç›®å½•ä¸‹æœ‰å“ªäº›å­ç›®å½•å’Œæ–‡ä»¶ï¼Œä»¥åŠæ–‡ä»¶åã€æ–‡ä»¶å‰¯æœ¬æ•°ã€æ–‡ä»¶ç”±å“ªäº› Block ç»„æˆç­‰ã€‚</li>
</ul>
<p>Active NameNode å†…å­˜ä¸­æœ‰ä¸€ä»½æœ€æ–°çš„å…ƒæ•°æ®ï¼ˆ= fsimage + editsï¼‰ã€‚</p>
<p>Standby NameNode åœ¨æ£€æŸ¥ç‚¹å®šæœŸå°†å†…å­˜ä¸­çš„å…ƒæ•°æ®ä¿å­˜åˆ° fsimage æ–‡ä»¶ä¸­ã€‚</p>
<h3 id="datanode"><a class="markdownIt-Anchor" href="#datanode"></a> DataNode</h3>
<p>**DataNode å°±æ˜¯ slave å·¥ä½œèŠ‚ç‚¹ã€‚**NameNode ä¸‹è¾¾å‘½ä»¤ï¼ŒDataNode æ‰§è¡Œå®é™…çš„æ“ä½œã€‚</p>
<ul>
<li>å­˜å‚¨ Block å’Œæ•°æ®æ ¡éªŒå’Œ</li>
<li>æ‰§è¡Œå®¢æˆ·ç«¯å‘é€çš„è¯»å†™æ“ä½œ</li>
<li>é€šè¿‡å¿ƒè·³æœºåˆ¶å®šæœŸï¼ˆé»˜è®¤ 3 ç§’ï¼‰å‘ NameNode æ±‡æŠ¥è¿è¡ŒçŠ¶æ€å’Œ Block åˆ—è¡¨ä¿¡æ¯</li>
<li>é›†ç¾¤å¯åŠ¨æ—¶ï¼ŒDataNode å‘ NameNode æä¾› Block åˆ—è¡¨ä¿¡æ¯</li>
</ul>
<h3 id="block-æ•°æ®å—"><a class="markdownIt-Anchor" href="#block-æ•°æ®å—"></a> Block æ•°æ®å—</h3>
<ul>
<li>HDFS æœ€å°å­˜å‚¨å•å…ƒ</li>
<li>æ–‡ä»¶å†™å…¥ HDFS ä¼šè¢«åˆ‡åˆ†æˆè‹¥å¹²ä¸ª Block</li>
<li>Block å¤§å°å›ºå®šï¼Œé»˜è®¤ä¸º 128MBï¼Œå¯è‡ªå®šä¹‰</li>
<li>è‹¥ä¸€ä¸ª Block çš„å¤§å°å°äºè®¾å®šå€¼ï¼Œä¸ä¼šå ç”¨æ•´ä¸ªå—ç©ºé—´</li>
<li>é»˜è®¤æƒ…å†µä¸‹æ¯ä¸ª Block æœ‰ 3 ä¸ªå‰¯æœ¬</li>
</ul>
<h3 id="client"><a class="markdownIt-Anchor" href="#client"></a> Client</h3>
<ul>
<li>å°†æ–‡ä»¶åˆ‡åˆ†ä¸º Block æ•°æ®å—</li>
<li>ä¸ NameNode äº¤äº’ï¼Œè·å–æ–‡ä»¶å…ƒæ•°æ®</li>
<li>ä¸ DataNode äº¤äº’ï¼Œè¯»å–æˆ–å†™å…¥æ•°æ®</li>
<li>ç®¡ç† HDFS</li>
</ul>
<h2 id="block-å‰¯æœ¬ç­–ç•¥"><a class="markdownIt-Anchor" href="#block-å‰¯æœ¬ç­–ç•¥"></a> Block å‰¯æœ¬ç­–ç•¥</h2>
<p>HDFS è¢«è®¾è®¡æˆèƒ½å¤Ÿåœ¨ä¸€ä¸ªå¤§é›†ç¾¤ä¸­è·¨æœºå™¨å¯é åœ°å­˜å‚¨è¶…å¤§æ–‡ä»¶ã€‚å®ƒå°†æ¯ä¸ªæ–‡ä»¶å­˜å‚¨æˆä¸€ç³»åˆ—çš„æ•°æ®å—ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œæ‰€æœ‰çš„æ•°æ®å—éƒ½æ˜¯åŒæ ·å¤§å°çš„ã€‚ä¸ºäº†å®¹é”™ï¼Œæ–‡ä»¶çš„æ‰€æœ‰æ•°æ®å—éƒ½ä¼šæœ‰å‰¯æœ¬ã€‚æ¯ä¸ªæ–‡ä»¶çš„æ•°æ®å—å¤§å°å’Œå‰¯æœ¬ç³»æ•°éƒ½æ˜¯å¯é…ç½®çš„ã€‚åº”ç”¨ç¨‹åºå¯ä»¥æŒ‡å®šæŸä¸ªæ–‡ä»¶çš„å‰¯æœ¬æ•°ç›®ã€‚å‰¯æœ¬ç³»æ•°å¯ä»¥åœ¨æ–‡ä»¶åˆ›å»ºçš„æ—¶å€™æŒ‡å®šï¼Œä¹Ÿå¯ä»¥åœ¨ä¹‹åæ”¹å˜ã€‚HDFS ä¸­çš„æ–‡ä»¶éƒ½æ˜¯ä¸€æ¬¡æ€§å†™å…¥çš„ï¼Œå¹¶ä¸”ä¸¥æ ¼è¦æ±‚åœ¨ä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªå†™å…¥è€…ã€‚</p>
<p><strong>Namenode å…¨æƒç®¡ç†æ•°æ®å—çš„å¤åˆ¶</strong>ï¼Œå®ƒå‘¨æœŸæ€§åœ°ä»é›†ç¾¤ä¸­çš„æ¯ä¸ª Datanode æ¥æ”¶å¿ƒè·³ä¿¡å·å’Œå—çŠ¶æ€æŠ¥å‘Š(Blockreport)ã€‚æ¥æ”¶åˆ°å¿ƒè·³ä¿¡å·æ„å‘³ç€è¯¥ Datanode èŠ‚ç‚¹å·¥ä½œæ­£å¸¸ã€‚å—çŠ¶æ€æŠ¥å‘ŠåŒ…å«äº†ä¸€ä¸ªè¯¥ Datanode ä¸Šæ‰€æœ‰æ•°æ®å—çš„åˆ—è¡¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hdfs/hdfs-replica.png"/></div>
<ul>
<li>å‰¯æœ¬ 1ï¼šæ”¾åœ¨ Client æ‰€åœ¨èŠ‚ç‚¹
<ul>
<li>å¯¹äºè¿œç¨‹ Clientï¼Œç³»ç»Ÿä¼šéšæœºé€‰æ‹©èŠ‚ç‚¹</li>
</ul>
</li>
<li>å‰¯æœ¬ 2ï¼šæ”¾åœ¨ä¸åŒçš„æœºæ¶èŠ‚ç‚¹ä¸Š</li>
<li>å‰¯æœ¬ 3ï¼šæ”¾åœ¨ä¸ç¬¬äºŒä¸ªå‰¯æœ¬åŒä¸€æœºæ¶çš„ä¸åŒèŠ‚ç‚¹ä¸Š</li>
<li>å‰¯æœ¬ Nï¼šéšæœºé€‰æ‹©</li>
<li>èŠ‚ç‚¹é€‰æ‹©ï¼šåŒç­‰æ¡ä»¶ä¸‹ä¼˜å…ˆé€‰æ‹©ç©ºé—²èŠ‚ç‚¹</li>
</ul>
<h2 id="æ•°æ®æµ"><a class="markdownIt-Anchor" href="#æ•°æ®æµ"></a> æ•°æ®æµ</h2>
<h3 id="hdfs-è¯»æ–‡ä»¶"><a class="markdownIt-Anchor" href="#hdfs-è¯»æ–‡ä»¶"></a> HDFS è¯»æ–‡ä»¶</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hdfs/hdfs-read.png"/></div>
<ol>
<li>å®¢æˆ·ç«¯è°ƒç”¨ FileSyste å¯¹è±¡çš„ open() æ–¹æ³•åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­<strong>æ‰“å¼€è¦è¯»å–çš„æ–‡ä»¶</strong>ã€‚</li>
<li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ä½¿ç”¨ RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ¥è°ƒç”¨ namenodeï¼Œ<strong>ç¡®å®šæ–‡ä»¶èµ·å§‹å—çš„ä½ç½®</strong>ã€‚</li>
<li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„ DistributedFileSystem ç±»è¿”å›ä¸€ä¸ªæ”¯æŒæ–‡ä»¶å®šä½çš„è¾“å…¥æµ FSDataInputStream å¯¹è±¡ï¼ŒFSDataInputStream å¯¹è±¡æ¥ç€å°è£… DFSInputStream å¯¹è±¡ï¼ˆ<strong>å­˜å‚¨ç€æ–‡ä»¶èµ·å§‹å‡ ä¸ªå—çš„ datanode åœ°å€</strong>ï¼‰ï¼Œå®¢æˆ·ç«¯å¯¹è¿™ä¸ªè¾“å…¥æµè°ƒç”¨ read()æ–¹æ³•ã€‚</li>
<li>DFSInputStream è¿æ¥è·ç¦»æœ€è¿‘çš„ datanodeï¼Œé€šè¿‡åå¤è°ƒç”¨ read æ–¹æ³•ï¼Œ<strong>å°†æ•°æ®ä» datanode ä¼ è¾“åˆ°å®¢æˆ·ç«¯</strong>ã€‚</li>
<li>åˆ°è¾¾å—çš„æœ«ç«¯æ—¶ï¼ŒDFSInputStream å…³é—­ä¸è¯¥ datanode çš„è¿æ¥ï¼Œ<strong>å¯»æ‰¾ä¸‹ä¸€ä¸ªå—çš„æœ€ä½³ datanode</strong>ã€‚</li>
<li>å®¢æˆ·ç«¯å®Œæˆè¯»å–ï¼Œå¯¹ FSDataInputStream è°ƒç”¨ close()æ–¹æ³•<strong>å…³é—­è¿æ¥</strong>ã€‚</li>
</ol>
<h3 id="hdfs-å†™æ–‡ä»¶"><a class="markdownIt-Anchor" href="#hdfs-å†™æ–‡ä»¶"></a> HDFS å†™æ–‡ä»¶</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hdfs/hdfs-write.png"/></div>
<ol>
<li>å®¢æˆ·ç«¯é€šè¿‡å¯¹ DistributedFileSystem å¯¹è±¡è°ƒç”¨ create() å‡½æ•°æ¥<strong>æ–°å»ºæ–‡ä»¶</strong>ã€‚</li>
<li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå¯¹ namenod åˆ›å»ºä¸€ä¸ª RPC è°ƒç”¨ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿçš„<strong>å‘½åç©ºé—´ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶</strong>ã€‚</li>
<li>Namenode å¯¹æ–°å»ºæ–‡ä»¶è¿›è¡Œæ£€æŸ¥æ— è¯¯åï¼Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ª FSDataOutputStream å¯¹è±¡ï¼ŒFSDataOutputStream å¯¹è±¡å°è£…ä¸€ä¸ª DFSoutPutstream å¯¹è±¡ï¼Œè´Ÿè´£å¤„ç† namenode å’Œ datanode ä¹‹é—´çš„é€šä¿¡ï¼Œ<strong>å®¢æˆ·ç«¯å¼€å§‹å†™å…¥æ•°æ®</strong>ã€‚</li>
<li>FSDataOutputStream å°†<strong>æ•°æ®åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„æ•°æ®åŒ…ï¼Œå†™å…¥å†…éƒ¨é˜Ÿåˆ—â€œæ•°æ®é˜Ÿåˆ—â€</strong>ï¼ŒDataStreamer è´Ÿè´£å°†æ•°æ®åŒ…ä¾æ¬¡æµå¼ä¼ è¾“åˆ°ç”±ä¸€ç»„ namenode æ„æˆçš„ç®¡çº¿ä¸­ã€‚</li>
<li>DFSOutputStream ç»´æŠ¤ç€ç¡®è®¤é˜Ÿåˆ—æ¥ç­‰å¾… datanode æ”¶åˆ°ç¡®è®¤å›æ‰§ï¼Œ<strong>æ”¶åˆ°ç®¡é“ä¸­æ‰€æœ‰ datanode ç¡®è®¤åï¼Œæ•°æ®åŒ…ä»ç¡®è®¤é˜Ÿåˆ—åˆ </strong>é™¤ã€‚</li>
<li><strong>å®¢æˆ·ç«¯å®Œæˆæ•°æ®çš„å†™å…¥</strong>ï¼Œå¯¹æ•°æ®æµè°ƒç”¨ close() æ–¹æ³•ã€‚</li>
<li>namenode <strong>ç¡®è®¤å®Œæˆ</strong>ã€‚</li>
</ol>
<h2 id="hdfs-å®‰å…¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#hdfs-å®‰å…¨æ¨¡å¼"></a> HDFS å®‰å…¨æ¨¡å¼</h2>
<h3 id="ä»€ä¹ˆæ˜¯å®‰å…¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯å®‰å…¨æ¨¡å¼"></a> ä»€ä¹ˆæ˜¯å®‰å…¨æ¨¡å¼ï¼Ÿ</h3>
<ul>
<li>å®‰å…¨æ¨¡å¼æ˜¯ HDFS çš„ä¸€ç§ç‰¹æ®ŠçŠ¶æ€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼ŒHDFS åªæ¥æ”¶è¯»æ•°æ®è¯·æ±‚ï¼Œè€Œä¸æ¥æ”¶å†™å…¥ã€åˆ é™¤ã€ä¿®æ”¹ç­‰å˜æ›´è¯·æ±‚ã€‚</li>
<li>å®‰å…¨æ¨¡å¼æ˜¯ HDFS ç¡®ä¿ Block æ•°æ®å®‰å…¨çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚</li>
<li>Active NameNode å¯åŠ¨æ—¶ï¼ŒHDFS ä¼šè¿›å…¥å®‰å…¨æ¨¡å¼ï¼ŒDataNode ä¸»åŠ¨å‘ NameNode æ±‡æŠ¥å¯ç”¨ Block åˆ—è¡¨ç­‰ä¿¡æ¯ï¼Œåœ¨ç³»ç»Ÿè¾¾åˆ°å®‰å…¨æ ‡å‡†å‰ï¼ŒHDFS ä¸€ç›´å¤„äºâ€œåªè¯»â€çŠ¶æ€ã€‚</li>
</ul>
<h3 id="ä½•æ—¶æ­£å¸¸ç¦»å¼€å®‰å…¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#ä½•æ—¶æ­£å¸¸ç¦»å¼€å®‰å…¨æ¨¡å¼"></a> ä½•æ—¶æ­£å¸¸ç¦»å¼€å®‰å…¨æ¨¡å¼</h3>
<ul>
<li>Block ä¸ŠæŠ¥ç‡ï¼šDataNode ä¸ŠæŠ¥çš„å¯ç”¨ Block ä¸ªæ•° / NameNode å…ƒæ•°æ®è®°å½•çš„ Block ä¸ªæ•°</li>
<li>å½“ Block ä¸ŠæŠ¥ç‡ &gt;= é˜ˆå€¼æ—¶ï¼ŒHDFS æ‰èƒ½ç¦»å¼€å®‰å…¨æ¨¡å¼ï¼Œé»˜è®¤é˜ˆå€¼ä¸º 0.999</li>
<li>ä¸å»ºè®®æ‰‹åŠ¨å¼ºåˆ¶é€€å‡ºå®‰å…¨æ¨¡å¼</li>
</ul>
<h3 id="è§¦å‘å®‰å…¨æ¨¡å¼çš„åŸå› "><a class="markdownIt-Anchor" href="#è§¦å‘å®‰å…¨æ¨¡å¼çš„åŸå› "></a> è§¦å‘å®‰å…¨æ¨¡å¼çš„åŸå› </h3>
<ul>
<li>NameNode é‡å¯</li>
<li>NameNode ç£ç›˜ç©ºé—´ä¸è¶³</li>
<li>Block ä¸ŠæŠ¥ç‡ä½äºé˜ˆå€¼</li>
<li>DataNode æ— æ³•æ­£å¸¸å¯åŠ¨</li>
<li>æ—¥å¿—ä¸­å‡ºç°ä¸¥é‡å¼‚å¸¸</li>
<li>ç”¨æˆ·æ“ä½œä¸å½“ï¼Œå¦‚ï¼š<strong>å¼ºåˆ¶å…³æœºï¼ˆç‰¹åˆ«æ³¨æ„ï¼ï¼‰</strong></li>
</ul>
<h3 id="æ•…éšœæ’æŸ¥"><a class="markdownIt-Anchor" href="#æ•…éšœæ’æŸ¥"></a> æ•…éšœæ’æŸ¥</h3>
<ul>
<li>æ‰¾åˆ° DataNode ä¸èƒ½æ­£å¸¸å¯åŠ¨çš„åŸå› ï¼Œé‡å¯ DataNode</li>
<li>æ¸…ç† NameNode ç£ç›˜</li>
<li>è°¨æ…æ“ä½œï¼Œæœ‰é—®é¢˜æ‰¾æ˜Ÿç¯ï¼Œä»¥å…ä¸¢å¤±æ•°æ®</li>
</ul>
<h2 id="hdfs-é«˜å¯ç”¨"><a class="markdownIt-Anchor" href="#hdfs-é«˜å¯ç”¨"></a> HDFS é«˜å¯ç”¨</h2>
<h3 id="namenode-çš„-ha-æœºåˆ¶"><a class="markdownIt-Anchor" href="#namenode-çš„-ha-æœºåˆ¶"></a> NameNode çš„ HA æœºåˆ¶</h3>
<p>Active NameNode å’Œ Standby NameNode å®ç°ä¸»å¤‡ã€‚</p>
<h3 id="åˆ©ç”¨-qjm-å®ç°å…ƒæ•°æ®é«˜å¯ç”¨"><a class="markdownIt-Anchor" href="#åˆ©ç”¨-qjm-å®ç°å…ƒæ•°æ®é«˜å¯ç”¨"></a> åˆ©ç”¨ QJM å®ç°å…ƒæ•°æ®é«˜å¯ç”¨</h3>
<blockquote>
<p>åŸºäº Paxos ç®—æ³•</p>
</blockquote>
<p>QJM æœºåˆ¶ï¼ˆQuorum Journal Managerï¼‰</p>
<p>åªè¦ä¿è¯ Quorumï¼ˆæ³•å®šäººæ•°ï¼‰æ•°é‡çš„æ“ä½œæˆåŠŸï¼Œå°±è®¤ä¸ºè¿™æ˜¯ä¸€æ¬¡æœ€ç»ˆæˆåŠŸçš„æ“ä½œ</p>
<p>QJM å…±äº«å­˜å‚¨ç³»ç»Ÿ</p>
<ul>
<li>éƒ¨ç½²å¥‡æ•°ï¼ˆ2N+1ï¼‰ä¸ª JournalNode</li>
<li>JournalNode è´Ÿè´£å­˜å‚¨ edits ç¼–è¾‘æ—¥å¿—</li>
<li>å†™ edits çš„æ—¶å€™ï¼Œåªè¦è¶…è¿‡åŠæ•°ï¼ˆï‚³N+1ï¼‰çš„ JournalNode è¿”å›æˆåŠŸï¼Œå°±ä»£è¡¨æœ¬æ¬¡å†™å…¥æˆåŠŸ</li>
<li>æœ€å¤šå¯å®¹å¿ N ä¸ª JournalNode å®•æœº</li>
</ul>
<p>åˆ©ç”¨ ZooKeeper å®ç° Active èŠ‚ç‚¹é€‰ä¸¾ã€‚</p>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
<ul>
<li><a href="http://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html" target="_blank" rel="noopener">HDFS å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://www.cnblogs.com/caiyisen/p/7395843.html" target="_blank" rel="noopener">HDFS çŸ¥è¯†ç‚¹æ€»ç»“</a></li>
<li><a href="http://shop.oreilly.com/product/0636920033448.do" target="_blank" rel="noopener">ã€ŠHadoop: The Definitive Guide, Fourth Editionã€‹</a> by Tom White</li>
<li><a href="http://hadoop.apache.org/docs/r1.0.4/cn/hdfs_design.html" target="_blank" rel="noopener">http://hadoop.apache.org/docs/r1.0.4/cn/hdfs_design.html</a></li>
</ul>
]]></content>
      <categories>
        <category>bigdata</category>
      </categories>
      <tags>
        <tag>bigdata</tag>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>MapReduce</title>
    <url>/blog/bigdata/MapReduce/</url>
    <content><![CDATA[<h1 id="mapreduce"><a class="markdownIt-Anchor" href="#mapreduce"></a> MapReduce</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#mapreduce-%E7%AE%80%E4%BB%8B">MapReduce ç®€ä»‹</a>
<ul>
<li><a href="#%E6%A6%82%E5%BF%B5">æ¦‚å¿µ</a></li>
<li><a href="#%E6%80%9D%E6%83%B3">æ€æƒ³</a></li>
<li><a href="#%E7%89%B9%E7%82%B9">ç‰¹ç‚¹</a></li>
<li><a href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">é€‚ç”¨åœºæ™¯</a></li>
<li><a href="#%E4%B8%8D%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">ä¸é€‚ç”¨åœºæ™¯</a></li>
</ul>
</li>
<li><a href="#mapreduce-%E5%8E%9F%E7%90%86">MapReduce åŸç†</a>
<ul>
<li><a href="#job--task%E4%BD%9C%E4%B8%9A%E4%B8%8E%E4%BB%BB%E5%8A%A1">Job &amp; Taskï¼ˆä½œä¸šä¸ä»»åŠ¡ï¼‰</a></li>
<li><a href="#split%E5%88%87%E7%89%87">Splitï¼ˆåˆ‡ç‰‡ï¼‰</a></li>
<li><a href="#map-%E9%98%B6%E6%AE%B5%E6%98%A0%E5%B0%84">Map é˜¶æ®µï¼ˆæ˜ å°„ï¼‰</a></li>
<li><a href="#reduce-%E9%98%B6%E6%AE%B5%E5%8C%96%E7%AE%80">Reduce é˜¶æ®µï¼ˆåŒ–ç®€ï¼‰</a></li>
<li><a href="#shuffle-%E9%98%B6%E6%AE%B5%E6%B4%97%E7%89%8C">Shuffle é˜¶æ®µï¼ˆæ´—ç‰Œï¼‰</a></li>
</ul>
</li>
<li><a href="#shuffle-%E8%AF%A6%E8%A7%A3">Shuffle è¯¦è§£</a>
<ul>
<li><a href="#map-%E7%AB%AF">Map ç«¯</a></li>
<li><a href="#reduce-%E7%AB%AF">Reduce ç«¯</a></li>
</ul>
</li>
<li><a href="#%E4%BD%9C%E4%B8%9A%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F">ä½œä¸šè¿è¡Œæ¨¡å¼</a>
<ul>
<li><a href="#jobtrackertasktracker-%E6%A8%A1%E5%BC%8Fhadoop-1x">JobTracker/TaskTracker æ¨¡å¼ï¼ˆHadoop 1.Xï¼‰</a></li>
<li><a href="#yarn-%E6%A8%A1%E5%BC%8Fhadoop-2x">YARN æ¨¡å¼ï¼ˆHadoop 2.Xï¼‰</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="mapreduce-ç®€ä»‹"><a class="markdownIt-Anchor" href="#mapreduce-ç®€ä»‹"></a> MapReduce ç®€ä»‹</h2>
<h3 id="æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#æ¦‚å¿µ"></a> æ¦‚å¿µ</h3>
<p>MapReduce æ˜¯ä¸€ä¸ªé¢å‘æ‰¹å¤„ç†çš„åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ã€‚</p>
<p>ç¼–ç¨‹æ¨¡å‹ï¼šMapReduce ç¨‹åºè¢«åˆ†ä¸º Mapï¼ˆæ˜ å°„ï¼‰é˜¶æ®µå’Œ Reduceï¼ˆåŒ–ç®€ï¼‰é˜¶æ®µã€‚</p>
<h3 id="æ€æƒ³"><a class="markdownIt-Anchor" href="#æ€æƒ³"></a> æ€æƒ³</h3>
<p>åˆ†è€Œæ²»ä¹‹ï¼Œå¹¶è¡Œè®¡ç®—<br />
ç§»åŠ¨è®¡ç®—ï¼Œè€Œéç§»åŠ¨æ•°æ®</p>
<h3 id="ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#ç‰¹ç‚¹"></a> ç‰¹ç‚¹</h3>
<ul>
<li>è®¡ç®—è·Ÿç€æ•°æ®èµ°</li>
<li>è‰¯å¥½çš„æ‰©å±•æ€§ï¼šè®¡ç®—èƒ½åŠ›éšç€èŠ‚ç‚¹æ•°å¢åŠ ï¼Œè¿‘ä¼¼çº¿æ€§é€’å¢</li>
<li>é«˜å®¹é”™</li>
<li>çŠ¶æ€ç›‘æ§</li>
<li>é€‚åˆæµ·é‡æ•°æ®çš„ç¦»çº¿æ‰¹å¤„ç†</li>
<li>é™ä½äº†åˆ†å¸ƒå¼ç¼–ç¨‹çš„é—¨æ§›</li>
</ul>
<h3 id="é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#é€‚ç”¨åœºæ™¯"></a> é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>æ•°æ®ç»Ÿè®¡ï¼Œå¦‚ï¼šç½‘ç«™çš„ PVã€UV ç»Ÿè®¡</li>
<li>æœç´¢å¼•æ“æ„å»ºç´¢å¼•</li>
<li>æµ·é‡æ•°æ®æŸ¥è¯¢</li>
</ul>
<h3 id="ä¸é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#ä¸é€‚ç”¨åœºæ™¯"></a> ä¸é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>OLAP
<ul>
<li>è¦æ±‚æ¯«ç§’æˆ–ç§’çº§è¿”å›ç»“æœ</li>
</ul>
</li>
<li>æµè®¡ç®—
<ul>
<li>æµè®¡ç®—çš„è¾“å…¥æ•°æ®é›†æ˜¯åŠ¨æ€çš„ï¼Œè€Œ MapReduce æ˜¯é™æ€çš„</li>
</ul>
</li>
<li>DAG è®¡ç®—
<ul>
<li>å¤šä¸ªä½œä¸šå­˜åœ¨ä¾èµ–å…³ç³»ï¼Œåä¸€ä¸ªçš„è¾“å…¥æ˜¯å‰ä¸€ä¸ªçš„è¾“å‡ºï¼Œæ„æˆæœ‰å‘æ— ç¯å›¾ DAG</li>
<li>æ¯ä¸ª MapReduce ä½œä¸šçš„è¾“å‡ºç»“æœéƒ½ä¼šè½ç›˜ï¼Œé€ æˆå¤§é‡ç£ç›˜ IOï¼Œå¯¼è‡´æ€§èƒ½éå¸¸ä½ä¸‹</li>
</ul>
</li>
</ul>
<h2 id="mapreduce-åŸç†"><a class="markdownIt-Anchor" href="#mapreduce-åŸç†"></a> MapReduce åŸç†</h2>
<h3 id="job-taskä½œä¸šä¸ä»»åŠ¡"><a class="markdownIt-Anchor" href="#job-taskä½œä¸šä¸ä»»åŠ¡"></a> Job &amp; Taskï¼ˆä½œä¸šä¸ä»»åŠ¡ï¼‰</h3>
<ul>
<li>ä½œä¸šæ˜¯å®¢æˆ·ç«¯è¯·æ±‚æ‰§è¡Œçš„ä¸€ä¸ªå·¥ä½œå•å…ƒ
<ul>
<li>åŒ…æ‹¬è¾“å…¥æ•°æ®ã€MapReduce ç¨‹åºã€é…ç½®ä¿¡æ¯</li>
</ul>
</li>
<li>ä»»åŠ¡æ˜¯å°†ä½œä¸šåˆ†è§£åå¾—åˆ°çš„ç»†åˆ†å·¥ä½œå•å…ƒ
<ul>
<li>åˆ†ä¸º Map ä»»åŠ¡å’Œ Reduce ä»»åŠ¡</li>
</ul>
</li>
</ul>
<h3 id="splitåˆ‡ç‰‡"><a class="markdownIt-Anchor" href="#splitåˆ‡ç‰‡"></a> Splitï¼ˆåˆ‡ç‰‡ï¼‰</h3>
<ul>
<li>è¾“å…¥æ•°æ®è¢«åˆ’åˆ†æˆç­‰é•¿çš„å°æ•°æ®å—ï¼Œç§°ä¸ºè¾“å…¥åˆ‡ç‰‡ï¼ˆInput Splitï¼‰ï¼Œç®€ç§°åˆ‡ç‰‡</li>
<li>Split æ˜¯é€»è¾‘æ¦‚å¿µï¼Œä»…åŒ…å«å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚ï¼šæ•°æ®çš„èµ·å§‹ä½ç½®ã€é•¿åº¦ã€æ‰€åœ¨èŠ‚ç‚¹ç­‰</li>
<li>æ¯ä¸ª Split äº¤ç»™ä¸€ä¸ª Map ä»»åŠ¡å¤„ç†ï¼ŒSplit çš„æ•°é‡å†³å®š Map ä»»åŠ¡çš„æ•°é‡</li>
<li>Split çš„åˆ’åˆ†æ–¹å¼ç”±ç¨‹åºè®¾å®šï¼ŒSplit ä¸ HDFS Block æ²¡æœ‰ä¸¥æ ¼çš„å¯¹åº”å…³ç³»</li>
<li>Split çš„å¤§å°é»˜è®¤ç­‰äº Block å¤§å°</li>
<li>Split è¶Šå°ï¼Œè´Ÿè½½è¶Šå‡è¡¡ï¼Œä½†é›†ç¾¤çš„å¼€é”€è¶Šå¤§</li>
</ul>
<h3 id="map-é˜¶æ®µæ˜ å°„"><a class="markdownIt-Anchor" href="#map-é˜¶æ®µæ˜ å°„"></a> Map é˜¶æ®µï¼ˆæ˜ å°„ï¼‰</h3>
<ul>
<li>ç”±è‹¥å¹² Map ä»»åŠ¡ç»„æˆï¼Œä»»åŠ¡æ•°é‡ç”± Split æ•°é‡å†³å®š</li>
<li>è¾“å…¥ï¼šSplit åˆ‡ç‰‡ï¼ˆkey-valueï¼‰ï¼Œè¾“å‡ºï¼šä¸­é—´è®¡ç®—ç»“æœï¼ˆkey-valueï¼‰</li>
</ul>
<h3 id="reduce-é˜¶æ®µåŒ–ç®€"><a class="markdownIt-Anchor" href="#reduce-é˜¶æ®µåŒ–ç®€"></a> Reduce é˜¶æ®µï¼ˆåŒ–ç®€ï¼‰</h3>
<ul>
<li>ç”±è‹¥å¹² Reduce ä»»åŠ¡ç»„æˆï¼Œä»»åŠ¡æ•°é‡ç”±ç¨‹åºæŒ‡å®š</li>
<li>è¾“å…¥ï¼šMap é˜¶æ®µè¾“å‡ºçš„ä¸­é—´ç»“æœï¼ˆkey-valueï¼‰ï¼Œè¾“å‡ºï¼šæœ€ç»ˆç»“æœï¼ˆkey-valueï¼‰</li>
</ul>
<h3 id="shuffle-é˜¶æ®µæ´—ç‰Œ"><a class="markdownIt-Anchor" href="#shuffle-é˜¶æ®µæ´—ç‰Œ"></a> Shuffle é˜¶æ®µï¼ˆæ´—ç‰Œï¼‰</h3>
<ul>
<li>Mapã€Reduce é˜¶æ®µçš„ä¸­é—´ç¯èŠ‚ï¼Œè´Ÿè´£æ‰§è¡Œ Partitionï¼ˆåˆ†åŒºï¼‰ã€Sortï¼ˆæ’åºï¼‰ã€Spillï¼ˆæº¢å†™ï¼‰ã€Mergeï¼ˆåˆå¹¶ï¼‰ã€æŠ“å–ï¼ˆFetchï¼‰ç­‰å·¥ä½œ</li>
<li>Partition å†³å®šäº† Map ä»»åŠ¡è¾“å‡ºçš„æ¯æ¡æ•°æ®æ”¾å…¥å“ªä¸ªåˆ†åŒºï¼Œäº¤ç»™å“ªä¸ª Reduce ä»»åŠ¡å¤„ç†</li>
<li>Reduce ä»»åŠ¡çš„æ•°é‡å†³å®šäº† Partition æ•°é‡</li>
<li>Partition ç¼–å· = Reduce ä»»åŠ¡ç¼–å· =â€œkey hashcode % reduce task numberâ€</li>
<li>é¿å…å’Œå‡å°‘ Shuffle æ˜¯ MapReduce ç¨‹åºè°ƒä¼˜çš„é‡ç‚¹</li>
</ul>
<h2 id="shuffle-è¯¦è§£"><a class="markdownIt-Anchor" href="#shuffle-è¯¦è§£"></a> Shuffle è¯¦è§£</h2>
<h3 id="map-ç«¯"><a class="markdownIt-Anchor" href="#map-ç«¯"></a> Map ç«¯</h3>
<p>Map ä»»åŠ¡å°†ä¸­é—´ç»“æœå†™å…¥ä¸“ç”¨å†…å­˜ç¼“å†²åŒº Bufferï¼ˆé»˜è®¤ 100Mï¼‰ï¼ŒåŒæ—¶è¿›è¡Œ Partition å’Œ Sortï¼ˆå…ˆæŒ‰â€œkey hashcode % reduce task numberâ€å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºï¼Œåˆ†åŒºå†…å†æŒ‰ key æ’åºï¼‰<br />
å½“ Buffer çš„æ•°æ®é‡è¾¾åˆ°é˜ˆå€¼ï¼ˆé»˜è®¤ 80%ï¼‰æ—¶ï¼Œå°†æ•°æ®æº¢å†™ï¼ˆSpillï¼‰åˆ°ç£ç›˜çš„ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶å†…æ•°æ®å…ˆåˆ†åŒºåæ’åº<br />
Map ä»»åŠ¡ç»“æŸå‰ï¼Œå°†å¤šä¸ªä¸´æ—¶æ–‡ä»¶åˆå¹¶ï¼ˆMergeï¼‰ä¸ºä¸€ä¸ª Map è¾“å‡ºæ–‡ä»¶ï¼Œæ–‡ä»¶å†…æ•°æ®å…ˆåˆ†åŒºåæ’åº</p>
<h3 id="reduce-ç«¯"><a class="markdownIt-Anchor" href="#reduce-ç«¯"></a> Reduce ç«¯</h3>
<p>Reduce ä»»åŠ¡ä»å¤šä¸ª Map è¾“å‡ºæ–‡ä»¶ä¸­ä¸»åŠ¨æŠ“å–ï¼ˆFetchï¼‰å±äºè‡ªå·±çš„åˆ†åŒºæ•°æ®ï¼Œå…ˆå†™å…¥ Bufferï¼Œæ•°æ®é‡è¾¾åˆ°é˜ˆå€¼åï¼Œæº¢å†™åˆ°ç£ç›˜çš„ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­<br />
æ•°æ®æŠ“å–å®Œæˆåï¼Œå°†å¤šä¸ªä¸´æ—¶æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ª Reduce è¾“å…¥æ–‡ä»¶ï¼Œæ–‡ä»¶å†…æ•°æ®æŒ‰ key æ’åº</p>
<h2 id="ä½œä¸šè¿è¡Œæ¨¡å¼"><a class="markdownIt-Anchor" href="#ä½œä¸šè¿è¡Œæ¨¡å¼"></a> ä½œä¸šè¿è¡Œæ¨¡å¼</h2>
<h3 id="jobtrackertasktracker-æ¨¡å¼hadoop-1x"><a class="markdownIt-Anchor" href="#jobtrackertasktracker-æ¨¡å¼hadoop-1x"></a> JobTracker/TaskTracker æ¨¡å¼ï¼ˆHadoop 1.Xï¼‰</h3>
<p><strong>JobTracker èŠ‚ç‚¹ï¼ˆMasterï¼‰</strong></p>
<ul>
<li>è°ƒåº¦ä»»åŠ¡åœ¨ TaskTracker ä¸Šè¿è¡Œ</li>
<li>è‹¥ä»»åŠ¡å¤±è´¥ï¼ŒæŒ‡å®šæ–° TaskTracker é‡æ–°è¿è¡Œ</li>
</ul>
<p><strong>TaskTracker èŠ‚ç‚¹ï¼ˆSlaveï¼‰</strong></p>
<ul>
<li>æ‰§è¡Œä»»åŠ¡ï¼Œå‘é€è¿›åº¦æŠ¥å‘Š</li>
</ul>
<p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p>
<ul>
<li>JobTracker å­˜åœ¨å•ç‚¹æ•…éšœ</li>
<li>JobTracker è´Ÿè½½å¤ªé‡ï¼ˆä¸Šé™ 4000 èŠ‚ç‚¹ï¼‰</li>
<li>JobTracker ç¼ºå°‘å¯¹èµ„æºçš„å…¨é¢ç®¡ç†</li>
<li>TaskTracker å¯¹èµ„æºçš„æè¿°è¿‡äºç®€å•</li>
<li>æºç å¾ˆéš¾ç†è§£</li>
</ul>
<h3 id="yarn-æ¨¡å¼hadoop-2x"><a class="markdownIt-Anchor" href="#yarn-æ¨¡å¼hadoop-2x"></a> YARN æ¨¡å¼ï¼ˆHadoop 2.Xï¼‰</h3>
<ul>
<li>æäº¤ä½œä¸š</li>
<li>æŸ¥çœ‹ä½œä¸š</li>
<li>ç»ˆæ­¢ä½œä¸š</li>
</ul>
]]></content>
      <categories>
        <category>bigdata</category>
      </categories>
      <tags>
        <tag>bigdata</tag>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Spark</title>
    <url>/blog/bigdata/Spark/</url>
    <content><![CDATA[<h1 id="spark"><a class="markdownIt-Anchor" href="#spark"></a> Spark</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#spark-%E7%AE%80%E4%BB%8B">Spark ç®€ä»‹</a>
<ul>
<li><a href="#spark-%E6%A6%82%E5%BF%B5">Spark æ¦‚å¿µ</a></li>
<li><a href="#spark-%E7%89%B9%E7%82%B9">Spark ç‰¹ç‚¹</a></li>
</ul>
</li>
<li><a href="#spark-%E5%8E%9F%E7%90%86">Spark åŸç†</a>
<ul>
<li><a href="#%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B">ç¼–ç¨‹æ¨¡å‹</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="spark-ç®€ä»‹"><a class="markdownIt-Anchor" href="#spark-ç®€ä»‹"></a> Spark ç®€ä»‹</h2>
<h3 id="spark-æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#spark-æ¦‚å¿µ"></a> Spark æ¦‚å¿µ</h3>
<ul>
<li>å¤§è§„æ¨¡åˆ†å¸ƒå¼é€šç”¨è®¡ç®—å¼•æ“
<ul>
<li>Spark Coreï¼šæ ¸å¿ƒè®¡ç®—æ¡†æ¶</li>
<li>Spark SQLï¼šç»“æ„åŒ–æ•°æ®æŸ¥è¯¢</li>
<li>Spark Streamingï¼šå®æ—¶æµå¤„ç†</li>
<li>Spark MLibï¼šæœºå™¨å­¦ä¹ </li>
<li>Spark GraphXï¼šå›¾è®¡ç®—</li>
</ul>
</li>
<li>å…·æœ‰é«˜ååã€ä½å»¶æ—¶ã€é€šç”¨æ˜“æ‰©å±•ã€é«˜å®¹é”™ç­‰ç‰¹ç‚¹</li>
<li>é‡‡ç”¨ Scala è¯­è¨€å¼€å‘</li>
<li>æä¾›å¤šç§è¿è¡Œæ¨¡å¼</li>
</ul>
<h3 id="spark-ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#spark-ç‰¹ç‚¹"></a> Spark ç‰¹ç‚¹</h3>
<ul>
<li>è®¡ç®—é«˜æ•ˆ
<ul>
<li>åˆ©ç”¨å†…å­˜è®¡ç®—ã€Cache ç¼“å­˜æœºåˆ¶ï¼Œæ”¯æŒè¿­ä»£è®¡ç®—å’Œæ•°æ®å…±äº«ï¼Œå‡å°‘æ•°æ®è¯»å–çš„ IO å¼€é”€</li>
<li>åˆ©ç”¨ DAG å¼•æ“ï¼Œå‡å°‘ä¸­é—´è®¡ç®—ç»“æœå†™å…¥ HDFS çš„å¼€é”€</li>
<li>åˆ©ç”¨å¤šçº¿ç¨‹æ± æ¨¡å‹ï¼Œå‡å°‘ä»»åŠ¡å¯åŠ¨å¼€é”€ï¼Œé¿å… Shuffle ä¸­ä¸å¿…è¦çš„æ’åºå’Œç£ç›˜ IO æ“ä½œ</li>
</ul>
</li>
<li>é€šç”¨æ˜“ç”¨
<ul>
<li>é€‚ç”¨äºæ‰¹å¤„ç†ã€æµå¤„ç†ã€äº¤äº’å¼è®¡ç®—ã€æœºå™¨å­¦ä¹ ç®—æ³•ç­‰åœºæ™¯</li>
<li>æä¾›äº†ä¸°å¯Œçš„å¼€å‘ APIï¼Œæ”¯æŒ Scalaã€Javaã€Pythonã€R ç­‰</li>
</ul>
</li>
<li>è¿è¡Œæ¨¡å¼å¤šæ ·
<ul>
<li>Local æ¨¡å¼</li>
<li>Standalone æ¨¡å¼</li>
<li>YARN/Mesos æ¨¡å¼</li>
</ul>
</li>
<li>è®¡ç®—é«˜æ•ˆ
<ul>
<li>åˆ©ç”¨å†…å­˜è®¡ç®—ã€Cache ç¼“å­˜æœºåˆ¶ï¼Œæ”¯æŒè¿­ä»£è®¡ç®—å’Œæ•°æ®å…±äº«ï¼Œå‡å°‘æ•°æ®è¯»å–çš„ IO å¼€é”€</li>
<li>åˆ©ç”¨ DAG å¼•æ“ï¼Œå‡å°‘ä¸­é—´è®¡ç®—ç»“æœå†™å…¥ HDFS çš„å¼€é”€</li>
<li>åˆ©ç”¨å¤šçº¿ç¨‹æ± æ¨¡å‹ï¼Œå‡å°‘ä»»åŠ¡å¯åŠ¨å¼€é”€ï¼Œé¿å… Shuffle ä¸­ä¸å¿…è¦çš„æ’åºå’Œç£ç›˜ IO æ“ä½œ</li>
</ul>
</li>
<li>é€šç”¨æ˜“ç”¨
<ul>
<li>é€‚ç”¨äºæ‰¹å¤„ç†ã€æµå¤„ç†ã€äº¤äº’å¼è®¡ç®—ã€æœºå™¨å­¦ä¹ ç­‰åœºæ™¯</li>
<li>æä¾›äº†ä¸°å¯Œçš„å¼€å‘ APIï¼Œæ”¯æŒ Scalaã€Javaã€Pythonã€R ç­‰</li>
</ul>
</li>
</ul>
<h2 id="spark-åŸç†"><a class="markdownIt-Anchor" href="#spark-åŸç†"></a> Spark åŸç†</h2>
<h3 id="ç¼–ç¨‹æ¨¡å‹"><a class="markdownIt-Anchor" href="#ç¼–ç¨‹æ¨¡å‹"></a> ç¼–ç¨‹æ¨¡å‹</h3>
<h4 id="rdd"><a class="markdownIt-Anchor" href="#rdd"></a> RDD</h4>
<ul>
<li>å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆResilient Distributed Datesetsï¼‰
<ul>
<li>åˆ†å¸ƒåœ¨é›†ç¾¤ä¸­çš„åªè¯»å¯¹è±¡é›†åˆ</li>
<li>ç”±å¤šä¸ª Partition ç»„æˆ</li>
<li>é€šè¿‡è½¬æ¢æ“ä½œæ„é€ </li>
<li>å¤±æ•ˆåè‡ªåŠ¨é‡æ„ï¼ˆå¼¹æ€§ï¼‰</li>
<li>å­˜å‚¨åœ¨å†…å­˜æˆ–ç£ç›˜ä¸­</li>
</ul>
</li>
<li>Spark åŸºäº RDD è¿›è¡Œè®¡ç®—</li>
</ul>
<h4 id="rdd-æ“ä½œoperator"><a class="markdownIt-Anchor" href="#rdd-æ“ä½œoperator"></a> RDD æ“ä½œï¼ˆOperatorï¼‰</h4>
<ul>
<li>Transformationï¼ˆè½¬æ¢ï¼‰
<ul>
<li>å°† Scala é›†åˆæˆ– Hadoop è¾“å…¥æ•°æ®æ„é€ æˆä¸€ä¸ªæ–° RDD</li>
<li>é€šè¿‡å·²æœ‰çš„ RDD äº§ç”Ÿæ–° RDD</li>
<li>æƒ°æ€§æ‰§è¡Œï¼šåªè®°å½•è½¬æ¢å…³ç³»ï¼Œä¸è§¦å‘è®¡ç®—</li>
<li>ä¾‹å¦‚ï¼šmapã€filterã€flatmapã€unionã€distinctã€sortbykey</li>
</ul>
</li>
<li>Actionï¼ˆåŠ¨ä½œï¼‰
<ul>
<li>é€šè¿‡ RDD è®¡ç®—å¾—åˆ°ä¸€ä¸ªå€¼æˆ–ä¸€ç»„å€¼</li>
<li>çœŸæ­£è§¦å‘è®¡ç®—</li>
<li>ä¾‹å¦‚ï¼šfirstã€countã€collectã€foreachã€saveAsTextFile</li>
</ul>
</li>
</ul>
<h4 id="rdd-ä¾èµ–dependency"><a class="markdownIt-Anchor" href="#rdd-ä¾èµ–dependency"></a> RDD ä¾èµ–ï¼ˆDependencyï¼‰</h4>
<ul>
<li>çª„ä¾èµ–ï¼ˆNarrow Dependencyï¼‰
<ul>
<li>çˆ¶ RDD ä¸­çš„åˆ†åŒºæœ€å¤šåªèƒ½è¢«ä¸€ä¸ªå­ RDD çš„ä¸€ä¸ªåˆ†åŒºä½¿ç”¨</li>
<li>å­ RDD å¦‚æœæœ‰éƒ¨åˆ†åˆ†åŒºæ•°æ®ä¸¢å¤±æˆ–æŸåï¼Œåªéœ€ä»å¯¹åº”çš„çˆ¶ RDD é‡æ–°è®¡ç®—æ¢å¤</li>
<li>ä¾‹å¦‚ï¼šmapã€filterã€union</li>
</ul>
</li>
<li>å®½ä¾èµ–ï¼ˆShuffle/Wide Dependency ï¼‰
<ul>
<li>å­ RDD åˆ†åŒºä¾èµ–çˆ¶ RDD çš„æ‰€æœ‰åˆ†åŒº</li>
<li>å­ RDD å¦‚æœéƒ¨åˆ†æˆ–å…¨éƒ¨åˆ†åŒºæ•°æ®ä¸¢å¤±æˆ–æŸåï¼Œå¿…é¡»ä»æ‰€æœ‰çˆ¶ RDD åˆ†åŒºé‡æ–°è®¡ç®—</li>
<li>ç›¸å¯¹äºçª„ä¾èµ–ï¼Œå®½ä¾èµ–ä»˜å‡ºçš„ä»£ä»·è¦é«˜å¾ˆå¤šï¼Œå°½é‡é¿å…ä½¿ç”¨</li>
<li>ä¾‹å¦‚ï¼šgroupByKeyã€reduceByKeyã€sortByKey</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>bigdata</category>
      </categories>
      <tags>
        <tag>bigdata</tag>
      </tags>
  </entry>
  <entry>
    <title>ç³»ç»ŸåŸç†é¢è¯•é¢˜</title>
    <url>/blog/design/theory/system-theory-interview/</url>
    <content><![CDATA[<h1 id="ç³»ç»ŸåŸç†é¢è¯•é¢˜"><a class="markdownIt-Anchor" href="#ç³»ç»ŸåŸç†é¢è¯•é¢˜"></a> ç³»ç»ŸåŸç†é¢è¯•é¢˜</h1>
<h2 id="1-åˆ†å¸ƒå¼ç¼“å­˜"><a class="markdownIt-Anchor" href="#1-åˆ†å¸ƒå¼ç¼“å­˜"></a> 1. åˆ†å¸ƒå¼ç¼“å­˜</h2>
<h3 id="11-redis-æœ‰ä»€ä¹ˆæ•°æ®ç±»å‹åˆ†åˆ«ç”¨äºä»€ä¹ˆåœºæ™¯"><a class="markdownIt-Anchor" href="#11-redis-æœ‰ä»€ä¹ˆæ•°æ®ç±»å‹åˆ†åˆ«ç”¨äºä»€ä¹ˆåœºæ™¯"></a> 1.1. Redis æœ‰ä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿåˆ†åˆ«ç”¨äºä»€ä¹ˆåœºæ™¯</h3>
<table>
<thead>
<tr>
<th>æ•°æ®ç±»å‹</th>
<th>å¯ä»¥å­˜å‚¨çš„å€¼</th>
<th>æ“ä½œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING</td>
<td>å­—ç¬¦ä¸²ã€æ•´æ•°æˆ–è€…æµ®ç‚¹æ•°</td>
<td>å¯¹æ•´ä¸ªå­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦ä¸²çš„å…¶ä¸­ä¸€éƒ¨åˆ†æ‰§è¡Œæ“ä½œ</br> å¯¹æ•´æ•°å’Œæµ®ç‚¹æ•°æ‰§è¡Œè‡ªå¢æˆ–è€…è‡ªå‡æ“ä½œ</td>
</tr>
<tr>
<td>LIST</td>
<td>åˆ—è¡¨</td>
<td>ä»ä¸¤ç«¯å‹å…¥æˆ–è€…å¼¹å‡ºå…ƒç´ </br> è¯»å–å•ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ </br> è¿›è¡Œä¿®å‰ªï¼Œåªä¿ç•™ä¸€ä¸ªèŒƒå›´å†…çš„å…ƒç´ </td>
</tr>
<tr>
<td>SET</td>
<td>æ— åºé›†åˆ</td>
<td>æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªå…ƒç´ </br> æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­</br> è®¡ç®—äº¤é›†ã€å¹¶é›†ã€å·®é›†</br> ä»é›†åˆé‡Œé¢éšæœºè·å–å…ƒç´ </td>
</tr>
<tr>
<td>HASH</td>
<td>åŒ…å«é”®å€¼å¯¹çš„æ— åºæ•£åˆ—è¡¨</td>
<td>æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªé”®å€¼å¯¹</br> è·å–æ‰€æœ‰é”®å€¼å¯¹</br> æ£€æŸ¥æŸä¸ªé”®æ˜¯å¦å­˜åœ¨</td>
</tr>
<tr>
<td>ZSET</td>
<td>æœ‰åºé›†åˆ</td>
<td>æ·»åŠ ã€è·å–ã€åˆ é™¤å…ƒç´ </br> æ ¹æ®åˆ†å€¼èŒƒå›´æˆ–è€…æˆå‘˜æ¥è·å–å…ƒç´ </br> è®¡ç®—ä¸€ä¸ªé”®çš„æ’å</td>
</tr>
</tbody>
</table>
<blockquote>
<p><a href="https://redislabs.com/ebook/part-1-getting-started/chapter-1-getting-to-know-redis/1-2-what-redis-data-structures-look-like/" target="_blank" rel="noopener">What Redis data structures look like</a></p>
</blockquote>
<h3 id="12-redis-çš„ä¸»ä»å¤åˆ¶æ˜¯å¦‚ä½•å®ç°çš„"><a class="markdownIt-Anchor" href="#12-redis-çš„ä¸»ä»å¤åˆ¶æ˜¯å¦‚ä½•å®ç°çš„"></a> 1.2. Redis çš„ä¸»ä»å¤åˆ¶æ˜¯å¦‚ä½•å®ç°çš„</h3>
<ol>
<li>ä»æœåŠ¡å™¨è¿æ¥ä¸»æœåŠ¡å™¨ï¼Œå‘é€ SYNC å‘½ä»¤ï¼›</li>
<li>ä¸»æœåŠ¡å™¨æ¥æ”¶åˆ° SYNC å‘½ååï¼Œå¼€å§‹æ‰§è¡Œ BGSAVE å‘½ä»¤ç”Ÿæˆ RDB æ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ï¼›</li>
<li>ä¸»æœåŠ¡å™¨ BGSAVE æ‰§è¡Œå®Œåï¼Œå‘æ‰€æœ‰ä»æœåŠ¡å™¨å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ï¼›</li>
<li>ä»æœåŠ¡å™¨æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§ï¼›</li>
<li>ä¸»æœåŠ¡å™¨å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»æœåŠ¡å™¨å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ï¼›</li>
<li>ä»æœåŠ¡å™¨å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»æœåŠ¡å™¨ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼›</li>
</ol>
<h3 id="13-redis-çš„-key-æ˜¯å¦‚ä½•å¯»å€çš„"><a class="markdownIt-Anchor" href="#13-redis-çš„-key-æ˜¯å¦‚ä½•å¯»å€çš„"></a> 1.3. Redis çš„ key æ˜¯å¦‚ä½•å¯»å€çš„</h3>
<h4 id="131-èƒŒæ™¯"><a class="markdownIt-Anchor" href="#131-èƒŒæ™¯"></a> 1.3.1. èƒŒæ™¯</h4>
<p>ï¼ˆ1ï¼‰redis ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®åº“ï¼Œéƒ½ç”±ä¸€ä¸ª redisDb çš„ç»“æ„å­˜å‚¨ã€‚å…¶ä¸­ï¼š</p>
<ul>
<li><a href="http://redisDb.id" target="_blank" rel="noopener">redisDb.id</a> å­˜å‚¨ç€ redis æ•°æ®åº“ä»¥æ•´æ•°è¡¨ç¤ºçš„å·ç ã€‚</li>
<li>redisDb.dict å­˜å‚¨ç€è¯¥åº“æ‰€æœ‰çš„é”®å€¼å¯¹æ•°æ®ã€‚</li>
<li>redisDb.expires ä¿å­˜ç€æ¯ä¸€ä¸ªé”®çš„è¿‡æœŸæ—¶é—´ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰å½“ redis æœåŠ¡å™¨åˆå§‹åŒ–æ—¶ï¼Œä¼šé¢„å…ˆåˆ†é… 16 ä¸ªæ•°æ®åº“ï¼ˆè¯¥æ•°é‡å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®ï¼‰ï¼Œæ‰€æœ‰æ•°æ®åº“ä¿å­˜åˆ°ç»“æ„ redisServer çš„ä¸€ä¸ªæˆå‘˜ redisServer.db æ•°ç»„ä¸­ã€‚å½“æˆ‘ä»¬é€‰æ‹©æ•°æ®åº“ select number æ—¶ï¼Œç¨‹åºç›´æ¥é€šè¿‡ redisServer.db[number] æ¥åˆ‡æ¢æ•°æ®åº“ã€‚æœ‰æ—¶å€™å½“ç¨‹åºéœ€è¦çŸ¥é“è‡ªå·±æ˜¯åœ¨å“ªä¸ªæ•°æ®åº“æ—¶ï¼Œç›´æ¥è¯»å– <a href="http://redisDb.id" target="_blank" rel="noopener">redisDb.id</a> å³å¯ã€‚</p>
<p>ï¼ˆ3ï¼‰redis çš„å­—å…¸ä½¿ç”¨å“ˆå¸Œè¡¨ä½œä¸ºå…¶åº•å±‚å®ç°ã€‚dict ç±»å‹ä½¿ç”¨çš„ä¸¤ä¸ªæŒ‡å‘å“ˆå¸Œè¡¨çš„æŒ‡é’ˆï¼Œå…¶ä¸­ 0 å·å“ˆå¸Œè¡¨ï¼ˆht[0]ï¼‰ä¸»è¦ç”¨äºå­˜å‚¨æ•°æ®åº“çš„æ‰€æœ‰é”®å€¼ï¼Œè€Œ 1 å·å“ˆå¸Œè¡¨ä¸»è¦ç”¨äºç¨‹åºå¯¹ 0 å·å“ˆå¸Œè¡¨è¿›è¡Œ rehash æ—¶ä½¿ç”¨ï¼Œrehash ä¸€èˆ¬æ˜¯åœ¨æ·»åŠ æ–°å€¼æ—¶ä¼šè§¦å‘ï¼Œè¿™é‡Œä¸åšè¿‡å¤šçš„èµ˜è¿°ã€‚æ‰€ä»¥ redis ä¸­æŸ¥æ‰¾ä¸€ä¸ª keyï¼Œå…¶å®å°±æ˜¯å¯¹è¿›è¡Œè¯¥ dict ç»“æ„ä¸­çš„ ht[0] è¿›è¡ŒæŸ¥æ‰¾æ“ä½œã€‚</p>
<p>ï¼ˆ4ï¼‰æ—¢ç„¶æ˜¯å“ˆå¸Œï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“å°±ä¼šæœ‰å“ˆå¸Œç¢°æ’ï¼Œé‚£ä¹ˆå½“å¤šä¸ªé”®å“ˆå¸Œä¹‹åä¸ºåŒä¸€ä¸ªå€¼æ€ä¹ˆåŠå‘¢ï¼Ÿredis é‡‡å–é“¾è¡¨çš„æ–¹å¼æ¥å­˜å‚¨å¤šä¸ªå“ˆå¸Œç¢°æ’çš„é”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ ¹æ® key çš„å“ˆå¸Œå€¼æ‰¾åˆ°è¯¥åˆ—è¡¨åï¼Œå¦‚æœåˆ—è¡¨çš„é•¿åº¦å¤§äº 1ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦éå†è¯¥é“¾è¡¨æ¥æ‰¾åˆ°æˆ‘ä»¬æ‰€æŸ¥æ‰¾çš„ keyã€‚å½“ç„¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹é“¾è¡¨é•¿åº¦éƒ½ä¸ºæ˜¯ 1ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦å¯çœ‹ä½œ o(1)ã€‚</p>
<h4 id="132-å¯»å€-key-çš„æ­¥éª¤"><a class="markdownIt-Anchor" href="#132-å¯»å€-key-çš„æ­¥éª¤"></a> 1.3.2. å¯»å€ key çš„æ­¥éª¤</h4>
<ol>
<li>å½“æ‹¿åˆ°ä¸€ä¸ª key åï¼Œredis å…ˆåˆ¤æ–­å½“å‰åº“çš„ 0 å·å“ˆå¸Œè¡¨æ˜¯å¦ä¸ºç©ºï¼Œå³ï¼šif (dict-&gt;ht[0].size == 0)ã€‚å¦‚æœä¸º true ç›´æ¥è¿”å› NULLã€‚</li>
<li>åˆ¤æ–­è¯¥ 0 å·å“ˆå¸Œè¡¨æ˜¯å¦éœ€è¦ rehashï¼Œå› ä¸ºå¦‚æœåœ¨è¿›è¡Œ rehashï¼Œé‚£ä¹ˆä¸¤ä¸ªè¡¨ä¸­è€…æœ‰å¯èƒ½å­˜å‚¨è¯¥ keyã€‚å¦‚æœæ­£åœ¨è¿›è¡Œ rehashï¼Œå°†è°ƒç”¨ä¸€æ¬¡<code>_dictRehashStep</code> æ–¹æ³•ï¼Œ<code>_dictRehashStep</code> ç”¨äºå¯¹æ•°æ®åº“å­—å…¸ã€ä»¥åŠå“ˆå¸Œé”®çš„å­—å…¸è¿›è¡Œè¢«åŠ¨ rehashï¼Œè¿™é‡Œä¸ä½œèµ˜è¿°ã€‚</li>
<li>è®¡ç®—å“ˆå¸Œè¡¨ï¼Œæ ¹æ®å½“å‰å­—å…¸ä¸ key è¿›è¡Œå“ˆå¸Œå€¼çš„è®¡ç®—ã€‚</li>
<li>æ ¹æ®å“ˆå¸Œå€¼ä¸å½“å‰å­—å…¸è®¡ç®—å“ˆå¸Œè¡¨çš„ç´¢å¼•å€¼ã€‚</li>
<li>æ ¹æ®ç´¢å¼•å€¼åœ¨å“ˆå¸Œè¡¨ä¸­å–å‡ºé“¾è¡¨ï¼Œéå†è¯¥é“¾è¡¨æ‰¾åˆ° key çš„ä½ç½®ã€‚ä¸€èˆ¬æƒ…å†µï¼Œè¯¥é“¾è¡¨é•¿åº¦ä¸º 1ã€‚</li>
<li>å½“ ht[0] æŸ¥æ‰¾å®Œäº†ä¹‹åï¼Œå†è¿›è¡Œäº†æ¬¡ rehash åˆ¤æ–­ï¼Œå¦‚æœæœªåœ¨ rehashingï¼Œåˆ™ç›´æ¥ç»“æŸï¼Œå¦åˆ™å¯¹ ht[1]é‡å¤ 345 æ­¥éª¤ã€‚</li>
</ol>
<h3 id="14-redis-çš„é›†ç¾¤æ¨¡å¼æ˜¯å¦‚ä½•å®ç°çš„"><a class="markdownIt-Anchor" href="#14-redis-çš„é›†ç¾¤æ¨¡å¼æ˜¯å¦‚ä½•å®ç°çš„"></a> 1.4. Redis çš„é›†ç¾¤æ¨¡å¼æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h3>
<p>Redis Cluster æ˜¯ Redis çš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆï¼Œåœ¨ Redis 3.0 ç‰ˆæœ¬æ­£å¼æ¨å‡ºçš„ã€‚</p>
<p>Redis Cluster å»ä¸­å¿ƒåŒ–ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜æ•°æ®å’Œæ•´ä¸ªé›†ç¾¤çŠ¶æ€ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è¿æ¥ã€‚</p>
<h4 id="141-redis-cluster-èŠ‚ç‚¹åˆ†é…"><a class="markdownIt-Anchor" href="#141-redis-cluster-èŠ‚ç‚¹åˆ†é…"></a> 1.4.1. Redis Cluster èŠ‚ç‚¹åˆ†é…</h4>
<p>Redis Cluster ç‰¹ç‚¹ï¼š</p>
<ol>
<li>æ‰€æœ‰çš„ redis èŠ‚ç‚¹å½¼æ­¤äº’è”(PING-PONG æœºåˆ¶)ï¼Œå†…éƒ¨ä½¿ç”¨äºŒè¿›åˆ¶åè®®ä¼˜åŒ–ä¼ è¾“é€Ÿåº¦å’Œå¸¦å®½ã€‚</li>
<li>èŠ‚ç‚¹çš„ fail æ˜¯é€šè¿‡é›†ç¾¤ä¸­è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹æ£€æµ‹å¤±æ•ˆæ—¶æ‰ç”Ÿæ•ˆã€‚</li>
<li>å®¢æˆ·ç«¯ä¸ redis èŠ‚ç‚¹ç›´è¿,ä¸éœ€è¦ä¸­é—´ proxy å±‚ã€‚å®¢æˆ·ç«¯ä¸éœ€è¦è¿æ¥é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¿æ¥é›†ç¾¤ä¸­ä»»ä½•ä¸€ä¸ªå¯ç”¨èŠ‚ç‚¹å³å¯ã€‚</li>
<li>redis-cluster æŠŠæ‰€æœ‰çš„ç‰©ç†èŠ‚ç‚¹æ˜ å°„åˆ°[0-16383] å“ˆå¸Œæ§½ (hash slot)ä¸Šï¼ˆä¸ä¸€å®šæ˜¯å¹³å‡åˆ†é…ï¼‰,cluster è´Ÿè´£ç»´æŠ¤ node&lt;-&gt;slot&lt;-&gt;valueã€‚</li>
<li>Redis é›†ç¾¤é¢„åˆ†å¥½ 16384 ä¸ªæ¡¶ï¼Œå½“éœ€è¦åœ¨ Redis é›†ç¾¤ä¸­æ”¾ç½®ä¸€ä¸ª key-value æ—¶ï¼Œæ ¹æ® CRC16(key) mod 16384 çš„å€¼ï¼Œå†³å®šå°†ä¸€ä¸ª key æ”¾åˆ°å“ªä¸ªæ¡¶ä¸­ã€‚</li>
</ol>
<h4 id="142-redis-cluster-ä¸»ä»æ¨¡å¼"><a class="markdownIt-Anchor" href="#142-redis-cluster-ä¸»ä»æ¨¡å¼"></a> 1.4.2. Redis Cluster ä¸»ä»æ¨¡å¼</h4>
<p>Redis Cluster ä¸ºäº†ä¿è¯æ•°æ®çš„é«˜å¯ç”¨æ€§ï¼ŒåŠ å…¥äº†ä¸»ä»æ¨¡å¼ã€‚</p>
<p>ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªä»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹æä¾›æ•°æ®å­˜å–ï¼Œä»èŠ‚ç‚¹åˆ™æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–æ•°æ®å¤‡ä»½ã€‚å½“è¿™ä¸ªä¸»èŠ‚ç‚¹æŒ‚æ‰åï¼Œå°±ä¼šæœ‰è¿™ä¸ªä»èŠ‚ç‚¹é€‰å–ä¸€ä¸ªæ¥å……å½“ä¸»èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯é›†ç¾¤ä¸ä¼šæŒ‚æ‰ã€‚æ‰€ä»¥ï¼Œåœ¨é›†ç¾¤å»ºç«‹çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¸ºæ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æ·»åŠ äº†ä»èŠ‚ç‚¹ã€‚</p>
<h4 id="143-redis-sentinel"><a class="markdownIt-Anchor" href="#143-redis-sentinel"></a> 1.4.3. Redis Sentinel</h4>
<p>Redis Sentinel ç”¨äºç®¡ç†å¤šä¸ª Redis æœåŠ¡å™¨ï¼Œå®ƒæœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li><strong>ç›‘æ§ï¼ˆMonitoringï¼‰</strong> - Sentinel ä¼šä¸æ–­åœ°æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li>
<li><strong>æé†’ï¼ˆNotificationï¼‰</strong> - å½“è¢«ç›‘æ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œ Sentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚</li>
<li><strong>è‡ªåŠ¨æ•…éšœè¿ç§»ï¼ˆAutomatic failoverï¼‰</strong> - å½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œ Sentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œ å®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œ å¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä»–ä»æœåŠ¡å™¨æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»æœåŠ¡å™¨ï¼› å½“å®¢æˆ·ç«¯è¯•å›¾è¿æ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œ é›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›æ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œ ä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨ä»£æ›¿å¤±æ•ˆæœåŠ¡å™¨ã€‚</li>
</ul>
<p>Redis é›†ç¾¤ä¸­åº”è¯¥æœ‰å¥‡æ•°ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥è‡³å°‘æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ã€‚</p>
<p>å“¨å…µç›‘æ§é›†ç¾¤ä¸­çš„ä¸»æœåŠ¡å™¨å‡ºç°æ•…éšœæ—¶ï¼Œéœ€è¦æ ¹æ® quorum é€‰ä¸¾å‡ºä¸€ä¸ªå“¨å…µæ¥æ‰§è¡Œæ•…éšœè½¬ç§»ã€‚é€‰ä¸¾éœ€è¦ majorityï¼Œå³å¤§å¤šæ•°å“¨å…µæ˜¯è¿è¡Œçš„ï¼ˆ2 ä¸ªå“¨å…µçš„ majority=2ï¼Œ3 ä¸ªå“¨å…µçš„ majority=2ï¼Œ5 ä¸ªå“¨å…µçš„ majority=3ï¼Œ4 ä¸ªå“¨å…µçš„ majority=2ï¼‰ã€‚</p>
<p>å‡è®¾é›†ç¾¤ä»…ä»…éƒ¨ç½² 2 ä¸ªèŠ‚ç‚¹</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">+----+         +----+</span><br><span class="line">|<span class="string"> M1 </span>|<span class="string">---------</span>|<span class="string"> R1 </span>|</span><br><span class="line">|<span class="string"> S1 </span>|<span class="string">         </span>|<span class="string"> S2 </span>|</span><br><span class="line">+----+         +----+</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ M1 å’Œ S1 æ‰€åœ¨æœåŠ¡å™¨å®•æœºï¼Œåˆ™å“¨å…µåªæœ‰ 1 ä¸ªï¼Œæ— æ³•æ»¡è¶³ majority æ¥è¿›è¡Œé€‰ä¸¾ï¼Œå°±ä¸èƒ½æ‰§è¡Œæ•…éšœè½¬ç§»ã€‚</p>
<h3 id="15-redis-å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”zookeeper-å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”æ¯”è¾ƒäºŒè€…ä¼˜åŠ£"><a class="markdownIt-Anchor" href="#15-redis-å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”zookeeper-å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”æ¯”è¾ƒäºŒè€…ä¼˜åŠ£"></a> 1.5. Redis å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼ŸZooKeeper å¦‚ä½•å®ç°åˆ†å¸ƒå¼é”ï¼Ÿæ¯”è¾ƒäºŒè€…ä¼˜åŠ£ï¼Ÿ</h3>
<p>åˆ†å¸ƒå¼é”çš„ä¸‰ç§å®ç°ï¼š</p>
<ul>
<li>åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ï¼›</li>
<li>åŸºäºç¼“å­˜ï¼ˆRedis ç­‰ï¼‰å®ç°åˆ†å¸ƒå¼é”ï¼›</li>
<li>åŸºäº Zookeeper å®ç°åˆ†å¸ƒå¼é”ï¼›</li>
</ul>
<h4 id="151-æ•°æ®åº“å®ç°"><a class="markdownIt-Anchor" href="#151-æ•°æ®åº“å®ç°"></a> 1.5.1. æ•°æ®åº“å®ç°</h4>
<h4 id="152-redis-å®ç°"><a class="markdownIt-Anchor" href="#152-redis-å®ç°"></a> 1.5.2. Redis å®ç°</h4>
<ol>
<li>è·å–é”çš„æ—¶å€™ï¼Œä½¿ç”¨ setnx åŠ é”ï¼Œå¹¶ä½¿ç”¨ expire å‘½ä»¤ä¸ºé”æ·»åŠ ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´åˆ™è‡ªåŠ¨é‡Šæ”¾é”ï¼Œé”çš„ value å€¼ä¸ºä¸€ä¸ªéšæœºç”Ÿæˆçš„ UUIDï¼Œé€šè¿‡æ­¤åœ¨é‡Šæ”¾é”çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­ã€‚</li>
<li>è·å–é”çš„æ—¶å€™è¿˜è®¾ç½®ä¸€ä¸ªè·å–çš„è¶…æ—¶æ—¶é—´ï¼Œè‹¥è¶…è¿‡è¿™ä¸ªæ—¶é—´åˆ™æ”¾å¼ƒè·å–é”ã€‚</li>
<li>é‡Šæ”¾é”çš„æ—¶å€™ï¼Œé€šè¿‡ UUID åˆ¤æ–­æ˜¯ä¸æ˜¯è¯¥é”ï¼Œè‹¥æ˜¯è¯¥é”ï¼Œåˆ™æ‰§è¡Œ delete è¿›è¡Œé”é‡Šæ”¾ã€‚</li>
</ol>
<h4 id="153-zookeeper-å®ç°"><a class="markdownIt-Anchor" href="#153-zookeeper-å®ç°"></a> 1.5.3. ZooKeeper å®ç°</h4>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç›®å½• mylockï¼›</li>
<li>çº¿ç¨‹ A æƒ³è·å–é”å°±åœ¨ mylock ç›®å½•ä¸‹åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼›</li>
<li>è·å– mylock ç›®å½•ä¸‹æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œç„¶åè·å–æ¯”è‡ªå·±å°çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜å½“å‰çº¿ç¨‹é¡ºåºå·æœ€å°ï¼Œè·å¾—é”ï¼›</li>
<li>çº¿ç¨‹ B è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ¤æ–­è‡ªå·±ä¸æ˜¯æœ€å°èŠ‚ç‚¹ï¼Œè®¾ç½®ç›‘å¬æ¯”è‡ªå·±æ¬¡å°çš„èŠ‚ç‚¹ï¼›</li>
<li>çº¿ç¨‹ A å¤„ç†å®Œï¼Œåˆ é™¤è‡ªå·±çš„èŠ‚ç‚¹ï¼Œçº¿ç¨‹ B ç›‘å¬åˆ°å˜æ›´äº‹ä»¶ï¼Œåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯åˆ™è·å¾—é”ã€‚</li>
</ol>
<h4 id="154-å®ç°å¯¹æ¯”"><a class="markdownIt-Anchor" href="#154-å®ç°å¯¹æ¯”"></a> 1.5.4. å®ç°å¯¹æ¯”</h4>
<p>ZooKeeper å…·å¤‡é«˜å¯ç”¨ã€å¯é‡å…¥ã€é˜»å¡é”ç‰¹æ€§ï¼Œå¯è§£å†³å¤±æ•ˆæ­»é”é—®é¢˜ã€‚<br />
ä½† ZooKeeper å› ä¸ºéœ€è¦é¢‘ç¹çš„åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹ï¼Œæ€§èƒ½ä¸Šä¸å¦‚ Redis æ–¹å¼ã€‚</p>
<h3 id="16-redis-çš„æŒä¹…åŒ–æ–¹å¼æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹æŒä¹…åŒ–å®ç°åŸç†"><a class="markdownIt-Anchor" href="#16-redis-çš„æŒä¹…åŒ–æ–¹å¼æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹æŒä¹…åŒ–å®ç°åŸç†"></a> 1.6. Redis çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼ŸæŒä¹…åŒ–å®ç°åŸç†ï¼Ÿ</h3>
<h4 id="161-rdb-å¿«ç…§snapshot"><a class="markdownIt-Anchor" href="#161-rdb-å¿«ç…§snapshot"></a> 1.6.1. RDB å¿«ç…§ï¼ˆsnapshotï¼‰</h4>
<p>å°†å­˜åœ¨äºæŸä¸€æ—¶åˆ»çš„æ‰€æœ‰æ•°æ®éƒ½å†™å…¥åˆ°ç¡¬ç›˜ä¸­ã€‚</p>
<h5 id="å¿«ç…§çš„åŸç†"><a class="markdownIt-Anchor" href="#å¿«ç…§çš„åŸç†"></a> å¿«ç…§çš„åŸç†</h5>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis å°†æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œ è®©å®ƒåœ¨â€œN ç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ SAVE æˆ–è€… BGSAVEï¼Œæ‰‹åŠ¨è®© Redis è¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œã€‚è¿™ç§æŒä¹…åŒ–æ–¹å¼è¢«ç§°ä¸ºå¿«ç…§ã€‚</p>
<p>å½“ Redis éœ€è¦ä¿å­˜ dump.rdb æ–‡ä»¶æ—¶ï¼Œ æœåŠ¡å™¨æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p>
<ul>
<li>Redis åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚</li>
<li>å­è¿›ç¨‹å°†æ•°æ®é›†å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶å¿«ç…§æ–‡ä»¶ä¸­ã€‚</li>
<li>å½“å­è¿›ç¨‹å®Œæˆå¯¹æ–°å¿«ç…§æ–‡ä»¶çš„å†™å…¥æ—¶ï¼ŒRedis ç”¨æ–°å¿«ç…§æ–‡ä»¶æ›¿æ¢åŸæ¥çš„å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„å¿«ç…§æ–‡ä»¶ã€‚</li>
</ul>
<p>è¿™ç§å·¥ä½œæ–¹å¼ä½¿å¾— Redis å¯ä»¥ä»å†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰æœºåˆ¶ä¸­è·ç›Šã€‚</p>
<h5 id="å¿«ç…§çš„ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#å¿«ç…§çš„ä¼˜ç‚¹"></a> å¿«ç…§çš„ä¼˜ç‚¹</h5>
<ul>
<li>å®ƒä¿å­˜äº†æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®é›†ï¼Œéå¸¸é€‚ç”¨äºæ•°æ®é›†çš„å¤‡ä»½ã€‚</li>
<li>å¾ˆæ–¹ä¾¿ä¼ é€åˆ°å¦ä¸€ä¸ªè¿œç«¯æ•°æ®ä¸­å¿ƒæˆ–è€…äºšé©¬é€Šçš„ S3ï¼ˆå¯èƒ½åŠ å¯†ï¼‰ï¼Œéå¸¸é€‚ç”¨äºç¾éš¾æ¢å¤ã€‚</li>
<li>å¿«ç…§åœ¨ä¿å­˜ RDB æ–‡ä»¶æ—¶çˆ¶è¿›ç¨‹å”¯ä¸€éœ€è¦åšçš„å°±æ˜¯ fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ¥ä¸‹æ¥çš„å·¥ä½œå…¨éƒ¨ç”±å­è¿›ç¨‹æ¥åšï¼Œçˆ¶è¿›ç¨‹ä¸éœ€è¦å†åšå…¶ä»– IO æ“ä½œï¼Œæ‰€ä»¥å¿«ç…§æŒä¹…åŒ–æ–¹å¼å¯ä»¥æœ€å¤§åŒ– redis çš„æ€§èƒ½ã€‚</li>
<li>ä¸ AOF ç›¸æ¯”ï¼Œåœ¨æ¢å¤å¤§çš„æ•°æ®é›†çš„æ—¶å€™ï¼ŒDB æ–¹å¼ä¼šæ›´å¿«ä¸€äº›ã€‚</li>
</ul>
<h5 id="å¿«ç…§çš„ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#å¿«ç…§çš„ç¼ºç‚¹"></a> å¿«ç…§çš„ç¼ºç‚¹</h5>
<ul>
<li>å¦‚æœä½ å¸Œæœ›åœ¨ redis æ„å¤–åœæ­¢å·¥ä½œï¼ˆä¾‹å¦‚ç”µæºä¸­æ–­ï¼‰çš„æƒ…å†µä¸‹ä¸¢å¤±çš„æ•°æ®æœ€å°‘çš„è¯ï¼Œé‚£ä¹ˆå¿«ç…§ä¸é€‚åˆä½ ã€‚</li>
<li>å¿«ç…§éœ€è¦ç»å¸¸ fork å­è¿›ç¨‹æ¥ä¿å­˜æ•°æ®é›†åˆ°ç¡¬ç›˜ä¸Šã€‚å½“æ•°æ®é›†æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œfork çš„è¿‡ç¨‹æ˜¯éå¸¸è€—æ—¶çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ Redis åœ¨ä¸€äº›æ¯«ç§’çº§å†…ä¸èƒ½å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</li>
</ul>
<h4 id="162-aof"><a class="markdownIt-Anchor" href="#162-aof"></a> 1.6.2. AOF</h4>
<p>AOF æŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨æ‰§è¡Œçš„å†™æ“ä½œã€‚å½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®ã€‚</p>
<h4 id="163-aof-çš„åŸç†"><a class="markdownIt-Anchor" href="#163-aof-çš„åŸç†"></a> 1.6.3. AOF çš„åŸç†</h4>
<ul>
<li>Redis åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚</li>
<li>å­è¿›ç¨‹å¼€å§‹å°†æ–° AOF æ–‡ä»¶çš„å†…å®¹å†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶ã€‚</li>
<li>å¯¹äºæ‰€æœ‰æ–°æ‰§è¡Œçš„å†™å…¥å‘½ä»¤ï¼Œçˆ¶è¿›ç¨‹ä¸€è¾¹å°†å®ƒä»¬ç´¯ç§¯åˆ°ä¸€ä¸ªå†…å­˜ç¼“å­˜ä¸­ï¼Œä¸€è¾¹å°†è¿™äº›æ”¹åŠ¨è¿½åŠ åˆ°ç°æœ‰ AOF æ–‡ä»¶çš„æœ«å°¾ï¼Œè¿™æ ·æ ·å³ä½¿åœ¨é‡å†™çš„ä¸­é€”å‘ç”Ÿåœæœºï¼Œç°æœ‰çš„ AOF æ–‡ä»¶ä¹Ÿè¿˜æ˜¯å®‰å…¨çš„ã€‚</li>
<li>å½“å­è¿›ç¨‹å®Œæˆé‡å†™å·¥ä½œæ—¶ï¼Œå®ƒç»™çˆ¶è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œçˆ¶è¿›ç¨‹åœ¨æ¥æ”¶åˆ°ä¿¡å·ä¹‹åï¼Œå°†å†…å­˜ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚</li>
<li>æå®šï¼ç°åœ¨ Redis åŸå­åœ°ç”¨æ–°æ–‡ä»¶æ›¿æ¢æ—§æ–‡ä»¶ï¼Œä¹‹åæ‰€æœ‰å‘½ä»¤éƒ½ä¼šç›´æ¥è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚</li>
</ul>
<h4 id="164-aof-çš„ä¼˜ç‚¹"><a class="markdownIt-Anchor" href="#164-aof-çš„ä¼˜ç‚¹"></a> 1.6.4. AOF çš„ä¼˜ç‚¹</h4>
<ul>
<li>ä½¿ç”¨é»˜è®¤çš„æ¯ç§’ fsync ç­–ç•¥ï¼ŒRedis çš„æ€§èƒ½ä¾ç„¶å¾ˆå¥½(fsync æ˜¯ç”±åå°çº¿ç¨‹è¿›è¡Œå¤„ç†çš„,ä¸»çº¿ç¨‹ä¼šå°½åŠ›å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚)ï¼Œä¸€æ—¦å‡ºç°æ•…éšœï¼Œä½¿ç”¨ AOF ï¼Œä½ æœ€å¤šä¸¢å¤± 1 ç§’çš„æ•°æ®ã€‚</li>
<li>AOF æ–‡ä»¶æ˜¯ä¸€ä¸ªåªè¿›è¡Œè¿½åŠ çš„æ—¥å¿—æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸éœ€è¦å†™å…¥ seekï¼Œå³ä½¿ç”±äºæŸäº›åŸå› (ç£ç›˜ç©ºé—´å·²æ»¡ï¼Œå†™çš„è¿‡ç¨‹ä¸­å®•æœºç­‰ç­‰)æœªæ‰§è¡Œå®Œæ•´çš„å†™å…¥å‘½ä»¤ï¼Œä½ ä¹Ÿä¹Ÿå¯ä½¿ç”¨ redis-check-aof å·¥å…·ä¿®å¤è¿™äº›é—®é¢˜ã€‚</li>
<li>Redis å¯ä»¥åœ¨ AOF æ–‡ä»¶ä½“ç§¯å˜å¾—è¿‡å¤§æ—¶ï¼Œè‡ªåŠ¨åœ°åœ¨åå°å¯¹ AOF è¿›è¡Œé‡å†™ï¼šé‡å†™åçš„æ–° AOF æ–‡ä»¶åŒ…å«äº†æ¢å¤å½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°å‘½ä»¤é›†åˆã€‚æ•´ä¸ªé‡å†™æ“ä½œæ˜¯ç»å¯¹å®‰å…¨çš„ã€‚</li>
<li>AOF æ–‡ä»¶æœ‰åºåœ°ä¿å­˜äº†å¯¹æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å†™å…¥æ“ä½œï¼Œè¿™äº›å†™å…¥æ“ä½œä»¥ Redis åè®®çš„æ ¼å¼ä¿å­˜ã€‚å› æ­¤ AOF æ–‡ä»¶çš„å†…å®¹éå¸¸å®¹æ˜“è¢«äººè¯»æ‡‚ï¼Œå¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼ˆparseï¼‰ä¹Ÿå¾ˆè½»æ¾ã€‚</li>
</ul>
<h4 id="165-aof-çš„ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#165-aof-çš„ç¼ºç‚¹"></a> 1.6.5. AOF çš„ç¼ºç‚¹</h4>
<ul>
<li>å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯é€šå¸¸è¦å¤§äº RDB æ–‡ä»¶çš„ä½“ç§¯ã€‚</li>
<li>æ ¹æ®æ‰€ä½¿ç”¨çš„ fsync ç­–ç•¥ï¼ŒAOF çš„é€Ÿåº¦å¯èƒ½ä¼šæ…¢äºå¿«ç…§ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ç§’ fsync çš„æ€§èƒ½ä¾ç„¶éå¸¸é«˜ï¼Œè€Œå…³é—­ fsync å¯ä»¥è®© AOF çš„é€Ÿåº¦å’Œå¿«ç…§ä¸€æ ·å¿«ï¼Œå³ä½¿åœ¨é«˜è´Ÿè·ä¹‹ä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¸è¿‡åœ¨å¤„ç†å·¨å¤§çš„å†™å…¥è½½å…¥æ—¶ï¼Œå¿«ç…§å¯ä»¥æä¾›æ›´æœ‰ä¿è¯çš„æœ€å¤§å»¶è¿Ÿæ—¶é—´ï¼ˆlatencyï¼‰ã€‚</li>
</ul>
<h3 id="17-redis-è¿‡æœŸç­–ç•¥æœ‰å“ªäº›"><a class="markdownIt-Anchor" href="#17-redis-è¿‡æœŸç­–ç•¥æœ‰å“ªäº›"></a> 1.7. Redis è¿‡æœŸç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</h3>
<ul>
<li><strong>noeviction</strong> - å½“å†…å­˜ä½¿ç”¨è¾¾åˆ°é˜ˆå€¼çš„æ—¶å€™ï¼Œæ‰€æœ‰å¼•èµ·ç”³è¯·å†…å­˜çš„å‘½ä»¤ä¼šæŠ¥é”™ã€‚</li>
<li><strong>allkeys-lru</strong> - åœ¨ä¸»é”®ç©ºé—´ä¸­ï¼Œä¼˜å…ˆç§»é™¤æœ€è¿‘æœªä½¿ç”¨çš„ keyã€‚</li>
<li><strong>allkeys-random</strong> - åœ¨ä¸»é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ª keyã€‚</li>
<li><strong>volatile-lru</strong> - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œä¼˜å…ˆç§»é™¤æœ€è¿‘æœªä½¿ç”¨çš„ keyã€‚</li>
<li><strong>volatile-random</strong> - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ª keyã€‚</li>
<li><strong>volatile-ttl</strong> - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œå…·æœ‰æ›´æ—©è¿‡æœŸæ—¶é—´çš„ key ä¼˜å…ˆç§»é™¤ã€‚</li>
</ul>
<h3 id="18-redis-å’Œ-memcached-æœ‰ä»€ä¹ˆåŒºåˆ«"><a class="markdownIt-Anchor" href="#18-redis-å’Œ-memcached-æœ‰ä»€ä¹ˆåŒºåˆ«"></a> 1.8. Redis å’Œ Memcached æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<p>ä¸¤è€…éƒ½æ˜¯éå…³ç³»å‹å†…å­˜é”®å€¼æ•°æ®åº“ã€‚æœ‰ä»¥ä¸‹ä¸»è¦ä¸åŒï¼š</p>
<p><strong>æ•°æ®ç±»å‹</strong></p>
<ul>
<li>Memcached ä»…æ”¯æŒå­—ç¬¦ä¸²ç±»å‹ï¼›</li>
<li>è€Œ Redis æ”¯æŒäº”ç§ä¸åŒç§ç±»çš„æ•°æ®ç±»å‹ï¼Œä½¿å¾—å®ƒå¯ä»¥æ›´çµæ´»åœ°è§£å†³é—®é¢˜ã€‚</li>
</ul>
<p><strong>æ•°æ®æŒä¹…åŒ–</strong></p>
<ul>
<li>Memcached ä¸æ”¯æŒæŒä¹…åŒ–ï¼›</li>
<li>Redis æ”¯æŒä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼šRDB å¿«ç…§å’Œ AOF æ—¥å¿—ã€‚</li>
</ul>
<p><strong>åˆ†å¸ƒå¼</strong></p>
<ul>
<li>Memcached ä¸æ”¯æŒåˆ†å¸ƒå¼ï¼Œåªèƒ½é€šè¿‡åœ¨å®¢æˆ·ç«¯ä½¿ç”¨åƒä¸€è‡´æ€§å“ˆå¸Œè¿™æ ·çš„åˆ†å¸ƒå¼ç®—æ³•æ¥å®ç°åˆ†å¸ƒå¼å­˜å‚¨ï¼Œè¿™ç§æ–¹å¼åœ¨å­˜å‚¨å’ŒæŸ¥è¯¢æ—¶éƒ½éœ€è¦å…ˆåœ¨å®¢æˆ·ç«¯è®¡ç®—ä¸€æ¬¡æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚</li>
<li>Redis Cluster å®ç°äº†åˆ†å¸ƒå¼çš„æ”¯æŒã€‚</li>
</ul>
<p><strong>å†…å­˜ç®¡ç†æœºåˆ¶</strong></p>
<ul>
<li>Memcached å°†å†…å­˜åˆ†å‰²æˆç‰¹å®šé•¿åº¦çš„å—æ¥å­˜å‚¨æ•°æ®ï¼Œä»¥å®Œå…¨è§£å†³å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¼šä½¿å¾—å†…å­˜çš„åˆ©ç”¨ç‡ä¸é«˜ï¼Œä¾‹å¦‚å—çš„å¤§å°ä¸º 128 bytesï¼Œåªå­˜å‚¨ 100 bytes çš„æ•°æ®ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ 28 bytes å°±æµªè´¹æ‰äº†ã€‚</li>
<li>åœ¨ Redis ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æ•°æ®éƒ½ä¸€ç›´å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥å°†ä¸€äº›å¾ˆä¹…æ²¡ç”¨çš„ value äº¤æ¢åˆ°ç£ç›˜ã€‚è€Œ Memcached çš„æ•°æ®åˆ™ä¼šä¸€ç›´åœ¨å†…å­˜ä¸­ã€‚</li>
</ul>
<h3 id="19-ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„-redis-æ€§èƒ½åè€Œä¼˜äºå¤šçº¿ç¨‹çš„-memcached"><a class="markdownIt-Anchor" href="#19-ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„-redis-æ€§èƒ½åè€Œä¼˜äºå¤šçº¿ç¨‹çš„-memcached"></a> 1.9. ä¸ºä»€ä¹ˆå•çº¿ç¨‹çš„ Redis æ€§èƒ½åè€Œä¼˜äºå¤šçº¿ç¨‹çš„ Memcachedï¼Ÿ</h3>
<p>Redis å¿«é€Ÿçš„åŸå› ï¼š</p>
<ol>
<li>ç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼ˆéå¸¸å¿«é€Ÿï¼‰</li>
<li>é‡‡ç”¨å•çº¿ç¨‹,é¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶</li>
<li>éé˜»å¡ IO</li>
</ol>
<p>å†…éƒ¨å®ç°é‡‡ç”¨ epollï¼Œé‡‡ç”¨äº† epoll+è‡ªå·±å®ç°çš„ç®€å•çš„äº‹ä»¶æ¡†æ¶ã€‚epoll ä¸­çš„è¯»ã€å†™ã€å…³é—­ã€è¿æ¥éƒ½è½¬åŒ–æˆäº†äº‹ä»¶ï¼Œç„¶ååˆ©ç”¨ epoll çš„å¤šè·¯å¤ç”¨ç‰¹æ€§ï¼Œç»ä¸åœ¨ io ä¸Šæµªè´¹ä¸€ç‚¹æ—¶é—´ã€‚</p>
<h2 id="2-åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—mq"><a class="markdownIt-Anchor" href="#2-åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—mq"></a> 2. åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰</h2>
<h3 id="21-ä¸ºä»€ä¹ˆä½¿ç”¨-mq"><a class="markdownIt-Anchor" href="#21-ä¸ºä»€ä¹ˆä½¿ç”¨-mq"></a> 2.1. ä¸ºä»€ä¹ˆä½¿ç”¨ MQï¼Ÿ</h3>
<ul>
<li>å¼‚æ­¥å¤„ç† - ç›¸æ¯”äºä¼ ç»Ÿçš„ä¸²è¡Œã€å¹¶è¡Œæ–¹å¼ï¼Œæé«˜äº†ç³»ç»Ÿååé‡ã€‚</li>
<li>åº”ç”¨è§£è€¦ - ç³»ç»Ÿé—´é€šè¿‡æ¶ˆæ¯é€šä¿¡ï¼Œä¸ç”¨å…³å¿ƒå…¶ä»–ç³»ç»Ÿçš„å¤„ç†ã€‚</li>
<li>æµé‡å‰Šé”‹ - å¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—é•¿åº¦æ§åˆ¶è¯·æ±‚é‡ï¼›å¯ä»¥ç¼“è§£çŸ­æ—¶é—´å†…çš„é«˜å¹¶å‘è¯·æ±‚ã€‚</li>
<li>æ—¥å¿—å¤„ç† - è§£å†³å¤§é‡æ—¥å¿—ä¼ è¾“ã€‚</li>
<li>æ¶ˆæ¯é€šè®¯ - æ¶ˆæ¯é˜Ÿåˆ—ä¸€èˆ¬éƒ½å†…ç½®äº†é«˜æ•ˆçš„é€šä¿¡æœºåˆ¶ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ç”¨åœ¨çº¯çš„æ¶ˆæ¯é€šè®¯ã€‚æ¯”å¦‚å®ç°ç‚¹å¯¹ç‚¹æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæˆ–è€…èŠå¤©å®¤ç­‰ã€‚</li>
</ul>
<h3 id="22-å¦‚ä½•ä¿è¯-mq-çš„é«˜å¯ç”¨"><a class="markdownIt-Anchor" href="#22-å¦‚ä½•ä¿è¯-mq-çš„é«˜å¯ç”¨"></a> 2.2. å¦‚ä½•ä¿è¯ MQ çš„é«˜å¯ç”¨ï¼Ÿ</h3>
<h4 id="221-æ•°æ®å¤åˆ¶"><a class="markdownIt-Anchor" href="#221-æ•°æ®å¤åˆ¶"></a> 2.2.1. æ•°æ®å¤åˆ¶</h4>
<ol>
<li>å°†æ‰€æœ‰ Broker å’Œå¾…åˆ†é…çš„ Partition æ’åº</li>
<li>å°†ç¬¬ i ä¸ª Partition åˆ†é…åˆ°ç¬¬ï¼ˆi mod nï¼‰ä¸ª Broker ä¸Š</li>
<li>å°†ç¬¬ i ä¸ª Partition çš„ç¬¬ j ä¸ª Replica åˆ†é…åˆ°ç¬¬ï¼ˆ(i + j) mode nï¼‰ä¸ª Broker ä¸Š</li>
</ol>
<h4 id="222-é€‰ä¸¾ä¸»æœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#222-é€‰ä¸¾ä¸»æœåŠ¡å™¨"></a> 2.2.2. é€‰ä¸¾ä¸»æœåŠ¡å™¨</h4>
<h3 id="23-mq-æœ‰å“ªäº›å¸¸è§é—®é¢˜å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜"><a class="markdownIt-Anchor" href="#23-mq-æœ‰å“ªäº›å¸¸è§é—®é¢˜å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜"></a> 2.3. MQ æœ‰å“ªäº›å¸¸è§é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Ÿ</h3>
<p>MQ çš„å¸¸è§é—®é¢˜æœ‰ï¼š</p>
<ol>
<li>æ¶ˆæ¯çš„é¡ºåºé—®é¢˜</li>
<li>æ¶ˆæ¯çš„é‡å¤é—®é¢˜</li>
</ol>
<h4 id="231-æ¶ˆæ¯çš„é¡ºåºé—®é¢˜"><a class="markdownIt-Anchor" href="#231-æ¶ˆæ¯çš„é¡ºåºé—®é¢˜"></a> 2.3.1. æ¶ˆæ¯çš„é¡ºåºé—®é¢˜</h4>
<p>æ¶ˆæ¯æœ‰åºæŒ‡çš„æ˜¯å¯ä»¥æŒ‰ç…§æ¶ˆæ¯çš„å‘é€é¡ºåºæ¥æ¶ˆè´¹ã€‚</p>
<p>å‡å¦‚ç”Ÿäº§è€…äº§ç”Ÿäº† 2 æ¡æ¶ˆæ¯ï¼šM1ã€M2ï¼Œå‡å®š M1 å‘é€åˆ° S1ï¼ŒM2 å‘é€åˆ° S2ï¼Œå¦‚æœè¦ä¿è¯ M1 å…ˆäº M2 è¢«æ¶ˆè´¹ï¼Œæ€ä¹ˆåšï¼Ÿ</p>
<div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-23145c8b554a0f2f.jpg"/></div>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>ï¼ˆ1ï¼‰ä¿è¯ç”Ÿäº§è€… - MQServer - æ¶ˆè´¹è€…æ˜¯ä¸€å¯¹ä¸€å¯¹ä¸€çš„å…³ç³»</p>
<div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-034106d7e04c062d.jpg"/></div>
<p>ç¼ºé™·ï¼š</p>
<ul>
<li>å¹¶è¡Œåº¦å°±ä¼šæˆä¸ºæ¶ˆæ¯ç³»ç»Ÿçš„ç“¶é¢ˆï¼ˆååé‡ä¸å¤Ÿï¼‰</li>
<li>æ›´å¤šçš„å¼‚å¸¸å¤„ç†ï¼Œæ¯”å¦‚ï¼šåªè¦æ¶ˆè´¹ç«¯å‡ºç°é—®é¢˜ï¼Œå°±ä¼šå¯¼è‡´æ•´ä¸ªå¤„ç†æµç¨‹é˜»å¡ï¼Œæˆ‘ä»¬ä¸å¾—ä¸èŠ±è´¹æ›´å¤šçš„ç²¾åŠ›æ¥è§£å†³é˜»å¡çš„é—®é¢˜ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰é€šè¿‡åˆç†çš„è®¾è®¡æˆ–è€…å°†é—®é¢˜åˆ†è§£æ¥è§„é¿ã€‚</p>
<ul>
<li>ä¸å…³æ³¨ä¹±åºçš„åº”ç”¨å®é™…å¤§é‡å­˜åœ¨</li>
<li>é˜Ÿåˆ—æ— åºå¹¶ä¸æ„å‘³ç€æ¶ˆæ¯æ— åº</li>
</ul>
<p>æ‰€ä»¥ä»ä¸šåŠ¡å±‚é¢æ¥ä¿è¯æ¶ˆæ¯çš„é¡ºåºè€Œä¸ä»…ä»…æ˜¯ä¾èµ–äºæ¶ˆæ¯ç³»ç»Ÿï¼Œæ˜¯ä¸€ç§æ›´åˆç†çš„æ–¹å¼ã€‚</p>
<h4 id="232-æ¶ˆæ¯çš„é‡å¤é—®é¢˜"><a class="markdownIt-Anchor" href="#232-æ¶ˆæ¯çš„é‡å¤é—®é¢˜"></a> 2.3.2. æ¶ˆæ¯çš„é‡å¤é—®é¢˜</h4>
<p>é€ æˆæ¶ˆæ¯é‡å¤çš„æ ¹æœ¬åŸå› æ˜¯ï¼šç½‘ç»œä¸å¯è¾¾ã€‚</p>
<p>æ‰€ä»¥è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•å°±æ˜¯ç»•è¿‡è¿™ä¸ªé—®é¢˜ã€‚é‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†ï¼šå¦‚æœæ¶ˆè´¹ç«¯æ”¶åˆ°ä¸¤æ¡ä¸€æ ·çš„æ¶ˆæ¯ï¼Œåº”è¯¥æ€æ ·å¤„ç†ï¼Ÿ</p>
<p>æ¶ˆè´¹ç«¯å¤„ç†æ¶ˆæ¯çš„ä¸šåŠ¡é€»è¾‘ä¿æŒå¹‚ç­‰æ€§ã€‚åªè¦ä¿æŒå¹‚ç­‰æ€§ï¼Œä¸ç®¡æ¥å¤šå°‘æ¡é‡å¤æ¶ˆæ¯ï¼Œæœ€åå¤„ç†çš„ç»“æœéƒ½ä¸€æ ·ã€‚<br />
ä¿è¯æ¯æ¡æ¶ˆæ¯éƒ½æœ‰å”¯ä¸€ç¼–å·ä¸”ä¿è¯æ¶ˆæ¯å¤„ç†æˆåŠŸä¸å»é‡è¡¨çš„æ—¥å¿—åŒæ—¶å‡ºç°ã€‚åˆ©ç”¨ä¸€å¼ æ—¥å¿—è¡¨æ¥è®°å½•å·²ç»å¤„ç†æˆåŠŸçš„æ¶ˆæ¯çš„ IDï¼Œå¦‚æœæ–°åˆ°çš„æ¶ˆæ¯ ID å·²ç»åœ¨æ—¥å¿—è¡¨ä¸­ï¼Œé‚£ä¹ˆå°±ä¸å†å¤„ç†è¿™æ¡æ¶ˆæ¯ã€‚</p>
<h3 id="24-kafka-activemq-rabbitmq-rocketmq-å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#24-kafka-activemq-rabbitmq-rocketmq-å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹"></a> 2.4. Kafka, ActiveMQ, RabbitMQ, RocketMQ å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h3>
<div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-c26f4a3048c38af4.jpg"/></div>
<h2 id="3-åˆ†å¸ƒå¼æœåŠ¡rpc"><a class="markdownIt-Anchor" href="#3-åˆ†å¸ƒå¼æœåŠ¡rpc"></a> 3. åˆ†å¸ƒå¼æœåŠ¡ï¼ˆRPCï¼‰</h2>
<h3 id="31-dubbo-çš„å®ç°è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#31-dubbo-çš„å®ç°è¿‡ç¨‹"></a> 3.1. Dubbo çš„å®ç°è¿‡ç¨‹ï¼Ÿ</h3>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/distributed/rpc/dubbo/dubboåŸºæœ¬æ¶æ„.png!zp" width="500"/>
</div>
<p>èŠ‚ç‚¹è§’è‰²ï¼š</p>
<table>
<thead>
<tr>
<th>èŠ‚ç‚¹</th>
<th>è§’è‰²è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Provider</td>
<td>æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹</td>
</tr>
<tr>
<td>Consumer</td>
<td>è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹</td>
</tr>
<tr>
<td>Registry</td>
<td>æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒ</td>
</tr>
<tr>
<td>Monitor</td>
<td>ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒ</td>
</tr>
<tr>
<td>Container</td>
<td>æœåŠ¡è¿è¡Œå®¹å™¨</td>
</tr>
</tbody>
</table>
<p>è°ƒç”¨å…³ç³»ï¼š</p>
<ol>
<li>åŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</li>
<li>æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</li>
<li>æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</li>
<li>æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</li>
</ol>
<h3 id="32-dubbo-è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å“ªäº›"><a class="markdownIt-Anchor" href="#32-dubbo-è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å“ªäº›"></a> 3.2. Dubbo è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</h3>
<h5 id="random"><a class="markdownIt-Anchor" href="#random"></a> Random</h5>
<ul>
<li>éšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ã€‚</li>
<li>åœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼Œæœ‰åˆ©äºåŠ¨æ€è°ƒæ•´æä¾›è€…æƒé‡ã€‚</li>
</ul>
<h5 id="roundrobin"><a class="markdownIt-Anchor" href="#roundrobin"></a> RoundRobin</h5>
<ul>
<li>è½®å¾ªï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®å¾ªæ¯”ç‡ã€‚</li>
<li>å­˜åœ¨æ…¢çš„æä¾›è€…ç´¯ç§¯è¯·æ±‚çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šã€‚</li>
</ul>
<h5 id="leastactive"><a class="markdownIt-Anchor" href="#leastactive"></a> LeastActive</h5>
<ul>
<li>æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ã€‚</li>
<li>ä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚</li>
</ul>
<h5 id="consistenthash"><a class="markdownIt-Anchor" href="#consistenthash"></a> ConsistentHash</h5>
<ul>
<li>ä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€…ã€‚</li>
<li>å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒæä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚</li>
<li>ç®—æ³•å‚è§ï¼š<a href="http://en.wikipedia.org/wiki/Consistent_hashing" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/Consistent_hashing</a></li>
<li>ç¼ºçœåªå¯¹ç¬¬ä¸€ä¸ªå‚æ•° Hashï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® <code>&lt;dubbo:parameter key=&quot;hash.arguments&quot; value=&quot;0,1&quot; /&gt;</code></li>
<li>ç¼ºçœç”¨ 160 ä»½è™šæ‹ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® <code>&lt;dubbo:parameter key=&quot;hash.nodes&quot; value=&quot;320&quot; /&gt;</code></li>
</ul>
<h3 id="33-dubbo-é›†ç¾¤å®¹é”™ç­–ç•¥"><a class="markdownIt-Anchor" href="#33-dubbo-é›†ç¾¤å®¹é”™ç­–ç•¥"></a> 3.3. Dubbo é›†ç¾¤å®¹é”™ç­–ç•¥ ï¼Ÿ</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/java/javaweb/distributed/rpc/dubbo/dubbo%E9%9B%86%E7%BE%A4%E5%AE%B9%E9%94%99.jpg!zp"/></div>
<ul>
<li><strong>Failover</strong> - å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ã€‚é€šå¸¸ç”¨äºè¯»æ“ä½œï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries=â€œ2â€ æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚</li>
<li><strong>Failfast</strong> - å¿«é€Ÿå¤±è´¥ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œå¤±è´¥ç«‹å³æŠ¥é”™ã€‚é€šå¸¸ç”¨äºéå¹‚ç­‰æ€§çš„å†™æ“ä½œï¼Œæ¯”å¦‚æ–°å¢è®°å½•ã€‚</li>
<li><strong>Failsafe</strong> - å¤±è´¥å®‰å…¨ï¼Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œç›´æ¥å¿½ç•¥ã€‚é€šå¸¸ç”¨äºå†™å…¥å®¡è®¡æ—¥å¿—ç­‰æ“ä½œã€‚</li>
<li><strong>Failback</strong> - å¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°è®°å½•å¤±è´¥è¯·æ±‚ï¼Œå®šæ—¶é‡å‘ã€‚é€šå¸¸ç”¨äºæ¶ˆæ¯é€šçŸ¥æ“ä½œã€‚</li>
<li><strong>Forking</strong> - å¹¶è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œåªè¦ä¸€ä¸ªæˆåŠŸå³è¿”å›ã€‚é€šå¸¸ç”¨äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„è¯»æ“ä½œï¼Œä½†éœ€è¦æµªè´¹æ›´å¤šæœåŠ¡èµ„æºã€‚å¯é€šè¿‡ forks=â€œ2â€ æ¥è®¾ç½®æœ€å¤§å¹¶è¡Œæ•°ã€‚</li>
<li><strong>Broadcast</strong> - æ’­è°ƒç”¨æ‰€æœ‰æä¾›è€…ï¼Œé€ä¸ªè°ƒç”¨ï¼Œä»»æ„ä¸€å°æŠ¥é”™åˆ™æŠ¥é”™ã€‚é€šå¸¸ç”¨äºé€šçŸ¥æ‰€æœ‰æä¾›è€…æ›´æ–°ç¼“å­˜æˆ–æ—¥å¿—ç­‰æœ¬åœ°èµ„æºä¿¡æ¯ã€‚</li>
</ul>
<h3 id="34-åŠ¨æ€ä»£ç†ç­–ç•¥"><a class="markdownIt-Anchor" href="#34-åŠ¨æ€ä»£ç†ç­–ç•¥"></a> 3.4. åŠ¨æ€ä»£ç†ç­–ç•¥ï¼Ÿ</h3>
<p>Dubbo ä½œä¸º RPC æ¡†æ¶ï¼Œé¦–å…ˆè¦å®Œæˆçš„å°±æ˜¯è·¨ç³»ç»Ÿï¼Œè·¨ç½‘ç»œçš„æœåŠ¡è°ƒç”¨ã€‚æ¶ˆè´¹æ–¹ä¸æä¾›æ–¹éµå¾ªç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œæ¶ˆè´¹æ–¹è°ƒç”¨æ¥å£æ—¶ï¼ŒDubbo å°†å…¶è½¬æ¢æˆç»Ÿä¸€æ ¼å¼çš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡ç½‘ç»œä¼ è¾“ï¼Œæä¾›æ–¹æ ¹æ®è§„åˆ™æ‰¾åˆ°æ¥å£å®ç°ï¼Œé€šè¿‡åå°„å®Œæˆè°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¶ˆè´¹æ–¹è·å–çš„æ˜¯å¯¹è¿œç¨‹æœåŠ¡çš„ä¸€ä¸ªä»£ç†(Proxy)ï¼Œè€Œæä¾›æ–¹å› ä¸ºè¦æ”¯æŒä¸åŒçš„æ¥å£å®ç°ï¼Œéœ€è¦ä¸€ä¸ªåŒ…è£…å±‚(Wrapper)ã€‚è°ƒç”¨çš„è¿‡ç¨‹å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p>
<div align="center"><img src="https://oscimg.oschina.net/oscnet/bef19cd5a31b5ae13aff35a8cb4898faaf0.jpg"/></div>
<p>æ¶ˆè´¹æ–¹çš„ Proxy å’Œæä¾›æ–¹çš„ Wrapper å¾—ä»¥è®© Dubbo æ„å»ºå‡ºå¤æ‚ã€ç»Ÿä¸€çš„ä½“ç³»ã€‚è€Œè¿™ç§åŠ¨æ€ä»£ç†ä¸åŒ…è£…ä¹Ÿæ˜¯é€šè¿‡åŸºäº SPI çš„æ’ä»¶æ–¹å¼å®ç°çš„ï¼Œå®ƒçš„æ¥å£å°±æ˜¯<strong>ProxyFactory</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SPI</span>(<span class="string">"javassist"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Adaptive</span>(&#123;Constants.PROXY_KEY&#125;)</span><br><span class="line">    &lt;T&gt; <span class="function">T <span class="title">getProxy</span><span class="params">(Invoker&lt;T&gt; invoker)</span> <span class="keyword">throws</span> RpcException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Adaptive</span>(&#123;Constants.PROXY_KEY&#125;)</span><br><span class="line">    &lt;T&gt; <span class="function">Invoker&lt;T&gt; <span class="title">getInvoker</span><span class="params">(T proxy, Class&lt;T&gt; type, URL url)</span> <span class="keyword">throws</span> RpcException</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ProxyFactory æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäº JDK çš„ä»£ç†å®ç°ï¼Œä¸€ç§æ˜¯åŸºäº javassist çš„å®ç°ã€‚ProxyFactory æ¥å£ä¸Šå®šä¹‰äº†@SPI(â€œjavassistâ€)ï¼Œé»˜è®¤ä¸º javassist çš„å®ç°ã€‚</p>
<h3 id="35-dubbo-æ”¯æŒå“ªäº›åºåˆ—åŒ–åè®®hessianhessian-çš„æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#35-dubbo-æ”¯æŒå“ªäº›åºåˆ—åŒ–åè®®hessianhessian-çš„æ•°æ®ç»“æ„"></a> 3.5. Dubbo æ”¯æŒå“ªäº›åºåˆ—åŒ–åè®®ï¼ŸHessianï¼ŸHessian çš„æ•°æ®ç»“æ„ï¼Ÿ</h3>
<ol>
<li>dubbo åºåˆ—åŒ–ï¼Œé˜¿é‡Œå°šä¸æˆç†Ÿçš„ java åºåˆ—åŒ–å®ç°ã€‚</li>
<li>hessian2 åºåˆ—åŒ–ï¼šhessian æ˜¯ä¸€ç§è·¨è¯­è¨€çš„é«˜æ•ˆäºŒè¿›åˆ¶çš„åºåˆ—åŒ–æ–¹å¼ï¼Œä½†è¿™é‡Œå®é™…ä¸æ˜¯åŸç”Ÿçš„ hessian2 åºåˆ—åŒ–ï¼Œè€Œæ˜¯é˜¿é‡Œä¿®æ”¹è¿‡çš„ hessian liteï¼Œå®ƒæ˜¯ dubbo RPC é»˜è®¤å¯ç”¨çš„åºåˆ—åŒ–æ–¹å¼ã€‚</li>
<li>json åºåˆ—åŒ–ï¼šç›®å‰æœ‰ä¸¤ç§å®ç°ï¼Œä¸€ç§æ˜¯é‡‡ç”¨çš„é˜¿é‡Œçš„ fastjson åº“ï¼Œå¦ä¸€ç§æ˜¯é‡‡ç”¨ dubbo ä¸­è‡ªå·²å®ç°çš„ç®€å• json åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œjson è¿™ç§æ–‡æœ¬åºåˆ—åŒ–æ€§èƒ½ä¸å¦‚äºŒè¿›åˆ¶åºåˆ—åŒ–ã€‚</li>
<li>java åºåˆ—åŒ–ï¼šä¸»è¦æ˜¯é‡‡ç”¨ JDK è‡ªå¸¦çš„ java åºåˆ—åŒ–å®ç°ï¼Œæ€§èƒ½å¾ˆä¸ç†æƒ³ã€‚</li>
<li>Kryo å’Œ FSTï¼šKryo å’Œ FST çš„æ€§èƒ½ä¾ç„¶æ™®éä¼˜äº hessian å’Œ dubbo åºåˆ—åŒ–ã€‚</li>
</ol>
<p>Hessian åºåˆ—åŒ–ä¸ Java é»˜è®¤çš„åºåˆ—åŒ–åŒºåˆ«ï¼Ÿ</p>
<p>Hessian æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ remoting on http å·¥å…·ï¼Œé‡‡ç”¨çš„æ˜¯ Binary RPC åè®®ï¼Œæ‰€ä»¥å®ƒå¾ˆé€‚åˆäºå‘é€äºŒè¿›åˆ¶æ•°æ®ï¼ŒåŒæ—¶åˆå…·æœ‰é˜²ç«å¢™ç©¿é€èƒ½åŠ›ã€‚</p>
<ol>
<li>Hessian æ”¯æŒè·¨è¯­è¨€ä¸²è¡Œ</li>
<li>æ¯” java åºåˆ—åŒ–å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œæ˜“ç”¨æ€§</li>
<li>æ”¯æŒçš„è¯­è¨€æ¯”è¾ƒå¤š</li>
</ol>
<h3 id="36-protoco-buffer-æ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#36-protoco-buffer-æ˜¯ä»€ä¹ˆ"></a> 3.6. Protoco Buffer æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>Protocol Buffer æ˜¯ Google å‡ºå“çš„ä¸€ç§è½»é‡ &amp; é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œæ€§èƒ½æ¯” Jsonã€XML çœŸçš„å¼ºï¼å¤ªï¼å¤šï¼</p>
<p>Protocol Buffer çš„åºåˆ—åŒ– &amp; ååºåˆ—åŒ–ç®€å• &amp; é€Ÿåº¦å¿«çš„åŸå› æ˜¯ï¼š</p>
<ol>
<li>ç¼–ç  / è§£ç  æ–¹å¼ç®€å•ï¼ˆåªéœ€è¦ç®€å•çš„æ•°å­¦è¿ç®— = ä½ç§»ç­‰ç­‰ï¼‰</li>
<li>é‡‡ç”¨ Protocol Buffer è‡ªèº«çš„æ¡†æ¶ä»£ç  å’Œ ç¼–è¯‘å™¨ å…±åŒå®Œæˆ</li>
</ol>
<p>Protocol Buffer çš„æ•°æ®å‹ç¼©æ•ˆæœå¥½ï¼ˆå³åºåˆ—åŒ–åçš„æ•°æ®é‡ä½“ç§¯å°ï¼‰çš„åŸå› æ˜¯ï¼š</p>
<ol>
<li>é‡‡ç”¨äº†ç‹¬ç‰¹çš„ç¼–ç æ–¹å¼ï¼Œå¦‚ Varintã€Zigzag ç¼–ç æ–¹å¼ç­‰ç­‰</li>
<li>é‡‡ç”¨ T - L - V çš„æ•°æ®å­˜å‚¨æ–¹å¼ï¼šå‡å°‘äº†åˆ†éš”ç¬¦çš„ä½¿ç”¨ &amp; æ•°æ®å­˜å‚¨å¾—ç´§å‡‘</li>
</ol>
<h3 id="37-æ³¨å†Œä¸­å¿ƒæŒ‚äº†å¯ä»¥ç»§ç»­é€šä¿¡å—"><a class="markdownIt-Anchor" href="#37-æ³¨å†Œä¸­å¿ƒæŒ‚äº†å¯ä»¥ç»§ç»­é€šä¿¡å—"></a> 3.7. æ³¨å†Œä¸­å¿ƒæŒ‚äº†å¯ä»¥ç»§ç»­é€šä¿¡å—ï¼Ÿ</h3>
<p>å¯ä»¥ã€‚Dubbo æ¶ˆè´¹è€…åœ¨åº”ç”¨å¯åŠ¨æ—¶ä¼šä»æ³¨å†Œä¸­å¿ƒæ‹‰å–å·²æ³¨å†Œçš„ç”Ÿäº§è€…çš„åœ°å€æ¥å£ï¼Œå¹¶ç¼“å­˜åœ¨æœ¬åœ°ã€‚æ¯æ¬¡è°ƒç”¨æ—¶ï¼ŒæŒ‰ç…§æœ¬åœ°å­˜å‚¨çš„åœ°å€è¿›è¡Œè°ƒç”¨ã€‚</p>
<h3 id="38-zookeeper-åŸç†æ˜¯ä»€ä¹ˆzookeeper-æœ‰ä»€ä¹ˆç”¨"><a class="markdownIt-Anchor" href="#38-zookeeper-åŸç†æ˜¯ä»€ä¹ˆzookeeper-æœ‰ä»€ä¹ˆç”¨"></a> 3.8. ZooKeeper åŸç†æ˜¯ä»€ä¹ˆï¼ŸZooKeeper æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3>
<p>ZooKeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼åº”ç”¨åè°ƒç³»ç»Ÿï¼Œå·²ç»ç”¨åˆ°äº†è®¸å¤šåˆ†å¸ƒå¼é¡¹ç›®ä¸­ï¼Œç”¨æ¥å®Œæˆç»Ÿä¸€å‘½åæœåŠ¡ã€çŠ¶æ€åŒæ­¥æœåŠ¡ã€é›†ç¾¤ç®¡ç†ã€åˆ†å¸ƒå¼åº”ç”¨é…ç½®é¡¹çš„ç®¡ç†ç­‰å·¥ä½œã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/distributed/rpc/zookeeper/zookeeper-service.png!zp" />
</div>
<ol>
<li>æ¯ä¸ª Server åœ¨å†…å­˜ä¸­å­˜å‚¨äº†ä¸€ä»½æ•°æ®ï¼›</li>
<li>Zookeeper å¯åŠ¨æ—¶ï¼Œå°†ä»å®ä¾‹ä¸­é€‰ä¸¾ä¸€ä¸ª leaderï¼ˆPaxos åè®®ï¼‰ï¼›</li>
<li>Leader è´Ÿè´£å¤„ç†æ•°æ®æ›´æ–°ç­‰æ“ä½œï¼ˆZab åè®®ï¼‰ï¼›</li>
<li>ä¸€ä¸ªæ›´æ–°æ“ä½œæˆåŠŸï¼Œå½“ä¸”ä»…å½“å¤§å¤šæ•° Server åœ¨å†…å­˜ä¸­æˆåŠŸä¿®æ”¹æ•°æ®ã€‚</li>
</ol>
<h3 id="39-netty-æœ‰ä»€ä¹ˆç”¨niobioaio-æœ‰ä»€ä¹ˆç”¨æœ‰ä»€ä¹ˆåŒºåˆ«"><a class="markdownIt-Anchor" href="#39-netty-æœ‰ä»€ä¹ˆç”¨niobioaio-æœ‰ä»€ä¹ˆç”¨æœ‰ä»€ä¹ˆåŒºåˆ«"></a> 3.9. Netty æœ‰ä»€ä¹ˆç”¨ï¼ŸNIO/BIO/AIO æœ‰ä»€ä¹ˆç”¨ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<p>Netty æ˜¯ä¸€ä¸ªâ€œç½‘ç»œé€šè®¯æ¡†æ¶â€ã€‚</p>
<p>Netty è¿›è¡Œäº‹ä»¶å¤„ç†çš„æµç¨‹ã€‚<code>Channel</code>æ˜¯è¿æ¥çš„é€šé“ï¼Œæ˜¯ ChannelEvent çš„äº§ç”Ÿè€…ï¼Œè€Œ<code>ChannelPipeline</code>å¯ä»¥ç†è§£ä¸º ChannelHandler çš„é›†åˆã€‚</p>
<div align="center"><img src="https://camo.githubusercontent.com/5f7331d15c79fba29474c5be6e9e86db465637c3/687474703a2f2f7374617469632e6f736368696e612e6e65742f75706c6f6164732f73706163652f323031332f303932312f3137343033325f313872625f3139303539312e706e67"/></div>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://github.com/code4craft/netty-learning/blob/master/posts/ch1-overview.md" target="_blank" rel="noopener">https://github.com/code4craft/netty-learning/blob/master/posts/ch1-overview.md</a></p>
</blockquote>
<p>IO çš„æ–¹å¼é€šå¸¸åˆ†ä¸ºå‡ ç§ï¼š</p>
<ul>
<li>åŒæ­¥é˜»å¡çš„ BIO</li>
<li>åŒæ­¥éé˜»å¡çš„ NIO</li>
<li>å¼‚æ­¥éé˜»å¡çš„ AIO</li>
</ul>
<p>åœ¨ä½¿ç”¨åŒæ­¥ I/O çš„ç½‘ç»œåº”ç”¨ä¸­ï¼Œå¦‚æœè¦åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚ï¼Œæˆ–æ˜¯åœ¨å®¢æˆ·ç«¯è¦åŒæ—¶å’Œå¤šä¸ªæœåŠ¡å™¨è¿›è¡Œé€šè®¯ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ã€‚</p>
<p>NIO åŸºäº Reactorï¼Œå½“ socket æœ‰æµå¯è¯»æˆ–å¯å†™å…¥ socket æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šç›¸åº”çš„é€šçŸ¥å¼•ç”¨ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œåº”ç”¨å†å°†æµè¯»å–åˆ°ç¼“å†²åŒºæˆ–å†™å…¥æ“ä½œç³»ç»Ÿã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå·²ç»ä¸æ˜¯ä¸€ä¸ªè¿æ¥å°±è¦å¯¹åº”ä¸€ä¸ªå¤„ç†çº¿ç¨‹äº†ï¼Œè€Œæ˜¯æœ‰æ•ˆçš„è¯·æ±‚ï¼Œå¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œå½“è¿æ¥æ²¡æœ‰æ•°æ®æ—¶ï¼Œæ˜¯æ²¡æœ‰å·¥ä½œçº¿ç¨‹æ¥å¤„ç†çš„ã€‚</p>
<p>ä¸ NIO ä¸åŒï¼Œå½“è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œåªé¡»ç›´æ¥è°ƒç”¨ API çš„ read æˆ– write æ–¹æ³•å³å¯ã€‚è¿™ä¸¤ç§æ–¹æ³•å‡ä¸ºå¼‚æ­¥çš„ï¼Œå¯¹äºè¯»æ“ä½œè€Œè¨€ï¼Œå½“æœ‰æµå¯è¯»å–æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å¯è¯»çš„æµä¼ å…¥ read æ–¹æ³•çš„ç¼“å†²åŒºï¼Œå¹¶é€šçŸ¥åº”ç”¨ç¨‹åºï¼›å¯¹äºå†™æ“ä½œè€Œè¨€ï¼Œå½“æ“ä½œç³»ç»Ÿå°† write æ–¹æ³•ä¼ é€’çš„æµå†™å…¥å®Œæ¯•æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸»åŠ¨é€šçŸ¥åº”ç”¨ç¨‹åºã€‚ å³å¯ä»¥ç†è§£ä¸ºï¼Œread/write æ–¹æ³•éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå®Œæˆåä¼šä¸»åŠ¨è°ƒç”¨å›è°ƒå‡½æ•°ã€‚</p>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/skiof007/article/details/52873421" target="_blank" rel="noopener">https://blog.csdn.net/skiof007/article/details/52873421</a></p>
</blockquote>
<h3 id="310-ä¸ºä»€ä¹ˆè¦è¿›è¡Œç³»ç»Ÿæ‹†åˆ†æ‹†åˆ†ä¸ç”¨-dubbo-å¯ä»¥å—"><a class="markdownIt-Anchor" href="#310-ä¸ºä»€ä¹ˆè¦è¿›è¡Œç³»ç»Ÿæ‹†åˆ†æ‹†åˆ†ä¸ç”¨-dubbo-å¯ä»¥å—"></a> 3.10. ä¸ºä»€ä¹ˆè¦è¿›è¡Œç³»ç»Ÿæ‹†åˆ†ï¼Ÿæ‹†åˆ†ä¸ç”¨ Dubbo å¯ä»¥å—ï¼Ÿ</h3>
<p>ç³»ç»Ÿæ‹†åˆ†ä»èµ„æºè§’åº¦åˆ†ä¸ºï¼šåº”ç”¨æ‹†åˆ†å’Œæ•°æ®åº“æ‹†åˆ†ã€‚</p>
<p>ä»é‡‡ç”¨çš„å…ˆåé¡ºåºå¯åˆ†ä¸ºï¼šæ°´å¹³æ‰©å±•ã€å‚ç›´æ‹†åˆ†ã€ä¸šåŠ¡æ‹†åˆ†ã€æ°´å¹³æ‹†åˆ†ã€‚</p>
<div align="center"><img src="http://misc.linkedkeeper.com/misc/img/blog/201804/linkedkeeper0_9c2ed2ed-6156-40f7-ad08-20af067047ca.jpg"/></div>
<p>æ˜¯å¦ä½¿ç”¨æœåŠ¡ä¾æ®å®é™…ä¸šåŠ¡åœºæ™¯æ¥å†³å®šã€‚</p>
<p>å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶(RPC)æ˜¯å…³é”®ã€‚</p>
<p>å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ(SOA)æ˜¯å…³é”®ã€‚</p>
<h3 id="311-dubbo-å’Œ-thrift-æœ‰ä»€ä¹ˆåŒºåˆ«"><a class="markdownIt-Anchor" href="#311-dubbo-å’Œ-thrift-æœ‰ä»€ä¹ˆåŒºåˆ«"></a> 3.11. Dubbo å’Œ Thrift æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<ul>
<li>Thrift æ˜¯è·¨è¯­è¨€çš„ RPC æ¡†æ¶ã€‚</li>
<li>Dubbo æ”¯æŒæœåŠ¡æ²»ç†ï¼Œè€Œ Thrift ä¸æ”¯æŒã€‚</li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ†å¸ƒå¼ç³»ç»ŸåŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/distributed-base-theory/</url>
    <content><![CDATA[<h1 id="åˆ†å¸ƒå¼ç³»ç»ŸåŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#åˆ†å¸ƒå¼ç³»ç»ŸåŸºæœ¬åŸç†"></a> åˆ†å¸ƒå¼ç³»ç»ŸåŸºæœ¬åŸç†</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%AF%E8%AF%AD">1. åˆ†å¸ƒå¼æœ¯è¯­</a>
<ul>
<li><a href="#11-%E5%BC%82%E5%B8%B8">1.1. å¼‚å¸¸</a></li>
<li><a href="#12-%E8%B6%85%E6%97%B6">1.2. è¶…æ—¶</a></li>
<li><a href="#13-%E8%A1%A1%E9%87%8F%E6%8C%87%E6%A0%87">1.3. è¡¡é‡æŒ‡æ ‡</a></li>
</ul>
</li>
<li><a href="#2-%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA">2. åˆ†å¸ƒå¼ç†è®º</a>
<ul>
<li><a href="#21-cap">2.1. CAP</a></li>
<li><a href="#22-base">2.2. BASE</a></li>
</ul>
</li>
<li><a href="#3-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1">3. åˆ†å¸ƒå¼äº‹åŠ¡</a>
<ul>
<li><a href="#31-%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A42pc">3.1. ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰</a></li>
<li><a href="#32-%E8%A1%A5%E5%81%BF%E4%BA%8B%E5%8A%A1tcc">3.2. è¡¥å¿äº‹åŠ¡ï¼ˆTCCï¼‰</a></li>
<li><a href="#33-%E6%9C%AC%E5%9C%B0%E6%B6%88%E6%81%AF%E8%A1%A8%E5%BC%82%E6%AD%A5%E7%A1%AE%E4%BF%9D">3.3. æœ¬åœ°æ¶ˆæ¯è¡¨ï¼ˆå¼‚æ­¥ç¡®ä¿ï¼‰</a></li>
<li><a href="#34-mq-%E4%BA%8B%E5%8A%A1%E6%B6%88%E6%81%AF">3.4. MQ äº‹åŠ¡æ¶ˆæ¯</a></li>
</ul>
</li>
<li><a href="#4-%E5%85%B1%E8%AF%86%E6%80%A7%E9%97%AE%E9%A2%98">4. å…±è¯†æ€§é—®é¢˜</a>
<ul>
<li><a href="#41-paxos">4.1. Paxos</a></li>
<li><a href="#42-raft">4.2. Raft</a></li>
</ul>
</li>
<li><a href="#5-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">5. å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="1-åˆ†å¸ƒå¼æœ¯è¯­"><a class="markdownIt-Anchor" href="#1-åˆ†å¸ƒå¼æœ¯è¯­"></a> 1. åˆ†å¸ƒå¼æœ¯è¯­</h2>
<h3 id="11-å¼‚å¸¸"><a class="markdownIt-Anchor" href="#11-å¼‚å¸¸"></a> 1.1. å¼‚å¸¸</h3>
<ul>
<li><strong><code>æœåŠ¡å™¨å®•æœº</code></strong> - å†…å­˜é”™è¯¯ã€æœåŠ¡å™¨åœç”µç­‰éƒ½ä¼šå¯¼è‡´æœåŠ¡å™¨å®•æœºï¼Œæ­¤æ—¶èŠ‚ç‚¹æ— æ³•æ­£å¸¸å·¥ä½œï¼Œç§°ä¸ºä¸å¯ç”¨ã€‚æœåŠ¡å™¨å®•æœºä¼šå¯¼è‡´èŠ‚ç‚¹å¤±å»æ‰€æœ‰å†…å­˜ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦å°†å†…å­˜ä¿¡æ¯ä¿å­˜åˆ°æŒä¹…åŒ–ä»‹è´¨ä¸Šã€‚</li>
<li><strong><code>ç½‘ç»œå¼‚å¸¸</code></strong> - æœ‰ä¸€ç§ç‰¹æ®Šçš„ç½‘ç»œå¼‚å¸¸ç§°ä¸ºâ€”â€”<strong>ç½‘ç»œåˆ†åŒº</strong> ï¼Œå³é›†ç¾¤çš„æ‰€æœ‰èŠ‚ç‚¹è¢«åˆ’åˆ†ä¸ºå¤šä¸ªåŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸå†…éƒ¨å¯ä»¥é€šä¿¡ï¼Œä½†æ˜¯åŒºåŸŸä¹‹é—´æ— æ³•é€šä¿¡ã€‚</li>
<li><strong><code>ç£ç›˜æ•…éšœ</code></strong> - ç£ç›˜æ•…éšœæ˜¯ä¸€ç§å‘ç”Ÿæ¦‚ç‡å¾ˆé«˜çš„å¼‚å¸¸ã€‚ä½¿ç”¨å†—ä½™æœºåˆ¶ï¼Œå°†æ•°æ®å­˜å‚¨åˆ°å¤šå°æœåŠ¡å™¨ã€‚</li>
</ul>
<h3 id="12-è¶…æ—¶"><a class="markdownIt-Anchor" href="#12-è¶…æ—¶"></a> 1.2. è¶…æ—¶</h3>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªè¯·æ±‚é™¤äº†æˆåŠŸå’Œå¤±è´¥ä¸¤ç§çŠ¶æ€ï¼Œè¿˜å­˜åœ¨ç€è¶…æ—¶çŠ¶æ€ã€‚</p>
<p>å¯ä»¥å°†æœåŠ¡å™¨çš„æ“ä½œè®¾è®¡ä¸ºå…·æœ‰ <strong>å¹‚ç­‰æ€§</strong> ï¼Œå³æ‰§è¡Œå¤šæ¬¡çš„ç»“æœä¸æ‰§è¡Œä¸€æ¬¡çš„ç»“æœç›¸åŒã€‚å¦‚æœä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå½“å‡ºç°è¶…æ—¶çš„æ—¶å€™ï¼Œå¯ä»¥ä¸æ–­åœ°é‡æ–°è¯·æ±‚ç›´åˆ°æˆåŠŸã€‚</p>
<h3 id="13-è¡¡é‡æŒ‡æ ‡"><a class="markdownIt-Anchor" href="#13-è¡¡é‡æŒ‡æ ‡"></a> 1.3. è¡¡é‡æŒ‡æ ‡</h3>
<h4 id="æ€§èƒ½"><a class="markdownIt-Anchor" href="#æ€§èƒ½"></a> æ€§èƒ½</h4>
<p>å¸¸è§çš„æ€§èƒ½æŒ‡æ ‡æœ‰ï¼šååé‡ã€å“åº”æ—¶é—´ã€‚</p>
<p>å…¶ä¸­ï¼Œååé‡æŒ‡ç³»ç»Ÿåœ¨æŸä¸€æ®µæ—¶é—´å¯ä»¥å¤„ç†çš„è¯·æ±‚æ€»æ•°ï¼Œé€šå¸¸ä¸ºæ¯ç§’çš„è¯»æ“ä½œæ•°æˆ–è€…å†™æ“ä½œæ•°ï¼›å“åº”æ—¶é—´æŒ‡ä»æŸä¸ªè¯·æ±‚å‘å‡ºåˆ°æ¥æ”¶åˆ°è¿”å›ç»“æœæ¶ˆè€—çš„æ—¶é—´ã€‚</p>
<p>è¿™ä¸¤ä¸ªæŒ‡æ ‡å¾€å¾€æ˜¯çŸ›ç›¾çš„ï¼Œè¿½æ±‚é«˜ååçš„ç³»ç»Ÿï¼Œå¾€å¾€å¾ˆéš¾åšåˆ°ä½å“åº”æ—¶é—´ï¼Œè§£é‡Šå¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>åœ¨æ— å¹¶å‘çš„ç³»ç»Ÿä¸­ï¼Œååé‡ä¸ºå“åº”æ—¶é—´çš„å€’æ•°ï¼Œä¾‹å¦‚å“åº”æ—¶é—´ä¸º 10 msï¼Œé‚£ä¹ˆååé‡ä¸º 100 req/sï¼Œå› æ­¤é«˜ååä¹Ÿå°±æ„å‘³ç€ä½å“åº”æ—¶é—´ã€‚</p>
</li>
<li>
<p>ä½†æ˜¯åœ¨å¹¶å‘çš„ç³»ç»Ÿä¸­ï¼Œç”±äºä¸€ä¸ªè¯·æ±‚åœ¨è°ƒç”¨ I/O èµ„æºçš„æ—¶å€™ï¼Œéœ€è¦è¿›è¡Œç­‰å¾…ã€‚æœåŠ¡å™¨ç«¯ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯å¼‚æ­¥ç­‰å¾…æ–¹å¼ï¼Œå³ç­‰å¾…çš„è¯·æ±‚è¢«é˜»å¡ä¹‹åä¸éœ€è¦ä¸€ç›´å ç”¨ CPU èµ„æºã€‚è¿™ç§æ–¹å¼èƒ½å¤§å¤§æé«˜ CPU èµ„æºçš„åˆ©ç”¨ç‡ï¼Œä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå•ä¸ªè¯·æ±‚åœ¨æ— å¹¶å‘çš„ç³»ç»Ÿä¸­å“åº”æ—¶é—´ä¸º 10 msï¼Œå¦‚æœåœ¨å¹¶å‘çš„ç³»ç»Ÿä¸­ï¼Œé‚£ä¹ˆååé‡å°†å¤§äº 100 req/sã€‚å› æ­¤ä¸ºäº†è¿½æ±‚é«˜ååé‡ï¼Œé€šå¸¸ä¼šæé«˜å¹¶å‘ç¨‹åº¦ã€‚ä½†æ˜¯å¹¶å‘ç¨‹åº¦çš„å¢åŠ ï¼Œä¼šå¯¼è‡´è¯·æ±‚çš„å¹³å‡å“åº”æ—¶é—´ä¹Ÿå¢åŠ ï¼Œå› ä¸ºè¯·æ±‚ä¸èƒ½é©¬ä¸Šè¢«å¤„ç†ï¼Œéœ€è¦å’Œå…¶å®ƒè¯·æ±‚ä¸€èµ·è¿›è¡Œå¹¶å‘å¤„ç†ï¼Œå“åº”æ—¶é—´è‡ªç„¶å°±ä¼šå¢é«˜ã€‚</p>
</li>
</ul>
<h4 id="å¯ç”¨æ€§"><a class="markdownIt-Anchor" href="#å¯ç”¨æ€§"></a> å¯ç”¨æ€§</h4>
<p>å¯ç”¨æ€§æŒ‡ç³»ç»Ÿåœ¨é¢å¯¹å„ç§å¼‚å¸¸æ—¶å¯ä»¥æä¾›æ­£å¸¸æœåŠ¡çš„èƒ½åŠ›ã€‚å¯ä»¥ç”¨ç³»ç»Ÿå¯ç”¨æ—¶é—´å æ€»æ—¶é—´çš„æ¯”å€¼æ¥è¡¡é‡ï¼Œ4 ä¸ª 9 çš„å¯ç”¨æ€§è¡¨ç¤ºç³»ç»Ÿ 99.99% çš„æ—¶é—´æ˜¯å¯ç”¨çš„ã€‚</p>
<h4 id="ä¸€è‡´æ€§"><a class="markdownIt-Anchor" href="#ä¸€è‡´æ€§"></a> ä¸€è‡´æ€§</h4>
<p>å¯ä»¥ä»ä¸¤ä¸ªè§’åº¦ç†è§£ä¸€è‡´æ€§ï¼šä»å®¢æˆ·ç«¯çš„è§’åº¦ï¼Œè¯»å†™æ“ä½œæ˜¯å¦æ»¡è¶³æŸç§ç‰¹æ€§ï¼›ä»æœåŠ¡å™¨çš„è§’åº¦ï¼Œå¤šä¸ªæ•°æ®å‰¯æœ¬ä¹‹é—´æ˜¯å¦ä¸€è‡´ã€‚</p>
<h4 id="å¯æ‰©å±•æ€§"><a class="markdownIt-Anchor" href="#å¯æ‰©å±•æ€§"></a> å¯æ‰©å±•æ€§</h4>
<p>æŒ‡ç³»ç»Ÿé€šè¿‡æ‰©å±•é›†ç¾¤æœåŠ¡å™¨è§„æ¨¡æ¥æé«˜æ€§èƒ½çš„èƒ½åŠ›ã€‚ç†æƒ³çš„åˆ†å¸ƒå¼ç³»ç»Ÿéœ€è¦å®ç°â€œçº¿æ€§å¯æ‰©å±•â€ï¼Œå³éšç€é›†ç¾¤è§„æ¨¡çš„å¢åŠ ï¼Œç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ä¹Ÿä¼šçº¿æ€§å¢åŠ ã€‚</p>
<h2 id="2-åˆ†å¸ƒå¼ç†è®º"><a class="markdownIt-Anchor" href="#2-åˆ†å¸ƒå¼ç†è®º"></a> 2. åˆ†å¸ƒå¼ç†è®º</h2>
<h3 id="21-cap"><a class="markdownIt-Anchor" href="#21-cap"></a> 2.1. CAP</h3>
<p>åˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶æ»¡è¶³ <strong><code>ä¸€è‡´æ€§ï¼ˆCï¼šConsistencyï¼‰</code></strong>ã€<strong><code>å¯ç”¨æ€§ï¼ˆAï¼šAvailabilityï¼‰</code><strong>å’Œ</strong><code>åˆ†åŒºå®¹å¿æ€§ï¼ˆPï¼šPartition Toleranceï¼‰</code></strong>ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³å…¶ä¸­ä¸¤é¡¹ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/åˆ†å¸ƒå¼ç†è®º-CAP.jpg" width="450"/>
</div>
<h4 id="ä¸€è‡´æ€§-2"><a class="markdownIt-Anchor" href="#ä¸€è‡´æ€§-2"></a> ä¸€è‡´æ€§</h4>
<p>ä¸€è‡´æ€§æŒ‡çš„æ˜¯<strong>å¤šä¸ªæ•°æ®å‰¯æœ¬æ˜¯å¦èƒ½ä¿æŒä¸€è‡´</strong>çš„ç‰¹æ€§ã€‚</p>
<p>åœ¨ä¸€è‡´æ€§çš„æ¡ä»¶ä¸‹ï¼Œç³»ç»Ÿåœ¨æ‰§è¡Œæ•°æ®æ›´æ–°æ“ä½œä¹‹åèƒ½å¤Ÿä»ä¸€è‡´æ€§çŠ¶æ€è½¬ç§»åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚</p>
<p>å¯¹ç³»ç»Ÿçš„ä¸€ä¸ªæ•°æ®æ›´æ–°æˆåŠŸä¹‹åï¼Œå¦‚æœæ‰€æœ‰ç”¨æˆ·éƒ½èƒ½å¤Ÿè¯»å–åˆ°æœ€æ–°çš„å€¼ï¼Œè¯¥ç³»ç»Ÿå°±è¢«è®¤ä¸ºå…·æœ‰å¼ºä¸€è‡´æ€§ã€‚</p>
<h4 id="å¯ç”¨æ€§-2"><a class="markdownIt-Anchor" href="#å¯ç”¨æ€§-2"></a> å¯ç”¨æ€§</h4>
<p>å¯ç”¨æ€§æŒ‡<strong>åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é¢å¯¹å„ç§å¼‚å¸¸æ—¶å¯ä»¥æä¾›æ­£å¸¸æœåŠ¡çš„èƒ½åŠ›</strong>ï¼Œå¯ä»¥ç”¨ç³»ç»Ÿå¯ç”¨æ—¶é—´å æ€»æ—¶é—´çš„æ¯”å€¼æ¥è¡¡é‡ï¼Œ4 ä¸ª 9 çš„å¯ç”¨æ€§è¡¨ç¤ºç³»ç»Ÿ <code>99.99%</code> çš„æ—¶é—´æ˜¯å¯ç”¨çš„ã€‚</p>
<p>åœ¨å¯ç”¨æ€§æ¡ä»¶ä¸‹ï¼Œç³»ç»Ÿæä¾›çš„æœåŠ¡ä¸€ç›´å¤„äºå¯ç”¨çš„çŠ¶æ€ï¼Œå¯¹äºç”¨æˆ·çš„æ¯ä¸€ä¸ªæ“ä½œè¯·æ±‚æ€»æ˜¯èƒ½å¤Ÿåœ¨æœ‰é™çš„æ—¶é—´å†…è¿”å›ç»“æœã€‚</p>
<h4 id="åˆ†åŒºå®¹é”™æ€§"><a class="markdownIt-Anchor" href="#åˆ†åŒºå®¹é”™æ€§"></a> åˆ†åŒºå®¹é”™æ€§</h4>
<p>åˆ†åŒºå®¹é”™æ€§æŒ‡ <strong>åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é‡åˆ°ä»»ä½•ç½‘ç»œåˆ†åŒºæ•…éšœçš„æ—¶å€™ï¼Œä»ç„¶éœ€è¦èƒ½å¯¹å¤–æä¾›ä¸€è‡´æ€§å’Œå¯ç”¨æ€§çš„æœåŠ¡ï¼Œé™¤éæ˜¯æ•´ä¸ªç½‘ç»œç¯å¢ƒéƒ½å‘ç”Ÿäº†æ•…éšœ</strong>ã€‚</p>
<h4 id="æƒè¡¡"><a class="markdownIt-Anchor" href="#æƒè¡¡"></a> æƒè¡¡</h4>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œåˆ†åŒºå®¹å¿æ€§å¿…ä¸å¯å°‘ï¼Œå› ä¸ºéœ€è¦æ€»æ˜¯å‡è®¾ç½‘ç»œæ˜¯ä¸å¯é çš„ã€‚å› æ­¤ï¼ŒCAP ç†è®ºå®é™…åœ¨æ˜¯è¦åœ¨å¯ç”¨æ€§å’Œä¸€è‡´æ€§ä¹‹é—´åšæƒè¡¡ã€‚</p>
<p>å¯ç”¨æ€§å’Œä¸€è‡´æ€§å¾€å¾€æ˜¯å†²çªçš„ï¼Œå¾ˆéš¾éƒ½ä½¿å®ƒä»¬åŒæ—¶æ»¡è¶³ã€‚åœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´è¿›è¡Œæ•°æ®åŒæ­¥æ—¶ï¼Œ</p>
<ul>
<li>ä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼ˆCPï¼‰ï¼Œå°±éœ€è¦è®©æ‰€æœ‰èŠ‚ç‚¹ä¸‹çº¿æˆä¸ºä¸å¯ç”¨çš„çŠ¶æ€ï¼Œç­‰å¾…åŒæ­¥å®Œæˆï¼›</li>
<li>ä¸ºäº†ä¿è¯å¯ç”¨æ€§ï¼ˆAPï¼‰ï¼Œåœ¨åŒæ­¥è¿‡ç¨‹ä¸­å…è®¸è¯»å–æ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®å¯èƒ½ä¸ä¸€è‡´ã€‚</li>
</ul>
<h3 id="22-base"><a class="markdownIt-Anchor" href="#22-base"></a> 2.2. BASE</h3>
<p>BASE æ˜¯ <strong><code>åŸºæœ¬å¯ç”¨ï¼ˆBasically Availableï¼‰</code></strong>ã€<strong><code>è½¯çŠ¶æ€ï¼ˆSoft Stateï¼‰</code></strong> å’Œ <strong><code>æœ€ç»ˆä¸€è‡´æ€§ï¼ˆEventually Consistentï¼‰</code></strong> ä¸‰ä¸ªçŸ­è¯­çš„ç¼©å†™ã€‚</p>
<p>BASE ç†è®ºæ˜¯å¯¹ CAP ä¸­ä¸€è‡´æ€§å’Œå¯ç”¨æ€§æƒè¡¡çš„ç»“æœï¼Œå®ƒçš„ç†è®ºçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå³ä½¿æ— æ³•åšåˆ°å¼ºä¸€è‡´æ€§ï¼Œä½†æ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹ç‚¹ï¼Œé‡‡ç”¨é€‚å½“çš„æ–¹å¼æ¥ä½¿ç³»ç»Ÿè¾¾åˆ°æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA-BASE.png" alt="img" /></p>
<h4 id="åŸºæœ¬å¯ç”¨"><a class="markdownIt-Anchor" href="#åŸºæœ¬å¯ç”¨"></a> åŸºæœ¬å¯ç”¨</h4>
<p>æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œä¿è¯æ ¸å¿ƒå¯ç”¨ï¼Œå…è®¸æŸå¤±éƒ¨åˆ†å¯ç”¨æ€§ã€‚</p>
<p>ä¾‹å¦‚ï¼Œç”µå•†åœ¨åšä¿ƒé”€æ—¶ï¼Œä¸ºäº†ä¿è¯è´­ç‰©ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œéƒ¨åˆ†æ¶ˆè´¹è€…å¯èƒ½ä¼šè¢«å¼•å¯¼åˆ°ä¸€ä¸ªé™çº§çš„é¡µé¢ã€‚</p>
<h4 id="è½¯çŠ¶æ€"><a class="markdownIt-Anchor" href="#è½¯çŠ¶æ€"></a> è½¯çŠ¶æ€</h4>
<p>æŒ‡å…è®¸ç³»ç»Ÿä¸­çš„æ•°æ®å­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œå¹¶è®¤ä¸ºè¯¥ä¸­é—´çŠ¶æ€ä¸ä¼šå½±å“ç³»ç»Ÿæ•´ä½“å¯ç”¨æ€§ï¼Œå³å…è®¸ç³»ç»Ÿä¸åŒèŠ‚ç‚¹çš„æ•°æ®å‰¯æœ¬ä¹‹é—´è¿›è¡ŒåŒæ­¥çš„è¿‡ç¨‹å­˜åœ¨å»¶æ—¶ã€‚</p>
<h4 id="æœ€ç»ˆä¸€è‡´æ€§"><a class="markdownIt-Anchor" href="#æœ€ç»ˆä¸€è‡´æ€§"></a> æœ€ç»ˆä¸€è‡´æ€§</h4>
<p>æœ€ç»ˆä¸€è‡´æ€§å¼ºè°ƒçš„æ˜¯ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ•°æ®å‰¯æœ¬ï¼Œåœ¨ç»è¿‡ä¸€æ®µæ—¶é—´çš„åŒæ­¥åï¼Œæœ€ç»ˆèƒ½è¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚</p>
<p>ACID è¦æ±‚å¼ºä¸€è‡´æ€§ï¼Œé€šå¸¸è¿ç”¨åœ¨ä¼ ç»Ÿçš„æ•°æ®åº“ç³»ç»Ÿä¸Šã€‚è€Œ BASE è¦æ±‚æœ€ç»ˆä¸€è‡´æ€§ï¼Œé€šè¿‡ç‰ºç‰²å¼ºä¸€è‡´æ€§æ¥è¾¾åˆ°å¯ç”¨æ€§ï¼Œé€šå¸¸è¿ç”¨åœ¨å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ã€‚</p>
<p>åœ¨å®é™…çš„åˆ†å¸ƒå¼åœºæ™¯ä¸­ï¼Œä¸åŒä¸šåŠ¡å•å…ƒå’Œç»„ä»¶å¯¹ä¸€è‡´æ€§çš„è¦æ±‚æ˜¯ä¸åŒçš„ï¼Œå› æ­¤ ACID å’Œ BASE å¾€å¾€ä¼šç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ã€‚</p>
<h2 id="3-åˆ†å¸ƒå¼äº‹åŠ¡"><a class="markdownIt-Anchor" href="#3-åˆ†å¸ƒå¼äº‹åŠ¡"></a> 3. åˆ†å¸ƒå¼äº‹åŠ¡</h2>
<h3 id="31-ä¸¤é˜¶æ®µæäº¤2pc"><a class="markdownIt-Anchor" href="#31-ä¸¤é˜¶æ®µæäº¤2pc"></a> 3.1. ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰</h3>
<p>ä¸¤é˜¶æ®µæäº¤ï¼ˆTwo-phase Commitï¼Œ2PCï¼‰</p>
<p>ä¸»è¦ç”¨äºå®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡æŒ‡çš„æ˜¯äº‹åŠ¡æ“ä½œè·¨è¶Šå¤šä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸”è¦æ±‚æ»¡è¶³äº‹åŠ¡çš„ ACID ç‰¹æ€§ã€‚</p>
<p>é€šè¿‡å¼•å…¥åè°ƒè€…ï¼ˆCoordinatorï¼‰æ¥è°ƒåº¦å‚ä¸è€…çš„è¡Œä¸ºï¼Œå¹¶æœ€ç»ˆå†³å®šè¿™äº›å‚ä¸è€…æ˜¯å¦è¦çœŸæ­£æ‰§è¡Œäº‹åŠ¡ã€‚</p>
<h4 id="è¿è¡Œè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è¿è¡Œè¿‡ç¨‹"></a> è¿è¡Œè¿‡ç¨‹</h4>
<h5 id="å‡†å¤‡é˜¶æ®µ"><a class="markdownIt-Anchor" href="#å‡†å¤‡é˜¶æ®µ"></a> å‡†å¤‡é˜¶æ®µ</h5>
<p>åè°ƒè€…è¯¢é—®å‚ä¸è€…äº‹åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œå‚ä¸è€…å‘å›äº‹åŠ¡æ‰§è¡Œç»“æœã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/åˆ†å¸ƒå¼äº‹åŠ¡ä¸¤é˜¶æ®µæäº¤-01.jpg" />
</div>
<h5 id="æäº¤é˜¶æ®µ"><a class="markdownIt-Anchor" href="#æäº¤é˜¶æ®µ"></a> æäº¤é˜¶æ®µ</h5>
<p>å¦‚æœäº‹åŠ¡åœ¨æ¯ä¸ªå‚ä¸è€…ä¸Šéƒ½æ‰§è¡ŒæˆåŠŸï¼Œäº‹åŠ¡åè°ƒè€…å‘é€é€šçŸ¥è®©å‚ä¸è€…æäº¤äº‹åŠ¡ï¼›å¦åˆ™ï¼Œåè°ƒè€…å‘é€é€šçŸ¥è®©å‚ä¸è€…å›æ»šäº‹åŠ¡ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/åˆ†å¸ƒå¼äº‹åŠ¡ä¸¤é˜¶æ®µæäº¤-02.jpg" />
</div>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å‡†å¤‡é˜¶æ®µï¼Œå‚ä¸è€…æ‰§è¡Œäº†äº‹åŠ¡ï¼Œä½†æ˜¯è¿˜æœªæäº¤ã€‚åªæœ‰åœ¨æäº¤é˜¶æ®µæ¥æ”¶åˆ°åè°ƒè€…å‘æ¥çš„é€šçŸ¥åï¼Œæ‰è¿›è¡Œæäº¤æˆ–è€…å›æ»šã€‚</p>
<h4 id="é—®é¢˜"><a class="markdownIt-Anchor" href="#é—®é¢˜"></a> é—®é¢˜</h4>
<h5 id="åŒæ­¥é˜»å¡"><a class="markdownIt-Anchor" href="#åŒæ­¥é˜»å¡"></a> åŒæ­¥é˜»å¡</h5>
<p>æ‰€æœ‰äº‹åŠ¡å‚ä¸è€…åœ¨ç­‰å¾…å…¶å®ƒå‚ä¸è€…å“åº”çš„æ—¶å€™éƒ½å¤„äºåŒæ­¥é˜»å¡çŠ¶æ€ï¼Œæ— æ³•è¿›è¡Œå…¶å®ƒæ“ä½œã€‚</p>
<h5 id="å•ç‚¹é—®é¢˜"><a class="markdownIt-Anchor" href="#å•ç‚¹é—®é¢˜"></a> å•ç‚¹é—®é¢˜</h5>
<p>åè°ƒè€…åœ¨ 2PC ä¸­èµ·åˆ°éå¸¸å¤§çš„ä½œç”¨ï¼Œå‘ç”Ÿæ•…éšœå°†ä¼šé€ æˆå¾ˆå¤§å½±å“ï¼Œç‰¹åˆ«æ˜¯åœ¨é˜¶æ®µäºŒå‘ç”Ÿæ•…éšœï¼Œæ‰€æœ‰å‚ä¸è€…ä¼šä¸€ç›´ç­‰å¾…çŠ¶æ€ï¼Œæ— æ³•å®Œæˆå…¶å®ƒæ“ä½œã€‚</p>
<h5 id="æ•°æ®ä¸ä¸€è‡´"><a class="markdownIt-Anchor" href="#æ•°æ®ä¸ä¸€è‡´"></a> æ•°æ®ä¸ä¸€è‡´</h5>
<p>åœ¨é˜¶æ®µäºŒï¼Œå¦‚æœåè°ƒè€…åªå‘é€äº†éƒ¨åˆ† Commit æ¶ˆæ¯ï¼Œæ­¤æ—¶ç½‘ç»œå‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¹ˆåªæœ‰éƒ¨åˆ†å‚ä¸è€…æ¥æ”¶åˆ° Commit æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰éƒ¨åˆ†å‚ä¸è€…æäº¤äº†äº‹åŠ¡ï¼Œä½¿å¾—ç³»ç»Ÿæ•°æ®ä¸ä¸€è‡´ã€‚</p>
<h5 id="å¤ªè¿‡ä¿å®ˆ"><a class="markdownIt-Anchor" href="#å¤ªè¿‡ä¿å®ˆ"></a> å¤ªè¿‡ä¿å®ˆ</h5>
<p>ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å¤±è´¥å°±ä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡å¤±è´¥ï¼Œæ²¡æœ‰å®Œå–„çš„å®¹é”™æœºåˆ¶ã€‚</p>
<h4 id="pc-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#pc-ä¼˜ç¼ºç‚¹"></a> PC ä¼˜ç¼ºç‚¹</h4>
<p>ä¼˜ç‚¹ï¼šå°½é‡ä¿è¯äº†æ•°æ®çš„å¼ºä¸€è‡´ï¼Œé€‚åˆå¯¹æ•°æ®å¼ºä¸€è‡´è¦æ±‚å¾ˆé«˜çš„å…³é”®é¢†åŸŸã€‚ï¼ˆå…¶å®ä¹Ÿä¸èƒ½ 100%ä¿è¯å¼ºä¸€è‡´ï¼‰<br />
ç¼ºç‚¹ï¼šå®ç°å¤æ‚ï¼Œç‰ºç‰²äº†å¯ç”¨æ€§ï¼Œå¯¹æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œä¸é€‚åˆé«˜å¹¶å‘é«˜æ€§èƒ½åœºæ™¯ã€‚</p>
<h3 id="32-è¡¥å¿äº‹åŠ¡tcc"><a class="markdownIt-Anchor" href="#32-è¡¥å¿äº‹åŠ¡tcc"></a> 3.2. è¡¥å¿äº‹åŠ¡ï¼ˆTCCï¼‰</h3>
<p>è¡¥å¿äº‹åŠ¡ï¼ˆTCCï¼‰å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šé’ˆå¯¹æ¯ä¸ªæ“ä½œï¼Œéƒ½è¦æ³¨å†Œä¸€ä¸ªä¸å…¶å¯¹åº”çš„ç¡®è®¤å’Œè¡¥å¿ï¼ˆæ’¤é”€ï¼‰æ“ä½œã€‚å®ƒåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li>Try é˜¶æ®µä¸»è¦æ˜¯å¯¹ä¸šåŠ¡ç³»ç»Ÿåšæ£€æµ‹åŠèµ„æºé¢„ç•™ã€‚</li>
<li>Confirm é˜¶æ®µä¸»è¦æ˜¯å¯¹ä¸šåŠ¡ç³»ç»Ÿåšç¡®è®¤æäº¤ï¼ŒTry é˜¶æ®µæ‰§è¡ŒæˆåŠŸå¹¶å¼€å§‹æ‰§è¡Œ Confirm é˜¶æ®µæ—¶ï¼Œé»˜è®¤ Confirm é˜¶æ®µæ˜¯ä¸ä¼šå‡ºé”™çš„ã€‚å³ï¼šåªè¦ Try æˆåŠŸï¼ŒConfirm ä¸€å®šæˆåŠŸã€‚</li>
<li>Cancel é˜¶æ®µä¸»è¦æ˜¯åœ¨ä¸šåŠ¡æ‰§è¡Œé”™è¯¯ï¼Œéœ€è¦å›æ»šçš„çŠ¶æ€ä¸‹æ‰§è¡Œçš„ä¸šåŠ¡å–æ¶ˆï¼Œé¢„ç•™èµ„æºé‡Šæ”¾ã€‚</li>
</ol>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ Bob è¦å‘ Smith è½¬è´¦ï¼Œæ€è·¯å¤§æ¦‚æ˜¯ï¼š</p>
<ol>
<li>é¦–å…ˆåœ¨ Try é˜¶æ®µï¼Œè¦å…ˆè°ƒç”¨è¿œç¨‹æ¥å£æŠŠ Smith å’Œ Bob çš„é’±ç»™å†»ç»“èµ·æ¥ã€‚</li>
<li>åœ¨ Confirm é˜¶æ®µï¼Œæ‰§è¡Œè¿œç¨‹è°ƒç”¨çš„è½¬è´¦çš„æ“ä½œï¼Œè½¬è´¦æˆåŠŸè¿›è¡Œè§£å†»ã€‚</li>
<li>å¦‚æœç¬¬ 2 æ­¥æ‰§è¡ŒæˆåŠŸï¼Œé‚£ä¹ˆè½¬è´¦æˆåŠŸï¼Œå¦‚æœç¬¬äºŒæ­¥æ‰§è¡Œå¤±è´¥ï¼Œåˆ™è°ƒç”¨è¿œç¨‹å†»ç»“æ¥å£å¯¹åº”çš„è§£å†»æ–¹æ³• (Cancel)ã€‚</li>
</ol>
<h4 id="tcc-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#tcc-ä¼˜ç¼ºç‚¹"></a> TCC ä¼˜ç¼ºç‚¹</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šè·Ÿ 2PC æ¯”èµ·æ¥ï¼Œå®ç°ä»¥åŠæµç¨‹ç›¸å¯¹ç®€å•äº†ä¸€äº›ï¼Œä½†æ•°æ®çš„ä¸€è‡´æ€§æ¯” 2PC ä¹Ÿè¦å·®ä¸€äº›ã€‚</li>
<li>ç¼ºç‚¹ï¼šç¼ºç‚¹è¿˜æ˜¯æ¯”è¾ƒæ˜æ˜¾çš„ï¼Œåœ¨ 2,3 æ­¥ä¸­éƒ½æœ‰å¯èƒ½å¤±è´¥ã€‚TCC å±äºåº”ç”¨å±‚çš„ä¸€ç§è¡¥å¿æ–¹å¼ï¼Œæ‰€ä»¥éœ€è¦ç¨‹åºå‘˜åœ¨å®ç°çš„æ—¶å€™å¤šå†™å¾ˆå¤šè¡¥å¿çš„ä»£ç ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œä¸€äº›ä¸šåŠ¡æµç¨‹å¯èƒ½ç”¨ TCC ä¸å¤ªå¥½å®šä¹‰åŠå¤„ç†ã€‚</li>
</ul>
<h3 id="33-æœ¬åœ°æ¶ˆæ¯è¡¨å¼‚æ­¥ç¡®ä¿"><a class="markdownIt-Anchor" href="#33-æœ¬åœ°æ¶ˆæ¯è¡¨å¼‚æ­¥ç¡®ä¿"></a> 3.3. æœ¬åœ°æ¶ˆæ¯è¡¨ï¼ˆå¼‚æ­¥ç¡®ä¿ï¼‰</h3>
<p>æœ¬åœ°æ¶ˆæ¯è¡¨ä¸ä¸šåŠ¡æ•°æ®è¡¨å¤„äºåŒä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œè¿™æ ·å°±èƒ½åˆ©ç”¨æœ¬åœ°äº‹åŠ¡æ¥ä¿è¯åœ¨å¯¹è¿™ä¸¤ä¸ªè¡¨çš„æ“ä½œæ»¡è¶³äº‹åŠ¡ç‰¹æ€§ã€‚</p>
<ol>
<li>åœ¨åˆ†å¸ƒå¼äº‹åŠ¡æ“ä½œçš„ä¸€æ–¹å®Œæˆå†™ä¸šåŠ¡æ•°æ®çš„æ“ä½œä¹‹åå‘æœ¬åœ°æ¶ˆæ¯è¡¨å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼Œæœ¬åœ°äº‹åŠ¡èƒ½ä¿è¯è¿™ä¸ªæ¶ˆæ¯ä¸€å®šä¼šè¢«å†™å…¥æœ¬åœ°æ¶ˆæ¯è¡¨ä¸­ã€‚</li>
<li>ä¹‹åå°†æœ¬åœ°æ¶ˆæ¯è¡¨ä¸­çš„æ¶ˆæ¯è½¬å‘åˆ° Kafka ç­‰æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰ä¸­ï¼Œå¦‚æœè½¬å‘æˆåŠŸåˆ™å°†æ¶ˆæ¯ä»æœ¬åœ°æ¶ˆæ¯è¡¨ä¸­åˆ é™¤ï¼Œå¦åˆ™ç»§ç»­é‡æ–°è½¬å‘ã€‚</li>
<li>åœ¨åˆ†å¸ƒå¼äº‹åŠ¡æ“ä½œçš„å¦ä¸€æ–¹ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¯»å–ä¸€ä¸ªæ¶ˆæ¯ï¼Œå¹¶æ‰§è¡Œæ¶ˆæ¯ä¸­çš„æ“ä½œã€‚</li>
</ol>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/åˆ†å¸ƒå¼äº‹åŠ¡æœ¬åœ°æ¶ˆæ¯.jpg" />
</div>
<p>è¿™ç§æ–¹æ¡ˆéµå¾ª BASE ç†è®ºï¼Œé‡‡ç”¨çš„æ˜¯æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<p>æœ¬åœ°æ¶ˆæ¯è¡¨åˆ©ç”¨äº†æœ¬åœ°äº‹åŠ¡æ¥å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¹¶ä¸”ä½¿ç”¨äº†æ¶ˆæ¯é˜Ÿåˆ—æ¥ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<h4 id="æœ¬åœ°æ¶ˆæ¯è¡¨ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#æœ¬åœ°æ¶ˆæ¯è¡¨ä¼˜ç¼ºç‚¹"></a> æœ¬åœ°æ¶ˆæ¯è¡¨ä¼˜ç¼ºç‚¹</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šä¸€ç§éå¸¸ç»å…¸çš„å®ç°ï¼Œé¿å…äº†åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå®ç°äº†æœ€ç»ˆä¸€è‡´æ€§ã€‚</li>
<li>ç¼ºç‚¹ï¼šæ¶ˆæ¯è¡¨ä¼šè€¦åˆåˆ°ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œå¦‚æœæ²¡æœ‰å°è£…å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä¼šæœ‰å¾ˆå¤šæ‚æ´»éœ€è¦å¤„ç†ã€‚</li>
</ul>
<h3 id="34-mq-äº‹åŠ¡æ¶ˆæ¯"><a class="markdownIt-Anchor" href="#34-mq-äº‹åŠ¡æ¶ˆæ¯"></a> 3.4. MQ äº‹åŠ¡æ¶ˆæ¯</h3>
<p>æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹çš„ MQ æ˜¯æ”¯æŒäº‹åŠ¡æ¶ˆæ¯çš„ï¼Œæ¯”å¦‚ RocketMQï¼Œä»–ä»¬æ”¯æŒäº‹åŠ¡æ¶ˆæ¯çš„æ–¹å¼ä¹Ÿæ˜¯ç±»ä¼¼äºé‡‡ç”¨çš„äºŒé˜¶æ®µæäº¤ã€‚ä½†æ˜¯å¸‚é¢ä¸Šä¸€äº›ä¸»æµçš„ MQ éƒ½æ˜¯ä¸æ”¯æŒäº‹åŠ¡æ¶ˆæ¯çš„ï¼Œæ¯”å¦‚ RabbitMQ å’Œ Kafka éƒ½ä¸æ”¯æŒã€‚</p>
<p>ä»¥é˜¿é‡Œçš„ RocketMQ ä¸­é—´ä»¶ä¸ºä¾‹ï¼Œå…¶æ€è·¯å¤§è‡´ä¸ºï¼š</p>
<ol>
<li>Prepared æ¶ˆæ¯ï¼Œä¼šæ‹¿åˆ°æ¶ˆæ¯çš„åœ°å€ã€‚</li>
<li>æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ã€‚</li>
<li>é€šè¿‡ç¬¬ä¸€é˜¶æ®µæ‹¿åˆ°çš„åœ°å€å»è®¿é—®æ¶ˆæ¯ï¼Œå¹¶ä¿®æ”¹çŠ¶æ€ã€‚</li>
</ol>
<p>ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸šåŠ¡æ–¹æ³•å†…è¦æƒ³æ¶ˆæ¯é˜Ÿåˆ—æäº¤ä¸¤æ¬¡è¯·æ±‚ï¼Œä¸€æ¬¡å‘é€æ¶ˆæ¯å’Œä¸€æ¬¡ç¡®è®¤æ¶ˆæ¯ã€‚å¦‚æœç¡®è®¤æ¶ˆæ¯å‘é€å¤±è´¥äº† RocketMQ ä¼šå®šæœŸæ‰«ææ¶ˆæ¯é›†ç¾¤ä¸­çš„äº‹åŠ¡æ¶ˆæ¯ï¼Œè¿™æ—¶å€™å‘ç°äº† Prepared æ¶ˆæ¯ï¼Œå®ƒä¼šå‘æ¶ˆæ¯å‘é€è€…ç¡®è®¤ï¼Œæ‰€ä»¥ç”Ÿäº§æ–¹éœ€è¦å®ç°ä¸€ä¸ª check æ¥å£ï¼ŒRocketMQ ä¼šæ ¹æ®å‘é€ç«¯è®¾ç½®çš„ç­–ç•¥æ¥å†³å®šæ˜¯å›æ»šè¿˜æ˜¯ç»§ç»­å‘é€ç¡®è®¤æ¶ˆæ¯ã€‚è¿™æ ·å°±ä¿è¯äº†æ¶ˆæ¯å‘é€ä¸æœ¬åœ°äº‹åŠ¡åŒæ—¶æˆåŠŸæˆ–åŒæ—¶å¤±è´¥ã€‚</p>
<h4 id="mq-äº‹åŠ¡æ¶ˆæ¯ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#mq-äº‹åŠ¡æ¶ˆæ¯ä¼˜ç¼ºç‚¹"></a> MQ äº‹åŠ¡æ¶ˆæ¯ä¼˜ç¼ºç‚¹</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šå®ç°äº†æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸éœ€è¦ä¾èµ–æœ¬åœ°æ•°æ®åº“äº‹åŠ¡ã€‚</li>
<li>ç¼ºç‚¹ï¼šå®ç°éš¾åº¦å¤§ï¼Œä¸»æµ MQ ä¸æ”¯æŒã€‚</li>
</ul>
<h2 id="4-å…±è¯†æ€§é—®é¢˜"><a class="markdownIt-Anchor" href="#4-å…±è¯†æ€§é—®é¢˜"></a> 4. å…±è¯†æ€§é—®é¢˜</h2>
<h3 id="41-paxos"><a class="markdownIt-Anchor" href="#41-paxos"></a> 4.1. Paxos</h3>
<p>ç”¨äºè¾¾æˆå…±è¯†æ€§é—®é¢˜ï¼Œå³å¯¹å¤šä¸ªèŠ‚ç‚¹äº§ç”Ÿçš„å€¼ï¼Œè¯¥ç®—æ³•èƒ½ä¿è¯åªé€‰å‡ºå”¯ä¸€ä¸€ä¸ªå€¼ã€‚</p>
<p>ä¸»è¦æœ‰ä¸‰ç±»èŠ‚ç‚¹ï¼š</p>
<ul>
<li>æè®®è€…ï¼ˆProposerï¼‰ï¼šæè®®ä¸€ä¸ªå€¼ï¼›</li>
<li>æ¥å—è€…ï¼ˆAcceptorï¼‰ï¼šå¯¹æ¯ä¸ªæè®®è¿›è¡ŒæŠ•ç¥¨ï¼›</li>
<li>å‘ŠçŸ¥è€…ï¼ˆLearnerï¼‰ï¼šè¢«å‘ŠçŸ¥æŠ•ç¥¨çš„ç»“æœï¼Œä¸å‚ä¸æŠ•ç¥¨è¿‡ç¨‹ã€‚</li>
</ul>
<p>ç®—æ³•éœ€è¦æ»¡è¶³ safety å’Œ liveness ä¸¤æ–¹é¢çš„çº¦æŸè¦æ±‚ï¼ˆå®é™…ä¸Šè¿™ä¸¤ä¸ªåŸºç¡€å±æ€§æ˜¯å¤§éƒ¨åˆ†åˆ†å¸ƒå¼ç®—æ³•éƒ½è¯¥è€ƒè™‘çš„ï¼‰ï¼š</p>
<ul>
<li>safetyï¼šä¿è¯å†³è®®ç»“æœæ˜¯å¯¹çš„ï¼Œæ— æ­§ä¹‰çš„ï¼Œä¸ä¼šå‡ºç°é”™è¯¯æƒ…å†µã€‚
<ul>
<li>å†³è®®ï¼ˆvalueï¼‰åªæœ‰åœ¨è¢« proposers æå‡ºçš„ proposal æ‰èƒ½è¢«æœ€ç»ˆæ‰¹å‡†ï¼›</li>
<li>åœ¨ä¸€æ¬¡æ‰§è¡Œå®ä¾‹ä¸­ï¼Œåªæ‰¹å‡†ï¼ˆchosenï¼‰ä¸€ä¸ªæœ€ç»ˆå†³è®®ï¼Œæ„å‘³ç€å¤šæ•°æ¥å—ï¼ˆacceptï¼‰çš„ç»“æœèƒ½æˆä¸ºå†³è®®ï¼›</li>
</ul>
</li>
<li>livenessï¼šä¿è¯å†³è®®è¿‡ç¨‹èƒ½åœ¨æœ‰é™æ—¶é—´å†…å®Œæˆã€‚
<ul>
<li>å†³è®®æ€»ä¼šäº§ç”Ÿï¼Œå¹¶ä¸” learners èƒ½è·å¾—è¢«æ‰¹å‡†ï¼ˆchosenï¼‰çš„å†³è®®ã€‚</li>
</ul>
</li>
</ul>
<p>åŸºæœ¬è¿‡ç¨‹åŒ…æ‹¬ proposer æå‡ºææ¡ˆï¼Œå…ˆäº‰å–å¤§å¤šæ•° acceptor çš„æ”¯æŒï¼Œè¶…è¿‡ä¸€åŠæ”¯æŒæ—¶ï¼Œåˆ™å‘é€ç»“æ¡ˆç»“æœç»™æ‰€æœ‰äººè¿›è¡Œç¡®è®¤ã€‚ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜æ˜¯ proposer åœ¨æ­¤è¿‡ç¨‹ä¸­å‡ºç°æ•…éšœï¼Œå¯ä»¥é€šè¿‡è¶…æ—¶æœºåˆ¶æ¥è§£å†³ã€‚æä¸ºå‡‘å·§çš„æƒ…å†µä¸‹ï¼Œæ¯æ¬¡æ–°çš„ä¸€è½®ææ¡ˆçš„ proposer éƒ½æ°å¥½æ•…éšœï¼Œç³»ç»Ÿåˆ™æ°¸è¿œæ— æ³•è¾¾æˆä¸€è‡´ï¼ˆæ¦‚ç‡å¾ˆå°ï¼‰ã€‚</p>
<p>Paxos èƒ½ä¿è¯åœ¨è¶…è¿‡ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">2</span></span></span></span> çš„æ­£å¸¸èŠ‚ç‚¹å­˜åœ¨æ—¶ï¼Œç³»ç»Ÿèƒ½è¾¾æˆå…±è¯†ã€‚</p>
<h4 id="å•ä¸ªææ¡ˆè€…å¤šæ¥æ”¶è€…"><a class="markdownIt-Anchor" href="#å•ä¸ªææ¡ˆè€…å¤šæ¥æ”¶è€…"></a> å•ä¸ªææ¡ˆè€…+å¤šæ¥æ”¶è€…</h4>
<p>å¦‚æœç³»ç»Ÿä¸­é™å®šåªæœ‰æŸä¸ªç‰¹å®šèŠ‚ç‚¹æ˜¯ææ¡ˆè€…ï¼Œé‚£ä¹ˆä¸€è‡´æ€§è‚¯å®šèƒ½è¾¾æˆï¼ˆåªæœ‰ä¸€ä¸ªæ–¹æ¡ˆï¼Œè¦ä¹ˆè¾¾æˆï¼Œè¦ä¹ˆå¤±è´¥ï¼‰ã€‚ææ¡ˆè€…åªè¦æ”¶åˆ°äº†æ¥è‡ªå¤šæ•°æ¥æ”¶è€…çš„æŠ•ç¥¨ï¼Œå³å¯è®¤ä¸ºé€šè¿‡ï¼Œå› ä¸ºç³»ç»Ÿä¸­ä¸å­˜åœ¨å…¶ä»–çš„ææ¡ˆã€‚</p>
<p>ä½†ä¸€æ—¦ææ¡ˆè€…æ•…éšœï¼Œåˆ™ç³»ç»Ÿæ— æ³•å·¥ä½œã€‚</p>
<h4 id="å¤šä¸ªææ¡ˆè€…å•ä¸ªæ¥æ”¶è€…"><a class="markdownIt-Anchor" href="#å¤šä¸ªææ¡ˆè€…å•ä¸ªæ¥æ”¶è€…"></a> å¤šä¸ªææ¡ˆè€…+å•ä¸ªæ¥æ”¶è€…</h4>
<p>é™å®šæŸä¸ªèŠ‚ç‚¹ä½œä¸ºæ¥æ”¶è€…ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå…±è¯†ä¹Ÿå¾ˆå®¹æ˜“è¾¾æˆï¼Œæ¥æ”¶è€…æ”¶åˆ°å¤šä¸ªææ¡ˆï¼Œé€‰ç¬¬ä¸€ä¸ªææ¡ˆä½œä¸ºå†³è®®ï¼Œæ‹’ç»æ‰åç»­çš„ææ¡ˆå³å¯ã€‚</p>
<p>ç¼ºé™·ä¹Ÿæ˜¯å®¹æ˜“å‘ç”Ÿå•ç‚¹æ•…éšœï¼ŒåŒ…æ‹¬æ¥æ”¶è€…æ•…éšœæˆ–é¦–ä¸ªææ¡ˆè€…èŠ‚ç‚¹æ•…éšœã€‚</p>
<p>ä»¥ä¸Šä¸¤ç§æƒ…å½¢å…¶å®ç±»ä¼¼ä¸»ä»æ¨¡å¼ï¼Œè™½ç„¶ä¸é‚£ä¹ˆå¯é ï¼Œä½†å› ä¸ºåŸç†ç®€å•è€Œè¢«å¹¿æ³›é‡‡ç”¨ã€‚</p>
<p>å½“ææ¡ˆè€…å’Œæ¥æ”¶è€…éƒ½æ¨å¹¿åˆ°å¤šä¸ªçš„æƒ…å½¢ï¼Œä¼šå‡ºç°ä¸€äº›æŒ‘æˆ˜ã€‚</p>
<h4 id="å¤šä¸ªææ¡ˆè€…å¤šä¸ªæ¥æ”¶è€…"><a class="markdownIt-Anchor" href="#å¤šä¸ªææ¡ˆè€…å¤šä¸ªæ¥æ”¶è€…"></a> å¤šä¸ªææ¡ˆè€…+å¤šä¸ªæ¥æ”¶è€…</h4>
<p>æ—¢ç„¶é™å®šå•ææ¡ˆè€…æˆ–å•æ¥æ”¶è€…éƒ½ä¼šå‡ºç°æ•…éšœï¼Œé‚£ä¹ˆå°±å¾—å…è®¸å‡ºç°å¤šä¸ªææ¡ˆè€…å’Œå¤šä¸ªæ¥æ”¶è€…ã€‚é—®é¢˜ä¸€ä¸‹å­å˜å¾—å¤æ‚äº†ã€‚</p>
<p>ä¸€ç§æƒ…å†µæ˜¯åŒä¸€æ—¶é—´ç‰‡æ®µï¼ˆå¦‚ä¸€ä¸ªææ¡ˆå‘¨æœŸï¼‰å†…åªæœ‰ä¸€ä¸ªææ¡ˆè€…ï¼Œè¿™æ—¶å¯ä»¥é€€åŒ–åˆ°å•ææ¡ˆè€…çš„æƒ…å½¢ã€‚éœ€è¦è®¾è®¡ä¸€ç§æœºåˆ¶æ¥ä¿éšœææ¡ˆè€…çš„æ­£ç¡®äº§ç”Ÿï¼Œä¾‹å¦‚æŒ‰ç…§æ—¶é—´ã€åºåˆ—ã€æˆ–è€…å¤§å®¶çŒœæ‹³ï¼ˆå‡ºä¸€ä¸ªæ•°å­—æ¥æ¯”è¾ƒï¼‰ä¹‹ç±»ã€‚è€ƒè™‘åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿè¦å¤„ç†çš„å·¥ä½œé‡å¾ˆå¤§ï¼Œè¿™ä¸ªè¿‡ç¨‹è¦å°½é‡é«˜æ•ˆï¼Œæ»¡è¶³è¿™ä¸€æ¡ä»¶çš„æœºåˆ¶éå¸¸éš¾è®¾è®¡ã€‚</p>
<p>å¦ä¸€ç§æƒ…å†µæ˜¯å…è®¸åŒä¸€æ—¶é—´ç‰‡æ®µå†…å¯ä»¥å‡ºç°å¤šä¸ªææ¡ˆè€…ã€‚é‚£åŒä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½æ”¶åˆ°å¤šä»½ææ¡ˆï¼Œæ€ä¹ˆå¯¹ä»–ä»¬è¿›è¡ŒåŒºåˆ†å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™é‡‡ç”¨åªæ¥å—ç¬¬ä¸€ä¸ªææ¡ˆè€Œæ‹’ç»åç»­ææ¡ˆçš„æ–¹æ³•ä¹Ÿä¸é€‚ç”¨ã€‚å¾ˆè‡ªç„¶çš„ï¼Œææ¡ˆéœ€è¦å¸¦ä¸Šä¸åŒçš„åºå·ã€‚èŠ‚ç‚¹éœ€è¦æ ¹æ®ææ¡ˆåºå·æ¥åˆ¤æ–­æ¥å—å“ªä¸ªã€‚æ¯”å¦‚æ¥å—å…¶ä¸­åºå·è¾ƒå¤§ï¼ˆå¾€å¾€æ„å‘³ç€æ˜¯æ¥å—æ–°æå‡ºçš„ï¼Œå› ä¸ºæ—§ææ¡ˆè€…æ•…éšœæ¦‚ç‡æ›´å¤§ï¼‰çš„ææ¡ˆã€‚</p>
<p>å¦‚ä½•ä¸ºææ¡ˆåˆ†é…åºå·å‘¢ï¼Ÿä¸€ç§å¯èƒ½æ–¹æ¡ˆæ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„ææ¡ˆæ•°å­—åŒºé—´å½¼æ­¤éš”ç¦»å¼€ï¼Œäº’ç›¸ä¸å†²çªã€‚ä¸ºäº†æ»¡è¶³é€’å¢çš„éœ€æ±‚å¯ä»¥é…åˆç”¨æ—¶é—´æˆ³ä½œä¸ºå‰ç¼€å­—æ®µã€‚</p>
<p>æ­¤å¤–ï¼Œææ¡ˆè€…å³ä¾¿æ”¶åˆ°äº†å¤šæ•°æ¥æ”¶è€…çš„æŠ•ç¥¨ï¼Œä¹Ÿä¸æ•¢è¯´å°±ä¸€å®šé€šè¿‡ã€‚å› ä¸ºåœ¨æ­¤è¿‡ç¨‹ä¸­ç³»ç»Ÿå¯èƒ½è¿˜æœ‰å…¶å®ƒçš„ææ¡ˆã€‚</p>
<h3 id="42-raft"><a class="markdownIt-Anchor" href="#42-raft"></a> 4.2. Raft</h3>
<p>Raft ç®—æ³•æ˜¯ Paxos ç®—æ³•çš„ä¸€ç§ç®€åŒ–å®ç°ã€‚</p>
<p>åŒ…æ‹¬ä¸‰ç§è§’è‰²ï¼šleaderã€candidate å’Œ followerï¼Œå…¶åŸºæœ¬è¿‡ç¨‹ä¸ºï¼š</p>
<ul>
<li><strong>Leader é€‰ä¸¾</strong> - æ¯ä¸ª candidate éšæœºç»è¿‡ä¸€å®šæ—¶é—´éƒ½ä¼šæå‡ºé€‰ä¸¾æ–¹æ¡ˆï¼Œæœ€è¿‘é˜¶æ®µä¸­å¾—ç¥¨æœ€å¤šè€…è¢«é€‰ä¸º leaderï¼›</li>
<li><strong>åŒæ­¥ log</strong> - leader ä¼šæ‰¾åˆ°ç³»ç»Ÿä¸­ log æœ€æ–°çš„è®°å½•ï¼Œå¹¶å¼ºåˆ¶æ‰€æœ‰çš„ follower æ¥åˆ·æ–°åˆ°è¿™ä¸ªè®°å½•ï¼›</li>
</ul>
<p><em>æ³¨ï¼šæ­¤å¤„ log å¹¶éæ˜¯æŒ‡æ—¥å¿—æ¶ˆæ¯ï¼Œè€Œæ˜¯å„ç§äº‹ä»¶çš„å‘ç”Ÿè®°å½•ã€‚</em></p>
<h4 id="å•ä¸ª-candidate-çš„ç«é€‰"><a class="markdownIt-Anchor" href="#å•ä¸ª-candidate-çš„ç«é€‰"></a> å•ä¸ª Candidate çš„ç«é€‰</h4>
<p>æœ‰ä¸‰ç§èŠ‚ç‚¹ï¼šFollowerã€Candidate å’Œ Leaderã€‚Leader ä¼šå‘¨æœŸæ€§çš„å‘é€å¿ƒè·³åŒ…ç»™ Followerã€‚æ¯ä¸ª Follower éƒ½è®¾ç½®äº†ä¸€ä¸ªéšæœºçš„ç«é€‰è¶…æ—¶æ—¶é—´ï¼Œä¸€èˆ¬ä¸º 150ms~300msï¼Œå¦‚æœåœ¨è¿™ä¸ªæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ° Leader çš„å¿ƒè·³åŒ…ï¼Œå°±ä¼šå˜æˆ Candidateï¼Œè¿›å…¥ç«é€‰é˜¶æ®µã€‚</p>
<ul>
<li>ä¸‹å›¾è¡¨ç¤ºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿçš„æœ€åˆé˜¶æ®µï¼Œæ­¤æ—¶åªæœ‰ Followerï¼Œæ²¡æœ‰ Leaderã€‚Follower A ç­‰å¾…ä¸€ä¸ªéšæœºçš„ç«é€‰è¶…æ—¶æ—¶é—´ä¹‹åï¼Œæ²¡æ”¶åˆ° Leader å‘æ¥çš„å¿ƒè·³åŒ…ï¼Œå› æ­¤è¿›å…¥ç«é€‰é˜¶æ®µã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-candidate-01.gif" />
</div>
<ul>
<li>æ­¤æ—¶ A å‘é€æŠ•ç¥¨è¯·æ±‚ç»™å…¶å®ƒæ‰€æœ‰èŠ‚ç‚¹ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-candidate-02.gif" />
</div>
<ul>
<li>å…¶å®ƒèŠ‚ç‚¹ä¼šå¯¹è¯·æ±‚è¿›è¡Œå›å¤ï¼Œå¦‚æœè¶…è¿‡ä¸€åŠçš„èŠ‚ç‚¹å›å¤äº†ï¼Œé‚£ä¹ˆè¯¥ Candidate å°±ä¼šå˜æˆ Leaderã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-candidate-03.gif" />
</div>
<ul>
<li>ä¹‹å Leader ä¼šå‘¨æœŸæ€§åœ°å‘é€å¿ƒè·³åŒ…ç»™ Followerï¼ŒFollower æ¥æ”¶åˆ°å¿ƒè·³åŒ…ï¼Œä¼šé‡æ–°å¼€å§‹è®¡æ—¶ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-candidate-04.gif" />
</div>
<h4 id="å¤šä¸ª-candidate-ç«é€‰"><a class="markdownIt-Anchor" href="#å¤šä¸ª-candidate-ç«é€‰"></a> å¤šä¸ª Candidate ç«é€‰</h4>
<ul>
<li>å¦‚æœæœ‰å¤šä¸ª Follower æˆä¸º Candidateï¼Œå¹¶ä¸”æ‰€è·å¾—ç¥¨æ•°ç›¸åŒï¼Œé‚£ä¹ˆå°±éœ€è¦é‡æ–°å¼€å§‹æŠ•ç¥¨ï¼Œä¾‹å¦‚ä¸‹å›¾ä¸­ Candidate B å’Œ Candidate D éƒ½è·å¾—ä¸¤ç¥¨ï¼Œå› æ­¤éœ€è¦é‡æ–°å¼€å§‹æŠ•ç¥¨ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-multi-candidate-01.gif" />
</div>
<ul>
<li>å½“é‡æ–°å¼€å§‹æŠ•ç¥¨æ—¶ï¼Œç”±äºæ¯ä¸ªèŠ‚ç‚¹è®¾ç½®çš„éšæœºç«é€‰è¶…æ—¶æ—¶é—´ä¸åŒï¼Œå› æ­¤èƒ½ä¸‹ä¸€æ¬¡å†æ¬¡å‡ºç°å¤šä¸ª Candidate å¹¶è·å¾—åŒæ ·ç¥¨æ•°çš„æ¦‚ç‡å¾ˆä½ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-multi-candidate-02.gif" />
</div>
<h4 id="åŒæ­¥æ—¥å¿—"><a class="markdownIt-Anchor" href="#åŒæ­¥æ—¥å¿—"></a> åŒæ­¥æ—¥å¿—</h4>
<ul>
<li>æ¥è‡ªå®¢æˆ·ç«¯çš„ä¿®æ”¹éƒ½ä¼šè¢«ä¼ å…¥ Leaderã€‚æ³¨æ„è¯¥ä¿®æ”¹è¿˜æœªè¢«æäº¤ï¼Œåªæ˜¯å†™å…¥æ—¥å¿—ä¸­ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-sync-log-01.gif" />
</div>
<ul>
<li>Leader ä¼šæŠŠä¿®æ”¹å¤åˆ¶åˆ°æ‰€æœ‰ Followerã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-sync-log-02.gif" />
</div>
<ul>
<li>Leader ä¼šç­‰å¾…å¤§å¤šæ•°çš„ Follower ä¹Ÿè¿›è¡Œäº†ä¿®æ”¹ï¼Œç„¶åæ‰å°†ä¿®æ”¹æäº¤ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-sync-log-03.gif" />
</div>
<ul>
<li>æ­¤æ—¶ Leader ä¼šé€šçŸ¥çš„æ‰€æœ‰ Follower è®©å®ƒä»¬ä¹Ÿæäº¤ä¿®æ”¹ï¼Œæ­¤æ—¶æ‰€æœ‰èŠ‚ç‚¹çš„å€¼è¾¾æˆä¸€è‡´ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/raft-sync-log-04.gif" />
</div>
<h2 id="5-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#5-å‚è€ƒèµ„æ–™"></a> 5. å‚è€ƒèµ„æ–™</h2>
<ul>
<li>æ¨ä¼ è¾‰. å¤§è§„æ¨¡åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿ: åŸç†è§£æä¸æ¶æ„å®æˆ˜[M]. æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾, 2013.</li>
<li><a href="https://www.gitbook.com/book/yeasy/blockchain_guide/details" target="_blank" rel="noopener">åŒºå—é“¾æŠ€æœ¯æŒ‡å—</a></li>
<li><a href="http://harry.me/blog/2014/12/27/neat-algorithms-paxos/" target="_blank" rel="noopener">NEAT ALGORITHMS - PAXOS</a></li>
<li><a href="http://thesecretlivesofdata.com/raft" target="_blank" rel="noopener">Raft: Understandable Distributed Consensus</a></li>
<li><a href="https://angus.nyc/2012/paxos-by-example/" target="_blank" rel="noopener">Paxos By Example</a></li>
<li><a href="https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html" target="_blank" rel="noopener">èŠèŠåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå†è¯´è¯´è§£å†³æ–¹æ¡ˆ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>åˆ†å¸ƒå¼</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯</title>
    <url>/blog/design/architecture/system-core-technologies/</url>
    <content><![CDATA[<h1 id="å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯"><a class="markdownIt-Anchor" href="#å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯"></a> å¤§å‹ç³»ç»Ÿæ ¸å¿ƒæŠ€æœ¯</h1>
<blockquote>
<p>å¤§å‹ç³»ç»Ÿçš„è®¾è®¡ç›®æ ‡å°±æ˜¯ä¸ºäº†å¿«é€Ÿã€é«˜æ•ˆã€ç¨³å®šçš„å¤„ç†æµ·é‡çš„æ•°æ®ä»¥åŠé«˜å¹¶å‘çš„è¯·æ±‚ã€‚</p>
<p>å•æœºæœåŠ¡å—é™äºç¡¬ä»¶ï¼Œå®¢è§‚å­˜åœ¨ç€èµ„æºç“¶é¢ˆï¼Œéš¾ä»¥åº”å¯¹ä¸æ–­å¢é•¿çš„æ•°æ®é‡å’Œè¯·æ±‚é‡ï¼Œä¸ºäº†æ‰“ç ´ç“¶é¢ˆï¼Œå¤§å‹ç³»ç»ŸåŸºæœ¬ä¸Šéƒ½è¢«è®¾è®¡ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p>
<p>åˆ†å¸ƒå¼ç³»ç»Ÿç”±äºå…¶é¢ä¸´çš„å…±æ€§é—®é¢˜ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹çš„è§£å†³æ–¹æ¡ˆå¾€å¾€ä¹Ÿå­˜åœ¨ç€å…±æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå¾ˆå¤šä¼˜ç§€çš„å¤§å‹ç³»ç»Ÿåœ¨è®¾è®¡æ–¹æ¡ˆä¸Šå­˜åœ¨ç€å¾ˆå¤šçš„å…±åŒç‚¹ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦è®¨è®ºåº”å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿå…±æ€§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™æ—¢å¯ä»¥åŠ æ·±å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿè¿ä½œåŸç†çš„ç†è§£ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè®¾è®¡å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶çš„å€Ÿé‰´ã€‚</p>
</blockquote>
<h2 id="1-åˆ†å¸ƒå¼äº‹åŠ¡"><a class="markdownIt-Anchor" href="#1-åˆ†å¸ƒå¼äº‹åŠ¡"></a> 1. åˆ†å¸ƒå¼äº‹åŠ¡</h2>
<blockquote>
<p>å‚è€ƒï¼š<a href="%E5%88%86%E5%B8%83%E5%BC%8F%E5%8E%9F%E7%90%86.md#4-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98">åˆ†å¸ƒå¼åŸç†#4-åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜</a></p>
</blockquote>
<h2 id="2-åˆ†å¸ƒå¼é”"><a class="markdownIt-Anchor" href="#2-åˆ†å¸ƒå¼é”"></a> 2. åˆ†å¸ƒå¼é”</h2>
<p>Java åŸç”Ÿ API è™½ç„¶æœ‰å¹¶å‘é”ï¼Œä½†å¹¶æ²¡æœ‰æä¾›åˆ†å¸ƒå¼é”çš„èƒ½åŠ›ï¼Œæ‰€ä»¥é’ˆå¯¹åˆ†å¸ƒå¼åœºæ™¯ä¸­çš„é”éœ€è¦è§£å†³çš„æ–¹æ¡ˆã€‚</p>
<p>åˆ†å¸ƒå¼é”çš„è§£å†³æ–¹æ¡ˆå¤§è‡´æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>åŸºäºæ•°æ®åº“å®ç°</li>
<li>åŸºäºç¼“å­˜ï¼ˆredisï¼Œmemcached ç­‰ï¼‰å®ç°</li>
<li>åŸºäº Zookeeper å®ç°</li>
</ul>
<h3 id="21-åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”"><a class="markdownIt-Anchor" href="#21-åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”"></a> 2.1. åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”</h3>
<h4 id="å®ç°"><a class="markdownIt-Anchor" href="#å®ç°"></a> å®ç°</h4>
<h5 id="1-åˆ›å»ºè¡¨"><a class="markdownIt-Anchor" href="#1-åˆ›å»ºè¡¨"></a> 1. åˆ›å»ºè¡¨</h5>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`methodLock`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'ä¸»é”®'</span>,</span><br><span class="line">  <span class="string">`method_name`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span> <span class="keyword">COMMENT</span> <span class="string">'é”å®šçš„æ–¹æ³•å'</span>,</span><br><span class="line">  <span class="string">`desc`</span> <span class="built_in">varchar</span>(<span class="number">1024</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'å¤‡æ³¨ä¿¡æ¯'</span>,</span><br><span class="line">  <span class="string">`update_time`</span> <span class="built_in">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'ä¿å­˜æ•°æ®æ—¶é—´ï¼Œè‡ªåŠ¨ç”Ÿæˆ'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`uidx_method_name`</span> (<span class="string">`method_name `</span>) <span class="keyword">USING</span> BTREE</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'é”å®šä¸­çš„æ–¹æ³•'</span>;</span><br></pre></td></tr></table></figure>
<h5 id="2-è·å–é”"><a class="markdownIt-Anchor" href="#2-è·å–é”"></a> 2. è·å–é”</h5>
<p>æƒ³è¦é”ä½æŸä¸ªæ–¹æ³•æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹ SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> methodLock(method_name,<span class="keyword">desc</span>) <span class="keyword">values</span> (â€˜method_nameâ€™,â€˜<span class="keyword">desc</span>â€™)</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæˆ‘ä»¬å¯¹ <code>method_name</code> åšäº†å”¯ä¸€æ€§çº¦æŸï¼Œè¿™é‡Œå¦‚æœæœ‰å¤šä¸ªè¯·æ±‚åŒæ—¶æäº¤åˆ°æ•°æ®åº“çš„è¯ï¼Œæ•°æ®åº“ä¼šä¿è¯åªæœ‰ä¸€ä¸ªæ“ä½œå¯ä»¥æˆåŠŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºæ“ä½œæˆåŠŸçš„é‚£ä¸ªçº¿ç¨‹è·å¾—äº†è¯¥æ–¹æ³•çš„é”ï¼Œå¯ä»¥æ‰§è¡Œæ–¹æ³•ä½“å†…å®¹ã€‚</p>
<p>æˆåŠŸæ’å…¥åˆ™è·å–é”ã€‚</p>
<h5 id="3-é‡Šæ”¾é”"><a class="markdownIt-Anchor" href="#3-é‡Šæ”¾é”"></a> 3. é‡Šæ”¾é”</h5>
<p>å½“æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæƒ³è¦é‡Šæ”¾é”çš„è¯ï¼Œéœ€è¦æ‰§è¡Œä»¥ä¸‹ Sql:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> methodLock <span class="keyword">where</span> method_name =<span class="string">'method_name'</span></span><br></pre></td></tr></table></figure>
<h4 id="é—®é¢˜"><a class="markdownIt-Anchor" href="#é—®é¢˜"></a> é—®é¢˜</h4>
<ol>
<li>è¿™æŠŠé”å¼ºä¾èµ–æ•°æ®åº“çš„å¯ç”¨æ€§ã€‚å¦‚æœæ•°æ®åº“æ˜¯ä¸€ä¸ªå•ç‚¹ï¼Œä¸€æ—¦æ•°æ®åº“æŒ‚æ‰ï¼Œä¼šå¯¼è‡´ä¸šåŠ¡ç³»ç»Ÿä¸å¯ç”¨ã€‚</li>
<li>è¿™æŠŠé”æ²¡æœ‰å¤±æ•ˆæ—¶é—´ï¼Œä¸€æ—¦è§£é”æ“ä½œå¤±è´¥ï¼Œå°±ä¼šå¯¼è‡´é”è®°å½•ä¸€ç›´åœ¨æ•°æ®åº“ä¸­ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•å†è·å¾—åˆ°é”ã€‚</li>
<li>è¿™æŠŠé”åªèƒ½æ˜¯éé˜»å¡çš„ï¼Œå› ä¸ºæ•°æ®çš„ insert æ“ä½œï¼Œä¸€æ—¦æ’å…¥å¤±è´¥å°±ä¼šç›´æ¥æŠ¥é”™ã€‚æ²¡æœ‰è·å¾—é”çš„çº¿ç¨‹å¹¶ä¸ä¼šè¿›å…¥æ’é˜Ÿé˜Ÿåˆ—ï¼Œè¦æƒ³å†æ¬¡è·å¾—é”å°±è¦å†æ¬¡è§¦å‘è·å¾—é”æ“ä½œã€‚</li>
<li>è¿™æŠŠé”æ˜¯éé‡å…¥çš„ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹åœ¨æ²¡æœ‰é‡Šæ”¾é”ä¹‹å‰æ— æ³•å†æ¬¡è·å¾—è¯¥é”ã€‚å› ä¸ºæ•°æ®ä¸­æ•°æ®å·²ç»å­˜åœ¨äº†ã€‚</li>
</ol>
<h4 id="è§£å†³åŠæ³•"><a class="markdownIt-Anchor" href="#è§£å†³åŠæ³•"></a> è§£å†³åŠæ³•</h4>
<ol>
<li>å•ç‚¹é—®é¢˜å¯ä»¥ç”¨å¤šæ•°æ®åº“å®ä¾‹ï¼ŒåŒæ—¶å¡ N ä¸ªè¡¨ï¼ŒN/2+1 ä¸ªæˆåŠŸå°±ä»»åŠ¡é”å®šæˆåŠŸ</li>
<li>å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œéš”ä¸€æ®µæ—¶é—´æ¸…é™¤ä¸€æ¬¡è¿‡æœŸçš„æ•°æ®ã€‚</li>
<li>å†™ä¸€ä¸ª while å¾ªç¯ï¼Œä¸æ–­çš„é‡è¯•æ’å…¥ï¼Œç›´åˆ°æˆåŠŸã€‚</li>
<li>åœ¨æ•°æ®åº“è¡¨ä¸­åŠ ä¸ªå­—æ®µï¼Œè®°å½•å½“å‰è·å¾—é”çš„æœºå™¨çš„ä¸»æœºä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯ï¼Œé‚£ä¹ˆä¸‹æ¬¡å†è·å–é”çš„æ—¶å€™å…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œå¦‚æœå½“å‰æœºå™¨çš„ä¸»æœºä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯åœ¨æ•°æ®åº“å¯ä»¥æŸ¥åˆ°çš„è¯ï¼Œç›´æ¥æŠŠé”åˆ†é…ç»™ä»–å°±å¯ä»¥äº†ã€‚</li>
</ol>
<h4 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h4>
<ul>
<li>ä¼˜ç‚¹: ç›´æ¥å€ŸåŠ©æ•°æ®åº“ï¼Œå®¹æ˜“ç†è§£ã€‚</li>
<li>ç¼ºç‚¹: ä¼šæœ‰å„ç§å„æ ·çš„é—®é¢˜ï¼Œåœ¨è§£å†³é—®é¢˜çš„è¿‡ç¨‹ä¸­ä¼šä½¿æ•´ä¸ªæ–¹æ¡ˆå˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚æ“ä½œæ•°æ®åº“éœ€è¦ä¸€å®šçš„å¼€é”€ï¼Œæ€§èƒ½é—®é¢˜éœ€è¦è€ƒè™‘ã€‚</li>
</ul>
<h3 id="22-åŸºäº-redis-å®ç°åˆ†å¸ƒå¼é”"><a class="markdownIt-Anchor" href="#22-åŸºäº-redis-å®ç°åˆ†å¸ƒå¼é”"></a> 2.2. åŸºäº Redis å®ç°åˆ†å¸ƒå¼é”</h3>
<p>ç›¸æ¯”äºç”¨æ•°æ®åº“æ¥å®ç°åˆ†å¸ƒå¼é”ï¼ŒåŸºäºç¼“å­˜å®ç°çš„åˆ†å¸ƒå¼é”çš„æ€§èƒ½ä¼šæ›´å¥½ä¸€äº›ã€‚ç›®å‰æœ‰å¾ˆå¤šæˆç†Ÿçš„åˆ†å¸ƒå¼äº§å“ï¼ŒåŒ…æ‹¬ Redisã€memcacheã€Tair ç­‰ã€‚è¿™é‡Œä»¥ Redis ä¸¾ä¾‹ã€‚</p>
<h4 id="redis-å‘½ä»¤"><a class="markdownIt-Anchor" href="#redis-å‘½ä»¤"></a> Redis å‘½ä»¤</h4>
<ul>
<li>setnx - setnx key valï¼šå½“ä¸”ä»…å½“ key ä¸å­˜åœ¨æ—¶ï¼Œset ä¸€ä¸ª key ä¸º val çš„å­—ç¬¦ä¸²ï¼Œè¿”å› 1ï¼›è‹¥ key å­˜åœ¨ï¼Œåˆ™ä»€ä¹ˆéƒ½ä¸åšï¼Œè¿”å› 0ã€‚</li>
<li>expire - expire key timeoutï¼šä¸º key è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸º secondï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´é”ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œé¿å…æ­»é”ã€‚</li>
<li>delete - delete keyï¼šåˆ é™¤ key</li>
</ul>
<h4 id="å®ç°-2"><a class="markdownIt-Anchor" href="#å®ç°-2"></a> å®ç°</h4>
<p>å•ç‚¹å®ç°æ­¥éª¤ï¼š</p>
<ol>
<li>è·å–é”çš„ä½¿ç”¨ï¼Œä½¿ç”¨ setnx åŠ é”ï¼Œé”çš„ value å€¼ä¸ºä¸€ä¸ªéšæœºç”Ÿæˆçš„ UUIDï¼Œå†ä½¿ç”¨ expire è®¾ç½®ä¸€ä¸ªè¿‡æœŸå€¼ã€‚</li>
<li>è·å–é”çš„æ—¶å€™è¿˜è®¾ç½®ä¸€ä¸ªè·å–çš„è¶…æ—¶æ—¶é—´ï¼Œè‹¥è¶…è¿‡è¿™ä¸ªæ—¶é—´åˆ™æ”¾å¼ƒè·å–é”ã€‚</li>
<li>é‡Šæ”¾é”çš„æ—¶å€™ï¼Œé€šè¿‡ UUID åˆ¤æ–­æ˜¯ä¸æ˜¯è¯¥é”ï¼Œè‹¥æ˜¯è¯¥é”ï¼Œåˆ™æ‰§è¡Œ delete è¿›è¡Œé”é‡Šæ”¾ã€‚</li>
</ol>
<h4 id="é—®é¢˜-2"><a class="markdownIt-Anchor" href="#é—®é¢˜-2"></a> é—®é¢˜</h4>
<ul>
<li>å•ç‚¹é—®é¢˜ã€‚å¦‚æœå•æœº redis æŒ‚æ‰äº†ï¼Œé‚£ä¹ˆç¨‹åºä¼šè·Ÿç€å‡ºé”™ã€‚</li>
<li>å¦‚æœè½¬ç§»ä½¿ç”¨ slave èŠ‚ç‚¹ï¼Œå¤åˆ¶ä¸æ˜¯åŒæ­¥å¤åˆ¶ï¼Œä¼šå‡ºç°å¤šä¸ªç¨‹åºè·å–é”çš„æƒ…å†µ</li>
</ul>
<h4 id="å°ç»“-2"><a class="markdownIt-Anchor" href="#å°ç»“-2"></a> å°ç»“</h4>
<p>å¯ä»¥è€ƒè™‘ä½¿ç”¨ <a href="https://github.com/redisson/redisson/wiki/8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8" target="_blank" rel="noopener">redisson çš„è§£å†³æ–¹æ¡ˆ</a>ã€‚</p>
<h3 id="23-åŸºäº-zookeeper-å®ç°åˆ†å¸ƒå¼é”"><a class="markdownIt-Anchor" href="#23-åŸºäº-zookeeper-å®ç°åˆ†å¸ƒå¼é”"></a> 2.3. åŸºäº ZooKeeper å®ç°åˆ†å¸ƒå¼é”</h3>
<h4 id="å®ç°-3"><a class="markdownIt-Anchor" href="#å®ç°-3"></a> å®ç°</h4>
<p>è¿™ä¹Ÿæ˜¯ ZooKeeper å®¢æˆ·ç«¯ curator çš„åˆ†å¸ƒå¼é”å®ç°ã€‚</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç›®å½• mylockï¼›</li>
<li>çº¿ç¨‹ A æƒ³è·å–é”å°±åœ¨ mylock ç›®å½•ä¸‹åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼›</li>
<li>è·å– mylock ç›®å½•ä¸‹æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œç„¶åè·å–æ¯”è‡ªå·±å°çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜å½“å‰çº¿ç¨‹é¡ºåºå·æœ€å°ï¼Œè·å¾—é”ï¼›</li>
<li>çº¿ç¨‹ B è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ¤æ–­è‡ªå·±ä¸æ˜¯æœ€å°èŠ‚ç‚¹ï¼Œè®¾ç½®ç›‘å¬æ¯”è‡ªå·±æ¬¡å°çš„èŠ‚ç‚¹ï¼›</li>
<li>çº¿ç¨‹ A å¤„ç†å®Œï¼Œåˆ é™¤è‡ªå·±çš„èŠ‚ç‚¹ï¼Œçº¿ç¨‹ B ç›‘å¬åˆ°å˜æ›´äº‹ä»¶ï¼Œåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯åˆ™è·å¾—é”ã€‚</li>
</ol>
<h4 id="å°ç»“-3"><a class="markdownIt-Anchor" href="#å°ç»“-3"></a> å°ç»“</h4>
<p>ZooKeeper ç‰ˆæœ¬çš„åˆ†å¸ƒå¼é”é—®é¢˜ç›¸å¯¹æ¯”è¾ƒæ¥è¯´å°‘ã€‚</p>
<ul>
<li>é”çš„å ç”¨æ—¶é—´é™åˆ¶ï¼šredis å°±æœ‰å ç”¨æ—¶é—´é™åˆ¶ï¼Œè€Œ ZooKeeper åˆ™æ²¡æœ‰ï¼Œæœ€ä¸»è¦çš„åŸå› æ˜¯ redis ç›®å‰æ²¡æœ‰åŠæ³•çŸ¥é“å·²ç»è·å–é”çš„å®¢æˆ·ç«¯çš„çŠ¶æ€ï¼Œæ˜¯å·²ç»æŒ‚äº†å‘¢è¿˜æ˜¯æ­£åœ¨æ‰§è¡Œè€—æ—¶è¾ƒé•¿çš„ä¸šåŠ¡é€»è¾‘ã€‚è€Œ ZooKeeper é€šè¿‡ä¸´æ—¶èŠ‚ç‚¹å°±èƒ½æ¸…æ™°çŸ¥é“ï¼Œå¦‚æœä¸´æ—¶èŠ‚ç‚¹å­˜åœ¨è¯´æ˜è¿˜åœ¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æœä¸´æ—¶èŠ‚ç‚¹ä¸å­˜åœ¨è¯´æ˜å·²ç»æ‰§è¡Œå®Œæ¯•é‡Šæ”¾é”æˆ–è€…æ˜¯æŒ‚äº†ã€‚ç”±æ­¤çœ‹æ¥ redis å¦‚æœèƒ½åƒ ZooKeeper ä¸€æ ·æ·»åŠ ä¸€äº›ä¸å®¢æˆ·ç«¯ç»‘å®šçš„ä¸´æ—¶é”®ï¼Œä¹Ÿæ˜¯ä¸€å¤§å¥½äº‹ã€‚</li>
<li>æ˜¯å¦å•ç‚¹æ•…éšœï¼šredis æœ¬èº«æœ‰å¾ˆå¤šä¸­ç©æ³•ï¼Œå¦‚å®¢æˆ·ç«¯ä¸€è‡´æ€§ hashï¼ŒæœåŠ¡å™¨ç«¯ sentinel æ–¹æ¡ˆæˆ–è€… cluster æ–¹æ¡ˆï¼Œå¾ˆéš¾åšåˆ°ä¸€ç§åˆ†å¸ƒå¼é”æ–¹å¼èƒ½åº”å¯¹æ‰€æœ‰è¿™äº›æ–¹æ¡ˆã€‚è€Œ ZooKeeper åªæœ‰ä¸€ç§ç©æ³•ï¼Œå¤šå°æœºå™¨çš„èŠ‚ç‚¹æ•°æ®æ˜¯ä¸€è‡´çš„ï¼Œæ²¡æœ‰ redis çš„é‚£ä¹ˆå¤šçš„éº»çƒ¦å› ç´ è¦è€ƒè™‘ã€‚</li>
</ul>
<p>æ€»ä½“ä¸Šæ¥è¯´ ZooKeeper å®ç°åˆ†å¸ƒå¼é”æ›´åŠ çš„ç®€å•ï¼Œå¯é æ€§æ›´é«˜ã€‚ä½† ZooKeeper å› ä¸ºéœ€è¦é¢‘ç¹çš„åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹ï¼Œæ€§èƒ½ä¸Šä¸å¦‚ Redis æ–¹å¼ã€‚</p>
<h2 id="3-åˆ†å¸ƒå¼-session"><a class="markdownIt-Anchor" href="#3-åˆ†å¸ƒå¼-session"></a> 3. åˆ†å¸ƒå¼ Session</h2>
<p>åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œä¸€ä¸ªç”¨æˆ·çš„ Session å¦‚æœåªå­˜å‚¨åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆå½“è´Ÿè½½å‡è¡¡å™¨æŠŠç”¨æˆ·çš„ä¸‹ä¸€ä¸ªè¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¯¥æœåŠ¡å™¨æ²¡æœ‰ç”¨æˆ·çš„ Sessionï¼Œå°±å¯èƒ½å¯¼è‡´ç”¨æˆ·éœ€è¦é‡æ–°è¿›è¡Œç™»å½•ç­‰æ“ä½œã€‚</p>
<p>åˆ†å¸ƒå¼ Session çš„å‡ ç§å®ç°ç­–ç•¥ï¼š</p>
<ol>
<li>ç²˜æ€§ session</li>
<li>åº”ç”¨æœåŠ¡å™¨é—´çš„ session å¤åˆ¶å…±äº«</li>
<li>åŸºäº cache DB ç¼“å­˜çš„ session å…±äº«</li>
</ol>
<h3 id="31-sticky-sessions"><a class="markdownIt-Anchor" href="#31-sticky-sessions"></a> 3.1. Sticky Sessions</h3>
<p>éœ€è¦é…ç½®è´Ÿè½½å‡è¡¡å™¨ï¼Œä½¿å¾—ä¸€ä¸ªç”¨æˆ·çš„æ‰€æœ‰è¯·æ±‚éƒ½è·¯ç”±åˆ°ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥æŠŠç”¨æˆ·çš„ Session å­˜æ”¾åœ¨è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸­ã€‚</p>
<p>ç¼ºç‚¹ï¼šå½“æœåŠ¡å™¨èŠ‚ç‚¹å®•æœºæ—¶ï¼Œå°†ä¸¢å¤±è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰ Sessionã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/MultiNode-StickySessions.jpg" />
</div>
<h3 id="32-session-replication"><a class="markdownIt-Anchor" href="#32-session-replication"></a> 3.2. Session Replication</h3>
<p>åœ¨æœåŠ¡å™¨èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œ Session åŒæ­¥æ“ä½œï¼Œè¿™æ ·çš„è¯ç”¨æˆ·å¯ä»¥è®¿é—®ä»»ä½•ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ã€‚</p>
<p>ç¼ºç‚¹ï¼šå ç”¨è¿‡å¤šå†…å­˜ï¼›åŒæ­¥è¿‡ç¨‹å ç”¨ç½‘ç»œå¸¦å®½ä»¥åŠæœåŠ¡å™¨å¤„ç†å™¨æ—¶é—´ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/MultiNode-SessionReplication.jpg" />
</div>
<h3 id="33-session-server"><a class="markdownIt-Anchor" href="#33-session-server"></a> 3.3. Session Server</h3>
<p>ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„æœåŠ¡å™¨å­˜å‚¨ Session æ•°æ®ï¼Œå¯ä»¥å­˜åœ¨ MySQL æ•°æ®åº“ä¸Šï¼Œä¹Ÿå¯ä»¥å­˜åœ¨ Redis æˆ–è€… Memcached è¿™ç§å†…å­˜å‹æ•°æ®åº“ã€‚</p>
<p>ç¼ºç‚¹ï¼šéœ€è¦å»å®ç°å­˜å– Session çš„ä»£ç ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/MultiNode-SpringSession.jpg" />
</div>
<h2 id="4-åˆ†å¸ƒå¼å­˜å‚¨"><a class="markdownIt-Anchor" href="#4-åˆ†å¸ƒå¼å­˜å‚¨"></a> 4. åˆ†å¸ƒå¼å­˜å‚¨</h2>
<p>é€šå¸¸æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>æ•°æ®åˆ†å¸ƒï¼šå°±æ˜¯æŠŠæ•°æ®åˆ†å—å­˜åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼ˆåˆ†åº“åˆ†è¡¨ï¼‰ã€‚</li>
<li>æ•°æ®å¤åˆ¶ï¼šè®©æ‰€æœ‰çš„æœåŠ¡å™¨éƒ½æœ‰ç›¸åŒçš„æ•°æ®ï¼Œæä¾›ç›¸å½“çš„æœåŠ¡ã€‚</li>
</ol>
<blockquote>
<p>å‚è€ƒï¼š<a href="%E5%88%86%E5%B8%83%E5%BC%8F%E5%8E%9F%E7%90%86.md#2-%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83">åˆ†å¸ƒå¼åŸç†.md#2-æ•°æ®åˆ†å¸ƒ</a></p>
</blockquote>
<h2 id="5-åˆ†å¸ƒå¼ç¼“å­˜"><a class="markdownIt-Anchor" href="#5-åˆ†å¸ƒå¼ç¼“å­˜"></a> 5. åˆ†å¸ƒå¼ç¼“å­˜</h2>
<p>ä½¿ç”¨ç¼“å­˜çš„å¥½å¤„ï¼š</p>
<ul>
<li>æå‡æ•°æ®è¯»å–é€Ÿåº¦</li>
<li>æå‡ç³»ç»Ÿæ‰©å±•èƒ½åŠ›ï¼Œé€šè¿‡æ‰©å±•ç¼“å­˜ï¼Œæå‡ç³»ç»Ÿæ‰¿è½½èƒ½åŠ›</li>
<li>é™ä½å­˜å‚¨æˆæœ¬ï¼ŒCache+DB çš„æ–¹å¼å¯ä»¥æ‰¿æ‹…åŸæœ‰éœ€è¦å¤šå° DB æ‰èƒ½æ‰¿æ‹…çš„è¯·æ±‚é‡ï¼ŒèŠ‚çœæœºå™¨æˆæœ¬</li>
</ul>
<p>æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼Œé€šå¸¸ç¼“å­˜æœ‰ä»¥ä¸‹å‡ ç§ä½¿ç”¨æ–¹å¼</p>
<ul>
<li>æ‡’æ±‰å¼(è¯»æ—¶è§¦å‘)ï¼šå†™å…¥ DB å, ç„¶åæŠŠç›¸å…³çš„æ•°æ®ä¹Ÿå†™å…¥ Cache</li>
<li>é¥¥é¥¿å¼(å†™æ—¶è§¦å‘)ï¼šå…ˆæŸ¥è¯¢ DB é‡Œçš„æ•°æ®, ç„¶åæŠŠç›¸å…³çš„æ•°æ®å†™å…¥ Cache</li>
<li>å®šæœŸåˆ·æ–°ï¼šé€‚åˆå‘¨æœŸæ€§çš„è·‘æ•°æ®çš„ä»»åŠ¡ï¼Œæˆ–è€…åˆ—è¡¨å‹çš„æ•°æ®ï¼Œè€Œä¸”ä¸è¦æ±‚ç»å¯¹å®æ—¶æ€§</li>
</ul>
<p>ç¼“å­˜åˆ†ç±»ï¼š</p>
<ul>
<li>åº”ç”¨å†…ç¼“å­˜ï¼šå¦‚ï¼šEHCache</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜ï¼šå¦‚ï¼šMemachedã€Redis</li>
</ul>
<blockquote>
<p>å‚è€ƒï¼š<a href="%E5%88%86%E5%B8%83%E5%BC%8F%E5%8E%9F%E7%90%86.md#6-%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98">åˆ†å¸ƒå¼åŸç†.md#6-åˆ†å¸ƒå¼ç¼“å­˜é—®é¢˜</a></p>
</blockquote>
<h2 id="6-åˆ†å¸ƒå¼è®¡ç®—"><a class="markdownIt-Anchor" href="#6-åˆ†å¸ƒå¼è®¡ç®—"></a> 6. åˆ†å¸ƒå¼è®¡ç®—</h2>
<h2 id="7-è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#7-è´Ÿè½½å‡è¡¡"></a> 7. è´Ÿè½½å‡è¡¡</h2>
<h3 id="71-ç®—æ³•"><a class="markdownIt-Anchor" href="#71-ç®—æ³•"></a> 7.1. ç®—æ³•</h3>
<h4 id="è½®è¯¢round-robin"><a class="markdownIt-Anchor" href="#è½®è¯¢round-robin"></a> è½®è¯¢ï¼ˆRound Robinï¼‰</h4>
<p>è½®è¯¢ç®—æ³•æŠŠæ¯ä¸ªè¯·æ±‚è½®æµå‘é€åˆ°æ¯ä¸ªæœåŠ¡å™¨ä¸Šã€‚ä¸‹å›¾ä¸­ï¼Œä¸€å…±æœ‰ 6 ä¸ªå®¢æˆ·ç«¯äº§ç”Ÿäº† 6 ä¸ªè¯·æ±‚ï¼Œè¿™ 6 ä¸ªè¯·æ±‚æŒ‰ (1, 2, 3, 4, 5, 6) çš„é¡ºåºå‘é€ã€‚æœ€åï¼Œ(1, 3, 5) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œ(2, 4, 6) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 2ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹è½®è¯¢-01.jpg" width="640"/>
</div>
<p>è¯¥ç®—æ³•æ¯”è¾ƒé€‚åˆæ¯ä¸ªæœåŠ¡å™¨çš„æ€§èƒ½å·®ä¸å¤šçš„åœºæ™¯ï¼Œå¦‚æœæœ‰æ€§èƒ½å­˜åœ¨å·®å¼‚çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆæ€§èƒ½è¾ƒå·®çš„æœåŠ¡å™¨å¯èƒ½æ— æ³•æ‰¿æ‹…è¿‡å¤§çš„è´Ÿè½½ï¼ˆä¸‹å›¾çš„ Server 2ï¼‰ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹è½®è¯¢-02.jpg" width="640"/>
</div>
<h4 id="åŠ æƒè½®è¯¢weighted-round-robbin"><a class="markdownIt-Anchor" href="#åŠ æƒè½®è¯¢weighted-round-robbin"></a> åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robbinï¼‰</h4>
<p>åŠ æƒè½®è¯¢æ˜¯åœ¨è½®è¯¢çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ€§èƒ½å·®å¼‚ï¼Œä¸ºæœåŠ¡å™¨èµ‹äºˆä¸€å®šçš„æƒå€¼ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ 1 è¢«èµ‹äºˆçš„æƒå€¼ä¸º 5ï¼ŒæœåŠ¡å™¨ 2 è¢«èµ‹äºˆçš„æƒå€¼ä¸º 1ï¼Œé‚£ä¹ˆ (1, 2, 3, 4, 5) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œ(6) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 2ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹åŠ æƒè½®è¯¢.jpg" width="640"/>
</div>
<h4 id="æœ€å°‘è¿æ¥least-connections"><a class="markdownIt-Anchor" href="#æœ€å°‘è¿æ¥least-connections"></a> æœ€å°‘è¿æ¥ï¼ˆleast Connectionsï¼‰</h4>
<p>ç”±äºæ¯ä¸ªè¯·æ±‚çš„è¿æ¥æ—¶é—´ä¸ä¸€æ ·ï¼Œä½¿ç”¨è½®è¯¢æˆ–è€…åŠ æƒè½®è¯¢ç®—æ³•çš„è¯ï¼Œå¯èƒ½ä¼šè®©ä¸€å°æœåŠ¡å™¨å½“å‰è¿æ¥æ•°è¿‡å¤§ï¼Œè€Œå¦ä¸€å°æœåŠ¡å™¨çš„è¿æ¥è¿‡å°ï¼Œé€ æˆè´Ÿè½½ä¸å‡è¡¡ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼Œ(1, 3, 5) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œä½†æ˜¯ (1, 3) å¾ˆå¿«å°±æ–­å¼€è¿æ¥ï¼Œæ­¤æ—¶åªæœ‰ (5) è¯·æ±‚è¿æ¥æœåŠ¡å™¨ 1ï¼›(2, 4, 6) è¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ 2ï¼Œåªæœ‰ (2) çš„è¿æ¥æ–­å¼€ã€‚è¯¥ç³»ç»Ÿç»§ç»­è¿è¡Œæ—¶ï¼ŒæœåŠ¡å™¨ 2 ä¼šæ‰¿æ‹…è¿‡å¤§çš„è´Ÿè½½ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹æœ€å°‘è¿æ¥-01.jpg" width="640"/>
</div>
<p>æœ€å°‘è¿æ¥ç®—æ³•å°±æ˜¯å°†è¯·æ±‚å‘é€ç»™å½“å‰æœ€å°‘è¿æ¥æ•°çš„æœåŠ¡å™¨ä¸Šã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ 1 å½“å‰è¿æ¥æ•°æœ€å°ï¼Œé‚£ä¹ˆæ–°åˆ°æ¥çš„è¯·æ±‚ 6 å°±ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1 ä¸Šã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹æœ€å°‘è¿æ¥-02.jpg" width="640"/>
</div>
<h4 id="åŠ æƒæœ€å°‘è¿æ¥weighted-least-connection"><a class="markdownIt-Anchor" href="#åŠ æƒæœ€å°‘è¿æ¥weighted-least-connection"></a> åŠ æƒæœ€å°‘è¿æ¥ï¼ˆWeighted Least Connectionï¼‰</h4>
<p>åœ¨æœ€å°‘è¿æ¥çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ€§èƒ½ä¸ºæ¯å°æœåŠ¡å™¨åˆ†é…æƒé‡ï¼Œå†æ ¹æ®æƒé‡è®¡ç®—å‡ºæ¯å°æœåŠ¡å™¨èƒ½å¤„ç†çš„è¿æ¥æ•°ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹åŠ æƒæœ€å°‘è¿æ¥.jpg" width="640"/>
</div>
<h4 id="éšæœºç®—æ³•random"><a class="markdownIt-Anchor" href="#éšæœºç®—æ³•random"></a> éšæœºç®—æ³•ï¼ˆRandomï¼‰</h4>
<p>æŠŠè¯·æ±‚éšæœºå‘é€åˆ°æœåŠ¡å™¨ä¸Šã€‚å’Œè½®è¯¢ç®—æ³•ç±»ä¼¼ï¼Œè¯¥ç®—æ³•æ¯”è¾ƒé€‚åˆæœåŠ¡å™¨æ€§èƒ½å·®ä¸å¤šçš„åœºæ™¯ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹éšæœº.jpg" width="640"/>
</div>
<h4 id="æºåœ°å€å“ˆå¸Œæ³•-ip-hash"><a class="markdownIt-Anchor" href="#æºåœ°å€å“ˆå¸Œæ³•-ip-hash"></a> æºåœ°å€å“ˆå¸Œæ³• (IP Hash)</h4>
<p>æºåœ°å€å“ˆå¸Œé€šè¿‡å¯¹å®¢æˆ·ç«¯ IP å“ˆå¸Œè®¡ç®—å¾—åˆ°çš„ä¸€ä¸ªæ•°å€¼ï¼Œç”¨è¯¥æ•°å€¼å¯¹æœåŠ¡å™¨æ•°é‡è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œå–æ¨¡ç»“æœä¾¿æ˜¯ç›®æ ‡æœåŠ¡å™¨çš„åºå·ã€‚</p>
<ul>
<li>ä¼˜ç‚¹ï¼šä¿è¯åŒä¸€ IP çš„å®¢æˆ·ç«¯éƒ½ä¼šè¢« hash åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šã€‚</li>
<li>ç¼ºç‚¹ï¼šä¸åˆ©äºé›†ç¾¤æ‰©å±•ï¼Œåå°æœåŠ¡å™¨æ•°é‡å˜æ›´éƒ½ä¼šå½±å“ hash ç»“æœã€‚å¯ä»¥é‡‡ç”¨ä¸€è‡´æ€§ Hash æ”¹è¿›ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/è´Ÿè½½å‡è¡¡ç®—æ³•ä¹‹IpHash.jpg" width="640"/>
</div>
<h3 id="72-å®ç°"><a class="markdownIt-Anchor" href="#72-å®ç°"></a> 7.2. å®ç°</h3>
<h4 id="http-é‡å®šå‘"><a class="markdownIt-Anchor" href="#http-é‡å®šå‘"></a> HTTP é‡å®šå‘</h4>
<p>HTTP é‡å®šå‘è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ”¶åˆ° HTTP è¯·æ±‚ä¹‹åä¼šè¿”å›æœåŠ¡å™¨çš„åœ°å€ï¼Œå¹¶å°†è¯¥åœ°å€å†™å…¥ HTTP é‡å®šå‘å“åº”ä¸­è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ”¶åˆ°åéœ€è¦å†æ¬¡å‘é€è¯·æ±‚ã€‚</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç”¨æˆ·è®¿é—®çš„å»¶è¿Ÿä¼šå¢åŠ ï¼›</li>
<li>å¦‚æœè´Ÿè½½å‡è¡¡å™¨å®•æœºï¼Œå°±æ— æ³•è®¿é—®è¯¥ç«™ç‚¹ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/Httpé‡å®šå‘.png" width="640"/>
</div>
<h4 id="dns-é‡å®šå‘"><a class="markdownIt-Anchor" href="#dns-é‡å®šå‘"></a> DNS é‡å®šå‘</h4>
<p>ä½¿ç”¨ DNS ä½œä¸ºè´Ÿè½½å‡è¡¡å™¨ï¼Œæ ¹æ®è´Ÿè½½æƒ…å†µè¿”å›ä¸åŒæœåŠ¡å™¨çš„ IP åœ°å€ã€‚å¤§å‹ç½‘ç«™åŸºæœ¬ä½¿ç”¨äº†è¿™ç§æ–¹å¼åšä¸ºç¬¬ä¸€çº§è´Ÿè½½å‡è¡¡æ‰‹æ®µï¼Œç„¶ååœ¨å†…éƒ¨ä½¿ç”¨å…¶å®ƒæ–¹å¼åšç¬¬äºŒçº§è´Ÿè½½å‡è¡¡ã€‚</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>DNS æŸ¥æ‰¾è¡¨å¯èƒ½ä¼šè¢«å®¢æˆ·ç«¯ç¼“å­˜èµ·æ¥ï¼Œé‚£ä¹ˆä¹‹åçš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«é‡å®šå‘åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/Dnsé‡å®šå‘.png" width="640"/>
</div>
<h4 id="ä¿®æ”¹-mac-åœ°å€"><a class="markdownIt-Anchor" href="#ä¿®æ”¹-mac-åœ°å€"></a> ä¿®æ”¹ MAC åœ°å€</h4>
<p>ä½¿ç”¨ LVSï¼ˆLinux Virtual Serverï¼‰è¿™ç§é“¾è·¯å±‚è´Ÿè½½å‡è¡¡å™¨ï¼Œæ ¹æ®è´Ÿè½½æƒ…å†µä¿®æ”¹è¯·æ±‚çš„ MAC åœ°å€ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ä¿®æ”¹Macåœ°å€.png" width="640"/>
</div>
<h4 id="ä¿®æ”¹-ip-åœ°å€"><a class="markdownIt-Anchor" href="#ä¿®æ”¹-ip-åœ°å€"></a> ä¿®æ”¹ IP åœ°å€</h4>
<p>åœ¨ç½‘ç»œå±‚ä¿®æ”¹è¯·æ±‚çš„ç›®çš„ IP åœ°å€ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ä¿®æ”¹IPåœ°å€.png" width="640"/>
</div>
<h4 id="ä»£ç†è‡ªåŠ¨é…ç½®"><a class="markdownIt-Anchor" href="#ä»£ç†è‡ªåŠ¨é…ç½®"></a> ä»£ç†è‡ªåŠ¨é…ç½®</h4>
<p>æ­£å‘ä»£ç†ä¸åå‘ä»£ç†çš„åŒºåˆ«ï¼š</p>
<ul>
<li>æ­£å‘ä»£ç†ï¼šå‘ç”Ÿåœ¨å®¢æˆ·ç«¯ï¼Œæ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å‘èµ·çš„ã€‚æ¯”å¦‚ç¿»å¢™ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä¸»åŠ¨è®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œè®©ä»£ç†æœåŠ¡å™¨è·å¾—éœ€è¦çš„å¤–ç½‘æ•°æ®ï¼Œç„¶åè½¬å‘å›å®¢æˆ·ç«¯ã€‚</li>
<li>åå‘ä»£ç†ï¼šå‘ç”Ÿåœ¨æœåŠ¡å™¨ç«¯ï¼Œç”¨æˆ·ä¸çŸ¥é“ä»£ç†çš„å­˜åœ¨ã€‚</li>
</ul>
<p>PAC æœåŠ¡å™¨æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªè¯·æ±‚æ˜¯å¦è¦ç»è¿‡ä»£ç†ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ä»£ç†è‡ªåŠ¨é…ç½®.jpg" width="640"/>
</div>
<h2 id="8-èµ„æ–™"><a class="markdownIt-Anchor" href="#8-èµ„æ–™"></a> 8. èµ„æ–™</h2>
<ul>
<li><a href="https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html" target="_blank" rel="noopener">https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html</a></li>
<li><a href="https://github.com/CyC2018/Interview-Notebook/blob/master/notes/%E5%88%86%E5%B8%83%E5%BC%8F%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90.md" target="_blank" rel="noopener">https://github.com/CyC2018/Interview-Notebook/blob/master/notes/åˆ†å¸ƒå¼é—®é¢˜åˆ†æ.md</a></li>
<li><a href="https://www.jianshu.com/p/453c6e7ff81c" target="_blank" rel="noopener">https://www.jianshu.com/p/453c6e7ff81c</a></li>
<li><a href="https://juejin.im/post/5a20cd8bf265da43163cdd9a" target="_blank" rel="noopener">https://juejin.im/post/5a20cd8bf265da43163cdd9a</a></li>
<li><a href="https://github.com/redisson/redisson/wiki/8.-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%92%8C%E5%90%8C%E6%AD%A5%E5%99%A8" target="_blank" rel="noopener">https://github.com/redisson/redisson/wiki/8.-åˆ†å¸ƒå¼é”å’ŒåŒæ­¥å™¨</a></li>
<li><a href="https://github.com/L316476844/distributed-session" target="_blank" rel="noopener">https://github.com/L316476844/distributed-session</a></li>
<li><a href="https://juejin.im/entry/57e39e320e3dd90058021bff" target="_blank" rel="noopener">åˆ†å¸ƒå¼ç¼“å­˜æ¶æ„åŸºç¡€</a></li>
<li><a href="https://www.toutiao.com/i6533812974807679495/?tt_from=weixin&amp;utm_campaign=client_share&amp;from=singlemessage&amp;timestamp=1521281305&amp;app=news_article&amp;utm_source=weixin&amp;iid=28128279343&amp;utm_medium=toutiao_android&amp;weixin_list=1&amp;wxshare_count=2&amp;pbid=6517746516513195523" target="_blank" rel="noopener">é˜¿é‡Œ P8 æŠ€æœ¯ä¸“å®¶ç»†ç©¶åˆ†å¸ƒå¼ç¼“å­˜é—®é¢˜</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>æ¶æ„</tag>
        <tag>åˆ†å¸ƒå¼</tag>
      </tags>
  </entry>
  <entry>
    <title>è´Ÿè½½å‡è¡¡åŸºæœ¬åŸç†</title>
    <url>/blog/design/theory/load-balance-theory/</url>
    <content><![CDATA[<h1 id="è´Ÿè½½å‡è¡¡åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#è´Ÿè½½å‡è¡¡åŸºæœ¬åŸç†"></a> è´Ÿè½½å‡è¡¡åŸºæœ¬åŸç†</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#1-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%80%E4%BB%8B">1. è´Ÿè½½å‡è¡¡ç®€ä»‹</a>
<ul>
<li><a href="#11-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E4%BD%9C%E7%94%A8">1.1. è´Ÿè½½å‡è¡¡çš„ä½œç”¨</a></li>
<li><a href="#12-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%88%86%E7%B1%BB">1.2. è´Ÿè½½å‡è¡¡çš„åˆ†ç±»</a></li>
</ul>
</li>
<li><a href="#2-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95">2. è´Ÿè½½å‡è¡¡ç®—æ³•</a>
<ul>
<li><a href="#21-%E8%BD%AE%E8%AF%A2">2.1. è½®è¯¢</a></li>
<li><a href="#22-%E9%9A%8F%E6%9C%BA">2.2. éšæœº</a></li>
<li><a href="#23-%E6%9C%80%E5%B0%91%E8%BF%9E%E6%8E%A5">2.3. æœ€å°‘è¿æ¥</a></li>
<li><a href="#24-%E6%BA%90%E5%9C%B0%E5%9D%80%E5%93%88%E5%B8%8C">2.4. æºåœ°å€å“ˆå¸Œ</a></li>
<li><a href="#25-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C">2.5. ä¸€è‡´æ€§å“ˆå¸Œ</a></li>
</ul>
</li>
<li><a href="#3-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%8A%80%E6%9C%AF">3. è´Ÿè½½å‡è¡¡æŠ€æœ¯</a>
<ul>
<li><a href="#31-dns-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">3.1. DNS è´Ÿè½½å‡è¡¡</a></li>
<li><a href="#32-http-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">3.2. HTTP è´Ÿè½½å‡è¡¡</a></li>
<li><a href="#33-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86">3.3. åå‘ä»£ç†</a></li>
<li><a href="#34-%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E5%8F%91">3.4. ç½‘ç»œåœ°å€è½¬å‘</a></li>
<li><a href="#35-%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF">3.5. éš§é“æŠ€æœ¯</a></li>
<li><a href="#36-%E7%9B%B4%E6%8E%A5%E8%B7%AF%E7%94%B1">3.6. ç›´æ¥è·¯ç”±</a></li>
<li><a href="#37-%E6%B7%B7%E5%90%88%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">3.7. æ··åˆè´Ÿè½½å‡è¡¡</a></li>
</ul>
</li>
<li><a href="#4-%E6%9C%AF%E8%AF%AD">4. æœ¯è¯­</a></li>
<li><a href="#5-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">5. å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="1-è´Ÿè½½å‡è¡¡ç®€ä»‹"><a class="markdownIt-Anchor" href="#1-è´Ÿè½½å‡è¡¡ç®€ä»‹"></a> 1. è´Ÿè½½å‡è¡¡ç®€ä»‹</h2>
<h3 id="11-è´Ÿè½½å‡è¡¡çš„ä½œç”¨"><a class="markdownIt-Anchor" href="#11-è´Ÿè½½å‡è¡¡çš„ä½œç”¨"></a> 1.1. è´Ÿè½½å‡è¡¡çš„ä½œç”¨</h3>
<p>è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼Œç®€ç§° LBï¼‰æ˜¯é«˜å¯ç”¨åŸºç¡€æ¶æ„çš„å…³é”®ç»„ä»¶ï¼Œé€šå¸¸ <strong>ç”¨äºå°†ç½‘ç»œæµé‡åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œä»¥æé«˜åº”ç”¨çš„å“åº”é€Ÿåº¦å’Œå¯ç”¨æ€§</strong>ã€‚</p>
<p>ç³»ç»Ÿçš„æ‰©å±•å¯åˆ†ä¸ºå‚ç›´æ‰©å±•å’Œæ°´å¹³æ‰©å±•ã€‚</p>
<ul>
<li><strong>å‚ç›´æ‰©å±•</strong>ï¼Œæ˜¯ä»å•æœºçš„è§’åº¦é€šè¿‡<strong>å¢åŠ ç¡¬ä»¶å¤„ç†èƒ½åŠ›</strong>ï¼Œæ¯”å¦‚ CPU å¤„ç†èƒ½åŠ›ï¼Œå†…å­˜å®¹é‡ï¼Œç£ç›˜ç­‰æ–¹é¢ï¼Œå®ç°æœåŠ¡å™¨å¤„ç†èƒ½åŠ›çš„æå‡ã€‚è¿™ç§æ–¹å¼ä¸èƒ½æ»¡è¶³å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆç½‘ç«™ï¼‰ï¼Œå¤§æµé‡ï¼Œé«˜å¹¶å‘ï¼Œæµ·é‡æ•°æ®çš„é—®é¢˜ã€‚</li>
<li><strong>æ°´å¹³æ‰©å±•</strong>ï¼Œæ˜¯é€šè¿‡<strong>æ·»åŠ æœºå™¨</strong>æ¥æ»¡è¶³å¤§å‹ç½‘ç«™æœåŠ¡çš„å¤„ç†èƒ½åŠ›ã€‚æ¯”å¦‚ï¼šä¸€å°æœºå™¨ä¸èƒ½æ»¡è¶³ï¼Œåˆ™å¢åŠ ä¸¤å°æˆ–è€…å¤šå°æœºå™¨ï¼Œå…±åŒæ‰¿æ‹…è®¿é—®å‹åŠ›ã€‚
<ul>
<li>åº”ç”¨é›†ç¾¤ï¼šå°†åŒä¸€åº”ç”¨éƒ¨ç½²åˆ°å¤šå°æœºå™¨ä¸Šï¼Œç»„æˆå¤„ç†é›†ç¾¤ï¼Œæ¥æ”¶è´Ÿè½½å‡è¡¡è®¾å¤‡åˆ†å‘çš„è¯·æ±‚ï¼Œè¿›è¡Œå¤„ç†ï¼Œå¹¶è¿”å›ç›¸åº”æ•°æ®ã€‚</li>
<li>è´Ÿè½½å‡è¡¡è®¾å¤‡ï¼šå°†ç”¨æˆ·è®¿é—®çš„è¯·æ±‚ï¼Œæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œåˆ†å‘åˆ°é›†ç¾¤ä¸­çš„ä¸€å°å¤„ç†æœåŠ¡å™¨ã€‚ï¼ˆä¸€ç§æŠŠç½‘ç»œè¯·æ±‚åˆ†æ•£åˆ°ä¸€ä¸ªæœåŠ¡å™¨é›†ç¾¤ä¸­çš„å¯ç”¨æœåŠ¡å™¨ä¸Šå»çš„è®¾å¤‡ï¼‰</li>
</ul>
</li>
</ul>
<p>è´Ÿè½½å‡è¡¡çš„ä½œç”¨ï¼š</p>
<ul>
<li><strong>é«˜å¹¶å‘</strong> - è´Ÿè½½å‡è¡¡é€šè¿‡è°ƒæ•´è´Ÿè½½ï¼Œå°½åŠ›è®©åº”ç”¨é›†ç¾¤ä¸­çš„èŠ‚ç‚¹å·¥ä½œé‡è¾¾åˆ°å‡åŒ€ï¼Œä»¥æ­¤æé«˜åº”ç”¨é›†ç¾¤çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼ˆååé‡ï¼‰ã€‚</li>
<li><strong>ä¼¸ç¼©æ€§</strong> - æ·»åŠ æˆ–å‡å°‘æœåŠ¡å™¨æ•°é‡ï¼Œç„¶åç”±è´Ÿè½½å‡è¡¡è¿›è¡Œåˆ†å‘æ§åˆ¶ã€‚è¿™ä½¿å¾—åº”ç”¨é›†ç¾¤å…·å¤‡ä¼¸ç¼©æ€§ã€‚</li>
<li><strong>æ•…éšœè½¬ç§»</strong> - è´Ÿè½½å‡è¡¡å™¨å¯ä»¥ç›‘æ§å€™é€‰æœåŠ¡å™¨ï¼Œå½“æœåŠ¡å™¨ä¸å¯ç”¨æ—¶ï¼Œè‡ªåŠ¨è·³è¿‡ï¼Œå°†è¯·æ±‚åˆ†å‘ç»™å¯ç”¨çš„æœåŠ¡å™¨ã€‚è¿™ä½¿å¾—åº”ç”¨é›†ç¾¤å…·å¤‡é«˜å¯ç”¨çš„ç‰¹æ€§ã€‚</li>
<li><strong>å®‰å…¨é˜²æŠ¤</strong> - æœ‰äº›è´Ÿè½½å‡è¡¡è½¯ä»¶æˆ–ç¡¬ä»¶æä¾›äº†å®‰å…¨æ€§åŠŸèƒ½ï¼Œå¦‚ï¼šé»‘ç™½åå•å¤„ç†ã€é˜²ç«å¢™ï¼Œé˜² DDos æ”»å‡»ç­‰ã€‚</li>
</ul>
<h3 id="12-è´Ÿè½½å‡è¡¡çš„åˆ†ç±»"><a class="markdownIt-Anchor" href="#12-è´Ÿè½½å‡è¡¡çš„åˆ†ç±»"></a> 1.2. è´Ÿè½½å‡è¡¡çš„åˆ†ç±»</h3>
<p>è´Ÿè½½å‡è¡¡å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p>
<ul>
<li>è½¯ä»¶è´Ÿè½½å‡è¡¡</li>
<li>ç¡¬ä»¶è´Ÿè½½å‡è¡¡</li>
</ul>
<h4 id="è½¯ä»¶è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#è½¯ä»¶è´Ÿè½½å‡è¡¡"></a> è½¯ä»¶è´Ÿè½½å‡è¡¡</h4>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡ï¼Œåº”ç”¨æœ€ä¸ºå¹¿æ³›ï¼Œæ— è®ºå¤§å…¬å¸è¿˜æ˜¯å°å…¬å¸éƒ½ä¼šä½¿ç”¨ã€‚</p>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡ä»è½¯ä»¶å±‚é¢å®ç°è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬å¯ä»¥åœ¨ä»»ä½•æ ‡å‡†ç‰©ç†è®¾å¤‡ä¸Šè¿è¡Œã€‚</p>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ä¸»æµäº§å“</strong> æœ‰ï¼š<a href="https://www.nginx.com/" target="_blank" rel="noopener">Nginx</a>ã€<a href="http://www.haproxy.org/" target="_blank" rel="noopener">HAProxy</a>ã€<a href="https://github.com/alibaba/LVS" target="_blank" rel="noopener">LVS</a>ã€‚</p>
<ul>
<li><a href="https://github.com/alibaba/LVS" target="_blank" rel="noopener">LVS</a> å¯ä»¥ä½œä¸ºå››å±‚è´Ÿè½½å‡è¡¡å™¨ã€‚å…¶è´Ÿè½½å‡è¡¡çš„æ€§èƒ½è¦ä¼˜äº Nginxã€‚</li>
<li><a href="http://www.haproxy.org/" target="_blank" rel="noopener">HAProxy</a> å¯ä»¥ä½œä¸º HTTP å’Œ TCP è´Ÿè½½å‡è¡¡å™¨ã€‚</li>
<li><a href="https://www.nginx.com/" target="_blank" rel="noopener">Nginx</a>ã€<a href="http://www.haproxy.org/" target="_blank" rel="noopener">HAProxy</a> å¯ä»¥ä½œä¸ºå››å±‚æˆ–ä¸ƒå±‚è´Ÿè½½å‡è¡¡å™¨ã€‚</li>
</ul>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æ‰©å±•æ€§å¥½</strong> - é€‚åº”åŠ¨æ€å˜åŒ–ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ è½¯ä»¶è´Ÿè½½å‡è¡¡å®ä¾‹ï¼ŒåŠ¨æ€æ‰©å±•åˆ°è¶…å‡ºåˆå§‹å®¹é‡çš„èƒ½åŠ›ã€‚</li>
<li><strong>æˆæœ¬ä½å»‰</strong> - è½¯ä»¶è´Ÿè½½å‡è¡¡å¯ä»¥åœ¨ä»»ä½•æ ‡å‡†ç‰©ç†è®¾å¤‡ä¸Šè¿è¡Œï¼Œé™ä½äº†è´­ä¹°å’Œè¿ç»´çš„æˆæœ¬ã€‚</li>
</ul>
<p>è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æ€§èƒ½ç•¥å·®</strong> - ç›¸æ¯”äºç¡¬ä»¶è´Ÿè½½å‡è¡¡ï¼Œè½¯ä»¶è´Ÿè½½å‡è¡¡çš„æ€§èƒ½è¦ç•¥ä½ä¸€äº›ã€‚</li>
</ul>
<p>è½¯ä»¶è´Ÿè½½è´Ÿè½½å‡è¡¡ä»é€šä¿¡å±‚é¢æ¥çœ‹ï¼Œåˆå¯ä»¥åˆ†ä¸ºå››å±‚å’Œä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<ul>
<li>å››å±‚è´Ÿè½½å‡è¡¡ - åŸºäº IP åœ°å€å’Œç«¯å£è¿›è¡Œè¯·æ±‚çš„è½¬å‘ã€‚</li>
<li>ä¸ƒå±‚è´Ÿè½½å‡è¡¡ - å°±æ˜¯å¯ä»¥æ ¹æ®è®¿é—®ç”¨æˆ·çš„ HTTP è¯·æ±‚å¤´ã€URL ä¿¡æ¯å°†è¯·æ±‚è½¬å‘åˆ°ç‰¹å®šçš„ä¸»æœºã€‚</li>
</ul>
<h4 id="ç¡¬ä»¶è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#ç¡¬ä»¶è´Ÿè½½å‡è¡¡"></a> ç¡¬ä»¶è´Ÿè½½å‡è¡¡</h4>
<p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬æ˜¯åœ¨å®šåˆ¶å¤„ç†å™¨ä¸Šè¿è¡Œçš„ç‹¬ç«‹è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œä»·æ ¼æ˜‚è´µï¼ŒåœŸè±ªä¸“å±ã€‚</p>
<p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ä¸»æµäº§å“</strong> æœ‰ï¼š<a href="https://f5.com/zh" target="_blank" rel="noopener">F5</a> å’Œ <a href="https://www.a10networks.com.cn/" target="_blank" rel="noopener">A10</a>ã€‚</p>
<p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>åŠŸèƒ½å¼ºå¤§</strong> - æ”¯æŒå…¨å±€è´Ÿè½½å‡è¡¡å¹¶æä¾›è¾ƒå…¨é¢çš„ã€å¤æ‚çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚</li>
<li><strong>æ€§èƒ½å¼ºæ‚</strong> - ç¡¬ä»¶è´Ÿè½½å‡è¡¡ç”±äºæ˜¯åœ¨ä¸“ç”¨å¤„ç†å™¨ä¸Šè¿è¡Œï¼Œå› æ­¤ååé‡å¤§ï¼Œå¯æ”¯æŒå•æœºç™¾ä¸‡ä»¥ä¸Šçš„å¹¶å‘ã€‚</li>
<li><strong>å®‰å…¨æ€§é«˜</strong> - å¾€å¾€å…·å¤‡é˜²ç«å¢™ï¼Œé˜² DDos æ”»å‡»ç­‰å®‰å…¨åŠŸèƒ½ã€‚</li>
</ul>
<p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æˆæœ¬æ˜‚è´µ</strong> - è´­ä¹°å’Œç»´æŠ¤ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„æˆæœ¬éƒ½å¾ˆé«˜ã€‚</li>
<li><strong>æ‰©å±•æ€§å·®</strong> - å½“è®¿é—®é‡çªå¢æ—¶ï¼Œè¶…è¿‡é™åº¦ä¸èƒ½åŠ¨æ€æ‰©å®¹ã€‚</li>
</ul>
<h2 id="2-è´Ÿè½½å‡è¡¡ç®—æ³•"><a class="markdownIt-Anchor" href="#2-è´Ÿè½½å‡è¡¡ç®—æ³•"></a> 2. è´Ÿè½½å‡è¡¡ç®—æ³•</h2>
<p>è´Ÿè½½å‡è¡¡äº§å“å¤šç§å¤šæ ·ï¼Œä½†æ˜¯å„ç§è´Ÿè½½å‡è¡¡ç®—æ³•åŸç†æ˜¯å…±æ€§çš„ã€‚</p>
<p>è´Ÿè½½å‡è¡¡ç®—æ³•æœ‰å¾ˆå¤šç§ï¼Œåˆ†åˆ«é€‚ç”¨äºä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œæœ¬æ–‡ä»…ä»‹ç»æœ€ä¸ºå¸¸è§çš„è´Ÿè½½å‡è¡¡ç®—æ³•çš„ç‰¹æ€§åŠåŸç†ï¼šè½®è¯¢ã€éšæœºã€æœ€å°‘è¿æ¥ã€ä¸€è‡´æ€§ Hashã€‚</p>
<h3 id="21-è½®è¯¢"><a class="markdownIt-Anchor" href="#21-è½®è¯¢"></a> 2.1. è½®è¯¢</h3>
<p><strong><code>è½®è¯¢ï¼ˆRound Robinï¼‰</code></strong> ç®—æ³• <strong>å°†è¯·æ±‚ä¾æ¬¡åˆ†å‘åˆ°å€™é€‰æœåŠ¡å™¨</strong>ã€‚</p>
<ul>
<li>ç‰¹ç‚¹ï¼š<strong>è¯·æ±‚å®Œå…¨å‡åŒ€åˆ†å‘</strong>ï¼Œå³æœåŠ¡å™¨è¯·æ±‚è¢«å®Œå…¨å‡åŒ€çš„åˆ†å‘åˆ°é›†ç¾¤çš„å„èŠ‚ç‚¹ä¸Šã€‚</li>
<li>åœºæ™¯ï¼š<strong>é€‚åˆæœåŠ¡å™¨ç¡¬ä»¶ç›¸åŒçš„åœºæ™¯</strong>ã€‚</li>
</ul>
<p>ä¸‹å›¾ä¸­ï¼Œä¸€å…±æœ‰ 6 ä¸ªå®¢æˆ·ç«¯äº§ç”Ÿäº† 6 ä¸ªè¯·æ±‚ï¼Œè¿™ 6 ä¸ªè¯·æ±‚æŒ‰ (1, 2, 3, 4, 5, 6) çš„é¡ºåºå‘é€ã€‚æœ€åï¼Œ(1, 3, 5) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œ(2, 4, 6) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 2ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E4%B9%8B%E8%BD%AE%E8%AF%A2-01.jpg" alt="img" /></p>
<p>è¯¥ç®—æ³•æ¯”è¾ƒé€‚åˆæ¯ä¸ªæœåŠ¡å™¨çš„æ€§èƒ½å·®ä¸å¤šçš„åœºæ™¯ï¼Œå¦‚æœæœ‰æ€§èƒ½å­˜åœ¨å·®å¼‚çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆæ€§èƒ½è¾ƒå·®çš„æœåŠ¡å™¨å¯èƒ½æ— æ³•æ‰¿æ‹…è¿‡å¤§çš„è´Ÿè½½ï¼ˆä¸‹å›¾çš„ Server 2ï¼‰ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E4%B9%8B%E8%BD%AE%E8%AF%A2-02.jpg" alt="img" /></p>
<p>èŠ‚ç‚¹å­˜å‚¨ç»“æ„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;V&gt; nodeList = Collections.emptyList();</span><br></pre></td></tr></table></figure>
<p>ç®—æ³•å®ç°ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> V <span class="title">select</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (CollectionUtil.isEmpty(<span class="keyword">this</span>.nodeList)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> size = <span class="keyword">this</span>.nodeList.size();</span><br><span class="line">    offset.compareAndSet(size, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> nodeList.get(offset.getAndIncrement());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åŠ æƒè½®è¯¢"><a class="markdownIt-Anchor" href="#åŠ æƒè½®è¯¢"></a> åŠ æƒè½®è¯¢</h4>
<p><strong><code>åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robbinï¼‰</code></strong> ç®—æ³•åœ¨è½®è¯¢ç®—æ³•çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†æƒé‡å±æ€§ã€‚æ€§èƒ½é«˜ã€å¤„ç†é€Ÿåº¦å¿«çš„æœºå™¨åº”è¯¥è®¾ç½®æ›´é«˜çš„æƒé‡ï¼Œä½¿å¾—åˆ†å‘æ—¶ä¼˜å…ˆå°†è¯·æ±‚åˆ†å‘åˆ°æƒé‡è¾ƒé«˜çš„æœåŠ¡å™¨ä¸Šã€‚</p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ ¹æ®æƒé‡ï¼Œè°ƒèŠ‚è½¬å‘æœåŠ¡å™¨çš„è¯·æ±‚æ•°ç›®ã€‚</li>
<li>ç¼ºç‚¹ï¼šæ¯”è½®è¯¢ç®—æ³•å¤æ‚ã€‚</li>
</ul>
<p>åŠ æƒè½®è¯¢æ˜¯åœ¨è½®è¯¢çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ€§èƒ½å·®å¼‚ï¼Œä¸ºæœåŠ¡å™¨èµ‹äºˆä¸€å®šçš„æƒå€¼ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ 1 è¢«èµ‹äºˆçš„æƒå€¼ä¸º 5ï¼ŒæœåŠ¡å™¨ 2 è¢«èµ‹äºˆçš„æƒå€¼ä¸º 1ï¼Œé‚£ä¹ˆ (1, 2, 3, 4, 5) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œ(6) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 2ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E4%B9%8B%E5%8A%A0%E6%9D%83%E8%BD%AE%E8%AF%A2.jpg" alt="img" /></p>
<p>èŠ‚ç‚¹å­˜å‚¨ç»“æ„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// key å­˜å‚¨å®é™…èŠ‚ç‚¹å†…å®¹ï¼Œvalue å­˜å‚¨èŠ‚ç‚¹çš„æƒé‡</span></span><br><span class="line"><span class="keyword">private</span> Map&lt;V, Integer&gt; nodeMap = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br></pre></td></tr></table></figure>
<p>ç®—æ³•å®ç°ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">select</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (MapUtil.isEmpty(nodeMap)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> totalWeight = nodeMap.values().stream().mapToInt(a -&gt; a).sum();</span><br><span class="line">    <span class="keyword">int</span> number = offset.getAndIncrement() % totalWeight;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;V, Integer&gt; item : nodeMap.entrySet()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (item.getValue() &gt; number) &#123;</span><br><span class="line">            <span class="keyword">return</span> item.getKey();</span><br><span class="line">        &#125;</span><br><span class="line">        number -= item.getValue();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="22-éšæœº"><a class="markdownIt-Anchor" href="#22-éšæœº"></a> 2.2. éšæœº</h3>
<p><strong><code>éšæœºï¼ˆRandomï¼‰</code></strong> ç®—æ³• <strong>å°†è¯·æ±‚éšæœºåˆ†å‘åˆ°å€™é€‰æœåŠ¡å™¨</strong>ã€‚</p>
<ul>
<li>ç‰¹ç‚¹ï¼šè°ƒç”¨é‡è¾ƒå°çš„æ—¶å€™ï¼Œå¯èƒ½è´Ÿè½½å¹¶ä¸å‡åŒ€ï¼Œ<strong>è°ƒç”¨é‡è¶Šå¤§ï¼Œè´Ÿè½½è¶Šå‡è¡¡</strong>ã€‚</li>
<li>åœºæ™¯ï¼š<strong>é€‚åˆæœåŠ¡å™¨ç¡¬ä»¶ç›¸åŒçš„åœºæ™¯</strong>ã€‚</li>
</ul>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E4%B9%8B%E9%9A%8F%E6%9C%BA.jpg" alt="img" /></p>
<p>èŠ‚ç‚¹å­˜å‚¨ç»“æ„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;V&gt; nodeList = Collections.emptyList();</span><br></pre></td></tr></table></figure>
<p>ç®—æ³•å®ç°ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">select</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (CollectionUtil.isEmpty(<span class="keyword">this</span>.nodeList)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> offset = random.nextInt(nodeList.size());</span><br><span class="line">    <span class="keyword">return</span> nodeList.get(offset);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åŠ æƒéšæœº"><a class="markdownIt-Anchor" href="#åŠ æƒéšæœº"></a> åŠ æƒéšæœº</h4>
<p><strong><code>åŠ æƒéšæœºï¼ˆWeighted Randomï¼‰</code></strong> ç®—æ³•åœ¨éšæœºç®—æ³•çš„åŸºç¡€ä¸Šï¼ŒæŒ‰ç…§æ¦‚ç‡è°ƒæ•´æƒé‡ï¼Œè¿›è¡Œè´Ÿè½½åˆ†é…ã€‚</p>
<p>èŠ‚ç‚¹å­˜å‚¨ç»“æ„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// key å­˜å‚¨å®é™…èŠ‚ç‚¹å†…å®¹ï¼Œvalue å­˜å‚¨èŠ‚ç‚¹çš„æƒé‡</span></span><br><span class="line">Map&lt;V, Integer&gt; nodeMap = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br></pre></td></tr></table></figure>
<p>ç®—æ³•å®ç°ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">select</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (MapUtil.isEmpty(keyWeightMap)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;V&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;V, Integer&gt; item : keyWeightMap.entrySet()) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; item.getValue(); i++) &#123;</span><br><span class="line">            list.add(item.getKey());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> totalWeight = keyWeightMap.values().stream().mapToInt(a -&gt; a).sum();</span><br><span class="line">    <span class="keyword">int</span> number = random.nextInt(totalWeight);</span><br><span class="line">    <span class="keyword">return</span> list.get(number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="23-æœ€å°‘è¿æ¥"><a class="markdownIt-Anchor" href="#23-æœ€å°‘è¿æ¥"></a> 2.3. æœ€å°‘è¿æ¥</h3>
<p><strong><code>æœ€å°‘è¿æ¥ï¼ˆLeast Connectionï¼‰</code></strong> ç®—æ³• <strong>å°†è¯·æ±‚åˆ†å‘åˆ°è¿æ¥æ•°æœ€å°‘çš„å€™é€‰æœåŠ¡å™¨</strong>ï¼ˆç›®å‰å¤„ç†è¯·æ±‚æœ€å°‘çš„æœåŠ¡å™¨ï¼‰ã€‚</p>
<ul>
<li>ç‰¹ç‚¹ï¼šæ ¹æ®å€™é€‰æœåŠ¡å™¨å½“å‰çš„è¯·æ±‚è¿æ¥æ•°ï¼ŒåŠ¨æ€åˆ†é…ã€‚</li>
<li>åœºæ™¯ï¼š<strong>é€‚ç”¨äºå¯¹ç³»ç»Ÿè´Ÿè½½è¾ƒä¸ºæ•æ„Ÿæˆ–è¯·æ±‚è¿æ¥æ—¶é•¿ç›¸å·®è¾ƒå¤§çš„åœºæ™¯</strong>ã€‚</li>
</ul>
<p>ç”±äºæ¯ä¸ªè¯·æ±‚çš„è¿æ¥æ—¶é•¿ä¸ä¸€æ ·ï¼Œå¦‚æœé‡‡ç”¨ç®€å•çš„è½®å¾ªæˆ–éšæœºç®—æ³•ï¼Œéƒ½å¯èƒ½å‡ºç°<strong>æŸäº›æœåŠ¡å™¨å½“å‰è¿æ¥æ•°è¿‡å¤§ï¼Œè€Œå¦ä¸€äº›æœåŠ¡å™¨çš„è¿æ¥è¿‡å°</strong>çš„æƒ…å†µï¼Œè¿™å°±é€ æˆäº†è´Ÿè½½å¹¶éçœŸæ­£å‡è¡¡ã€‚è™½ç„¶ï¼Œè½®è¯¢æˆ–ç®—æ³•éƒ½å¯ä»¥é€šè¿‡åŠ æƒé‡å±æ€§çš„æ–¹å¼è¿›è¡Œè´Ÿè½½è°ƒæ•´ï¼Œä½†åŠ æƒæ–¹å¼éš¾ä»¥åº”å¯¹åŠ¨æ€å˜åŒ–ã€‚</p>
<p>ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼Œ(1, 3, 5) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œä½†æ˜¯ (1, 3) å¾ˆå¿«å°±æ–­å¼€è¿æ¥ï¼Œæ­¤æ—¶åªæœ‰ (5) è¯·æ±‚è¿æ¥æœåŠ¡å™¨ 1ï¼›(2, 4, 6) è¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ 2ï¼Œåªæœ‰ (2) çš„è¿æ¥æ–­å¼€ã€‚è¯¥ç³»ç»Ÿç»§ç»­è¿è¡Œæ—¶ï¼ŒæœåŠ¡å™¨ 2 ä¼šæ‰¿æ‹…è¿‡å¤§çš„è´Ÿè½½ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E4%B9%8B%E6%9C%80%E5%B0%91%E8%BF%9E%E6%8E%A5-01.jpg" alt="img" /></p>
<p>æœ€å°‘è¿æ¥ç®—æ³•ä¼šè®°å½•å½“å‰æ—¶åˆ»ï¼Œæ¯ä¸ªå€™é€‰èŠ‚ç‚¹æ­£åœ¨å¤„ç†çš„è¿æ¥æ•°ï¼Œç„¶åé€‰æ‹©è¿æ¥æ•°æœ€å°çš„èŠ‚ç‚¹ã€‚è¯¥ç­–ç•¥èƒ½å¤ŸåŠ¨æ€ã€å®æ—¶åœ°ååº”æœåŠ¡å™¨çš„å½“å‰çŠ¶å†µï¼Œè¾ƒä¸ºåˆç†åœ°å°†è´Ÿè´£åˆ†é…å‡åŒ€ï¼Œé€‚ç”¨äºå¯¹å½“å‰ç³»ç»Ÿè´Ÿè½½è¾ƒä¸ºæ•æ„Ÿçš„åœºæ™¯ã€‚</p>
<p>ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ 1 å½“å‰è¿æ¥æ•°æœ€å°ï¼Œé‚£ä¹ˆæ–°åˆ°æ¥çš„è¯·æ±‚ 6 å°±ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1 ä¸Šã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E4%B9%8B%E6%9C%80%E5%B0%91%E8%BF%9E%E6%8E%A5-02.jpg" alt="img" /></p>
<h4 id="åŠ æƒæœ€å°‘è¿æ¥"><a class="markdownIt-Anchor" href="#åŠ æƒæœ€å°‘è¿æ¥"></a> åŠ æƒæœ€å°‘è¿æ¥</h4>
<p>åŠ æƒæœ€å°‘è¿æ¥ï¼ˆWeighted Least Connectionï¼‰åœ¨æœ€å°‘è¿æ¥çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ€§èƒ½ä¸ºæ¯å°æœåŠ¡å™¨åˆ†é…æƒé‡ï¼Œå†æ ¹æ®æƒé‡è®¡ç®—å‡ºæ¯å°æœåŠ¡å™¨èƒ½å¤„ç†çš„è¿æ¥æ•°ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E4%B9%8B%E5%8A%A0%E6%9D%83%E6%9C%80%E5%B0%91%E8%BF%9E%E6%8E%A5.jpg" alt="img" /></p>
<h3 id="24-æºåœ°å€å“ˆå¸Œ"><a class="markdownIt-Anchor" href="#24-æºåœ°å€å“ˆå¸Œ"></a> 2.4. æºåœ°å€å“ˆå¸Œ</h3>
<p>**<code>æºåœ°å€å“ˆå¸Œï¼ˆIP Hashï¼‰</code>**ç®—æ³• <strong>æ ¹æ®è¯·æ±‚æº IPï¼Œé€šè¿‡å“ˆå¸Œè®¡ç®—å¾—åˆ°ä¸€ä¸ªæ•°å€¼ï¼Œç”¨è¯¥æ•°å€¼åœ¨å€™é€‰æœåŠ¡å™¨åˆ—è¡¨çš„è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œå¾—åˆ°çš„ç»“æœä¾¿æ˜¯é€‰ä¸­çš„æœåŠ¡å™¨</strong>ã€‚</p>
<ul>
<li>ç‰¹ç‚¹ï¼šä¿è¯ç‰¹å®šç”¨æˆ·æ€»æ˜¯è¯·æ±‚åˆ°ç›¸åŒçš„æœåŠ¡å™¨ï¼Œè‹¥æœåŠ¡å™¨å®•æœºï¼Œä¼šè¯ä¼šä¸¢å¤±ã€‚</li>
<li>åœºæ™¯ï¼šä¼šè¯ç²˜æ»ã€‚</li>
</ul>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95%E4%B9%8BIpHash.jpg" alt="img" /></p>
<p>ç®—æ³•ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">select</span><span class="params">(<span class="keyword">final</span> String key)</span> </span>&#123;</span><br><span class="line">    List&lt;V&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;(nodes);</span><br><span class="line">    <span class="keyword">int</span> hashCode = key.hashCode();</span><br><span class="line">    <span class="keyword">int</span> idx = hashCode % list.size();</span><br><span class="line">    <span class="keyword">return</span> list.get(Math.abs(idx));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="25-ä¸€è‡´æ€§å“ˆå¸Œ"><a class="markdownIt-Anchor" href="#25-ä¸€è‡´æ€§å“ˆå¸Œ"></a> 2.5. ä¸€è‡´æ€§å“ˆå¸Œ</h3>
<p>ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰ç®—æ³•çš„ç›®æ ‡æ˜¯ï¼š<strong>ç›¸åŒçš„è¯·æ±‚å°½å¯èƒ½è½åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Š</strong>ã€‚</p>
<ul>
<li>ç›¸åŒçš„è¯·æ±‚æ˜¯æŒ‡ï¼šä¸€èˆ¬åœ¨ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œæ—¶ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ª key ç”¨äº hash è®¡ç®—ï¼Œå¯èƒ½æ˜¯ï¼š
<ul>
<li>ç”¨æˆ· ID</li>
<li>è¯·æ±‚æ–¹ IP</li>
<li>è¯·æ±‚æœåŠ¡åç§°ï¼Œå‚æ•°åˆ—è¡¨æ„æˆçš„ä¸²</li>
</ul>
</li>
<li>å°½å¯èƒ½æ˜¯æŒ‡ï¼šæœåŠ¡å™¨å¯èƒ½å‘ç”Ÿä¸Šä¸‹çº¿ï¼Œå°‘æ•°æœåŠ¡å™¨çš„å˜åŒ–ä¸åº”è¯¥å½±å“å¤§å¤šæ•°çš„è¯·æ±‚ã€‚</li>
</ul>
<p>å½“æŸå°å€™é€‰æœåŠ¡å™¨å®•æœºæ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œä¼šåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒå€™é€‰æœåŠ¡å™¨ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚</p>
<p>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ç¤ºä¾‹ï¼š</p>
<ul>
<li>æ„å»ºè™šæ‹Ÿ Hash ç¯</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> VIRTUAL_NODE_SIZE = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String VIRTUAL_NODE_SUFFIX = <span class="string">"&amp;&amp;"</span>;</span><br><span class="line"><span class="keyword">private</span> Set&lt;V&gt; nodes = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(collection);</span><br><span class="line"><span class="keyword">private</span> TreeMap&lt;Integer, V&gt; hashRing = buildConsistentHashRing(<span class="keyword">this</span>.nodes);</span><br><span class="line"></span><br><span class="line"><span class="function">TreeMap&lt;Integer, V&gt; <span class="title">buildConsistentHashRing</span><span class="params">(Set&lt;V&gt; nodes)</span> </span>&#123;</span><br><span class="line">    TreeMap&lt;Integer, V&gt; hashRing = <span class="keyword">new</span> TreeMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (V node : nodes) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; VIRTUAL_NODE_SIZE; i++) &#123;</span><br><span class="line">            <span class="comment">// æ–°å¢è™šæ‹ŸèŠ‚ç‚¹çš„æ–¹å¼å¦‚æœæœ‰å½±å“ï¼Œä¹Ÿå¯ä»¥æŠ½è±¡å‡ºä¸€ä¸ªç”±ç‰©ç†èŠ‚ç‚¹æ‰©å±•è™šæ‹ŸèŠ‚ç‚¹çš„ç±»</span></span><br><span class="line">            hashRing.put(hashStrategy.hashCode(node + VIRTUAL_NODE_SUFFIX + i), node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hashRing;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ ¸å¿ƒç®—æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">select</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> hashCode = hashStrategy.hashCode(key);</span><br><span class="line">    <span class="comment">// å‘å³æ‰¾åˆ°ç¬¬ä¸€ä¸ª key</span></span><br><span class="line">    Map.Entry&lt;Integer, V&gt; entry = hashRing.ceilingEntry(hashCode);</span><br><span class="line">    <span class="keyword">if</span> (entry == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æƒ³è±¡æˆä¸€ä¸ªç¯ï¼Œè¶…è¿‡å°¾éƒ¨åˆ™å–ç¬¬ä¸€ä¸ª key</span></span><br><span class="line">        entry = hashRing.firstEntry();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> entry.getValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-è´Ÿè½½å‡è¡¡æŠ€æœ¯"><a class="markdownIt-Anchor" href="#3-è´Ÿè½½å‡è¡¡æŠ€æœ¯"></a> 3. è´Ÿè½½å‡è¡¡æŠ€æœ¯</h2>
<p>æ ¹æ®å®ç°æŠ€æœ¯ä¸åŒï¼Œå¯åˆ†åˆ’åˆ†å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä¸ƒå±‚è´Ÿè½½å‡è¡¡
<ul>
<li>DNS é‡å®šå‘</li>
<li>HTTP é‡å®šå‘</li>
<li>åå‘ä»£ç†</li>
</ul>
</li>
<li>å››å±‚è´Ÿè½½å‡è¡¡
<ul>
<li>ä¿®æ”¹ IP åœ°å€</li>
<li>ä¿®æ”¹ MAC åœ°å€</li>
</ul>
</li>
</ul>
<h3 id="31-dns-è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#31-dns-è´Ÿè½½å‡è¡¡"></a> 3.1. DNS è´Ÿè½½å‡è¡¡</h3>
<p>DNS è´Ÿè½½å‡è¡¡ä¸€èˆ¬ç”¨äºäº’è”ç½‘å…¬å¸ï¼Œå¤æ‚çš„ä¸šåŠ¡ç³»ç»Ÿä¸é€‚åˆä½¿ç”¨ã€‚å¤§å‹ç½‘ç«™ä¸€èˆ¬ä½¿ç”¨ DNS è´Ÿè½½å‡è¡¡ä½œä¸º <strong>ç¬¬ä¸€çº§è´Ÿè½½å‡è¡¡æ‰‹æ®µ</strong>ï¼Œç„¶ååœ¨å†…éƒ¨ä½¿ç”¨å…¶å®ƒæ–¹å¼åšç¬¬äºŒçº§è´Ÿè½½å‡è¡¡ã€‚DNS è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<p>DNS å³ <strong>åŸŸåè§£ææœåŠ¡</strong>ï¼Œæ˜¯ OSI ç¬¬ä¸ƒå±‚ç½‘ç»œåè®®ã€‚DNS è¢«è®¾è®¡ä¸ºä¸€ä¸ªæ ‘å½¢ç»“æ„çš„åˆ†å¸ƒå¼åº”ç”¨ï¼Œè‡ªä¸Šè€Œä¸‹ä¾æ¬¡ä¸ºï¼šæ ¹åŸŸåæœåŠ¡å™¨ï¼Œä¸€çº§åŸŸåæœåŠ¡å™¨ï¼ŒäºŒçº§åŸŸåæœåŠ¡å™¨ï¼Œâ€¦ ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ã€‚æ˜¾ç„¶ï¼Œå¦‚æœæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨æ ¹åŸŸåæœåŠ¡å™¨ï¼Œé‚£ä¹ˆ DNS æŸ¥è¯¢çš„è´Ÿè½½å’Œå¼€é”€ä¼šéå¸¸åºå¤§ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200125143248.png" alt="img" /></p>
<p>å› æ­¤ï¼ŒDNS æŸ¥è¯¢ç›¸å¯¹äº DNS å±‚çº§ç»“æ„ï¼Œæ˜¯ä¸€ä¸ªé€†å‘çš„é€’å½’æµç¨‹ï¼ŒDNS å®¢æˆ·ç«¯ä¾æ¬¡è¯·æ±‚æœ¬åœ° DNS æœåŠ¡å™¨ï¼Œä¸Šä¸€çº§ DNS æœåŠ¡å™¨ï¼Œä¸Šä¸Šä¸€çº§ DNS æœåŠ¡å™¨ï¼Œâ€¦ ï¼Œæ ¹ DNS æœåŠ¡å™¨ï¼ˆåˆå«æƒå¨ DNS æœåŠ¡å™¨ï¼‰ï¼Œä¸€æ—¦å‘½ä¸­ï¼Œç«‹å³è¿”å›ã€‚ä¸ºäº†å‡å°‘æŸ¥è¯¢æ¬¡æ•°ï¼Œæ¯ä¸€çº§ DNS æœåŠ¡å™¨éƒ½ä¼šè®¾ç½® DNS æŸ¥è¯¢ç¼“å­˜ã€‚</p>
<p>DNS è´Ÿè½½å‡è¡¡çš„å·¥ä½œåŸç†å°±æ˜¯ï¼š<strong>åŸºäº DNS æŸ¥è¯¢ç¼“å­˜ï¼ŒæŒ‰ç…§è´Ÿè½½æƒ…å†µè¿”å›ä¸åŒæœåŠ¡å™¨çš„ IP åœ°å€</strong>ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/Dns%E9%87%8D%E5%AE%9A%E5%90%91.png" alt="img" /></p>
<p>DNS é‡å®šå‘çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>ä½¿ç”¨ç®€å•</strong> - è´Ÿè½½å‡è¡¡å·¥ä½œï¼Œäº¤ç»™ DNS æœåŠ¡å™¨å¤„ç†ï¼Œçœæ‰äº†è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç»´æŠ¤çš„éº»çƒ¦</li>
<li><strong>æé«˜æ€§èƒ½</strong> - å¯ä»¥æ”¯æŒåŸºäºåœ°å€çš„åŸŸåè§£æï¼Œè§£ææˆè·ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡å™¨åœ°å€ï¼ˆç±»ä¼¼ CDN çš„åŸç†ï¼‰ï¼Œå¯ä»¥åŠ å¿«è®¿é—®é€Ÿåº¦ï¼Œæ”¹å–„æ€§èƒ½ï¼›</li>
</ul>
<p>DNS é‡å®šå‘çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å¯ç”¨æ€§å·®</strong> - DNS è§£ææ˜¯å¤šçº§è§£æï¼Œæ–°å¢/ä¿®æ”¹ DNS åï¼Œè§£ææ—¶é—´è¾ƒé•¿ï¼›è§£æè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·è®¿é—®ç½‘ç«™å°†å¤±è´¥ï¼›</li>
<li><strong>æ‰©å±•æ€§ä½</strong> - DNS è´Ÿè½½å‡è¡¡çš„æ§åˆ¶æƒåœ¨åŸŸåå•†é‚£é‡Œï¼Œæ— æ³•å¯¹å…¶åšæ›´å¤šçš„æ”¹å–„å’Œæ‰©å±•ï¼›</li>
<li><strong>ç»´æŠ¤æ€§å·®</strong> - ä¹Ÿä¸èƒ½åæ˜ æœåŠ¡å™¨çš„å½“å‰è¿è¡ŒçŠ¶æ€ï¼›æ”¯æŒçš„ç®—æ³•å°‘ï¼›ä¸èƒ½åŒºåˆ†æœåŠ¡å™¨çš„å·®å¼‚ï¼ˆä¸èƒ½æ ¹æ®ç³»ç»Ÿä¸æœåŠ¡çš„çŠ¶æ€æ¥åˆ¤æ–­è´Ÿè½½ï¼‰</li>
</ul>
<h3 id="32-http-è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#32-http-è´Ÿè½½å‡è¡¡"></a> 3.2. HTTP è´Ÿè½½å‡è¡¡</h3>
<p><strong>HTTP è´Ÿè½½å‡è¡¡æ˜¯åŸºäº HTTP é‡å®šå‘å®ç°çš„</strong>ã€‚HTTP è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<p>HTTP é‡å®šå‘åŸç†æ˜¯ï¼š<strong>æ ¹æ®ç”¨æˆ·çš„ HTTP è¯·æ±‚è®¡ç®—å‡ºä¸€ä¸ªçœŸå®çš„æœåŠ¡å™¨åœ°å€ï¼Œå°†è¯¥æœåŠ¡å™¨åœ°å€å†™å…¥ HTTP é‡å®šå‘å“åº”ä¸­ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œç”±æµè§ˆå™¨é‡æ–°è¿›è¡Œè®¿é—®</strong>ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/Http%E9%87%8D%E5%AE%9A%E5%90%91.png" alt="img" /></p>
<p>HTTP é‡å®šå‘çš„ <strong>ä¼˜ç‚¹</strong>ï¼š<strong>æ–¹æ¡ˆç®€å•</strong>ã€‚</p>
<p>HTTP é‡å®šå‘çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æ€§èƒ½è¾ƒå·®</strong> - æ¯æ¬¡è®¿é—®éœ€è¦ä¸¤æ¬¡è¯·æ±‚æœåŠ¡å™¨ï¼Œå¢åŠ äº†è®¿é—®çš„å»¶è¿Ÿã€‚</li>
<li><strong>é™ä½æœç´¢æ’å</strong> - ä½¿ç”¨é‡å®šå‘åï¼Œæœç´¢å¼•æ“ä¼šè§†ä¸º SEO ä½œå¼Šã€‚</li>
<li>å¦‚æœè´Ÿè½½å‡è¡¡å™¨å®•æœºï¼Œå°±æ— æ³•è®¿é—®è¯¥ç«™ç‚¹ã€‚</li>
</ul>
<p>ç”±äºå…¶ç¼ºç‚¹æ¯”è¾ƒæ˜æ˜¾ï¼Œæ‰€ä»¥è¿™ç§è´Ÿè½½å‡è¡¡ç­–ç•¥å®é™…åº”ç”¨è¾ƒå°‘ã€‚</p>
<h3 id="33-åå‘ä»£ç†"><a class="markdownIt-Anchor" href="#33-åå‘ä»£ç†"></a> 3.3. åå‘ä»£ç†</h3>
<p>åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼æ˜¯æŒ‡ä»¥ <strong>ä»£ç†æœåŠ¡å™¨</strong> æ¥æ¥å—ç½‘ç»œè¯·æ±‚ï¼Œç„¶å <strong>å°†è¯·æ±‚è½¬å‘ç»™å†…ç½‘ä¸­çš„æœåŠ¡å™¨</strong>ï¼Œå¹¶å°†ä»å†…ç½‘ä¸­çš„æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ç½‘ç»œè¯·æ±‚çš„å®¢æˆ·ç«¯ã€‚åå‘ä»£ç†è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<p><img src="http://dunwu.test.upcdn.net/cs/design/architecture/%E4%BB%A3%E7%90%86%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.png" alt="img" /></p>
<p>åå‘ä»£ç†æœåŠ¡çš„ä¸»æµäº§å“ï¼šNginxã€Apacheã€‚</p>
<p>æ­£å‘ä»£ç†ä¸åå‘ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<ul>
<li>æ­£å‘ä»£ç†ï¼šå‘ç”Ÿåœ¨ <strong>å®¢æˆ·ç«¯</strong>ï¼Œæ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å‘èµ·çš„ã€‚ç¿»å¢™è½¯ä»¶å°±æ˜¯å…¸å‹çš„æ­£å‘ä»£ç†ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä¸»åŠ¨è®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œè®©ä»£ç†æœåŠ¡å™¨è·å¾—éœ€è¦çš„å¤–ç½‘æ•°æ®ï¼Œç„¶åè½¬å‘å›å®¢æˆ·ç«¯ã€‚</li>
<li>åå‘ä»£ç†ï¼šå‘ç”Ÿåœ¨ <strong>æœåŠ¡ç«¯</strong>ï¼Œç”¨æˆ·ä¸çŸ¥é“ä»£ç†çš„å­˜åœ¨ã€‚</li>
</ul>
<p><img src="http://dunwu.test.upcdn.net/cs/web/nginx/reverse-proxy.png" alt="img" /></p>
<p>åå‘ä»£ç†çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>å¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•</strong> - æ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä»¥åº”å¯¹ä¸åŒçš„åœºæ™¯éœ€æ±‚ã€‚</li>
<li><strong>å¯ä»¥ç›‘æ§æœåŠ¡å™¨</strong> - åŸºäº HTTP åè®®ï¼Œå¯ä»¥ç›‘æ§è½¬å‘æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¦‚ï¼šç³»ç»Ÿè´Ÿè½½ã€å“åº”æ—¶é—´ã€æ˜¯å¦å¯ç”¨ã€è¿æ¥æ•°ã€æµé‡ç­‰ï¼Œä»è€Œæ ¹æ®è¿™äº›æ•°æ®è°ƒæ•´è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ã€‚</li>
</ul>
<p>åå‘ä»£ç†çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>
<p><strong>é¢å¤–çš„è½¬å‘å¼€é”€</strong> - åå‘ä»£ç†çš„è½¬å‘æ“ä½œæœ¬èº«æ˜¯æœ‰æ€§èƒ½å¼€é”€çš„ï¼Œå¯èƒ½ä¼šåŒ…æ‹¬ï¼Œåˆ›å»ºè¿æ¥ï¼Œç­‰å¾…è¿æ¥å“åº”ï¼Œåˆ†æå“åº”ç»“æœç­‰æ“ä½œã€‚</p>
</li>
<li>
<p><strong>å¢åŠ ç³»ç»Ÿå¤æ‚åº¦</strong> - åå‘ä»£ç†å¸¸ç”¨äºåšåˆ†å¸ƒå¼åº”ç”¨çš„æ°´å¹³æ‰©å±•ï¼Œä½†åå‘ä»£ç†æœåŠ¡å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼Œä¸ºäº†è§£å†³ä»¥ä¸‹é—®é¢˜ä¼šç»™ç³»ç»Ÿæ•´ä½“å¢åŠ é¢å¤–çš„å¤æ‚åº¦å’Œè¿ç»´æˆæœ¬ï¼š</p>
<ul>
<li>åå‘ä»£ç†æœåŠ¡å¦‚æœå®•æœºï¼Œå°±æ— æ³•è®¿é—®ç«™ç‚¹ï¼Œæ‰€ä»¥éœ€è¦æœ‰ <strong>é«˜å¯ç”¨</strong> æ–¹æ¡ˆï¼Œå¸¸è§çš„æ–¹æ¡ˆæœ‰ï¼šä¸»å¤‡æ¨¡å¼ï¼ˆä¸€ä¸»ä¸€å¤‡ï¼‰ã€åŒä¸»æ¨¡å¼ï¼ˆäº’ä¸ºä¸»å¤‡ï¼‰ã€‚</li>
<li>åå‘ä»£ç†æœåŠ¡è‡ªèº«ä¹Ÿå­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼Œéšç€éœ€è¦è½¬å‘çš„è¯·æ±‚é‡ä¸æ–­æ”€å‡ï¼Œéœ€è¦æœ‰ <strong>å¯æ‰©å±•</strong> æ–¹æ¡ˆã€‚</li>
</ul>
</li>
</ul>
<h3 id="34-ç½‘ç»œåœ°å€è½¬å‘"><a class="markdownIt-Anchor" href="#34-ç½‘ç»œåœ°å€è½¬å‘"></a> 3.4. ç½‘ç»œåœ°å€è½¬å‘</h3>
<p><strong><code>ç½‘ç»œåœ°å€è½¬å‘ï¼ˆNetwork Address Translationï¼Œç®€ç§° NATï¼‰</code></strong> æ˜¯æŒ‡ <strong>é€šè¿‡ä¿®æ”¹ç›®çš„ IP åœ°å€å®ç°è´Ÿè½½å‡è¡¡</strong>ã€‚NAT å±äºå››å±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<p>NAT å·¥ä½œåŸç†ï¼š</p>
<ul>
<li>ç”¨æˆ·è¯·æ±‚æ•°æ®åŒ…åˆ°è¾¾ LB åï¼ŒLB åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸è¿›ç¨‹è·å–ç½‘ç»œæ•°æ®åŒ…ã€‚</li>
<li>LB å™¨æ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•å¾—åˆ° RIPï¼Œå¹¶å°†è¯·æ±‚ç›®çš„åœ°å€ä¿®æ”¹ä¸º RIPï¼Œä¸éœ€è¦ç»è¿‡ç”¨æˆ·è¿›ç¨‹å¤„ç†ã€‚ç„¶åï¼Œå°†è¯·æ±‚å‘é€ç»™ RSã€‚</li>
<li>RS å¤„ç†å®Œæˆè¯·æ±‚åï¼Œå°†å“åº”æ•°æ®åŒ…è¿”å›åˆ° LBã€‚</li>
<li>LB å†å°†æ•°æ®åŒ…æºåœ°å€ä¿®æ”¹ä¸ºè‡ªèº«çš„ IP åœ°å€ï¼Œå‘é€ç»™ç”¨æˆ·æµè§ˆå™¨ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200125131843.png" alt="img" /></p>
<p>NAT çš„ <strong>ä¼˜ç‚¹</strong>ï¼šåœ¨å†…æ ¸è¿›ç¨‹å®Œæˆæ•°æ®åˆ†å‘ï¼Œæ¯”åœ¨åº”ç”¨å±‚åˆ†å‘ <strong>æ€§èƒ½æ›´å¥½</strong>ï¼›</p>
<p>NAT çš„ <strong>ç¼ºç‚¹</strong>ï¼šæ‰€æœ‰è¯·æ±‚å“åº”éƒ½éœ€è¦ç»è¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œé›†ç¾¤ <strong>æœ€å¤§ååé‡å—é™äºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç½‘å¡å¸¦å®½</strong>ï¼›</p>
<p>ç½‘ç»œå±‚è´Ÿè½½å‡è¡¡ä¸»æµçš„äº§å“æ˜¯ï¼š</p>
<ul>
<li><a href="https://github.com/alibaba/LVS" target="_blank" rel="noopener">LVS</a> çš„ NAT æ¨¡å¼ã€‚</li>
<li>HAProxy çš„ TCP å››å±‚è´Ÿè½½å‡è¡¡ã€‚</li>
</ul>
<p>åœ¨ NAT æ¨¡å¼ä¸‹ï¼ŒHAProxy ä½¿ç”¨æ¯” LVS æ›´æ–¹ä¾¿ã€‚</p>
<h3 id="35-éš§é“æŠ€æœ¯"><a class="markdownIt-Anchor" href="#35-éš§é“æŠ€æœ¯"></a> 3.5. éš§é“æŠ€æœ¯</h3>
<p><strong><code>éš§é“æŠ€æœ¯ï¼ˆ IP Tunnelingï¼Œç®€ç§° TUNï¼‰</code></strong> æ˜¯æŒ‡ï¼šé‡‡ç”¨ NAT æ¨¡å¼æ—¶ï¼Œç”±äºè¯·æ±‚å’Œå“åº”çš„æŠ¥æ–‡å¿…é¡»é€šè¿‡è´Ÿè½½å‡è¡¡å™¨é‡å†™åœ°å€ï¼Œå½“å®¢æˆ·è¯·æ±‚è¶Šæ¥è¶Šå¤šæ—¶ï¼Œè´Ÿè½½å‡è¡¡å™¨å¤„ç†èƒ½åŠ›å°†æˆä¸ºç“¶é¢ˆã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè´Ÿè½½å‡è¡¡å™¨æŠŠè¯·æ±‚çš„æŠ¥æ–‡<strong>é€šè¿‡ IP éš§é“è½¬å‘åˆ°çœŸå®çš„æœåŠ¡å™¨</strong>ã€‚çœŸå®çš„æœåŠ¡å™¨å°†å“åº”å¤„ç†åçš„æ•°æ®ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚è¿™æ ·è´Ÿè½½å‡è¡¡å™¨å°±åªéœ€å¤„ç†è¯·æ±‚æŠ¥æ–‡ã€‚</p>
<p>TUN å·¥ä½œåŸç†ï¼š</p>
<ul>
<li>å®¢æˆ·è¯·æ±‚æ•°æ®åŒ…ï¼Œæ ¹æ®ç›®æ ‡åœ°å€ VIP å‘é€åˆ° LB ä¸Šã€‚</li>
<li>LB æ¥æ”¶åˆ°å®¢æˆ·è¯·æ±‚åŒ…ï¼Œæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•è®¡ç®—å‡ºåˆ†å‘çš„ RSã€‚</li>
<li>ç„¶åï¼Œè¿›è¡Œ IP Tunnel å°è£…ã€‚å³åœ¨åŸæœ‰çš„è¯·æ±‚åŒ…ä¸Šå°è£… IP Tunnel çš„åŒ…å¤´ã€‚ç„¶åå‘é€å‡ºå»ã€‚</li>
<li>RS æ ¹æ® IP Tunnel åŒ…å¤´ä¿¡æ¯ï¼ˆæ­¤æ—¶å°±åˆä¸€ç§é€»è¾‘ä¸Šçš„éšå½¢éš§é“ï¼Œåªæœ‰ LB å’Œ RS ä¹‹é—´æ‡‚ï¼‰æ”¶åˆ°è¯·æ±‚åŒ…ï¼Œç„¶åè§£å¼€ IP Tunnel åŒ…å¤´ä¿¡æ¯ï¼Œå¾—åˆ°å®¢æˆ·çš„è¯·æ±‚åŒ…å¹¶è¿›è¡Œå“åº”å¤„ç†ã€‚</li>
<li>å“åº”å¤„ç†å®Œæ¯•ä¹‹åï¼ŒRS ä½¿ç”¨è‡ªå·±çš„å‡ºå…¬ç½‘çš„çº¿è·¯ï¼Œå°†è¿™ä¸ªå“åº”æ•°æ®åŒ…å‘é€ç»™å®¢æˆ·ç«¯ã€‚æº IP åœ°å€è¿˜æ˜¯ VIP åœ°å€ã€‚</li>
</ul>
<h3 id="36-ç›´æ¥è·¯ç”±"><a class="markdownIt-Anchor" href="#36-ç›´æ¥è·¯ç”±"></a> 3.6. ç›´æ¥è·¯ç”±</h3>
<p><strong><code>ç›´æ¥è·¯ç”±ï¼ˆDirect Routingï¼Œç®€ç§° DRï¼‰</code></strong> æ˜¯æŒ‡ <strong>é€šè¿‡ä¿®æ”¹ç›®çš„ MAC åœ°å€å®ç°è´Ÿè½½å‡è¡¡</strong>ã€‚DR å±äºå››å±‚è´Ÿè½½å‡è¡¡ã€‚</p>
<p>DR å·¥ä½œåŸç†ï¼š</p>
<ul>
<li>å®¢æˆ·è¯·æ±‚æ•°æ®åŒ…åˆ°è¾¾ LB åï¼ŒLB æ ¹æ®è°ƒåº¦ç®—æ³•é€‰å‡ºä¸€å° RSï¼Œå°†æ•°æ®å¸§çš„ MAC åœ°å€æ”¹å†™ä¸º RS çš„ MAC åœ°å€ï¼Œç„¶åå‘é€å‡ºå»ã€‚</li>
<li>äº¤æ¢æœºä¼šæ ¹æ® MAC åœ°å€å°†æ•°æ®å°åŒ…å‘é€ç»™ RSï¼ŒRS å°†å¤„ç†å®Œçš„ç»“æœç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200125131811.png" alt="img" /></p>
<p>æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡ä¸»æµçš„äº§å“æ˜¯ï¼š<a href="https://github.com/alibaba/LVS" target="_blank" rel="noopener">LVS</a> çš„ DR æ¨¡å¼ã€‚</p>
<p>DR çš„ <strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ä¸éœ€è¦è´Ÿè½½å‡è¡¡æœåŠ¡å™¨è¿›è¡Œåœ°å€çš„è½¬æ¢ã€‚</li>
<li>æ•°æ®å“åº”æ—¶ä¸éœ€è¦ç»è¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œæ€§èƒ½é«˜äº NATã€‚</li>
</ul>
<p>DR çš„ <strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>å¯¹ç½‘å¡å¸¦å®½è¦æ±‚è¾ƒé«˜ã€‚</li>
<li>æä¾›æœåŠ¡çš„ç«¯å£å¿…é¡»ä¸€è‡´ã€‚VIP çš„ç«¯å£å¯¹å¤–ç«¯å£ä¸º 80ï¼Œä½†åç«¯æœåŠ¡çš„çœŸå®ç«¯å£ä¸º 8080ï¼Œé€šè¿‡ LVS çš„ DR æ¨¡å¼æ— æ³•å®ç°ã€‚</li>
<li>LVS å’ŒçœŸå®æœåŠ¡å™¨å¿…é¡»åœ¨åŒä¸€ç½‘ç»œã€‚</li>
</ul>
<h3 id="37-æ··åˆè´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#37-æ··åˆè´Ÿè½½å‡è¡¡"></a> 3.7. æ··åˆè´Ÿè½½å‡è¡¡</h3>
<p>æ··åˆè´Ÿè½½å‡è¡¡å°±æ˜¯é›†å„å®¶ä¹‹æ‰€é•¿ï¼Œè®©ä¸åŒçš„è´Ÿè½½å‡è¡¡æŠ€æœ¯åœ¨åˆé€‚çš„åœºæ™¯å‘æŒ¥ä½œç”¨ã€‚</p>
<p>ç”±äºå¤šä¸ªæœåŠ¡å™¨ç¾¤å†…ç¡¬ä»¶è®¾å¤‡ã€å„è‡ªçš„è§„æ¨¡ã€æä¾›çš„æœåŠ¡ç­‰çš„å·®å¼‚ï¼Œå¯ä»¥è€ƒè™‘ç»™æ¯ä¸ªæœåŠ¡å™¨ç¾¤é‡‡ç”¨æœ€åˆé€‚çš„è´Ÿè½½å‡è¡¡æ–¹å¼ï¼Œç„¶ååˆåœ¨è¿™å¤šä¸ªæœåŠ¡å™¨ç¾¤é—´å†ä¸€æ¬¡è´Ÿè½½å‡è¡¡æˆ–ç¾¤é›†èµ·æ¥ä»¥ä¸€ä¸ªæ•´ä½“å‘å¤–ç•Œæä¾›æœåŠ¡ï¼ˆå³æŠŠè¿™å¤šä¸ªæœåŠ¡å™¨ç¾¤å½“åšä¸€ä¸ªæ–°çš„æœåŠ¡å™¨ç¾¤ï¼‰ï¼Œä»è€Œè¾¾åˆ°æœ€ä½³çš„æ€§èƒ½ã€‚å°†è¿™ç§æ–¹å¼ç§°ä¹‹ä¸ºæ··åˆå‹è´Ÿè½½å‡è¡¡ã€‚</p>
<p>æ­¤ç§æ–¹å¼æœ‰æ—¶ä¹Ÿç”¨äºå•å°å‡è¡¡è®¾å¤‡çš„æ€§èƒ½ä¸èƒ½æ»¡è¶³å¤§é‡è¿æ¥è¯·æ±‚çš„æƒ…å†µä¸‹ã€‚æ˜¯ç›®å‰å¤§å‹äº’è”ç½‘å…¬å¸ï¼Œæ™®éä½¿ç”¨çš„æ–¹å¼ã€‚</p>
<p>æ–¹å¼ä¸€ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://images2015.cnblogs.com/blog/820332/201512/820332-20151213200106747-94797427.png" alt="img" /></p>
<p>ä»¥ä¸Šæ¨¡å¼é€‚åˆæœ‰åŠ¨é™åˆ†ç¦»çš„åœºæ™¯ï¼Œåå‘ä»£ç†æœåŠ¡å™¨ï¼ˆé›†ç¾¤ï¼‰å¯ä»¥èµ·åˆ°ç¼“å­˜å’ŒåŠ¨æ€è¯·æ±‚åˆ†å‘çš„ä½œç”¨ï¼Œå½“æ—¶é™æ€èµ„æºç¼“å­˜åœ¨ä»£ç†æœåŠ¡å™¨æ—¶ï¼Œåˆ™ç›´æ¥è¿”å›åˆ°æµè§ˆå™¨ã€‚å¦‚æœåŠ¨æ€é¡µé¢åˆ™è¯·æ±‚åé¢çš„åº”ç”¨è´Ÿè½½å‡è¡¡ï¼ˆåº”ç”¨é›†ç¾¤ï¼‰ã€‚</p>
<p>æ–¹å¼äºŒï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://images2015.cnblogs.com/blog/820332/201512/820332-20151213200117825-1452672107.png" alt="img" /></p>
<p>ä»¥ä¸Šæ¨¡å¼ï¼Œé€‚åˆåŠ¨æ€è¯·æ±‚åœºæ™¯ã€‚</p>
<p>å› æ··åˆæ¨¡å¼ï¼Œå¯ä»¥æ ¹æ®å…·ä½“åœºæ™¯ï¼Œçµæ´»æ­é…å„ç§æ–¹å¼ï¼Œä»¥ä¸Šä¸¤ç§æ–¹å¼ä»…ä¾›å‚è€ƒã€‚</p>
<h2 id="4-æœ¯è¯­"><a class="markdownIt-Anchor" href="#4-æœ¯è¯­"></a> 4. æœ¯è¯­</h2>
<ul>
<li>LB - Load Balancerï¼Œå³è´Ÿè½½å‡è¡¡å™¨ã€‚</li>
<li>RS - Real Serverï¼Œå³çœŸå®æœåŠ¡å™¨ã€‚</li>
<li>RIP - Real Server IPï¼Œå³çœŸå®æœåŠ¡å™¨ IPã€‚</li>
<li>VIP - Virtual IPï¼Œå³è™šæ‹Ÿ IPï¼Œæ˜¯å¤–éƒ¨ç›´æ¥é¢å‘ç”¨æˆ·è¯·æ±‚ï¼Œä½œä¸ºç”¨æˆ·è¯·æ±‚çš„ç›®æ ‡ IP åœ°å€ã€‚</li>
<li>DIP - Director Server IPï¼Œå³ç›´è¿æœåŠ¡å™¨ IPï¼Œä¸»è¦ç”¨äºå’Œå†…éƒ¨ä¸»æœºé€šä¿¡çš„ IP åœ°å€ã€‚</li>
<li>CIP - Client IPï¼Œå³å®¢æˆ·ç«¯ IPã€‚</li>
<li>NAT - Network Address Translationï¼Œå³ç½‘ç»œåœ°å€è½¬å‘ã€‚</li>
<li>TUN - IP Tunnelingï¼Œå³ IP éš§é“æŠ€æœ¯ã€‚</li>
<li>DR - Direct Routingï¼Œå³ç›´æ¥è·¯ç”±ã€‚</li>
</ul>
<h2 id="5-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#5-å‚è€ƒèµ„æ–™"></a> 5. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹</a></li>
<li><a href="https://www.cnblogs.com/itfly8/p/5043435.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æ¶æ„ç³»åˆ—ï¼šè´Ÿè½½å‡è¡¡è¯¦è§£ï¼ˆ1ï¼‰</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/32841479" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡</a></li>
<li><a href="https://avinetworks.com/what-is-load-balancing/" target="_blank" rel="noopener">What Is Load Balancing</a></li>
<li><a href="https://segmentfault.com/a/1190000004492447" target="_blank" rel="noopener">è´Ÿè½½å‡è¡¡ç®—æ³•åŠæ‰‹æ®µ</a></li>
<li><a href="https://dubbo.apache.org/zh-cn/docs/source_code_guide/loadbalance.html" target="_blank" rel="noopener">Dubbo è´Ÿè½½å‡è¡¡å®ç°</a></li>
<li><a href="https://segmentfault.com/a/1190000002578457" target="_blank" rel="noopener">åˆ©ç”¨ dns è§£ææ¥å®ç°ç½‘ç«™çš„è´Ÿè½½å‡è¡¡</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/31777732" target="_blank" rel="noopener">åŸç†ä¸Šææ‡‚ LVS çš„ DR å’Œ NAT æ¨¡å¼çš„ç¼ºé™·ï¼Œä¸çœ‹å°å¿ƒè¸©å‘</a></li>
<li><a href="https://www.cnblogs.com/liwei0526vip/p/6370103.html" target="_blank" rel="noopener">ä½¿ç”¨ LVS å®ç°è´Ÿè½½å‡è¡¡åŸç†åŠå®‰è£…é…ç½®è¯¦è§£</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>ç³»ç»ŸåŸç†</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>ç³»ç»ŸåŸç†</tag>
        <tag>è´Ÿè½½å‡è¡¡</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¼¸ç¼©æ€§æ¶æ„</title>
    <url>/blog/design/architecture/scalable-architecture/</url>
    <content><![CDATA[<h1 id="ä¼¸ç¼©æ€§æ¶æ„"><a class="markdownIt-Anchor" href="#ä¼¸ç¼©æ€§æ¶æ„"></a> ä¼¸ç¼©æ€§æ¶æ„</h1>
<blockquote>
<p>ä¼¸ç¼©æ€§æ¶æ„æ˜¯æŒ‡ä¸éœ€è¦æ”¹å˜ç³»ç»Ÿçš„è½¯ç¡¬ä»¶è®¾è®¡ï¼Œä»…é€šè¿‡æ”¹å˜éƒ¨ç½²æœåŠ¡å™¨æ•°é‡å°±å¯ä»¥æ‰©å¤§æˆ–ç¼©å°ç³»ç»Ÿçš„æœåŠ¡å¤„ç†èƒ½åŠ›ã€‚</p>
</blockquote>
<h2 id="1-ç³»ç»Ÿæ¶æ„çš„ä¼¸ç¼©æ€§è®¾è®¡"><a class="markdownIt-Anchor" href="#1-ç³»ç»Ÿæ¶æ„çš„ä¼¸ç¼©æ€§è®¾è®¡"></a> 1. ç³»ç»Ÿæ¶æ„çš„ä¼¸ç¼©æ€§è®¾è®¡</h2>
<h3 id="11-ä¸åŒåŠŸèƒ½è¿›è¡Œç‰©ç†åˆ†ç¦»å®ç°ä¼¸ç¼©"><a class="markdownIt-Anchor" href="#11-ä¸åŒåŠŸèƒ½è¿›è¡Œç‰©ç†åˆ†ç¦»å®ç°ä¼¸ç¼©"></a> 1.1. ä¸åŒåŠŸèƒ½è¿›è¡Œç‰©ç†åˆ†ç¦»å®ç°ä¼¸ç¼©</h3>
<ul>
<li><strong>çºµå‘åˆ†ç¦»ï¼ˆåˆ†å±‚ååˆ†ç¦»ï¼‰</strong> - å°†ä¸šåŠ¡å¤„ç†æµç¨‹ä¸Šçš„ä¸åŒéƒ¨åˆ†åˆ†ç¦»éƒ¨ç½²ï¼Œå®ç°ç³»ç»Ÿä¼¸ç¼©æ€§ã€‚</li>
<li><strong>æ¨ªå‘åˆ†ç¦»ï¼ˆä¸šåŠ¡åˆ†å‰²ååˆ†ç¦»ï¼‰</strong> - å°†ä¸åŒçš„ä¸šåŠ¡æ¨¡å—åˆ†ç¦»éƒ¨ç½²ï¼Œå®ç°ç³»ç»Ÿä¼¸ç¼©æ€§ã€‚</li>
</ul>
<h3 id="12-å•ä¸€åŠŸèƒ½é€šè¿‡é›†ç¾¤è§„æ¨¡å®ç°ä¼¸ç¼©"><a class="markdownIt-Anchor" href="#12-å•ä¸€åŠŸèƒ½é€šè¿‡é›†ç¾¤è§„æ¨¡å®ç°ä¼¸ç¼©"></a> 1.2. å•ä¸€åŠŸèƒ½é€šè¿‡é›†ç¾¤è§„æ¨¡å®ç°ä¼¸ç¼©</h3>
<p>å°†ä¸åŒåŠŸèƒ½åˆ†ç¦»éƒ¨ç½²å¯ä»¥å®ç°ä¸€å®šç¨‹åº¦çš„ä¼¸ç¼©æ€§ï¼Œä½†æ˜¯éšç€è®¿é—®é‡é€æ­¥å¢åŠ ï¼Œå³ä½¿åˆ†ç¦»åˆ°æœ€å°ç²’åº¦çš„ç‹¬ç«‹éƒ¨ç½²ï¼Œå•ä¸€çš„æœåŠ¡å™¨ä¹Ÿä¸èƒ½æ»¡è¶³ä¸šåŠ¡è§„æ¨¡çš„è¦æ±‚ã€‚å› æ­¤å¿…é¡»ä½¿ç”¨æœåŠ¡å™¨é›†ç¾¤ï¼Œå³å°†ç›¸åŒæœåŠ¡éƒ¨ç½²åœ¨å¤šæ€æœåŠ¡å™¨ä¸Šæ„æˆä¸€ä¸ªé›†ç¾¤æ•´ä½“å¯¹å¤–æä¾›æœåŠ¡ã€‚</p>
<h2 id="2-åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"><a class="markdownIt-Anchor" href="#2-åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"></a> 2. åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡</h2>
<p>å¦‚æœ HTTP è¯·æ±‚åˆ†å‘è£…ç½®å¯ä»¥æ„ŸçŸ¥æˆ–è€…å¯ä»¥é…ç½®é›†ç¾¤çš„æœåŠ¡å™¨æ•°é‡ï¼Œå¯ä»¥åŠæ—¶å‘ç°é›†ç¾¤ä¸­æ–°ä¸Šçº¿æˆ–ä¸‹çº¿çš„æœåŠ¡å™¨ï¼Œå¹¶èƒ½å‘æ–°ä¸Šçº¿çš„æœåŠ¡å™¨åˆ†å‘è¯·æ±‚ï¼Œåœæ­¢å‘å·²ä¸‹çº¿çš„æœåŠ¡å™¨åˆ†å‘è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å®ç°äº†åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ä¼¸ç¼©æ€§ã€‚</p>
<h3 id="21-http-é‡å®šå‘è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#21-http-é‡å®šå‘è´Ÿè½½å‡è¡¡"></a> 2.1. HTTP é‡å®šå‘è´Ÿè½½å‡è¡¡</h3>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/è´Ÿè½½å‡è¡¡-HTTPé‡å®šå‘.png!zp" width="500"/>
</div>
<p>åˆ©ç”¨ HTTP é‡å®šå‘åè®®å®ç°è´Ÿè½½å‡è¡¡ã€‚</p>
<p>è¿™ç§è´Ÿè½½å‡è¡¡æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯æ¯”è¾ƒç®€å•ã€‚</p>
<p>ç¼ºç‚¹æ˜¯æµè§ˆå™¨éœ€è¦ä¸¤æ¬¡è¯·æ±‚æœåŠ¡å™¨æ‰èƒ½å®Œæˆä¸€æ¬¡è®¿é—®ï¼Œæ€§èƒ½è¾ƒå·®ï¼šé‡å®šå‘æœåŠ¡å™¨è‡ªèº«çš„å¤„ç†èƒ½åŠ›æœ‰å¯èƒ½æˆä¸ºç“¶é¢ˆï¼Œæ•´ä¸ªé›†ç¾¤çš„ä¼¸ç¼©æ€§è§„æ¨¡æœ‰é™ï¼›ä½¿ç”¨ HTTP 302 å“åº”ç é‡å®šå‘ï¼Œå¯èƒ½ä½¿æœç´¢å¼•æ“åˆ¤æ–­ä¸º SEO ä½œå¼Šï¼Œé™ä½æœç´¢æ’åã€‚</p>
<h3 id="22-dns-åŸŸåè§£æè´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#22-dns-åŸŸåè§£æè´Ÿè½½å‡è¡¡"></a> 2.2. DNS åŸŸåè§£æè´Ÿè½½å‡è¡¡</h3>
<p>åˆ©ç”¨ DNS å¤„ç†åŸŸåè§£æè¯·æ±‚çš„åŒæ—¶è¿›è¡Œè´Ÿè½½å‡è¡¡å¤„ç†çš„ä¸€ç§æ–¹æ¡ˆã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/è´Ÿè½½å‡è¡¡-DNSåŸŸåè§£æ.png!zp" width="500"/>
</div>
<p>åœ¨ DNS æœåŠ¡å™¨ä¸­é…ç½®å¤šä¸ª A è®°å½•ï¼Œå¦‚ï¼š</p>
<figure class="highlight accesslog"><table><tr><td class="code"><pre><span class="line"><span class="number">114.100.40.1</span> www.mysite.com</span><br><span class="line"><span class="number">114.100.40.2</span> www.mysite.com</span><br><span class="line"><span class="number">114.100.40.3</span> www.mysite.com</span><br></pre></td></tr></table></figure>
<p>æ¯æ¬¡åŸŸåè§£æè¯·æ±‚éƒ½ä¼šæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•è®¡ç®—ä¸€ä¸ªä¸åŒçš„ IP åœ°å€è¿”å›ï¼Œè¿™æ · A è®°å½•ä¸­é…ç½®çš„å¤šä¸ªæœåŠ¡å™¨å°±æ„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå¹¶å¯ä»¥å®ç°è´Ÿè½½å‡è¡¡ã€‚</p>
<p>DNS åŸŸåè§£æè´Ÿè½½å‡è¡¡çš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å°†è´Ÿè½½å‡è¡¡çš„å·¥ä½œè½¬äº¤ç»™äº† DNSï¼Œçœæ‰äº†ç½‘ç«™ç®¡ç†ç»´æŠ¤çš„éº»çƒ¦ã€‚</li>
<li>åŒæ—¶ï¼Œè®¸å¤š DNS æœåŠ¡å™¨è¿˜æ”¯æŒåŸºäºåœ°ç†ä½ç½®çš„åŸŸåè§£æï¼Œå³å°†åŸŸåè§£ææˆè·ç¦»ç”¨æˆ·åœ°ç†æœ€è¿‘çš„ä¸€ä¸ªæœåŠ¡å™¨åœ°å€ï¼Œè¿™æ ·å¯ä»¥åŠ å¿«ç”¨æˆ·è®¿é—®é€Ÿåº¦ï¼Œæ”¹å–„æ€§èƒ½ã€‚</li>
</ul>
<p>DNS åŸŸåè§£æè´Ÿè½½å‡è¡¡çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li>DNS æ˜¯å¤šçº§è§£æï¼Œæ¯ä¸€çº§ DNS éƒ½å¯èƒ½ç¼“å­˜ A è®°å½•ï¼Œå½“æŸå°æœåŠ¡å™¨ä¸‹çº¿åï¼Œå³ä½¿ä¿®æ”¹äº† DNS çš„ A è®°å½•ï¼Œè¦ä½¿å…¶ç”Ÿæ•ˆä¹Ÿéœ€è¦è¾ƒé•¿æ—¶é—´ã€‚è¿™æ®µæ—¶é—´ï¼Œä¾ç„¶ä¼šåŸŸåè§£æåˆ°å·²ç»ä¸‹çº¿çš„æœåŠ¡å™¨ï¼Œå¯¼è‡´ç”¨æˆ·è®¿é—®å¤±è´¥ã€‚</li>
<li>DNS çš„è´Ÿè½½å‡è¡¡çš„æ§åˆ¶æƒåœ¨åŸŸåæœåŠ¡å•†é‚£é‡Œï¼Œç½‘ç«™æ— æ³•å¯¹å…¶åšæ›´å¤šæ”¹å–„å’Œæ›´å¼ºå¤§çš„ç®¡ç†ã€‚</li>
</ul>
<h3 id="23-åå‘ä»£ç†è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#23-åå‘ä»£ç†è´Ÿè½½å‡è¡¡"></a> 2.3. åå‘ä»£ç†è´Ÿè½½å‡è¡¡</h3>
<p>å¤§å¤šæ•°åå‘ä»£ç†æœåŠ¡å™¨åŒæ—¶æä¾›åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/è´Ÿè½½å‡è¡¡-åå‘ä»£ç†.png!zp" width="500"/>
</div>
<p>åå‘ä»£ç†æœåŠ¡å™¨çš„ä¼˜ç‚¹æ˜¯éƒ¨ç½²ç®€å•ã€‚ç¼ºç‚¹æ˜¯åå‘ä»£ç†æœåŠ¡å™¨æ˜¯æ‰€æœ‰è¯·æ±‚å’Œå“åº”çš„ä¸­è½¬ç«™ï¼Œå…¶æ€§èƒ½å¯èƒ½ä¼šæˆä¸ºç“¶é¢ˆã€‚</p>
<h3 id="24-ip-è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#24-ip-è´Ÿè½½å‡è¡¡"></a> 2.4. IP è´Ÿè½½å‡è¡¡</h3>
<p>åœ¨ç½‘ç»œå±‚é€šè¿‡ä¿®æ”¹è¯·æ±‚ç›®æ ‡åœ°å€è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/è´Ÿè½½å‡è¡¡-IPå±‚.png!zp" width="500"/>
</div>
<p>è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼ˆç½‘å…³æœåŠ¡å™¨ï¼‰åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸è·å–ç½‘ç»œæ•°æ®åŒ…ï¼Œæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•è®¡ç®—å¾—åˆ°ä¸€å°çœŸå® Web æœåŠ¡å™¨ 10.0.0.1ï¼Œç„¶åå°†ç›®çš„ IP åœ°å€ä¿®æ”¹ä¸º 10.0.0.1ï¼Œä¸éœ€è¦é€šè¿‡ç”¨æˆ·è¿›ç¨‹ã€‚çœŸå® Web æœåŠ¡å™¨å¤„ç†å®Œæˆåï¼Œå“åº”æ•°æ®åŒ…å›åˆ°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œè´Ÿè½½å‡è¡¡æœåŠ¡å™¨å†å°†æ•°æ®åŒ…åŸåœ°å€ä¿®æ”¹ä¸ºè‡ªèº«çš„ IP åœ°å€ï¼ˆ114.100.80.10ï¼‰å‘é€ç»™æµè§ˆå™¨ã€‚</p>
<p>IP è´Ÿè½½å‡è¡¡åœ¨å†…æ ¸å®Œæˆæ•°æ®åˆ†å‘ï¼Œæ‰€ä»¥å¤„ç†æ€§èƒ½ä¼˜äºåå‘ä»£ç†è´Ÿè½½å‡è¡¡ã€‚ä½†æ˜¯å› ä¸ºæ‰€æœ‰è¯·æ±‚å“åº”éƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œé›†ç¾¤çš„æœ€å¤§å“åº”æ•°æ®ååé‡å—åˆ¶äºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç½‘å¡å¸¦å®½ã€‚</p>
<h3 id="25-æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"><a class="markdownIt-Anchor" href="#25-æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"></a> 2.5. æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡</h3>
<p>æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡æ˜¯æŒ‡åœ¨é€šä¿¡åè®®çš„æ•°æ®é“¾è·¯å±‚ä¿®æ”¹ mac åœ°å€è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/è´Ÿè½½å‡è¡¡-æ•°æ®é“¾è·¯å±‚.png!zp" width="500"/>
</div>
<p>è¿™ç§æ–¹å¼åˆç§°ä½œä¸‰è§’ä¼ è¾“æ–¹å¼ï¼Œè´Ÿè½½å‡è¡¡æ•°æ®åˆ†å‘è¿‡ç¨‹ä¸­ä¸ä¿®æ”¹ IP åœ°å€ï¼Œåªä¿®æ”¹ç›®çš„ mac åœ°å€ï¼Œé€šè¿‡é…ç½®çœŸå®ç‰©ç†æœåŠ¡å™¨é›†ç¾¤æ‰€æœ‰æœºå™¨è™šæ‹Ÿ IP å’Œè´Ÿè½½å‡è¡¡æœåŠ¡å™¨ IP åœ°å€ä¸€è‡´ï¼Œä»è€Œè¾¾åˆ°ä¸ä¿®æ”¹æ•°æ®åŒ…çš„æºåœ°å€å’Œç›®çš„åœ°å€å°±å¯ä»¥è¿›è¡Œæ•°æ®åˆ†å‘çš„ç›®çš„ï¼Œç”±äºå®é™…å¤„ç†è¯·æ±‚çš„çœŸå®ç‰©ç†æœåŠ¡å™¨ IP å’Œæ•°æ®è¯·æ±‚ç›®çš„ IP ä¸€è‡´ï¼Œä¸éœ€è¦é€šè¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨è¿›è¡Œåœ°å€è½¬æ¢ï¼Œå¯å°†å“åº”æ•°æ®åŒ…ç›´æ¥è¿”å›ç»™ç”¨æˆ·æµè§ˆå™¨ï¼Œé¿å…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç½‘å¡å¸¦å®½æˆä¸ºç“¶é¢ˆã€‚è¿™ç§è´Ÿè½½æ–¹å¼åˆç§°ä½œç›´æ¥è·¯ç”±æ–¹å¼ã€‚</p>
<p>åœ¨ Linux å¹³å°ä¸Šæœ€å¥½çš„é“¾è·¯å±‚è´Ÿè½½å‡è¡¡å¼€æºäº§å“æ˜¯ <strong>LVS(Linux Virtual Server)</strong>ã€‚</p>
<h3 id="26-è´Ÿè½½å‡è¡¡ç®—æ³•"><a class="markdownIt-Anchor" href="#26-è´Ÿè½½å‡è¡¡ç®—æ³•"></a> 2.6. è´Ÿè½½å‡è¡¡ç®—æ³•</h3>
<p>è´Ÿè½½å‡è¡¡æœåŠ¡å™¨çš„å®ç°å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li>æ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•å’Œ Web æœåŠ¡å™¨åˆ—è¡¨è®¡ç®—å¾—åˆ°é›†ç¾¤ä¸­ä¸€å° Web æœåŠ¡å™¨çš„åœ°å€ã€‚</li>
<li>å°†è¯·æ±‚æ•°æ®å‘é€åˆ°è¯¥åœ°å€å¯¹åº”çš„ Web æœåŠ¡å™¨ä¸Šã€‚</li>
</ol>
<p>è´Ÿè½½å‡è¡¡ç®—æ³•é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><strong>è½®è¯¢ï¼ˆRound Robinï¼‰</strong> - æ‰€æœ‰è¯·æ±‚è¢«ä¾æ¬¡åˆ†å‘åˆ°æ¯å°åº”ç”¨æœåŠ¡å™¨ä¸Šï¼Œå³æ¯å°æœåŠ¡å™¨éœ€è¦å¤„ç†çš„è¯·æ±‚æ•°æ®éƒ½ç›¸åŒï¼Œé€‚åˆäºæ‰€æœ‰æœåŠ¡å™¨ç¡¬ä»¶éƒ½ç›¸åŒçš„åœºæ™¯ã€‚</li>
<li><strong>åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robinï¼‰</strong> - æ ¹æ®æœåŠ¡å™¨ç¡¬ä»¶æ€§èƒ½æƒ…å†µï¼Œåœ¨è½®è¯¢çš„åŸºç¡€ä¸Šï¼ŒæŒ‰ç…§é…ç½®æƒé‡å°†è¯·æ±‚åˆ†å‘åˆ°æ¯ä¸ªæœåŠ¡å™¨ï¼Œé«˜æ€§èƒ½æœåŠ¡å™¨èƒ½åˆ†é…æ›´å¤šè¯·æ±‚ã€‚</li>
<li><strong>éšæœºï¼ˆRandomï¼‰</strong> - è¯·æ±‚è¢«éšæœºåˆ†é…åˆ°å„ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œåœ¨è®¸å¤šåœºåˆä¸‹ï¼Œè¿™ç§æ–¹æ¡ˆéƒ½å¾ˆç®€å•å®ç”¨ï¼Œå› ä¸ºå¥½çš„éšæœºæ•°æœ¬èº«å°±å¾ˆå¹³å‡ï¼Œå³ä½¿åº”ç”¨æœåŠ¡å™¨ç¡¬ä»¶é…ç½®ä¸åŒï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŠ æƒéšæœºç®—æ³•ã€‚</li>
<li><strong>æœ€å°‘è¿æ¥ï¼ˆLeast Connectionï¼‰</strong> - è®°å½•æ¯ä¸ªåº”ç”¨æœåŠ¡å™¨æ­£åœ¨å¤„ç†çš„è¿æ¥æ•°ï¼Œå°†æ–°åˆ°çš„è¯·æ±‚åˆ†å‘åˆ°æœ€å°‘è¿æ¥çš„æœåŠ¡å™¨ä¸Šï¼Œåº”è¯¥è¯´ï¼Œè¿™æ˜¯æœ€ç¬¦åˆè´Ÿè½½å‡è¡¡å®šä¹‰çš„ç®—æ³•ã€‚</li>
<li><strong>æºåœ°å€ Hashï¼ˆSource Hashï¼‰</strong> - æ ¹æ®è¯·æ±‚æ¥æºçš„ IP åœ°å€è¿›è¡Œ Hash è®¡ç®—ï¼Œå¾—åˆ°åº”ç”¨æœåŠ¡å™¨ï¼Œè¿™æ ·æ¥è‡ªåŒä¸€ä¸ª IP åœ°å€çš„è¯·æ±‚æ€»åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šå¤„ç†ï¼Œè¯¥è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å¯ä»¥å­˜å‚¨åœ¨è¿™å°æœåŠ¡å™¨ä¸Šï¼Œåœ¨ä¸€ä¸ªä¼šè¯å‘¨æœŸå†…é‡å¤ä½¿ç”¨ï¼Œä»è€Œå®ç°ä¼šè¯ç²˜æ»ã€‚</li>
</ul>
<h2 id="3-åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"><a class="markdownIt-Anchor" href="#3-åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"></a> 3. åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡</h2>
<p>ç›®å‰æ¯”è¾ƒæµè¡Œçš„åˆ†å¸ƒå¼é›†ç¾¤ä¼¸ç¼©æ€§æ–¹æ¡ˆå°±æ˜¯ï¼šä¸€è‡´æ€§ HASH ç®—æ³•</p>
<h2 id="4-æ•°æ®å­˜å‚¨æœåŠ¡é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"><a class="markdownIt-Anchor" href="#4-æ•°æ®å­˜å‚¨æœåŠ¡é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡"></a> 4. æ•°æ®å­˜å‚¨æœåŠ¡é›†ç¾¤çš„ä¼¸ç¼©æ€§è®¾è®¡</h2>
<h3 id="41-å…³ç³»å‹æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡"><a class="markdownIt-Anchor" href="#41-å…³ç³»å‹æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡"></a> 4.1. å…³ç³»å‹æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡</h3>
<ul>
<li><strong>ä¸»ä»å¤åˆ¶</strong> - ä¸»æµå…³ç³»å‹æ•°æ®åº“ä¸€èˆ¬éƒ½æ”¯æŒä¸»ä»å¤åˆ¶ã€‚</li>
<li><strong>åˆ†åº“</strong> - æ ¹æ®ä¸šåŠ¡å¯¹æ•°æ®åº“è¿›è¡Œåˆ†å‰²ã€‚åˆ¶çº¦æ¡ä»¶æ˜¯è·¨åº“çš„è¡¨ä¸èƒ½è¿›è¡Œ Join æ“ä½œã€‚</li>
<li><strong>åˆ†è¡¨</strong> - ä½¿ç”¨æ•°æ®åº“åˆ†ç‰‡ä¸­é—´ä»¶ï¼Œå¦‚ Cobar ç­‰ã€‚</li>
</ul>
<h3 id="42-nosql-æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡"><a class="markdownIt-Anchor" href="#42-nosql-æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡"></a> 4.2. NoSql æ•°æ®åº“çš„ä¼¸ç¼©æ€§è®¾è®¡</h3>
<p>ä¸€èˆ¬è€Œè¨€ï¼ŒNosql ä¸æ”¯æŒ SQL å’Œ ACIDï¼Œä½†æ˜¯å¼ºåŒ–äº†å¯¹äºé«˜å¯ç”¨å’Œä¼¸ç¼©æ€§çš„æ”¯æŒã€‚</p>
<h2 id="5-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#5-å‚è€ƒèµ„æ–™"></a> 5. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>é«˜å¯ç”¨æ¶æ„</title>
    <url>/blog/design/architecture/high-availability-architecture/</url>
    <content><![CDATA[<h1 id="é«˜å¯ç”¨æ¶æ„"><a class="markdownIt-Anchor" href="#é«˜å¯ç”¨æ¶æ„"></a> é«˜å¯ç”¨æ¶æ„</h1>
<h2 id="1-ç½‘ç«™å¯ç”¨æ€§çš„åº¦é‡"><a class="markdownIt-Anchor" href="#1-ç½‘ç«™å¯ç”¨æ€§çš„åº¦é‡"></a> 1. ç½‘ç«™å¯ç”¨æ€§çš„åº¦é‡</h2>
<p>ç½‘ç«™ä¸å¯ç”¨ä¹Ÿè¢«ç§°ä½œç½‘ç«™æ•…éšœï¼Œä¸šç•Œé€šå¸¸ç”¨å¤šä¸ª 9 æ¥è¡¡é‡ç½‘ç«™çš„å¯ç”¨æ€§ã€‚å¦‚ QQ çš„å¯ç”¨æ€§ä¸º 4 ä¸ª 9ï¼Œå³ 99.99% å¯ç”¨ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">ç½‘ç«™ä¸å¯ç”¨æ—¶é—´ = æ•…éšœä¿®å¤æ—¶é—´ç‚¹ - æ•…éšœå‘ç°æ—¶é—´ç‚¹</span><br><span class="line">ç½‘ç«™å¹´åº¦å¯ç”¨æ€§æŒ‡æ ‡ = (<span class="number">1</span> - ç½‘ç«™ä¸å¯ç”¨æ—¶é—´/å¹´åº¦æ€»æ—¶é—´) * <span class="number">100</span>%</span><br></pre></td></tr></table></figure>
<p>ä¸€èˆ¬æ¥è¯´ï¼š</p>
<ul>
<li>2 ä¸ª 9 æ˜¯åŸºæœ¬å¯ç”¨ï¼Œä¸€å¹´ä¸å¯ç”¨æ—¶é—´å°äº 88 å°æ—¶ï¼›</li>
<li>3 ä¸ª 9 æ˜¯è¾ƒé«˜å¯ç”¨ï¼Œä¸€å¹´ä¸å¯ç”¨æ—¶é—´å°äº 9 å°æ—¶ï¼›</li>
<li>4 ä¸ª 9 æ˜¯å…·æœ‰è‡ªåŠ¨æ¢å¤èƒ½åŠ›çš„é«˜å¯ç”¨ï¼Œä¸€å¹´ä¸å¯ç”¨æ—¶é—´å°äº 55 åˆ†é’Ÿï¼›</li>
<li>5 ä¸ª 9 æ˜¯æé«˜å¯ç”¨ï¼Œä¸€å¹´ä¸å¯ç”¨æ—¶é—´å°äº 5 åˆ†é’Ÿã€‚</li>
</ul>
<h2 id="2-é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„"><a class="markdownIt-Anchor" href="#2-é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„"></a> 2. é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„</h2>
<p>é€šå¸¸ï¼Œä¼ä¸šçº§åº”ç”¨ç³»ç»Ÿä¸ºæé«˜ç³»ç»Ÿå¯ç”¨æ€§ï¼Œä¼šé‡‡ç”¨è¾ƒæ˜‚è´µçš„è½¯ç¡¬ä»¶è®¾å¤‡ï¼Œå½“ç„¶è¿™æ ·çš„è®¾å¤‡ä¹Ÿæ¯”è¾ƒç¨³å®šã€‚</p>
<p>äº’è”ç½‘å…¬å¸æˆ–ä¸€äº›åˆåˆ›å‹å…¬å¸åŸºäºæˆæœ¬è€ƒè™‘ï¼Œæ›´å¤šé‡‡ç”¨ PC çº§è½¯ç¡¬ä»¶è®¾å¤‡ï¼ŒèŠ‚çº¦æˆæœ¬æ‰€ä»˜å‡ºçš„ä»£ä»·å°±æ˜¯è®¾å¤‡è¾ƒä¸ºä¸ç¨³å®šã€‚æœåŠ¡å™¨ä¸€å¹´ä¸­å‡ºç°å‡ æ¬¡å®•æœºï¼Œé«˜å¼ºåº¦è¯»å†™ç£ç›˜å¯¼è‡´ç£ç›˜æŸåç­‰äº‹ä»¶å®å±æ­£å¸¸ã€‚</p>
<p>ç»¼ä¸Šï¼Œç¡¬ä»¶å‡ºç°æ•…éšœåº”è§†ä¸ºå¿…ç„¶çš„ï¼Œè€Œ<strong>é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„è®¾è®¡ç›®æ ‡å°±æ˜¯è¦ä¿è¯å½“å‡ºç°ç¡¬ä»¶æ•…éšœæ—¶ï¼ŒæœåŠ¡ä¾ç„¶å¯ç”¨ï¼Œæ•°æ®ä¾ç„¶èƒ½å¤Ÿä¿å­˜å¹¶è¢«è®¿é—®</strong>ã€‚</p>
<p><strong>å®ç°é«˜å¯ç”¨çš„ç³»ç»Ÿæ¶æ„çš„ä¸»è¦æ‰‹æ®µæ˜¯æ•°æ®å’ŒæœåŠ¡çš„å†—ä½™å¤‡ä»½åŠå¤±æ•ˆè½¬ç§»</strong>ï¼Œä¸€æ—¦æŸäº›æœåŠ¡å™¨å®•æœºï¼Œå°±å°†æœåŠ¡åˆ‡æ¢åˆ°å…¶ä»–å¯ç”¨çš„æœåŠ¡å™¨ä¸Šï¼›å¦‚æœç£ç›˜æŸåï¼Œåˆ™ä»å¤‡ä»½çš„ç£ç›˜è¯»å–æ•°æ®ã€‚</p>
<h2 id="3-é«˜å¯ç”¨çš„åº”ç”¨"><a class="markdownIt-Anchor" href="#3-é«˜å¯ç”¨çš„åº”ç”¨"></a> 3. é«˜å¯ç”¨çš„åº”ç”¨</h2>
<blockquote>
<p>åº”ç”¨å±‚ä¸»è¦å¤„ç†ç½‘ç«™åº”ç”¨çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¸€ä¸ªæ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯åº”ç”¨çš„ <strong>æ— çŠ¶æ€</strong> æ€§ã€‚</p>
<p>æ‰€è°“çš„ <strong>æ— çŠ¶æ€</strong> çš„åº”ç”¨æ˜¯æŒ‡åº”ç”¨æœåŠ¡å™¨ä¸ä¿å­˜ä¸šåŠ¡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè€Œä»…æ ¹æ®æ¯æ¬¡è¯·æ±‚æäº¤çš„æ•°æ®è¿›è¡Œç›¸åº”çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œå¤šä¸ªæœåŠ¡å®ä¾‹ä¹‹é—´å®Œå…¨å¯¹ç­‰ï¼Œè¯·æ±‚æäº¤åˆ°ä»»æ„æœåŠ¡å™¨ï¼Œå¤„ç†ç»“æœéƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</p>
</blockquote>
<h3 id="31-é€šè¿‡è´Ÿè½½å‡è¡¡è¿›è¡Œæ— çŠ¶æ€æœåŠ¡çš„å¤±æ•ˆè½¬ç§»"><a class="markdownIt-Anchor" href="#31-é€šè¿‡è´Ÿè½½å‡è¡¡è¿›è¡Œæ— çŠ¶æ€æœåŠ¡çš„å¤±æ•ˆè½¬ç§»"></a> 3.1. é€šè¿‡è´Ÿè½½å‡è¡¡è¿›è¡Œæ— çŠ¶æ€æœåŠ¡çš„å¤±æ•ˆè½¬ç§»</h3>
<p>æ— çŠ¶æ€çš„åº”ç”¨å®ç°é«˜å¯ç”¨æ¶æ„ååˆ†ç®€å•ï¼Œç”±äºæœåŠ¡å™¨ä¸ä¿å­˜è¯·æ±‚çŠ¶æ€ï¼Œé‚£ä¹ˆæ‰€æœ‰æœåŠ¡å™¨å®Œå…¨å¯¹ç­‰ï¼Œåœ¨ä»»æ„èŠ‚ç‚¹æ‰§è¡ŒåŒæ ·çš„è¯·æ±‚ï¼Œç»“æœæ€»æ˜¯ä¸€è‡´çš„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€ç®€å•çš„é«˜å¯ç”¨æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨è´Ÿè½½å‡è¡¡ã€‚</p>
<p>è´Ÿè½½å‡è¡¡ï¼Œé¡¾åæ€ä¹‰ï¼Œä¸»è¦ä½¿ç”¨åœ¨ä¸šåŠ¡é‡å’Œæ•°æ®é‡è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œå½“å•å°æœåŠ¡å™¨ä¸è¶³ä»¥æ‰¿æ‹…æ‰€æœ‰çš„è´Ÿè½½å‹åŠ›æ—¶ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æ‰‹æ®µï¼Œå°†æµé‡å’Œæ•°æ®åˆ†æ‘Šåˆ°ä¸€ä¸ªé›†ç¾¤ç»„æˆçš„å¤šå°æœåŠ¡å™¨ä¸Šï¼Œä»¥æé«˜æ•´ä½“çš„è´Ÿè½½å¤„ç†èƒ½åŠ›ã€‚</p>
<h3 id="32-åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„-session-ç®¡ç†"><a class="markdownIt-Anchor" href="#32-åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„-session-ç®¡ç†"></a> 3.2. åº”ç”¨æœåŠ¡å™¨é›†ç¾¤çš„ Session ç®¡ç†</h3>
<p>åº”ç”¨æœåŠ¡å™¨çš„é«˜å¯ç”¨æ¶æ„è®¾è®¡ä¸»è¦åŸºäºæœåŠ¡æ— çŠ¶æ€è¿™ä¸€ç‰¹æ€§ã€‚äº‹å®ä¸Šï¼Œä¸šåŠ¡æ€»æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå¦‚è´­ç‰©è½¦è®°å½•ç”¨æˆ·çš„è´­ä¹°ä¿¡æ¯ï¼›ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼›æœ€æ–°å‘å¸ƒçš„æ¶ˆæ¯ç­‰ç­‰ã€‚</p>
<p>Web åº”ç”¨ä¸­å°†è¿™äº›å¤šæ¬¡è¯·æ±‚ä¿®æ”¹ä½¿ç”¨çš„ä¸Šä¸‹æ–‡å¯¹è±¡ç§°ä½œä¼šè¯ã€‚å•æœºæƒ…å†µä¸‹ï¼ŒSession å¯ç”±éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šçš„ Web å®¹å™¨ç®¡ç†ã€‚</p>
<p>è€Œåœ¨é›†ç¾¤ç¯å¢ƒä¸‹ï¼ŒSession ç®¡ç†æœ‰ä»¥ä¸‹æ‰‹æ®µï¼š</p>
<h4 id="321-session-å¤åˆ¶"><a class="markdownIt-Anchor" href="#321-session-å¤åˆ¶"></a> 3.2.1. Session å¤åˆ¶</h4>
<p>Session å¤åˆ¶æ˜¯æŒ‡åº”ç”¨æœåŠ¡å™¨å¼€å¯ Web å®¹å™¨çš„ Session å¤åˆ¶åŠŸèƒ½ï¼Œåœ¨é›†ç¾¤ä¸­çš„å‡ å°æœåŠ¡å™¨ä¹‹é—´åŒæ­¥ Session å¯¹è±¡ï¼Œä½¿å¾—æ¯å°æœåŠ¡å™¨ä¸Šéƒ½ä¿å­˜æ‰€æœ‰ç”¨æˆ·çš„ Session ä¿¡æ¯ã€‚</p>
<p>è¿™ç§æ–¹æ¡ˆå¾ˆç®€å•ä½†ä¸å¯å–ã€‚å› ä¸ºå½“é›†ç¾¤è§„æ¨¡è¾ƒå¤§æ—¶ï¼Œé›†ç¾¤æœåŠ¡é—´éœ€è¦å¤§é‡çš„é€šä¿¡æ¥è¿›è¡Œ Session å¤åˆ¶ï¼Œå ç”¨æœåŠ¡å™¨å’Œç½‘ç»œçš„å¤§é‡èµ„æºã€‚</p>
<h4 id="322-session-ç»‘å®š"><a class="markdownIt-Anchor" href="#322-session-ç»‘å®š"></a> 3.2.2. Session ç»‘å®š</h4>
<p>Session ç»‘å®šå¯ä»¥åˆ©ç”¨è´Ÿè½½å‡è¡¡çš„æºåœ°å€ Hash ç®—æ³•å®ç°ï¼Œè´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ€»æ˜¯å°†æ¥æºäºåŒä¸€ IP çš„è¯·æ±‚åˆ†å‘åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šã€‚è¿™æ ·åœ¨æ•´ä¸ªä¼šè¯æœŸé—´ï¼Œç”¨æˆ·æ‰€æœ‰çš„è¯·æ±‚éƒ½åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šå¤„ç†ï¼Œå³ Session ç»‘å®šåˆ°æŸå°ç‰¹å®šæœåŠ¡å™¨ä¸Šã€‚è¿™ç§æ–¹æ³•åˆè¢«ç§°ä½œä¼šè¯é»æ»ã€‚</p>
<p>ä½†æ˜¯è¿™ç§ç­–ç•¥ä¸ç¬¦åˆç³»ç»Ÿé«˜å¯ç”¨çš„éœ€æ±‚ï¼Œå› ä¸ºä¸€æ—¦æŸå°æœåŠ¡å™¨å®•æœºï¼Œé‚£ä¹ˆè¯¥æœºå™¨ä¸Šçš„ Session ä¹Ÿå°±ä¸å¤å­˜åœ¨äº†ã€‚</p>
<h4 id="323-åˆ©ç”¨-cookie-è®°å½•-session"><a class="markdownIt-Anchor" href="#323-åˆ©ç”¨-cookie-è®°å½•-session"></a> 3.2.3. åˆ©ç”¨ Cookie è®°å½• Session</h4>
<p>å¯ä»¥å°† Session è®°å½•åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ Cookieï¼‰ï¼Œæ¯æ¬¡è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼Œå°† Session æ”¾åœ¨è¯·æ±‚ä¸­å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¤„ç†å®Œè¯·æ±‚åå†å°†ä¿®æ”¹è¿‡çš„ Session å“åº”ç»™å®¢æˆ·ç«¯ã€‚</p>
<p>è¿™ç§ç­–ç•¥çš„ç¼ºç‚¹æ˜¯ï¼š</p>
<ul>
<li>Cookie æœ‰å¤§å°é™åˆ¶ï¼Œèƒ½è®°å½•çš„ä¿¡æ¯æœ‰é™ï¼›</li>
<li>æ¯æ¬¡è¯·æ±‚å“åº”éƒ½éœ€è¦ä¼ è¾“ Cookieï¼Œå½±å“æ€§èƒ½ï¼›</li>
<li>å¦‚æœç”¨æˆ·å…³é—­ Cookieï¼Œè®¿é—®å°±ä¸èƒ½å·¥ä½œã€‚</li>
</ul>
<h4 id="324-session-æœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#324-session-æœåŠ¡å™¨"></a> 3.2.4. Session æœåŠ¡å™¨</h4>
<p>åˆ©ç”¨ç‹¬ç«‹éƒ¨ç½²çš„ Session æœåŠ¡å™¨ï¼ˆé›†ç¾¤ï¼‰ç»Ÿä¸€ç®¡ç† Sessionï¼Œåº”ç”¨æœåŠ¡å™¨æ¯æ¬¡è¯»å†™ Session æ—¶ï¼Œéƒ½è®¿é—® Session æœåŠ¡å™¨ã€‚</p>
<p>å®ç° Session æœåŠ¡å™¨çš„ä¸€ç§ç®€å•æ–¹æ³•æ—¶ï¼šåˆ©ç”¨åˆ†å¸ƒå¼ç¼“å­˜ã€æ•°æ®åº“ç­‰ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡ŒåŒ…è£…ï¼Œä½¿å…¶ç¬¦åˆ Session çš„å­˜å‚¨å’Œè®¿é—®è¦æ±‚ã€‚å¦‚æœä¸šåŠ¡å¯¹ Session ç®¡ç†æœ‰è¾ƒé«˜è¦æ±‚ï¼Œå¦‚åˆ©ç”¨ Session æœåŠ¡é›†æˆå•ç‚¹ç™»å½•ï¼ˆSSOï¼‰ã€ç”¨æˆ·æœåŠ¡ç­‰åŠŸèƒ½ï¼Œåˆ™éœ€è¦å¼€å‘ç‹¬ç«‹çš„ Session æœåŠ¡ç®¡ç†å¹³å°ã€‚</p>
<h2 id="4-é«˜å¯ç”¨çš„æœåŠ¡"><a class="markdownIt-Anchor" href="#4-é«˜å¯ç”¨çš„æœåŠ¡"></a> 4. é«˜å¯ç”¨çš„æœåŠ¡</h2>
<p>é«˜å¯ç”¨çš„æœåŠ¡ç­–ç•¥ï¼š</p>
<ul>
<li><strong>åˆ†çº§ç®¡ç†</strong>
<ul>
<li>å°†æœåŠ¡æ ¹æ®ä¸šåŠ¡é‡è¦æ€§è¿›è¡Œåˆ†çº§ç®¡ç†ï¼Œæ ¸å¿ƒåº”ç”¨å’ŒæœåŠ¡ä¼˜å…ˆä½¿ç”¨æ›´å¥½çš„ç¡¬ä»¶ï¼Œåœ¨è¿ç»´å“åº”é€Ÿåº¦ä¸Šä¹Ÿæ ¼å¤–è¿…é€Ÿã€‚</li>
<li>åœ¨æœåŠ¡éƒ¨ç½²ä¸Šè¿›è¡Œå¿…è¦çš„éš”ç¦»ï¼Œé¿å…æ•…éšœçš„è¿é”ååº”ã€‚ä½ä¼˜å…ˆçº§çš„æœåŠ¡é€šè¿‡å¯åŠ¨ä¸åŒçš„çº¿ç¨‹æˆ–éƒ¨ç½²åœ¨ä¸åŒçš„è™šæ‹Ÿæœºä¸Šè¿›è¡Œéš”ç¦»ï¼Œè€Œé«˜ä¼˜å…ˆçº§çš„æœåŠ¡åˆ™éœ€è¦éƒ¨ç½²åœ¨ä¸åŒçš„ç‰©ç†æœºä¸Šï¼Œæ ¸å¿ƒæœåŠ¡å’Œæ•°æ®ç”šè‡³è¦éƒ¨ç½²åœ¨ä¸åŒåœ°åŸŸçš„æ•°æ®ä¸­å¿ƒã€‚</li>
</ul>
</li>
<li><strong>è¶…æ—¶è®¾ç½®</strong> - ç”±äºæœåŠ¡å™¨å®•æœºã€çº¿ç¨‹æ­»é”ç­‰åŸå› ï¼Œå¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºå¯¹æœåŠ¡ç«¯çš„è°ƒç”¨å¤±å»å“åº”ã€‚æ‰€ä»¥æœ‰å¿…è¦å¼•å…¥è¶…æ—¶æœºåˆ¶ï¼Œä¸€æ—¦è°ƒç”¨è¶…æ—¶ï¼ŒæœåŠ¡åŒ–æ¡†æ¶æŠ›å‡ºå¼‚å¸¸ï¼Œåº”ç”¨ç¨‹åºæ ¹æ®æœåŠ¡è°ƒåº¦ç­–ç•¥ï¼Œé€‰æ‹©é‡è¯•æˆ–è¯·æ±‚è½¬ç§»åˆ°å…¶ä»–æœºå™¨ä¸Šã€‚</li>
<li><strong>å¼‚æ­¥è°ƒç”¨</strong> - å¯¹äºéœ€è¦å³æ—¶å“åº”çš„ä¸šåŠ¡ï¼Œåº”ç”¨åœ¨è°ƒç”¨æœåŠ¡æ—¶å¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ç­‰å¼‚æ­¥æ–¹å¼å®Œæˆï¼Œé¿å…ä¸€ä¸ªæœåŠ¡å¤±è´¥å¯¼è‡´æ•´ä¸ªåº”ç”¨è¯·æ±‚å¤±è´¥çš„æƒ…å†µã€‚å½“ç„¶ä¸æ˜¯æ‰€æœ‰æœåŠ¡è°ƒç”¨éƒ½å¯ä»¥å¼‚æ­¥è°ƒç”¨ï¼Œå¯¹äºè·å–ç”¨æˆ·ä¿¡æ¯è¿™ç±»è°ƒç”¨ï¼Œé‡‡ç”¨å¼‚æ­¥æ–¹å¼ä¼šå»¶é•¿å“åº”æ—¶é—´ï¼Œå¾—ä¸å¿å¤±ï¼›æ­¤å¤–ï¼Œå¯¹äºé‚£äº›å¿…é¡»ç¡®è®¤æœåŠ¡è°ƒç”¨æ‰èƒ½ç»§ç»­ä¸‹ä¸€æ­¥æ“ä½œçš„åº”ç”¨ä¹Ÿä¸é€‚å®œé£Ÿç”¨å¼‚æ­¥è°ƒç”¨ã€‚</li>
<li><strong>æœåŠ¡é™çº§</strong> - ç½‘ç«™è®¿é—®é«˜å³°æœŸï¼ŒæœåŠ¡å¯èƒ½å› ä¸ºå¤§é‡å¹¶å‘è°ƒç”¨è€Œæ€§èƒ½ä¸‹é™ï¼Œä¸¥é‡æ—¶å¯èƒ½ä¼šå¯¼è‡´å®•æœºã€‚ä¸ºäº†ä¿è¯æ ¸å¿ƒåŠŸèƒ½çš„æ­£å¸¸è¿è¡Œï¼Œéœ€è¦å¯¹æœåŠ¡è¿›è¡Œé™çº§ã€‚é™çº§æœ‰ä¸¤ç§æ‰‹æ®µï¼š
<ul>
<li><strong>æ‹’ç»æœåŠ¡</strong> - æ‹’ç»ä½ä¼˜å…ˆçº§åº”ç”¨çš„è°ƒç”¨ï¼Œå‡å°‘æœåŠ¡è°ƒç”¨å¹¶å‘æ•°ï¼Œç¡®ä¿æ ¸å¿ƒåº”ç”¨æ­£å¸¸ä½¿ç”¨ã€‚æˆ–è€…éšæœºæ‹’ç»éƒ¨åˆ†è°ƒç”¨ï¼ŒèŠ‚çº¦èµ„æºï¼Œé¿å…è¦æ­»å¤§å®¶ä¸€èµ·æ­»çš„æƒ¨å‰§ã€‚</li>
<li><strong>å…³é—­æœåŠ¡</strong> - å…³é—­éƒ¨åˆ†ä¸é‡è¦çš„æœåŠ¡ï¼Œæˆ–è€…æœåŠ¡å†…éƒ¨å…³é—­éƒ¨åˆ†ä¸é‡è¦çš„åŠŸèƒ½ï¼Œä»¥èŠ‚çº¦èµ„æºã€‚</li>
</ul>
</li>
<li><strong>å¹‚ç­‰æ€§è®¾è®¡</strong> - ä¸ºäº†é¿å…æœåŠ¡é‡å¤è°ƒç”¨ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ç¼–å·çš„æ–¹å¼è¿›è¡ŒæœåŠ¡è°ƒç”¨æœ‰æ•ˆæ€§æ ¡éªŒï¼Œæœ‰æ•ˆçš„æ“ä½œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
<h2 id="5-é«˜å¯ç”¨çš„æ•°æ®"><a class="markdownIt-Anchor" href="#5-é«˜å¯ç”¨çš„æ•°æ®"></a> 5. é«˜å¯ç”¨çš„æ•°æ®</h2>
<h3 id="51-cap-åŸç†"><a class="markdownIt-Anchor" href="#51-cap-åŸç†"></a> 5.1. CAP åŸç†</h3>
<p>åˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼ˆCï¼šConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAï¼šAvailabilityï¼‰å’Œåˆ†åŒºå®¹å¿æ€§ï¼ˆPï¼šPartition Toleranceï¼‰ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³å…¶ä¸­ä¸¤é¡¹ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/åˆ†å¸ƒå¼ç†è®º-CAP.jpg!zp" width="450"/>
</div>
<h4 id="511-å¯ç”¨æ€§"><a class="markdownIt-Anchor" href="#511-å¯ç”¨æ€§"></a> 5.1.1. å¯ç”¨æ€§</h4>
<p><strong>å¯ç”¨æ€§æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é¢å¯¹å„ç§å¼‚å¸¸æ—¶å¯ä»¥æä¾›æ­£å¸¸æœåŠ¡çš„èƒ½åŠ›</strong>ã€‚å¯ä»¥ç”¨ç³»ç»Ÿå¯ç”¨æ—¶é—´å æ€»æ—¶é—´çš„æ¯”å€¼æ¥è¡¡é‡ï¼Œ4 ä¸ª 9 çš„å¯ç”¨æ€§è¡¨ç¤ºç³»ç»Ÿ 99.99% çš„æ—¶é—´æ˜¯å¯ç”¨çš„ã€‚</p>
<p>åœ¨å¯ç”¨æ€§æ¡ä»¶ä¸‹ï¼Œç³»ç»Ÿæä¾›çš„æœåŠ¡ä¸€ç›´å¤„äºå¯ç”¨çš„çŠ¶æ€ï¼Œå¯¹äºç”¨æˆ·çš„æ¯ä¸€ä¸ªæ“ä½œè¯·æ±‚æ€»æ˜¯èƒ½å¤Ÿåœ¨æœ‰é™çš„æ—¶é—´å†…è¿”å›ç»“æœã€‚</p>
<h4 id="512-åˆ†åŒºå®¹å¿æ€§"><a class="markdownIt-Anchor" href="#512-åˆ†åŒºå®¹å¿æ€§"></a> 5.1.2. åˆ†åŒºå®¹å¿æ€§</h4>
<p>ç½‘ç»œåˆ†åŒºæŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹è¢«åˆ’åˆ†ä¸ºå¤šä¸ªåŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸå†…éƒ¨å¯ä»¥é€šä¿¡ï¼Œä½†æ˜¯åŒºåŸŸä¹‹é—´æ— æ³•é€šä¿¡ã€‚</p>
<p>åœ¨åˆ†åŒºå®¹å¿æ€§æ¡ä»¶ä¸‹ï¼Œ<strong>åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é‡åˆ°ä»»ä½•ç½‘ç»œåˆ†åŒºæ•…éšœçš„æ—¶å€™ï¼Œä»ç„¶éœ€è¦èƒ½å¯¹å¤–æä¾›ä¸€è‡´æ€§å’Œå¯ç”¨æ€§çš„æœåŠ¡ï¼Œé™¤éæ˜¯æ•´ä¸ªç½‘ç»œç¯å¢ƒéƒ½å‘ç”Ÿäº†æ•…éšœ</strong>ã€‚</p>
<h4 id="513-ä¸€è‡´æ€§"><a class="markdownIt-Anchor" href="#513-ä¸€è‡´æ€§"></a> 5.1.3. ä¸€è‡´æ€§</h4>
<p><strong>ä¸€è‡´æ€§æŒ‡çš„æ˜¯å¤šä¸ªæ•°æ®å‰¯æœ¬æ˜¯å¦èƒ½ä¿æŒä¸€è‡´çš„ç‰¹æ€§</strong>ã€‚</p>
<p>åœ¨ä¸€è‡´æ€§çš„æ¡ä»¶ä¸‹ï¼Œç³»ç»Ÿåœ¨æ‰§è¡Œæ•°æ®æ›´æ–°æ“ä½œä¹‹åèƒ½å¤Ÿä»ä¸€è‡´æ€§çŠ¶æ€è½¬ç§»åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚</p>
<p>æ•°æ®ä¸€è‡´æ€§åˆå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>å¼ºä¸€è‡´æ€§</strong> - æ•°æ®æ›´æ–°æ“ä½œç»“æœå’Œæ“ä½œå“åº”æ€»æ˜¯ä¸€è‡´çš„ï¼Œå³æ“ä½œå“åº”é€šçŸ¥æ›´æ–°å¤±è´¥ï¼Œé‚£ä¹ˆæ•°æ®ä¸€å®šæ²¡æœ‰è¢«æ›´æ–°ï¼Œè€Œä¸æ˜¯å¤„äºä¸ç¡®å®šçŠ¶æ€ã€‚</li>
<li><strong>æœ€ç»ˆä¸€è‡´æ€§</strong> - å³ç‰©ç†å­˜å‚¨çš„æ•°æ®å¯èƒ½æ˜¯ä¸ä¸€è‡´çš„ï¼Œç»ˆç«¯ç”¨æˆ·è®¿é—®åˆ°çš„æ•°æ®å¯èƒ½ä¹Ÿæ˜¯ä¸ä¸€è‡´çš„ï¼Œä½†ç³»ç»Ÿç»è¿‡ä¸€æ®µæ—¶é—´çš„è‡ªæˆ‘ä¿®å¤å’Œä¿®æ­£ï¼Œæ•°æ®æœ€ç»ˆä¼šè¾¾åˆ°ä¸€è‡´ã€‚</li>
</ul>
<h4 id="514-æƒè¡¡"><a class="markdownIt-Anchor" href="#514-æƒè¡¡"></a> 5.1.4. æƒè¡¡</h4>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œåˆ†åŒºå®¹å¿æ€§å¿…ä¸å¯å°‘ï¼Œå› ä¸ºéœ€è¦æ€»æ˜¯å‡è®¾ç½‘ç»œæ˜¯ä¸å¯é çš„ã€‚å› æ­¤ï¼ŒCAP ç†è®ºå®é™…åœ¨æ˜¯è¦åœ¨å¯ç”¨æ€§å’Œä¸€è‡´æ€§ä¹‹é—´åšæƒè¡¡ã€‚</p>
<p>å¯ç”¨æ€§å’Œä¸€è‡´æ€§å¾€å¾€æ˜¯å†²çªçš„ï¼Œå¾ˆéš¾éƒ½ä½¿å®ƒä»¬åŒæ—¶æ»¡è¶³ã€‚åœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´è¿›è¡Œæ•°æ®åŒæ­¥æ—¶ï¼Œ</p>
<ul>
<li>ä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼ˆCPï¼‰ï¼Œå°±éœ€è¦è®©æ‰€æœ‰èŠ‚ç‚¹ä¸‹çº¿æˆä¸ºä¸å¯ç”¨çš„çŠ¶æ€ï¼Œç­‰å¾…åŒæ­¥å®Œæˆï¼›</li>
<li>ä¸ºäº†ä¿è¯å¯ç”¨æ€§ï¼ˆAPï¼‰ï¼Œåœ¨åŒæ­¥è¿‡ç¨‹ä¸­å…è®¸è¯»å–æ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®å¯èƒ½ä¸ä¸€è‡´ã€‚</li>
</ul>
<h3 id="52-æ•°æ®å¤‡ä»½"><a class="markdownIt-Anchor" href="#52-æ•°æ®å¤‡ä»½"></a> 5.2. æ•°æ®å¤‡ä»½</h3>
<ul>
<li><strong>å†·å¤‡ä»½</strong> - å®šæœŸå°†æ•°æ®å¤åˆ¶åˆ°æŸç§å­˜å‚¨ä»‹è´¨ã€‚</li>
<li><strong>çƒ­å¤‡ä»½</strong>
<ul>
<li><strong>å¼‚æ­¥çƒ­å¤‡æ–¹å¼</strong> - å¼‚æ­¥çƒ­å¤‡æ–¹å¼æ˜¯æŒ‡å¤šä»½æ•°æ®å‰¯æœ¬çš„å†™å…¥æ“ä½œå¼‚æ­¥å®Œæˆï¼Œåº”ç”¨ç¨‹åºæ”¶åˆ°æ•°æ®æœåŠ¡ç³»ç»Ÿçš„å†™æ“ä½œæˆåŠŸå“åº”æ—¶ï¼Œåªå†™æˆåŠŸäº†ä¸€ä»½ï¼Œå­˜å‚¨ç³»ç»Ÿå°†ä¼šå¼‚æ­¥åœ°å†™å…¶ä»–å‰¯æœ¬ã€‚</li>
<li><strong>åŒæ­¥çƒ­å¤‡æ–¹å¼</strong> - åŒæ­¥çƒ­å¤‡æ–¹å¼æ˜¯æŒ‡å¤šä»½æ•°æ®å‰¯æœ¬çš„å†™å…¥æ“ä½œåŒæ­¥å®Œæˆï¼Œå³åº”ç”¨ç¨‹åºæ”¶åˆ°æ•°æ®æœåŠ¡ç³»ç»Ÿçš„å†™æˆåŠŸå“åº”æ—¶ï¼Œå¤šä»½æ•°æ®éƒ½å·²ç»å†™æ“ä½œæˆåŠŸã€‚ä½†æ˜¯å½“åº”ç”¨ç¨‹åºæ”¶åˆ°æ•°æ®å†™æ“ä½œå¤±è´¥çš„å“åº”å¼ï¼Œå¯èƒ½æœ‰éƒ¨åˆ†å‰¯æœ¬æˆ–è€…å…¨éƒ¨å‰¯æœ¬éƒ½å·²ç»å†™å…¥æˆåŠŸäº†ï¼ˆå› ä¸ºç½‘ç»œæˆ–è€…ç³»ç»Ÿæ•…éšœï¼Œæ— æ³•è¿”å›æ“ä½œæˆåŠŸçš„å“åº”ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 id="53-å¤±æ•ˆè½¬ç§»"><a class="markdownIt-Anchor" href="#53-å¤±æ•ˆè½¬ç§»"></a> 5.3. å¤±æ•ˆè½¬ç§»</h3>
<h4 id="531-å¤±æ•ˆç¡®è®¤"><a class="markdownIt-Anchor" href="#531-å¤±æ•ˆç¡®è®¤"></a> 5.3.1. å¤±æ•ˆç¡®è®¤</h4>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/check-fail.png!zp" width="500" />
</div>
<p>åˆ¤æ–­æœåŠ¡å™¨å®•æœºçš„æ‰‹æ®µæœ‰ä¸¤ç§ï¼š<strong>å¿ƒè·³æ£€æµ‹</strong>å’Œ<strong>è®¿é—®å¤±è´¥æŠ¥å‘Š</strong>ã€‚</p>
<p>å¯¹äºåº”ç”¨ç¨‹åºçš„è®¿é—®å¤±è´¥æŠ¥å‘Šï¼Œæ§åˆ¶ä¸­å¿ƒè¿˜éœ€è¦å†ä¸€æ¬¡å‘é€å¿ƒè·³æ£€æµ‹è¿›è¡Œç¡®è®¤ï¼Œä»¥å…é”™è¯¯åˆ¤æ–­æœåŠ¡å™¨å®•æœºã€‚å› ä¸ºä¸€æ—¦è¿›è¡Œæ•°æ®è®¿é—®çš„å¤±æ•ˆè½¬ç§»ï¼Œæ„å‘³ç€æ•°æ®å­˜å‚¨å¤šä»½å‰¯æœ¬ä¸ä¸€è‡´ï¼Œéœ€è¦è¿›è¡Œåç»­ä¸€ç³»åˆ—çš„å¤æ‚åŠ¨ä½œã€‚</p>
<h4 id="532-è®¿é—®è½¬ç§»"><a class="markdownIt-Anchor" href="#532-è®¿é—®è½¬ç§»"></a> 5.3.2. è®¿é—®è½¬ç§»</h4>
<p>ç¡®è®¤æŸå°æ•°æ®æœåŠ¡å™¨å®•æœºåï¼Œå°±éœ€è¦å°†æ•°æ®è¯»å†™è®¿é—®é‡æ–°è·¯ç”±åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Šã€‚å¯¹äºå®Œå…¨å¯¹ç­‰å­˜å‚¨çš„æœåŠ¡å™¨ï¼Œå½“å…¶ä¸­ä¸€å°å®•æœºåï¼Œåº”ç”¨ç¨‹åºæ ¹æ®é…ç½®ç›´æ¥åˆ‡æ¢åˆ°å¯¹ç­‰æœåŠ¡å™¨ä¸Šã€‚å¦‚æœå­˜å‚¨ä¸å¯¹ç­‰ï¼Œå°±éœ€è¦é‡æ–°è®¡ç®—è·¯ç”±ï¼Œé€‰æ‹©å­˜å‚¨æœåŠ¡å™¨ã€‚</p>
<h4 id="533-æ•°æ®æ¢å¤"><a class="markdownIt-Anchor" href="#533-æ•°æ®æ¢å¤"></a> 5.3.3. æ•°æ®æ¢å¤</h4>
<p>å› ä¸ºæŸå°æœåŠ¡å™¨å®•æœºï¼Œæ‰€ä»¥æ•°æ®å­˜å‚¨çš„å‰¯æœ¬æ•°ç›®ä¼šå‡å°‘ï¼Œå¿…é¡»å°†å‰¯æœ¬çš„æ•°ç›®æ¢å¤åˆ°ç³»ç»Ÿè®¾å®šçš„å€¼ï¼Œå¦åˆ™ï¼Œå†æœ‰æœåŠ¡å™¨å®•æœºæ—¶ï¼Œå°±å¯èƒ½å‡ºç°æ— æ³•è®¿é—®è½¬ç§»ï¼Œæ•°æ®æ°¸ä¹…ä¸¢å¤±çš„æƒ…å†µã€‚å› æ­¤ç³»ç»Ÿéœ€è¦ä»å¥åº·çš„æœåŠ¡å™¨å¤åˆ¶æ•°æ®ï¼Œå°†æ•°æ®å‰¯æœ¬æ•°ç›®æ¢å¤åˆ°è®¾å®šå€¼ã€‚</p>
<h2 id="6-é«˜å¯ç”¨çš„è½¯ä»¶è´¨é‡ä¿è¯"><a class="markdownIt-Anchor" href="#6-é«˜å¯ç”¨çš„è½¯ä»¶è´¨é‡ä¿è¯"></a> 6. é«˜å¯ç”¨çš„è½¯ä»¶è´¨é‡ä¿è¯</h2>
<p>é«˜å¯ç”¨çš„è½¯ä»¶è´¨é‡ä¿è¯çš„æ‰‹æ®µï¼š</p>
<ul>
<li>è‡ªåŠ¨åŒ–å‘å¸ƒ</li>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•</li>
<li>é¢„å‘å¸ƒéªŒè¯</li>
<li>ä»£ç æ§åˆ¶</li>
<li>ç°åº¦å‘å¸ƒ</li>
</ul>
<h2 id="7-ç³»ç»Ÿç›‘æ§"><a class="markdownIt-Anchor" href="#7-ç³»ç»Ÿç›‘æ§"></a> 7. ç³»ç»Ÿç›‘æ§</h2>
<blockquote>
<p>ä¸å…è®¸æ²¡æœ‰ç›‘æ§çš„ç³»ç»Ÿä¸Šçº¿ã€‚</p>
</blockquote>
<ul>
<li><strong>ç›‘æ§æ•°æ®é‡‡é›†</strong>
<ul>
<li><strong>ç”¨æˆ·è¡Œä¸ºæ—¥å¿—æ”¶é›†</strong>
<ul>
<li>æœåŠ¡ç«¯æ—¥å¿—æ”¶é›† - Apacheã€Nginx ç­‰å‡ ä¹æ‰€æœ‰ Web æœåŠ¡å™¨éƒ½å…·å¤‡æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œåªè¦å¼€å¯æ—¥å¿—è®°å½•å³å¯ã€‚å¦‚æœæ˜¯æœåŠ¡å™¨æ¯”è¾ƒå¤šï¼Œéœ€è¦é›†ä¸­é‡‡é›†æ—¥å¿—ï¼Œé€šå¸¸ä¼šä½¿ç”¨ Elastic æ¥è¿›è¡Œæ”¶é›†ã€‚</li>
<li>å®¢æˆ·ç«¯æ—¥å¿—æ”¶é›† - åˆ©ç”¨é¡µé¢åµŒå…¥ä¸“é—¨çš„ JavaScript è„šæœ¬å¯ä»¥æ”¶é›†ç”¨æˆ·çœŸå®çš„æ“ä½œè¡Œä¸ºã€‚</li>
<li>æ—¥å¿—åˆ†æ - å¯ä»¥åˆ©ç”¨ ElasticSearch åšè¯­ä¹‰åˆ†æåŠæœç´¢ï¼›åˆ©ç”¨å®æ—¶è®¡ç®—æ¡†æ¶ Stormã€Flink ç­‰å¼€å‘æ—¥å¿—ç»Ÿè®¡ä¸åˆ†æå·¥å…·ã€‚</li>
</ul>
</li>
<li><strong>æœåŠ¡å™¨æ€§èƒ½ç›‘æ§</strong> - æ”¶é›†æœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚ç³»ç»Ÿè´Ÿè½½ã€å†…å­˜å ç”¨ã€CPU å ç”¨ã€ç£ç›˜ IOã€ç½‘ç»œ IO ç­‰ã€‚å¸¸ç”¨çš„ç›‘æ§å·¥å…·æœ‰ï¼š<a href="https://github.com/apache/skywalking" target="_blank" rel="noopener">Apache SkyWalking</a> ã€<a href="https://github.com/naver/pinpoint" target="_blank" rel="noopener">Pinpoint</a> ç­‰ã€‚</li>
<li><strong>è¿è¡Œæ•°æ®æŠ¥å‘Š</strong> - åº”è¯¥ç›‘æ§ä¸€äº›ä¸å…·ä½“ä¸šåŠ¡åœºæ™¯ç›¸å…³çš„æŠ€æœ¯å’Œä¸šåŠ¡æŒ‡æ ‡ï¼Œå¦‚ï¼šç¼“å­˜å‘½ä¸­ç‡ã€å¹³å‡å“åº”æ—¶å»¶ã€TPSã€QPS ç­‰ã€‚</li>
</ul>
</li>
<li><strong>ç›‘æ§ç®¡ç†</strong>
<ul>
<li><strong>ç³»ç»ŸæŠ¥è­¦</strong> - è®¾ç½®é˜ˆå€¼ã€‚å½“è¾¾åˆ°é˜ˆå€¼ï¼ŒåŠæ—¶è§¦å‘å‘Šè­¦ï¼ˆçŸ­ä¿¡ã€é‚®ä»¶ã€é€šä¿¡å·¥å…·å‡å¯ï¼‰ï¼Œé€šè¿‡åŠæ—¶åˆ¤æ–­çŠ¶å†µï¼Œé˜²æ‚£äºæœªç„¶ã€‚</li>
<li><strong>å¤±æ•ˆè½¬ç§»</strong> - ç›‘æ§ç³»ç»Ÿå¯ä»¥åœ¨å‘ç°æ•…éšœçš„æƒ…å†µä¸‹ä¸»åŠ¨é€šçŸ¥åº”ç”¨è¿›è¡Œå¤±æ•ˆè½¬ç§»ã€‚</li>
<li><strong>è‡ªåŠ¨ä¼˜é›…é™çº§</strong>
<ul>
<li>ä¼˜é›…é™çº§æ˜¯ä¸ºäº†åº”ä»˜çªç„¶çˆ†å‘çš„è®¿é—®é«˜å³°ï¼Œä¸»åŠ¨å…³é—­éƒ¨åˆ†åŠŸèƒ½ï¼Œé‡Šæ”¾éƒ¨åˆ†èµ„æºï¼Œä»¥ä¿è¯æ ¸å¿ƒåŠŸèƒ½çš„ä¼˜å…ˆè®¿é—®ã€‚</li>
<li>ç³»ç»Ÿåœ¨ç›‘æ§ç®¡ç†åŸºç¡€ä¹‹ä¸Šå®ç°è‡ªåŠ¨ä¼˜é›…é™çº§ï¼Œæ˜¯æŸ”æ€§æ¶æ„çš„ç†æƒ³çŠ¶æ€ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="8-èµ„æ–™"><a class="markdownIt-Anchor" href="#8-èµ„æ–™"></a> 8. èµ„æ–™</h2>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>æ‰©å±•æ€§æ¶æ„</title>
    <url>/blog/design/architecture/extensible-architecture/</url>
    <content><![CDATA[<h1 id="æ‰©å±•æ€§æ¶æ„"><a class="markdownIt-Anchor" href="#æ‰©å±•æ€§æ¶æ„"></a> æ‰©å±•æ€§æ¶æ„</h1>
<blockquote>
<p>æ‰©å±•æ€§å’Œä¼¸ç¼©æ€§æ˜¯ä¸åŒçš„æ¦‚å¿µï¼š</p>
<ul>
<li><strong>æ‰©å±•æ€§ï¼ˆExtensibilityï¼‰</strong> - æŒ‡å¯¹ç°æœ‰ç³»ç»Ÿå½±å“æœ€å°çš„æƒ…å†µä¸‹ï¼Œç³»ç»ŸåŠŸèƒ½å¯æŒç»­æ‰©å±•æˆ–æå‡çš„èƒ½åŠ›ã€‚è¡¨ç°åœ¨ç³»ç»ŸåŸºç¡€è®¾æ–½ç¨³å®šä¸éœ€è¦ç»å¸¸å˜æ›´ï¼Œåº”ç”¨ä¹‹é—´è¾ƒå°‘ä¾èµ–å’Œè€¦åˆï¼Œå¯¹éœ€æ±‚å˜æ›´å¯ä»¥æ•æ·å“åº”ã€‚å®ƒæ˜¯ç³»ç»Ÿæ¶æ„è®¾è®¡å±‚é¢çš„å¼€é—­åŸåˆ™ï¼ˆå¯¹æ‰©å±•å¼€æ”¾ã€å¯¹ä¿®æ”¹å…³é—­ï¼‰ï¼Œæ¶æ„è®¾è®¡è€ƒè™‘æœªæ¥åŠŸèƒ½æ‰©å±•ï¼Œå½“ç³»ç»Ÿå¢åŠ æ–°åŠŸèƒ½æ—¶ï¼Œä¸éœ€è¦å¯¹ç°æœ‰ç³»ç»Ÿçš„ç»“æ„å’Œä»£ç è¿›è¡Œä¿®æ”¹ã€‚</li>
<li><strong>ä¼¸ç¼©æ€§ï¼ˆScalabilityï¼‰</strong> - æŒ‡ç³»ç»Ÿèƒ½å¤Ÿé€šè¿‡å¢åŠ å‡å°‘è‡ªèº«èµ„æºè§„æ¨¡çš„æ–¹å¼å¢å‡è‡ªå·±è®¡ç®—å¤„ç†äº‹åŠ¡çš„èƒ½åŠ›ã€‚å¦‚æœè¿™ç§å¢å‡æ˜¯æˆæ¯”ä¾‹çš„ï¼Œå°±è¢«ç§°ä½œçº¿æ€§ä¼¸ç¼©æ€§ã€‚åœ¨ç½‘ç«™æ¶æ„ä¸­ ï¼Œé€šå¸¸æŒ‡åˆ©ç”¨é›†ç¾¤çš„æ–¹å¼å¢åŠ æœåŠ¡å™¨æ•°é‡ã€æé«˜ç³»ç»Ÿçš„æ•´ä½“äº‹åŠ¡ååèƒ½åŠ›ã€‚</li>
</ul>
</blockquote>
<h2 id="1-æ˜“æ‰©å±•çš„ç³»ç»Ÿæ¶æ„"><a class="markdownIt-Anchor" href="#1-æ˜“æ‰©å±•çš„ç³»ç»Ÿæ¶æ„"></a> 1. æ˜“æ‰©å±•çš„ç³»ç»Ÿæ¶æ„</h2>
<blockquote>
<p><strong>ä½è€¦åˆçš„ç³»ç»Ÿæ›´å®¹æ˜“æ‰©å±•ã€å¤ç”¨</strong>ã€‚</p>
</blockquote>
<p><strong>å¯æ‰©å±•æ¶æ„çš„æ ¸å¿ƒæ€æƒ³æ˜¯æ¨¡å—åŒ–ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆæ€§ï¼Œæé«˜æ¨¡å—çš„å¤ç”¨æ€§</strong>ã€‚</p>
<p>åˆ†å±‚å’Œåˆ†å‰²ä¸ä»…å¯ä»¥è¿›è¡Œæ¶æ„ä¼¸ç¼©ï¼Œä¹Ÿæ˜¯æ¨¡å—åŒ–è®¾è®¡çš„é‡è¦æ‰‹æ®µï¼Œåˆ©ç”¨åˆ†å±‚å’Œåˆ†å‰²çš„æ–¹å¼å°†è½¯ä»¶åˆ†å‰²ä¸ºè‹¥å¹²ä¸ªä½è€¦åˆçš„ç‹¬ç«‹çš„ç»„ä»¶æ¨¡å—ï¼Œè¿™äº›ç»„ä»¶æ¨¡å—ä»¥æ¶ˆæ¯ä¼ é€’åŠä¾èµ–è°ƒç”¨çš„æ–¹å¼èšåˆæˆä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿã€‚</p>
<p>åœ¨å¤§å‹ç½‘ç«™ä¸­ï¼Œè¿™äº›æ¨¡å—é€šè¿‡åˆ†å¸ƒå¼éƒ¨ç½²çš„æ–¹å¼ï¼Œç‹¬ç«‹çš„æ¨¡å—éƒ¨ç½²åœ¨ç‹¬ç«‹çš„æœåŠ¡å™¨ä¸Šï¼Œä»ç‰©ç†ä¸Šåˆ†ç¦»æ¨¡å—é—´çš„è€¦åˆå…³ç³»ï¼Œè¿›ä¸€æ­¥é™ä½è€¦åˆæ€§æé«˜å¤ç”¨æ€§ã€‚</p>
<h2 id="2-åˆ©ç”¨åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é™ä½ç³»ç»Ÿè€¦åˆæ€§"><a class="markdownIt-Anchor" href="#2-åˆ©ç”¨åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é™ä½ç³»ç»Ÿè€¦åˆæ€§"></a> 2. åˆ©ç”¨åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é™ä½ç³»ç»Ÿè€¦åˆæ€§</h2>
<h3 id="21-äº‹ä»¶é©±åŠ¨æ¶æ„"><a class="markdownIt-Anchor" href="#21-äº‹ä»¶é©±åŠ¨æ¶æ„"></a> 2.1. äº‹ä»¶é©±åŠ¨æ¶æ„</h3>
<p><strong>äº‹ä»¶é©±åŠ¨æ¶æ„é€šè¿‡åœ¨ä½è€¦åˆçš„æ¨¡å—é—´ä¼ è¾“äº‹ä»¶æ¶ˆæ¯ï¼Œä»¥ä¿æŒæ¨¡å—çš„æ¾æ•£è€¦åˆï¼Œå¹¶å€ŸåŠ©äº‹ä»¶æ¶ˆæ¯çš„é€šä¿¡å®Œæˆæ¨¡å—é—´åˆä½œ</strong>ã€‚å…¸å‹çš„äº‹ä»¶é©±åŠ¨æ¶æ„å°±æ˜¯æ“ä½œç³»ç»Ÿä¸­å¸¸è§çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ã€‚åœ¨å¤§å‹ç½‘ç«™ä¸­ï¼Œæœ€å¸¸è§çš„å®ç°æ‰‹æ®µå°±æ˜¯åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p>
<h3 id="22-åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#22-åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—"></a> 2.2. åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—</h3>
<p>æ¶ˆæ¯ç”Ÿäº§è€…åº”ç”¨ç¨‹åºé€šè¿‡è¿œç¨‹è®¿é—®æ¥å£å°†æ¶ˆæ¯æ¨é€ç»™æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ï¼Œæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å°†æ¶ˆæ¯å†™å…¥æœ¬åœ°å†…å­˜é˜Ÿåˆ—åç«‹å³è¿”å›æˆåŠŸå“åº”ç»™æ¶ˆæ¯ç”Ÿäº§è€…ã€‚æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨æ ¹æ®æ¶ˆæ¯è®¢é˜…åˆ—è¡¨æŸ¥æ‰¾è®¢é˜…è¯¥æ¶ˆæ¯çš„æ¶ˆæ¯æ¶ˆè´¹è€…åº”ç”¨ç¨‹åºï¼Œå°†æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æŒ‰ç…§å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„åŸåˆ™å°†æ¶ˆæ¯é€šè¿‡è¿œç¨‹é€šä¿¡æ¥å£å‘é€ç»™æ¶ˆæ¯æ¶ˆè´¹è€…ç¨‹åºã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„åŸç†.png!zp" />
</div>
<p>åœ¨ä¼¸ç¼©æ€§æ–¹é¢ï¼Œç”±äºæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ä¸Šçš„æ•°æ®å¯ä»¥çœ‹ä½œæ˜¯å³æ—¶å¤„ç†çš„ï¼Œå› æ­¤ç±»ä¼¼äºæ— çŠ¶æ€çš„æœåŠ¡å™¨ï¼Œä¼¸ç¼©æ€§è®¾è®¡æ¯”è¾ƒç®€å•ã€‚å°†æ–°æœåŠ¡å™¨åŠ å…¥åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—é›†ç¾¤ä¸­ï¼Œé€šçŸ¥ç”Ÿäº§è€…æœåŠ¡å™¨æ›´æ”¹æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨åˆ—è¡¨å³å¯ã€‚</p>
<p>åœ¨å¯ç”¨æ€§æ–¹é¢ï¼Œä¸ºäº†é¿å…æ¶ˆè´¹è€…è¿›ç¨‹å¤„ç†ç¼“æ…¢ï¼Œåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨å†…å­˜ç©ºé—´ä¸è¶³é€ æˆçš„é—®é¢˜ï¼Œå¦‚æœå†…å­˜é˜Ÿåˆ—å·²æ»¡ï¼Œä¼šå°†æ¶ˆæ¯å†™å…¥ç£ç›˜ï¼Œæ¶ˆæ¯æ¨é€æ¨¡å—åœ¨å°†å†…å­˜é˜Ÿåˆ—æ¶ˆæ¯å¤„ç†å®Œæˆä»¥åï¼Œå°†ç£ç›˜å†…å®¹åŠ è½½åˆ°å†…å­˜é˜Ÿåˆ—ç»§ç»­å¤„ç†ã€‚</p>
<h2 id="3-åˆ©ç”¨åˆ†å¸ƒå¼æœåŠ¡æ‰“é€ å¯å¤ç”¨çš„ä¸šåŠ¡å¹³å°"><a class="markdownIt-Anchor" href="#3-åˆ©ç”¨åˆ†å¸ƒå¼æœåŠ¡æ‰“é€ å¯å¤ç”¨çš„ä¸šåŠ¡å¹³å°"></a> 3. åˆ©ç”¨åˆ†å¸ƒå¼æœåŠ¡æ‰“é€ å¯å¤ç”¨çš„ä¸šåŠ¡å¹³å°</h2>
<p>å·¨æ— éœ¸ç³»ç»Ÿçš„é—®é¢˜ï¼š</p>
<ul>
<li>æ„å»ºã€éƒ¨ç½²å›°éš¾</li>
<li>ä»£ç åˆ†æ”¯ç®¡ç†å›°éš¾</li>
<li>æ•°æ®åº“è¿æ¥è€—å°½</li>
<li>æ‰©å±•ä¸šåŠ¡å›°éš¾</li>
</ul>
<p>è€Œè§£å†³å·¨æ— éœ¸ç³»ç»Ÿé—®é¢˜çš„æ–¹æ¡ˆå°±æ˜¯æ‹†åˆ†ï¼š</p>
<ul>
<li>é€šè¿‡çºµå‘æ‹†åˆ†å°†ä¸šåŠ¡æ‹†åˆ†å¤šä¸ªåº”ç”¨æˆ–æ¨¡å—ï¼›</li>
<li>é€šè¿‡æ¨ªå‘æ‹†åˆ†å°†å¯å¤ç”¨ä¸šåŠ¡ä½œä¸ºç‹¬ç«‹åº”ç”¨ã€‚</li>
</ul>
<p>ç„¶åï¼Œéœ€è¦é€šè¿‡ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡ç®¡ç†æ¡†æ¶å°†è¿™äº›åº”ç”¨æˆ–æœåŠ¡ç»„ç»‡ç®¡ç†èµ·æ¥ï¼šé€šè¿‡æ¥å£åˆ†è§£ç³»ç»Ÿè€¦åˆæ€§ï¼Œä¸åŒå­ç³»ç»Ÿé€šè¿‡ç›¸åŒçš„æ¥å£æè¿°è¿›è¡ŒæœåŠ¡è°ƒç”¨ã€‚å¸¸è§çš„åˆ†å¸ƒå¼æœåŠ¡ç®¡ç†æ¡†æ¶å¦‚ï¼šSpring Cloudã€Dubbo ç­‰ã€‚</p>
<p>å¤§å‹ç½‘ç«™åˆ†å¸ƒå¼æœåŠ¡çš„éœ€æ±‚ä¸ç‰¹ç‚¹ï¼š</p>
<ul>
<li>è´Ÿè½½å‡è¡¡</li>
<li>å¤±æ•ˆè½¬ç§»</li>
<li>é«˜æ•ˆçš„è¿œç¨‹é€šä¿¡</li>
<li>æ•´åˆå¼‚æ„ç³»ç»Ÿ</li>
<li>å¯¹åº”ç”¨æœ€å°‘ä¾µå…¥</li>
<li>ç‰ˆæœ¬ç®¡ç†</li>
<li>å®æ—¶ç›‘æ§</li>
</ul>
<h2 id="4-å¯æ‰©å±•çš„æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#4-å¯æ‰©å±•çš„æ•°æ®ç»“æ„"></a> 4. å¯æ‰©å±•çš„æ•°æ®ç»“æ„</h2>
<p>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ä¸ºäº†ä¿è¯å…³ç³»è¿ç®—çš„æ­£ç¡®æ€§ï¼Œåœ¨è®¾è®¡æ•°æ®åº“è¡¨ç»“æ„çš„æ—¶å€™ï¼Œå°±éœ€è¦æŒ‡å®šè¡¨çš„ schema â€”â€”å­—æ®µåç§°ï¼Œæ•°æ®ç±»å‹ç­‰ï¼Œå¹¶è¦éµå¾ªç‰¹å®šçš„è®¾è®¡èŒƒå¼ã€‚è¿™äº›è§„èŒƒå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šéš¾ä»¥é¢å¯¹éœ€æ±‚å˜æ›´å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œæ‰€ä»¥æœ‰äººé€šè¿‡é¢„å…ˆè®¾è®¡ä¸€äº›å†—ä½™å­—æ®µæ¥åº”å¯¹ã€‚</p>
<p>è®¸å¤š NoSql æ•°æ®åº“ä½¿ç”¨ ColumnFamily è®¾è®¡æ¥è®¾è®¡å¯æ‰©å±•çš„æ•°æ®ç»“æ„ã€‚</p>
<h2 id="5-å¼€æ”¾å¹³å°"><a class="markdownIt-Anchor" href="#5-å¼€æ”¾å¹³å°"></a> 5. å¼€æ”¾å¹³å°</h2>
<p>å¾ˆå¤šå¤§å…¬å¸ä¼šåˆ©ç”¨å¼€æ”¾å¹³å°æä¾›å¤§é‡å¼€æ”¾æ€§ API ä½¿å¾—ä¼ä¸šå’Œä¸ªäººå¯ä»¥æ–¹ä¾¿çš„æ¥å…¥ä¸šåŠ¡ã€‚é€šè¿‡å¼€æ”¾å¹³å°ï¼Œå¯ä»¥æ„å»ºç”Ÿæ€åœˆï¼Œæå‡å“ç‰Œä»·å€¼ä»¥åŠç«äº‰åŠ›ã€‚</p>
<p>å¼€æ”¾å¹³å°ä¸æ˜¯ä¸€æœä¸€å¤•å®Œæˆçš„ï¼Œè¿™éœ€è¦å¤§é‡ OPEN API çš„æ²‰æ·€ã€‚ç³»ç»Ÿæ¶æ„åœ¨è®¾è®¡ä¹‹åˆï¼Œåº”è¯¥æœ‰æ„è¯†çš„å°†æœªæ¥å¯èƒ½è¢«å¤ç”¨çš„æ¥å£å¥½å¥½è®¾è®¡ï¼Œä»¥ä¾¿äºéœ€è¦å¼€æ”¾ OPEN API æ—¶ï¼Œå¯ä»¥ä¾¿æ·çš„æš´éœ²æœåŠ¡æ¥å£ã€‚</p>
<h2 id="6-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#6-å‚è€ƒèµ„æ–™"></a> 6. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>é«˜æ€§èƒ½æ¶æ„</title>
    <url>/blog/design/architecture/high-performance-architecture/</url>
    <content><![CDATA[<h1 id="é«˜æ€§èƒ½æ¶æ„"><a class="markdownIt-Anchor" href="#é«˜æ€§èƒ½æ¶æ„"></a> é«˜æ€§èƒ½æ¶æ„</h1>
<h2 id="1-æ€§èƒ½æµ‹è¯•"><a class="markdownIt-Anchor" href="#1-æ€§èƒ½æµ‹è¯•"></a> 1. æ€§èƒ½æµ‹è¯•</h2>
<blockquote>
<p>æ€§èƒ½æµ‹è¯•æ˜¯æ€§èƒ½ä¼˜åŒ–çš„å‰æå’ŒåŸºç¡€ï¼Œä¹Ÿæ˜¯æ€§èƒ½ä¼˜åŒ–ç»“æœçš„æ£€æŸ¥å’Œåº¦é‡æ ‡å‡†ã€‚ä¸åŒè§†è§’ä¸‹çš„æ€§èƒ½æœ‰ä¸åŒæ ‡å‡†ï¼Œä¹Ÿæœ‰ä¸åŒçš„ä¼˜åŒ–æ‰‹æ®µã€‚</p>
</blockquote>
<h3 id="11-æ€§èƒ½æŒ‡æ ‡"><a class="markdownIt-Anchor" href="#11-æ€§èƒ½æŒ‡æ ‡"></a> 1.1. æ€§èƒ½æŒ‡æ ‡</h3>
<p>æ€§èƒ½æµ‹è¯•çš„ä¸»è¦æŒ‡æ ‡æœ‰ï¼š</p>
<ul>
<li><strong>å“åº”æ—¶é—´</strong> - å“åº”æ—¶é—´(RT)æ˜¯æŒ‡ä»å®¢æˆ·ç«¯å‘ä¸€ä¸ªè¯·æ±‚å¼€å§‹è®¡æ—¶ï¼Œåˆ°å®¢æˆ·ç«¯æ¥æ”¶åˆ°ä»æœåŠ¡å™¨ç«¯è¿”å›çš„å“åº”ç»“æœç»“æŸæ‰€ç»å†çš„æ—¶é—´ï¼Œå“åº”æ—¶é—´ç”±è¯·æ±‚å‘é€æ—¶é—´ã€ç½‘ç»œä¼ è¾“æ—¶é—´å’ŒæœåŠ¡å™¨å¤„ç†æ—¶é—´ä¸‰éƒ¨åˆ†ç»„æˆã€‚</li>
<li><strong>å¹¶å‘æ•°</strong> - ç³»ç»Ÿèƒ½åŒæ—¶å¤„ç†çš„è¯·æ±‚ã€äº‹åŠ¡æ•°ã€‚</li>
<li><strong>ååé‡</strong> - <strong><code>TPS(æ¯ç§’äº‹åŠ¡æ•°)</code></strong>ã€<strong><code>HPS(æ¯ç§’ HTTP è¯·æ±‚æ•°)</code></strong>ã€<strong><code>QPS(æ¯ç§’æŸ¥è¯¢æ•°)</code></strong>ã€‚</li>
<li><strong>æ€§èƒ½è®¡æ•°å™¨</strong> - ç³»ç»Ÿè´Ÿè½½ã€å¯¹è±¡ä¸çº¿ç¨‹æ•°ã€å†…å­˜ä½¿ç”¨ã€CPU ä½¿ç”¨ã€ç£ç›˜ä¸ç½‘ç»œ IO ç­‰ã€‚è¿™äº›æŒ‡æ ‡ä¹Ÿæ˜¯ç³»ç»Ÿç›‘æ§çš„é‡è¦å‚æ•°ã€‚</li>
</ul>
<h3 id="12-æ€§èƒ½æµ‹è¯•æ–¹æ³•"><a class="markdownIt-Anchor" href="#12-æ€§èƒ½æµ‹è¯•æ–¹æ³•"></a> 1.2. æ€§èƒ½æµ‹è¯•æ–¹æ³•</h3>
<ul>
<li>æ€§èƒ½æµ‹è¯•</li>
<li>è´Ÿè½½æµ‹è¯•</li>
<li>å‹åŠ›æµ‹è¯•</li>
<li>ç¨³å®šæ€§æµ‹è¯•</li>
</ul>
<h3 id="13-æ€§èƒ½æµ‹è¯•æŠ¥å‘Š"><a class="markdownIt-Anchor" href="#13-æ€§èƒ½æµ‹è¯•æŠ¥å‘Š"></a> 1.3. æ€§èƒ½æµ‹è¯•æŠ¥å‘Š</h3>
<p>æ€§èƒ½æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹ï¼š</p>
<div align="center">
<img src="https://upload-images.jianshu.io/upload_images/3101171-3d533a36f42608a1.png" />
</div>
<h3 id="14-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"><a class="markdownIt-Anchor" href="#14-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥"></a> 1.4. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h3>
<ol>
<li><strong>æ€§èƒ½åˆ†æ</strong> - å¦‚æœè¯·æ±‚å“åº”æ…¢ï¼Œå­˜åœ¨æ€§èƒ½é—®é¢˜ã€‚éœ€è¦å¯¹è¯·æ±‚ç»å†çš„å„ä¸ªç¯èŠ‚é€ä¸€åˆ†æï¼Œæ’æŸ¥å¯èƒ½å‡ºç°æ€§èƒ½ç“¶é¢ˆçš„åœ°æ–¹ï¼Œå®šä½é—®é¢˜ã€‚æ£€æŸ¥ç›‘æ§æ•°æ®ï¼Œåˆ†æå½±å“æ€§èƒ½çš„ä¸»è¦å› ç´ ï¼šå†…å­˜ã€ç£ç›˜ã€ç½‘ç»œã€CPUï¼Œå¯èƒ½æ˜¯ä»£ç æˆ–æ¶æ„è®¾è®¡ä¸åˆç†ï¼Œåˆæˆ–è€…æ˜¯ç³»ç»Ÿèµ„æºç¡®å®ä¸è¶³ã€‚</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong> - æ€§èƒ½ä¼˜åŒ–æ ¹æ®ç½‘ç«™åˆ†å±‚æ¶æ„ï¼Œå¤§è‡´å¯åˆ†ä¸ºå‰ç«¯æ€§èƒ½ä¼˜åŒ–ã€åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–ã€å­˜å‚¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–ã€‚</li>
</ol>
<h2 id="2-å‰ç«¯æ€§èƒ½ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#2-å‰ç«¯æ€§èƒ½ä¼˜åŒ–"></a> 2. å‰ç«¯æ€§èƒ½ä¼˜åŒ–</h2>
<h3 id="21-æµè§ˆå™¨è®¿é—®ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#21-æµè§ˆå™¨è®¿é—®ä¼˜åŒ–"></a> 2.1. æµè§ˆå™¨è®¿é—®ä¼˜åŒ–</h3>
<ol>
<li><strong>å‡å°‘ HTTP è¯·æ±‚</strong> - HTTP è¯·æ±‚éœ€è¦å»ºç«‹é€šä¿¡é“¾è·¯ï¼Œè¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œå¼€é”€é«˜æ˜‚ï¼Œæ‰€ä»¥å‡å°‘ HTTP è¯·æ±‚æ•°å¯ä»¥æœ‰æ•ˆæé«˜è®¿é—®æ€§èƒ½ã€‚å‡å°‘ HTTP çš„ä¸»è¦æ‰‹æ®µæ˜¯åˆå¹¶ Cssã€JavaScriptã€å›¾ç‰‡ã€‚</li>
<li><strong>ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜</strong> - å› ä¸ºé™æ€èµ„æºæ–‡ä»¶æ›´æ–°é¢‘ç‡ä½ï¼Œå¯ä»¥ç¼“å­˜æµè§ˆå™¨ä¸­ä»¥æé«˜æ€§èƒ½ã€‚è®¾ç½® HTTP å¤´ä¸­çš„ <code>Cache-Control</code> å’Œ <code>Expires</code> å±æ€§ï¼Œå¯è®¾å®šæµè§ˆå™¨ç¼“å­˜ã€‚</li>
<li><strong>å¯ç”¨å‹ç¼©</strong> - åœ¨æœåŠ¡å™¨ç«¯å‹ç¼©é™æ€èµ„æºæ–‡ä»¶ï¼Œåœ¨æµè§ˆå™¨ç«¯è§£å‹ç¼©ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘ä¼ è¾“çš„æ•°æ®é‡ã€‚ç”±äºæ–‡æœ¬æ–‡ä»¶å‹ç¼©ç‡å¯è¾¾ 80% ä»¥ä¸Šï¼Œæ‰€ä»¥å¯ä»¥å¯¹é™æ€èµ„æºï¼Œå¦‚ Htmlã€Cssã€JavaScrip è¿›è¡Œå‹ç¼©ã€‚</li>
<li><strong>CSS æ”¾åœ¨é¡µé¢æœ€ä¸Šé¢ï¼ŒJavaScript æ”¾åœ¨é¡µé¢æœ€ä¸‹é¢</strong> - æµè§ˆå™¨ä¼šåœ¨ä¸‹è½½å®Œå…¨éƒ¨çš„ Css åæ‰å¯¹æ•´ä¸ªé¡µé¢è¿›è¡Œæ¸²æŸ“ï¼Œæ‰€ä»¥æœ€å¥½çš„åšæ³•æ˜¯å°† Css æ”¾åœ¨é¡µé¢æœ€ä¸Šé¢ï¼Œè®©æµè§ˆå™¨å°½å¿«ä¸‹è½½ Cssï¼›JavaScript åˆ™ç›¸åï¼Œæµè§ˆå™¨åŠ è½½ JavaScript åç«‹å³æ‰§è¡Œï¼Œå¯èƒ½ä¼šé˜»å¡æ•´ä¸ªé¡µé¢ï¼Œé€ æˆé¡µé¢æ˜¾ç¤ºç¼“æ…¢ï¼Œå› æ­¤ JavaScript æœ€å¥½æ”¾åœ¨é¡µé¢æœ€ä¸‹é¢ã€‚</li>
<li><strong>å‡å°‘ Cookie ä¼ è¾“</strong> - Cookie åŒ…å«åœ¨ HTTP æ¯æ¬¡çš„è¯·æ±‚å’Œå“åº”ä¸­ï¼Œå¤ªå¤§çš„ Cookie ä¼šä¸¥é‡å½±å“æ•°æ®ä¼ è¾“ã€‚</li>
</ol>
<h3 id="22-cdn"><a class="markdownIt-Anchor" href="#22-cdn"></a> 2.2. CDN</h3>
<p>CDN ä¸€èˆ¬ç¼“å­˜çš„æ˜¯é™æ€èµ„æºã€‚</p>
<p>CDN çš„æœ¬è´¨ä»ç„¶æ˜¯ä¸€ä¸ªç¼“å­˜ï¼Œè€Œä¸”å°†æ•°æ®ç¼“å­˜åœ¨ç¦»ç”¨æˆ·æœ€è¿‘çš„åœ°æ–¹ï¼Œä½¿ç”¨æˆ·å·²æœ€å¿«é€Ÿåº¦è·å–æ•°æ®ï¼Œå³æ‰€è°“ç½‘ç»œè®¿é—®ç¬¬ä¸€è·³ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/cdn.png!zp" width="640" />
</div>
<h3 id="23-åå‘ä»£ç†"><a class="markdownIt-Anchor" href="#23-åå‘ä»£ç†"></a> 2.3. åå‘ä»£ç†</h3>
<p>ä¼ ç»Ÿä»£ç†æœåŠ¡å™¨ä½äºæµè§ˆå™¨ä¸€ä¾§ï¼Œä»£ç†æµè§ˆå™¨å°† HTTP è¯·æ±‚å‘é€åˆ°äº’è”ç½‘ä¸Šï¼Œè€Œåå‘ä»£ç†æœåŠ¡å™¨ä½äºç½‘ç«™æœºæˆ¿ä¸€ä¾§ï¼Œä»£ç†ç½‘ç«™æœåŠ¡å™¨æ¥æ”¶ HTTP è¯·æ±‚ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/java/javaweb/architecture/reverse-proxy.jpg!zp" width="640" />
</div>
<p>åå‘ä»£ç†æœåŠ¡å™¨å¯ä»¥é…ç½®ç¼“å­˜åŠŸèƒ½åŠ é€Ÿ Web è¯·æ±‚ï¼Œå½“ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®é™æ€å†…å®¹æ—¶ï¼Œé™æ€å†…å®¹å°±ä¼šè¢«ç¼“å­˜åœ¨åå‘ä»£ç†æœåŠ¡å™¨ä¸Šã€‚</p>
<p>åå‘ä»£ç†è¿˜å¯ä»¥å®ç°è´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æ„å»ºçš„é›†ç¾¤å¯ä»¥æé«˜ç³»ç»Ÿæ€»ä½“å¤„ç†èƒ½åŠ›ã€‚</p>
<p>å› ä¸ºæ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»å…ˆç»è¿‡åå‘ä»£ç†æœåŠ¡å™¨ï¼Œæ‰€ä»¥å¯ä»¥å±è”½ä¸€äº›æ”»å‡» IPï¼Œè¾¾åˆ°ä¿æŠ¤ç½‘ç«™å®‰å…¨çš„ä½œç”¨ã€‚</p>
<h2 id="3-åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#3-åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–"></a> 3. åº”ç”¨æœåŠ¡æ€§èƒ½ä¼˜åŒ–</h2>
<h3 id="31-åˆ†å¸ƒå¼ç¼“å­˜"><a class="markdownIt-Anchor" href="#31-åˆ†å¸ƒå¼ç¼“å­˜"></a> 3.1. åˆ†å¸ƒå¼ç¼“å­˜</h3>
<blockquote>
<p>ç½‘ç«™æ€§èƒ½ä¼˜åŒ–ç¬¬ä¸€å®šå¾‹ï¼šä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ç¼“å­˜ä¼˜åŒ–æ€§èƒ½ã€‚</p>
</blockquote>
<h4 id="311-ç¼“å­˜åŸç†"><a class="markdownIt-Anchor" href="#311-ç¼“å­˜åŸç†"></a> 3.1.1. ç¼“å­˜åŸç†</h4>
<p>ç¼“å­˜æŒ‡å°†æ•°æ®å­˜å‚¨åœ¨ç›¸å¯¹è¾ƒé«˜è®¿é—®é€Ÿåº¦çš„å­˜å‚¨ä»‹è´¨ä¸­ï¼Œä»¥ä¾›ç³»ç»Ÿå¤„ç†ã€‚ä¸€æ–¹é¢ç¼“å­˜è®¿é—®é€Ÿåº¦å¿«ï¼Œå¯ä»¥å‡å°‘æ•°æ®è®¿é—®çš„æ—¶é—´ï¼Œå¦ä¸€æ–¹é¢å¦‚æœç¼“å­˜çš„æ•°æ®æ˜¯ç»è¿‡è®¡ç®—å¤„ç†å¾—åˆ°çš„ï¼Œé‚£ä¹ˆè¢«ç¼“å­˜çš„æ•°æ®æ— éœ€é‡å¤è®¡ç®—å³å¯ç›´æ¥ä½¿ç”¨ï¼Œå› æ­¤ç¼“å­˜è¿˜èµ·åˆ°å‡å°‘è®¡ç®—æ—¶é—´çš„ä½œç”¨ã€‚</p>
<p>ç¼“å­˜çš„æœ¬è´¨æ˜¯ä¸€ä¸ªå†…å­˜ HASH è¡¨ã€‚</p>
<p>ç¼“å­˜ä¸»è¦ç”¨æ¥å­˜æ”¾é‚£äº›è¯»å†™æ¯”å¾ˆé«˜ã€å¾ˆå°‘å˜åŒ–çš„æ•°æ®ï¼Œå¦‚å•†å“çš„ç±»ç›®ä¿¡æ¯ï¼Œçƒ­é—¨è¯çš„æœç´¢åˆ—è¡¨ä¿¡æ¯ã€çƒ­é—¨å•†å“ä¿¡æ¯ç­‰ã€‚</p>
<h4 id="312-åˆç†ä½¿ç”¨ç¼“å­˜"><a class="markdownIt-Anchor" href="#312-åˆç†ä½¿ç”¨ç¼“å­˜"></a> 3.1.2. åˆç†ä½¿ç”¨ç¼“å­˜</h4>
<p>ç¼“å­˜æ•°æ®çš„é€‰æ‹©ï¼š</p>
<ul>
<li>ä¸è¦å­˜å‚¨é¢‘ç¹ä¿®æ”¹çš„æ•°æ®</li>
<li>ä¸è¦å­˜å‚¨éçƒ­ç‚¹æ•°æ®</li>
<li>æ•°æ®ä¸ä¸€è‡´ä¸è„è¯»ï¼šç¼“å­˜æœ‰æœ‰æ•ˆæœŸï¼Œæ‰€ä»¥å­˜åœ¨ä¸€å®šæ—¶é—´çš„æ•°æ®ä¸ä¸€è‡´å’Œè„è¯»é—®é¢˜ã€‚å¦‚æœä¸èƒ½æ¥å—ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ•°æ®æ›´æ–°ç«‹å³æ›´æ–°ç¼“å­˜ç­–ç•¥</li>
</ul>
<p>éœ€è¦è€ƒè™‘çš„ç¼“å­˜é—®é¢˜ï¼š</p>
<ul>
<li><strong>ç¼“å­˜é›ªå´©</strong> - å½“ç¼“å­˜æœåŠ¡å´©æºƒæ—¶ï¼Œæ•°æ®åº“ä¼šå› ä¸ºä¸èƒ½æ‰¿å—è¿‡å¤§çš„å‹åŠ›è€Œå®•æœºã€‚</li>
<li><strong>ç¼“å­˜é¢„çƒ­</strong> - å¯¹äºä¸€äº›æ˜ç¡®çš„çƒ­ç‚¹æ•°æ®ã€å…ƒæ•°æ®ï¼Œå¦‚åœ°åã€ç±»ç›®ä¿¡æ¯ç­‰ï¼Œå¯ä»¥åœ¨å¯åŠ¨æ—¶åŠ è½½åˆ°ç¼“å­˜è¿›è¡Œé¢„çƒ­ã€‚</li>
<li><strong>ç¼“å­˜ç©¿é€</strong> - å¦‚æœå› ä¸æ°å½“çš„ä¸šåŠ¡æˆ–æ¶æ„æ”»å‡»æŒç»­é«˜å¹¶å‘åœ°è¯·æ±‚æŸä¸ªä¸å­˜åœ¨çš„æ•°æ®ï¼Œç”±äºç¼“å­˜ä¸­æ²¡æœ‰è¯¥æ•°æ®ï¼Œå°±ä¼šå¯¼è‡´è¯·æ±‚éƒ½è½åœ¨æ•°æ®åº“ä¸Šï¼Œå¯¼è‡´æ•°æ®åº“æœ€ç»ˆå´©æºƒã€‚ä¸€ä¸ªç®€å•çš„ç­–ç•¥æ˜¯å°†ä¸å­˜åœ¨çš„æ•°æ®ä¹Ÿç¼“å­˜èµ·æ¥ï¼ˆå³ç¼“å­˜ null å€¼ï¼‰ã€‚</li>
</ul>
<h3 id="32-å¼‚æ­¥æ“ä½œ"><a class="markdownIt-Anchor" href="#32-å¼‚æ­¥æ“ä½œ"></a> 3.2. å¼‚æ­¥æ“ä½œ</h3>
<p>å¼‚æ­¥å¤„ç†ä¸ä»…å¯ä»¥å‡å°‘ç³»ç»ŸæœåŠ¡é—´çš„è€¦åˆåº¦ï¼Œæé«˜æ‰©å±•æ€§ï¼Œäº‹å®ä¸Šï¼Œå®ƒè¿˜å¯ä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚å¼‚æ­¥å¤„ç†å¯ä»¥æœ‰æ•ˆå‡å°‘å“åº”ç­‰å¾…æ—¶é—´ï¼Œä»è€Œæé«˜å“åº”é€Ÿåº¦ã€‚</p>
<p>å¼‚æ­¥å¤„ç†ä¸€èˆ¬æ˜¯é€šè¿‡åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼ã€‚</p>
<p>å¼‚æ­¥å¤„ç†å¯ä»¥è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>å¼‚æ­¥å¤„ç†</li>
<li>åº”ç”¨è§£è€¦</li>
<li>æµé‡å‰Šé”‹</li>
<li>æ—¥å¿—å¤„ç†</li>
<li>æ¶ˆæ¯é€šè®¯</li>
</ul>
<h3 id="33-ä½¿ç”¨é›†ç¾¤"><a class="markdownIt-Anchor" href="#33-ä½¿ç”¨é›†ç¾¤"></a> 3.3. ä½¿ç”¨é›†ç¾¤</h3>
<p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œä½¿ç”¨è´Ÿè½½å‡è¡¡æŠ€æœ¯ä¸ºä¸€ä¸ªåº”ç”¨æ„å»ºä¸€ä¸ªç”±å¤šå°æœåŠ¡å™¨ç»„æˆçš„æœåŠ¡å™¨é›†ç¾¤ï¼Œå°†å¹¶å‘è®¿é—®è¯·æ±‚åˆ†å‘åˆ°å¤šå°æœåŠ¡å™¨ä¸Šå¤„ç†ï¼Œé¿å…å•ä¸€æœåŠ¡å™¨å› è´Ÿè½½å‹åŠ›è¿‡å¤§è€Œå“åº”ç¼“æ…¢ï¼Œä½¿ç”¨æˆ·è¯·æ±‚å…·æœ‰æ›´å¥½çš„å“åº”å»¶è¿Ÿç‰¹æ€§ã€‚</p>
<h3 id="34-ä»£ç ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#34-ä»£ç ä¼˜åŒ–"></a> 3.4. ä»£ç ä¼˜åŒ–</h3>
<h4 id="341-å¤šçº¿ç¨‹"><a class="markdownIt-Anchor" href="#341-å¤šçº¿ç¨‹"></a> 3.4.1. å¤šçº¿ç¨‹</h4>
<p>ä»èµ„æºåˆ©ç”¨çš„è§’åº¦çœ‹ï¼Œä½¿ç”¨å¤šçº¿ç¨‹çš„åŸå› ä¸»è¦æœ‰ä¸¤ä¸ªï¼šIO é˜»å¡å’Œå¤š CPUã€‚</p>
<p>çº¿ç¨‹æ•°å¹¶éè¶Šå¤šè¶Šå¥½ï¼Œé‚£ä¹ˆå¯åŠ¨å¤šå°‘çº¿ç¨‹åˆé€‚å‘¢ï¼Ÿ</p>
<p>æœ‰ä¸ªå‚è€ƒå…¬å¼ï¼š</p>
<figure class="highlight fix"><table><tr><td class="code"><pre><span class="line"><span class="attr">å¯åŠ¨çº¿ç¨‹æ•° </span>=<span class="string"> (ä»»åŠ¡æ‰§è¡Œæ—¶é—´ / (ä»»åŠ¡æ‰§è¡Œæ—¶é—´ - IO ç­‰å¾…æ—¶é—´)) * CPU å†…æ ¸æ•°</span></span><br></pre></td></tr></table></figure>
<p>æœ€ä½³å¯åŠ¨çº¿ç¨‹æ•°å’Œ CPU å†…æ ¸æ•°æˆæ­£æ¯”ï¼Œå’Œ IO é˜»å¡æ—¶é—´æˆåæ¯”ã€‚</p>
<ul>
<li>å¦‚æœä»»åŠ¡éƒ½æ˜¯ CPU è®¡ç®—å‹ä»»åŠ¡ï¼Œé‚£ä¹ˆçº¿ç¨‹æ•°æœ€å¤šä¸è¦è¶…è¿‡ CPU å†…æ ¸æ•°ï¼Œå› ä¸ºå¯åŠ¨å†å¤šçº¿ç¨‹ï¼ŒCPU ä¹Ÿæ¥ä¸åŠè°ƒåº¦ï¼›</li>
<li>ç›¸åï¼Œå¦‚æœæ˜¯ä»»åŠ¡éœ€è¦ç­‰å¾…ç£ç›˜æ“ä½œï¼Œç½‘ç»œå“åº”ï¼Œé‚£ä¹ˆå¤šå¯åŠ¨çº¿ç¨‹æœ‰åŠ©äºä»»åŠ¡å¹¶ç½šèµŒï¼Œæé«˜ç³»ç»Ÿååé‡ã€‚</li>
</ul>
<h5 id="çº¿ç¨‹å®‰å…¨é—®é¢˜"><a class="markdownIt-Anchor" href="#çº¿ç¨‹å®‰å…¨é—®é¢˜"></a> çº¿ç¨‹å®‰å…¨é—®é¢˜</h5>
<p>çº¿ç¨‹å®‰å…¨é—®é¢˜æ—¶æŒ‡å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®æŸä¸ªèµ„æºï¼Œå¯¼è‡´æ•°æ®æ··ä¹±ã€‚</p>
<p>è§£å†³æ‰‹æ®µæœ‰ï¼š</p>
<ul>
<li><strong>å°†å¯¹è±¡è®¾è®¡ä¸ºæ— çŠ¶æ€å¯¹è±¡</strong> - å…¸å‹åº”ç”¨ï¼šServlet å°±æ˜¯æ— çŠ¶æ€å¯¹è±¡ï¼Œå¯ä»¥è¢«æœåŠ¡å™¨å¤šçº¿ç¨‹å¹¶å‘è°ƒç”¨å¤„ç†ç”¨æˆ·è¯·æ±‚ã€‚</li>
<li><strong>ä½¿ç”¨å±€éƒ¨å¯¹è±¡</strong></li>
<li><strong>å¹¶å‘è®¿é—®èµ„æºæ—¶ä½¿ç”¨é”</strong> - ä½†æ˜¯å¼•å…¥é”ä¼šäº§ç”Ÿæ€§èƒ½å¼€é”€ï¼Œåº”å°½é‡ä½¿ç”¨è½»é‡çº§çš„é”ã€‚</li>
</ul>
<h4 id="342-èµ„æºå¤ç”¨"><a class="markdownIt-Anchor" href="#342-èµ„æºå¤ç”¨"></a> 3.4.2. èµ„æºå¤ç”¨</h4>
<p>åº”è¯¥å°½é‡å‡å°‘é‚£äº›å¼€é”€å¾ˆå¤§çš„ç³»ç»Ÿèµ„æºçš„åˆ›å»ºå’Œé”€æ¯ï¼Œå¦‚æ•°æ®åº“è¿æ¥ã€ç½‘ç»œé€šä¿¡è¿æ¥ã€çº¿ç¨‹ã€å¤æ‚å¯¹è±¡ç­‰ã€‚ä»ç¼–ç¨‹è§’åº¦ï¼Œèµ„æºå¤ç”¨ä¸»è¦æœ‰ä¸¤ç§æ¨¡å¼ï¼šå•ä¾‹æ¨¡å¼å’Œå¯¹è±¡æ± ã€‚</p>
<h4 id="343-æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#343-æ•°æ®ç»“æ„"></a> 3.4.3. æ•°æ®ç»“æ„</h4>
<p>æ ¹æ®å…·ä½“åœºæ™¯ï¼Œé€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ã€‚</p>
<h4 id="344-åƒåœ¾å›æ”¶"><a class="markdownIt-Anchor" href="#344-åƒåœ¾å›æ”¶"></a> 3.4.4. åƒåœ¾å›æ”¶</h4>
<p>å¦‚æœ Web åº”ç”¨è¿è¡Œåœ¨ JVM ç­‰å…·æœ‰åƒåœ¾å›æ”¶åŠŸèƒ½çš„ç¯å¢ƒä¸­ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶å¯èƒ½ä¼šå¯¹ç³»ç»Ÿçš„æ€§èƒ½ç‰¹æ€§äº§ç”Ÿå·¨å¤§å½±å“ã€‚ç«‹å³åƒåœ¾å›æ”¶æœºåˆ¶æœ‰åŠ©äºç¨‹åºä¼˜åŒ–å’Œå‚æ•°è°ƒä¼˜ï¼Œä»¥åŠç¼–å†™å†…å­˜å®‰å…¨çš„ä»£ç ã€‚</p>
<h2 id="4-å­˜å‚¨æ€§èƒ½ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#4-å­˜å‚¨æ€§èƒ½ä¼˜åŒ–"></a> 4. å­˜å‚¨æ€§èƒ½ä¼˜åŒ–</h2>
<h3 id="41-æœºæ¢°é”®ç›˜å’Œå›ºæ€ç¡¬ç›˜"><a class="markdownIt-Anchor" href="#41-æœºæ¢°é”®ç›˜å’Œå›ºæ€ç¡¬ç›˜"></a> 4.1. æœºæ¢°é”®ç›˜å’Œå›ºæ€ç¡¬ç›˜</h3>
<p>è€ƒè™‘ä½¿ç”¨å›ºæ€ç¡¬ç›˜æ›¿ä»£æœºæ¢°é”®ç›˜ï¼Œå› ä¸ºå®ƒçš„è¯»å†™é€Ÿåº¦æ›´å¿«ã€‚</p>
<h3 id="42-bæ•°å’Œ-lsm-æ ‘"><a class="markdownIt-Anchor" href="#42-bæ•°å’Œ-lsm-æ ‘"></a> 4.2. B+æ•°å’Œ LSM æ ‘</h3>
<p>ä¼ ç»Ÿå…³ç³»æ•°æ®åº“çš„æ•°æ®åº“ç´¢å¼•ä¸€èˆ¬éƒ½ä½¿ç”¨ä¸¤çº§ç´¢å¼•çš„ <strong>B+ æ ‘</strong> ç»“æ„ï¼Œæ ‘çš„å±‚æ¬¡æœ€å¤šä¸‰å±‚ã€‚å› æ­¤å¯èƒ½éœ€è¦ 5 æ¬¡ç£ç›˜è®¿é—®æ‰èƒ½æ›´æ–°ä¸€æ¡è®°å½•ï¼ˆä¸‰æ¬¡ç£ç›˜è®¿é—®è·å¾—æ•°æ®ç´¢å¼•åŠè¡Œ IDï¼Œç„¶åå†è¿›è¡Œä¸€æ¬¡æ•°æ®æ–‡ä»¶è¯»æ“ä½œåŠä¸€æ¬¡æ•°æ®æ–‡ä»¶å†™æ“ä½œï¼‰ã€‚</p>
<p>ç”±äºç£ç›˜è®¿é—®æ˜¯éšæœºçš„ï¼Œä¼ ç»Ÿæœºæ¢°é”®ç›˜åœ¨æ•°æ®éšæœºè®¿é—®æ—¶æ€§èƒ½è¾ƒå·®ï¼Œæ¯æ¬¡æ•°æ®è®¿é—®éƒ½éœ€è¦å¤šæ¬¡è®¿é—®ç£ç›˜å½±å“æ•°æ®è®¿é—®æ€§èƒ½ã€‚</p>
<p>è®¸å¤š Nosql æ•°æ®åº“ä¸­çš„ç´¢å¼•é‡‡ç”¨ <strong>LSM æ ‘</strong> ä½œä¸ºä¸»è¦æ•°æ®ç»“æ„ã€‚LSM æ ‘å¯è§†ä¸ºä¸€ä¸ª N é˜¶åˆå¹¶æ ‘ã€‚æ•°æ®å†™æ“ä½œéƒ½åœ¨å†…å­˜ä¸­è¿›è¡Œã€‚åœ¨ <strong>LSM æ ‘ä¸Šè¿›è¡Œä¸€æ¬¡æ•°æ®æ›´æ–°ä¸éœ€è¦ç£ç›˜è®¿é—®ï¼Œé€Ÿåº¦è¿œå¿«äº B+ æ ‘</strong>ã€‚</p>
<h3 id="43-raid-å’Œ-hdfs"><a class="markdownIt-Anchor" href="#43-raid-å’Œ-hdfs"></a> 4.3. RAID å’Œ HDFS</h3>
<p>RAID æ˜¯ Redundant Array of Independent Disks çš„ç¼©å†™ï¼Œä¸­æ–‡ç®€ç§°ä¸ºç‹¬ç«‹å†—ä½™ç£ç›˜é˜µåˆ—ã€‚</p>
<p>RAID æ˜¯ä¸€ç§æŠŠå¤šå—ç‹¬ç«‹çš„ç¡¬ç›˜ï¼ˆç‰©ç†ç¡¬ç›˜ï¼‰æŒ‰ä¸åŒçš„æ–¹å¼ç»„åˆèµ·æ¥å½¢æˆä¸€ä¸ªç¡¬ç›˜ç»„ï¼ˆé€»è¾‘ç¡¬ç›˜ï¼‰ï¼Œä»è€Œæä¾›æ¯”å•ä¸ªç¡¬ç›˜æ›´é«˜çš„å­˜å‚¨æ€§èƒ½å’Œæä¾›æ•°æ®å¤‡ä»½æŠ€æœ¯ã€‚</p>
<p>HDFS(åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ) æ›´è¢«å¤§å‹ç½‘ç«™æ‰€é’çã€‚å®ƒå¯ä»¥é…åˆ <code>MapReduce</code> å¹¶å‘è®¡ç®—ä»»åŠ¡æ¡†æ¶è¿›è¡Œå¤§æ•°æ®å¤„ç†ï¼Œå¯ä»¥åœ¨æ•´ä¸ªé›†ç¾¤ä¸Šå¹¶å‘è®¿é—®æ‰€æœ‰ç£ç›˜ï¼Œæ— éœ€ RAID æ”¯æŒã€‚</p>
<p>HDFS å¯¹æ•°æ®å­˜å‚¨ç©ºé—´çš„ç®¡ç†ä»¥æ•°æ®å—ï¼ˆBlockï¼‰ä¸ºå•ä½ï¼Œé»˜è®¤ä¸º 64 MBã€‚æ‰€ä»¥ï¼ŒHDFS æ›´é€‚åˆå­˜å‚¨è¾ƒå¤§çš„æ–‡ä»¶ã€‚</p>
<h2 id="5-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#5-å‚è€ƒèµ„æ–™"></a> 5. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æ</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>æ¶æ„</tag>
        <tag>æ€§èƒ½</tag>
      </tags>
  </entry>
  <entry>
    <title>ç³»ç»Ÿæ¶æ„æ¦‚è¿°</title>
    <url>/blog/design/architecture/system-architecture-overview/</url>
    <content><![CDATA[<h1 id="ç³»ç»Ÿæ¶æ„æ¦‚è¿°"><a class="markdownIt-Anchor" href="#ç³»ç»Ÿæ¶æ„æ¦‚è¿°"></a> ç³»ç»Ÿæ¶æ„æ¦‚è¿°</h1>
<blockquote>
<p><strong>æ¶æ„</strong> çš„ä¸€ç§é€šä¿—è¯´æ³•æ˜¯ï¼š<strong>æœ€é«˜å±‚æ¬¡çš„è§„åˆ’ï¼Œéš¾ä»¥æ”¹å˜çš„å†³å®šã€‚</strong></p>
<p><strong>è½¯ä»¶æ¶æ„</strong>æ˜¯æœ‰å…³è½¯ä»¶æ•´ä½“ç»“æ„ä¸ç»„ä»¶çš„æŠ½è±¡æè¿°ï¼Œç”¨äºæŒ‡å¯¼å¤§å‹è½¯ä»¶ç³»ç»Ÿå„ä¸ªæ–¹é¢çš„è®¾è®¡ã€‚ â€”â€”ç»´åŸºç™¾ç§‘</p>
</blockquote>
<h2 id="1-å¤§å‹ç³»ç»Ÿæ¶æ„çš„é—®é¢˜å’Œç›®æ ‡"><a class="markdownIt-Anchor" href="#1-å¤§å‹ç³»ç»Ÿæ¶æ„çš„é—®é¢˜å’Œç›®æ ‡"></a> 1. å¤§å‹ç³»ç»Ÿæ¶æ„çš„é—®é¢˜å’Œç›®æ ‡</h2>
<p>å¤§å‹ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜ï¼š</p>
<ul>
<li>ç”¨æˆ·ä½“é‡å¤§ä¸”åˆ†å¸ƒå¹¿æ³›</li>
<li>æµ·é‡æ•°æ®</li>
<li>é«˜å¹¶å‘ã€é«˜åå</li>
<li>ç½‘ç»œç¯å¢ƒå¤æ‚</li>
<li>å®‰å…¨ç¯å¢ƒæ¶åŠ£ï¼Œæ˜“å—ç½‘ç»œæ”»å‡»</li>
<li>äº§å“éœ€è¦å¿«é€Ÿè¿­ä»£</li>
<li>ä»å°åˆ°å¤§ï¼Œæ¸è¿›å‘å±•</li>
<li>ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒ</li>
<li>å…è´¹æœåŠ¡ï¼Œä»˜è´¹ä½“éªŒ</li>
</ul>
<p>å¤§å‹ç³»ç»Ÿæ¶æ„çš„ç›®æ ‡ï¼š</p>
<ul>
<li><strong>é«˜æ€§èƒ½</strong> - é«˜å¹¶å‘ã€é«˜ååï¼Œä»¥åº”å¯¹å¤§é‡çš„ç”¨æˆ·è®¿é—®ä»¥åŠå¤„ç†æµ·é‡çš„æ•°æ®ã€‚</li>
<li><strong>é«˜å¯ç”¨</strong> - æä¾›ç¨³å®šå¯é çš„æœåŠ¡ã€‚ä¸€èˆ¬é€šè¿‡å¤‡ä»½ã€åˆ†å¸ƒå¼ç­‰æ‰‹æ®µæ¥æå‡ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li>
<li><strong>æ˜“ä¼¸ç¼©</strong> - é€šè¿‡å¢/å‡æœåŠ¡å™¨èŠ‚ç‚¹æ•°ï¼Œæ¥çµæ´»çš„æé«˜/é™ä½ç³»ç»Ÿå¤„ç†èƒ½åŠ›ã€‚</li>
<li><strong>æ˜“æ‰©å±•</strong> - æ¶æ„ä¸Šè€¦åˆåº¦ä½ï¼Œæ˜“äºåœ¨ä¸å½±å“ç°æœ‰åŠŸèƒ½çš„åŸºç¡€ä¸Šæ”¯æ’‘ä¸šåŠ¡å¿«é€Ÿå‘å±•ã€‚</li>
<li><strong>å®‰å…¨æ€§</strong> - é€šè¿‡ä¿¡æ¯åŠ å¯†ï¼Œè®¤è¯ã€æƒé™ç®¡ç†ï¼Œé£é™©æ§åˆ¶ç­‰é˜²æŠ¤æ€§æ‰‹æ®µï¼Œä¸ºç³»ç»Ÿä¿é©¾æŠ¤èˆªã€‚</li>
<li><strong>æ˜“ç»´æŠ¤</strong> - åˆ©ç”¨æŒç»­é›†æˆã€æŒç»­éƒ¨ç½²ç­‰è‡ªåŠ¨åŒ–æ‰‹æ®µï¼Œä½¿å¾—ç³»ç»Ÿå¯ä»¥å¿«é€Ÿè¿­ä»£ï¼ˆæ„å»ºã€éƒ¨ç½²ã€è¿ç»´ï¼‰ï¼Œç¼©å‡ç³»ç»Ÿç»´æŠ¤éš¾åº¦å’Œæˆæœ¬ã€‚</li>
</ul>
<h2 id="2-å¤§å‹è½¯ä»¶æ¶æ„æ¼”åŒ–"><a class="markdownIt-Anchor" href="#2-å¤§å‹è½¯ä»¶æ¶æ„æ¼”åŒ–"></a> 2. å¤§å‹è½¯ä»¶æ¶æ„æ¼”åŒ–</h2>
<p>å¤§å‹è½¯ä»¶æ¶æ„æ¼”åŒ–æ¯”è¾ƒå…·æœ‰ä»£è¡¨æ€§çš„å°±æ˜¯å¤§å‹ç½‘ç«™çš„æ¼”åŒ–è¿‡ç¨‹ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸‹å¤§å‹ç½‘ç«™æ¼”åŒ–çš„ä¸€èˆ¬è§„å¾‹ã€‚</p>
<h3 id="21-åˆå§‹é˜¶æ®µæ¶æ„"><a class="markdownIt-Anchor" href="#21-åˆå§‹é˜¶æ®µæ¶æ„"></a> 2.1. åˆå§‹é˜¶æ®µæ¶æ„</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šç½‘ç«™è¿è¥åˆæœŸï¼Œè®¿é—®ç”¨æˆ·å°‘ï¼Œä¸€å°æœåŠ¡å™¨ç»°ç»°æœ‰ä½™ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>åº”ç”¨ç¨‹åºã€æ•°æ®åº“ã€æ–‡ä»¶ç­‰æ‰€æœ‰çš„èµ„æºéƒ½åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šé€šå¸¸æœåŠ¡å™¨æ“ä½œç³»ç»Ÿä½¿ç”¨ linuxï¼Œåº”ç”¨ç¨‹åºä½¿ç”¨ PHP å¼€å‘ï¼Œç„¶åéƒ¨ç½²åœ¨ Apache ä¸Šï¼Œæ•°æ®åº“ä½¿ç”¨ Mysqlï¼Œé€šä¿—ç§°ä¸º LAMPã€‚æ±‡é›†å„ç§å…è´¹å¼€æºè½¯ä»¶ä»¥åŠä¸€å°å»‰ä»·æœåŠ¡å™¨å°±å¯ä»¥å¼€å§‹ç³»ç»Ÿçš„å‘å±•ä¹‹è·¯äº†ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-åˆå§‹é˜¶æ®µæ¶æ„.jpg!zp" width="400"/>
</div>
<h3 id="22-åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»"><a class="markdownIt-Anchor" href="#22-åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»"></a> 2.2. åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦»</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šè¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·è®¿é—®å¯¼è‡´æ€§èƒ½è¶Šæ¥è¶Šå·®ï¼Œè¶Šæ¥è¶Šå¤šçš„æ•°æ®å¯¼è‡´å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œä¸€å°æœåŠ¡å™¨å·²ä¸è¶³ä»¥æ”¯æ’‘ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>åº”ç”¨æœåŠ¡å™¨ã€æ•°æ®åº“æœåŠ¡å™¨ã€æ–‡ä»¶æœåŠ¡å™¨åˆ†åˆ«ç‹¬ç«‹éƒ¨ç½²ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šä¸‰å°æœåŠ¡å™¨å¯¹æ€§èƒ½è¦æ±‚å„ä¸ç›¸åŒï¼š
<ul>
<li>åº”ç”¨æœåŠ¡å™¨è¦å¤„ç†å¤§é‡ä¸šåŠ¡é€»è¾‘ï¼Œå› æ­¤éœ€è¦æ›´å¿«æ›´å¼ºå¤§çš„ CPUï¼›</li>
<li>æ•°æ®åº“æœåŠ¡å™¨éœ€è¦å¿«é€Ÿç£ç›˜æ£€ç´¢å’Œæ•°æ®ç¼“å­˜ï¼Œå› æ­¤éœ€è¦æ›´å¿«çš„ç¡¬ç›˜å’Œæ›´å¤§çš„å†…å­˜ï¼›</li>
<li>æ–‡ä»¶æœåŠ¡å™¨éœ€è¦å­˜å‚¨å¤§é‡æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦æ›´å¤§å®¹é‡çš„ç¡¬ç›˜ã€‚</li>
</ul>
</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-åº”ç”¨æœåŠ¡å’Œæ•°æ®æœåŠ¡åˆ†ç¦».jpg!zp" width="450"/>
</div>
<h3 id="23-ä½¿ç”¨ç¼“å­˜æ”¹å–„æ€§èƒ½"><a class="markdownIt-Anchor" href="#23-ä½¿ç”¨ç¼“å­˜æ”¹å–„æ€§èƒ½"></a> 2.3. ä½¿ç”¨ç¼“å­˜æ”¹å–„æ€§èƒ½</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šéšç€ç”¨æˆ·é€æ¸å¢å¤šï¼Œæ•°æ®åº“å‹åŠ›å¤ªå¤§å¯¼è‡´è®¿é—®å»¶è¿Ÿã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼šç”±äºç½‘ç«™è®¿é—®å’Œè´¢å¯Œåˆ†é…ä¸€æ ·éµå¾ªäºŒå…«å®šå¾‹ï¼š<em>80% çš„ä¸šåŠ¡è®¿é—®é›†ä¸­åœ¨ 20% çš„æ•°æ®ä¸Š</em>ã€‚<strong>å°†æ•°æ®åº“ä¸­è®¿é—®è¾ƒé›†ä¸­çš„å°‘éƒ¨åˆ†æ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥å‡å°‘æ•°æ®åº“çš„è®¿é—®æ¬¡æ•°ï¼Œé™ä½æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šç¼“å­˜åˆ†ä¸ºä¸¤ç§ï¼šåº”ç”¨æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨ä¸Šçš„è¿œç¨‹ç¼“å­˜ã€‚
<ul>
<li>æœ¬åœ°ç¼“å­˜è®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œä½†ç¼“å­˜æ•°æ®é‡æœ‰é™ï¼ŒåŒæ—¶å­˜åœ¨ä¸åº”ç”¨ç¨‹åºäº‰ç”¨å†…å­˜çš„æƒ…å†µã€‚</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜å¯ä»¥é‡‡ç”¨é›†ç¾¤æ–¹å¼ï¼Œç†è®ºä¸Šå¯ä»¥åšåˆ°ä¸å—å†…å­˜å®¹é‡é™åˆ¶çš„ç¼“å­˜æœåŠ¡ã€‚</li>
</ul>
</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-ä½¿ç”¨ç¼“å­˜æ”¹å–„æ€§èƒ½.jpg!zp" width="450"/>
</div>
<h3 id="24-ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„å¹¶å‘å¤„ç†èƒ½åŠ›"><a class="markdownIt-Anchor" href="#24-ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„å¹¶å‘å¤„ç†èƒ½åŠ›"></a> 2.4. ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤æ”¹å–„å¹¶å‘å¤„ç†èƒ½åŠ›</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šä½¿ç”¨ç¼“å­˜åï¼Œæ•°æ®åº“è®¿é—®å‹åŠ›å¾—åˆ°æœ‰æ•ˆç¼“è§£ã€‚ä½†æ˜¯å•ä¸€åº”ç”¨æœåŠ¡å™¨èƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚è¿æ¥æœ‰é™ï¼Œåœ¨è®¿é—®é«˜å³°æœŸï¼Œæˆä¸ºç“¶é¢ˆã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>å¤šå°æœåŠ¡å™¨é€šè¿‡è´Ÿè½½å‡è¡¡åŒæ—¶å‘å¤–éƒ¨æä¾›æœåŠ¡ï¼Œè§£å†³å•ä¸€æœåŠ¡å™¨å¤„ç†èƒ½åŠ›å’Œå­˜å‚¨ç©ºé—´ä¸è¶³çš„é—®é¢˜ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šä½¿ç”¨é›†ç¾¤æ˜¯ç³»ç»Ÿè§£å†³é«˜å¹¶å‘ã€æµ·é‡æ•°æ®é—®é¢˜çš„å¸¸ç”¨æ‰‹æ®µã€‚é€šè¿‡å‘é›†ç¾¤ä¸­è¿½åŠ èµ„æºï¼Œæå‡ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œä½¿å¾—æœåŠ¡å™¨çš„è´Ÿè½½å‹åŠ›ä¸å†æˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-ä½¿ç”¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤.jpg!zp" width="500"/>
</div>
<h3 id="25-æ•°æ®åº“è¯»å†™åˆ†ç¦»"><a class="markdownIt-Anchor" href="#25-æ•°æ®åº“è¯»å†™åˆ†ç¦»"></a> 2.5. æ•°æ®åº“è¯»å†™åˆ†ç¦»</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šç½‘ç«™ä½¿ç”¨ç¼“å­˜åï¼Œä½¿ç»å¤§éƒ¨åˆ†æ•°æ®è¯»æ“ä½œè®¿é—®éƒ½å¯ä»¥ä¸é€šè¿‡æ•°æ®åº“å°±èƒ½å®Œæˆï¼Œä½†æ˜¯ä»æœ‰ä¸€éƒ¨åˆ†è¯»æ“ä½œå’Œå…¨éƒ¨çš„å†™æ“ä½œéœ€è¦è®¿é—®æ•°æ®åº“ï¼Œåœ¨ç½‘ç«™çš„ç”¨æˆ·è¾¾åˆ°ä¸€å®šè§„æ¨¡åï¼Œæ•°æ®åº“å› ä¸ºè´Ÿè½½å‹åŠ›è¿‡é«˜è€Œæˆä¸ºç½‘ç«™çš„ç“¶é¢ˆã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼šç›®å‰å¤§éƒ¨åˆ†çš„ä¸»æµæ•°æ®åº“éƒ½æä¾›ä¸»ä»çƒ­å¤‡åŠŸèƒ½ï¼Œé€šè¿‡é…ç½®ä¸¤å°æ•°æ®åº“ä¸»ä»å…³ç³»ï¼Œå¯ä»¥å°†ä¸€å°æ•°æ®åº“æœåŠ¡å™¨çš„æ•°æ®æ›´æ–°åŒæ­¥åˆ°ä¸€å°æœåŠ¡å™¨ä¸Šã€‚<strong>ç½‘ç«™åˆ©ç”¨æ•°æ®åº“çš„ä¸»ä»çƒ­å¤‡åŠŸèƒ½ï¼Œå®ç°æ•°æ®åº“è¯»å†™åˆ†ç¦»ï¼Œä»è€Œæ”¹å–„æ•°æ®åº“è´Ÿè½½å‹åŠ›ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šåº”ç”¨æœåŠ¡å™¨åœ¨å†™æ“ä½œçš„æ—¶å€™ï¼Œè®¿é—®ä¸»æ•°æ®åº“ï¼Œä¸»æ•°æ®åº“é€šè¿‡ä¸»ä»å¤åˆ¶æœºåˆ¶å°†æ•°æ®æ›´æ–°åŒæ­¥åˆ°ä»æ•°æ®åº“ã€‚è¿™æ ·å½“åº”ç”¨æœåŠ¡å™¨åœ¨è¯»æ“ä½œçš„æ—¶å€™ï¼Œè®¿é—®ä»æ•°æ®åº“è·å¾—æ•°æ®ã€‚ä¸ºäº†ä¾¿äºåº”ç”¨ç¨‹åºè®¿é—®è¯»å†™åˆ†ç¦»åçš„æ•°æ®åº“ï¼Œé€šå¸¸åœ¨åº”ç”¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ä¸“é—¨çš„æ•°æ®è®¿é—®æ¨¡å—ï¼Œä½¿æ•°æ®åº“è¯»å†™åˆ†ç¦»çš„å¯¹åº”ç”¨é€æ˜ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-æ•°æ®åº“è¯»å†™åˆ†ç¦».jpg!zp" width="500"/>
</div>
<h3 id="26-åå‘ä»£ç†å’Œ-cdn-åŠ é€Ÿ"><a class="markdownIt-Anchor" href="#26-åå‘ä»£ç†å’Œ-cdn-åŠ é€Ÿ"></a> 2.6. åå‘ä»£ç†å’Œ CDN åŠ é€Ÿ</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šä¸­å›½ç½‘ç»œç¯å¢ƒå¤æ‚ï¼Œä¸åŒåœ°åŒºçš„ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶ï¼Œé€Ÿåº¦å·®åˆ«ä¹Ÿæå¤§ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>é‡‡ç”¨ CDN å’Œåå‘ä»£ç†åŠ å¿«ç³»ç»Ÿçš„é™æ€èµ„æºè®¿é—®é€Ÿåº¦ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šCDN å’Œåå‘ä»£ç†çš„åŸºæœ¬åŸç†éƒ½æ˜¯ç¼“å­˜ï¼ŒåŒºåˆ«åœ¨äºï¼š
<ul>
<li>CDN éƒ¨ç½²åœ¨ç½‘ç»œæä¾›å•†çš„æœºæˆ¿ï¼Œä½¿ç”¨æˆ·åœ¨è¯·æ±‚ç½‘ç«™æœåŠ¡æ—¶ï¼Œå¯ä»¥ä»è·ç¦»è‡ªå·±æœ€è¿‘çš„ç½‘ç»œæä¾›å•†æœºæˆ¿è·å–æ•°æ®ï¼›</li>
<li>è€Œåå‘ä»£ç†åˆ™éƒ¨ç½²åœ¨ç½‘ç«™çš„ä¸­å¿ƒæœºæˆ¿ï¼Œå½“ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ä¸­å¿ƒæœºæˆ¿åï¼Œé¦–å…ˆè®¿é—®çš„æœåŠ¡å™¨æ—¶åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¦‚æœåå‘ä»£ç†æœåŠ¡å™¨ä¸­ç¼“å­˜ç€ç”¨æˆ·è¯·æ±‚çš„èµ„æºï¼Œå°±å°†å…¶ç›´æ¥è¿”å›ç»™ç”¨æˆ·ã€‚</li>
</ul>
</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-åå‘ä»£ç†å’ŒCDNåŠ é€Ÿ.jpg!zp" width="500"/>
</div>
<h3 id="27-åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“"><a class="markdownIt-Anchor" href="#27-åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“"></a> 2.7. åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šéšç€å¤§å‹ç½‘ç«™ä¸šåŠ¡æŒç»­å¢é•¿ï¼Œæ•°æ®åº“ç»è¿‡è¯»å†™åˆ†ç¦»ï¼Œä»ä¸€å°æœåŠ¡å™¨æ‹†åˆ†ä¸ºä¸¤å°æœåŠ¡å™¨ï¼Œä¾ç„¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>æ•°æ®åº“é‡‡ç”¨åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæ–‡ä»¶ç³»ç»Ÿé‡‡ç”¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šåˆ†å¸ƒå¼æ•°æ®åº“æ˜¯æ•°æ®åº“æ‹†åˆ†çš„æœ€åæ–¹æ³•ï¼Œåªæœ‰åœ¨å•è¡¨æ•°æ®è§„æ¨¡éå¸¸åºå¤§çš„æ—¶å€™æ‰ä½¿ç”¨ã€‚ä¸åˆ°ä¸å¾—å·²æ—¶ï¼Œæ›´å¸¸ç”¨çš„æ•°æ®åº“æ‹†åˆ†æ‰‹æ®µæ˜¯ä¸šåŠ¡åˆ†åº“ï¼Œå°†ä¸åŒçš„ä¸šåŠ¡æ•°æ®åº“éƒ¨ç½²åœ¨ä¸åŒçš„ç‰©ç†æœåŠ¡å™¨ä¸Šã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå’Œåˆ†å¸ƒå¼æ•°æ®åº“.jpg!zp" />
</div>
<h3 id="28-ä½¿ç”¨-nosql-å’Œæœç´¢å¼•æ“"><a class="markdownIt-Anchor" href="#28-ä½¿ç”¨-nosql-å’Œæœç´¢å¼•æ“"></a> 2.8. ä½¿ç”¨ NoSQL å’Œæœç´¢å¼•æ“</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šéšç€ç½‘ç«™ä¸šåŠ¡è¶Šæ¥è¶Šå¤æ‚ï¼Œå¯¹æ•°æ®å­˜å‚¨å’Œæ£€ç´¢çš„éœ€æ±‚ä¹Ÿè¶Šæ¥è¶Šå¤æ‚ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>ç³»ç»Ÿå¼•å…¥ NoSQL æ•°æ®åº“åŠæœç´¢å¼•æ“ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šNoSQL æ•°æ®åº“åŠæœç´¢å¼•æ“å¯¹å¯ä¼¸ç¼©çš„åˆ†å¸ƒå¼ç‰¹æ€§å…·æœ‰æ›´å¥½çš„æ”¯æŒã€‚åº”ç”¨æœåŠ¡å™¨é€šè¿‡ç»Ÿä¸€æ•°æ®è®¿é—®æ¨¡å—è®¿é—®å„ç§æ•°æ®ï¼Œå‡è½»åº”ç”¨ç¨‹åºç®¡ç†è¯¸å¤šæ•°æ®æºçš„éº»çƒ¦ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-ä½¿ç”¨NoSQLå’Œæœç´¢å¼•æ“.jpg!zp" />
</div>
<h3 id="29-ä¸šåŠ¡æ‹†åˆ†"><a class="markdownIt-Anchor" href="#29-ä¸šåŠ¡æ‹†åˆ†"></a> 2.9. ä¸šåŠ¡æ‹†åˆ†</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šå¤§å‹ç½‘ç«™çš„ä¸šåŠ¡åœºæ™¯æ—¥ç›Šå¤æ‚ï¼Œåˆ†ä¸ºå¤šä¸ªäº§å“çº¿ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼šé‡‡ç”¨åˆ†è€Œæ²»ä¹‹çš„æ‰‹æ®µå°†æ•´ä¸ªç½‘ç«™ä¸šåŠ¡åˆ†æˆä¸åŒçš„äº§å“çº¿ã€‚<strong>ç³»ç»Ÿä¸ŠæŒ‰ç…§ä¸šåŠ¡è¿›è¡Œæ‹†åˆ†æ”¹é€ ï¼Œåº”ç”¨æœåŠ¡å™¨æŒ‰ç…§ä¸šåŠ¡åŒºåˆ†è¿›è¡Œåˆ†åˆ«éƒ¨ç½²ã€‚</strong></li>
<li><strong>æè¿°</strong>ï¼šåº”ç”¨ä¹‹é—´å¯ä»¥é€šè¿‡è¶…é“¾æ¥å»ºç«‹å…³ç³»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œæ•°æ®åˆ†å‘ï¼Œå½“ç„¶æ›´å¤šçš„è¿˜æ˜¯é€šè¿‡è®¿é—®åŒä¸€ä¸ªæ•°æ®å­˜å‚¨ç³»ç»Ÿæ¥æ„æˆä¸€ä¸ªå…³è”çš„å®Œæ•´ç³»ç»Ÿã€‚
<ul>
<li><strong>çºµå‘æ‹†åˆ†</strong>ï¼š<strong>å°†ä¸€ä¸ªå¤§åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªå°åº”ç”¨</strong>ï¼Œå¦‚æœæ–°ä¸šåŠ¡è¾ƒä¸ºç‹¬ç«‹ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†å…¶è®¾è®¡éƒ¨ç½²ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ Web åº”ç”¨ç³»ç»Ÿã€‚çºµå‘æ‹†åˆ†ç›¸å¯¹è¾ƒä¸ºç®€å•ï¼Œé€šè¿‡æ¢³ç†ä¸šåŠ¡ï¼Œå°†è¾ƒå°‘ç›¸å…³çš„ä¸šåŠ¡å‰¥ç¦»å³å¯ã€‚</li>
<li><strong>æ¨ªå‘æ‹†åˆ†</strong>ï¼š<strong>å°†å¤ç”¨çš„ä¸šåŠ¡æ‹†åˆ†å‡ºæ¥ï¼Œç‹¬ç«‹éƒ¨ç½²ä¸ºåˆ†å¸ƒå¼æœåŠ¡</strong>ï¼Œæ–°å¢ä¸šåŠ¡åªéœ€è¦è°ƒç”¨è¿™äº›åˆ†å¸ƒå¼æœåŠ¡æ¨ªå‘æ‹†åˆ†éœ€è¦è¯†åˆ«å¯å¤ç”¨çš„ä¸šåŠ¡ï¼Œè®¾è®¡æœåŠ¡æ¥å£ï¼Œè§„èŒƒæœåŠ¡ä¾èµ–å…³ç³»ã€‚</li>
</ul>
</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-ä¸šåŠ¡æ‹†åˆ†.jpg!zp" />
</div>
<h3 id="210-åˆ†å¸ƒå¼æœåŠ¡"><a class="markdownIt-Anchor" href="#210-åˆ†å¸ƒå¼æœåŠ¡"></a> 2.10. åˆ†å¸ƒå¼æœåŠ¡</h3>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šéšç€ä¸šåŠ¡è¶Šæ‹†è¶Šå°ï¼Œå­˜å‚¨ç³»ç»Ÿè¶Šæ¥è¶Šåºå¤§ï¼Œåº”ç”¨ç³»ç»Ÿæ•´ä½“å¤æ‚ç¨‹åº¦å‘ˆæŒ‡æ•°çº§ä¸Šå‡ï¼Œéƒ¨ç½²ç»´æŠ¤è¶Šæ¥è¶Šå›°éš¾ã€‚ç”±äºæ‰€æœ‰åº”ç”¨è¦å’Œæ‰€æœ‰æ•°æ®åº“ç³»ç»Ÿè¿æ¥ï¼Œæœ€ç»ˆå¯¼è‡´æ•°æ®åº“è¿æ¥èµ„æºä¸è¶³ï¼Œæ‹’ç»æœåŠ¡ã€‚</li>
<li><strong>ç‰¹å¾</strong>ï¼š<strong>å…¬å…±ä¸šåŠ¡æå–å‡ºæ¥ï¼Œç‹¬ç«‹éƒ¨ç½²ã€‚ç”±è¿™äº›å¯å¤ç”¨çš„ä¸šåŠ¡è¿æ¥æ•°æ®åº“ï¼Œé€šè¿‡åˆ†å¸ƒå¼æœåŠ¡æä¾›å…±ç”¨ä¸šåŠ¡æœåŠ¡ã€‚</strong></li>
<li>æè¿°ï¼šå¤§å‹ç½‘ç«™çš„æ¶æ„æ¼”åŒ–åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šå¤§å¤šæ•°çš„æŠ€æœ¯é—®é¢˜éƒ½å¾—ä»¥è§£å†³ï¼Œè¯¸å¦‚è·¨æ•°æ®ä¸­å¿ƒçš„å®æ—¶æ•°æ®åŒæ­¥å’Œå…·ä½“ç½‘ç«™ä¸šåŠ¡ç›¸å…³çš„é—®é¢˜ä¹Ÿéƒ½å¯ä»¥ç»„åˆæ”¹è¿›ç°æœ‰æŠ€æœ¯æ¶æ„æ¥è§£å†³ã€‚</li>
</ul>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/ç³»ç»Ÿæ¶æ„è¿›åŒ–-åˆ†å¸ƒå¼æœåŠ¡.jpg!zp" />
</div>
<h2 id="3-å¤§å‹è½¯ä»¶æ¶æ„çš„è€ƒé‡"><a class="markdownIt-Anchor" href="#3-å¤§å‹è½¯ä»¶æ¶æ„çš„è€ƒé‡"></a> 3. å¤§å‹è½¯ä»¶æ¶æ„çš„è€ƒé‡</h2>
<blockquote>
<p><strong>æ¯ä¸€ä¸ªæ¨¡å¼æè¿°äº†ä¸€ä¸ªä¸ä½†é‡å¤å‘ç”Ÿçš„é—®é¢˜åŠè¯¥é—®é¢˜è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒã€‚è¿™æ ·ï¼Œå°±å¯ä»¥ä¸æ–­å¤ç”¨è¯¥æ–¹æ¡ˆè€Œå‡å°‘é‡å¤å·¥ä½œ</strong>ã€‚</p>
</blockquote>
<h3 id="31-åŸåˆ™"><a class="markdownIt-Anchor" href="#31-åŸåˆ™"></a> 3.1. åŸåˆ™</h3>
<ul>
<li>æ¶æ„è®¾è®¡åº”è¯¥<strong>æŒ‰éœ€è®¾è®¡</strong>ã€‚ä»»ä½•ç½‘ç«™éƒ½æ˜¯éšç€ä¸šåŠ¡é€æ­¥å‘å±•ï¼Œä¸æ–­æ¼”åŒ–è€Œæˆï¼Œä¸è¦æŒ‡æœ›ä¸€åŠ³æ°¸é€¸ã€‚</li>
<li>é©±åŠ¨æŠ€æœ¯å‘å±•çš„ä¸»è¦åŠ›é‡æ˜¯ä¸šåŠ¡å‘å±•ã€‚</li>
<li>ä¸è¦ç›²ç›®è·Ÿé£å¤§å…¬å¸çš„è§£å†³æ–¹æ¡ˆã€‚</li>
<li>ä¸è¦ç›²ç›®è¿½æ±‚æµè¡ŒæŠ€æœ¯ï¼Œè€Œè„±ç¦»äº†ä¸šåŠ¡å‘å±•çš„å®é™…æƒ…å†µã€‚</li>
<li>ä¸è¦æŠŠæ‰€æœ‰é—®é¢˜éƒ½ä¸¢ç»™æŠ€æœ¯ã€‚ç°å®ä¸­ï¼Œæœ‰å¾ˆå¤šæ¡ˆä¾‹å‘Šè¯‰æˆ‘ä»¬ï¼Œå¾ˆå¤šé—®é¢˜ä¸ä¸€å®šéœ€è¦é€šè¿‡æŠ€æœ¯æ¥è§£å†³ã€‚å½’æ ¹ç»“åº•ï¼ŒæŠ€æœ¯å§‹ç»ˆéƒ½æ˜¯ä¸šåŠ¡çš„è¾…åŠ©ï¼Œä¸šåŠ¡é—®é¢˜ç©¶ç«Ÿæ˜¯é€šè¿‡æŠ€æœ¯æ¥è§£å†³è¿˜æ˜¯ç›´æ¥é€šè¿‡ä¸šåŠ¡æ¥è§£å†³ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µå»åˆ†æåˆ¤æ–­ã€‚è¿™å°±éœ€è¦å¯¹ä¸šåŠ¡é¢†åŸŸæœ‰æ¯”è¾ƒæ·±å…¥çš„ç†è§£å’Œæ€è€ƒã€‚</li>
</ul>
<h3 id="32-æ€§èƒ½"><a class="markdownIt-Anchor" href="#32-æ€§èƒ½"></a> 3.2. æ€§èƒ½</h3>
<p>æ€§èƒ½æ˜¯è½¯ä»¶ç³»ç»Ÿçš„é‡è¦è¡¡é‡æ ‡å‡†ã€‚å¾ˆå¤šæ‰©å±•æ€§ã€ä¼¸ç¼©æ€§ã€å¯ç”¨æ€§çš„é—®é¢˜ï¼Œæ˜¯ä¸ºäº†è§£å†³æ€§èƒ½é—®é¢˜è€Œå¼•å…¥çš„ã€‚</p>
<p>å¸¸è§çš„æ€§èƒ½æå‡æ‰‹æ®µæœ‰ï¼š</p>
<ul>
<li>å‰ç«¯
<ul>
<li>æµè§ˆå™¨ç¼“å­˜</li>
<li>é™æ€èµ„æºå‹ç¼©</li>
<li>åˆç†å¸ƒå±€é¡µé¢</li>
<li>å‡å°‘ cookie ä¼ è¾“</li>
<li>CDN</li>
</ul>
</li>
<li>åº”ç”¨æœåŠ¡
<ul>
<li>è´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†</li>
<li>æœ¬åœ°ç¼“å­˜</li>
<li>åˆ†å¸ƒå¼ç¼“å­˜</li>
<li>å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>é›†ç¾¤</li>
<li>ä»£ç å±‚é¢ï¼šä½¿ç”¨å¤šçº¿ç¨‹ã€æ”¹å–„å†…å­˜ç®¡ç†</li>
</ul>
</li>
<li>æ•°æ®åº“
<ul>
<li>ç´¢å¼•</li>
<li>æ•°æ®åº“ç¼“å­˜</li>
<li>SQL ä¼˜åŒ–</li>
</ul>
</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼šç¼“å­˜æ˜¯æ”¹å–„è½¯ä»¶æ€§èƒ½çš„ç¬¬ä¸€æ‰‹æ®µã€‚ç¼“å­˜é™¤äº†å¯ä»¥åŠ å¿«æ•°æ®è®¿é—®é€Ÿåº¦ä»¥å¤–ï¼Œè¿˜å¯ä»¥å‡è½»åç«¯åº”ç”¨å’Œæ•°æ®å­˜å‚¨çš„è´Ÿè½½å‹åŠ›ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¦æå‡ç³»ç»Ÿæ€§èƒ½ï¼Œåº”è¯¥ç¬¬ä¸€æ—¶é—´æƒ³åˆ°ç¼“å­˜ã€‚</p>
<p>ä½¿ç”¨ç¼“å­˜æœ‰ä¸¤ä¸ªå‰æï¼š</p>
<ul>
<li>æ•°æ®è®¿é—®çƒ­ç‚¹ä¸å‡åŒ€ï¼Œé¢‘ç¹è®¿é—®çš„æ•°æ®åº”è¯¥æ”¾åœ¨ç¼“å­˜ä¸­</li>
<li>æ•°æ®åœ¨æŸä¸ªæ—¶é—´æ®µæœ‰æ•ˆï¼Œä¸è¿‡å¾ˆå¿«è¿‡æœŸï¼Œå¦åˆ™ç¼“å­˜æ•°æ®ä¼šå› å·²ç»å¤±æ•ˆè€Œäº§ç”Ÿè„è¯»</li>
</ul>
</blockquote>
<h3 id="33-æ‰©å±•æ€§"><a class="markdownIt-Anchor" href="#33-æ‰©å±•æ€§"></a> 3.3. æ‰©å±•æ€§</h3>
<blockquote>
<p>è¡¡é‡æ‰©å±•æ€§çš„æ ‡å‡†å°±æ˜¯å¢åŠ æ–°çš„ä¸šåŠ¡äº§å“æ—¶ï¼Œæ˜¯å¦å¯ä»¥å®ç°å¯¹ç°æœ‰äº§å“é€æ˜æ— å½±å“ï¼Œä¸éœ€è¦ä»»ä½•æ”¹åŠ¨æˆ–å¾ˆå°‘æ”¹åŠ¨ï¼Œæ—¢æœ‰åŠŸèƒ½å°±å¯ä»¥ä¸Šçº¿æ–°äº§å“ã€‚</p>
<p>è½¯ä»¶å‘å±•çš„ä¸€ä¸ªé‡è¦ç›®æ ‡å’Œé©±åŠ¨åŠ›æ˜¯é™ä½è½¯ä»¶è€¦åˆæ€§ã€‚äº‹ç‰©ä¹‹é—´ç›´æ¥å…³ç³»è¶Šå°‘ï¼Œå½¼æ­¤å½±å“å°±è¶Šå°ï¼Œä¹Ÿå°±æ›´å®¹æ˜“ç‹¬ç«‹å‘å±•ï¼Œå³æ‰©å±•æ€§å¥½ã€‚</p>
</blockquote>
<p>ä¸»è¦æ‰‹æ®µæœ‰ï¼š</p>
<ul>
<li>
<p><strong>åˆ†å±‚</strong> - åˆ†å±‚æ˜¯æ‰©å±•æ€§è®¾è®¡çš„æœ€åŸºæœ¬æ‰‹æ®µã€‚é€šè¿‡åˆ†å±‚ï¼Œå¯ä»¥å°†ä¸€ä¸ªçš„è½¯ä»¶ç³»ç»Ÿåˆ‡åˆ†ä¸ºä¸åŒçš„éƒ¨åˆ†ï¼Œä¾¿äºåˆ†å·¥åˆä½œå¼€å‘å’Œç»´æŠ¤ï¼›å„å±‚é—´å…·æœ‰ä¸€å®šçš„ç‹¬ç«‹æ€§ã€‚</p>
<ul>
<li>åˆ†å±‚æ¶æ„çš„çº¦æŸï¼š<strong>ç¦æ­¢è·¨å±‚æ¬¡çš„è°ƒç”¨åŠé€†å‘è°ƒç”¨</strong>ã€‚</li>
<li>å³ä½¿ç³»ç»Ÿè§„æ¨¡å¾ˆå°ï¼Œä¹Ÿåº”è¯¥è€ƒè™‘é‡‡ç”¨åˆ†å±‚çš„æ¶æ„ï¼Œè¿™æ ·ä¾¿äºä»¥åæ‰©å±•ã€‚</li>
</ul>
</li>
<li>
<p><strong>åˆ†å‰²</strong> - å°†ä¸åŒçš„åŠŸèƒ½å’ŒæœåŠ¡åˆ†å‰²å¼€æ¥ï¼ŒåŒ…è£…æˆé«˜å†…èšã€ä½è€¦åˆçš„æ¨¡å—å•å…ƒã€‚è¿™æœ‰åŠ©äºè½¯ä»¶çš„å¼€å‘å’Œç»´æŠ¤ï¼Œä¾¿äºä¸åŒæ¨¡å—çš„åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œæé«˜ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›å’ŒåŠŸèƒ½æ‰©å±•èƒ½åŠ›ã€‚</p>
</li>
<li>
<p><strong>å¼‚æ­¥</strong> - ä¸šåŠ¡é—´çš„æ¶ˆæ¯ä¼ é€’ä¸æ˜¯åŒæ­¥è°ƒç”¨ï¼Œè€Œæ˜¯å°†ä¸€ä¸ªä¸šåŠ¡æ“ä½œæ‹†åˆ†æˆå¤šé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µé—´é€šè¿‡å…±äº«æ•°æ®çš„æ–¹å¼å¼‚æ­¥æ‰§è¡Œè¿›è¡Œåä½œã€‚</p>
<ul>
<li><strong>åœ¨å•ä¸€æœåŠ¡å™¨å†…éƒ¨å¯é€šè¿‡å¤šçº¿ç¨‹å…±äº«å†…å­˜é˜Ÿåˆ—çš„æ–¹å¼å®ç°å¼‚æ­¥</strong>ï¼Œå¤„åœ¨ä¸šåŠ¡æ“ä½œå‰é¢çš„çº¿ç¨‹å°†æ“ä½œè¾“å‡ºåˆ°é˜Ÿåˆ—ï¼Œåé¢çš„çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è¯»å–æ•°æ®è¿›è¡Œå¤„ç†ï¼›</li>
<li>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ<strong>å¤šä¸ªæœåŠ¡å™¨é›†ç¾¤é€šè¿‡åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—å®ç°å¼‚æ­¥</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>åˆ†å¸ƒå¼</strong> - å°†ä¸šåŠ¡å’Œå¯å¤ç”¨æœåŠ¡åˆ†ç¦»ï¼Œé€šè¿‡åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶è°ƒç”¨ã€‚åˆ†å¸ƒå¼æ˜¯æŒ‡å¤šå°æœåŠ¡å™¨éƒ¨ç½²ç›¸åŒåº”ç”¨æ„æˆä¸€ä¸ªé›†ç¾¤ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡è®¾å¤‡å…±åŒå¯¹å¤–æä¾›æœåŠ¡ã€‚ç€æ„å‘³ç€æœåŠ¡å¯ä»¥ç”¨æ›´å¤šçš„æœºå™¨å·¥ä½œï¼Œå³æ‰©å±• CPUã€å†…å­˜ã€IO ç­‰èµ„æºï¼Œä»è€Œæé«˜ç³»ç»Ÿæ•´ä½“çš„ååé‡å’Œå¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</p>
<ul>
<li>å¸¸ç”¨çš„åˆ†å¸ƒå¼æ–¹æ¡ˆï¼š
<ul>
<li>åˆ†å¸ƒå¼åº”ç”¨å’ŒæœåŠ¡</li>
<li>åˆ†å¸ƒå¼é™æ€èµ„æº</li>
<li>åˆ†å¸ƒå¼æ•°æ®å’Œå­˜å‚¨</li>
<li>åˆ†å¸ƒå¼è®¡ç®—</li>
</ul>
</li>
<li>åˆ†å¸ƒå¼ä¹Ÿå¼•å…¥äº†ä¸€äº›é—®é¢˜ï¼š
<ul>
<li>æœåŠ¡è°ƒç”¨å¿…é¡»é€šè¿‡ç½‘ç»œï¼Œç½‘ç»œå»¶è¿Ÿä¼šå½±å“æ€§èƒ½ã€‚</li>
<li>æœåŠ¡å™¨è¶Šå¤šï¼Œå®•æœºæ¦‚ç‡ä¹Ÿè¶Šå¤§ï¼Œå¯¼è‡´å¯ç”¨æ€§é™ä½ã€‚</li>
<li>æ•°æ®ä¸€è‡´æ€§éå¸¸å›°éš¾ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ä¹Ÿéš¾ä»¥ä¿è¯ã€‚</li>
<li>ç½‘ç«™ä¾èµ–é”™ç»¼å¤æ‚ï¼Œå¼€å‘ç®¡ç†ç»´æŠ¤å›°éš¾ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="34-ä¼¸ç¼©æ€§"><a class="markdownIt-Anchor" href="#34-ä¼¸ç¼©æ€§"></a> 3.4. ä¼¸ç¼©æ€§</h3>
<blockquote>
<p>è¡¡é‡ä¼¸ç¼©çš„æ ‡å‡†å°±æ˜¯æ˜¯å¦å¯ä»¥ç”¨å¤šå°æœåŠ¡å™¨æ„å»ºé›†ç¾¤ï¼Œæ˜¯å¦å®¹æ˜“å‘é›†ç¾¤ä¸­å¢åˆ æœåŠ¡å™¨èŠ‚ç‚¹ã€‚å¢åˆ æœåŠ¡å™¨èŠ‚ç‚¹åæ˜¯å¦å¯ä»¥æä¾›å’Œä¹‹å‰æ— å·®åˆ«çš„æœåŠ¡ã€‚é›†ç¾¤ä¸­å¯å®¹çº³çš„æ€»æœåŠ¡å™¨æ•°æ˜¯å¦æœ‰é™åˆ¶ã€‚</p>
</blockquote>
<p>ä¸»è¦æ‰‹æ®µæœ‰:</p>
<ul>
<li><strong>åº”ç”¨æœåŠ¡å™¨é›†ç¾¤</strong> - åªè¦æœåŠ¡å™¨ä¸Šä¿å­˜æ•°æ®ï¼Œåˆ™æ‰€æœ‰æœåŠ¡å™¨éƒ½æ˜¯å¯¹ç­‰çš„ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡è®¾å¤‡å‘é›†ç¾¤ä¸­ä¸æ–­åŠ å…¥æœåŠ¡å™¨å³å¯</li>
<li><strong>ç¼“å­˜æœåŠ¡å™¨é›†ç¾¤</strong> - åŠ å…¥æ–°çš„æœåŠ¡å™¨å¯èƒ½ä¼šå¯¼è‡´ç¼“å­˜è·¯ç”±å¤±æ•ˆï¼Œè¿›è€Œå¯¼è‡´é›†ç¾¤ä¸­çš„å¤§éƒ¨åˆ†ç¼“å­˜æ•°æ®éƒ½æ— æ³•è®¿é—®ã€‚è™½ç„¶ç¼“å­˜æ•°æ®å¯ä»¥é€šè¿‡æ•°æ®åº“é‡æ–°åŠ è½½ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä¸¥é‡ä¾èµ–ç¼“å­˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç½‘ç«™å´©æºƒã€‚éœ€è¦æ”¹è¿›ç¼“å­˜è·¯ç”±ç®—æ³•ä¿è¯ç¼“å­˜æ•°æ®çš„å¯è®¿é—®æ€§ã€‚</li>
<li><strong>å…³ç³»å‹æ•°æ®åº“é›†ç¾¤</strong> - å…³ç³»å‹æ•°æ®åº“è™½ç„¶æ”¯æŒæ•°æ®å¤åˆ¶ï¼Œä¸»ä»çƒ­å¤‡ç­‰æœºåˆ¶ï¼Œä½†æ˜¯å¾ˆéš¾åšåˆ°å¤§è§„æ¨¡é›†ç¾¤çš„å¯ä¼¸ç¼©æ€§ï¼Œå› æ­¤å…³ç³»å‹æ•°æ®åº“çš„é›†ç¾¤ä¼¸ç¼©æ€§æ–¹æ¡ˆå¿…é¡»åœ¨æ•°æ®åº“ä¹‹å¤–å®ç°ï¼Œé€šè¿‡è·¯ç”±åˆ†åŒºç­‰æ‰‹æ®µå°†éƒ¨ç½²æœ‰å¤šä¸ªæ•°æ®åº“çš„æœåŠ¡å™¨ç»„æˆä¸€ä¸ªé›†ç¾¤ã€‚</li>
<li><strong>Nosql æ•°æ®åº“é›†ç¾¤</strong> - ç”±äºå…ˆå¤©å°±æ˜¯ä¸ºäº†åº”å¯¹æµ·é‡æ•°æ®è€Œäº§ç”Ÿï¼Œå› æ­¤å¯¹ä¼¸ç¼©æ€§çš„æ”¯æŒé€šå¸¸éƒ½éå¸¸å¥½ã€‚</li>
</ul>
<h3 id="35-å¯ç”¨æ€§"><a class="markdownIt-Anchor" href="#35-å¯ç”¨æ€§"></a> 3.5. å¯ç”¨æ€§</h3>
<p>å¯¹äºå¤§å‹è½¯ä»¶ç³»ç»Ÿï¼Œå‡ºç°æœåŠ¡å™¨å®•æœºæ˜¯å¿…ç„¶äº‹ä»¶ã€‚è¦ä¿è¯éƒ¨åˆ†æœåŠ¡å™¨å®•æœºçš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¾ç„¶å¯ä»¥ç»§ç»­å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸ä¸¢å¤±æ•°æ®ï¼Œå°±éœ€è¦ä¸€å®šç¨‹åº¦ä¸Šçš„æœåŠ¡å™¨å†—ä½™è¿è¡Œï¼Œæ•°æ®å†—ä½™å¤‡ä»½ã€‚è¿™æ ·å½“æŸå°æœåŠ¡å™¨å®•æœºæ—¶ï¼Œå¯ä»¥å°†å…¶ä¸Šçš„æœåŠ¡å’Œæ•°æ®è®¿é—®è½¬ç§»åˆ°å…¶ä»–æœºå™¨ä¸Šã€‚</p>
<p>ä¸€èˆ¬çš„åšæ³•æ˜¯ï¼š</p>
<ul>
<li><strong>è´Ÿè½½å‡è¡¡</strong> - é€šè¿‡è´Ÿè½½å‡è¡¡è®¾å¤‡å»ºç«‹é›†ç¾¤å…±åŒå¯¹å¤–æä¾›æœåŠ¡ã€‚</li>
<li><strong>å¤‡ä»½</strong> - æ•°æ®å­˜å‚¨åœ¨å¤šå°æœåŠ¡å™¨ï¼Œäº’ç›¸å¤‡ä»½ã€‚å³ä½¿è®¿é—®å’Œè´Ÿè½½å¾ˆå°çš„æœåŠ¡ä¹Ÿå¿…é¡»éƒ¨ç½²è‡³å°‘ä¸¤å°æœåŠ¡å™¨ï¼Œæ„æˆä¸€ä¸ªé›†ç¾¤ï¼Œç›®çš„å°±æ˜¯é€šè¿‡å†—ä½™å®ç°æœåŠ¡çš„é«˜å¯ç”¨ã€‚
<ul>
<li><strong>å†·å¤‡ä»½</strong> - æ•°æ®åº”è¯¥å®šæœŸå¤‡ä»½ï¼›</li>
<li><strong>çƒ­å¤‡ä»½</strong> - ä¸ºäº†ä¿è¯åœ¨çº¿ä¸šåŠ¡é«˜å¯ç”¨ï¼Œè¿˜éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œä¸»ä»åˆ†ç¦»ï¼Œå®æ—¶åŒæ­¥ ã€‚</li>
<li><strong>ç¾å¤‡</strong> - ä¸ºäº†æŠµå¾¡åœ°éœ‡ã€æµ·å•¸ç­‰ä¸å¯æŠ—å› ç´ å¯¼è‡´çš„ç½‘ç«™å®Œå…¨ç˜«ç—ªï¼ŒæŸäº›å¤§å‹ç½‘ç«™ä¼šå¯¹æ•´ä¸ªæ•°æ®ä¸­å¿ƒè¿›è¡Œå¤‡ä»½ï¼Œå…¨çƒèŒƒå›´å†…éƒ¨ç½² <strong>ç¾å¤‡æ•°æ®ä¸­å¿ƒ</strong>ã€‚ç½‘ç«™ç¨‹åºå’Œæ•°æ®å®æ—¶åŒæ­¥åˆ°å¤šä¸ªç¾å¤‡æ•°æ®ä¸­å¿ƒã€‚</li>
</ul>
</li>
<li><strong>è‡ªåŠ¨åŒ–</strong> - è‡ªåŠ¨åŒ–æ˜¯æŒ‡ï¼Œå¤§å‹ç³»ç»Ÿæœ‰å¿…è¦é€šè¿‡é¢„å‘å¸ƒéªŒè¯ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€è‡ªåŠ¨åŒ–å‘å¸ƒã€ç°åº¦å‘å¸ƒç­‰æ‰‹æ®µï¼Œå‡å°‘å°†æ•…éšœå¼•å…¥çº¿ä¸Šç¯å¢ƒçš„å¯èƒ½ã€‚å¸¸è§è‡ªåŠ¨åŒ–æ‰‹æ®µæœ‰ï¼š
<ul>
<li>å‘å¸ƒè¿‡ç¨‹è‡ªåŠ¨åŒ–
<ul>
<li>è‡ªåŠ¨åŒ–ä»£ç ç®¡ç†</li>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•</li>
<li>è‡ªåŠ¨åŒ–å®‰å…¨ç›‘æµ‹</li>
<li>è‡ªåŠ¨åŒ–éƒ¨ç½²</li>
</ul>
</li>
<li>è¿ç»´è‡ªåŠ¨åŒ–
<ul>
<li>è‡ªåŠ¨åŒ–ç›‘æ§</li>
<li>è‡ªåŠ¨åŒ–æŠ¥è­¦</li>
<li>è‡ªåŠ¨åŒ–å¤±æ•ˆè½¬ç§»</li>
<li>è‡ªåŠ¨åŒ–å¤±æ•ˆæ¢å¤</li>
<li>è‡ªåŠ¨åŒ–é™çº§</li>
<li>è‡ªåŠ¨åŒ–åˆ†é…èµ„æº</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="36-å®‰å…¨"><a class="markdownIt-Anchor" href="#36-å®‰å…¨"></a> 3.6. å®‰å…¨</h3>
<p>å®‰å…¨æ˜¯æŒ‡ç³»ç»Ÿåº”è¯¥å¯¹æ¶æ„æ”»å‡»æœ‰ä¸€å®šçš„æŠµæŠ—èƒ½åŠ›ï¼Œä¿æŠ¤é‡è¦æ•°æ®ä¸è¢«çªƒå–ã€‚</p>
<ul>
<li><strong>å¯†ç </strong> å’Œ <strong>æ‰‹æœºæ ¡éªŒç </strong> è¿›è¡Œèº«ä»½è®¤è¯</li>
<li>ç™»å½•ã€äº¤æ˜“ç­‰é‡è¦æ“ä½œéœ€è¦å¯¹ç½‘ç»œé€šä¿¡è¿›è¡Œ <strong>åŠ å¯†</strong>ï¼Œå­˜å‚¨çš„æ•æ„Ÿæ•°æ®å¦‚ç”¨æˆ·ä¿¡æ¯ç­‰ä¹Ÿè¿›è¡ŒåŠ å¯†å¤„ç†</li>
<li>é˜²æ­¢æœºå™¨äººç¨‹åºæ”»å‡»ç½‘ç«™ï¼Œä½¿ç”¨ <strong>éªŒè¯ç </strong> è¿›è¡Œè¯†åˆ«</li>
<li>å¯¹å¸¸è§ç”¨äº <strong>æ”»å‡»</strong> ç½‘ç«™çš„ XSS æ”»å‡»ã€SQL æ³¨å…¥ã€è¿›è¡Œç¼–ç è½¬æ¢ç­‰ç›¸åº”å¤„ç†</li>
<li>å¯¹åƒåœ¾ä¿¡æ¯ã€æ•æ„Ÿä¿¡æ¯è¿›è¡Œ <strong>è¿‡æ»¤</strong></li>
<li>å¯¹äº¤æ˜“è½¬è´¦ç­‰é‡è¦æ“ä½œæ ¹æ®äº¤æ˜“æ¨¡å¼å’Œäº¤æ˜“ä¿¡æ¯è¿›è¡Œ <strong>é£é™©æ§åˆ¶</strong></li>
</ul>
<h2 id="4-å¸¸è§æ¶æ„æ¨¡å‹"><a class="markdownIt-Anchor" href="#4-å¸¸è§æ¶æ„æ¨¡å‹"></a> 4. å¸¸è§æ¶æ„æ¨¡å‹</h2>
<h3 id="41-åˆ†å±‚æ¶æ„"><a class="markdownIt-Anchor" href="#41-åˆ†å±‚æ¶æ„"></a> 4.1. åˆ†å±‚æ¶æ„</h3>
<p>åˆ†å±‚æ¶æ„ï¼ˆlayered architectureï¼‰æ˜¯æœ€å¸¸è§çš„è½¯ä»¶æ¶æ„ï¼Œä¹Ÿæ˜¯äº‹å®ä¸Šçš„æ ‡å‡†æ¶æ„ã€‚</p>
<p>è¿™ç§æ¶æ„å°†è½¯ä»¶åˆ†æˆè‹¥å¹²ä¸ªæ°´å¹³å±‚ï¼Œæ¯ä¸€å±‚éƒ½æœ‰æ¸…æ™°çš„è§’è‰²å’Œåˆ†å·¥ï¼Œä¸éœ€è¦çŸ¥é“å…¶ä»–å±‚çš„ç»†èŠ‚ã€‚å±‚ä¸å±‚ä¹‹é—´é€šè¿‡æ¥å£é€šä¿¡ã€‚</p>
<p>å››å±‚çš„ç»“æ„æœ€å¸¸è§ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/layered-architecture.png" width="500"/>
</div>
<ul>
<li>è¡¨ç°å±‚ï¼ˆpresentationï¼‰ï¼šç”¨æˆ·ç•Œé¢ï¼Œè´Ÿè´£è§†è§‰å’Œç”¨æˆ·äº’åŠ¨</li>
<li>ä¸šåŠ¡å±‚ï¼ˆbusinessï¼‰ï¼šå®ç°ä¸šåŠ¡é€»è¾‘</li>
<li>æŒä¹…å±‚ï¼ˆpersistenceï¼‰ï¼šæä¾›æ•°æ®ï¼ŒSQL è¯­å¥å°±æ”¾åœ¨è¿™ä¸€å±‚</li>
<li>æ•°æ®åº“ï¼ˆdatabaseï¼‰ ï¼šä¿å­˜æ•°æ®</li>
</ul>
<p>ä¼˜ç‚¹</p>
<ul>
<li>ç»“æ„ç®€å•ï¼Œå®¹æ˜“ç†è§£å’Œå¼€å‘</li>
<li>ä¸åŒæŠ€èƒ½çš„ç¨‹åºå‘˜å¯ä»¥åˆ†å·¥ï¼Œè´Ÿè´£ä¸åŒçš„å±‚ï¼Œå¤©ç„¶é€‚åˆå¤§å¤šæ•°è½¯ä»¶å…¬å¸çš„ç»„ç»‡æ¶æ„</li>
<li>æ¯ä¸€å±‚éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•ï¼Œå…¶ä»–å±‚çš„æ¥å£é€šè¿‡æ¨¡æ‹Ÿè§£å†³</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>ä¸€æ—¦ç¯å¢ƒå˜åŒ–ï¼Œéœ€è¦ä»£ç è°ƒæ•´æˆ–å¢åŠ åŠŸèƒ½æ—¶ï¼Œé€šå¸¸æ¯”è¾ƒéº»çƒ¦å’Œè´¹æ—¶</li>
<li>éƒ¨ç½²æ¯”è¾ƒéº»çƒ¦ï¼Œå³ä½¿åªä¿®æ”¹ä¸€ä¸ªå°åœ°æ–¹ï¼Œå¾€å¾€éœ€è¦æ•´ä¸ªè½¯ä»¶é‡æ–°éƒ¨ç½²ï¼Œä¸å®¹æ˜“åšæŒç»­å‘å¸ƒ</li>
<li>è½¯ä»¶å‡çº§æ—¶ï¼Œå¯èƒ½éœ€è¦æ•´ä¸ªæœåŠ¡æš‚åœ</li>
<li>æ‰©å±•æ€§å·®ã€‚ç”¨æˆ·è¯·æ±‚å¤§é‡å¢åŠ æ—¶ï¼Œå¿…é¡»ä¾æ¬¡æ‰©å±•æ¯ä¸€å±‚ï¼Œç”±äºæ¯ä¸€å±‚å†…éƒ¨æ˜¯è€¦åˆçš„ï¼Œæ‰©å±•ä¼šå¾ˆå›°éš¾</li>
</ul>
<h3 id="42-äº‹ä»¶é©±åŠ¨æ¶æ„"><a class="markdownIt-Anchor" href="#42-äº‹ä»¶é©±åŠ¨æ¶æ„"></a> 4.2. äº‹ä»¶é©±åŠ¨æ¶æ„</h3>
<p>äº‹ä»¶ï¼ˆeventï¼‰æ˜¯çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè½¯ä»¶å‘å‡ºçš„é€šçŸ¥ã€‚</p>
<p>äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆevent-driven architectureï¼‰å°±æ˜¯é€šè¿‡äº‹ä»¶è¿›è¡Œé€šä¿¡çš„è½¯ä»¶æ¶æ„ã€‚å®ƒåˆ†æˆå››ä¸ªéƒ¨åˆ†ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/event-driven-architecture.png" width="500"/>
</div>
<ul>
<li>äº‹ä»¶é˜Ÿåˆ—ï¼ˆevent queueï¼‰ï¼šæ¥æ”¶äº‹ä»¶çš„å…¥å£</li>
<li>åˆ†å‘å™¨ï¼ˆevent mediatorï¼‰ï¼šå°†ä¸åŒçš„äº‹ä»¶åˆ†å‘åˆ°ä¸åŒçš„ä¸šåŠ¡é€»è¾‘å•å…ƒ</li>
<li>äº‹ä»¶é€šé“ï¼ˆevent channelï¼‰ï¼šåˆ†å‘å™¨ä¸å¤„ç†å™¨ä¹‹é—´çš„è”ç³»æ¸ é“</li>
<li>äº‹ä»¶å¤„ç†å™¨ï¼ˆevent processorï¼‰ï¼šå®ç°ä¸šåŠ¡é€»è¾‘ï¼Œå¤„ç†å®Œæˆåä¼šå‘å‡ºäº‹ä»¶ï¼Œè§¦å‘ä¸‹ä¸€æ­¥æ“ä½œ</li>
</ul>
<p>å¯¹äºç®€å•çš„é¡¹ç›®ï¼Œäº‹ä»¶é˜Ÿåˆ—ã€åˆ†å‘å™¨å’Œäº‹ä»¶é€šé“ï¼Œå¯ä»¥åˆä¸ºä¸€ä½“ï¼Œæ•´ä¸ªè½¯ä»¶å°±åˆ†æˆäº‹ä»¶ä»£ç†å’Œäº‹ä»¶å¤„ç†å™¨ä¸¤éƒ¨åˆ†ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/simple-event-driven-architecture.png" width="500"/>
</div>
<p>ä¼˜ç‚¹</p>
<ul>
<li>åˆ†å¸ƒå¼çš„å¼‚æ­¥æ¶æ„ï¼Œäº‹ä»¶å¤„ç†å™¨ä¹‹é—´é«˜åº¦è§£è€¦ï¼Œè½¯ä»¶çš„æ‰©å±•æ€§å¥½</li>
<li>é€‚ç”¨æ€§å¹¿ï¼Œå„ç§ç±»å‹çš„é¡¹ç›®éƒ½å¯ä»¥ç”¨</li>
<li>æ€§èƒ½è¾ƒå¥½ï¼Œå› ä¸ºäº‹ä»¶çš„å¼‚æ­¥æœ¬è´¨ï¼Œè½¯ä»¶ä¸æ˜“äº§ç”Ÿå µå¡</li>
<li>äº‹ä»¶å¤„ç†å™¨å¯ä»¥ç‹¬ç«‹åœ°åŠ è½½å’Œå¸è½½ï¼Œå®¹æ˜“éƒ¨ç½²</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>æ¶‰åŠå¼‚æ­¥ç¼–ç¨‹ï¼ˆè¦è€ƒè™‘è¿œç¨‹é€šä¿¡ã€å¤±å»å“åº”ç­‰æƒ…å†µï¼‰ï¼Œå¼€å‘ç›¸å¯¹å¤æ‚</li>
<li>éš¾ä»¥æ”¯æŒåŸå­æ€§æ“ä½œï¼Œå› ä¸ºäº‹ä»¶é€šè¿‡ä¼šæ¶‰åŠå¤šä¸ªå¤„ç†å™¨ï¼Œå¾ˆéš¾å›æ»š</li>
<li>åˆ†å¸ƒå¼å’Œå¼‚æ­¥ç‰¹æ€§å¯¼è‡´è¿™ä¸ªæ¶æ„è¾ƒéš¾æµ‹è¯•</li>
</ul>
<h3 id="43-å¾®æ ¸æ¶æ„"><a class="markdownIt-Anchor" href="#43-å¾®æ ¸æ¶æ„"></a> 4.3. å¾®æ ¸æ¶æ„</h3>
<p>å¾®æ ¸æ¶æ„ï¼ˆmicrokernel architectureï¼‰åˆç§°ä¸º&quot;æ’ä»¶æ¶æ„&quot;ï¼ˆplug-in architectureï¼‰ï¼ŒæŒ‡çš„æ˜¯è½¯ä»¶çš„å†…æ ¸ç›¸å¯¹è¾ƒå°ï¼Œä¸»è¦åŠŸèƒ½å’Œä¸šåŠ¡é€»è¾‘éƒ½é€šè¿‡æ’ä»¶å®ç°ã€‚</p>
<p>å†…æ ¸ï¼ˆcoreï¼‰é€šå¸¸åªåŒ…å«ç³»ç»Ÿè¿è¡Œçš„æœ€å°åŠŸèƒ½ã€‚æ’ä»¶åˆ™æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œæ’ä»¶ä¹‹é—´çš„é€šä¿¡ï¼Œåº”è¯¥å‡å°‘åˆ°æœ€ä½ï¼Œé¿å…å‡ºç°äº’ç›¸ä¾èµ–çš„é—®é¢˜ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/plug-in-architecture.png" width="500"/>
</div>
<p>ä¼˜ç‚¹</p>
<ul>
<li>è‰¯å¥½çš„åŠŸèƒ½å»¶ä¼¸æ€§ï¼ˆextensibilityï¼‰ï¼Œéœ€è¦ä»€ä¹ˆåŠŸèƒ½ï¼Œå¼€å‘ä¸€ä¸ªæ’ä»¶å³å¯</li>
<li>åŠŸèƒ½ä¹‹é—´æ˜¯éš”ç¦»çš„ï¼Œæ’ä»¶å¯ä»¥ç‹¬ç«‹çš„åŠ è½½å’Œå¸è½½ï¼Œä½¿å¾—å®ƒæ¯”è¾ƒå®¹æ˜“éƒ¨ç½²ï¼Œ</li>
<li>å¯å®šåˆ¶æ€§é«˜ï¼Œé€‚åº”ä¸åŒçš„å¼€å‘éœ€è¦</li>
<li>å¯ä»¥æ¸è¿›å¼åœ°å¼€å‘ï¼Œé€æ­¥å¢åŠ åŠŸèƒ½</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>æ‰©å±•æ€§ï¼ˆscalabilityï¼‰å·®ï¼Œå†…æ ¸é€šå¸¸æ˜¯ä¸€ä¸ªç‹¬ç«‹å•å…ƒï¼Œä¸å®¹æ˜“åšæˆåˆ†å¸ƒå¼</li>
<li>å¼€å‘éš¾åº¦ç›¸å¯¹è¾ƒé«˜ï¼Œå› ä¸ºæ¶‰åŠåˆ°æ’ä»¶ä¸å†…æ ¸çš„é€šä¿¡ï¼Œä»¥åŠå†…éƒ¨çš„æ’ä»¶ç™»è®°æœºåˆ¶</li>
</ul>
<h3 id="44-å¾®æœåŠ¡æ¶æ„"><a class="markdownIt-Anchor" href="#44-å¾®æœåŠ¡æ¶æ„"></a> 4.4. å¾®æœåŠ¡æ¶æ„</h3>
<p>å¾®æœåŠ¡æ¶æ„ï¼ˆmicroservices architectureï¼‰æ˜¯æœåŠ¡å¯¼å‘æ¶æ„ï¼ˆservice-oriented architectureï¼Œç¼©å†™ SOAï¼‰çš„å‡çº§ã€‚</p>
<p>æ¯ä¸€ä¸ªæœåŠ¡å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„éƒ¨ç½²å•å…ƒï¼ˆseparately deployed unitï¼‰ã€‚è¿™äº›å•å…ƒéƒ½æ˜¯åˆ†å¸ƒå¼çš„ï¼Œäº’ç›¸è§£è€¦ï¼Œé€šè¿‡è¿œç¨‹é€šä¿¡åè®®ï¼ˆæ¯”å¦‚ RESTã€SOAPï¼‰è”ç³»ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/microservices-architecture.png" width="500"/>
</div>
<p>å¾®æœåŠ¡æ¶æ„åˆ†æˆä¸‰ç§å®ç°æ¨¡å¼ã€‚</p>
<ul>
<li>RESTful API æ¨¡å¼ï¼šæœåŠ¡é€šè¿‡ API æä¾›ï¼Œäº‘æœåŠ¡å°±å±äºè¿™ä¸€ç±»</li>
<li>RESTful åº”ç”¨æ¨¡å¼ï¼šæœåŠ¡é€šè¿‡ä¼ ç»Ÿçš„ç½‘ç»œåè®®æˆ–è€…åº”ç”¨åè®®æä¾›ï¼ŒèƒŒåé€šå¸¸æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„åº”ç”¨ç¨‹åºï¼Œå¸¸è§äºä¼ä¸šå†…éƒ¨</li>
<li>é›†ä¸­æ¶ˆæ¯æ¨¡å¼ï¼šé‡‡ç”¨æ¶ˆæ¯ä»£ç†ï¼ˆmessage brokerï¼‰ï¼Œå¯ä»¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—ã€è´Ÿè½½å‡è¡¡ã€ç»Ÿä¸€æ—¥å¿—å’Œå¼‚å¸¸å¤„ç†ï¼Œç¼ºç‚¹æ˜¯ä¼šå‡ºç°å•ç‚¹å¤±è´¥ï¼Œæ¶ˆæ¯ä»£ç†å¯èƒ½è¦åšæˆé›†ç¾¤</li>
</ul>
<p>ä¼˜ç‚¹</p>
<ul>
<li>æ‰©å±•æ€§å¥½ï¼Œå„ä¸ªæœåŠ¡ä¹‹é—´ä½è€¦åˆ</li>
<li>å®¹æ˜“éƒ¨ç½²ï¼Œè½¯ä»¶ä»å•ä¸€å¯éƒ¨ç½²å•å…ƒï¼Œè¢«æ‹†æˆäº†å¤šä¸ªæœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡éƒ½æ˜¯å¯éƒ¨ç½²å•å…ƒ</li>
<li>å®¹æ˜“å¼€å‘ï¼Œæ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥è¿›è¡ŒæŒç»­é›†æˆå¼çš„å¼€å‘ï¼Œå¯ä»¥åšåˆ°å®æ—¶éƒ¨ç½²ï¼Œä¸é—´æ–­åœ°å‡çº§</li>
<li>æ˜“äºæµ‹è¯•ï¼Œå¯ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸€ä¸ªæœåŠ¡</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>ç”±äºå¼ºè°ƒäº’ç›¸ç‹¬ç«‹å’Œä½è€¦åˆï¼ŒæœåŠ¡å¯èƒ½ä¼šæ‹†åˆ†å¾—å¾ˆç»†ã€‚è¿™å¯¼è‡´ç³»ç»Ÿä¾èµ–å¤§é‡çš„å¾®æœåŠ¡ï¼Œå˜å¾—å¾ˆå‡Œä¹±å’Œç¬¨é‡ï¼Œæ€§èƒ½ä¹Ÿä¼šä¸ä½³ã€‚</li>
<li>ä¸€æ—¦æœåŠ¡ä¹‹é—´éœ€è¦é€šä¿¡ï¼ˆå³ä¸€ä¸ªæœåŠ¡è¦ç”¨åˆ°å¦ä¸€ä¸ªæœåŠ¡ï¼‰ï¼Œæ•´ä¸ªæ¶æ„å°±ä¼šå˜å¾—å¤æ‚ã€‚å…¸å‹çš„ä¾‹å­å°±æ˜¯ä¸€äº›é€šç”¨çš„ Utility ç±»ï¼Œä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯æŠŠå®ƒä»¬æ‹·è´åˆ°æ¯ä¸€ä¸ªæœåŠ¡ä¸­å»ï¼Œç”¨å†—ä½™æ¢å–æ¶æ„çš„ç®€å•æ€§ã€‚</li>
<li>åˆ†å¸ƒå¼çš„æœ¬è´¨ä½¿å¾—è¿™ç§æ¶æ„å¾ˆéš¾å®ç°åŸå­æ€§æ“ä½œï¼Œäº¤æ˜“å›æ»šä¼šæ¯”è¾ƒå›°éš¾ã€‚</li>
</ul>
<h3 id="45-äº‘æ¶æ„"><a class="markdownIt-Anchor" href="#45-äº‘æ¶æ„"></a> 4.5. äº‘æ¶æ„</h3>
<p>äº‘ç»“æ„ï¼ˆcloud architectureï¼‰ä¸»è¦è§£å†³æ‰©å±•æ€§å’Œå¹¶å‘çš„é—®é¢˜ï¼Œæ˜¯æœ€å®¹æ˜“æ‰©å±•çš„æ¶æ„ã€‚</p>
<p>å®ƒçš„é«˜æ‰©å±•æ€§ï¼Œä¸»è¦åŸå› æ˜¯æ²¡ä½¿ç”¨ä¸­å¤®æ•°æ®åº“ï¼Œè€Œæ˜¯æŠŠæ•°æ®éƒ½å¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œå˜æˆå¯å¤åˆ¶çš„å†…å­˜æ•°æ®å•å…ƒã€‚ç„¶åï¼Œä¸šåŠ¡å¤„ç†èƒ½åŠ›å°è£…æˆä¸€ä¸ªä¸ªå¤„ç†å•å…ƒï¼ˆprcessing unitï¼‰ã€‚è®¿é—®é‡å¢åŠ ï¼Œå°±æ–°å»ºå¤„ç†å•å…ƒï¼›è®¿é—®é‡å‡å°‘ï¼Œå°±å…³é—­å¤„ç†å•å…ƒã€‚ç”±äºæ²¡æœ‰ä¸­å¤®æ•°æ®åº“ï¼Œæ‰€ä»¥æ‰©å±•æ€§çš„æœ€å¤§ç“¶é¢ˆæ¶ˆå¤±äº†ã€‚ç”±äºæ¯ä¸ªå¤„ç†å•å…ƒçš„æ•°æ®éƒ½åœ¨å†…å­˜é‡Œï¼Œæœ€å¥½è¦è¿›è¡Œæ•°æ®æŒä¹…åŒ–ã€‚</p>
<div align="center">
<img src="http://dunwu.test.upcdn.net/cs/design/architecture/cloud-architecture.png" width="500"/>
</div>
<p>è¿™ä¸ªæ¨¡å¼ä¸»è¦åˆ†æˆä¸¤éƒ¨åˆ†ï¼šå¤„ç†å•å…ƒï¼ˆprocessing unitï¼‰å’Œè™šæ‹Ÿä¸­é—´ä»¶ï¼ˆvirtualized middlewareï¼‰ã€‚</p>
<ul>
<li>å¤„ç†å•å…ƒï¼šå®ç°ä¸šåŠ¡é€»è¾‘</li>
<li>è™šæ‹Ÿä¸­é—´ä»¶ï¼šè´Ÿè´£é€šä¿¡ã€ä¿æŒ sessionsã€æ•°æ®å¤åˆ¶ã€åˆ†å¸ƒå¼å¤„ç†ã€å¤„ç†å•å…ƒçš„éƒ¨ç½²ã€‚</li>
</ul>
<p>è™šæ‹Ÿä¸­é—´ä»¶åˆåŒ…å«å››ä¸ªç»„ä»¶ã€‚</p>
<blockquote>
<ul>
<li><strong>æ¶ˆæ¯ä¸­é—´ä»¶</strong>ï¼ˆMessaging Gridï¼‰ï¼šç®¡ç†ç”¨æˆ·è¯·æ±‚å’Œ sessionï¼Œå½“ä¸€ä¸ªè¯·æ±‚è¿›æ¥ä»¥åï¼Œå†³å®šåˆ†é…ç»™å“ªä¸€ä¸ªå¤„ç†å•å…ƒã€‚</li>
<li><strong>æ•°æ®ä¸­é—´ä»¶</strong>ï¼ˆData Gridï¼‰ï¼šå°†æ•°æ®å¤åˆ¶åˆ°æ¯ä¸€ä¸ªå¤„ç†å•å…ƒï¼Œå³æ•°æ®åŒæ­¥ã€‚ä¿è¯æŸä¸ªå¤„ç†å•å…ƒéƒ½å¾—åˆ°åŒæ ·çš„æ•°æ®ã€‚</li>
<li><strong>å¤„ç†ä¸­é—´ä»¶</strong>ï¼ˆProcessing Gridï¼‰ï¼šå¯é€‰ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚æ¶‰åŠä¸åŒç±»å‹çš„å¤„ç†å•å…ƒï¼Œè¯¥ä¸­é—´ä»¶è´Ÿè´£åè°ƒå¤„ç†å•å…ƒ</li>
<li><strong>éƒ¨ç½²ä¸­é—´ä»¶</strong>ï¼ˆDeployment Managerï¼‰ï¼šè´Ÿè´£å¤„ç†å•å…ƒçš„å¯åŠ¨å’Œå…³é—­ï¼Œç›‘æ§è´Ÿè½½å’Œå“åº”æ—¶é—´ï¼Œå½“è´Ÿè½½å¢åŠ ï¼Œå°±æ–°å¯åŠ¨å¤„ç†å•å…ƒï¼Œè´Ÿè½½å‡å°‘ï¼Œå°±å…³é—­å¤„ç†å•å…ƒã€‚</li>
</ul>
</blockquote>
<p>ä¼˜ç‚¹</p>
<ul>
<li>é«˜è´Ÿè½½ï¼Œé«˜æ‰©å±•æ€§</li>
<li>åŠ¨æ€éƒ¨ç½²</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>å®ç°å¤æ‚ï¼Œæˆæœ¬è¾ƒé«˜</li>
<li>ä¸»è¦é€‚åˆç½‘ç«™ç±»åº”ç”¨ï¼Œä¸åˆé€‚å¤§é‡æ•°æ®ååçš„å¤§å‹æ•°æ®åº“åº”ç”¨</li>
<li>è¾ƒéš¾æµ‹è¯•</li>
</ul>
<h2 id="5-å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#5-å‚è€ƒèµ„æ–™"></a> 5. å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">å¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æ</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/09/software-architecture.html" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„å…¥é—¨- é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>æ¶æ„</tag>
        <tag>ç½‘ç«™</tag>
      </tags>
  </entry>
  <entry>
    <title>ç³»ç»Ÿå®‰å…¨æ€§æ¶æ„</title>
    <url>/blog/design/architecture/security-architecture/</url>
    <content><![CDATA[<h1 id="ç³»ç»Ÿå®‰å…¨æ€§æ¶æ„"><a class="markdownIt-Anchor" href="#ç³»ç»Ÿå®‰å…¨æ€§æ¶æ„"></a> ç³»ç»Ÿå®‰å…¨æ€§æ¶æ„</h1>
<blockquote>
<p>å…³é”®è¯ï¼šXSSã€CSRFã€SQL æ³¨å…¥ã€DoSã€æ¶ˆæ¯æ‘˜è¦ã€åŠ å¯†ç®—æ³•ã€è¯ä¹¦</p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E4%B8%80%E8%AE%A4%E8%AF%81">ä¸€ã€è®¤è¯</a>
<ul>
<li><a href="#sso">SSO</a></li>
<li><a href="#oauth-20">Oauth 2.0</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C%E9%89%B4%E6%9D%83">äºŒã€é‰´æƒ</a>
<ul>
<li><a href="#rbac">RBAC</a></li>
<li><a href="#%E8%A7%92%E8%89%B2%E7%BB%A7%E6%89%BF">è§’è‰²ç»§æ‰¿</a></li>
</ul>
</li>
<li><a href="#%E4%B8%89%E5%AE%A1%E8%AE%A1">ä¸‰ã€å®¡è®¡</a></li>
<li><a href="#%E5%9B%9B%E7%BD%91%E7%AB%99%E6%94%BB%E5%87%BB">å››ã€ç½‘ç«™æ”»å‡»</a>
<ul>
<li><a href="#xss">XSS</a></li>
<li><a href="#csrf">CSRF</a></li>
<li><a href="#sql-%E6%B3%A8%E5%85%A5">SQL æ³¨å…¥</a></li>
<li><a href="#dos">DoS</a></li>
</ul>
</li>
<li><a href="#%E4%BA%94%E5%8A%A0%E5%AF%86%E6%8A%80%E6%9C%AF">äº”ã€åŠ å¯†æŠ€æœ¯</a>
<ul>
<li><a href="#%E6%B6%88%E6%81%AF%E6%91%98%E8%A6%81">æ¶ˆæ¯æ‘˜è¦</a></li>
<li><a href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95">åŠ å¯†ç®—æ³•</a></li>
<li><a href="#%E8%AF%81%E4%B9%A6">è¯ä¹¦</a></li>
</ul>
</li>
<li><a href="#%E5%85%AD%E4%BF%A1%E6%81%AF%E8%BF%87%E6%BB%A4">å…­ã€ä¿¡æ¯è¿‡æ»¤</a>
<ul>
<li><a href="#%E6%96%87%E6%9C%AC%E5%8C%B9%E9%85%8D">æ–‡æœ¬åŒ¹é…</a></li>
<li><a href="#%E9%BB%91%E5%90%8D%E5%8D%95">é»‘åå•</a></li>
<li><a href="#%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95">åˆ†ç±»ç®—æ³•</a></li>
</ul>
</li>
<li><a href="#%E4%B8%83%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6">ä¸ƒã€é£é™©æ§åˆ¶</a>
<ul>
<li><a href="#%E9%A3%8E%E9%99%A9%E7%A7%8D%E7%B1%BB">é£é™©ç§ç±»</a></li>
<li><a href="#%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E6%89%8B%E6%AE%B5">é£é™©æ§åˆ¶æ‰‹æ®µ</a></li>
<li><a href="#%E8%A7%84%E5%88%99%E5%BC%95%E6%93%8E">è§„åˆ™å¼•æ“</a></li>
<li><a href="#%E7%BB%9F%E8%AE%A1%E6%A8%A1%E5%9E%8B">ç»Ÿè®¡æ¨¡å‹</a></li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="ä¸€-è®¤è¯"><a class="markdownIt-Anchor" href="#ä¸€-è®¤è¯"></a> ä¸€ã€è®¤è¯</h2>
<h3 id="sso"><a class="markdownIt-Anchor" href="#sso"></a> SSO</h3>
<p><strong>SSO(Single Sign On)ï¼Œå³å•ç‚¹ç™»å½•</strong>ã€‚æ‰€è°“å•ç‚¹ç™»å½•ï¼Œå°±æ˜¯åŒå¹³å°çš„è¯¸å¤šåº”ç”¨ç™»é™†ä¸€æ¬¡ï¼Œä¸‹ä¸€æ¬¡å°±å…ç™»é™†çš„åŠŸèƒ½ã€‚</p>
<p>SSO éœ€è¦è§£å†³å¤šä¸ªå¼‚æ„ç³»ç»Ÿä¹‹é—´çš„é—®é¢˜ï¼š</p>
<ul>
<li>Session å…±äº«é—®é¢˜</li>
<li>è·¨åŸŸé—®é¢˜</li>
</ul>
<h4 id="session-å…±äº«é—®é¢˜"><a class="markdownIt-Anchor" href="#session-å…±äº«é—®é¢˜"></a> Session å…±äº«é—®é¢˜</h4>
<p>åˆ†å¸ƒå¼ Session çš„å‡ ç§å®ç°ç­–ç•¥ï¼š</p>
<ul>
<li>ç²˜æ€§ Session - ç¼ºç‚¹ï¼šå½“<strong>æœåŠ¡å™¨èŠ‚ç‚¹å®•æœºæ—¶ï¼Œå°†ä¸¢å¤±è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰ Session</strong>ã€‚</li>
<li>åº”ç”¨æœåŠ¡å™¨é—´çš„ Session å¤åˆ¶å…±äº« - ç¼ºç‚¹ï¼š<strong>å ç”¨è¿‡å¤šå†…å­˜</strong>ï¼›<strong>åŒæ­¥è¿‡ç¨‹å ç”¨ç½‘ç»œå¸¦å®½ä»¥åŠæœåŠ¡å™¨å¤„ç†å™¨æ—¶é—´</strong>ã€‚</li>
<li>åŸºäºç¼“å­˜çš„ Session å…±äº« âœ… ï¼ˆæ¨èæ–¹æ¡ˆï¼‰ - ä¸è¿‡éœ€è¦ç¨‹åºè‡ªèº«æ§åˆ¶ Session è¯»å†™ï¼Œå¯ä»¥è€ƒè™‘åŸºäº spring-session + redis è¿™ç§æˆç†Ÿçš„æ–¹æ¡ˆæ¥å¤„ç†ã€‚</li>
</ul>
<blockquote>
<p>è¯¦æƒ…è¯·å‚è€ƒï¼š<a href="../theory/distributed-session-theory.md">Session åŸç†</a></p>
</blockquote>
<h4 id="cookie-è·¨åŸŸ"><a class="markdownIt-Anchor" href="#cookie-è·¨åŸŸ"></a> Cookie è·¨åŸŸ</h4>
<p><strong>Cookie ä¸èƒ½è·¨åŸŸ</strong>ï¼æ¯”å¦‚ï¼šæµè§ˆå™¨ä¸ä¼šæŠŠ <a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> çš„ cookie ä¼ ç»™ <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>ã€‚</p>
<p>è¿™å°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šç”±äºåŸŸåä¸åŒï¼Œç”¨æˆ·åœ¨ç³»ç»Ÿ A ç™»å½•åï¼Œæµè§ˆå™¨è®°å½•ç³»ç»Ÿ A çš„ Cookieï¼Œä½†æ˜¯è®¿é—®ç³»ç»Ÿ B çš„æ—¶å€™ä¸ä¼šæºå¸¦è¿™ä¸ª Cookieã€‚</p>
<p>é’ˆå¯¹ <strong>Cookie ä¸èƒ½è·¨åŸŸ</strong> çš„é—®é¢˜ï¼Œæœ‰å‡ ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>æœåŠ¡ç«¯ç”Ÿæˆ Cookie åï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è§£æ Cookie ï¼Œæå– Token ï¼ˆæ¯”å¦‚ JWTï¼‰ï¼Œæ­¤åæ¯æ¬¡è¯·æ±‚éƒ½æºå¸¦è¿™ä¸ª Tokenã€‚</li>
<li>å¤šä¸ªåŸŸåå…±äº« Cookieï¼Œåœ¨è¿”å› Cookie ç»™å®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œåœ¨ Cookie ä¸­è®¾ç½® domain ç™½åå•ã€‚</li>
<li>å°† Token ä¿å­˜åœ¨ <strong><code>SessionStroage</code></strong> ä¸­ï¼ˆä¸ä¾èµ– Cookie å°±æ²¡æœ‰è·¨åŸŸçš„é—®é¢˜äº†ï¼‰ã€‚</li>
</ul>
<h4 id="cas"><a class="markdownIt-Anchor" href="#cas"></a> CAS</h4>
<p>CAS æ˜¯å®ç° SSO çš„ä¸»æµæ–¹å¼ã€‚</p>
<p>CAS åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼ŒCAS Server å’Œ CAS Client</p>
<ul>
<li><strong><code>CAS Server</code></strong> - è´Ÿè´£ç”¨æˆ·çš„è®¤è¯å·¥ä½œï¼Œå°±åƒæ˜¯æŠŠç¬¬ä¸€æ¬¡ç™»å½•ç”¨æˆ·çš„ä¸€ä¸ªæ ‡è¯†å­˜åœ¨è¿™é‡Œï¼Œä»¥ä¾¿æ­¤ç”¨æˆ·åœ¨å…¶ä»–ç³»ç»Ÿç™»å½•æ—¶éªŒè¯å…¶éœ€ä¸éœ€è¦å†æ¬¡ç™»å½•ã€‚</li>
<li><strong><code>CAS Client</code></strong> - ä¸šåŠ¡åº”ç”¨ï¼Œéœ€è¦æ¥å…¥ CAS Serverã€‚å½“ç”¨æˆ·è®¿é—®æˆ‘ä»¬çš„åº”ç”¨æ—¶ï¼Œé¦–å…ˆéœ€è¦é‡å®šå‘åˆ° CAS Server ç«¯è¿›è¡ŒéªŒè¯ï¼Œè¦æ˜¯åŸæ¥ç™»é™†è¿‡ï¼Œå°±å…å»ç™»å½•ï¼Œé‡å®šå‘åˆ°ä¸‹æ¸¸ç³»ç»Ÿï¼Œå¦åˆ™è¿›è¡Œç”¨æˆ·åå¯†ç ç™»é™†æ“ä½œã€‚</li>
</ul>
<p>æœ¯è¯­ï¼š</p>
<ul>
<li><strong><code>Ticket Granting Ticket (TGT)</code></strong> - å¯ä»¥è®¤ä¸ºæ˜¯ CAS Server æ ¹æ®ç”¨æˆ·åã€å¯†ç ç”Ÿæˆçš„ä¸€å¼ ç¥¨ï¼Œå­˜åœ¨ Server ç«¯ã€‚</li>
<li><strong><code>Ticket Granting Cookie (TGC)</code></strong> - å…¶å®å°±æ˜¯ä¸€ä¸ª Cookieï¼Œå­˜æ”¾ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œç”± Server å‘ç»™ Client ç«¯ã€‚</li>
<li><strong><code>Service Ticket (ST)</code></strong> - ç”± TGT ç”Ÿæˆçš„ä¸€æ¬¡æ€§ç¥¨æ®ï¼Œç”¨äºéªŒè¯ï¼Œåªèƒ½ç”¨ä¸€æ¬¡ã€‚</li>
</ul>
<p>CAS å·¥ä½œæµç¨‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200119195646.png" alt="" /></p>
<ol>
<li>ç”¨æˆ·è®¿é—® CAS Client Aï¼ˆä¸šåŠ¡ç³»ç»Ÿï¼‰ï¼Œç¬¬ä¸€æ¬¡è®¿é—®ï¼Œé‡å®šå‘åˆ°è®¤è¯æœåŠ¡ä¸­å¿ƒï¼ˆCAS Serverï¼‰ã€‚CAS Server å‘ç°å½“å‰è¯·æ±‚ä¸­æ²¡æœ‰ Cookieï¼Œå†é‡å®šå‘åˆ° CAS Server çš„ç™»å½•é¡µé¢ã€‚é‡å®šå‘è¯·æ±‚çš„ URL ä¸­åŒ…å«è®¿é—®åœ°å€ï¼Œä»¥ä¾¿è®¤è¯æˆåŠŸåç›´æ¥è·³è½¬åˆ°è®¿é—®é¡µé¢ã€‚</li>
<li>ç”¨æˆ·åœ¨ç™»å½•é¡µé¢è¾“å…¥ç”¨æˆ·åã€å¯†ç ç­‰è®¤è¯ä¿¡æ¯ï¼Œè®¤è¯æˆåŠŸåï¼ŒCAS Server ç”Ÿæˆ TGTï¼Œå†ç”¨ TGT ç”Ÿæˆä¸€ä¸ª STã€‚ç„¶åè¿”å› ST å’Œ TGCï¼ˆCookieï¼‰ç»™æµè§ˆå™¨ã€‚</li>
<li>æµè§ˆå™¨æºå¸¦ ST å†åº¦è®¿é—®ä¹‹å‰æƒ³è®¿é—®çš„ CAS Client A é¡µé¢ã€‚</li>
<li>CAS Client A æ”¶åˆ° ST åï¼Œå‘ CAS Server éªŒè¯ ST çš„æœ‰æ•ˆæ€§ã€‚éªŒè¯é€šè¿‡åˆ™å…è®¸ç”¨æˆ·è®¿é—®é¡µé¢ã€‚</li>
<li>æ­¤æ—¶ï¼Œå¦‚æœç™»å½•å¦ä¸€ä¸ª CAS Client Bï¼Œä¼šå…ˆé‡å®šå‘åˆ° CAS Serverï¼ŒCAS Server å¯ä»¥åˆ¤æ–­è¿™ä¸ª CAS Client B æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œä½†æ˜¯æœ¬åœ°æœ‰ TGCï¼Œæ‰€ä»¥æ— éœ€å†æ¬¡ç™»å½•ã€‚ç”¨ TGC åˆ›å»ºä¸€ä¸ª STï¼Œè¿”å›ç»™æµè§ˆå™¨ã€‚</li>
<li>é‡å¤ç±»ä¼¼ 3ã€4 æ­¥éª¤ã€‚</li>
</ol>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200119202448.png" alt="" /></p>
<p>ä»¥ä¸Šäº†å½’çº³æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>è®¿é—®æœåŠ¡</strong> - ç”¨æˆ·è®¿é—® SSO Client èµ„æºã€‚</p>
</li>
<li>
<p><strong>å®šå‘è®¤è¯</strong> - SSO Client é‡å®šå‘ç”¨æˆ·è¯·æ±‚åˆ° SSO Serverã€‚</p>
</li>
<li>
<p><strong>ç”¨æˆ·è®¤è¯</strong> - ç”¨æˆ·èº«ä»½è®¤è¯ã€‚</p>
</li>
<li>
<p><strong>å‘æ”¾ç¥¨æ®</strong> - SSO Server ä¼šäº§ç”Ÿä¸€ä¸ª Service Ticket (ST) å¹¶è¿”å›ç»™æµè§ˆå™¨ã€‚</p>
</li>
<li>
<p><strong>éªŒè¯ç¥¨æ®</strong> - æµè§ˆå™¨æ¯æ¬¡è®¿é—® SSO Client æ—¶ï¼Œæºå¸¦ STï¼ŒSSO Client å‘ SSO Server éªŒè¯ç¥¨æ®ã€‚åªæœ‰éªŒè¯é€šè¿‡ï¼Œæ‰å…è®¸è®¿é—®ã€‚</p>
</li>
<li>
<p><strong>ä¼ è¾“ç”¨æˆ·ä¿¡æ¯</strong> - SSO Server éªŒè¯ç¥¨æ®é€šè¿‡åï¼Œä¼ è¾“ç”¨æˆ·è®¤è¯ç»“æœä¿¡æ¯ç»™ SSO Clientã€‚</p>
</li>
</ol>
<h3 id="oauth-20"><a class="markdownIt-Anchor" href="#oauth-20"></a> Oauth 2.0</h3>
<h4 id="åŸºæœ¬åŸç†"><a class="markdownIt-Anchor" href="#åŸºæœ¬åŸç†"></a> åŸºæœ¬åŸç†</h4>
<p>OAuth åœ¨&quot;å®¢æˆ·ç«¯&quot;ä¸&quot;æœåŠ¡æä¾›å•†&quot;ä¹‹é—´ï¼Œè®¾ç½®äº†ä¸€ä¸ªæˆæƒå±‚ï¼ˆauthorization layerï¼‰ã€‚â€œå®¢æˆ·ç«¯&quot;ä¸èƒ½ç›´æ¥ç™»å½•&quot;æœåŠ¡æä¾›å•†â€ï¼Œåªèƒ½ç™»å½•æˆæƒå±‚ï¼Œä»¥æ­¤å°†ç”¨æˆ·ä¸å®¢æˆ·ç«¯åŒºåˆ†å¼€æ¥ã€‚&quot;å®¢æˆ·ç«¯&quot;ç™»å½•æˆæƒå±‚æ‰€ç”¨çš„ä»¤ç‰Œï¼ˆtokenï¼‰ï¼Œä¸ç”¨æˆ·çš„å¯†ç ä¸åŒã€‚ç”¨æˆ·å¯ä»¥åœ¨ç™»å½•çš„æ—¶å€™ï¼ŒæŒ‡å®šæˆæƒå±‚ä»¤ç‰Œçš„æƒé™èŒƒå›´å’Œæœ‰æ•ˆæœŸã€‚</p>
<p>&quot;å®¢æˆ·ç«¯&quot;ç™»å½•æˆæƒå±‚ä»¥åï¼Œ&quot;æœåŠ¡æä¾›å•†&quot;æ ¹æ®ä»¤ç‰Œçš„æƒé™èŒƒå›´å’Œæœ‰æ•ˆæœŸï¼Œå‘&quot;å®¢æˆ·ç«¯&quot;å¼€æ”¾ç”¨æˆ·å‚¨å­˜çš„èµ„æ–™ã€‚</p>
<p>OAuth 2.0 çš„è¿è¡Œæµç¨‹å¦‚ä¸‹å›¾ï¼Œæ‘˜è‡ª RFC 6749ã€‚</p>
<div align="center"><img src="http://www.ruanyifeng.com/blogimg/asset/2014/bg2014051203.png"/></div>
ï¼ˆAï¼‰ç”¨æˆ·æ‰“å¼€å®¢æˆ·ç«¯ä»¥åï¼Œå®¢æˆ·ç«¯è¦æ±‚ç”¨æˆ·ç»™äºˆæˆæƒã€‚
<p>ï¼ˆBï¼‰ç”¨æˆ·åŒæ„ç»™äºˆå®¢æˆ·ç«¯æˆæƒã€‚</p>
<p>ï¼ˆCï¼‰å®¢æˆ·ç«¯ä½¿ç”¨ä¸Šä¸€æ­¥è·å¾—çš„æˆæƒï¼Œå‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œã€‚</p>
<p>ï¼ˆDï¼‰è®¤è¯æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯è¿›è¡Œè®¤è¯ä»¥åï¼Œç¡®è®¤æ— è¯¯ï¼ŒåŒæ„å‘æ”¾ä»¤ç‰Œã€‚</p>
<p>ï¼ˆEï¼‰å®¢æˆ·ç«¯ä½¿ç”¨ä»¤ç‰Œï¼Œå‘èµ„æºæœåŠ¡å™¨ç”³è¯·è·å–èµ„æºã€‚</p>
<p>ï¼ˆFï¼‰èµ„æºæœåŠ¡å™¨ç¡®è®¤ä»¤ç‰Œæ— è¯¯ï¼ŒåŒæ„å‘å®¢æˆ·ç«¯å¼€æ”¾èµ„æºã€‚</p>
<p>ä¸éš¾çœ‹å‡ºæ¥ï¼Œä¸Šé¢å…­ä¸ªæ­¥éª¤ä¹‹ä¸­ï¼ŒB æ˜¯å…³é”®ï¼Œå³ç”¨æˆ·æ€æ ·æ‰èƒ½ç»™äºå®¢æˆ·ç«¯æˆæƒã€‚æœ‰äº†è¿™ä¸ªæˆæƒä»¥åï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥è·å–ä»¤ç‰Œï¼Œè¿›è€Œå‡­ä»¤ç‰Œè·å–èµ„æºã€‚</p>
<h4 id="æˆæƒæ¨¡å¼"><a class="markdownIt-Anchor" href="#æˆæƒæ¨¡å¼"></a> æˆæƒæ¨¡å¼</h4>
<p>å®¢æˆ·ç«¯å¿…é¡»å¾—åˆ°ç”¨æˆ·çš„æˆæƒï¼ˆauthorization grantï¼‰ï¼Œæ‰èƒ½è·å¾—ä»¤ç‰Œï¼ˆaccess tokenï¼‰ã€‚OAuth 2.0 å®šä¹‰äº†å››ç§æˆæƒæ–¹å¼ã€‚</p>
<ul>
<li>æˆæƒç æ¨¡å¼ï¼ˆauthorization codeï¼‰</li>
<li>ç®€åŒ–æ¨¡å¼ï¼ˆimplicitï¼‰</li>
<li>å¯†ç æ¨¡å¼ï¼ˆresource owner password credentialsï¼‰</li>
<li>å®¢æˆ·ç«¯æ¨¡å¼ï¼ˆclient credentialsï¼‰</li>
</ul>
<h4 id="æˆæƒç æ¨¡å¼"><a class="markdownIt-Anchor" href="#æˆæƒç æ¨¡å¼"></a> æˆæƒç æ¨¡å¼</h4>
<p>æˆæƒç æ¨¡å¼ï¼ˆauthorization codeï¼‰æ˜¯åŠŸèƒ½æœ€å®Œæ•´ã€æµç¨‹æœ€ä¸¥å¯†çš„æˆæƒæ¨¡å¼ã€‚å®ƒçš„ç‰¹ç‚¹å°±æ˜¯é€šè¿‡å®¢æˆ·ç«¯çš„åå°æœåŠ¡å™¨ï¼Œä¸&quot;æœåŠ¡æä¾›å•†&quot;çš„è®¤è¯æœåŠ¡å™¨è¿›è¡Œäº’åŠ¨ã€‚</p>
<div align="center"><img src="http://www.ruanyifeng.com/blogimg/asset/2014/bg2014051204.png"/></div>
å®ƒçš„æ­¥éª¤å¦‚ä¸‹ï¼š
<p>ï¼ˆAï¼‰ç”¨æˆ·è®¿é—®å®¢æˆ·ç«¯ï¼Œåè€…å°†å‰è€…å¯¼å‘è®¤è¯æœåŠ¡å™¨ã€‚</p>
<p>ï¼ˆBï¼‰ç”¨æˆ·é€‰æ‹©æ˜¯å¦ç»™äºˆå®¢æˆ·ç«¯æˆæƒã€‚</p>
<p>ï¼ˆCï¼‰å‡è®¾ç”¨æˆ·ç»™äºˆæˆæƒï¼Œè®¤è¯æœåŠ¡å™¨å°†ç”¨æˆ·å¯¼å‘å®¢æˆ·ç«¯äº‹å…ˆæŒ‡å®šçš„&quot;é‡å®šå‘ URI&quot;ï¼ˆredirection URIï¼‰ï¼ŒåŒæ—¶é™„ä¸Šä¸€ä¸ªæˆæƒç ã€‚</p>
<p>ï¼ˆDï¼‰å®¢æˆ·ç«¯æ”¶åˆ°æˆæƒç ï¼Œé™„ä¸Šæ—©å…ˆçš„&quot;é‡å®šå‘ URI&quot;ï¼Œå‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œã€‚è¿™ä¸€æ­¥æ˜¯åœ¨å®¢æˆ·ç«¯çš„åå°çš„æœåŠ¡å™¨ä¸Šå®Œæˆçš„ï¼Œå¯¹ç”¨æˆ·ä¸å¯è§ã€‚</p>
<p>ï¼ˆEï¼‰è®¤è¯æœåŠ¡å™¨æ ¸å¯¹äº†æˆæƒç å’Œé‡å®šå‘ URIï¼Œç¡®è®¤æ— è¯¯åï¼Œå‘å®¢æˆ·ç«¯å‘é€è®¿é—®ä»¤ç‰Œï¼ˆaccess tokenï¼‰å’Œæ›´æ–°ä»¤ç‰Œï¼ˆrefresh tokenï¼‰ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸Šé¢è¿™äº›æ­¥éª¤æ‰€éœ€è¦çš„å‚æ•°ã€‚</p>
<p>A æ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯ç”³è¯·è®¤è¯çš„ URIï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>response_typeï¼šè¡¨ç¤ºæˆæƒç±»å‹ï¼Œå¿…é€‰é¡¹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸º&quot;code&quot;</li>
<li>client_idï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„ IDï¼Œå¿…é€‰é¡¹</li>
<li>redirect_uriï¼šè¡¨ç¤ºé‡å®šå‘ URIï¼Œå¯é€‰é¡¹</li>
<li>scopeï¼šè¡¨ç¤ºç”³è¯·çš„æƒé™èŒƒå›´ï¼Œå¯é€‰é¡¹</li>
<li>stateï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„å½“å‰çŠ¶æ€ï¼Œå¯ä»¥æŒ‡å®šä»»æ„å€¼ï¼Œè®¤è¯æœåŠ¡å™¨ä¼šåŸå°ä¸åŠ¨åœ°è¿”å›è¿™ä¸ªå€¼ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz</span><br><span class="line">  &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: server.example.com</span><br></pre></td></tr></table></figure>
<p>C æ­¥éª¤ä¸­ï¼ŒæœåŠ¡å™¨å›åº”å®¢æˆ·ç«¯çš„ URIï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>codeï¼šè¡¨ç¤ºæˆæƒç ï¼Œå¿…é€‰é¡¹ã€‚è¯¥ç çš„æœ‰æ•ˆæœŸåº”è¯¥å¾ˆçŸ­ï¼Œé€šå¸¸è®¾ä¸º 10 åˆ†é’Ÿï¼Œå®¢æˆ·ç«¯åªèƒ½ä½¿ç”¨è¯¥ç ä¸€æ¬¡ï¼Œå¦åˆ™ä¼šè¢«æˆæƒæœåŠ¡å™¨æ‹’ç»ã€‚è¯¥ç ä¸å®¢æˆ·ç«¯ ID å’Œé‡å®šå‘ URIï¼Œæ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚</li>
<li>stateï¼šå¦‚æœå®¢æˆ·ç«¯çš„è¯·æ±‚ä¸­åŒ…å«è¿™ä¸ªå‚æ•°ï¼Œè®¤è¯æœåŠ¡å™¨çš„å›åº”ä¹Ÿå¿…é¡»ä¸€æ¨¡ä¸€æ ·åŒ…å«è¿™ä¸ªå‚æ•°ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">Location</span>: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA</span><br><span class="line">    &amp;state=xyz</span><br></pre></td></tr></table></figure>
<p>D æ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯å‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>grant_typeï¼šè¡¨ç¤ºä½¿ç”¨çš„æˆæƒæ¨¡å¼ï¼Œå¿…é€‰é¡¹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸º&quot;authorization_code&quot;ã€‚</li>
<li>codeï¼šè¡¨ç¤ºä¸Šä¸€æ­¥è·å¾—çš„æˆæƒç ï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>redirect_uriï¼šè¡¨ç¤ºé‡å®šå‘ URIï¼Œå¿…é€‰é¡¹ï¼Œä¸”å¿…é¡»ä¸ A æ­¥éª¤ä¸­çš„è¯¥å‚æ•°å€¼ä¿æŒä¸€è‡´ã€‚</li>
<li>client_idï¼šè¡¨ç¤ºå®¢æˆ·ç«¯ IDï¼Œå¿…é€‰é¡¹ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/token</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: server.example.com</span><br><span class="line"><span class="attribute">Authorization</span>: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">grant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA</span><br><span class="line">&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb</span><br></pre></td></tr></table></figure>
<p>E æ­¥éª¤ä¸­ï¼Œè®¤è¯æœåŠ¡å™¨å‘é€çš„ HTTP å›å¤ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>access_tokenï¼šè¡¨ç¤ºè®¿é—®ä»¤ç‰Œï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>token_typeï¼šè¡¨ç¤ºä»¤ç‰Œç±»å‹ï¼Œè¯¥å€¼å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¿…é€‰é¡¹ï¼Œå¯ä»¥æ˜¯ bearer ç±»å‹æˆ– mac ç±»å‹ã€‚</li>
<li>expires_inï¼šè¡¨ç¤ºè¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œå¿…é¡»å…¶ä»–æ–¹å¼è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚</li>
<li>refresh_tokenï¼šè¡¨ç¤ºæ›´æ–°ä»¤ç‰Œï¼Œç”¨æ¥è·å–ä¸‹ä¸€æ¬¡çš„è®¿é—®ä»¤ç‰Œï¼Œå¯é€‰é¡¹ã€‚</li>
<li>scopeï¼šè¡¨ç¤ºæƒé™èŒƒå›´ï¼Œå¦‚æœä¸å®¢æˆ·ç«¯ç”³è¯·çš„èŒƒå›´ä¸€è‡´ï¼Œæ­¤é¡¹å¯çœç•¥ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json;charset=UTF-8</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-store</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"> "access_token":"2YotnFZFEjr1zCsicMWpAA",</span><br><span class="line"> "token_type":"example",</span><br><span class="line"> "expires_in":3600,</span><br><span class="line"> "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",</span><br><span class="line"> "example_parameter":"example_value"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œç›¸å…³å‚æ•°ä½¿ç”¨ JSON æ ¼å¼å‘é€ï¼ˆContent-Type: application/jsonï¼‰ã€‚æ­¤å¤–ï¼ŒHTTP å¤´ä¿¡æ¯ä¸­æ˜ç¡®æŒ‡å®šä¸å¾—ç¼“å­˜ã€‚</p>
<h4 id="ç®€åŒ–æ¨¡å¼"><a class="markdownIt-Anchor" href="#ç®€åŒ–æ¨¡å¼"></a> ç®€åŒ–æ¨¡å¼</h4>
<p>ç®€åŒ–æ¨¡å¼ï¼ˆimplicit grant typeï¼‰ä¸é€šè¿‡ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ï¼Œç›´æ¥åœ¨æµè§ˆå™¨ä¸­å‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œï¼Œè·³è¿‡äº†&quot;æˆæƒç &quot;è¿™ä¸ªæ­¥éª¤ï¼Œå› æ­¤å¾—åã€‚æ‰€æœ‰æ­¥éª¤åœ¨æµè§ˆå™¨ä¸­å®Œæˆï¼Œä»¤ç‰Œå¯¹è®¿é—®è€…æ˜¯å¯è§çš„ï¼Œä¸”å®¢æˆ·ç«¯ä¸éœ€è¦è®¤è¯ã€‚</p>
<div align="center"><img src="http://www.ruanyifeng.com/blogimg/asset/2014/bg2014051205.png"/></div>
å®ƒçš„æ­¥éª¤å¦‚ä¸‹ï¼š
<p>ï¼ˆAï¼‰å®¢æˆ·ç«¯å°†ç”¨æˆ·å¯¼å‘è®¤è¯æœåŠ¡å™¨ã€‚</p>
<p>ï¼ˆBï¼‰ç”¨æˆ·å†³å®šæ˜¯å¦ç»™äºå®¢æˆ·ç«¯æˆæƒã€‚</p>
<p>ï¼ˆCï¼‰å‡è®¾ç”¨æˆ·ç»™äºˆæˆæƒï¼Œè®¤è¯æœåŠ¡å™¨å°†ç”¨æˆ·å¯¼å‘å®¢æˆ·ç«¯æŒ‡å®šçš„&quot;é‡å®šå‘ URI&quot;ï¼Œå¹¶åœ¨ URI çš„ Hash éƒ¨åˆ†åŒ…å«äº†è®¿é—®ä»¤ç‰Œã€‚</p>
<p>ï¼ˆDï¼‰æµè§ˆå™¨å‘èµ„æºæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå…¶ä¸­ä¸åŒ…æ‹¬ä¸Šä¸€æ­¥æ”¶åˆ°çš„ Hash å€¼ã€‚</p>
<p>ï¼ˆEï¼‰èµ„æºæœåŠ¡å™¨è¿”å›ä¸€ä¸ªç½‘é¡µï¼Œå…¶ä¸­åŒ…å«çš„ä»£ç å¯ä»¥è·å– Hash å€¼ä¸­çš„ä»¤ç‰Œã€‚</p>
<p>ï¼ˆFï¼‰æµè§ˆå™¨æ‰§è¡Œä¸Šä¸€æ­¥è·å¾—çš„è„šæœ¬ï¼Œæå–å‡ºä»¤ç‰Œã€‚</p>
<p>ï¼ˆGï¼‰æµè§ˆå™¨å°†ä»¤ç‰Œå‘ç»™å®¢æˆ·ç«¯ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸Šé¢è¿™äº›æ­¥éª¤æ‰€éœ€è¦çš„å‚æ•°ã€‚</p>
<p>A æ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯å‘å‡ºçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>response_typeï¼šè¡¨ç¤ºæˆæƒç±»å‹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸º&quot;token&quot;ï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>client_idï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„ IDï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>redirect_uriï¼šè¡¨ç¤ºé‡å®šå‘çš„ URIï¼Œå¯é€‰é¡¹ã€‚</li>
<li>scopeï¼šè¡¨ç¤ºæƒé™èŒƒå›´ï¼Œå¯é€‰é¡¹ã€‚</li>
<li>stateï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„å½“å‰çŠ¶æ€ï¼Œå¯ä»¥æŒ‡å®šä»»æ„å€¼ï¼Œè®¤è¯æœåŠ¡å™¨ä¼šåŸå°ä¸åŠ¨åœ°è¿”å›è¿™ä¸ªå€¼ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">GET /authorize?response_type=token&amp;client_id=s6BhdRkqt3&amp;state=xyz</span><br><span class="line">  &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: server.example.com</span><br></pre></td></tr></table></figure>
<p>C æ­¥éª¤ä¸­ï¼Œè®¤è¯æœåŠ¡å™¨å›åº”å®¢æˆ·ç«¯çš„ URIï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>access_tokenï¼šè¡¨ç¤ºè®¿é—®ä»¤ç‰Œï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>token_typeï¼šè¡¨ç¤ºä»¤ç‰Œç±»å‹ï¼Œè¯¥å€¼å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>expires_inï¼šè¡¨ç¤ºè¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œå¿…é¡»å…¶ä»–æ–¹å¼è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚</li>
<li>scopeï¼šè¡¨ç¤ºæƒé™èŒƒå›´ï¼Œå¦‚æœä¸å®¢æˆ·ç«¯ç”³è¯·çš„èŒƒå›´ä¸€è‡´ï¼Œæ­¤é¡¹å¯çœç•¥ã€‚</li>
<li>stateï¼šå¦‚æœå®¢æˆ·ç«¯çš„è¯·æ±‚ä¸­åŒ…å«è¿™ä¸ªå‚æ•°ï¼Œè®¤è¯æœåŠ¡å™¨çš„å›åº”ä¹Ÿå¿…é¡»ä¸€æ¨¡ä¸€æ ·åŒ…å«è¿™ä¸ªå‚æ•°ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">Location</span>: http://example.com/cb#access_token=2YotnFZFEjr1zCsicMWpAA</span><br><span class="line">         &amp;state=xyz&amp;token_type=example&amp;expires_in=3600</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè®¤è¯æœåŠ¡å™¨ç”¨ HTTP å¤´ä¿¡æ¯çš„ Location æ ï¼ŒæŒ‡å®šæµè§ˆå™¨é‡å®šå‘çš„ç½‘å€ã€‚æ³¨æ„ï¼Œåœ¨è¿™ä¸ªç½‘å€çš„ Hash éƒ¨åˆ†åŒ…å«äº†ä»¤ç‰Œã€‚</p>
<p>æ ¹æ®ä¸Šé¢çš„ D æ­¥éª¤ï¼Œä¸‹ä¸€æ­¥æµè§ˆå™¨ä¼šè®¿é—® Location æŒ‡å®šçš„ç½‘å€ï¼Œä½†æ˜¯ Hash éƒ¨åˆ†ä¸ä¼šå‘é€ã€‚æ¥ä¸‹æ¥çš„ E æ­¥éª¤ï¼ŒæœåŠ¡æä¾›å•†çš„èµ„æºæœåŠ¡å™¨å‘é€è¿‡æ¥çš„ä»£ç ï¼Œä¼šæå–å‡º Hash ä¸­çš„ä»¤ç‰Œã€‚</p>
<p>å¯†ç æ¨¡å¼</p>
<p>å¯†ç æ¨¡å¼ï¼ˆResource Owner Password Credentials Grantï¼‰ä¸­ï¼Œç”¨æˆ·å‘å®¢æˆ·ç«¯æä¾›è‡ªå·±çš„ç”¨æˆ·åå’Œå¯†ç ã€‚å®¢æˆ·ç«¯ä½¿ç”¨è¿™äº›ä¿¡æ¯ï¼Œå‘&quot;æœåŠ¡å•†æä¾›å•†&quot;ç´¢è¦æˆæƒã€‚</p>
<p>åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œç”¨æˆ·å¿…é¡»æŠŠè‡ªå·±çš„å¯†ç ç»™å®¢æˆ·ç«¯ï¼Œä½†æ˜¯å®¢æˆ·ç«¯ä¸å¾—å‚¨å­˜å¯†ç ã€‚è¿™é€šå¸¸ç”¨åœ¨ç”¨æˆ·å¯¹å®¢æˆ·ç«¯é«˜åº¦ä¿¡ä»»çš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚å®¢æˆ·ç«¯æ˜¯æ“ä½œç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œæˆ–è€…ç”±ä¸€ä¸ªè‘—åå…¬å¸å‡ºå“ã€‚è€Œè®¤è¯æœåŠ¡å™¨åªæœ‰åœ¨å…¶ä»–æˆæƒæ¨¡å¼æ— æ³•æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½è€ƒè™‘ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚</p>
<div align="center"><img src="http://www.ruanyifeng.com/blogimg/asset/2014/bg2014051206.png"/></div>
å®ƒçš„æ­¥éª¤å¦‚ä¸‹ï¼š
<p>ï¼ˆAï¼‰ç”¨æˆ·å‘å®¢æˆ·ç«¯æä¾›ç”¨æˆ·åå’Œå¯†ç ã€‚</p>
<p>ï¼ˆBï¼‰å®¢æˆ·ç«¯å°†ç”¨æˆ·åå’Œå¯†ç å‘ç»™è®¤è¯æœåŠ¡å™¨ï¼Œå‘åè€…è¯·æ±‚ä»¤ç‰Œã€‚</p>
<p>ï¼ˆCï¼‰è®¤è¯æœåŠ¡å™¨ç¡®è®¤æ— è¯¯åï¼Œå‘å®¢æˆ·ç«¯æä¾›è®¿é—®ä»¤ç‰Œã€‚</p>
<p>B æ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯å‘å‡ºçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>grant_typeï¼šè¡¨ç¤ºæˆæƒç±»å‹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸º&quot;password&quot;ï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>usernameï¼šè¡¨ç¤ºç”¨æˆ·åï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>passwordï¼šè¡¨ç¤ºç”¨æˆ·çš„å¯†ç ï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>scopeï¼šè¡¨ç¤ºæƒé™èŒƒå›´ï¼Œå¯é€‰é¡¹ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/token</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: server.example.com</span><br><span class="line"><span class="attribute">Authorization</span>: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">grant_type=password&amp;username=johndoe&amp;password=A3ddj3w</span><br></pre></td></tr></table></figure>
<p>C æ­¥éª¤ä¸­ï¼Œè®¤è¯æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€è®¿é—®ä»¤ç‰Œï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json;charset=UTF-8</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-store</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"> "access_token":"2YotnFZFEjr1zCsicMWpAA",</span><br><span class="line"> "token_type":"example",</span><br><span class="line"> "expires_in":3600,</span><br><span class="line"> "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",</span><br><span class="line"> "example_parameter":"example_value"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå„ä¸ªå‚æ•°çš„å«ä¹‰å‚è§ã€Šæˆæƒç æ¨¡å¼ã€‹ä¸€èŠ‚ã€‚</p>
<p>æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯ä¸å¾—ä¿å­˜ç”¨æˆ·çš„å¯†ç ã€‚</p>
<p>å®¢æˆ·ç«¯æ¨¡å¼</p>
<p>å®¢æˆ·ç«¯æ¨¡å¼ï¼ˆClient Credentials Grantï¼‰æŒ‡å®¢æˆ·ç«¯ä»¥è‡ªå·±çš„åä¹‰ï¼Œè€Œä¸æ˜¯ä»¥ç”¨æˆ·çš„åä¹‰ï¼Œå‘&quot;æœåŠ¡æä¾›å•†&quot;è¿›è¡Œè®¤è¯ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œå®¢æˆ·ç«¯æ¨¡å¼å¹¶ä¸å±äº OAuth æ¡†æ¶æ‰€è¦è§£å†³çš„é—®é¢˜ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œç”¨æˆ·ç›´æ¥å‘å®¢æˆ·ç«¯æ³¨å†Œï¼Œå®¢æˆ·ç«¯ä»¥è‡ªå·±çš„åä¹‰è¦æ±‚&quot;æœåŠ¡æä¾›å•†&quot;æä¾›æœåŠ¡ï¼Œå…¶å®ä¸å­˜åœ¨æˆæƒé—®é¢˜ã€‚</p>
<div align="center"><img src="http://www.ruanyifeng.com/blogimg/asset/2014/bg2014051207.png"/></div>
å®ƒçš„æ­¥éª¤å¦‚ä¸‹ï¼š
<p>ï¼ˆAï¼‰å®¢æˆ·ç«¯å‘è®¤è¯æœåŠ¡å™¨è¿›è¡Œèº«ä»½è®¤è¯ï¼Œå¹¶è¦æ±‚ä¸€ä¸ªè®¿é—®ä»¤ç‰Œã€‚</p>
<p>ï¼ˆBï¼‰è®¤è¯æœåŠ¡å™¨ç¡®è®¤æ— è¯¯åï¼Œå‘å®¢æˆ·ç«¯æä¾›è®¿é—®ä»¤ç‰Œã€‚</p>
<p>A æ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯å‘å‡ºçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>grant<em>typeï¼šè¡¨ç¤ºæˆæƒç±»å‹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸º&quot;client</em>credentials&quot;ï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>scopeï¼šè¡¨ç¤ºæƒé™èŒƒå›´ï¼Œå¯é€‰é¡¹ã€‚</li>
</ul>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/token</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: server.example.com</span><br><span class="line"><span class="attribute">Authorization</span>: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">grant_type=client_credentials</span><br></pre></td></tr></table></figure>
<p>è®¤è¯æœåŠ¡å™¨å¿…é¡»ä»¥æŸç§æ–¹å¼ï¼ŒéªŒè¯å®¢æˆ·ç«¯èº«ä»½ã€‚</p>
<p>B æ­¥éª¤ä¸­ï¼Œè®¤è¯æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€è®¿é—®ä»¤ç‰Œï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json;charset=UTF-8</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-store</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"> "access_token":"2YotnFZFEjr1zCsicMWpAA",</span><br><span class="line"> "token_type":"example",</span><br><span class="line"> "expires_in":3600,</span><br><span class="line"> "example_parameter":"example_value"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå„ä¸ªå‚æ•°çš„å«ä¹‰å‚è§ã€Šæˆæƒç æ¨¡å¼ã€‹ä¸€èŠ‚ã€‚</p>
<h4 id="æ›´æ–°ä»¤ç‰Œ"><a class="markdownIt-Anchor" href="#æ›´æ–°ä»¤ç‰Œ"></a> æ›´æ–°ä»¤ç‰Œ</h4>
<p>å¦‚æœç”¨æˆ·è®¿é—®çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯çš„&quot;è®¿é—®ä»¤ç‰Œ&quot;å·²ç»è¿‡æœŸï¼Œåˆ™éœ€è¦ä½¿ç”¨&quot;æ›´æ–°ä»¤ç‰Œ&quot;ç”³è¯·ä¸€ä¸ªæ–°çš„è®¿é—®ä»¤ç‰Œã€‚</p>
<p>å®¢æˆ·ç«¯å‘å‡ºæ›´æ–°ä»¤ç‰Œçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>grant<em>typeï¼šè¡¨ç¤ºä½¿ç”¨çš„æˆæƒæ¨¡å¼ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸º&quot;refresh</em>token&quot;ï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>refresh_tokenï¼šè¡¨ç¤ºæ—©å‰æ”¶åˆ°çš„æ›´æ–°ä»¤ç‰Œï¼Œå¿…é€‰é¡¹ã€‚</li>
<li>scopeï¼šè¡¨ç¤ºç”³è¯·çš„æˆæƒèŒƒå›´ï¼Œä¸å¯ä»¥è¶…å‡ºä¸Šä¸€æ¬¡ç”³è¯·çš„èŒƒå›´ï¼Œå¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œåˆ™è¡¨ç¤ºä¸ä¸Šä¸€æ¬¡ä¸€è‡´ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/token</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: server.example.com</span><br><span class="line"><span class="attribute">Authorization</span>: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA</span><br></pre></td></tr></table></figure>
<h2 id="äºŒ-é‰´æƒ"><a class="markdownIt-Anchor" href="#äºŒ-é‰´æƒ"></a> äºŒã€é‰´æƒ</h2>
<h3 id="rbac"><a class="markdownIt-Anchor" href="#rbac"></a> RBAC</h3>
<p>åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBAC: Role-Based Access Control)</p>
<p>æ¯ä¸ªç”¨æˆ·å…³è”ä¸€ä¸ªæˆ–å¤šä¸ªè§’è‰²ï¼Œæ¯ä¸ªè§’è‰²å…³è”ä¸€ä¸ªæˆ–å¤šä¸ªæƒé™ï¼Œä»è€Œå¯ä»¥å®ç°äº†éå¸¸çµæ´»çš„æƒé™ç®¡ç†ã€‚è§’è‰²å¯ä»¥æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚çµæ´»åˆ›å»ºï¼Œè¿™æ ·å°±çœå»äº†æ¯æ–°å¢ä¸€ä¸ªç”¨æˆ·å°±è¦å…³è”ä¸€éæ‰€æœ‰æƒé™çš„éº»çƒ¦ã€‚ç®€å•æ¥è¯´ RBAC å°±æ˜¯ï¼šç”¨æˆ·å…³è”è§’è‰²ï¼Œè§’è‰²å…³è”æƒé™ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200119210359.png" alt="" /></p>
<h3 id="è§’è‰²ç»§æ‰¿"><a class="markdownIt-Anchor" href="#è§’è‰²ç»§æ‰¿"></a> è§’è‰²ç»§æ‰¿</h3>
<p>è§’è‰²ç»§æ‰¿(Hierarchical Role) å°±æ˜¯æŒ‡è§’è‰²å¯ä»¥ç»§æ‰¿äºå…¶ä»–è§’è‰²ï¼Œåœ¨æ‹¥æœ‰å…¶ä»–è§’è‰²æƒé™çš„åŒæ—¶ï¼Œè‡ªå·±è¿˜å¯ä»¥å…³è”é¢å¤–çš„æƒé™ã€‚è¿™ç§è®¾è®¡å¯ä»¥ç»™è§’è‰²åˆ†ç»„å’Œåˆ†å±‚ï¼Œä¸€å®šç¨‹åº¦ç®€åŒ–äº†æƒé™ç®¡ç†å·¥ä½œã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200119210528.png" alt="" /></p>
<h4 id="èŒè´£åˆ†ç¦»separation-of-duty"><a class="markdownIt-Anchor" href="#èŒè´£åˆ†ç¦»separation-of-duty"></a> èŒè´£åˆ†ç¦»(Separation of Duty)</h4>
<p>ä¸ºäº†é¿å…ç”¨æˆ·æ‹¥æœ‰è¿‡å¤šæƒé™è€Œäº§ç”Ÿåˆ©ç›Šå†²çªï¼Œä¾‹å¦‚ä¸€ä¸ªç¯®çƒè¿åŠ¨å‘˜åŒæ—¶æ‹¥æœ‰è£åˆ¤çš„æƒé™ï¼ˆçœ‹ä¸€çœ¼å°±ç»™ä½ åˆ¤çŠ¯è§„ç‹ ä¸ç‹ ï¼Ÿï¼‰ï¼Œå¦ä¸€ç§èŒè´£åˆ†ç¦»æ‰©å±•ç‰ˆçš„ RBAC è¢«æå‡ºã€‚</p>
<p>èŒè´£åˆ†ç¦»æœ‰ä¸¤ç§æ¨¡å¼ï¼š</p>
<p>é™æ€èŒè´£åˆ†ç¦»(Static Separation of Duty)ï¼šç”¨æˆ·æ— æ³•åŒæ—¶è¢«èµ‹äºˆæœ‰å†²çªçš„è§’è‰²ã€‚</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/594774-feb7c1074d151113.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/509/format/webp" alt="img" /></p>
<p>åŠ¨æ€èŒè´£åˆ†ç¦»(Dynamic Separation of Duty)ï¼šç”¨æˆ·åœ¨ä¸€æ¬¡ä¼šè¯ï¼ˆSessionï¼‰ä¸­ä¸èƒ½åŒæ—¶æ¿€æ´»è‡ªèº«æ‰€æ‹¥æœ‰çš„ã€äº’ç›¸æœ‰å†²çªçš„è§’è‰²ï¼Œåªèƒ½é€‰æ‹©å…¶ä¸€ã€‚</p>
<p><img src="https:////upload-images.jianshu.io/upload_images/594774-059b93e4209e8fa6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/397/format/webp" alt="img" /></p>
<p>è®²äº†è¿™ä¹ˆå¤š RBACï¼Œéƒ½è¿˜åªæ˜¯åœ¨ç”¨æˆ·å’Œæƒé™ä¹‹é—´è¿›è¡Œè®¾è®¡ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠåˆ°ç”¨æˆ·å’Œå¯¹è±¡ä¹‹é—´çš„æƒé™åˆ¤æ–­ï¼Œè€Œåœ¨å®é™…ä¸šåŠ¡ç³»ç»Ÿä¸­é™åˆ¶ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨çš„å¯¹è±¡æ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ã€‚</p>
<h2 id="ä¸‰-å®¡è®¡"><a class="markdownIt-Anchor" href="#ä¸‰-å®¡è®¡"></a> ä¸‰ã€å®¡è®¡</h2>
<p>TODO</p>
<h2 id="å››-ç½‘ç«™æ”»å‡»"><a class="markdownIt-Anchor" href="#å››-ç½‘ç«™æ”»å‡»"></a> å››ã€ç½‘ç«™æ”»å‡»</h2>
<p>äº’è”ç½‘ç¯å¢ƒé±¼é¾™æ··æ‚ï¼Œç½‘ç«™è¢«æ”»å‡»æ˜¯å¸¸è§ç°è±¡ï¼Œæ‰€ä»¥äº†è§£ä¸€äº›å¸¸è§çš„ç½‘ç«™æ”»å‡»æ‰‹æ®µååˆ†å¿…è¦ã€‚ä¸‹é¢åˆ—ä¸¾æ¯”è¾ƒå¸¸è§çš„ 4 ç§æ”»å‡»æ‰‹æ®µï¼š</p>
<h3 id="xss"><a class="markdownIt-Anchor" href="#xss"></a> XSS</h3>
<h4 id="æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#æ¦‚å¿µ"></a> æ¦‚å¿µ</h4>
<p><strong><code>è·¨ç«™è„šæœ¬ï¼ˆCross-site scriptingï¼Œé€šå¸¸ç®€ç§°ä¸ºXSSï¼‰</code></strong> æ˜¯ä¸€ç§ç½‘ç«™åº”ç”¨ç¨‹åºçš„å®‰å…¨æ¼æ´æ”»å‡»ï¼Œæ˜¯ä»£ç æ³¨å…¥çš„ä¸€ç§ã€‚å®ƒå…è®¸æ¶æ„ç”¨æˆ·å°†ä»£ç æ³¨å…¥åˆ°ç½‘é¡µä¸Šï¼Œå…¶ä»–ç”¨æˆ·åœ¨è§‚çœ‹ç½‘é¡µæ—¶å°±ä¼šå—åˆ°å½±å“ã€‚è¿™ç±»æ”»å‡»é€šå¸¸åŒ…å«äº† HTML ä»¥åŠç”¨æˆ·ç«¯è„šæœ¬è¯­è¨€ã€‚</p>
<p>XSS æ”»å‡»ç¤ºä¾‹ï¼š</p>
<p>å‡å¦‚æœ‰ä¸‹é¢ä¸€ä¸ª textbox</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"address1"</span> <span class="attr">value</span>=<span class="string">"value1from"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>value1from æ˜¯æ¥è‡ªç”¨æˆ·çš„è¾“å…¥ï¼Œå¦‚æœç”¨æˆ·ä¸æ˜¯è¾“å…¥ value1from,è€Œæ˜¯è¾“å…¥ <code>&quot;/&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;!-</code> é‚£ä¹ˆå°±ä¼šå˜æˆï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"address1"</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">	alert(<span class="built_in">document</span>.cookie)</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">!-</span> "&gt;</span></span><br></pre></td></tr></table></figure>
<p>åµŒå…¥çš„ JavaScript ä»£ç å°†ä¼šè¢«æ‰§è¡Œã€‚æ”»å‡»çš„å¨åŠ›ï¼Œå–å†³äºç”¨æˆ·è¾“å…¥äº†ä»€ä¹ˆæ ·çš„è„šæœ¬ã€‚</p>
<h4 id="æ”»å‡»æ‰‹æ®µå’Œç›®çš„"><a class="markdownIt-Anchor" href="#æ”»å‡»æ‰‹æ®µå’Œç›®çš„"></a> æ”»å‡»æ‰‹æ®µå’Œç›®çš„</h4>
<p>å¸¸ç”¨çš„ XSS æ”»å‡»æ‰‹æ®µå’Œç›®çš„æœ‰ï¼š</p>
<ul>
<li>ç›—ç”¨ cookieï¼Œè·å–æ•æ„Ÿä¿¡æ¯ã€‚</li>
<li>åˆ©ç”¨æ¤å…¥ Flashï¼Œé€šè¿‡ <code>crossdomain</code> æƒé™è®¾ç½®è¿›ä¸€æ­¥è·å–æ›´é«˜æƒé™ï¼›æˆ–è€…åˆ©ç”¨ Java ç­‰å¾—åˆ°ç±»ä¼¼çš„æ“ä½œã€‚</li>
<li>åˆ©ç”¨ <code>iframe</code>ã€<code>frame</code>ã€<code>XMLHttpRequest</code> æˆ–ä¸Šè¿° Flash ç­‰æ–¹å¼ï¼Œä»¥ï¼ˆè¢«æ”»å‡»ï¼‰ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œä¸€äº›ç®¡ç†åŠ¨ä½œï¼Œæˆ–æ‰§è¡Œä¸€äº›ä¸€èˆ¬çš„å¦‚å‘å¾®åšã€åŠ å¥½å‹ã€å‘ç§ä¿¡ç­‰æ“ä½œã€‚</li>
<li>åˆ©ç”¨å¯è¢«æ”»å‡»çš„åŸŸå—åˆ°å…¶ä»–åŸŸä¿¡ä»»çš„ç‰¹ç‚¹ï¼Œä»¥å—ä¿¡ä»»æ¥æºçš„èº«ä»½è¯·æ±‚ä¸€äº›å¹³æ—¶ä¸å…è®¸çš„æ“ä½œï¼Œå¦‚è¿›è¡Œä¸å½“çš„æŠ•ç¥¨æ´»åŠ¨ã€‚</li>
<li>åœ¨è®¿é—®é‡æå¤§çš„ä¸€äº›é¡µé¢ä¸Šçš„ XSS å¯ä»¥æ”»å‡»ä¸€äº›å°å‹ç½‘ç«™ï¼Œå®ç° DDoS æ”»å‡»çš„æ•ˆæœã€‚</li>
</ul>
<h4 id="åº”å¯¹æ‰‹æ®µ"><a class="markdownIt-Anchor" href="#åº”å¯¹æ‰‹æ®µ"></a> åº”å¯¹æ‰‹æ®µ</h4>
<ul>
<li><strong>è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦</strong> - å°†ç”¨æˆ·æ‰€æä¾›çš„å†…å®¹è¿›è¡Œè¿‡æ»¤ï¼Œä»è€Œé¿å… HTML å’Œ Jascript ä»£ç çš„è¿è¡Œã€‚å¦‚ <code>&gt;</code> è½¬ä¹‰ä¸º <code>&amp;gt</code>ã€<code>&lt;</code> è½¬ä¹‰ä¸º <code>&amp;lt</code> ç­‰ï¼Œå°±å¯ä»¥é˜²æ­¢å¤§éƒ¨åˆ†æ”»å‡»ã€‚ä¸ºäº†é¿å…å¯¹ä¸å¿…è¦çš„å†…å®¹é”™è¯¯è½¬ç§»ï¼Œå¦‚ <code>3&lt;5</code> ä¸­çš„ <code>&lt;</code> éœ€è¦è¿›è¡Œæ–‡æœ¬åŒ¹é…åå†è½¬ç§»ï¼Œå¦‚ï¼š<code>&lt;img src=</code> è¿™æ ·çš„ä¸Šä¸‹æ–‡ä¸­çš„ <code>&lt;</code> æ‰è½¬ä¹‰ã€‚</li>
<li><strong>è®¾ç½® Cookie ä¸º HttpOnly</strong> - è®¾ç½®äº† HttpOnly çš„ Cookie å¯ä»¥é˜²æ­¢ JavaScript è„šæœ¬è°ƒç”¨ï¼Œå°±æ— æ³•é€šè¿‡ document.cookie è·å–ç”¨æˆ· Cookie ä¿¡æ¯ã€‚</li>
</ul>
<blockquote>
<p>ğŸ‘‰ å‚è€ƒé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%B6%B2%E7%AB%99%E6%8C%87%E4%BB%A4%E7%A2%BC" target="_blank" rel="noopener">Wiki è¯æ¡ - è·¨ç«™è„šæœ¬</a></li>
<li><a href="https://www.cnblogs.com/TankXiao/archive/2012/03/21/2337194.html" target="_blank" rel="noopener">Web å®‰å…¨æµ‹è¯•ä¹‹ XSS</a></li>
</ul>
</blockquote>
<h3 id="csrf"><a class="markdownIt-Anchor" href="#csrf"></a> CSRF</h3>
<h4 id="æ¦‚å¿µ-2"><a class="markdownIt-Anchor" href="#æ¦‚å¿µ-2"></a> æ¦‚å¿µ</h4>
<p><strong><code>è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCross-site request forgeryï¼ŒCSRFï¼‰</code></strong>ï¼Œä¹Ÿè¢«ç§°ä¸º one-click attack æˆ–è€… session ridingï¼Œé€šå¸¸ç¼©å†™ä¸º CSRF æˆ–è€… XSRFã€‚å®ƒæ˜¯ä¸€ç§æŒŸæŒç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„ Web åº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ã€‚å’Œè·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰ç›¸æ¯”ï¼ŒXSS åˆ©ç”¨çš„æ˜¯ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼ŒCSRF åˆ©ç”¨çš„æ˜¯ç½‘ç«™å¯¹ç”¨æˆ·ç½‘é¡µæµè§ˆå™¨çš„ä¿¡ä»»ã€‚</p>
<h4 id="æ”»å‡»æ‰‹æ®µå’Œç›®çš„-2"><a class="markdownIt-Anchor" href="#æ”»å‡»æ‰‹æ®µå’Œç›®çš„-2"></a> æ”»å‡»æ‰‹æ®µå’Œç›®çš„</h4>
<p>å¯ä»¥å¦‚æ­¤ç†è§£ CSRFï¼šæ”»å‡»è€…ç›—ç”¨äº†ä½ çš„èº«ä»½ï¼Œä»¥ä½ çš„åä¹‰å‘é€æ¶æ„è¯·æ±‚ã€‚</p>
<p>CSRF èƒ½åšçš„äº‹å¤ªå¤šï¼š</p>
<ul>
<li>ä»¥ä½ åä¹‰å‘é€é‚®ä»¶ï¼Œå‘æ¶ˆæ¯</li>
<li>ç”¨ä½ çš„è´¦å·è´­ä¹°å•†å“</li>
<li>ç”¨ä½ çš„åä¹‰å®Œæˆè™šæ‹Ÿè´§å¸è½¬è´¦</li>
<li>æ³„éœ²ä¸ªäººéšç§</li>
<li>â€¦</li>
</ul>
<h4 id="åº”å¯¹æ‰‹æ®µ-2"><a class="markdownIt-Anchor" href="#åº”å¯¹æ‰‹æ®µ-2"></a> åº”å¯¹æ‰‹æ®µ</h4>
<ul>
<li><strong>è¡¨å• Token</strong> - CSRF æ˜¯ä¸€ä¸ªä¼ªé€ ç”¨æˆ·è¯·æ±‚çš„æ“ä½œï¼Œæ‰€ä»¥éœ€è¦æ„é€ ç”¨æˆ·è¯·æ±‚çš„æ‰€æœ‰å‚æ•°æ‰å¯ä»¥ã€‚è¡¨å• Token é€šè¿‡åœ¨è¯·æ±‚å‚æ•°ä¸­æ·»åŠ éšæœºæ•°çš„åŠæ³•æ¥é˜»æ­¢æ”»å‡»è€…è·å¾—æ‰€æœ‰è¯·æ±‚å‚æ•°ã€‚</li>
<li><strong>éªŒè¯ç </strong> - è¯·æ±‚æäº¤æ—¶ï¼Œéœ€è¦ç”¨æˆ·è¾“å…¥éªŒè¯ç ï¼Œä»¥é¿å…ç”¨æˆ·åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹è¢«æ”»å‡»è€…ä¼ªé€ è¯·æ±‚ã€‚</li>
<li><strong>Referer check</strong> - HTTP è¯·æ±‚å¤´çš„ Referer åŸŸä¸­è®°å½•ç€è¯·æ±‚èµ„æºï¼Œå¯é€šè¿‡æ£€æŸ¥è¯·æ±‚æ¥æºï¼ŒéªŒè¯å…¶æ˜¯å¦åˆæ³•ã€‚</li>
</ul>
<blockquote>
<p>ğŸ‘‰ å‚è€ƒé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0" target="_blank" rel="noopener">Wiki è¯æ¡ - è·¨ç«™è¯·æ±‚ä¼ªé€ </a></li>
<li><a href="http://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html" target="_blank" rel="noopener">æµ…è°ˆ CSRF æ”»å‡»æ–¹å¼</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/22521378" target="_blank" rel="noopener">ã€Œæ¯æ—¥ä¸€é¢˜ã€CSRF æ˜¯ä»€ä¹ˆï¼Ÿ</a><a href="https://zhuanlan.zhihu.com/p/22521378" target="_blank" rel="noopener">ã€Œæ¯æ—¥ä¸€é¢˜ã€CSRF æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://www.jianshu.com/p/855395f9603b" target="_blank" rel="noopener">WEB å®‰å…¨ä¹‹-CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰</a></li>
</ul>
</blockquote>
<h3 id="sql-æ³¨å…¥"><a class="markdownIt-Anchor" href="#sql-æ³¨å…¥"></a> SQL æ³¨å…¥</h3>
<h4 id="æ¦‚å¿µ-3"><a class="markdownIt-Anchor" href="#æ¦‚å¿µ-3"></a> æ¦‚å¿µ</h4>
<p><strong><code>SQL æ³¨å…¥æ”»å‡»ï¼ˆSQL injectionï¼‰</code></strong>ï¼Œæ˜¯å‘ç”Ÿäºåº”ç”¨ç¨‹åºä¹‹æ•°æ®å±‚çš„å®‰å…¨æ¼æ´ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæ˜¯åœ¨è¾“å…¥çš„å­—ç¬¦ä¸²ä¹‹ä¸­æ³¨å…¥ SQL æŒ‡ä»¤ï¼Œåœ¨è®¾è®¡ä¸è‰¯çš„ç¨‹åºå½“ä¸­å¿½ç•¥äº†æ£€æŸ¥ï¼Œé‚£ä¹ˆè¿™äº›æ³¨å…¥è¿›å»çš„æŒ‡ä»¤å°±ä¼šè¢«æ•°æ®åº“æœåŠ¡å™¨è¯¯è®¤ä¸ºæ˜¯æ­£å¸¸çš„ SQL æŒ‡ä»¤è€Œè¿è¡Œï¼Œå› æ­¤é­åˆ°ç ´åæˆ–æ˜¯å…¥ä¾µã€‚</p>
<p>æ”»å‡»ç¤ºä¾‹ï¼š</p>
<p>è€ƒè™‘ä»¥ä¸‹ç®€å•çš„ç™»å½•è¡¨å•ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/login"</span> <span class="attr">method</span>=<span class="string">"POST"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>Username: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span>Password: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"ç™»é™†"</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çš„å¤„ç†é‡Œé¢çš„ SQL å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">username:=r.Form.Get("username")</span><br><span class="line">password:=r.Form.Get("password")</span><br><span class="line">sql:="<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> username=<span class="string">'"+username+"'</span> <span class="keyword">AND</span> <span class="keyword">password</span>=<span class="string">'"+password+"'</span><span class="string">"</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœç”¨æˆ·çš„è¾“å…¥çš„ç”¨æˆ·åå¦‚ä¸‹ï¼Œå¯†ç ä»»æ„</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">myuser' or 'foo' = 'foo' <span class="comment">--</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„ SQL å˜æˆäº†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> username=<span class="string">'myuser'</span> <span class="keyword">or</span> <span class="string">'foo'</span> = <span class="string">'foo'</span> <span class="comment">--'' AND password='xxx'</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ SQL é‡Œé¢ <code>--</code> æ˜¯æ³¨é‡Šæ ‡è®°ï¼Œæ‰€ä»¥æŸ¥è¯¢è¯­å¥ä¼šåœ¨æ­¤ä¸­æ–­ã€‚è¿™å°±è®©æ”»å‡»è€…åœ¨ä¸çŸ¥é“ä»»ä½•åˆæ³•ç”¨æˆ·åå’Œå¯†ç çš„æƒ…å†µä¸‹æˆåŠŸç™»å½•äº†ã€‚</p>
<p>å¯¹äº MSSQL è¿˜æœ‰æ›´åŠ å±é™©çš„ä¸€ç§ SQL æ³¨å…¥ï¼Œå°±æ˜¯æ§åˆ¶ç³»ç»Ÿï¼Œä¸‹é¢è¿™ä¸ªå¯æ€•çš„ä¾‹å­å°†æ¼”ç¤ºå¦‚ä½•åœ¨æŸäº›ç‰ˆæœ¬çš„ MSSQL æ•°æ®åº“ä¸Šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">sql:="<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%"+prod+"%'</span><span class="string">"</span></span><br><span class="line"><span class="string">Db.Exec(sql)</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ”»å‡»æäº¤ <code>a%' exec master..xp_cmdshell 'net user test testpass /ADD' --</code> ä½œä¸ºå˜é‡ prod çš„å€¼ï¼Œé‚£ä¹ˆ sql å°†ä¼šå˜æˆ</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">sql:="<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%a%'</span> exec master..xp_cmdshell <span class="string">'net user test testpass /ADD'</span><span class="comment">--%'"</span></span><br></pre></td></tr></table></figure>
<p>MSSQL æœåŠ¡å™¨ä¼šæ‰§è¡Œè¿™æ¡ SQL è¯­å¥ï¼ŒåŒ…æ‹¬å®ƒåé¢é‚£ä¸ªç”¨äºå‘ç³»ç»Ÿæ·»åŠ æ–°ç”¨æˆ·çš„å‘½ä»¤ã€‚å¦‚æœè¿™ä¸ªç¨‹åºæ˜¯ä»¥ sa è¿è¡Œè€Œ MSSQLSERVER æœåŠ¡åˆæœ‰è¶³å¤Ÿçš„æƒé™çš„è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è·å¾—ä¸€ä¸ªç³»ç»Ÿå¸å·æ¥è®¿é—®ä¸»æœºäº†ã€‚</p>
<p>è™½ç„¶ä»¥ä¸Šçš„ä¾‹å­æ˜¯é’ˆå¯¹æŸä¸€ç‰¹å®šçš„æ•°æ®åº“ç³»ç»Ÿçš„ï¼Œä½†æ˜¯è¿™å¹¶ä¸ä»£è¡¨ä¸èƒ½å¯¹å…¶å®ƒæ•°æ®åº“ç³»ç»Ÿå®æ–½ç±»ä¼¼çš„æ”»å‡»ã€‚é’ˆå¯¹è¿™ç§å®‰å…¨æ¼æ´ï¼Œåªè¦ä½¿ç”¨ä¸åŒæ–¹æ³•ï¼Œå„ç§æ•°æ®åº“éƒ½æœ‰å¯èƒ½é­æ®ƒã€‚</p>
<h4 id="æ”»å‡»æ‰‹æ®µå’Œç›®çš„-3"><a class="markdownIt-Anchor" href="#æ”»å‡»æ‰‹æ®µå’Œç›®çš„-3"></a> æ”»å‡»æ‰‹æ®µå’Œç›®çš„</h4>
<ul>
<li>æ•°æ®è¡¨ä¸­çš„æ•°æ®å¤–æ³„ï¼Œä¾‹å¦‚ä¸ªäººæœºå¯†æ•°æ®ï¼Œè´¦æˆ·æ•°æ®ï¼Œå¯†ç ç­‰ã€‚</li>
<li>æ•°æ®ç»“æ„è¢«é»‘å®¢æ¢çŸ¥ï¼Œå¾—ä»¥åšè¿›ä¸€æ­¥æ”»å‡»ï¼ˆä¾‹å¦‚ <code>SELECT * FROM sys.tables</code>ï¼‰ã€‚</li>
<li>æ•°æ®åº“æœåŠ¡å™¨è¢«æ”»å‡»ï¼Œç³»ç»Ÿç®¡ç†å‘˜è´¦æˆ·è¢«çªœæ”¹ï¼ˆä¾‹å¦‚ <code>ALTER LOGIN sa WITH PASSWORD='xxxxxx'</code>ï¼‰ã€‚</li>
<li>è·å–ç³»ç»Ÿè¾ƒé«˜æƒé™åï¼Œæœ‰å¯èƒ½å¾—ä»¥åœ¨ç½‘é¡µåŠ å…¥æ¶æ„é“¾æ¥ã€æ¶æ„ä»£ç ä»¥åŠ XSS ç­‰ã€‚</li>
<li>ç»ç”±æ•°æ®åº“æœåŠ¡å™¨æä¾›çš„æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè®©é»‘å®¢å¾—ä»¥ä¿®æ”¹æˆ–æ§åˆ¶æ“ä½œç³»ç»Ÿï¼ˆä¾‹å¦‚ xp_cmdshell &quot;net stop iisadmin&quot;å¯åœæ­¢æœåŠ¡å™¨çš„ IIS æœåŠ¡ï¼‰ã€‚</li>
<li>ç ´åç¡¬ç›˜æ•°æ®ï¼Œç˜«ç—ªå…¨ç³»ç»Ÿï¼ˆä¾‹å¦‚ xp_cmdshell â€œFORMAT C:â€ï¼‰ã€‚</li>
</ul>
<h4 id="åº”å¯¹æ‰‹æ®µ-3"><a class="markdownIt-Anchor" href="#åº”å¯¹æ‰‹æ®µ-3"></a> åº”å¯¹æ‰‹æ®µ</h4>
<ul>
<li><strong>ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢</strong> - å»ºè®®ä½¿ç”¨æ•°æ®åº“æä¾›çš„å‚æ•°åŒ–æŸ¥è¯¢æ¥å£ï¼Œå‚æ•°åŒ–çš„è¯­å¥ä½¿ç”¨å‚æ•°è€Œä¸æ˜¯å°†ç”¨æˆ·è¾“å…¥å˜é‡åµŒå…¥åˆ° SQL è¯­å¥ä¸­ï¼Œå³ä¸è¦ç›´æ¥æ‹¼æ¥ SQL è¯­å¥ã€‚ä¾‹å¦‚ä½¿ç”¨ database/sql é‡Œé¢çš„æŸ¥è¯¢å‡½æ•° <code>Prepare</code> å’Œ <code>Query</code> ï¼Œæˆ–è€… <code>Exec(query string, args ...interface{})</code>ã€‚</li>
<li><strong>å•å¼•å·è½¬æ¢</strong> - åœ¨ç»„åˆ SQL å­—ç¬¦ä¸²æ—¶ï¼Œå…ˆé’ˆå¯¹æ‰€ä¼ å…¥çš„å‚æ•°è¿›è¡Œå­—ç¬¦æ›¿æ¢ï¼ˆå°†å•å¼•å·å­—ç¬¦æ›¿æ¢ä¸ºè¿ç»­ 2 ä¸ªå•å¼•å·å­—ç¬¦ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>ğŸ‘‰ å‚è€ƒé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/SQL%E8%B3%87%E6%96%99%E9%9A%B1%E7%A2%BC%E6%94%BB%E6%93%8A" target="_blank" rel="noopener">Wiki è¯æ¡ - SQL æ³¨å…¥æ”»å‡»</a></li>
<li><a href="https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/09.4.md" target="_blank" rel="noopener">é¿å… SQL æ³¨å…¥</a></li>
<li><a href="http://blog.jobbole.com/83092/" target="_blank" rel="noopener">å®ä¾‹è®²è§£ SQL æ³¨å…¥æ”»å‡»</a></li>
</ul>
</blockquote>
<h3 id="dos"><a class="markdownIt-Anchor" href="#dos"></a> DoS</h3>
<p><strong><code>æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆdenial-of-service attack, DoSï¼‰äº¦ç§°æ´ªæ°´æ”»å‡»</code></strong>ï¼Œæ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»æ‰‹æ³•ï¼Œå…¶ç›®çš„åœ¨äºä½¿ç›®æ ‡ç”µè„‘çš„ç½‘ç»œæˆ–ç³»ç»Ÿèµ„æºè€—å°½ï¼Œä½¿æœåŠ¡æš‚æ—¶ä¸­æ–­æˆ–åœæ­¢ï¼Œå¯¼è‡´å…¶æ­£å¸¸ç”¨æˆ·æ— æ³•è®¿é—®ã€‚</p>
<p>å½“é»‘å®¢ä½¿ç”¨ç½‘ç»œä¸Šä¸¤ä¸ªæˆ–ä»¥ä¸Šè¢«æ”»é™·çš„ç”µè„‘ä½œä¸ºâ€œåƒµå°¸â€å‘ç‰¹å®šçš„ç›®æ ‡å‘åŠ¨â€œæ‹’ç»æœåŠ¡â€å¼æ”»å‡»æ—¶ï¼Œç§°ä¸ºåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆdistributed denial-of-service attackï¼Œç¼©å†™ï¼šDDoS attackã€DDoSï¼‰ã€‚</p>
<h4 id="æ”»å‡»æ–¹å¼"><a class="markdownIt-Anchor" href="#æ”»å‡»æ–¹å¼"></a> æ”»å‡»æ–¹å¼</h4>
<ul>
<li>å¸¦å®½æ¶ˆè€—å‹æ”»å‡»</li>
<li>èµ„æºæ¶ˆè€—å‹æ”»å‡»</li>
</ul>
<h4 id="åº”å¯¹æ‰‹æ®µ-4"><a class="markdownIt-Anchor" href="#åº”å¯¹æ‰‹æ®µ-4"></a> åº”å¯¹æ‰‹æ®µ</h4>
<ul>
<li><strong>é˜²ç«å¢™</strong> - å…è®¸æˆ–æ‹’ç»ç‰¹å®šé€šè®¯åè®®ï¼Œç«¯å£æˆ– IP åœ°å€ã€‚å½“æ”»å‡»ä»å°‘æ•°ä¸æ­£å¸¸çš„ IP åœ°å€å‘å‡ºæ—¶ï¼Œå¯ä»¥ç®€å•çš„ä½¿ç”¨æ‹’ç»è§„åˆ™é˜»æ­¢ä¸€åˆ‡ä»æ”»å‡»æº IP å‘å‡ºçš„é€šä¿¡ã€‚</li>
<li><strong>è·¯ç”±å™¨ã€äº¤æ¢æœº</strong> - å…·æœ‰é€Ÿåº¦é™åˆ¶å’Œè®¿é—®æ§åˆ¶èƒ½åŠ›ã€‚</li>
<li><strong>æµé‡æ¸…æ´—</strong> - é€šè¿‡é‡‡ç”¨æŠ— DDoS è½¯ä»¶å¤„ç†ï¼Œå°†æ­£å¸¸æµé‡å’Œæ¶æ„æµé‡åŒºåˆ†å¼€ã€‚</li>
</ul>
<blockquote>
<p>ğŸ‘‰ å‚è€ƒé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E9%98%BB%E6%96%B7%E6%9C%8D%E5%8B%99%E6%94%BB%E6%93%8A" target="_blank" rel="noopener">æ‹’ç»æœåŠ¡æ”»å‡»</a></li>
</ul>
</blockquote>
<h2 id="äº”-åŠ å¯†æŠ€æœ¯"><a class="markdownIt-Anchor" href="#äº”-åŠ å¯†æŠ€æœ¯"></a> äº”ã€åŠ å¯†æŠ€æœ¯</h2>
<p>å¯¹äºç½‘ç«™æ¥è¯´ï¼Œç”¨æˆ·ä¿¡æ¯ã€è´¦æˆ·ç­‰ç­‰æ•æ„Ÿæ•°æ®ä¸€æ—¦æ³„æ¼ï¼Œåæœä¸¥é‡ï¼Œæ‰€ä»¥ä¸ºäº†ä¿æŠ¤æ•°æ®ï¼Œåº”å¯¹è¿™äº›ä¿¡æ¯è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚</p>
<p>ä¿¡æ¯åŠ å¯†æŠ€æœ¯ä¸€èˆ¬åˆ†ä¸ºï¼š</p>
<ul>
<li>æ¶ˆæ¯æ‘˜è¦</li>
<li>åŠ å¯†ç®—æ³•
<ul>
<li>å¯¹ç§°åŠ å¯†</li>
<li>éå¯¹ç§°åŠ å¯†</li>
</ul>
</li>
<li>è¯ä¹¦</li>
</ul>
<h3 id="æ¶ˆæ¯æ‘˜è¦"><a class="markdownIt-Anchor" href="#æ¶ˆæ¯æ‘˜è¦"></a> æ¶ˆæ¯æ‘˜è¦</h3>
<p>å¸¸ç”¨æ•°å­—ç­¾åç®—æ³•ï¼šMD5ã€SHA ç­‰ã€‚</p>
<p>åº”ç”¨åœºæ™¯ï¼šå°†ç”¨æˆ·å¯†ç ä»¥æ¶ˆæ¯æ‘˜è¦å½¢å¼ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</p>
<blockquote>
<p>ğŸ‘‰ å‚è€ƒé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://github.com/dunwu/javacore/blob/master/docs/advanced/encode/java-message-digest.md" target="_blank" rel="noopener">æ¶ˆæ¯æ‘˜è¦</a></li>
</ul>
</blockquote>
<h3 id="åŠ å¯†ç®—æ³•"><a class="markdownIt-Anchor" href="#åŠ å¯†ç®—æ³•"></a> åŠ å¯†ç®—æ³•</h3>
<h4 id="å¯¹ç§°åŠ å¯†"><a class="markdownIt-Anchor" href="#å¯¹ç§°åŠ å¯†"></a> å¯¹ç§°åŠ å¯†</h4>
<p>å¯¹ç§°åŠ å¯†æŒ‡åŠ å¯†å’Œè§£å¯†æ‰€ä½¿ç”¨çš„å¯†é’¥æ˜¯åŒä¸€ä¸ªå¯†é’¥ã€‚</p>
<p>å¸¸ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•ï¼šDESã€AES ç­‰ã€‚</p>
<p>åº”ç”¨åœºæ™¯ï¼šCookie åŠ å¯†ã€é€šä¿¡æœºå¯†ç­‰ã€‚</p>
<h4 id="éå¯¹ç§°åŠ å¯†"><a class="markdownIt-Anchor" href="#éå¯¹ç§°åŠ å¯†"></a> éå¯¹ç§°åŠ å¯†</h4>
<p>éå¯¹ç§°åŠ å¯†æŒ‡åŠ å¯†å’Œè§£å¯†æ‰€ä½¿ç”¨çš„ä¸æ˜¯åŒä¸€ä¸ªå¯†é’¥ï¼Œè€Œæ˜¯ä¸€ä¸ªå…¬ç§é’¥å¯¹ã€‚ç”¨å…¬é’¥åŠ å¯†çš„ä¿¡æ¯å¿…é¡»ç”¨ç§é’¥æ‰èƒ½è§£å¼€ï¼›åä¹‹ï¼Œç”¨ç§é’¥åŠ å¯†çš„ä¿¡æ¯åªæœ‰ç”¨å…¬é’¥æ‰èƒ½è§£å¼€ã€‚</p>
<p>å¸¸ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼šRSA ç­‰ã€‚</p>
<p>åº”ç”¨åœºæ™¯ï¼šHTTPS ä¼ è¾“ä¸­æµè§ˆå™¨ä½¿ç”¨çš„æ•°å­—è¯ä¹¦å®è´¨ä¸Šæ˜¯ç»è¿‡æƒå¨æœºæ„è®¤è¯çš„éå¯¹ç§°åŠ å¯†å…¬é’¥ã€‚</p>
<blockquote>
<p>ğŸ‘‰ å‚è€ƒé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://github.com/dunwu/javacore/blob/master/docs/advanced/encode/java-encryption.md" target="_blank" rel="noopener">åŠ å¯†</a></li>
</ul>
</blockquote>
<h4 id="å¯†é’¥å®‰å…¨ç®¡ç†"><a class="markdownIt-Anchor" href="#å¯†é’¥å®‰å…¨ç®¡ç†"></a> å¯†é’¥å®‰å…¨ç®¡ç†</h4>
<p>ä¿è¯å¯†é’¥å®‰å…¨çš„æ–¹æ³•ï¼š</p>
<ol>
<li>æŠŠå¯†é’¥å’Œç®—æ³•æ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡å™¨ä¸Šï¼Œå¯¹å¤–æä¾›åŠ å¯†å’Œè§£å¯†æœåŠ¡ï¼Œåº”ç”¨ç³»ç»Ÿé€šè¿‡è°ƒç”¨è¿™ä¸ªæœåŠ¡ï¼Œå®ç°æ•°æ®çš„åŠ è§£å¯†ã€‚</li>
<li>æŠŠåŠ è§£å¯†ç®—æ³•æ”¾åœ¨åº”ç”¨ç³»ç»Ÿä¸­ï¼Œå¯†é’¥åˆ™æ”¾åœ¨ç‹¬ç«‹æœåŠ¡å™¨ä¸­ï¼Œä¸ºäº†æé«˜å¯†é’¥çš„å®‰å…¨æ€§ï¼Œå®é™…å­˜å‚¨æ—¶ï¼Œå¯†é’¥è¢«åˆ‡åˆ†æˆæ•°ç‰‡ï¼ŒåŠ å¯†ååˆ†åˆ«ä¿å­˜åœ¨ä¸åŒå­˜å‚¨ä»‹è´¨ä¸­ã€‚</li>
</ol>
<h3 id="è¯ä¹¦"><a class="markdownIt-Anchor" href="#è¯ä¹¦"></a> è¯ä¹¦</h3>
<p><strong>è¯ä¹¦å¯ä»¥ç§°ä¸ºä¿¡æ¯å®‰å…¨åŠ å¯†çš„ç»ˆææ‰‹æ®µ</strong>ã€‚å…¬å¼€å¯†é’¥è®¤è¯ï¼ˆè‹±è¯­ï¼šPublic key certificateï¼‰ï¼Œåˆç§°å…¬å¼€å¯†é’¥è¯ä¹¦ã€å…¬é’¥è¯ä¹¦ã€æ•°å­—è¯ä¹¦ï¼ˆdigital certificateï¼‰ã€æ•°å­—è®¤è¯ã€èº«ä»½è¯ä¹¦ï¼ˆidentity certificateï¼‰ã€ç”µå­è¯ä¹¦æˆ–å®‰å…¨è¯ä¹¦ï¼Œæ˜¯ç”¨äºå…¬å¼€å¯†é’¥åŸºç¡€å»ºè®¾çš„ç”µå­æ–‡ä»¶ï¼Œç”¨æ¥è¯æ˜å…¬å¼€å¯†é’¥æ‹¥æœ‰è€…çš„èº«ä»½ã€‚æ­¤æ–‡ä»¶åŒ…å«äº†å…¬é’¥ä¿¡æ¯ã€æ‹¥æœ‰è€…èº«ä»½ä¿¡æ¯ï¼ˆä¸»ä½“ï¼‰ã€ä»¥åŠæ•°å­—è¯ä¹¦è®¤è¯æœºæ„ï¼ˆå‘è¡Œè€…ï¼‰å¯¹è¿™ä»½æ–‡ä»¶çš„æ•°å­—ç­¾åï¼Œä»¥ä¿è¯è¿™ä¸ªæ–‡ä»¶çš„æ•´ä½“å†…å®¹æ­£ç¡®æ— è¯¯ã€‚</p>
<p>é€è¿‡ä¿¡ä»»æƒå¨æ•°å­—è¯ä¹¦è®¤è¯æœºæ„çš„æ ¹è¯ä¹¦ã€åŠå…¶ä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†ä½œæ•°å­—ç­¾åæ ¸å‘çš„å…¬å¼€å¯†é’¥è®¤è¯ï¼Œå½¢æˆä¿¡ä»»é“¾æ¶æ„ï¼Œå·²åœ¨ TLS å®ç°å¹¶åœ¨ä¸‡ç»´ç½‘çš„ HTTP ä»¥ HTTPSã€åœ¨ç”µå­é‚®ä»¶çš„ SMTP ä»¥ STARTTLS å¼•å…¥å¹¶å¹¿æ³›åº”ç”¨ã€‚</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¸¸è§çš„åº”ç”¨å±‚åè®® HTTPã€FTPã€Telnet æœ¬èº«ä¸ä¿è¯ä¿¡æ¯å®‰å…¨ã€‚ä½†æ˜¯åŠ å…¥äº† SSL/TLS åŠ å¯†æ•°æ®åŒ…æœºåˆ¶çš„ HTTPSã€FTPSã€Telnets æ˜¯ä¿¡æ¯å®‰å…¨çš„ã€‚ä¼ è¾“å±‚å®‰å…¨æ€§åè®®ï¼ˆTransport Layer Security, TLSï¼‰ï¼ŒåŠå…¶å‰èº«å®‰å…¨å¥—æ¥å±‚ï¼ˆSecure Sockets Layer, SSLï¼‰æ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œç›®çš„æ˜¯ä¸ºäº’è”ç½‘é€šä¿¡ï¼Œæä¾›å®‰å…¨åŠæ•°æ®å®Œæ•´æ€§ä¿éšœã€‚</p>
<h4 id="è¯ä¹¦åŸç†"><a class="markdownIt-Anchor" href="#è¯ä¹¦åŸç†"></a> è¯ä¹¦åŸç†</h4>
<p>SSL/TLS åè®®çš„åŸºæœ¬æ€è·¯æ˜¯é‡‡ç”¨å…¬é’¥åŠ å¯†æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢æˆ·ç«¯å…ˆå‘æœåŠ¡å™¨ç«¯ç´¢è¦å…¬é’¥ï¼Œç„¶åç”¨å…¬é’¥åŠ å¯†ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°å¯†æ–‡åï¼Œç”¨è‡ªå·±çš„ç§é’¥è§£å¯†ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<p>ï¼ˆ1ï¼‰<strong>å¦‚ä½•ä¿è¯å…¬é’¥ä¸è¢«ç¯¡æ”¹ï¼Ÿ</strong></p>
<p>è§£å†³æ–¹æ³•ï¼šå°†å…¬é’¥æ”¾åœ¨æ•°å­—è¯ä¹¦ä¸­ã€‚åªè¦è¯ä¹¦æ˜¯å¯ä¿¡çš„ï¼Œå…¬é’¥å°±æ˜¯å¯ä¿¡çš„ã€‚</p>
<p>ï¼ˆ2ï¼‰<strong>å…¬é’¥åŠ å¯†è®¡ç®—é‡å¤ªå¤§ï¼Œå¦‚ä½•å‡å°‘è€—ç”¨çš„æ—¶é—´ï¼Ÿ</strong></p>
<p>è§£å†³æ–¹æ³•ï¼šæ¯ä¸€æ¬¡å¯¹è¯ï¼ˆsessionï¼‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½ç”Ÿæˆä¸€ä¸ª&quot;å¯¹è¯å¯†é’¥&quot;ï¼ˆsession keyï¼‰ï¼Œç”¨å®ƒæ¥åŠ å¯†ä¿¡æ¯ã€‚ç”±äº&quot;å¯¹è¯å¯†é’¥&quot;æ˜¯å¯¹ç§°åŠ å¯†ï¼Œæ‰€ä»¥è¿ç®—é€Ÿåº¦éå¸¸å¿«ï¼Œè€ŒæœåŠ¡å™¨å…¬é’¥åªç”¨äºåŠ å¯†&quot;å¯¹è¯å¯†é’¥&quot;æœ¬èº«ï¼Œè¿™æ ·å°±å‡å°‘äº†åŠ å¯†è¿ç®—çš„æ¶ˆè€—æ—¶é—´ã€‚</p>
<p>SSL/TLS åè®®çš„åŸºæœ¬è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯ç´¢è¦å¹¶éªŒè¯å…¬é’¥ã€‚</li>
<li>åŒæ–¹åå•†ç”Ÿæˆ&quot;å¯¹è¯å¯†é’¥&quot;ã€‚</li>
<li>åŒæ–¹é‡‡ç”¨&quot;å¯¹è¯å¯†é’¥&quot;è¿›è¡ŒåŠ å¯†é€šä¿¡ã€‚</li>
</ol>
<blockquote>
<p>ğŸ‘‰ å‚è€ƒé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">ä¼ è¾“å±‚å®‰å…¨æ€§åè®®</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%85%AC%E9%96%8B%E9%87%91%E9%91%B0%E8%AA%8D%E8%AD%89" target="_blank" rel="noopener">å…¬å¼€å¯†é’¥è®¤è¯</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank" rel="noopener">SSL/TLS åè®®è¿è¡Œæœºåˆ¶çš„æ¦‚è¿°</a></li>
</ul>
</blockquote>
<h2 id="å…­-ä¿¡æ¯è¿‡æ»¤"><a class="markdownIt-Anchor" href="#å…­-ä¿¡æ¯è¿‡æ»¤"></a> å…­ã€ä¿¡æ¯è¿‡æ»¤</h2>
<p>åœ¨ç½‘ç»œä¸­ï¼Œå¹¿å‘Šå’Œåƒåœ¾ä¿¡æ¯å±¡è§ä¸é²œï¼Œæ³›æ»¥æˆç¾ã€‚</p>
<p>å¸¸è§çš„ä¿¡æ¯è¿‡æ»¤ä¸ååƒåœ¾æ‰‹æ®µæœ‰ï¼š</p>
<h3 id="æ–‡æœ¬åŒ¹é…"><a class="markdownIt-Anchor" href="#æ–‡æœ¬åŒ¹é…"></a> æ–‡æœ¬åŒ¹é…</h3>
<p>è§£å†³æ•æ„Ÿè¯è¿‡æ»¤ã€‚ç³»ç»Ÿç»´æŠ¤ä¸€ä»½æ•æ„Ÿè¯æ¸…å•ï¼Œå¦‚æœä¿¡æ¯ä¸­å«æœ‰æ•æ„Ÿè¯ï¼Œåˆ™è‡ªåŠ¨è¿›è¡Œè¿‡æ»¤æˆ–æ‹’ç»ä¿¡æ¯ã€‚</p>
<h3 id="é»‘åå•"><a class="markdownIt-Anchor" href="#é»‘åå•"></a> é»‘åå•</h3>
<p>é»‘åå•å°±æ˜¯å°†ä¸€äº›å·²ç»è¢«è¯†åˆ«å‡ºæœ‰è¿è§„è¡Œä¸ºçš„ IPã€åŸŸåã€é‚®ç®±ç­‰åŠ å…¥é»‘åå•ï¼Œæ‹’ç»å…¶è¯·æ±‚ã€‚</p>
<p>é»‘åå•å¯ä»¥é€šè¿‡ Hash è¡¨æ¥å®ç°ï¼Œæ–¹æ³•ç®€å•ï¼Œå¤æ‚åº¦å°ï¼Œé€‚äºä¸€èˆ¬åº”ç”¨åœºæ™¯ã€‚</p>
<p>ä½†å¦‚æœé»‘åå•åˆ—è¡¨éå¸¸å¤§æ—¶ï¼ŒHash è¡¨è¦å ç”¨å¾ˆå¤§çš„å†…å­˜ç©ºé—´ï¼Œè¿™æ—¶å°±ä¸å†ä½¿ç”¨äº†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨æ¥å®ç°ï¼Œå³é€šè¿‡ä¸€ä¸ªäºŒè¿›åˆ¶åˆ—è¡¨å’Œä¸€ç»„éšæœºæ•°æ˜ å°„å‡½æ•°æ¥å®ç°ã€‚</p>
<h3 id="åˆ†ç±»ç®—æ³•"><a class="markdownIt-Anchor" href="#åˆ†ç±»ç®—æ³•"></a> åˆ†ç±»ç®—æ³•</h3>
<p>å¯¹äºæµ·é‡ä¿¡æ¯ï¼Œéš¾ä»¥é€šè¿‡äººå·¥å»å®¡æ ¸ã€‚å¯¹å¹¿å‘Šè´´ã€‚</p>
<p>åƒåœ¾é‚®ä»¶ç­‰å†…å®¹çš„è¯†åˆ«æ¯”è¾ƒå¥½çš„è‡ªåŠ¨åŒ–æ–¹æ³•å°±æ˜¯é‡‡ç”¨åˆ†ç±»ç®—æ³•ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå³å°†æ‰¹é‡å·²åˆ†ç±»çš„æ ·æœ¬è¾“å…¥åˆ†ç±»ç®—æ³•è¿›è¡Œè®­ç»ƒï¼Œå¾—åˆ°ä¸€ä¸ªåˆ†ç±»æ¨¡å‹ï¼Œç„¶ååˆ©ç”¨åˆ†ç±»ç®—æ³•ç»“åˆåˆ†ç±»æ¨¡å‹å»å¯¹ä¿¡æ¯è¿›è¡Œè¯†åˆ«ã€‚æƒ³äº†è§£å…·ä½“åšæ³•ï¼Œéœ€è¦å»ç†è§£æœºå™¨å­¦ä¹ ç›¸å…³çŸ¥è¯†ã€‚</p>
<h2 id="ä¸ƒ-é£é™©æ§åˆ¶"><a class="markdownIt-Anchor" href="#ä¸ƒ-é£é™©æ§åˆ¶"></a> ä¸ƒã€é£é™©æ§åˆ¶</h2>
<p>ç½‘ç»œç»™å•†åŠ¡ã€é‡‘èé¢†åŸŸå¸¦æ¥æå¤§ä¾¿åˆ©çš„åŒæ—¶ï¼Œä¹Ÿå°†é£é™©å¸¦ç»™äº†å¯¹ç½‘ç»œå®‰å…¨ä¸€æ— æ‰€çŸ¥çš„äººä»¬ã€‚ç”±äºäº¤æ˜“åŒæ–¹ä¿¡æ¯çš„ä¸å¯¹ç­‰ï¼Œä½¿å¾—äº¤æ˜“å­˜åœ¨ç€é£é™©ï¼Œè€Œå½“äº¤æ˜“å‘ç”Ÿåœ¨ç½‘ç»œä¸Šæ—¶ï¼Œé£é™©å°±æ›´åŠ éš¾ä»¥æ§åˆ¶äº†ã€‚</p>
<h3 id="é£é™©ç§ç±»"><a class="markdownIt-Anchor" href="#é£é™©ç§ç±»"></a> é£é™©ç§ç±»</h3>
<ul>
<li>è´¦æˆ·é£é™© - ç›—ç”¨è´¦æˆ·ã€æ¶æ„æ³¨å†Œè´¦æˆ·ç­‰</li>
<li>ä¹°å®¶é£é™© - è™šå‡è¯¢ç›˜ã€æ¶æ„æ‹’æ”¶ã€æ¶æ„ä¸‹å•ã€é»„ç‰›å…šæŠ¢è´­çƒ­é—¨å•†å“ç­‰</li>
<li>å–å®¶é£é™© - è™šå‡å‘è´§ã€å‡ºå”®è¿ç¦å“ã€ä¾µæƒç­‰</li>
<li>äº¤æ˜“é£é™© - ä¿¡ç”¨å¡ç›—åˆ·ã€äº¤æ˜“æ¬ºè¯ˆã€æ´—é’±ã€å¥—ç°ã€ç”µä¿¡è¯ˆéª—ç­‰</li>
</ul>
<h3 id="é£é™©æ§åˆ¶æ‰‹æ®µ"><a class="markdownIt-Anchor" href="#é£é™©æ§åˆ¶æ‰‹æ®µ"></a> é£é™©æ§åˆ¶æ‰‹æ®µ</h3>
<p>å¤§å‹ç”µå•†ç½‘ç«™ç³»ç»Ÿæˆ–é‡‘èç³»ç»Ÿéƒ½é…å¤‡ä¸“ä¸šçš„é£æ§å›¢é˜Ÿè¿›è¡Œé£é™©æ§åˆ¶ã€‚é£é™©æ§åˆ¶æ‰‹æ®µæ—¢åŒ…æ‹¬äººå·¥å®¡æ ¸ä¹ŸåŒ…æ‹¬è‡ªåŠ¨å®¡æ ¸ã€‚</p>
<p>è‡ªåŠ¨é£æ§çš„æŠ€æœ¯æ‰‹æ®µä¸»è¦æœ‰è§„åˆ™å¼•æ“å’Œç»Ÿè®¡æ¨¡å‹ã€‚</p>
<h3 id="è§„åˆ™å¼•æ“"><a class="markdownIt-Anchor" href="#è§„åˆ™å¼•æ“"></a> è§„åˆ™å¼•æ“</h3>
<p>åœ¨äº¤æ˜“ä¸­ï¼Œä¹°å®¶ã€å–å®¶çš„æŸäº›æŒ‡æ ‡æ»¡è¶³ä¸€å®šæ¡ä»¶æ—¶ï¼Œå°±ä¼šè¢«è®¤ä¸ºå­˜åœ¨é£é™©ã€‚å¦‚ï¼šäº¤æ˜“é‡‘é¢è¶…è¿‡æŸä¸ªæ•°å€¼ï¼›ç”¨æˆ·æ¥è‡ªé»‘åå•ï¼›ç”¨æˆ·å’Œä¸Šæ¬¡ç™»å½•çš„åœ°å€è·ç¦»å·®è·å¾ˆå¤§ï¼›ç”¨æˆ·åœ¨ä¸€å®šæ—¶é—´å†…é¢‘ç¹äº¤æ˜“ç­‰ç­‰ã€‚</p>
<p>å¦‚æœä»¥ä¸Šè¿™äº›æ¡ä»¶éƒ½é€šè¿‡ if â€¦ else â€¦ å¼æ ·çš„ä»£ç å»å®ç°ï¼Œä»£ç ç»´æŠ¤ã€æ‰©å±•ä¼šéå¸¸ä¸ä¾¿ã€‚å› æ­¤ï¼Œå°±æœ‰äº†è§„åˆ™å¼•æ“æ¥å¤„ç†è¿™ç±»é—®é¢˜ã€‚è§„åˆ™å¼•æ“æ˜¯ä¸€ç§å°†ä¸šåŠ¡è§„åˆ™å’Œè§„åˆ™å¤„ç†é€»è¾‘ç›¸åˆ†ç¦»çš„æŠ€æœ¯ï¼Œä¸šåŠ¡è§„åˆ™ç”±è¿è¥äººå‘˜é€šè¿‡ç®¡ç†ç•Œé¢å»ç¼–è¾‘ï¼Œå®ç°æ— éœ€ä¿®æ”¹ä»£ç ï¼Œå³å¯å®æ—¶çš„ä½¿ç”¨æ–°è§„åˆ™ã€‚</p>
<h3 id="ç»Ÿè®¡æ¨¡å‹"><a class="markdownIt-Anchor" href="#ç»Ÿè®¡æ¨¡å‹"></a> ç»Ÿè®¡æ¨¡å‹</h3>
<p>è§„åˆ™å¼•æ“è™½ç„¶æŠ€æœ¯ç®€å•ï¼Œä½†æ˜¯éšç€è§„åˆ™ä¸æ–­å¢åŠ ï¼Œè§„æ¨¡è¶Šæ¥è¶Šå¤§ã€‚å¯èƒ½ä¼šå‡ºç°è§„åˆ™å†²çªï¼Œéš¾ä»¥ç»´æŠ¤çš„æƒ…å†µï¼Œå¹¶ä¸”è§„åˆ™è¶Šå¤šï¼Œæ€§èƒ½ä¹Ÿè¶Šå·®ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œå°±æœ‰äº†ç»Ÿè®¡æ¨¡å‹ã€‚ç»Ÿè®¡æ¨¡å‹ä¼šä½¿ç”¨åˆ†ç±»ç®—æ³•æˆ–æ›´å¤æ‚çš„æœºå™¨å­¦ä¹ ç®—æ³•è¿›è¡Œæ™ºèƒ½ç»Ÿè®¡ã€‚æ ¹æ®å†å²äº¤æ˜“ä¸­çš„ä¿¡æ¯è®­ç»ƒåˆ†ç±»ï¼Œç„¶åå°†ç»è¿‡é‡‡é›†åŠ å·¥åçš„äº¤æ˜“ä¿¡æ¯è¾“å…¥åˆ†ç±»ç®—æ³•ï¼Œå¾—åˆ°äº¤æ˜“é£é™©å€¼ï¼Œç„¶ååŸºäºæ­¤ï¼Œåšå‡ºé¢„æµ‹ã€‚</p>
<p>ç»è¿‡å……åˆ†è®­ç»ƒåçš„ç»Ÿè®¡æ¨¡å‹ï¼Œå‡†ç¡®ç‡ä¸ä½äºè§„åˆ™å¼•æ“ã€‚ä½†æ˜¯ï¼Œéœ€è¦æœ‰é¢†åŸŸä¸“å®¶ã€è¡Œä¸šä¸“å®¶ä»‹å…¥ï¼Œå»ºç«‹åˆç†çš„è®­ç»ƒæ¨¡å‹ï¼Œå¹¶ä¸æ–­ä¼˜åŒ–ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://item.jd.com/11322972.html" target="_blank" rel="noopener">ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%B6%B2%E7%AB%99%E6%8C%87%E4%BB%A4%E7%A2%BC" target="_blank" rel="noopener">Wiki è¯æ¡ - è·¨ç«™è„šæœ¬</a></li>
<li><a href="https://www.cnblogs.com/TankXiao/archive/2012/03/21/2337194.html" target="_blank" rel="noopener">Web å®‰å…¨æµ‹è¯•ä¹‹ XSS</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0" target="_blank" rel="noopener">Wiki è¯æ¡ - è·¨ç«™è¯·æ±‚ä¼ªé€ </a></li>
<li><a href="http://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html" target="_blank" rel="noopener">æµ…è°ˆ CSRF æ”»å‡»æ–¹å¼</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/22521378" target="_blank" rel="noopener">ã€Œæ¯æ—¥ä¸€é¢˜ã€CSRF æ˜¯ä»€ä¹ˆï¼Ÿ</a><a href="https://zhuanlan.zhihu.com/p/22521378" target="_blank" rel="noopener">ã€Œæ¯æ—¥ä¸€é¢˜ã€CSRF æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://www.jianshu.com/p/855395f9603b" target="_blank" rel="noopener">WEB å®‰å…¨ä¹‹-CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰</a></li>
<li><a href="https://zh.wikipedia.org/wiki/SQL%E8%B3%87%E6%96%99%E9%9A%B1%E7%A2%BC%E6%94%BB%E6%93%8A" target="_blank" rel="noopener">Wiki è¯æ¡ - SQL æ³¨å…¥æ”»å‡»</a></li>
<li><a href="https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/09.4.md" target="_blank" rel="noopener">é¿å… SQL æ³¨å…¥</a></li>
<li><a href="http://blog.jobbole.com/83092/" target="_blank" rel="noopener">å®ä¾‹è®²è§£ SQL æ³¨å…¥æ”»å‡»</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E9%98%BB%E6%96%B7%E6%9C%8D%E5%8B%99%E6%94%BB%E6%93%8A" target="_blank" rel="noopener">æ‹’ç»æœåŠ¡æ”»å‡»</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener">ä¼ è¾“å±‚å®‰å…¨æ€§åè®®</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E5%85%AC%E9%96%8B%E9%87%91%E9%91%B0%E8%AA%8D%E8%AD%89" target="_blank" rel="noopener">å…¬å¼€å¯†é’¥è®¤è¯</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank" rel="noopener">SSL/TLS åè®®è¿è¡Œæœºåˆ¶çš„æ¦‚è¿°</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html</a></li>
<li><a href="http://www.coin163.com/java/cas/cas.html" target="_blank" rel="noopener">CAS å®ç° SSO å•ç‚¹ç™»å½•åŸç†</a></li>
<li><a href="https://www.jianshu.com/p/ce0944b4a903" target="_blank" rel="noopener">æƒé™ç³»ç»Ÿè®¾è®¡æ¨¡å‹åˆ†æï¼ˆDACï¼ŒMACï¼ŒRBACï¼ŒABACï¼‰</a></li>
</ul>
]]></content>
      <categories>
        <category>è®¾è®¡</category>
        <category>æ¶æ„</category>
      </categories>
      <tags>
        <tag>è®¾è®¡</tag>
        <tag>æ¶æ„</tag>
        <tag>å®‰å…¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€ç¯‡æ–‡ç« è®©ä½ å½»åº•æŒæ¡ Python</title>
    <url>/blog/coding/python/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<h1 id="python-ç¼–ç¨‹"><a class="markdownIt-Anchor" href="#python-ç¼–ç¨‹"></a> Python ç¼–ç¨‹</h1>
<h2 id="è§£é‡Šå™¨"><a class="markdownIt-Anchor" href="#è§£é‡Šå™¨"></a> è§£é‡Šå™¨</h2>
<p>Linux/Unix çš„ç³»ç»Ÿä¸Šï¼ŒPython è§£é‡Šå™¨é€šå¸¸è¢«å®‰è£…åœ¨ <code>/usr/local/bin/python3.4</code> è¿™æ ·çš„æœ‰æ•ˆè·¯å¾„ï¼ˆç›®å½•ï¼‰é‡Œã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°†è·¯å¾„ <code>/usr/local/bin</code> æ·»åŠ åˆ°æ‚¨çš„ Linux/Unix æ“ä½œç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥é€šè¿‡ shell ç»ˆç«¯è¾“å…¥ä¸‹é¢çš„å‘½ä»¤æ¥å¯åŠ¨ Python ã€‚</p>
<p>åœ¨ Linux/Unix ç³»ç»Ÿä¸­ï¼Œä½ å¯ä»¥åœ¨è„šæœ¬é¡¶éƒ¨æ·»åŠ ä»¥ä¸‹å‘½ä»¤è®© Python è„šæœ¬å¯ä»¥åƒ SHELL è„šæœ¬ä¸€æ ·å¯ç›´æ¥æ‰§è¡Œï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python3.4</span></span><br></pre></td></tr></table></figure>
<h2 id="æ³¨é‡Š"><a class="markdownIt-Anchor" href="#æ³¨é‡Š"></a> æ³¨é‡Š</h2>
<p>Python ä¸­çš„æ³¨é‡Šæœ‰ä¸‰ç§å½¢å¼ï¼š</p>
<ul>
<li>ä»¥ <code>#</code> å¼€å¤´</li>
<li>ä»¥ <code>'''</code> å¼€å§‹ï¼Œä»¥ <code>'''</code> ç»“å°¾</li>
<li>ä»¥ <code>&quot;&quot;&quot;</code> å¼€å§‹ï¼Œä»¥ <code>&quot;&quot;&quot;</code> ç»“å°¾</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å•è¡Œæ³¨é‡Š</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">è¿™æ˜¯å¤šè¡Œæ³¨é‡Šï¼Œç”¨ä¸‰ä¸ªå•å¼•å·</span></span><br><span class="line"><span class="string">è¿™æ˜¯å¤šè¡Œæ³¨é‡Šï¼Œç”¨ä¸‰ä¸ªå•å¼•å·</span></span><br><span class="line"><span class="string">è¿™æ˜¯å¤šè¡Œæ³¨é‡Šï¼Œç”¨ä¸‰ä¸ªå•å¼•å·</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">è¿™æ˜¯å¤šè¡Œæ³¨é‡Šï¼Œç”¨ä¸‰ä¸ªåŒå¼•å·</span></span><br><span class="line"><span class="string">è¿™æ˜¯å¤šè¡Œæ³¨é‡Šï¼Œç”¨ä¸‰ä¸ªåŒå¼•å·</span></span><br><span class="line"><span class="string">è¿™æ˜¯å¤šè¡Œæ³¨é‡Šï¼Œç”¨ä¸‰ä¸ªåŒå¼•å·</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®ç±»å‹"><a class="markdownIt-Anchor" href="#æ•°æ®ç±»å‹"></a> æ•°æ®ç±»å‹</h2>
<p>Python3 ä¸­æœ‰å…­ä¸ªæ ‡å‡†çš„æ•°æ®ç±»å‹ï¼š</p>
<ul>
<li>Numbersï¼ˆæ•°å­—ï¼‰</li>
<li>Stringï¼ˆå­—ç¬¦ä¸²ï¼‰</li>
<li>Listï¼ˆåˆ—è¡¨ï¼‰</li>
<li>Tupleï¼ˆå…ƒç»„ï¼‰</li>
<li>Setsï¼ˆé›†åˆï¼‰</li>
<li>Dictionariesï¼ˆå­—å…¸ï¼‰</li>
</ul>
<h2 id="æ“ä½œç¬¦"><a class="markdownIt-Anchor" href="#æ“ä½œç¬¦"></a> æ“ä½œç¬¦</h2>
<p>Python è¯­è¨€æ”¯æŒä»¥ä¸‹ç±»å‹çš„è¿ç®—ç¬¦:</p>
<ul>
<li>
<p>ç®—æœ¯è¿ç®—ç¬¦</p>
</li>
<li>
<p>æ¯”è¾ƒï¼ˆå…³ç³»ï¼‰è¿ç®—ç¬¦</p>
</li>
<li>
<p>èµ‹å€¼è¿ç®—ç¬¦</p>
</li>
<li>
<p>é€»è¾‘è¿ç®—ç¬¦</p>
</li>
<li>
<p>ä½è¿ç®—ç¬¦</p>
</li>
<li>
<p>æˆå‘˜è¿ç®—ç¬¦</p>
</li>
<li>
<p>èº«ä»½è¿ç®—ç¬¦</p>
</li>
<li>
<p>è¿ç®—ç¬¦ä¼˜å…ˆçº§</p>
</li>
</ul>
<h3 id="ç®—æœ¯è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#ç®—æœ¯è¿ç®—ç¬¦"></a> ç®—æœ¯è¿ç®—ç¬¦</h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
<th>å®ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>åŠ  - ä¸¤ä¸ªå¯¹è±¡ç›¸åŠ </td>
<td>a + b è¾“å‡ºç»“æœ 31</td>
</tr>
<tr>
<td>-</td>
<td>å‡ - å¾—åˆ°è´Ÿæ•°æˆ–æ˜¯ä¸€ä¸ªæ•°å‡å»å¦ä¸€ä¸ªæ•°</td>
<td>a - b è¾“å‡ºç»“æœ -11</td>
</tr>
<tr>
<td>*</td>
<td>ä¹˜ - ä¸¤ä¸ªæ•°ç›¸ä¹˜æˆ–æ˜¯è¿”å›ä¸€ä¸ªè¢«é‡å¤è‹¥å¹²æ¬¡çš„å­—ç¬¦ä¸²</td>
<td>a * b è¾“å‡ºç»“æœ 210</td>
</tr>
<tr>
<td>/</td>
<td>é™¤ - x é™¤ä»¥ y</td>
<td>b / a è¾“å‡ºç»“æœ 2.1</td>
</tr>
<tr>
<td>%</td>
<td>å–æ¨¡ - è¿”å›é™¤æ³•çš„ä½™æ•°</td>
<td>b % a è¾“å‡ºç»“æœ 1</td>
</tr>
<tr>
<td>**</td>
<td>å¹‚ - è¿”å› x çš„ y æ¬¡å¹‚</td>
<td>a**b ä¸º 10 çš„ 21 æ¬¡æ–¹</td>
</tr>
<tr>
<td>//</td>
<td>å–æ•´é™¤ - è¿”å›å•†çš„æ•´æ•°éƒ¨åˆ†</td>
<td>9//2 è¾“å‡ºç»“æœ 4 , 9.0//2.0 è¾“å‡ºç»“æœ 4.0</td>
</tr>
</tbody>
</table>
<h3 id="æ¯”è¾ƒè¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#æ¯”è¾ƒè¿ç®—ç¬¦"></a> æ¯”è¾ƒè¿ç®—ç¬¦</h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
<th>å®ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>==</td>
<td>ç­‰äº - æ¯”è¾ƒå¯¹è±¡æ˜¯å¦ç›¸ç­‰</td>
<td>(a == b) è¿”å› Falseã€‚</td>
</tr>
<tr>
<td>!=</td>
<td>ä¸ç­‰äº - æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ä¸ç›¸ç­‰</td>
<td>(a != b) è¿”å› True.</td>
</tr>
<tr>
<td>&gt;</td>
<td>å¤§äº - è¿”å› x æ˜¯å¦å¤§äº y</td>
<td>(a &gt; b) è¿”å› Falseã€‚</td>
</tr>
<tr>
<td>&lt;</td>
<td>å°äº - è¿”å› x æ˜¯å¦å°äº yã€‚æ‰€æœ‰æ¯”è¾ƒè¿ç®—ç¬¦è¿”å› 1 è¡¨ç¤ºçœŸï¼Œè¿”å› 0 è¡¨ç¤ºå‡ã€‚è¿™åˆ†åˆ«ä¸ç‰¹æ®Šçš„å˜é‡ True å’Œ False ç­‰ä»·ã€‚æ³¨æ„ï¼Œè¿™äº›å˜é‡åçš„å¤§å†™ã€‚</td>
<td>(a &lt; b) è¿”å› Trueã€‚</td>
</tr>
<tr>
<td>&gt;=</td>
<td>å¤§äºç­‰äº - è¿”å› x æ˜¯å¦å¤§äºç­‰äº yã€‚</td>
<td>(a &gt;= b) è¿”å› Falseã€‚</td>
</tr>
<tr>
<td>&lt;=</td>
<td>å°äºç­‰äº - è¿”å› x æ˜¯å¦å°äºç­‰äº yã€‚</td>
<td>(a &lt;= b) è¿”å› Trueã€‚</td>
</tr>
</tbody>
</table>
<h3 id="èµ‹å€¼è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#èµ‹å€¼è¿ç®—ç¬¦"></a> èµ‹å€¼è¿ç®—ç¬¦</h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
<th>å®ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>=</td>
<td>ç®€å•çš„èµ‹å€¼è¿ç®—ç¬¦</td>
<td>c = a + b å°† a + b çš„è¿ç®—ç»“æœèµ‹å€¼ä¸º c</td>
</tr>
<tr>
<td>+=</td>
<td>åŠ æ³•èµ‹å€¼è¿ç®—ç¬¦</td>
<td>c += a ç­‰æ•ˆäº c = c + a</td>
</tr>
<tr>
<td>-=</td>
<td>å‡æ³•èµ‹å€¼è¿ç®—ç¬¦</td>
<td>c -= a ç­‰æ•ˆäº c = c - a</td>
</tr>
<tr>
<td>*=</td>
<td>ä¹˜æ³•èµ‹å€¼è¿ç®—ç¬¦</td>
<td>c _= a ç­‰æ•ˆäº c = c _ a</td>
</tr>
<tr>
<td>/=</td>
<td>é™¤æ³•èµ‹å€¼è¿ç®—ç¬¦</td>
<td>c /= a ç­‰æ•ˆäº c = c / a</td>
</tr>
<tr>
<td>%=</td>
<td>å–æ¨¡èµ‹å€¼è¿ç®—ç¬¦</td>
<td>c %= a ç­‰æ•ˆäº c = c % a</td>
</tr>
<tr>
<td>**=</td>
<td>å¹‚èµ‹å€¼è¿ç®—ç¬¦</td>
<td>c **= a ç­‰æ•ˆäº c = c ** a</td>
</tr>
<tr>
<td>//=</td>
<td>å–æ•´é™¤èµ‹å€¼è¿ç®—ç¬¦</td>
<td>c //= a ç­‰æ•ˆäº c = c // a</td>
</tr>
</tbody>
</table>
<h3 id="ä½è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#ä½è¿ç®—ç¬¦"></a> ä½è¿ç®—ç¬¦</h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
<th>å®ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;</td>
<td>æŒ‰ä½ä¸è¿ç®—ç¬¦ï¼šå‚ä¸è¿ç®—çš„ä¸¤ä¸ªå€¼,å¦‚æœä¸¤ä¸ªç›¸åº”ä½éƒ½ä¸º 1,åˆ™è¯¥ä½çš„ç»“æœä¸º 1,å¦åˆ™ä¸º 0</td>
<td>(a &amp; b) è¾“å‡ºç»“æœ 12 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 0000 1100</td>
</tr>
<tr>
<td>|</td>
<td>æŒ‰ä½æˆ–è¿ç®—ç¬¦ï¼šåªè¦å¯¹åº”çš„äºŒä¸ªäºŒè¿›ä½æœ‰ä¸€ä¸ªä¸º 1 æ—¶ï¼Œç»“æœä½å°±ä¸º 1ã€‚</td>
<td>(a | b) è¾“å‡ºç»“æœ 61 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 0011 1101</td>
</tr>
<tr>
<td>^</td>
<td>æŒ‰ä½å¼‚æˆ–è¿ç®—ç¬¦ï¼šå½“ä¸¤å¯¹åº”çš„äºŒè¿›ä½ç›¸å¼‚æ—¶ï¼Œç»“æœä¸º 1</td>
<td>(a ^ b) è¾“å‡ºç»“æœ 49 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 0011 0001</td>
</tr>
<tr>
<td>~</td>
<td>æŒ‰ä½å–åè¿ç®—ç¬¦ï¼šå¯¹æ•°æ®çš„æ¯ä¸ªäºŒè¿›åˆ¶ä½å–å,å³æŠŠ 1 å˜ä¸º 0,æŠŠ 0 å˜ä¸º 1</td>
<td>(~a ) è¾“å‡ºç»“æœ -61 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 1100 0011ï¼Œ åœ¨ä¸€ä¸ªæœ‰ç¬¦å·äºŒè¿›åˆ¶æ•°çš„è¡¥ç å½¢å¼ã€‚</td>
</tr>
<tr>
<td>&lt;&lt;</td>
<td>å·¦ç§»åŠ¨è¿ç®—ç¬¦ï¼šè¿ç®—æ•°çš„å„äºŒè¿›ä½å…¨éƒ¨å·¦ç§»è‹¥å¹²ä½ï¼Œç”±&quot;&lt;&lt;&quot;å³è¾¹çš„æ•°æŒ‡å®šç§»åŠ¨çš„ä½æ•°ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥ 0ã€‚</td>
<td>a &lt;&lt; 2 è¾“å‡ºç»“æœ 240 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 1111 0000</td>
</tr>
<tr>
<td>&gt;&gt;</td>
<td>å³ç§»åŠ¨è¿ç®—ç¬¦ï¼šæŠŠ&quot;&gt;&gt;â€œå·¦è¾¹çš„è¿ç®—æ•°çš„å„äºŒè¿›ä½å…¨éƒ¨å³ç§»è‹¥å¹²ä½ï¼Œâ€&gt;&gt;&quot;å³è¾¹çš„æ•°æŒ‡å®šç§»åŠ¨çš„ä½æ•°</td>
<td>a &gt;&gt; 2 è¾“å‡ºç»“æœ 15 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 0000 1111</td>
</tr>
</tbody>
</table>
<h3 id="é€»è¾‘è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#é€»è¾‘è¿ç®—ç¬¦"></a> é€»è¾‘è¿ç®—ç¬¦</h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>é€»è¾‘è¡¨è¾¾å¼</th>
<th>æè¿°</th>
<th>å®ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>x and y</td>
<td>å¸ƒå°”&quot;ä¸&quot; - å¦‚æœ x ä¸º Falseï¼Œx and y è¿”å› Falseï¼Œå¦åˆ™å®ƒè¿”å› y çš„è®¡ç®—å€¼ã€‚</td>
<td>(a and b) è¿”å› 20ã€‚</td>
</tr>
<tr>
<td>or</td>
<td>x or y</td>
<td>å¸ƒå°”&quot;æˆ–&quot; - å¦‚æœ x æ˜¯ Trueï¼Œå®ƒè¿”å› x çš„å€¼ï¼Œå¦åˆ™å®ƒè¿”å› y çš„è®¡ç®—å€¼ã€‚</td>
<td>(a or b) è¿”å› 10ã€‚</td>
</tr>
<tr>
<td>not</td>
<td>not x</td>
<td>å¸ƒå°”&quot;é&quot; - å¦‚æœ x ä¸º Trueï¼Œè¿”å› False ã€‚å¦‚æœ x ä¸º Falseï¼Œå®ƒè¿”å› Trueã€‚</td>
<td>not(a and b) è¿”å› False</td>
</tr>
</tbody>
</table>
<h3 id="æˆå‘˜è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#æˆå‘˜è¿ç®—ç¬¦"></a> æˆå‘˜è¿ç®—ç¬¦</h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
<th>å®ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>in</td>
<td>å¦‚æœåœ¨æŒ‡å®šçš„åºåˆ—ä¸­æ‰¾åˆ°å€¼è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</td>
<td>x åœ¨ y åºåˆ—ä¸­ , å¦‚æœ x åœ¨ y åºåˆ—ä¸­è¿”å› Trueã€‚</td>
</tr>
<tr>
<td>not in</td>
<td>å¦‚æœåœ¨æŒ‡å®šçš„åºåˆ—ä¸­æ²¡æœ‰æ‰¾åˆ°å€¼è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</td>
<td>x ä¸åœ¨ y åºåˆ—ä¸­ , å¦‚æœ x ä¸åœ¨ y åºåˆ—ä¸­è¿”å› Trueã€‚</td>
</tr>
</tbody>
</table>
<h3 id="èº«ä»½è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#èº«ä»½è¿ç®—ç¬¦"></a> èº«ä»½è¿ç®—ç¬¦</h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
<th>å®ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>is</td>
<td>is æ˜¯åˆ¤æ–­ä¸¤ä¸ªæ ‡è¯†ç¬¦æ˜¯ä¸æ˜¯å¼•ç”¨è‡ªä¸€ä¸ªå¯¹è±¡</td>
<td>x is y, å¦‚æœ id(x) ç­‰äº id(y) , <strong>is</strong> è¿”å›ç»“æœ 1</td>
</tr>
<tr>
<td>is not</td>
<td>is not æ˜¯åˆ¤æ–­ä¸¤ä¸ªæ ‡è¯†ç¬¦æ˜¯ä¸æ˜¯å¼•ç”¨è‡ªä¸åŒå¯¹è±¡</td>
<td>x is not y, å¦‚æœ id(x) ä¸ç­‰äº id(y). <strong>is not</strong> è¿”å›ç»“æœ 1</td>
</tr>
</tbody>
</table>
<h3 id="è¿ç®—ç¬¦ä¼˜å…ˆçº§"><a class="markdownIt-Anchor" href="#è¿ç®—ç¬¦ä¼˜å…ˆçº§"></a> è¿ç®—ç¬¦ä¼˜å…ˆçº§</h3>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>**</td>
<td>æŒ‡æ•° (æœ€é«˜ä¼˜å…ˆçº§)</td>
</tr>
<tr>
<td>~ + -</td>
<td>æŒ‰ä½ç¿»è½¬, ä¸€å…ƒåŠ å·å’Œå‡å· (æœ€åä¸¤ä¸ªçš„æ–¹æ³•åä¸º +@ å’Œ -@)</td>
</tr>
<tr>
<td>* / % //</td>
<td>ä¹˜ï¼Œé™¤ï¼Œå–æ¨¡å’Œå–æ•´é™¤</td>
</tr>
<tr>
<td>+ -</td>
<td>åŠ æ³•å‡æ³•</td>
</tr>
<tr>
<td>&gt;&gt; &lt;&lt;</td>
<td>å³ç§»ï¼Œå·¦ç§»è¿ç®—ç¬¦</td>
</tr>
<tr>
<td>&amp;</td>
<td>ä½ â€˜ANDâ€™</td>
</tr>
<tr>
<td>^ |</td>
<td>ä½è¿ç®—ç¬¦</td>
</tr>
<tr>
<td>&lt;= &lt; &gt; &gt;=</td>
<td>æ¯”è¾ƒè¿ç®—ç¬¦</td>
</tr>
<tr>
<td>&lt;&gt; == !=</td>
<td>ç­‰äºè¿ç®—ç¬¦</td>
</tr>
<tr>
<td>= %= /= //= -= += *= **=</td>
<td>èµ‹å€¼è¿ç®—ç¬¦</td>
</tr>
<tr>
<td>is is not</td>
<td>èº«ä»½è¿ç®—ç¬¦</td>
</tr>
<tr>
<td>in not in</td>
<td>æˆå‘˜è¿ç®—ç¬¦</td>
</tr>
<tr>
<td>not or and</td>
<td>é€»è¾‘è¿ç®—ç¬¦</td>
</tr>
</tbody>
</table>
<h2 id="æ§åˆ¶è¯­å¥"><a class="markdownIt-Anchor" href="#æ§åˆ¶è¯­å¥"></a> æ§åˆ¶è¯­å¥</h2>
<h3 id="æ¡ä»¶è¯­å¥"><a class="markdownIt-Anchor" href="#æ¡ä»¶è¯­å¥"></a> æ¡ä»¶è¯­å¥</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> condition_1:</span><br><span class="line">    statement_block_1</span><br><span class="line"><span class="keyword">elif</span> condition_2:</span><br><span class="line">    statement_block_2</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    statement_block_3</span><br></pre></td></tr></table></figure>
<h3 id="å¾ªç¯è¯­å¥"><a class="markdownIt-Anchor" href="#å¾ªç¯è¯­å¥"></a> å¾ªç¯è¯­å¥</h3>
<h4 id="while"><a class="markdownIt-Anchor" href="#while"></a> while</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> åˆ¤æ–­æ¡ä»¶ï¼š</span><br><span class="line">    statements</span><br></pre></td></tr></table></figure>
<h4 id="for"><a class="markdownIt-Anchor" href="#for"></a> for</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> &lt;variable&gt; <span class="keyword">in</span> &lt;sequence&gt;:</span><br><span class="line">  &lt;statements&gt;</span><br></pre></td></tr></table></figure>
<h4 id="range"><a class="markdownIt-Anchor" href="#range"></a> range()</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">10</span>, <span class="number">3</span>) :</span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>
<h4 id="break-å’Œ-continue"><a class="markdownIt-Anchor" href="#break-å’Œ-continue"></a> break å’Œ continue</h4>
<ul>
<li>break è¯­å¥å¯ä»¥è·³å‡º for å’Œ while çš„å¾ªç¯ä½“ã€‚</li>
<li>continue è¯­å¥è¢«ç”¨æ¥å‘Šè¯‰ Python è·³è¿‡å½“å‰å¾ªç¯å—ä¸­çš„å‰©ä½™è¯­å¥ï¼Œç„¶åç»§ç»­è¿›è¡Œä¸‹ä¸€è½®å¾ªç¯ã€‚</li>
</ul>
<h4 id="pass"><a class="markdownIt-Anchor" href="#pass"></a> pass</h4>
<p>pass è¯­å¥ä»€ä¹ˆéƒ½ä¸åšã€‚å®ƒåªåœ¨è¯­æ³•ä¸Šéœ€è¦ä¸€æ¡è¯­å¥ä½†ç¨‹åºä¸éœ€è¦ä»»ä½•æ“ä½œæ—¶ä½¿ç”¨.ä¾‹å¦‚:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">pass</span>  <span class="comment"># ç­‰å¾…é”®ç›˜ä¸­æ–­ (Ctrl+C)</span></span><br></pre></td></tr></table></figure>
<h2 id="å‡½æ•°"><a class="markdownIt-Anchor" href="#å‡½æ•°"></a> å‡½æ•°</h2>
<p>Python å®šä¹‰å‡½æ•°ä½¿ç”¨ def å…³é”®å­—ï¼Œä¸€èˆ¬æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span>  å‡½æ•°åï¼ˆå‚æ•°åˆ—è¡¨ï¼‰ï¼š</span></span><br><span class="line"><span class="function">    å‡½æ•°ä½“</span></span><br></pre></td></tr></table></figure>
<h3 id="å‡½æ•°å˜é‡ä½œç”¨åŸŸ"><a class="markdownIt-Anchor" href="#å‡½æ•°å˜é‡ä½œç”¨åŸŸ"></a> å‡½æ•°å˜é‡ä½œç”¨åŸŸ</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">a = <span class="number">4</span>  <span class="comment"># å…¨å±€å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_func1</span><span class="params">()</span>:</span></span><br><span class="line">    a = <span class="number">17</span> <span class="comment"># å±€éƒ¨å˜é‡</span></span><br><span class="line">    print(<span class="string">"in print_func a = "</span>, a)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_func2</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"in print_func a = "</span>, a)</span><br><span class="line">print_func1()</span><br><span class="line">print_func2()</span><br><span class="line">print(<span class="string">"a = "</span>, a)</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå®ä¾‹è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">in</span> print_func a =  <span class="number">17</span></span><br><span class="line"><span class="keyword">in</span> print_func a =  <span class="number">4</span></span><br><span class="line">a =  <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h3 id="å…³é”®å­—å‚æ•°"><a class="markdownIt-Anchor" href="#å…³é”®å­—å‚æ•°"></a> å…³é”®å­—å‚æ•°</h3>
<p>å‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨ kwarg=value çš„å…³é”®å­—å‚æ•°å½¢å¼è¢«è°ƒç”¨.ä¾‹å¦‚,ä»¥ä¸‹å‡½æ•°:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parrot</span><span class="params">(voltage, state=<span class="string">'a stiff'</span>, action=<span class="string">'voom'</span>, type=<span class="string">'Norwegian Blue'</span>)</span>:</span></span><br><span class="line">    print(<span class="string">"-- This parrot wouldn't"</span>, action, end=<span class="string">' '</span>)</span><br><span class="line">    print(<span class="string">"if you put"</span>, voltage, <span class="string">"volts through it."</span>)</span><br><span class="line">    print(<span class="string">"-- Lovely plumage, the"</span>, type)</span><br><span class="line">    print(<span class="string">"-- It's"</span>, state, <span class="string">"!"</span>)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä»¥ä¸‹å‡ ç§æ–¹å¼è¢«è°ƒç”¨:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">parrot(<span class="number">1000</span>)                                          <span class="comment"># 1 positional argument</span></span><br><span class="line">parrot(voltage=<span class="number">1000</span>)                                  <span class="comment"># 1 keyword argument</span></span><br><span class="line">parrot(voltage=<span class="number">1000000</span>, action=<span class="string">'VOOOOOM'</span>)             <span class="comment"># 2 keyword arguments</span></span><br><span class="line">parrot(action=<span class="string">'VOOOOOM'</span>, voltage=<span class="number">1000000</span>)             <span class="comment"># 2 keyword arguments</span></span><br><span class="line">parrot(<span class="string">'a million'</span>, <span class="string">'bereft of life'</span>, <span class="string">'jump'</span>)         <span class="comment"># 3 positional arguments</span></span><br><span class="line">parrot(<span class="string">'a thousand'</span>, state=<span class="string">'pushing up the daisies'</span>)  <span class="comment"># 1 positional, 1 keyword</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹ä¸ºé”™è¯¯è°ƒç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">parrot<span class="params">()</span>                     <span class="comment"># required argument missing</span></span><br><span class="line">parrot<span class="params">(<span class="attr">voltage</span>=5.0, 'dead')</span>  <span class="comment"># non-keyword argument after a keyword argument</span></span><br><span class="line">parrot<span class="params">(110, <span class="attr">voltage</span>=220)</span>     <span class="comment"># duplicate value for the same argument</span></span><br><span class="line">parrot<span class="params">(<span class="attr">actor</span>='John Cleese')</span>  <span class="comment"># unknown keyword argument</span></span><br></pre></td></tr></table></figure>
<h3 id="å¯å˜å‚æ•°åˆ—è¡¨"><a class="markdownIt-Anchor" href="#å¯å˜å‚æ•°åˆ—è¡¨"></a> å¯å˜å‚æ•°åˆ—è¡¨</h3>
<p>æœ€å,ä¸€ä¸ªæœ€ä¸å¸¸ç”¨çš„é€‰æ‹©æ˜¯å¯ä»¥è®©å‡½æ•°è°ƒç”¨å¯å˜ä¸ªæ•°çš„å‚æ•°.è¿™äº›å‚æ•°è¢«åŒ…è£…è¿›ä¸€ä¸ªå…ƒç»„(æŸ¥çœ‹å…ƒç»„å’Œåºåˆ—).åœ¨è¿™äº›å¯å˜ä¸ªæ•°çš„å‚æ•°ä¹‹å‰,å¯ä»¥æœ‰é›¶åˆ°å¤šä¸ªæ™®é€šçš„å‚æ•°:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">arithmetic_mean</span><span class="params">(*args)</span>:</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> args:</span><br><span class="line">        sum += x</span><br><span class="line">    <span class="keyword">return</span> sum</span><br></pre></td></tr></table></figure>
<h3 id="è¿”å›å€¼"><a class="markdownIt-Anchor" href="#è¿”å›å€¼"></a> è¿”å›å€¼</h3>
<p>Python çš„å‡½æ•°çš„è¿”å›å€¼ä½¿ç”¨ return è¯­å¥ï¼Œå¯ä»¥å°†å‡½æ•°ä½œä¸ºä¸€ä¸ªå€¼èµ‹å€¼ç»™æŒ‡å®šå˜é‡ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">return_sum</span><span class="params">(x,y)</span>:</span></span><br><span class="line">    c = x + y</span><br><span class="line">    <span class="keyword">return</span> c</span><br></pre></td></tr></table></figure>
<h2 id="å¼‚å¸¸"><a class="markdownIt-Anchor" href="#å¼‚å¸¸"></a> å¼‚å¸¸</h2>
<h3 id="å¼‚å¸¸å¤„ç†"><a class="markdownIt-Anchor" href="#å¼‚å¸¸å¤„ç†"></a> å¼‚å¸¸å¤„ç†</h3>
<p>try è¯­å¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼å·¥ä½œï¼›</p>
<ul>
<li>é¦–å…ˆï¼Œæ‰§è¡Œ try å­å¥ï¼ˆåœ¨å…³é”®å­— try å’Œå…³é”®å­— except ä¹‹é—´çš„è¯­å¥ï¼‰</li>
<li>å¦‚æœæ²¡æœ‰å¼‚å¸¸å‘ç”Ÿï¼Œå¿½ç•¥ except å­å¥ï¼Œtry å­å¥æ‰§è¡Œåç»“æŸã€‚</li>
<li>å¦‚æœåœ¨æ‰§è¡Œ try å­å¥çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†å¼‚å¸¸ï¼Œé‚£ä¹ˆ try å­å¥ä½™ä¸‹çš„éƒ¨åˆ†å°†è¢«å¿½ç•¥ã€‚å¦‚æœå¼‚å¸¸çš„ç±»å‹å’Œ except ä¹‹åçš„åç§°ç›¸ç¬¦ï¼Œé‚£ä¹ˆå¯¹åº”çš„ except å­å¥å°†è¢«æ‰§è¡Œã€‚æœ€åæ‰§è¡Œ try è¯­å¥ä¹‹åçš„ä»£ç ã€‚</li>
<li>å¦‚æœä¸€ä¸ªå¼‚å¸¸æ²¡æœ‰ä¸ä»»ä½•çš„ except åŒ¹é…ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼‚å¸¸å°†ä¼šä¼ é€’ç»™ä¸Šå±‚çš„ try ä¸­ã€‚</li>
<li>ä¸ç®¡ try å­å¥é‡Œé¢æœ‰æ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ï¼Œfinally å­å¥éƒ½ä¼šæ‰§è¡Œã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    f = open(<span class="string">'myfile.txt'</span>)</span><br><span class="line">    s = f.readline()</span><br><span class="line">    i = int(s.strip())</span><br><span class="line"><span class="keyword">except</span> OSError <span class="keyword">as</span> err:</span><br><span class="line">    print(<span class="string">"OS error: &#123;0&#125;"</span>.format(err))</span><br><span class="line"><span class="keyword">except</span> ValueError:</span><br><span class="line">    print(<span class="string">"Could not convert data to an integer."</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"Unexpected error:"</span>, sys.exc_info()[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">raise</span></span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="comment"># æ¸…ç†è¡Œä¸º</span></span><br></pre></td></tr></table></figure>
<h3 id="æŠ›å‡ºå¼‚å¸¸"><a class="markdownIt-Anchor" href="#æŠ›å‡ºå¼‚å¸¸"></a> æŠ›å‡ºå¼‚å¸¸</h3>
<p>Python ä½¿ç”¨ raise è¯­å¥æŠ›å‡ºä¸€ä¸ªæŒ‡å®šçš„å¼‚å¸¸ã€‚ä¾‹å¦‚:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">raise</span> NameError(<span class="string">'HiThere'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File "&lt;stdin&gt;", line 1, in ?</span><br><span class="line">NameError: HiThere</span><br></pre></td></tr></table></figure>
<h3 id="è‡ªå®šä¹‰å¼‚å¸¸"><a class="markdownIt-Anchor" href="#è‡ªå®šä¹‰å¼‚å¸¸"></a> è‡ªå®šä¹‰å¼‚å¸¸</h3>
<p>å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„ exception ç±»æ¥æ‹¥æœ‰è‡ªå·±çš„å¼‚å¸¸ã€‚å¼‚å¸¸åº”è¯¥ç»§æ‰¿è‡ª Exception ç±»ï¼Œæˆ–è€…ç›´æ¥ç»§æ‰¿ï¼Œæˆ–è€…é—´æ¥ç»§æ‰¿ã€‚</p>
<p>å½“åˆ›å»ºä¸€ä¸ªæ¨¡å—æœ‰å¯èƒ½æŠ›å‡ºå¤šç§ä¸åŒçš„å¼‚å¸¸æ—¶ï¼Œä¸€ç§é€šå¸¸çš„åšæ³•æ˜¯ä¸ºè¿™ä¸ªåŒ…å»ºç«‹ä¸€ä¸ªåŸºç¡€å¼‚å¸¸ç±»ï¼Œç„¶ååŸºäºè¿™ä¸ªåŸºç¡€ç±»ä¸ºä¸åŒçš„é”™è¯¯æƒ…å†µåˆ›å»ºä¸åŒçš„å­ç±»ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Error</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="string">"""Base class for exceptions in this module."""</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InputError</span><span class="params">(Error)</span>:</span></span><br><span class="line">    <span class="string">"""Exception raised for errors in the input.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        expression -- input expression in which the error occurred</span></span><br><span class="line"><span class="string">        message -- explanation of the error</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, expression, message)</span>:</span></span><br><span class="line">        self.expression = expression</span><br><span class="line">        self.message = message</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TransitionError</span><span class="params">(Error)</span>:</span></span><br><span class="line">    <span class="string">"""Raised when an operation attempts a state transition that's not</span></span><br><span class="line"><span class="string">    allowed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        previous -- state at beginning of transition</span></span><br><span class="line"><span class="string">        next -- attempted new state</span></span><br><span class="line"><span class="string">        message -- explanation of why the specific transition is not allowed</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, previous, next, message)</span>:</span></span><br><span class="line">        self.previous = previous</span><br><span class="line">        self.next = next</span><br><span class="line">        self.message = message</span><br></pre></td></tr></table></figure>
<p>å¤§å¤šæ•°çš„å¼‚å¸¸çš„åå­—éƒ½ä»¥&quot;Error&quot;ç»“å°¾ï¼Œå°±è·Ÿæ ‡å‡†çš„å¼‚å¸¸å‘½åä¸€æ ·ã€‚</p>
<h2 id="é¢å‘å¯¹è±¡"><a class="markdownIt-Anchor" href="#é¢å‘å¯¹è±¡"></a> é¢å‘å¯¹è±¡</h2>
<h3 id="é¢å‘å¯¹è±¡æŠ€æœ¯ç®€ä»‹"><a class="markdownIt-Anchor" href="#é¢å‘å¯¹è±¡æŠ€æœ¯ç®€ä»‹"></a> é¢å‘å¯¹è±¡æŠ€æœ¯ç®€ä»‹</h3>
<ul>
<li>
<p><strong>ç±»(Class):</strong> ç”¨æ¥æè¿°å…·æœ‰ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•çš„å¯¹è±¡çš„é›†åˆã€‚å®ƒå®šä¹‰äº†è¯¥é›†åˆä¸­æ¯ä¸ªå¯¹è±¡æ‰€å…±æœ‰çš„å±æ€§å’Œæ–¹æ³•ã€‚å¯¹è±¡æ˜¯ç±»çš„å®ä¾‹ã€‚</p>
</li>
<li>
<p>**ç±»å˜é‡ï¼š**ç±»å˜é‡åœ¨æ•´ä¸ªå®ä¾‹åŒ–çš„å¯¹è±¡ä¸­æ˜¯å…¬ç”¨çš„ã€‚ç±»å˜é‡å®šä¹‰åœ¨ç±»ä¸­ä¸”åœ¨å‡½æ•°ä½“ä¹‹å¤–ã€‚ç±»å˜é‡é€šå¸¸ä¸ä½œä¸ºå®ä¾‹å˜é‡ä½¿ç”¨ã€‚</p>
</li>
<li>
<p>**æ•°æ®æˆå‘˜ï¼š**ç±»å˜é‡æˆ–è€…å®ä¾‹å˜é‡ç”¨äºå¤„ç†ç±»åŠå…¶å®ä¾‹å¯¹è±¡çš„ç›¸å…³çš„æ•°æ®ã€‚</p>
</li>
<li>
<p>**æ–¹æ³•é‡å†™ï¼š**å¦‚æœä»çˆ¶ç±»ç»§æ‰¿çš„æ–¹æ³•ä¸èƒ½æ»¡è¶³å­ç±»çš„éœ€æ±‚ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œæ”¹å†™ï¼Œè¿™ä¸ªè¿‡ç¨‹å«æ–¹æ³•çš„è¦†ç›–ï¼ˆoverrideï¼‰ï¼Œä¹Ÿç§°ä¸ºæ–¹æ³•çš„é‡å†™ã€‚</p>
</li>
<li>
<p>**å®ä¾‹å˜é‡ï¼š**å®šä¹‰åœ¨æ–¹æ³•ä¸­çš„å˜é‡ï¼Œåªä½œç”¨äºå½“å‰å®ä¾‹çš„ç±»ã€‚</p>
</li>
<li>
<p>**ç»§æ‰¿ï¼š**å³ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼ˆderived classï¼‰ç»§æ‰¿åŸºç±»ï¼ˆbase classï¼‰çš„å­—æ®µå’Œæ–¹æ³•ã€‚ç»§æ‰¿ä¹Ÿå…è®¸æŠŠä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ä½œä¸ºä¸€ä¸ªåŸºç±»å¯¹è±¡å¯¹å¾…ã€‚ä¾‹å¦‚ï¼Œæœ‰è¿™æ ·ä¸€ä¸ªè®¾è®¡ï¼šä¸€ä¸ª Dog ç±»å‹çš„å¯¹è±¡æ´¾ç”Ÿè‡ª Animal ç±»ï¼Œè¿™æ˜¯æ¨¡æ‹Ÿ&quot;æ˜¯ä¸€ä¸ªï¼ˆis-aï¼‰&quot;å…³ç³»ï¼ˆä¾‹å›¾ï¼ŒDog æ˜¯ä¸€ä¸ª Animalï¼‰ã€‚</p>
</li>
<li>
<p>**å®ä¾‹åŒ–ï¼š**åˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œç±»çš„å…·ä½“å¯¹è±¡ã€‚</p>
</li>
<li>
<p>**æ–¹æ³•ï¼š**ç±»ä¸­å®šä¹‰çš„å‡½æ•°ã€‚</p>
</li>
<li>
<p>**å¯¹è±¡ï¼š**é€šè¿‡ç±»å®šä¹‰çš„æ•°æ®ç»“æ„å®ä¾‹ã€‚å¯¹è±¡åŒ…æ‹¬ä¸¤ä¸ªæ•°æ®æˆå‘˜ï¼ˆç±»å˜é‡å’Œå®ä¾‹å˜é‡ï¼‰å’Œæ–¹æ³•ã€‚</p>
</li>
</ul>
<h3 id="ç±»å®šä¹‰"><a class="markdownIt-Anchor" href="#ç±»å®šä¹‰"></a> ç±»å®šä¹‰</h3>
<p>è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span>:</span></span><br><span class="line">    &lt;statement<span class="number">-1</span>&gt;</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    &lt;statement-N&gt;</span><br></pre></td></tr></table></figure>
<p>ç±»å®ä¾‹åŒ–åï¼Œå¯ä»¥ä½¿ç”¨å…¶å±æ€§ï¼Œå®é™…ä¸Šï¼Œåˆ›å»ºä¸€ä¸ªç±»ä¹‹åï¼Œå¯ä»¥é€šè¿‡ç±»åè®¿é—®å…¶å±æ€§ã€‚</p>
<h3 id="ç±»å¯¹è±¡"><a class="markdownIt-Anchor" href="#ç±»å¯¹è±¡"></a> ç±»å¯¹è±¡</h3>
<p>ç±»å¯¹è±¡æ”¯æŒä¸¤ç§æ“ä½œï¼šå±æ€§å¼•ç”¨å’Œå®ä¾‹åŒ–ã€‚</p>
<p>å±æ€§å¼•ç”¨ä½¿ç”¨å’Œ Python ä¸­æ‰€æœ‰çš„å±æ€§å¼•ç”¨ä¸€æ ·çš„æ ‡å‡†è¯­æ³•ï¼š<strong><a href="http://obj.name" target="_blank" rel="noopener">obj.name</a></strong>ã€‚</p>
<p>ç±»å¯¹è±¡åˆ›å»ºåï¼Œç±»å‘½åç©ºé—´ä¸­æ‰€æœ‰çš„å‘½åéƒ½æ˜¯æœ‰æ•ˆå±æ€§åã€‚æ‰€ä»¥å¦‚æœç±»å®šä¹‰æ˜¯è¿™æ ·:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></span><br><span class="line">    <span class="string">"""ä¸€ä¸ªç®€å•çš„ç±»å®ä¾‹"""</span></span><br><span class="line">    i = <span class="number">12345</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'hello world'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ç±»</span></span><br><span class="line">x = MyClass()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¿é—®ç±»çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">print(<span class="string">"MyClass ç±»çš„å±æ€§ i ä¸ºï¼š"</span>, x.i)</span><br><span class="line">print(<span class="string">"MyClass ç±»çš„æ–¹æ³• f è¾“å‡ºä¸ºï¼š"</span>, x.f())</span><br></pre></td></tr></table></figure>
<p>å®ä¾‹åŒ–ç±»ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®ä¾‹åŒ–ç±»</span></span><br><span class="line">x = MyClass()</span><br><span class="line"><span class="comment"># è®¿é—®ç±»çš„å±æ€§å’Œæ–¹æ³•</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç±»å®ä¾‹å¹¶å°†è¯¥å¯¹è±¡èµ‹ç»™å±€éƒ¨å˜é‡ xï¼Œx ä¸ºç©ºçš„å¯¹è±¡ã€‚</p>
<p>æ‰§è¡Œä»¥ä¸Šç¨‹åºè¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">MyClass</span> <span class="string">ç±»çš„å±æ€§ i ä¸ºï¼š 12345</span></span><br><span class="line"><span class="attr">MyClass</span> <span class="string">ç±»çš„æ–¹æ³• f è¾“å‡ºä¸ºï¼š hello world</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆå¤šç±»éƒ½å€¾å‘äºå°†å¯¹è±¡åˆ›å»ºä¸ºæœ‰åˆå§‹çŠ¶æ€çš„ã€‚å› æ­¤ç±»å¯èƒ½ä¼šå®šä¹‰ä¸€ä¸ªåä¸º <strong>init</strong>() çš„ç‰¹æ®Šæ–¹æ³•ï¼ˆæ„é€ æ–¹æ³•ï¼‰ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.data = []</span><br></pre></td></tr></table></figure>
<p>ç±»å®šä¹‰äº† <strong>init</strong>() æ–¹æ³•çš„è¯ï¼Œç±»çš„å®ä¾‹åŒ–æ“ä½œä¼šè‡ªåŠ¨è°ƒç”¨ <strong>init</strong>() æ–¹æ³•ã€‚æ‰€ä»¥åœ¨ä¸‹ä¾‹ä¸­ï¼Œå¯ä»¥è¿™æ ·åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = MyClass()</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œ <strong>init</strong>() æ–¹æ³•å¯ä»¥æœ‰å‚æ•°ï¼Œå‚æ•°é€šè¿‡ <strong>init</strong>() ä¼ é€’åˆ°ç±»çš„å®ä¾‹åŒ–æ“ä½œä¸Šã€‚ä¾‹å¦‚:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Complex</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, realpart, imagpart)</span>:</span></span><br><span class="line"><span class="meta">... </span>        self.r = realpart</span><br><span class="line"><span class="meta">... </span>        self.i = imagpart</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = Complex(<span class="number">3.0</span>, <span class="number">-4.5</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.r, x.i</span><br><span class="line">(<span class="number">3.0</span>, <span class="number">-4.5</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ç±»çš„æ–¹æ³•"><a class="markdownIt-Anchor" href="#ç±»çš„æ–¹æ³•"></a> ç±»çš„æ–¹æ³•</h3>
<p>åœ¨ç±»åœ°å†…éƒ¨ï¼Œä½¿ç”¨ def å…³é”®å­—å¯ä»¥ä¸ºç±»å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œä¸ä¸€èˆ¬å‡½æ•°å®šä¹‰ä¸åŒï¼Œç±»æ–¹æ³•å¿…é¡»åŒ…å«å‚æ•° self,ä¸”ä¸ºç¬¬ä¸€ä¸ªå‚æ•°:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç±»å®šä¹‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">people</span>:</span></span><br><span class="line">    <span class="comment">#å®šä¹‰åŸºæœ¬å±æ€§</span></span><br><span class="line">    name = <span class="string">''</span></span><br><span class="line">    age = <span class="number">0</span></span><br><span class="line">    <span class="comment">#å®šä¹‰ç§æœ‰å±æ€§,ç§æœ‰å±æ€§åœ¨ç±»å¤–éƒ¨æ— æ³•ç›´æ¥è¿›è¡Œè®¿é—®</span></span><br><span class="line">    __weight = <span class="number">0</span></span><br><span class="line">    <span class="comment">#å®šä¹‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n,a,w)</span>:</span></span><br><span class="line">        self.name = n</span><br><span class="line">        self.age = a</span><br><span class="line">        self.__weight = w</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"%s è¯´: æˆ‘ %d å²ã€‚"</span> %(self.name,self.age))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ç±»</span></span><br><span class="line">p = people(<span class="string">'W3Cschool'</span>,<span class="number">10</span>,<span class="number">30</span>)</span><br><span class="line">p.speak()</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»¥ä¸Šç¨‹åºè¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">W3Cschool è¯´: æˆ‘ <span class="number">10</span> å²ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="ç»§æ‰¿"><a class="markdownIt-Anchor" href="#ç»§æ‰¿"></a> ç»§æ‰¿</h3>
<p>Python åŒæ ·æ”¯æŒç±»çš„ç»§æ‰¿ï¼Œå¦‚æœä¸€ç§è¯­è¨€ä¸æ”¯æŒç»§æ‰¿å°±ï¼Œç±»å°±æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚æ´¾ç”Ÿç±»çš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DerivedClassName</span><span class="params">(BaseClassName1)</span>:</span></span><br><span class="line">    &lt;statement<span class="number">-1</span>&gt;</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    &lt;statement-N&gt;</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„åœ†æ‹¬å·ä¸­åŸºç±»çš„é¡ºåºï¼Œè‹¥æ˜¯åŸºç±»ä¸­æœ‰ç›¸åŒçš„æ–¹æ³•åï¼Œè€Œåœ¨å­ç±»ä½¿ç”¨æ—¶æœªæŒ‡å®šï¼Œpython ä»å·¦è‡³å³æœç´¢ å³æ–¹æ³•åœ¨å­ç±»ä¸­æœªæ‰¾åˆ°æ—¶ï¼Œä»å·¦åˆ°å³æŸ¥æ‰¾åŸºç±»ä¸­æ˜¯å¦åŒ…å«æ–¹æ³•ã€‚</p>
<p>BaseClassNameï¼ˆç¤ºä¾‹ä¸­çš„åŸºç±»åï¼‰å¿…é¡»ä¸æ´¾ç”Ÿç±»å®šä¹‰åœ¨ä¸€ä¸ªä½œç”¨åŸŸå†…ã€‚é™¤äº†ç±»ï¼Œè¿˜å¯ä»¥ç”¨è¡¨è¾¾å¼ï¼ŒåŸºç±»å®šä¹‰åœ¨å¦ä¸€ä¸ªæ¨¡å—ä¸­æ—¶è¿™ä¸€ç‚¹éå¸¸æœ‰ç”¨:</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">DerivedClassName</span>(<span class="title">modname</span>.<span class="type">BaseClassName</span>):</span></span><br></pre></td></tr></table></figure>
<p><strong>å®ä¾‹</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç±»å®šä¹‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">people</span>:</span></span><br><span class="line">    <span class="comment">#å®šä¹‰åŸºæœ¬å±æ€§</span></span><br><span class="line">    name = <span class="string">''</span></span><br><span class="line">    age = <span class="number">0</span></span><br><span class="line">    <span class="comment">#å®šä¹‰ç§æœ‰å±æ€§,ç§æœ‰å±æ€§åœ¨ç±»å¤–éƒ¨æ— æ³•ç›´æ¥è¿›è¡Œè®¿é—®</span></span><br><span class="line">    __weight = <span class="number">0</span></span><br><span class="line">    <span class="comment">#å®šä¹‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n,a,w)</span>:</span></span><br><span class="line">        self.name = n</span><br><span class="line">        self.age = a</span><br><span class="line">        self.__weight = w</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"%s è¯´: æˆ‘ %d å²ã€‚"</span> %(self.name,self.age))</span><br><span class="line"></span><br><span class="line"><span class="comment">#å•ç»§æ‰¿ç¤ºä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span><span class="params">(people)</span>:</span></span><br><span class="line">    grade = <span class="string">''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n,a,w,g)</span>:</span></span><br><span class="line">        <span class="comment">#è°ƒç”¨çˆ¶ç±»çš„æ„å‡½</span></span><br><span class="line">        people.__init__(self,n,a,w)</span><br><span class="line">        self.grade = g</span><br><span class="line">    <span class="comment">#è¦†å†™çˆ¶ç±»çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"%s è¯´: æˆ‘ %d å²äº†ï¼Œæˆ‘åœ¨è¯» %d å¹´çº§"</span>%(self.name,self.age,self.grade))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = student(<span class="string">'ken'</span>,<span class="number">10</span>,<span class="number">60</span>,<span class="number">3</span>)</span><br><span class="line">s.speak()</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»¥ä¸Šç¨‹åºè¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">ken è¯´: æˆ‘ <span class="number">10</span> å²äº†ï¼Œæˆ‘åœ¨è¯» <span class="number">3</span> å¹´çº§</span><br></pre></td></tr></table></figure>
<h3 id="å¤šç»§æ‰¿"><a class="markdownIt-Anchor" href="#å¤šç»§æ‰¿"></a> å¤šç»§æ‰¿</h3>
<p>Python åŒæ ·æœ‰é™çš„æ”¯æŒå¤šç»§æ‰¿å½¢å¼ã€‚å¤šç»§æ‰¿çš„ç±»å®šä¹‰å½¢å¦‚ä¸‹ä¾‹:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DerivedClassName</span><span class="params">(Base1, Base2, Base3)</span>:</span></span><br><span class="line">    &lt;statement<span class="number">-1</span>&gt;</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    &lt;statement-N&gt;</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„åœ†æ‹¬å·ä¸­çˆ¶ç±»çš„é¡ºåºï¼Œè‹¥æ˜¯çˆ¶ç±»ä¸­æœ‰ç›¸åŒçš„æ–¹æ³•åï¼Œè€Œåœ¨å­ç±»ä½¿ç”¨æ—¶æœªæŒ‡å®šï¼Œpython ä»å·¦è‡³å³æœç´¢ å³æ–¹æ³•åœ¨å­ç±»ä¸­æœªæ‰¾åˆ°æ—¶ï¼Œä»å·¦åˆ°å³æŸ¥æ‰¾çˆ¶ç±»ä¸­æ˜¯å¦åŒ…å«æ–¹æ³•ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç±»å®šä¹‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">people</span>:</span></span><br><span class="line">    <span class="comment">#å®šä¹‰åŸºæœ¬å±æ€§</span></span><br><span class="line">    name = <span class="string">''</span></span><br><span class="line">    age = <span class="number">0</span></span><br><span class="line">    <span class="comment">#å®šä¹‰ç§æœ‰å±æ€§,ç§æœ‰å±æ€§åœ¨ç±»å¤–éƒ¨æ— æ³•ç›´æ¥è¿›è¡Œè®¿é—®</span></span><br><span class="line">    __weight = <span class="number">0</span></span><br><span class="line">    <span class="comment">#å®šä¹‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n,a,w)</span>:</span></span><br><span class="line">        self.name = n</span><br><span class="line">        self.age = a</span><br><span class="line">        self.__weight = w</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"%s è¯´: æˆ‘ %d å²ã€‚"</span> %(self.name,self.age))</span><br><span class="line"></span><br><span class="line"><span class="comment">#å•ç»§æ‰¿ç¤ºä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span><span class="params">(people)</span>:</span></span><br><span class="line">    grade = <span class="string">''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n,a,w,g)</span>:</span></span><br><span class="line">        <span class="comment">#è°ƒç”¨çˆ¶ç±»çš„æ„å‡½</span></span><br><span class="line">        people.__init__(self,n,a,w)</span><br><span class="line">        self.grade = g</span><br><span class="line">    <span class="comment">#è¦†å†™çˆ¶ç±»çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"%s è¯´: æˆ‘ %d å²äº†ï¼Œæˆ‘åœ¨è¯» %d å¹´çº§"</span>%(self.name,self.age,self.grade))</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¦ä¸€ä¸ªç±»ï¼Œå¤šé‡ç»§æ‰¿ä¹‹å‰çš„å‡†å¤‡</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">speaker</span><span class="params">()</span>:</span></span><br><span class="line">    topic = <span class="string">''</span></span><br><span class="line">    name = <span class="string">''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n,t)</span>:</span></span><br><span class="line">        self.name = n</span><br><span class="line">        self.topic = t</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"æˆ‘å« %sï¼Œæˆ‘æ˜¯ä¸€ä¸ªæ¼”è¯´å®¶ï¼Œæˆ‘æ¼”è®²çš„ä¸»é¢˜æ˜¯ %s"</span>%(self.name,self.topic))</span><br><span class="line"></span><br><span class="line"><span class="comment">#å¤šé‡ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sample</span><span class="params">(speaker,student)</span>:</span></span><br><span class="line">    a =<span class="string">''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n,a,w,g,t)</span>:</span></span><br><span class="line">        student.__init__(self,n,a,w,g)</span><br><span class="line">        speaker.__init__(self,n,t)</span><br><span class="line"></span><br><span class="line">test = sample(<span class="string">"Tim"</span>,<span class="number">25</span>,<span class="number">80</span>,<span class="number">4</span>,<span class="string">"Python"</span>)</span><br><span class="line">test.speak()   <span class="comment">#æ–¹æ³•ååŒï¼Œé»˜è®¤è°ƒç”¨çš„æ˜¯åœ¨æ‹¬å·ä¸­æ’å‰åœ°çˆ¶ç±»çš„æ–¹æ³•</span></span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»¥ä¸Šç¨‹åºè¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æˆ‘å« Timï¼Œæˆ‘æ˜¯ä¸€ä¸ªæ¼”è¯´å®¶ï¼Œæˆ‘æ¼”è®²çš„ä¸»é¢˜æ˜¯ Python</span><br></pre></td></tr></table></figure>
<h3 id="æ–¹æ³•é‡å†™"><a class="markdownIt-Anchor" href="#æ–¹æ³•é‡å†™"></a> æ–¹æ³•é‡å†™</h3>
<p>å¦‚æœä½ çš„çˆ¶ç±»æ–¹æ³•çš„åŠŸèƒ½ä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥åœ¨å­ç±»é‡å†™ä½ çˆ¶ç±»çš„æ–¹æ³•ï¼Œå®ä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span>:</span>        <span class="comment"># å®šä¹‰çˆ¶ç±»</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">myMethod</span><span class="params">(self)</span>:</span></span><br><span class="line">      <span class="keyword">print</span> (<span class="string">'è°ƒç”¨çˆ¶ç±»æ–¹æ³•'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span><span class="params">(Parent)</span>:</span> <span class="comment"># å®šä¹‰å­ç±»</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">myMethod</span><span class="params">(self)</span>:</span></span><br><span class="line">      <span class="keyword">print</span> (<span class="string">'è°ƒç”¨å­ç±»æ–¹æ³•'</span>)</span><br><span class="line"></span><br><span class="line">c = Child()          <span class="comment"># å­ç±»å®ä¾‹</span></span><br><span class="line">c.myMethod()         <span class="comment"># å­ç±»è°ƒç”¨é‡å†™æ–¹æ³•</span></span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»¥ä¸Šç¨‹åºè¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è°ƒç”¨å­ç±»æ–¹æ³•</span><br></pre></td></tr></table></figure>
<h3 id="ç±»å±æ€§ä¸æ–¹æ³•"><a class="markdownIt-Anchor" href="#ç±»å±æ€§ä¸æ–¹æ³•"></a> ç±»å±æ€§ä¸æ–¹æ³•</h3>
<h4 id="ç±»çš„ç§æœ‰å±æ€§"><a class="markdownIt-Anchor" href="#ç±»çš„ç§æœ‰å±æ€§"></a> ç±»çš„ç§æœ‰å±æ€§</h4>
<p><strong>__private_attrs</strong>ï¼šä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼Œå£°æ˜è¯¥å±æ€§ä¸ºç§æœ‰ï¼Œä¸èƒ½åœ¨ç±»åœ°å¤–éƒ¨è¢«ä½¿ç”¨æˆ–ç›´æ¥è®¿é—®ã€‚åœ¨ç±»å†…éƒ¨çš„æ–¹æ³•ä¸­ä½¿ç”¨æ—¶<strong>self.__private_attrs</strong>ã€‚</p>
<h4 id="ç±»çš„æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#ç±»çš„æ–¹æ³•-2"></a> ç±»çš„æ–¹æ³•</h4>
<p>åœ¨ç±»åœ°å†…éƒ¨ï¼Œä½¿ç”¨ def å…³é”®å­—å¯ä»¥ä¸ºç±»å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œä¸ä¸€èˆ¬å‡½æ•°å®šä¹‰ä¸åŒï¼Œç±»æ–¹æ³•å¿…é¡»åŒ…å«å‚æ•° self,ä¸”ä¸ºç¬¬ä¸€ä¸ªå‚æ•°</p>
<h4 id="ç±»çš„ç§æœ‰æ–¹æ³•"><a class="markdownIt-Anchor" href="#ç±»çš„ç§æœ‰æ–¹æ³•"></a> ç±»çš„ç§æœ‰æ–¹æ³•</h4>
<p><strong>__private_method</strong>ï¼šä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼Œå£°æ˜è¯¥æ–¹æ³•ä¸ºç§æœ‰æ–¹æ³•ï¼Œä¸èƒ½åœ¨ç±»åœ°å¤–éƒ¨è°ƒç”¨ã€‚åœ¨ç±»çš„å†…éƒ¨è°ƒç”¨ <strong>slef.__private_methods</strong>ã€‚</p>
<p>å®ä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JustCounter</span>:</span></span><br><span class="line">    __secretCount = <span class="number">0</span>  <span class="comment"># ç§æœ‰å˜é‡</span></span><br><span class="line">    publicCount = <span class="number">0</span>    <span class="comment"># å…¬å¼€å˜é‡</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.__secretCount += <span class="number">1</span></span><br><span class="line">        self.publicCount += <span class="number">1</span></span><br><span class="line">        <span class="keyword">print</span> (self.__secretCount)</span><br><span class="line"></span><br><span class="line">counter = JustCounter()</span><br><span class="line">counter.count()</span><br><span class="line">counter.count()</span><br><span class="line"><span class="keyword">print</span> (counter.publicCount)</span><br><span class="line"><span class="keyword">print</span> (counter.__secretCount)  <span class="comment"># æŠ¥é”™ï¼Œå®ä¾‹ä¸èƒ½è®¿é—®ç§æœ‰å˜é‡</span></span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»¥ä¸Šç¨‹åºè¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">Traceback (most recent <span class="keyword">call</span> <span class="keyword">last</span>):</span><br><span class="line">  <span class="keyword">File</span> <span class="string">"test.py"</span>, line <span class="number">16</span>, <span class="keyword">in</span> &lt;<span class="keyword">module</span>&gt;</span><br><span class="line">    print (counter.__secretCount)  <span class="comment"># æŠ¥é”™ï¼Œå®ä¾‹ä¸èƒ½è®¿é—®ç§æœ‰å˜é‡</span></span><br><span class="line">AttributeError: <span class="string">'JustCounter'</span> <span class="keyword">object</span> has <span class="keyword">no</span> <span class="keyword">attribute</span> <span class="string">'__secretCount'</span></span><br></pre></td></tr></table></figure>
<h4 id="ç±»çš„ä¸“æœ‰æ–¹æ³•"><a class="markdownIt-Anchor" href="#ç±»çš„ä¸“æœ‰æ–¹æ³•"></a> ç±»çš„ä¸“æœ‰æ–¹æ³•ï¼š</h4>
<ul>
<li>*<strong>*init</strong> ğŸ˜—* æ„é€ å‡½æ•°ï¼Œåœ¨ç”Ÿæˆå¯¹è±¡æ—¶è°ƒç”¨</li>
<li>*<strong>*del</strong> ğŸ˜—* ææ„å‡½æ•°ï¼Œé‡Šæ”¾å¯¹è±¡æ—¶ä½¿ç”¨</li>
<li>*<strong>*repr</strong> ğŸ˜—* æ‰“å°ï¼Œè½¬æ¢</li>
<li>*<strong>*setitem</strong> ğŸ˜—* æŒ‰ç…§ç´¢å¼•èµ‹å€¼</li>
<li>*<strong>*getitem</strong>ğŸ˜—* æŒ‰ç…§ç´¢å¼•è·å–å€¼</li>
<li>*<strong>*len</strong>ğŸ˜—* è·å¾—é•¿åº¦</li>
<li>*<strong>*cmp</strong>ğŸ˜—* æ¯”è¾ƒè¿ç®—</li>
<li>*<strong>*call</strong>ğŸ˜—* å‡½æ•°è°ƒç”¨</li>
<li>*<strong>*add</strong>ğŸ˜—* åŠ è¿ç®—</li>
<li>*<strong>*sub</strong>ğŸ˜—* å‡è¿ç®—</li>
<li>*<strong>*mul</strong>ğŸ˜—* ä¹˜è¿ç®—</li>
<li>*<strong>*div</strong>ğŸ˜—* é™¤è¿ç®—</li>
<li>*<strong>*mod</strong>ğŸ˜—* æ±‚ä½™è¿ç®—</li>
<li>*<strong>*pow</strong>ğŸ˜—* ä¹˜æ–¹</li>
</ul>
<h4 id="è¿ç®—ç¬¦é‡è½½"><a class="markdownIt-Anchor" href="#è¿ç®—ç¬¦é‡è½½"></a> è¿ç®—ç¬¦é‡è½½</h4>
<p>Python åŒæ ·æ”¯æŒè¿ç®—ç¬¦é‡è½½ï¼Œæˆ‘ä¹ˆå¯ä»¥å¯¹ç±»çš„ä¸“æœ‰æ–¹æ³•è¿›è¡Œé‡è½½ï¼Œå®ä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vector</span>:</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, a, b)</span>:</span></span><br><span class="line">      self.a = a</span><br><span class="line">      self.b = b</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">'Vector (%d, %d)'</span> % (self.a, self.b)</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self,other)</span>:</span></span><br><span class="line">      <span class="keyword">return</span> Vector(self.a + other.a, self.b + other.b)</span><br><span class="line"></span><br><span class="line">v1 = Vector(<span class="number">2</span>,<span class="number">10</span>)</span><br><span class="line">v2 = Vector(<span class="number">5</span>,<span class="number">-2</span>)</span><br><span class="line"><span class="keyword">print</span> (v1 + v2)</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç æ‰§è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">Vector</span><span class="params">(<span class="number">7</span>,<span class="number">8</span>)</span></span></span><br></pre></td></tr></table></figure>
<h2 id="æ ‡å‡†åº“æ¦‚è§ˆ"><a class="markdownIt-Anchor" href="#æ ‡å‡†åº“æ¦‚è§ˆ"></a> æ ‡å‡†åº“æ¦‚è§ˆ</h2>
<h3 id="æ“ä½œç³»ç»Ÿæ¥å£"><a class="markdownIt-Anchor" href="#æ“ä½œç³»ç»Ÿæ¥å£"></a> æ“ä½œç³»ç»Ÿæ¥å£</h3>
<p>os æ¨¡å—æä¾›äº†ä¸å°‘ä¸æ“ä½œç³»ç»Ÿç›¸å…³è”çš„å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.getcwd()      <span class="comment"># è¿”å›å½“å‰çš„å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="string">'C:\\Python34'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.chdir(<span class="string">'/server/accesslogs'</span>)   <span class="comment"># ä¿®æ”¹å½“å‰çš„å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.system(<span class="string">'mkdir today'</span>)   <span class="comment"># æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ mkdir</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
<h3 id="æ–‡ä»¶é€šé…ç¬¦"><a class="markdownIt-Anchor" href="#æ–‡ä»¶é€šé…ç¬¦"></a> æ–‡ä»¶é€šé…ç¬¦</h3>
<p>glob æ¨¡å—æä¾›äº†ä¸€ä¸ªå‡½æ•°ç”¨äºä»ç›®å½•é€šé…ç¬¦æœç´¢ä¸­ç”Ÿæˆæ–‡ä»¶åˆ—è¡¨:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> glob</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>glob.glob(<span class="string">'*.py'</span>)</span><br><span class="line">[<span class="string">'primes.py'</span>, <span class="string">'random.py'</span>, <span class="string">'quote.py'</span>]</span><br></pre></td></tr></table></figure>
<h3 id="å‘½ä»¤è¡Œå‚æ•°"><a class="markdownIt-Anchor" href="#å‘½ä»¤è¡Œå‚æ•°"></a> å‘½ä»¤è¡Œå‚æ•°</h3>
<p>é€šç”¨å·¥å…·è„šæœ¬ç»å¸¸è°ƒç”¨å‘½ä»¤è¡Œå‚æ•°ã€‚è¿™äº›å‘½ä»¤è¡Œå‚æ•°ä»¥é“¾è¡¨å½¢å¼å­˜å‚¨äº sys æ¨¡å—çš„ argv å˜é‡ã€‚ä¾‹å¦‚åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ <code>python demo.py one two three</code> åå¯ä»¥å¾—åˆ°ä»¥ä¸‹è¾“å‡ºç»“æœ:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(sys.argv)</span><br><span class="line">[<span class="string">'demo.py'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>]</span><br></pre></td></tr></table></figure>
<h3 id="é”™è¯¯è¾“å‡ºé‡å®šå‘å’Œç¨‹åºç»ˆæ­¢"><a class="markdownIt-Anchor" href="#é”™è¯¯è¾“å‡ºé‡å®šå‘å’Œç¨‹åºç»ˆæ­¢"></a> é”™è¯¯è¾“å‡ºé‡å®šå‘å’Œç¨‹åºç»ˆæ­¢</h3>
<p>sys è¿˜æœ‰ stdinï¼Œstdout å’Œ stderr å±æ€§ï¼Œå³ä½¿åœ¨ stdout è¢«é‡å®šå‘æ—¶ï¼Œåè€…ä¹Ÿå¯ä»¥ç”¨äºæ˜¾ç¤ºè­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.stderr.write(<span class="string">'Warning, log file not found starting a new one\n'</span>)</span><br><span class="line">Warning, log file <span class="keyword">not</span> found starting a new one</span><br></pre></td></tr></table></figure>
<h3 id="å­—ç¬¦ä¸²æ­£åˆ™åŒ¹é…"><a class="markdownIt-Anchor" href="#å­—ç¬¦ä¸²æ­£åˆ™åŒ¹é…"></a> å­—ç¬¦ä¸²æ­£åˆ™åŒ¹é…</h3>
<p>re æ¨¡å—ä¸ºé«˜çº§å­—ç¬¦ä¸²å¤„ç†æä¾›äº†æ­£åˆ™è¡¨è¾¾å¼å·¥å…·ã€‚å¯¹äºå¤æ‚çš„åŒ¹é…å’Œå¤„ç†ï¼Œæ­£åˆ™è¡¨è¾¾å¼æä¾›äº†ç®€æ´ã€ä¼˜åŒ–çš„è§£å†³æ–¹æ¡ˆ:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.findall(<span class="string">r'\bf[a-z]*'</span>, <span class="string">'which foot or hand fell fastest'</span>)</span><br><span class="line">[<span class="string">'foot'</span>, <span class="string">'fell'</span>, <span class="string">'fastest'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>re.sub(<span class="string">r'(\b[a-z]+) \1'</span>, <span class="string">r'\1'</span>, <span class="string">'cat in the the hat'</span>)</span><br><span class="line"><span class="string">'cat in the hat'</span></span><br></pre></td></tr></table></figure>
<h3 id="æ•°å­¦"><a class="markdownIt-Anchor" href="#æ•°å­¦"></a> æ•°å­¦</h3>
<p>math æ¨¡å—ä¸ºæµ®ç‚¹è¿ç®—æä¾›äº†å¯¹åº•å±‚ C å‡½æ•°åº“çš„è®¿é—®:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.cos(math.pi / <span class="number">4</span>)</span><br><span class="line"><span class="number">0.70710678118654757</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.log(<span class="number">1024</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">10.0</span></span><br></pre></td></tr></table></figure>
<h1 id="èµ„æ–™"><a class="markdownIt-Anchor" href="#èµ„æ–™"></a> èµ„æ–™</h1>
<ul>
<li><a href="https://github.com/vinta/awesome-python" target="_blank" rel="noopener">https://github.com/vinta/awesome-python</a> - èµ„æºå¤§å…¨</li>
<li><a href="https://github.com/jobbole/awesome-python-cn" target="_blank" rel="noopener">https://github.com/jobbole/awesome-python-cn</a> - èµ„æºå¤§å…¨</li>
<li><a href="https://github.com/scrapy/scrapy" target="_blank" rel="noopener">https://github.com/scrapy/scrapy</a> - python çˆ¬è™«æ¡†æ¶</li>
<li><a href="https://github.com/faif/python-patterns" target="_blank" rel="noopener">https://github.com/faif/python-patterns</a> - python è®¾è®¡æ¨¡å¼</li>
<li><a href="https://github.com/kennethreitz/python-guide" target="_blank" rel="noopener">https://github.com/kennethreitz/python-guide</a> - python æœ€ä½³å®è·µ</li>
</ul>
]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€</title>
    <url>/blog/coding/programming-guide/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2>
<p>å¾ˆå¤šäººå–œæ¬¢äº‰è®ºä»€ä¹ˆä»€ä¹ˆç¼–ç¨‹è¯­è¨€å¥½ï¼Œæˆ‘è®¤ä¸ºè¿™ä¸ªè¯é¢˜å¦‚æœä¸é™å®šåº”ç”¨èŒƒå›´ï¼Œå°±æ¯«æ— æ„ä¹‰ã€‚</p>
<p>æ¯ç§ç¼–ç¨‹è¯­è¨€å¿…ç„¶æœ‰å…¶ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œè¿™ä¹Ÿå†³å®šäº†å®ƒæœ‰é€‚åˆçš„åº”ç”¨åœºæ™¯å’Œä¸é€‚åˆçš„åº”ç”¨åœºæ™¯ã€‚ç°ä»£è½¯ä»¶è¡Œä¸šï¼Œæƒ³ä¸€é—¨ç¼–ç¨‹è¯­è¨€åŒ…æ‰“å¤©ä¸‹æ˜¯ä¸ç°å®çš„ã€‚è¿™ä¸­ç°çŠ¶ä¹Ÿé€ æˆäº†ä¸€ç§ç°è±¡ï¼Œä¸€ä¸ªç¨‹åºå‘˜å¾€å¾€è¦æŒæ¡å¤šç§ç¼–ç¨‹è¯­è¨€ã€‚</p>
<p>å­¦ä¹ ä»»ä½•ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œéƒ½ä¼šé¢ä¸´çš„ç¬¬ä¸€ä¸ªé—®é¢˜éƒ½æ˜¯ï¼šå¦‚ä½•å­¦ä¹  XX è¯­è¨€ï¼Ÿ</p>
<p>æˆ‘ä¸æƒ³è¯´ä»€ä¹ˆå¤šçœ‹ã€å¤šå­¦ã€å¤šå†™ã€å¤šç»ƒä¹‹ç±»çš„åºŸè¯ã€‚ä¸–ä¸Šäº‹æœ‰éš¾æ˜“ä¹ï¼Ÿæ— ä»–ï¼Œå”¯æ‰‹ç†Ÿå°”ã€‚è°ä¸çŸ¥é“ç†Ÿèƒ½ç”Ÿå·§çš„é“ç†ï¼Ÿ</p>
<p>æˆ‘è§‰å¾—æœ‰å¿…è¦è°ˆè°ˆçš„æ˜¯ï¼šå¦‚ä½•ç”±æµ…å…¥æ·±çš„å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Ÿå­¦ä¹ æ‰€æœ‰ç¼–ç¨‹è¯­è¨€æœ‰æ²¡æœ‰ä¸€ä¸ªç›¸å¯¹ç»Ÿä¸€çš„å­¦ä¹ æ–¹æ³•ï¼Ÿ</p>
<p>æ›¾å‡ ä½•æ—¶ï¼Œå½“æˆ‘è¿˜æ˜¯ä¸€åå°èœé¸Ÿæ—¶ï¼Œæ€»æ˜¯å¹æœé‚£äº›å¤§ç¥æŒæ¡å¤šé—¨ç¼–ç¨‹è¯­è¨€ã€‚åæ¥ï¼Œåœ¨å¤šå¹´ç¼–ç¨‹å·¥ä½œå’Œå­¦ä¹ ä¸­ï¼Œæˆ‘é™†é™†ç»­ç»­ä¹Ÿæ¥è§¦è¿‡ä¸å°‘ç¼–ç¨‹è¯­è¨€ï¼šCã€C++ã€Javaã€C#ã€Javascriptã€shell ç­‰ç­‰ã€‚æ¯æ¬¡å­¦ä¹ ä¸€é—¨æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼ŒæŒæ¡ç¨‹åº¦æˆ–æ·±æˆ–æµ…ï¼Œä½†æ˜¯å­¦ä¹ çš„æ›²çº¿å´å¤§æŠµç›¸ä¼¼ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘æŒ‰ç…§ä¸ªäººçš„å­¦ä¹ ç»éªŒæ€»ç»“ä¸€ä¸‹ï¼Œå­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„åŸºæœ¬æ­¥éª¤ã€‚</p>
<h2 id="å­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„æ­¥éª¤"><a class="markdownIt-Anchor" href="#å­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„æ­¥éª¤"></a> å­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„æ­¥éª¤</h2>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/programming/learn-programming-language.png"/></div>
<h3 id="åŸºæœ¬è¯­æ³•"><a class="markdownIt-Anchor" href="#åŸºæœ¬è¯­æ³•"></a> åŸºæœ¬è¯­æ³•</h3>
<p>é¦–å…ˆå½“ç„¶æ˜¯äº†è§£è¯­è¨€çš„æœ€åŸºæœ¬è¯­æ³•ã€‚</p>
<p>æ§åˆ¶å°è¾“å‡ºï¼Œå¦‚ C çš„ printfï¼ŒJava çš„ System.out.println ç­‰ã€‚</p>
<p>æ™®é€šç¨‹åºå‘˜çš„ç¬¬ä¸€è¡Œä»£ç ä¸€èˆ¬éƒ½æ˜¯è¾“å‡º â€œHello Worldâ€ å§ã€‚</p>
<ul>
<li>
<p>åŸºæœ¬æ•°æ®ç±»å‹</p>
<p>ä¸åŒç¼–ç¨‹è¯­è¨€çš„åŸºæœ¬æ•°æ®ç±»å‹ä¸åŒã€‚åŸºæœ¬æ•°æ®ç±»å‹æ˜¯çš„ç”³è¯·å†…å­˜ç©ºé—´å˜å¾—æ–¹ä¾¿ã€è§„èŒƒåŒ–ã€‚</p>
</li>
<li>
<p>å˜é‡</p>
<p>ä¸åŒç¼–ç¨‹è¯­è¨€çš„å£°æ˜å˜é‡æ–¹å¼æœ‰å¾ˆå¤§ä¸åŒã€‚æœ‰çš„å¦‚ Java ã€C++ éœ€è¦æ˜ç¡®æŒ‡å®šå˜é‡æ•°æ®ç±»å‹ï¼Œè¿™ç§å«å¼ºç±»å‹å®šä¹‰è¯­è¨€ã€‚æœ‰çš„è¯­è¨€ï¼ˆä¸»è¦æ˜¯è„šæœ¬è¯­è¨€ï¼‰ï¼Œå¦‚ Javascriptã€Shell ç­‰ï¼Œä¸éœ€è¦æ˜ç¡®æŒ‡å®šæ•°æ®ç±»å‹ï¼Œè¿™ç§å«å¼±ç±»å‹å®šä¹‰è¯­è¨€ã€‚</p>
<p>è¿˜éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯å˜é‡çš„ä½œç”¨åŸŸèŒƒå›´å’Œç”Ÿå‘½å‘¨æœŸã€‚ä¸åŒè¯­è¨€å˜é‡çš„ä½œç”¨åŸŸèŒƒå›´å’Œç”Ÿå‘½å‘¨æœŸä¸ä¸€å®šä¸€æ ·ï¼Œè¿™ä¸ªéœ€è¦åœ¨ä»£ç ä¸­ç»†ç»†ä½“ä¼šï¼Œæœ‰æ—¶ä¼šä¸ºæ­¤åŸ‹é›·ã€‚</p>
</li>
<li>
<p>é€»è¾‘æ§åˆ¶è¯­å¥</p>
<p>ç¼–ç¨‹è¯­è¨€éƒ½ä¼šæœ‰é€»è¾‘æ§åˆ¶è¯­å¥ï¼Œå“ªæ€•æ˜¯æ±‡ç¼–è¯­è¨€ã€‚</p>
<p>æŒæ¡æ¡ä»¶è¯­å¥ã€å¾ªç¯è¯­å¥ã€ä¸­æ–­å¾ªç¯è¯­å¥ï¼ˆbreakã€continueï¼‰ã€é€‰æ‹©è¯­å¥ã€‚ä¸€èˆ¬åŒºåˆ«ä»…ä»…åœ¨äºå…³é”®å­—ã€è¯­æ³•æ ¼å¼ç•¥æœ‰ä¸åŒã€‚</p>
</li>
<li>
<p>è¿ç®—ç¬¦</p>
<p>æŒæ¡åŸºæœ¬è¿ç®—ç¬¦ï¼Œå¦‚ç®—æœ¯è¿ç®—ç¬¦ã€å…³ç³»è¿ç®—ç¬¦ã€é€»è¾‘è¿ç®—ç¬¦ã€èµ‹å€¼è¿ç®—ç¬¦ç­‰ã€‚</p>
<p>æœ‰äº›è¯­è¨€è¿˜æä¾›ä½è¿ç®—ç¬¦ã€ç‰¹æ®Šè¿ç®—ç¬¦ï¼Œè§†æƒ…èŠ‚æŒæ¡ã€‚</p>
</li>
<li>
<p>æ³¨é‡Šï¼ˆæ²¡å•¥å¥½è¯´çš„ï¼‰</p>
</li>
<li>
<p>å‡½æ•°</p>
<p>ç¼–ç¨‹è¯­è¨€åŸºæœ¬éƒ½æœ‰å‡½æ•°ã€‚æ³¨æ„è¯­æ³•æ ¼å¼ï¼šæ˜¯å¦æ”¯æŒå‡ºå‚ï¼›æ”¯æŒå“ªäº›æ•°æ®ä½œä¸ºå…¥å‚ï¼Œæœ‰äº›è¯­è¨€å…è®¸å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‚æ•°ï¼ˆå³å›è°ƒï¼‰ï¼›è¿”å›å€¼ï¼›å¦‚ä½•é€€å‡ºå‡½æ•°ï¼ˆå¦‚ Javaã€C++çš„ returnï¼Œï¼‰ã€‚</p>
</li>
</ul>
<h3 id="æ•°ç»„-æšä¸¾-é›†åˆ"><a class="markdownIt-Anchor" href="#æ•°ç»„-æšä¸¾-é›†åˆ"></a> æ•°ç»„ã€æšä¸¾ã€é›†åˆ</h3>
<p>æšä¸¾åªæœ‰éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€æœ‰ï¼Œå¦‚ Javaã€C++ã€C#ã€‚</p>
<p>ä½†æ˜¯æ•°ç»„å’Œé›†åˆï¼ˆæœ‰äº›è¯­è¨€å«å®¹å™¨ï¼‰ä¸€èˆ¬ç¼–ç¨‹è¯­è¨€éƒ½æœ‰ï¼Œåªæ˜¯æœ‰çš„ç¼–ç¨‹è¯­è¨€æä¾›çš„é›†åˆæ¯”è¾ƒä¸°å¯Œã€‚ä½¿ç”¨æ–¹æ³•åŸºæœ¬ç±»ä¼¼ã€‚</p>
<h3 id="å¸¸ç”¨ç±»"><a class="markdownIt-Anchor" href="#å¸¸ç”¨ç±»"></a> å¸¸ç”¨ç±»</h3>
<p>æ¯”è¾ƒå¸¸ç”¨çš„ç±»ï¼ˆå½“ç„¶æœ‰äº›è¯­è¨€ä¸­ä¸å«ç±»ï¼Œå«å¯¹è±¡æˆ–è€…å…¶ä»–ä»€ä¹ˆï¼Œè¿™ä¸ªä¸é‡è¦ï¼Œé¢†ä¼šç²¾ç¥ï¼‰è¯·äº†è§£å…¶ API ç”¨æ³•ï¼Œå¦‚ï¼šå­—ç¬¦ä¸²ã€æ—¥æœŸã€æ•°å­¦è®¡ç®—ç­‰ç­‰ã€‚</p>
<h3 id="è¯­è¨€ç‰¹æ€§"><a class="markdownIt-Anchor" href="#è¯­è¨€ç‰¹æ€§"></a> è¯­è¨€ç‰¹æ€§</h3>
<p>è¯­è¨€ç‰¹æ€§è¿™ä¸ªç‰¹å­—åæ˜ çš„å°±æ˜¯å„ä¸ªç¼–ç¨‹è¯­è¨€è‡ªèº«çš„&quot;ç‹¬ç‰¹ä¸ªæ€§&quot;ï¼Œè¿™æ¶‰åŠçš„ç‚¹æ¯”è¾ƒå¤šï¼Œç®€å•åˆ—ä¸¾ä¸€äº›ã€‚</p>
<p><strong>ç¼–ç¨‹æ¨¡å¼</strong></p>
<p>æ¯”è¾ƒæµè¡Œçš„ç¼–ç¨‹æ¨¡å¼å¤§æ¦‚æœ‰ï¼š</p>
<p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œä¸»è¦æ˜¯å°è£…ã€ç»§æ‰¿ã€å¤šæ€ï¼›å‡½æ•°å¼ç¼–ç¨‹ï¼Œä¸»è¦æ˜¯åº”ç”¨ Lambdaï¼›è¿‡ç¨‹å¼ç¼–ç¨‹ï¼Œå¯ä»¥ç†è§£ä¸ºå®ç°éœ€æ±‚åŠŸèƒ½çš„ç‰¹å®šæ­¥éª¤ã€‚</p>
<p>æ¯ç§ç¼–ç¨‹æ¨¡å¼éƒ½æœ‰ä¸€å®šçš„é“ç†ï¼Œæˆ‘ä»ä¸è®¤ä¸ºåªæœ‰é¢å‘å¯¹è±¡ç¼–ç¨‹æ‰æ˜¯ç‹é“ã€‚</p>
<p>Java æ˜¯é¢å‘å¯¹è±¡è¯­è¨€ï¼Œä» Java8 å¼€å§‹ä¹Ÿæ”¯æŒå‡½æ•°ç¼–ç¨‹ï¼ˆå¼•å…¥ Lambda è¡¨è¾¾å¼ï¼‰ï¼›C++ å¯ä»¥ç®—æ˜¯åŠé¢å‘å¯¹è±¡ï¼ŒåŠé¢å‘è¿‡ç¨‹å¼è¯­è¨€ã€‚</p>
<p><strong>è¯­è¨€è‡ªèº«ç‰¹æ€§</strong></p>
<p>æ¯ä¸ªè¯­è¨€è‡ªèº«éƒ½æœ‰ä¸€äº›é‡è¦ç‰¹æ€§éœ€è¦äº†è§£ã€‚ä¾‹å¦‚ï¼Œå­¦ä¹  Cã€C++ï¼Œä½ å¿…é¡»äº†è§£å†…å­˜çš„ç”³è¯·å’Œé‡Šæ”¾ï¼Œäº†è§£æŒ‡é’ˆã€å¼•ç”¨ã€‚è€Œå­¦ä¹  Javaï¼Œä½ éœ€è¦äº†è§£ JVMï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ã€‚å­¦ä¹  Javascriptï¼Œä½ éœ€è¦äº†è§£ DOM æ“ä½œç­‰ã€‚</p>
<h3 id="ä»£ç ç»„ç»‡-æ¨¡å—åŠ è½½-åº“ç®¡ç†"><a class="markdownIt-Anchor" href="#ä»£ç ç»„ç»‡-æ¨¡å—åŠ è½½-åº“ç®¡ç†"></a> ä»£ç ç»„ç»‡ã€æ¨¡å—åŠ è½½ã€åº“ç®¡ç†</h3>
<p>ä¸€ä¸ªç¨‹åºä¸€èˆ¬éƒ½æœ‰å¾ˆå¤šä¸ªæºä»£ç æ–‡ä»¶ã€‚è¿™å°±ä¼šå¼•å…¥è¿™äº›é—®é¢˜ï¼šå¦‚ä½•å°†ä»£ç æ–‡ä»¶ç»„ç»‡èµ·æ¥ï¼Ÿå¦‚ä½•æ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œé€‰æ‹©å°†éƒ¨åˆ†æ¨¡å—å¯åŠ¨æ—¶è¿›è¡ŒåŠ è½½ï¼Œéƒ¨åˆ†æ¨¡å—ä½¿ç”¨æ‡’åŠ è½½ï¼ˆæˆ–è€…çƒ­åŠ è½½ï¼‰ï¼Ÿ</p>
<p>æœ€åŸºæœ¬çš„å¼•ç”¨æ–‡ä»¶å°±ä¸æäº†ï¼Œå¦‚ Cã€C++çš„#includeï¼ŒJava çš„ import ç­‰ã€‚</p>
<p>é’ˆå¯¹ä»£ç ç»„ç»‡ã€æ¨¡å—åŠ è½½ã€åº“ç®¡ç†è¿™äº›é—®é¢˜ï¼Œä¸åŒè¯­è¨€ä¼šæœ‰ä¸åŒçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å¦‚ Java å¯ä»¥ç”¨ mavenã€gradle ç®¡ç†é¡¹ç›®ä¾èµ–ã€ç»„ç»‡ä»£ç ç»“æ„ï¼›Javascript ï¼ˆåŒ…æ‹¬ Nodejsã€jqueryã€react ç­‰ç­‰åº“ï¼‰å¯ä»¥ç”¨ npmã€yarn ç®¡ç†ä¾èµ–ï¼Œç”¨ webpack ç­‰å·¥å…·ç®¡ç†æ¨¡å—åŠ è½½ã€‚</p>
<h3 id="å®¹é”™å¤„ç†"><a class="markdownIt-Anchor" href="#å®¹é”™å¤„ç†"></a> å®¹é”™å¤„ç†</h3>
<p>ç¨‹åºæ€»éš¾å…ä¼šæœ‰ bugã€‚</p>
<p>æ‰€ä»¥ä¸ºäº†ä»£ç å¥å£®æ€§ä¹Ÿå¥½ï¼Œä¸ºäº†æ–¹ä¾¿å®šä½é—®é¢˜ä¹Ÿå¥½ï¼Œä»£ç ä¸­éœ€è¦æœ‰å®¹é”™å¤„ç†ã€‚å¸¸è§çš„æ‰‹æ®µæœ‰ï¼š</p>
<ul>
<li>å¼‚å¸¸</li>
<li>æ–­è¨€</li>
<li>æ—¥å¿—</li>
<li>è°ƒè¯•</li>
<li>å•å…ƒæµ‹è¯•</li>
</ul>
<h3 id="è¾“å…¥è¾“å‡ºå’Œæ–‡ä»¶å¤„ç†"><a class="markdownIt-Anchor" href="#è¾“å…¥è¾“å‡ºå’Œæ–‡ä»¶å¤„ç†"></a> è¾“å…¥è¾“å‡ºå’Œæ–‡ä»¶å¤„ç†</h3>
<p>è¿™å—çŸ¥è¯†æ¯”è¾ƒç¹æ‚ã€‚å»ºè®®æçº²æŒˆé¢†çš„å­¦ä¹ ä¸€ä¸‹ï¼Œç†è§£åŸºæœ¬æ¦‚å¿µï¼Œæ¯”å¦‚è¾“å…¥è¾“å‡ºæµã€ç®¡é“ç­‰ç­‰ã€‚è‡³äº APIï¼Œç”¨åˆ°çš„æ—¶å€™å†æŸ¥ä¸€ä¸‹å³å¯ã€‚</p>
<h3 id="å›è°ƒæœºåˆ¶"><a class="markdownIt-Anchor" href="#å›è°ƒæœºåˆ¶"></a> å›è°ƒæœºåˆ¶</h3>
<p>æ¯ç§è¯­è¨€å®ç°å›è°ƒçš„æ–¹å¼æœ‰æ‰€ä¸åŒï¼Œå¦‚ .Net çš„ delegate ï¼ˆå¤§é‡è¢«ç”¨äº WinForm ç¨‹åºï¼‰ï¼›Javascript ä¸­å‡½æ•°å¤©ç„¶æ”¯æŒå›è°ƒï¼šJavascript å‡½æ•°å…è®¸ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå…¥å‚ï¼Œç„¶ååœ¨æ–¹æ³•ä¸­è°ƒç”¨å®ƒã€‚å…¶å®ƒè¯­è¨€çš„å›è°ƒæ–¹å¼ä¸ä¸€ä¸€åˆ—ä¸¾ã€‚</p>
<h3 id="åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a class="markdownIt-Anchor" href="#åºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a> åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h3>
<p>é¦–å…ˆéœ€è¦äº†è§£çš„æ˜¯ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä½œç”¨æ˜¯ä¸ºäº†åœ¨ä¸åŒå¹³å°ä¹‹é—´ä¼ è¾“å¯¹è±¡ã€‚</p>
<p>å…¶æ¬¡ï¼Œè¦çŸ¥é“åºåˆ—åŒ–å­˜åœ¨å¤šç§æ–¹å¼ï¼Œä¸åŒç¼–ç¨‹è¯­è¨€å¯èƒ½æœ‰å¤šç§æ–¹æ¡ˆã€‚æ ¹æ®åº”ç”¨çš„åºåˆ—åŒ–æ–¹å¼ï¼Œé€‰æ‹©æ€§äº†è§£å³å¯ã€‚</p>
<h3 id="è¿›é˜¶ç‰¹æ€§"><a class="markdownIt-Anchor" href="#è¿›é˜¶ç‰¹æ€§"></a> è¿›é˜¶ç‰¹æ€§</h3>
<p>ä»¥ä¸‹å­¦ä¹ å†…å®¹å±äºè¿›é˜¶æ€§å†…å®¹ã€‚å¯ä»¥æ ¹æ®å¼€å‘éœ€è¦å»å­¦ä¹ ã€æŒæ¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­¦ä¹ è¿™äº›ç‰¹æ€§çš„æ€åº¦åº”è¯¥æ˜¯ä¸å­¦åˆ™å·²ï¼Œå­¦åˆ™æ­»ç£•ã€‚å› ä¸ºåŠæ‡‚åŠä¸æ‡‚ï¼Œç‰¹åˆ«å®¹æ˜“å¼•å…¥é—®é¢˜ã€‚</p>
<p><em>å¯¹äºåŠæ¡¶æ°´çš„åŒå­¦ï¼Œæˆ‘æƒ³è¯´ï¼šæ”¾è¿‡è‡ªå·±ï¼Œä¹Ÿæ”¾è¿‡åˆ«äººï¼Œæ´»ç€ä¸å¥½å—ï¼Ÿ</em></p>
<ul>
<li>
<p>**å¹¶å‘ç¼–ç¨‹ï¼š**å¥½å¤„å¤šå¤šï¼Œååˆ†é‡è¦ï¼Œä½†æ˜¯å¹¶å‘ä»£ç å®¹æ˜“å‡ºé”™ï¼Œä¸”å‡ºé”™éš¾ä»¥å®šä½ã€‚è¦å­¦ä¹ è¿˜æ˜¯è¦èŠ±å¾ˆå¤§åŠ›æ°”çš„ï¼Œéœ€è¦äº†è§£å¤§é‡çŸ¥è¯†ï¼Œå¦‚ï¼šè¿›ç¨‹ã€çº¿ç¨‹ã€åŒæ­¥ã€å¼‚æ­¥ã€è¯»å†™é”ç­‰ç­‰ã€‚</p>
</li>
<li>
<p><strong>åå°„</strong> - è®©ä½ å¯ä»¥åŠ¨æ€ç¼–ç¨‹ï¼ˆæ…ç”¨ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ³›å‹</strong> - é›†åˆï¼ˆæˆ–è€…å«å®¹å™¨ï¼‰çš„åŸºçŸ³ã€‚ç²¾é€šæ³›å‹ï¼Œèƒ½å¤§å¤§æé«˜ä½ çš„ä»£ç æ•ˆç‡ã€‚</p>
</li>
<li>
<p><strong>å…ƒæ•°æ®</strong> - æè¿°æ•°æ®çš„æ•°æ®ã€‚Java ä¸­å«åšæ³¨è§£ã€‚</p>
</li>
</ul>
<h3 id="åº“å’Œæ¡†æ¶"><a class="markdownIt-Anchor" href="#åº“å’Œæ¡†æ¶"></a> åº“å’Œæ¡†æ¶</h3>
<p>å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œéš¾å…éœ€è¦ç”¨åˆ°å›´ç»•å®ƒæ„å»ºçš„æŠ€æœ¯ç”Ÿæ€åœˆâ€”â€”åº“å’Œæ¡†æ¶ã€‚è¿™æ–¹é¢çŸ¥è¯†èŒƒå›´å¤ªåºå¤§ï¼Œæ ¹æ®å®é™…åº”ç”¨é¢†åŸŸå»å­¦ä¹ å§ã€‚æ¯”å¦‚æ JavaWebï¼Œä½ å¤šå¤šå°‘å°‘è‚¯å®šè¦ç”¨åˆ° Springã€Mybatisã€Hibernateã€Shiro ç­‰å¤§é‡å¼€å‘æ¡†æ¶ï¼›å¦‚æœåš Javascript å‰ç«¯ï¼Œä½ å¯èƒ½ä¼šç”¨åˆ° Reactã€Vueã€Angular ã€jQuery ç­‰åº“æˆ–æ¡†æ¶ã€‚</p>
<h2 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h2>
<p>æ€»ç»“ä»¥ä¸Šï¼Œç¼–ç¨‹è¯­è¨€å­¦ä¹ çš„é“è·¯æ˜¯ä»»é‡è€Œé“è¿œçš„ï¼Œæœªæ¥æ˜¯å…‰æ˜çš„ã€‚</p>
<p>æœ€åä¸€å¥è¯ä¸å›å…±å‹‰ï¼šè·¯æ¼«æ¼«å…®å…¶ä¿®è¿œï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢ã€‚</p>
]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>Git ä»å…¥é—¨åˆ°ç²¾é€š</title>
    <url>/blog/tools/git/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<h3 id="git-æ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#git-æ˜¯ä»€ä¹ˆ"></a> Git æ˜¯ä»€ä¹ˆ</h3>
<p>Git æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶"></a> ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶</h3>
<p>ç‰ˆæœ¬æ§åˆ¶æ˜¯ä¸€ç§è®°å½•ä¸€ä¸ªæˆ–è‹¥å¹²æ–‡ä»¶å†…å®¹å˜åŒ–ï¼Œä»¥ä¾¿å°†æ¥æŸ¥é˜…ç‰¹å®šç‰ˆæœ¬ä¿®è®¢æƒ…å†µçš„ç³»ç»Ÿã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"></a> ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h3>
<p>ä»‹ç»åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå‰ï¼Œæœ‰å¿…è¦å…ˆäº†è§£ä¸€ä¸‹ä¼ ç»Ÿçš„é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚</p>
<p><strong>é›†ä¸­åŒ–çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>ï¼Œè¯¸å¦‚ CVSï¼ŒSubversion ç­‰ï¼Œéƒ½æœ‰ä¸€ä¸ªå•ä¸€çš„é›†ä¸­ç®¡ç†çš„æœåŠ¡å™¨ï¼Œä¿å­˜æ‰€æœ‰æ–‡ä»¶çš„ä¿®è®¢ç‰ˆæœ¬ï¼Œè€ŒååŒå·¥ä½œçš„äººä»¬éƒ½é€šè¿‡å®¢æˆ·ç«¯è¿åˆ°è¿™å°æœåŠ¡å™¨ï¼Œå–å‡ºæœ€æ–°çš„æ–‡ä»¶æˆ–è€…æäº¤æ›´æ–°ã€‚</p>
<p>è¿™ä¹ˆåšæœ€æ˜¾è€Œæ˜“è§çš„ç¼ºç‚¹æ˜¯ä¸­å¤®æœåŠ¡å™¨çš„å•ç‚¹æ•…éšœã€‚å¦‚æœå®•æœºä¸€å°æ—¶ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸€å°æ—¶å†…ï¼Œè°éƒ½æ— æ³•æäº¤æ›´æ–°ï¼Œä¹Ÿå°±æ— æ³•ååŒå·¥ä½œã€‚è¦æ˜¯ä¸­å¤®æœåŠ¡å™¨çš„ç£ç›˜å‘ç”Ÿæ•…éšœï¼Œç¢°å·§æ²¡åšå¤‡ä»½ï¼Œæˆ–è€…å¤‡ä»½ä¸å¤ŸåŠæ—¶ï¼Œå°±ä¼šæœ‰ä¸¢å¤±æ•°æ®çš„é£é™©ã€‚æœ€åçš„æƒ…å†µæ˜¯å½»åº•ä¸¢å¤±æ•´ä¸ªé¡¹ç›®çš„æ‰€æœ‰å†å²æ›´æ”¹è®°å½•ã€‚</p>
<div align="center"><img src="https://git-scm.com/figures/18333fig0102-tn.png"/></div>
<p><strong>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>çš„å®¢æˆ·ç«¯å¹¶ä¸åªæå–æœ€æ–°ç‰ˆæœ¬çš„æ–‡ä»¶å¿«ç…§ï¼Œè€Œæ˜¯æŠŠä»£ç ä»“åº“å®Œæ•´åœ°é•œåƒä¸‹æ¥ã€‚è¿™ä¹ˆä¸€æ¥ï¼Œä»»ä½•ä¸€å¤„ååŒå·¥ä½œç”¨çš„æœåŠ¡å™¨å‘ç”Ÿæ•…éšœï¼Œäº‹åéƒ½å¯ä»¥ç”¨ä»»ä½•ä¸€ä¸ªé•œåƒå‡ºæ¥çš„æœ¬åœ°ä»“åº“æ¢å¤ã€‚å› ä¸ºæ¯ä¸€æ¬¡çš„æå–æ“ä½œï¼Œå®é™…ä¸Šéƒ½æ˜¯ä¸€æ¬¡å¯¹ä»£ç ä»“åº“çš„å®Œæ•´å¤‡ä»½ã€‚</p>
<div align="center"><img src="https://git-scm.com/figures/18333fig0103-tn.png"/></div>
<h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨-git"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆä½¿ç”¨-git"></a> ä¸ºä»€ä¹ˆä½¿ç”¨ Git</h3>
<p>Git æ˜¯åˆ†å¸ƒå¼çš„ã€‚è¿™æ˜¯ Git å’Œå…¶å®ƒéåˆ†å¸ƒå¼çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œä¾‹å¦‚ svnï¼Œcvs ç­‰ï¼Œæœ€æ ¸å¿ƒçš„åŒºåˆ«ã€‚åˆ†å¸ƒå¼å¸¦æ¥ä»¥ä¸‹å¥½å¤„ï¼š</p>
<p><strong>å·¥ä½œæ—¶ä¸éœ€è¦è”ç½‘</strong></p>
<p>é¦–å…ˆï¼Œåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ ¹æœ¬æ²¡æœ‰â€œä¸­å¤®æœåŠ¡å™¨â€ï¼Œæ¯ä¸ªäººçš„ç”µè„‘ä¸Šéƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬åº“ï¼Œè¿™æ ·ï¼Œä½ å·¥ä½œçš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦è”ç½‘äº†ï¼Œå› ä¸ºç‰ˆæœ¬åº“å°±åœ¨ä½ è‡ªå·±çš„ç”µè„‘ä¸Šã€‚æ—¢ç„¶æ¯ä¸ªäººç”µè„‘ä¸Šéƒ½æœ‰ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬åº“ï¼Œé‚£å¤šä¸ªäººå¦‚ä½•åä½œå‘¢ï¼Ÿæ¯”æ–¹è¯´ä½ åœ¨è‡ªå·±ç”µè„‘ä¸Šæ”¹äº†æ–‡ä»¶ Aï¼Œä½ çš„åŒäº‹ä¹Ÿåœ¨ä»–çš„ç”µè„‘ä¸Šæ”¹äº†æ–‡ä»¶ Aï¼Œè¿™æ—¶ï¼Œä½ ä»¬ä¿©ä¹‹é—´åªéœ€æŠŠå„è‡ªçš„ä¿®æ”¹æ¨é€ç»™å¯¹æ–¹ï¼Œå°±å¯ä»¥äº’ç›¸çœ‹åˆ°å¯¹æ–¹çš„ä¿®æ”¹äº†ã€‚</p>
<p><strong>æ›´åŠ å®‰å…¨</strong></p>
<p>é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œä¸€æ—¦ä¸­å¤®æœåŠ¡å™¨å‡ºäº†é—®é¢˜ï¼Œæ‰€æœ‰äººéƒ½æ— æ³•å·¥ä½œã€‚</p>
<p>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œæ¯ä¸ªäººç”µè„‘ä¸­éƒ½æœ‰å®Œæ•´çš„ç‰ˆæœ¬åº“ï¼Œæ‰€ä»¥æŸäººçš„æœºå™¨æŒ‚äº†ï¼Œå¹¶ä¸å½±å“å…¶å®ƒäººã€‚</p>
<h2 id="å®‰è£…"><a class="markdownIt-Anchor" href="#å®‰è£…"></a> å®‰è£…</h2>
<p><strong>Debian/Ubuntu ç¯å¢ƒå®‰è£…</strong></p>
<p>å¦‚æœä½ ä½¿ç”¨çš„ç³»ç»Ÿæ˜¯ Debian/Ubuntu ï¼Œ å®‰è£…å‘½ä»¤ä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ apt-get install libcurl4-gnutls-dev libexpat1-dev gettext \</span><br><span class="line">&gt; libz-dev libssl-dev</span><br><span class="line">$ apt-get install git-core</span><br><span class="line">$ git --version</span><br><span class="line">git version 1.8.1.2</span><br></pre></td></tr></table></figure>
<p><strong>Centos/RedHat ç¯å¢ƒå®‰è£…</strong></p>
<p>å¦‚æœä½ ä½¿ç”¨çš„ç³»ç»Ÿæ˜¯ Centos/RedHat ï¼Œå®‰è£…å‘½ä»¤ä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ yum install curl-devel expat-devel gettext-devel \</span><br><span class="line">&gt; openssl-devel zlib-devel</span><br><span class="line">$ yum -y install git-core</span><br><span class="line">$ git --version</span><br><span class="line">git version 1.7.1</span><br></pre></td></tr></table></figure>
<p><strong>Windows ç¯å¢ƒå®‰è£…</strong></p>
<p>åœ¨<a href="https://git-scm.com/downloads" target="_blank" rel="noopener">Git å®˜æ–¹ä¸‹è½½åœ°å€</a>ä¸‹è½½ exe å®‰è£…åŒ…ã€‚æŒ‰ç…§å®‰è£…å‘å¯¼å®‰è£…å³å¯ã€‚</p>
<p>å»ºè®®å®‰è£… Git Bash è¿™ä¸ª git çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
<p><strong>Mac ç¯å¢ƒå®‰è£…</strong></p>
<p>åœ¨<a href="https://git-scm.com/downloads" target="_blank" rel="noopener">Git å®˜æ–¹ä¸‹è½½åœ°å€</a>ä¸‹è½½ mac å®‰è£…åŒ…ã€‚æŒ‰ç…§å®‰è£…å‘å¯¼å®‰è£…å³å¯ã€‚</p>
<h2 id="é…ç½®"><a class="markdownIt-Anchor" href="#é…ç½®"></a> é…ç½®</h2>
<p>Git è‡ªå¸¦ä¸€ä¸ª <code>git config</code> çš„å·¥å…·æ¥å¸®åŠ©è®¾ç½®æ§åˆ¶ Git å¤–è§‚å’Œè¡Œä¸ºçš„é…ç½®å˜é‡ã€‚ è¿™äº›å˜é‡å­˜å‚¨åœ¨ä¸‰ä¸ªä¸åŒçš„ä½ç½®ï¼š</p>
<ol>
<li><code>/etc/gitconfig</code> æ–‡ä»¶: åŒ…å«ç³»ç»Ÿä¸Šæ¯ä¸€ä¸ªç”¨æˆ·åŠä»–ä»¬ä»“åº“çš„é€šç”¨é…ç½®ã€‚ å¦‚æœä½¿ç”¨å¸¦æœ‰ <code>--system</code> é€‰é¡¹çš„ <code>git config</code> æ—¶ï¼Œå®ƒä¼šä»æ­¤æ–‡ä»¶è¯»å†™é…ç½®å˜é‡ã€‚</li>
<li><code>\~/.gitconfig</code> æˆ– <code>\~/.config/git/config</code> æ–‡ä»¶ï¼šåªé’ˆå¯¹å½“å‰ç”¨æˆ·ã€‚ å¯ä»¥ä¼ é€’ <code>--global</code> é€‰é¡¹è®© Git è¯»å†™æ­¤æ–‡ä»¶ã€‚</li>
<li>å½“å‰ä½¿ç”¨ä»“åº“çš„ Git ç›®å½•ä¸­çš„ <code>config</code> æ–‡ä»¶ï¼ˆå°±æ˜¯ <code>.git/config</code>ï¼‰ï¼šé’ˆå¯¹è¯¥ä»“åº“ã€‚</li>
</ol>
<p>æ¯ä¸€ä¸ªçº§åˆ«è¦†ç›–ä¸Šä¸€çº§åˆ«çš„é…ç½®ï¼Œæ‰€ä»¥ <code>.git/config</code> çš„é…ç½®å˜é‡ä¼šè¦†ç›– <code>/etc/gitconfig</code> ä¸­çš„é…ç½®å˜é‡ã€‚</p>
<p>åœ¨ Windows ç³»ç»Ÿä¸­ï¼ŒGit ä¼šæŸ¥æ‰¾ <code>$HOME</code> ç›®å½•ä¸‹ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ <code>C:\Users\$USER</code>ï¼‰çš„ <code>.gitconfig</code> æ–‡ä»¶ã€‚ Git åŒæ ·ä¹Ÿä¼šå¯»æ‰¾ <code>/etc/gitconfig</code> æ–‡ä»¶ï¼Œä½†åªé™äº MSys çš„æ ¹ç›®å½•ä¸‹ï¼Œå³å®‰è£… Git æ—¶æ‰€é€‰çš„ç›®æ ‡ä½ç½®ã€‚</p>
<h3 id="ç”¨æˆ·ä¿¡æ¯"><a class="markdownIt-Anchor" href="#ç”¨æˆ·ä¿¡æ¯"></a> ç”¨æˆ·ä¿¡æ¯</h3>
<p>å½“å®‰è£…å®Œ Git åº”è¯¥åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è®¾ç½®ä½ çš„ç”¨æˆ·åç§°ä¸é‚®ä»¶åœ°å€ã€‚ è¿™æ ·åšå¾ˆé‡è¦ï¼Œå› ä¸ºæ¯ä¸€ä¸ª Git çš„æäº¤éƒ½ä¼šä½¿ç”¨è¿™äº›ä¿¡æ¯ï¼Œå¹¶ä¸”å®ƒä¼šå†™å…¥åˆ°ä½ çš„æ¯ä¸€æ¬¡æäº¤ä¸­ï¼Œä¸å¯æ›´æ”¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">"John Doe"</span></span><br><span class="line">$ git config --global user.email johndoe@example.com</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡å¼ºè°ƒï¼Œå¦‚æœä½¿ç”¨äº† <code>--global</code> é€‰é¡¹ï¼Œé‚£ä¹ˆè¯¥å‘½ä»¤åªéœ€è¦è¿è¡Œä¸€æ¬¡ï¼Œå› ä¸ºä¹‹åæ— è®ºä½ åœ¨è¯¥ç³»ç»Ÿä¸Šåšä»»ä½•äº‹æƒ…ï¼Œ Git éƒ½ä¼šä½¿ç”¨é‚£äº›ä¿¡æ¯ã€‚ å½“ä½ æƒ³é’ˆå¯¹ç‰¹å®šé¡¹ç›®ä½¿ç”¨ä¸åŒçš„ç”¨æˆ·åç§°ä¸é‚®ä»¶åœ°å€æ—¶ï¼Œå¯ä»¥åœ¨é‚£ä¸ªé¡¹ç›®ç›®å½•ä¸‹è¿è¡Œæ²¡æœ‰ <code>--global</code> é€‰é¡¹çš„å‘½ä»¤æ¥é…ç½®ã€‚</p>
<p>å¾ˆå¤š GUI å·¥å…·éƒ½ä¼šåœ¨ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶å¸®åŠ©ä½ é…ç½®è¿™äº›ä¿¡æ¯ã€‚</p>
<h3 id="gitignore"><a class="markdownIt-Anchor" href="#gitignore"></a> .gitignore</h3>
<p><code>.gitignore</code> æ–‡ä»¶å¯èƒ½ä»å­—é¢å«ä¹‰ä¹Ÿä¸éš¾çŒœå‡ºï¼šè¿™ä¸ªæ–‡ä»¶é‡Œé…ç½®çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¼šè‡ªåŠ¨è¢« git æ‰€å¿½ç•¥ï¼Œä¸çº³å…¥ç‰ˆæœ¬æ§åˆ¶ã€‚</p>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ç»å¸¸ä¼šäº§ç”Ÿä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼Œå¦‚ç¼–è¯‘ Java äº§ç”Ÿçš„ <code>*.class</code> æ–‡ä»¶ï¼Œåˆæˆ–æ˜¯ IDE è‡ªåŠ¨ç”Ÿæˆçš„éšè—ç›®å½•ï¼ˆIntellij çš„ <code>.idea</code> ç›®å½•ã€Eclipse çš„ <code>.settings</code> ç›®å½•ç­‰ï¼‰ç­‰ç­‰ã€‚è¿™äº›æ–‡ä»¶æˆ–ç›®å½•å®åœ¨æ²¡å¿…è¦çº³å…¥ç‰ˆæœ¬ç®¡ç†ã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œä½ å°±éœ€è¦ç”¨åˆ° <code>.gitignore</code> é…ç½®æ¥è¿‡æ»¤è¿™äº›æ–‡ä»¶æˆ–ç›®å½•ã€‚</p>
<p>é…ç½®çš„è§„åˆ™å¾ˆç®€å•ï¼Œä¹Ÿæ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œçœ‹å‡ ä¸ªä¾‹å­ï¼Œè‡ªç„¶å°±æ˜ç™½äº†ã€‚</p>
<p>è¿™é‡Œæ¨èä¸€ä¸‹ Github çš„å¼€æºé¡¹ç›®ï¼š<a href="https://github.com/github/gitignore" target="_blank" rel="noopener">https://github.com/github/gitignore</a></p>
<p>åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥æ‰¾åˆ°å¾ˆå¤šå¸¸ç”¨çš„æ¨¡æ¿ï¼Œå¦‚ï¼šJavaã€Nodejsã€C++ çš„ <code>.gitignore</code> æ¨¡æ¿ç­‰ç­‰ã€‚</p>
<h2 id="åŸç†"><a class="markdownIt-Anchor" href="#åŸç†"></a> åŸç†</h2>
<p>ä¸ªäººè®¤ä¸ºï¼Œå¯¹äº Git è¿™ä¸ªç‰ˆæœ¬å·¥å…·ï¼Œå†ä¸äº†è§£åŸç†çš„æƒ…å†µä¸‹ï¼Œç›´æ¥å»å­¦ä¹ å‘½ä»¤è¡Œï¼Œå¯èƒ½ä¼šä¸€å¤´é›¾æ°´ã€‚æ‰€ä»¥ï¼Œæœ¬æ–‡ç‰¹æ„å°†åŸç†æ”¾åœ¨å‘½ä»¤ä½¿ç”¨ç« èŠ‚ä¹‹å‰è®²è§£ã€‚</p>
<h3 id="ç‰ˆæœ¬åº“"><a class="markdownIt-Anchor" href="#ç‰ˆæœ¬åº“"></a> ç‰ˆæœ¬åº“</h3>
<p>å½“ä½ ä¸€ä¸ªé¡¹ç›®åˆ°æœ¬åœ°æˆ–åˆ›å»ºä¸€ä¸ª git é¡¹ç›®ï¼Œé¡¹ç›®ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ªéšè—çš„ <code>.git</code> å­ç›®å½•ã€‚è¿™ä¸ªç›®å½•æ˜¯ git ç”¨æ¥è·Ÿè¸ªç®¡ç†ç‰ˆæœ¬åº“çš„ï¼Œåƒä¸‡ä¸è¦æ‰‹åŠ¨ä¿®æ”¹ã€‚</p>
<h3 id="å“ˆå¸Œå€¼"><a class="markdownIt-Anchor" href="#å“ˆå¸Œå€¼"></a> å“ˆå¸Œå€¼</h3>
<p>Git ä¸­æ‰€æœ‰æ•°æ®åœ¨å­˜å‚¨å‰éƒ½è®¡ç®—æ ¡éªŒå’Œï¼Œç„¶åä»¥æ ¡éªŒå’Œæ¥å¼•ç”¨ã€‚ è¿™æ„å‘³ç€ä¸å¯èƒ½åœ¨ Git ä¸çŸ¥æƒ…æ—¶æ›´æ”¹ä»»ä½•æ–‡ä»¶å†…å®¹æˆ–ç›®å½•å†…å®¹ã€‚ è¿™ä¸ªåŠŸèƒ½å»ºæ„åœ¨ Git åº•å±‚ï¼Œæ˜¯æ„æˆ Git å“²å­¦ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚ è‹¥ä½ åœ¨ä¼ é€è¿‡ç¨‹ä¸­ä¸¢å¤±ä¿¡æ¯æˆ–æŸåæ–‡ä»¶ï¼ŒGit å°±èƒ½å‘ç°ã€‚</p>
<p>Git ç”¨ä»¥è®¡ç®—æ ¡éªŒå’Œçš„æœºåˆ¶å«åš SHA-1 æ•£åˆ—ï¼ˆhashï¼Œå“ˆå¸Œï¼‰ã€‚ è¿™æ˜¯ä¸€ä¸ªç”± 40 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼ˆ0-9 å’Œ a-fï¼‰ç»„æˆå­—ç¬¦ä¸²ï¼ŒåŸºäº Git ä¸­æ–‡ä»¶çš„å†…å®¹æˆ–ç›®å½•ç»“æ„è®¡ç®—å‡ºæ¥ã€‚ SHA-1 å“ˆå¸Œçœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">24</span>b9da6552252987aa493b52f8696cd6d3b00373</span><br></pre></td></tr></table></figure>
<p>Git ä¸­ä½¿ç”¨è¿™ç§å“ˆå¸Œå€¼çš„æƒ…å†µå¾ˆå¤šï¼Œä½ å°†ç»å¸¸çœ‹åˆ°è¿™ç§å“ˆå¸Œå€¼ã€‚ å®é™…ä¸Šï¼ŒGit æ•°æ®åº“ä¸­ä¿å­˜çš„ä¿¡æ¯éƒ½æ˜¯ä»¥æ–‡ä»¶å†…å®¹çš„å“ˆå¸Œå€¼æ¥ç´¢å¼•ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åã€‚</p>
<h3 id="æ–‡ä»¶çŠ¶æ€"><a class="markdownIt-Anchor" href="#æ–‡ä»¶çŠ¶æ€"></a> æ–‡ä»¶çŠ¶æ€</h3>
<p>åœ¨ GIt ä¸­ï¼Œä½ çš„æ–‡ä»¶å¯èƒ½ä¼šå¤„äºä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼š</p>
<ul>
<li><strong>å·²ä¿®æ”¹ï¼ˆmodifiedï¼‰</strong> - å·²ä¿®æ”¹è¡¨ç¤ºä¿®æ”¹äº†æ–‡ä»¶ï¼Œä½†è¿˜æ²¡ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</li>
<li><strong>å·²æš‚å­˜ï¼ˆstagedï¼‰</strong> - å·²æš‚å­˜è¡¨ç¤ºå¯¹ä¸€ä¸ªå·²ä¿®æ”¹æ–‡ä»¶çš„å½“å‰ç‰ˆæœ¬åšäº†æ ‡è®°ï¼Œä½¿ä¹‹åŒ…å«åœ¨ä¸‹æ¬¡æäº¤çš„å¿«ç…§ä¸­ã€‚</li>
<li><strong>å·²æäº¤ï¼ˆcommittedï¼‰</strong> - å·²æäº¤è¡¨ç¤ºæ•°æ®å·²ç»å®‰å…¨çš„ä¿å­˜åœ¨æœ¬åœ°æ•°æ®åº“ä¸­ã€‚</li>
</ul>
<h3 id="å·¥ä½œåŒºåŸŸ"><a class="markdownIt-Anchor" href="#å·¥ä½œåŒºåŸŸ"></a> å·¥ä½œåŒºåŸŸ</h3>
<p>ä¸æ–‡ä»¶çŠ¶æ€å¯¹åº”çš„ï¼Œä¸åŒçŠ¶æ€çš„æ–‡ä»¶åœ¨ Git ä¸­å¤„äºä¸åŒçš„å·¥ä½œåŒºåŸŸã€‚</p>
<ul>
<li><strong>å·¥ä½œåŒºï¼ˆworkingï¼‰</strong> - å½“ä½  <code>git clone</code> ä¸€ä¸ªé¡¹ç›®åˆ°æœ¬åœ°ï¼Œç›¸å½“äºåœ¨æœ¬åœ°å…‹éš†äº†é¡¹ç›®çš„ä¸€ä¸ªå‰¯æœ¬ã€‚å·¥ä½œåŒºæ˜¯å¯¹é¡¹ç›®çš„æŸä¸ªç‰ˆæœ¬ç‹¬ç«‹æå–å‡ºæ¥çš„å†…å®¹ã€‚ è¿™äº›ä» Git ä»“åº“çš„å‹ç¼©æ•°æ®åº“ä¸­æå–å‡ºæ¥çš„æ–‡ä»¶ï¼Œæ”¾åœ¨ç£ç›˜ä¸Šä¾›ä½ ä½¿ç”¨æˆ–ä¿®æ”¹ã€‚</li>
<li><strong>æš‚å­˜åŒºï¼ˆstagingï¼‰</strong> - æš‚å­˜åŒºæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¿å­˜äº†ä¸‹æ¬¡å°†æäº¤çš„æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯ï¼Œä¸€èˆ¬åœ¨ Git ä»“åº“ç›®å½•ä¸­ã€‚ æœ‰æ—¶å€™ä¹Ÿè¢«ç§°ä½œ`â€˜ç´¢å¼•â€™â€™ï¼Œä¸è¿‡ä¸€èˆ¬è¯´æ³•è¿˜æ˜¯å«æš‚å­˜åŒºã€‚</li>
<li><strong>æœ¬åœ°ä»“åº“ï¼ˆlocalï¼‰</strong> - æäº¤æ›´æ–°ï¼Œæ‰¾åˆ°æš‚å­˜åŒºåŸŸçš„æ–‡ä»¶ï¼Œå°†å¿«ç…§æ°¸ä¹…æ€§å­˜å‚¨åˆ° Git æœ¬åœ°ä»“åº“ã€‚</li>
<li><strong>è¿œç¨‹ä»“åº“ï¼ˆremoteï¼‰</strong> - ä»¥ä¸Šå‡ ä¸ªå·¥ä½œåŒºéƒ½æ˜¯åœ¨æœ¬åœ°ã€‚ä¸ºäº†è®©åˆ«äººå¯ä»¥çœ‹åˆ°ä½ çš„ä¿®æ”¹ï¼Œä½ éœ€è¦å°†ä½ çš„æ›´æ–°æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚åŒç†ï¼Œå¦‚æœä½ æƒ³åŒæ­¥åˆ«äººçš„ä¿®æ”¹ï¼Œä½ éœ€è¦ä»è¿œç¨‹ä»“åº“æ‹‰å–æ›´æ–°ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/web/git/git-theory.png"/></div>
<h2 id="å‘½ä»¤"><a class="markdownIt-Anchor" href="#å‘½ä»¤"></a> å‘½ä»¤</h2>
<p>å›½å¤–ç½‘å‹åˆ¶ä½œäº†ä¸€å¼  Git Cheat Sheetï¼Œæ€»ç»“å¾ˆç²¾ç‚¼ï¼Œå„ä½ä¸å¦¨æ”¶è—ä¸€ä¸‹ã€‚</p>
<p>æœ¬èŠ‚é€‰æ‹©æ€§ä»‹ç» git ä¸­æ¯”è¾ƒå¸¸ç”¨çš„å‘½ä»¤è¡Œåœºæ™¯ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/web/git/git-cheat-sheet.png"/></div>
<h3 id="åˆ›å»ºä»“åº“"><a class="markdownIt-Anchor" href="#åˆ›å»ºä»“åº“"></a> åˆ›å»ºä»“åº“</h3>
<p>å…‹éš†ä¸€ä¸ªå·²åˆ›å»ºçš„ä»“åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡ SSH</span></span><br><span class="line">$ git <span class="built_in">clone</span> ssh://user@domain.com/repo.git</span><br><span class="line"></span><br><span class="line"><span class="comment">#é€šè¿‡ HTTP</span></span><br><span class="line">$ git <span class="built_in">clone</span> http://domain.com/user/repo.git</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„æœ¬åœ°ä»“åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git init</span><br></pre></td></tr></table></figure>
<h3 id="æ·»åŠ ä¿®æ”¹"><a class="markdownIt-Anchor" href="#æ·»åŠ ä¿®æ”¹"></a> æ·»åŠ ä¿®æ”¹</h3>
<p>æ·»åŠ ä¿®æ”¹åˆ°æš‚å­˜åŒºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŠŠæŒ‡å®šæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº</span></span><br><span class="line">$ git add xxx</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠå½“å‰æ‰€æœ‰ä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒº</span></span><br><span class="line">$ git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠæ‰€æœ‰ä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒº</span></span><br><span class="line">$ git add -A</span><br></pre></td></tr></table></figure>
<p>æäº¤ä¿®æ”¹åˆ°æœ¬åœ°ä»“åº“ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æäº¤æœ¬åœ°çš„æ‰€æœ‰ä¿®æ”¹</span></span><br><span class="line">$ git commit -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤ä¹‹å‰å·²æ ‡è®°çš„å˜åŒ–</span></span><br><span class="line">$ git commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># é™„åŠ æ¶ˆæ¯æäº¤</span></span><br><span class="line">$ git commit -m <span class="string">'commit message'</span></span><br></pre></td></tr></table></figure>
<h4 id="å‚¨è—"><a class="markdownIt-Anchor" href="#å‚¨è—"></a> å‚¨è—</h4>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŒä¸€ä¸ªé¡¹ç›®çš„ä¸åŒåˆ†æ”¯ä¸Šå·¥ä½œã€‚å½“éœ€è¦åˆ‡æ¢åˆ†æ”¯æ—¶ï¼Œååæœ¬åœ°çš„å·¥ä½œè¿˜æ²¡æœ‰å®Œæˆï¼Œæ­¤æ—¶ï¼Œæäº¤ä¿®æ”¹æ˜¾å¾—ä¸ä¸¥è°¨ï¼Œä½†æ˜¯ä¸æäº¤ä»£ç åˆæ— æ³•åˆ‡æ¢åˆ†æ”¯ã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>git stash</code> å°†æœ¬åœ°çš„ä¿®æ”¹å†…å®¹ä½œä¸ºè‰ç¨¿å‚¨è—èµ·æ¥ã€‚</p>
<p>å®˜æ–¹ç§°ä¹‹ä¸ºå‚¨è—ï¼Œä½†æˆ‘ä¸ªäººæ›´å–œæ¬¢ç§°ä¹‹ä¸ºå­˜è‰ç¨¿ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. å°†ä¿®æ”¹ä½œä¸ºå½“å‰åˆ†æ”¯çš„è‰ç¨¿ä¿å­˜</span></span><br><span class="line">$ git stash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æŸ¥çœ‹è‰ç¨¿åˆ—è¡¨</span></span><br><span class="line">$ git stash list</span><br><span class="line">stash@&#123;0&#125;: WIP on master: 6fae349 :memo: Writing docs.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.1 åˆ é™¤è‰ç¨¿</span></span><br><span class="line">$ git stash drop stash@&#123;0&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.2 è¯»å–è‰ç¨¿</span></span><br><span class="line">$ git stash apply stash@&#123;0&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ’¤é”€ä¿®æ”¹"><a class="markdownIt-Anchor" href="#æ’¤é”€ä¿®æ”¹"></a> æ’¤é”€ä¿®æ”¹</h3>
<p>æ’¤é”€æœ¬åœ°ä¿®æ”¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç§»é™¤ç¼“å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶ï¼ˆi.e. æ’¤é”€ä¸Šæ¬¡git addï¼‰</span></span><br><span class="line">$ git reset HEAD</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†HEADé‡ç½®åˆ°ä¸Šä¸€æ¬¡æäº¤çš„ç‰ˆæœ¬ï¼Œå¹¶å°†ä¹‹åçš„ä¿®æ”¹æ ‡è®°ä¸ºæœªæ·»åŠ åˆ°ç¼“å­˜åŒºçš„ä¿®æ”¹</span></span><br><span class="line">$ git reset &lt;commit&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†HEADé‡ç½®åˆ°ä¸Šä¸€æ¬¡æäº¤çš„ç‰ˆæœ¬ï¼Œå¹¶ä¿ç•™æœªæäº¤çš„æœ¬åœ°ä¿®æ”¹</span></span><br><span class="line">$ git reset --keep &lt;commit&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¾å¼ƒå·¥ä½œç›®å½•ä¸‹çš„æ‰€æœ‰ä¿®æ”¹</span></span><br><span class="line">$ git reset --hard HEAD</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†HEADé‡ç½®åˆ°æŒ‡å®šçš„ç‰ˆæœ¬ï¼Œå¹¶æŠ›å¼ƒè¯¥ç‰ˆæœ¬ä¹‹åçš„æ‰€æœ‰ä¿®æ”¹</span></span><br><span class="line">$ git reset --hard &lt;commit-hash&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨è¿œç«¯åˆ†æ”¯å¼ºåˆ¶è¦†ç›–æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">$ git reset --hard &lt;remote/branch&gt; e.g., upstream/master, origin/my-feature</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¾å¼ƒæŸä¸ªæ–‡ä»¶çš„æ‰€æœ‰æœ¬åœ°ä¿®æ”¹</span></span><br><span class="line">$ git checkout HEAD &lt;file&gt;</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤æ·»åŠ <code>.gitignore</code>æ–‡ä»¶å‰é”™è¯¯æäº¤çš„æ–‡ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rm -r --cached .</span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">"remove xyz file"</span></span><br></pre></td></tr></table></figure>
<p>æ’¤é”€è¿œç¨‹ä¿®æ”¹ï¼ˆåˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ï¼Œå¹¶å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬ï¼‰ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git revert &lt;commit-hash&gt;</span><br></pre></td></tr></table></figure>
<p>å½»åº•åˆ é™¤æŒ‡å®šç‰ˆæœ¬ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œä¸‹é¢å‘½ä»¤åï¼Œcommit-hash æäº¤åçš„è®°å½•éƒ½ä¼šè¢«å½»åº•åˆ é™¤ï¼Œä½¿ç”¨éœ€è°¨æ…</span></span><br><span class="line">$ git reset --hard &lt;commit-hash&gt;</span><br><span class="line">$ git push -f</span><br></pre></td></tr></table></figure>
<h3 id="æ›´æ–°ä¸æ¨é€"><a class="markdownIt-Anchor" href="#æ›´æ–°ä¸æ¨é€"></a> æ›´æ–°ä¸æ¨é€</h3>
<p>æ›´æ–°ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½è¿œç¨‹ç«¯ç‰ˆæœ¬ï¼Œä½†ä¸åˆå¹¶åˆ°HEADä¸­</span></span><br><span class="line">$ git fetch &lt;remote&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†è¿œç¨‹ç«¯ç‰ˆæœ¬åˆå¹¶åˆ°æœ¬åœ°ç‰ˆæœ¬ä¸­</span></span><br><span class="line">$ git pull origin master</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥rebaseæ–¹å¼å°†è¿œç«¯åˆ†æ”¯ä¸æœ¬åœ°åˆå¹¶</span></span><br><span class="line">$ git pull --rebase &lt;remote&gt; &lt;branch&gt;</span><br></pre></td></tr></table></figure>
<p>æ¨é€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°†æœ¬åœ°ç‰ˆæœ¬æ¨é€åˆ°è¿œç¨‹ç«¯</span></span><br><span class="line">$ git push remote &lt;remote&gt; &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤è¿œç¨‹ç«¯åˆ†æ”¯</span></span><br><span class="line">$ git push &lt;remote&gt; :&lt;branch&gt; (since Git v1.5.0)</span><br><span class="line">$ git push &lt;remote&gt; --delete &lt;branch&gt; (since Git v1.7.0)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘å¸ƒæ ‡ç­¾</span></span><br><span class="line">$ git push --tags</span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹ä¿¡æ¯"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹ä¿¡æ¯"></a> æŸ¥çœ‹ä¿¡æ¯</h3>
<p>æ˜¾ç¤ºå·¥ä½œè·¯å¾„ä¸‹å·²ä¿®æ”¹çš„æ–‡ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git status</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºä¸ä¸Šæ¬¡æäº¤ç‰ˆæœ¬æ–‡ä»¶çš„ä¸åŒï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git diff</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºæäº¤å†å²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä»æœ€æ–°æäº¤å¼€å§‹ï¼Œæ˜¾ç¤ºæ‰€æœ‰çš„æäº¤è®°å½•ï¼ˆæ˜¾ç¤ºhashï¼Œ ä½œè€…ä¿¡æ¯ï¼Œæäº¤çš„æ ‡é¢˜å’Œæ—¶é—´ï¼‰</span></span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæŸä¸ªç”¨æˆ·çš„æ‰€æœ‰æäº¤</span></span><br><span class="line">$ git <span class="built_in">log</span> --author=<span class="string">"username"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶çš„æ‰€æœ‰ä¿®æ”¹</span></span><br><span class="line">$ git <span class="built_in">log</span> -p &lt;file&gt;</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºæœç´¢å†…å®¹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä»å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ä¸­æŸ¥æ‰¾æ–‡æœ¬å†…å®¹</span></span><br><span class="line">$ git grep <span class="string">"Hello"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨æŸä¸€ç‰ˆæœ¬ä¸­æœç´¢æ–‡æœ¬</span></span><br><span class="line">$ git grep <span class="string">"Hello"</span> v2.5</span><br></pre></td></tr></table></figure>
<h3 id="åˆ†æ”¯"><a class="markdownIt-Anchor" href="#åˆ†æ”¯"></a> åˆ†æ”¯</h3>
<p>å¢åˆ æŸ¥åˆ†æ”¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰çš„åˆ†æ”¯</span></span><br><span class="line">$ git branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰çš„è¿œç«¯åˆ†æ”¯</span></span><br><span class="line">$ git branch -r</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸºäºå½“å‰åˆ†æ”¯åˆ›å»ºæ–°åˆ†æ”¯</span></span><br><span class="line">$ git branch &lt;new-branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸºäºè¿œç¨‹åˆ†æ”¯åˆ›å»ºæ–°çš„å¯è¿½æº¯çš„åˆ†æ”¯</span></span><br><span class="line">$ git branch --track &lt;new-branch&gt; &lt;remote-branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">$ git branch -d &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼Œå°†ä¼šä¸¢å¤±æœªåˆå¹¶çš„ä¿®æ”¹</span></span><br><span class="line">$ git branch -D &lt;branch&gt;</span><br></pre></td></tr></table></figure>
<p>åˆ‡æ¢åˆ†æ”¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ†æ”¯</span></span><br><span class="line">$ git checkout &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯</span></span><br><span class="line">$ git checkout -b &lt;branch&gt;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‡ç­¾"><a class="markdownIt-Anchor" href="#æ ‡ç­¾"></a> æ ‡ç­¾</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç»™å½“å‰ç‰ˆæœ¬æ‰“æ ‡ç­¾</span></span><br><span class="line">$ git tag &lt;tag-name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»™å½“å‰ç‰ˆæœ¬æ‰“æ ‡ç­¾å¹¶é™„åŠ æ¶ˆæ¯</span></span><br><span class="line">$ git tag -a &lt;tag-name&gt;</span><br></pre></td></tr></table></figure>
<h3 id="åˆå¹¶ä¸é‡ç½®"><a class="markdownIt-Anchor" href="#åˆå¹¶ä¸é‡ç½®"></a> åˆå¹¶ä¸é‡ç½®</h3>
<blockquote>
<p>merge ä¸ rebase è™½ç„¶æ˜¯ git å¸¸ç”¨åŠŸèƒ½ï¼Œä½†æ˜¯å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ git å‘½ä»¤æ¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚</p>
<p>å› ä¸ºå¦‚æœå‡ºç°ä»£ç å†²çªï¼Œåœ¨æ²¡æœ‰ä»£ç æ¯”å¯¹å·¥å…·çš„æƒ…å†µä¸‹ï¼Œå®åœ¨å¤ªè‰°éš¾äº†ã€‚</p>
<p>ä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨å„ç§ Git GUI å·¥å…·ã€‚</p>
</blockquote>
<p>åˆå¹¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°†åˆ†æ”¯åˆå¹¶åˆ°å½“å‰HEADä¸­</span></span><br><span class="line">$ git merge &lt;branch&gt;</span><br></pre></td></tr></table></figure>
<p>é‡ç½®ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°†å½“å‰HEADç‰ˆæœ¬é‡ç½®åˆ°åˆ†æ”¯ä¸­ï¼Œè¯·å‹¿é‡ç½®å·²å‘å¸ƒçš„æäº¤</span></span><br><span class="line">$ git rebase &lt;branch&gt;</span><br></pre></td></tr></table></figure>
<h3 id="github"><a class="markdownIt-Anchor" href="#github"></a> Github</h3>
<p>Github ä½œä¸ºæœ€è‘—åçš„ä»£ç å¼€æºåä½œç¤¾åŒºï¼Œåœ¨ç¨‹åºå‘˜åœˆæƒ³å¿…æ— äººä¸çŸ¥ï¼Œæ— äººä¸æ™“ã€‚</p>
<p>è¿™é‡Œä¸èµ˜è¿° Github çš„ç”¨æ³•ï¼Œç¡®å®æœ‰ä¸ä¼šç”¨çš„æ–°æ‰‹åŒå­¦ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ•™ç¨‹ï¼š<a href="https://guides.github.com/" target="_blank" rel="noopener">https://guides.github.com/</a></p>
<h4 id="clone-æ–¹å¼"><a class="markdownIt-Anchor" href="#clone-æ–¹å¼"></a> clone æ–¹å¼</h4>
<p>Git æ”¯æŒä¸‰ç§åè®®ï¼šHTTPS / SSH / GIT</p>
<p>è€Œ Github ä¸Šæ”¯æŒ HTTPS å’Œ SSHã€‚</p>
<p>HTTPS è¿™ç§æ–¹å¼è¦æ±‚ä½ æ¯æ¬¡ push æ—¶éƒ½è¦è¾“å…¥ç”¨æˆ·åã€å¯†ç ï¼Œæœ‰äº›ç¹çã€‚</p>
<p>è€Œ SSH è¦æ±‚ä½ æœ¬åœ°ç”Ÿæˆè¯ä¹¦ï¼Œç„¶ååœ¨ä½ çš„ Github è´¦æˆ·ä¸­æ³¨å†Œã€‚ç¬¬ä¸€æ¬¡é…ç½®éº»çƒ¦æ˜¯éº»çƒ¦äº†ç‚¹ï¼Œä½†æ˜¯ä»¥åå°±å…å»äº†æ¯æ¬¡ push éœ€è¦è¾“å…¥ç”¨æˆ·åã€å¯†ç çš„ç¹çã€‚</p>
<div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-66f60822aeb2c21c.png"/></div>
<p>ä»¥ä¸‹ä»‹ç»ä»¥ä¸‹ï¼Œå¦‚ä½•ç”Ÿæˆè¯ä¹¦ï¼Œä»¥åŠåœ¨ Github ä¸­æ³¨å†Œã€‚</p>
<h4 id="ç”Ÿæˆ-ssh-å…¬é’¥"><a class="markdownIt-Anchor" href="#ç”Ÿæˆ-ssh-å…¬é’¥"></a> ç”Ÿæˆ SSH å…¬é’¥</h4>
<p>å¦‚å‰æ‰€è¿°ï¼Œè®¸å¤š Git æœåŠ¡å™¨éƒ½ä½¿ç”¨ SSH å…¬é’¥è¿›è¡Œè®¤è¯ã€‚ ä¸ºäº†å‘ Git æœåŠ¡å™¨æä¾› SSH å…¬é’¥ï¼Œå¦‚æœæŸç³»ç»Ÿç”¨æˆ·å°šæœªæ‹¥æœ‰å¯†é’¥ï¼Œå¿…é¡»äº‹å…ˆä¸ºå…¶ç”Ÿæˆä¸€ä»½ã€‚ è¿™ä¸ªè¿‡ç¨‹åœ¨æ‰€æœ‰æ“ä½œç³»ç»Ÿä¸Šéƒ½æ˜¯ç›¸ä¼¼çš„ã€‚ é¦–å…ˆï¼Œä½ éœ€è¦ç¡®è®¤è‡ªå·±æ˜¯å¦å·²ç»æ‹¥æœ‰å¯†é’¥ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨æˆ·çš„ SSH å¯†é’¥å­˜å‚¨åœ¨å…¶ <code>\~/.ssh</code> ç›®å½•ä¸‹ã€‚ è¿›å…¥è¯¥ç›®å½•å¹¶åˆ—å‡ºå…¶ä¸­å†…å®¹ï¼Œä½ ä¾¿å¯ä»¥å¿«é€Ÿç¡®è®¤è‡ªå·±æ˜¯å¦å·²æ‹¥æœ‰å¯†é’¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/.ssh</span><br><span class="line">$ ls</span><br><span class="line">authorized_keys2  id_dsa       known_hosts</span><br><span class="line">config            id_dsa.pub</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€å¯¹ä»¥ <code>id_dsa</code> æˆ– <code>id_rsa</code> å‘½åçš„æ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªå¸¦æœ‰ <code>.pub</code> æ‰©å±•åã€‚ <code>.pub</code> æ–‡ä»¶æ˜¯ä½ çš„å…¬é’¥ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯ç§é’¥ã€‚ å¦‚æœæ‰¾ä¸åˆ°è¿™æ ·çš„æ–‡ä»¶ï¼ˆæˆ–è€…æ ¹æœ¬æ²¡æœ‰ <code>.ssh</code> ç›®å½•ï¼‰ï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œ <code>ssh-keygen</code> ç¨‹åºæ¥åˆ›å»ºå®ƒä»¬ã€‚åœ¨ Linux/Mac ç³»ç»Ÿä¸­ï¼Œ<code>ssh-keygen</code> éš SSH è½¯ä»¶åŒ…æä¾›ï¼›åœ¨ Windows ä¸Šï¼Œè¯¥ç¨‹åºåŒ…å«äº MSysGit è½¯ä»¶åŒ…ä¸­ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/home/schacon/.ssh/id_rsa):</span><br><span class="line">Created directory <span class="string">'/home/schacon/.ssh'</span>.</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /home/schacon/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /home/schacon/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">d0:82:24:8e:d7:f1:bb:9b:33:53:96:93:49:da:9b:e3 schacon@mylaptop.local</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆ <code>ssh-keygen</code> ä¼šç¡®è®¤å¯†é’¥çš„å­˜å‚¨ä½ç½®ï¼ˆé»˜è®¤æ˜¯ <code>.ssh/id_rsa</code>ï¼‰ï¼Œç„¶åå®ƒä¼šè¦æ±‚ä½ è¾“å…¥ä¸¤æ¬¡å¯†é’¥å£ä»¤ã€‚å¦‚æœä½ ä¸æƒ³åœ¨ä½¿ç”¨å¯†é’¥æ—¶è¾“å…¥å£ä»¤ï¼Œå°†å…¶ç•™ç©ºå³å¯ã€‚</p>
<p>ç°åœ¨ï¼Œè¿›è¡Œäº†ä¸Šè¿°æ“ä½œçš„ç”¨æˆ·éœ€è¦å°†å„è‡ªçš„å…¬é’¥å‘é€ç»™ä»»æ„ä¸€ä¸ª Git æœåŠ¡å™¨ç®¡ç†å‘˜ï¼ˆå‡è®¾æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨åŸºäºå…¬é’¥çš„ SSH éªŒè¯è®¾ç½®ï¼‰ã€‚ ä»–ä»¬æ‰€è¦åšçš„å°±æ˜¯å¤åˆ¶å„è‡ªçš„ <code>.pub</code> æ–‡ä»¶å†…å®¹ï¼Œå¹¶å°†å…¶é€šè¿‡é‚®ä»¶å‘é€ã€‚ å…¬é’¥çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat ~/.ssh/id_rsa.pub</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAklOUpkDHrfHY17SbrmTIpNLTGK9Tjom/BWDSU</span><br><span class="line">GPl+nafzlHDTYW7hdI4yZ5ew18JH4JW9jbhUFrviQzM7xlELEVf4h9lFX5QVkbPppSwg0cda3</span><br><span class="line">Pbv7kOdJ/MTyBlWXFCR+HAo3FXRitBqxiX1nKhXpHAZsMciLq8V6RjsNAQwdsdMFvSlVK/7XA</span><br><span class="line">t3FaoJoAsncM1Q9x5+3V0Ww68/eIFmb1zuUFljQJKprrX88XypNDvjYNby6vw/Pb0rwert/En</span><br><span class="line">mZ+AW4OZPnTPI89ZPmVMLuayrD2cE86Z/il8b+gw3r3+1nKatmIkjn2so1d01QraTlMqVSsbx</span><br><span class="line">NrRFi9wrf+M7Q== schacon@mylaptop.local</span><br></pre></td></tr></table></figure>
<p>åœ¨ä½ çš„ Github è´¦æˆ·ä¸­ï¼Œä¾æ¬¡ç‚¹å‡» <strong>Settings</strong> &gt; <strong>SSH and GPG keys</strong> &gt; <strong>New SSH key</strong></p>
<p>ç„¶åï¼Œå°†ä¸Šé¢ç”Ÿæˆçš„å…¬é’¥å†…å®¹ç²˜è´´åˆ° <code>Key</code> ç¼–è¾‘æ¡†å¹¶ä¿å­˜ã€‚è‡³æ­¤å¤§åŠŸå‘Šæˆã€‚</p>
<p>åé¢ï¼Œä½ åœ¨å…‹éš†ä½ çš„ Github é¡¹ç›®æ—¶ä½¿ç”¨ SSH æ–¹å¼å³å¯ã€‚</p>
<p>å¦‚æœè§‰å¾—æˆ‘çš„è®²è§£è¿˜ä¸å¤Ÿç»†è‡´ï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://help.github.com/articles/adding-a-new-ssh-key-to-your-github-account/" target="_blank" rel="noopener">https://help.github.com/articles/adding-a-new-ssh-key-to-your-github-account/</a></p>
<h2 id="æœ€ä½³å®è·µ-git-flow"><a class="markdownIt-Anchor" href="#æœ€ä½³å®è·µ-git-flow"></a> æœ€ä½³å®è·µ Git Flow</h2>
<blockquote>
<p>è¯¦ç»†å†…å®¹ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="http://www.cnblogs.com/cnblogsfans/p/5075073.html" target="_blank" rel="noopener">Git åœ¨å›¢é˜Ÿä¸­çš„æœ€ä½³å®è·µâ€“å¦‚ä½•æ­£ç¡®ä½¿ç”¨ Git Flow</a></p>
</blockquote>
<p>Git åœ¨å®é™…å¼€å‘ä¸­çš„æœ€ä½³å®è·µç­–ç•¥ Git Flow å¯ä»¥å½’çº³ä¸ºä»¥ä¸‹ï¼š</p>
<ul>
<li><strong><code>master</code> åˆ†æ”¯</strong> - ä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„ä¸»çº¿åˆ†æ”¯ï¼Œè¿™ä¸ªåˆ†æ”¯æ˜¯æœ€è¿‘å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒçš„ä»£ç ï¼Œè¿™ä¸ªåˆ†æ”¯åªèƒ½ä»å…¶ä»–åˆ†æ”¯åˆå¹¶ï¼Œä¸èƒ½åœ¨è¿™ä¸ªåˆ†æ”¯ç›´æ¥ä¿®æ”¹ã€‚</li>
<li><strong><code>develop</code> åˆ†æ”¯</strong> - è¿™ä¸ªåˆ†æ”¯æ˜¯æˆ‘ä»¬çš„ä¸»å¼€å‘åˆ†æ”¯ï¼ŒåŒ…å«æ‰€æœ‰è¦å‘å¸ƒåˆ°ä¸‹ä¸€ä¸ª release çš„ä»£ç ï¼Œè¿™ä¸ªåˆ†æ”¯ä¸»è¦æ˜¯ä»å…¶ä»–åˆ†æ”¯åˆå¹¶ä»£ç è¿‡æ¥ï¼Œæ¯”å¦‚ feature åˆ†æ”¯ã€‚</li>
<li><strong><code>feature</code> åˆ†æ”¯</strong> - è¿™ä¸ªåˆ†æ”¯ä¸»è¦æ˜¯ç”¨æ¥å¼€å‘ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼Œä¸€æ—¦å¼€å‘å®Œæˆï¼Œæˆ‘ä»¬åˆå¹¶å› develop åˆ†æ”¯è¿›å…¥ä¸‹ä¸€ä¸ª releaseã€‚</li>
<li><strong><code>release</code> åˆ†æ”¯</strong> - å½“ä½ éœ€è¦ä¸€ä¸ªå‘å¸ƒä¸€ä¸ªæ–° release çš„æ—¶å€™ï¼Œæˆ‘ä»¬åŸºäº Develop åˆ†æ”¯åˆ›å»ºä¸€ä¸ª release åˆ†æ”¯ï¼Œå®Œæˆ release åï¼Œæˆ‘ä»¬åˆå¹¶åˆ° master å’Œ develop åˆ†æ”¯ã€‚</li>
<li><strong><code>hotfix</code> åˆ†æ”¯</strong> - å½“æˆ‘ä»¬åœ¨ master å‘ç°æ–°çš„ Bug æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª hotfix, å®Œæˆ hotfix åï¼Œæˆ‘ä»¬åˆå¹¶å› master å’Œ develop åˆ†æ”¯ï¼Œæ‰€ä»¥ hotfix çš„æ”¹åŠ¨ä¼šè¿›å…¥ä¸‹ä¸€ä¸ª releaseã€‚</li>
</ul>
<h2 id="å¸¸è§é—®é¢˜"><a class="markdownIt-Anchor" href="#å¸¸è§é—®é¢˜"></a> å¸¸è§é—®é¢˜</h2>
<h3 id="ç¼–è¾‘æäº¤editting-commits"><a class="markdownIt-Anchor" href="#ç¼–è¾‘æäº¤editting-commits"></a> ç¼–è¾‘æäº¤(editting commits)</h3>
<h4 id="æˆ‘åˆšæ‰æäº¤äº†ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#æˆ‘åˆšæ‰æäº¤äº†ä»€ä¹ˆ"></a> æˆ‘åˆšæ‰æäº¤äº†ä»€ä¹ˆ</h4>
<p>å¦‚æœä½ ç”¨ <code>git commit -a</code> æäº¤äº†ä¸€æ¬¡å˜åŒ–(changes)ï¼Œè€Œä½ åˆä¸ç¡®å®šåˆ°åº•è¿™æ¬¡æäº¤äº†å“ªäº›å†…å®¹ã€‚ ä½ å°±å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ˜¾ç¤ºå½“å‰<code>HEAD</code>ä¸Šçš„æœ€è¿‘ä¸€æ¬¡çš„æäº¤(commit):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git show</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> -n1 -p</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘çš„æäº¤ä¿¡æ¯commit-messageå†™é”™äº†"><a class="markdownIt-Anchor" href="#æˆ‘çš„æäº¤ä¿¡æ¯commit-messageå†™é”™äº†"></a> æˆ‘çš„æäº¤ä¿¡æ¯(commit message)å†™é”™äº†</h4>
<p>å¦‚æœä½ çš„æäº¤ä¿¡æ¯(commit message)å†™é”™äº†ä¸”è¿™æ¬¡æäº¤(commit)è¿˜æ²¡æœ‰æ¨(push), ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ¥ä¿®æ”¹æäº¤ä¿¡æ¯(commit message):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git commit --amend</span><br></pre></td></tr></table></figure>
<p>è¿™ä¼šæ‰“å¼€ä½ çš„é»˜è®¤ç¼–è¾‘å™¨, åœ¨è¿™é‡Œä½ å¯ä»¥ç¼–è¾‘ä¿¡æ¯. å¦ä¸€æ–¹é¢, ä½ ä¹Ÿå¯ä»¥ç”¨ä¸€æ¡å‘½ä»¤ä¸€æ¬¡å®Œæˆ:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git commit --amend -m <span class="string">'xxxxxxx'</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ å·²ç»æ¨(push)äº†è¿™æ¬¡æäº¤(commit), ä½ å¯ä»¥ä¿®æ”¹è¿™æ¬¡æäº¤(commit)ç„¶åå¼ºæ¨(force push), ä½†æ˜¯ä¸æ¨èè¿™ä¹ˆåšã€‚</p>
<h4 id="æˆ‘æäº¤commité‡Œçš„ç”¨æˆ·åå’Œé‚®ç®±ä¸å¯¹"><a class="markdownIt-Anchor" href="#æˆ‘æäº¤commité‡Œçš„ç”¨æˆ·åå’Œé‚®ç®±ä¸å¯¹"></a> æˆ‘æäº¤(commit)é‡Œçš„ç”¨æˆ·åå’Œé‚®ç®±ä¸å¯¹</h4>
<p>å¦‚æœè¿™åªæ˜¯å•ä¸ªæäº¤(commit)ï¼Œä¿®æ”¹å®ƒï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git commit --amend --author <span class="string">"New Authorname &lt;authoremail@mydomain.com&gt;"</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ éœ€è¦ä¿®æ”¹æ‰€æœ‰å†å², å‚è€ƒ 'git filter-branchâ€™çš„æŒ‡å—é¡µ.</p>
<h4 id="æˆ‘æƒ³ä»ä¸€ä¸ªæäº¤commité‡Œç§»é™¤ä¸€ä¸ªæ–‡ä»¶"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³ä»ä¸€ä¸ªæäº¤commité‡Œç§»é™¤ä¸€ä¸ªæ–‡ä»¶"></a> æˆ‘æƒ³ä»ä¸€ä¸ªæäº¤(commit)é‡Œç§»é™¤ä¸€ä¸ªæ–‡ä»¶</h4>
<p>é€šè¿‡ä¸‹é¢çš„æ–¹æ³•ï¼Œä»ä¸€ä¸ªæäº¤(commit)é‡Œç§»é™¤ä¸€ä¸ªæ–‡ä»¶:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git checkout HEAD^ myfile</span><br><span class="line">$ git add -A</span><br><span class="line">$ git commit --amend</span><br></pre></td></tr></table></figure>
<p>è¿™å°†éå¸¸æœ‰ç”¨ï¼Œå½“ä½ æœ‰ä¸€ä¸ªå¼€æ”¾çš„è¡¥ä¸(open patch)ï¼Œä½ å¾€ä¸Šé¢æäº¤äº†ä¸€ä¸ªä¸å¿…è¦çš„æ–‡ä»¶ï¼Œä½ éœ€è¦å¼ºæ¨(force push)å»æ›´æ–°è¿™ä¸ªè¿œç¨‹è¡¥ä¸ã€‚</p>
<h4 id="æˆ‘æƒ³åˆ é™¤æˆ‘çš„çš„æœ€åä¸€æ¬¡æäº¤commit"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³åˆ é™¤æˆ‘çš„çš„æœ€åä¸€æ¬¡æäº¤commit"></a> æˆ‘æƒ³åˆ é™¤æˆ‘çš„çš„æœ€åä¸€æ¬¡æäº¤(commit)</h4>
<p>å¦‚æœä½ éœ€è¦åˆ é™¤æ¨äº†çš„æäº¤(pushed commits)ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ã€‚å¯æ˜¯ï¼Œè¿™ä¼šä¸å¯é€†çš„æ”¹å˜ä½ çš„å†å²ï¼Œä¹Ÿä¼šæä¹±é‚£äº›å·²ç»ä»è¯¥ä»“åº“æ‹‰å–(pulled)äº†çš„äººçš„å†å²ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœä½ ä¸æ˜¯å¾ˆç¡®å®šï¼Œåƒä¸‡ä¸è¦è¿™ä¹ˆåšã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git reset HEAD^ --hard</span><br><span class="line">$ git push -f [remote] [branch]</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ è¿˜æ²¡æœ‰æ¨åˆ°è¿œç¨‹, æŠŠ Git é‡ç½®(reset)åˆ°ä½ æœ€åä¸€æ¬¡æäº¤å‰çš„çŠ¶æ€å°±å¯ä»¥äº†(åŒæ—¶ä¿å­˜æš‚å­˜çš„å˜åŒ–):</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">my</span>-branch*)$ git <span class="keyword">reset</span> --soft HEAD@&#123;1&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™åªèƒ½åœ¨æ²¡æœ‰æ¨é€ä¹‹å‰æœ‰ç”¨. å¦‚æœä½ å·²ç»æ¨äº†, å”¯ä¸€å®‰å…¨èƒ½åšçš„æ˜¯ <code>git revert SHAofBadCommit</code>ï¼Œ é‚£ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤(commit)ç”¨äºæ’¤æ¶ˆå‰ä¸€ä¸ªæäº¤çš„æ‰€æœ‰å˜åŒ–(changes)ï¼› æˆ–è€…, å¦‚æœä½ æ¨çš„è¿™ä¸ªåˆ†æ”¯æ˜¯ rebase-safe çš„ (ä¾‹å¦‚ï¼š å…¶å®ƒå¼€å‘è€…ä¸ä¼šä»è¿™ä¸ªåˆ†æ”¯æ‹‰), åªéœ€è¦ä½¿ç”¨ <code>git push -f</code>ï¼› æ›´å¤š, è¯·å‚è€ƒ <a href="#deleteremove-last-pushed-commit">the above section</a>ã€‚</p>
<h4 id="åˆ é™¤ä»»æ„æäº¤commit"><a class="markdownIt-Anchor" href="#åˆ é™¤ä»»æ„æäº¤commit"></a> åˆ é™¤ä»»æ„æäº¤(commit)</h4>
<p>åŒæ ·çš„è­¦å‘Šï¼šä¸åˆ°ä¸‡ä¸å¾—å·²çš„æ—¶å€™ä¸è¦è¿™ä¹ˆåš.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git rebase --onto SHA1_OF_BAD_COMMIT^ SHA1_OF_BAD_COMMIT</span><br><span class="line">$ git push -f [remote] [branch]</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…åšä¸€ä¸ª <a href="#interactive-rebase">äº¤äº’å¼ rebase</a> åˆ é™¤é‚£äº›ä½ æƒ³è¦åˆ é™¤çš„æäº¤(commit)é‡Œæ‰€å¯¹åº”çš„è¡Œã€‚</p>
<h4 id="æˆ‘å°è¯•æ¨ä¸€ä¸ªä¿®æ­£åçš„æäº¤amended-commitåˆ°è¿œç¨‹ä½†æ˜¯æŠ¥é”™"><a class="markdownIt-Anchor" href="#æˆ‘å°è¯•æ¨ä¸€ä¸ªä¿®æ­£åçš„æäº¤amended-commitåˆ°è¿œç¨‹ä½†æ˜¯æŠ¥é”™"></a> æˆ‘å°è¯•æ¨ä¸€ä¸ªä¿®æ­£åçš„æäº¤(amended commit)åˆ°è¿œç¨‹ï¼Œä½†æ˜¯æŠ¥é”™ï¼š</h4>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">To https://github.com/yourusername/repo.git</span><br><span class="line">! [rejected]        mybranch -&gt; mybranch (non-fast-forward)</span><br><span class="line">error: failed to push some refs to <span class="string">'https://github.com/tanay1337/webmaker.org.git'</span></span><br><span class="line">hint: Updates were rejected because the tip of your current branch is behind</span><br><span class="line">hint: its remote counterpart. Integrate the remote changes (e.g.</span><br><span class="line">hint: <span class="string">'git pull ...'</span>) before pushing again.</span><br><span class="line">hint: See the <span class="string">'Note about fast-forwards'</span> <span class="keyword">in</span> <span class="string">'git push --help'</span> <span class="keyword">for</span> details.</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„, rebasing(è§ä¸‹é¢)å’Œä¿®æ­£(amending)ä¼šç”¨ä¸€ä¸ª<strong>æ–°çš„æäº¤(commit)ä»£æ›¿æ—§çš„</strong>, æ‰€ä»¥å¦‚æœä¹‹å‰ä½ å·²ç»å¾€è¿œç¨‹ä»“åº“ä¸Šæ¨è¿‡ä¸€æ¬¡ä¿®æ­£å‰çš„æäº¤(commit)ï¼Œé‚£ä½ ç°åœ¨å°±å¿…é¡»å¼ºæ¨(force push) (<code>-f</code>)ã€‚ æ³¨æ„ â€“ <em>æ€»æ˜¯</em> ç¡®ä¿ä½ æŒ‡æ˜ä¸€ä¸ªåˆ†æ”¯!</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git push origin mybranch -f</span><br></pre></td></tr></table></figure>
<p>ä¸€èˆ¬æ¥è¯´, <strong>è¦é¿å…å¼ºæ¨</strong>. æœ€å¥½æ˜¯åˆ›å»ºå’Œæ¨(push)ä¸€ä¸ªæ–°çš„æäº¤(commit)ï¼Œè€Œä¸æ˜¯å¼ºæ¨ä¸€ä¸ªä¿®æ­£åçš„æäº¤ã€‚åè€…ä¼šä½¿é‚£äº›ä¸è¯¥åˆ†æ”¯æˆ–è¯¥åˆ†æ”¯çš„å­åˆ†æ”¯å·¥ä½œçš„å¼€å‘è€…ï¼Œåœ¨æºå†å²ä¸­äº§ç”Ÿå†²çªã€‚</p>
<h4 id="æˆ‘æ„å¤–çš„åšäº†ä¸€æ¬¡ç¡¬é‡ç½®hard-resetæˆ‘æƒ³æ‰¾å›æˆ‘çš„å†…å®¹"><a class="markdownIt-Anchor" href="#æˆ‘æ„å¤–çš„åšäº†ä¸€æ¬¡ç¡¬é‡ç½®hard-resetæˆ‘æƒ³æ‰¾å›æˆ‘çš„å†…å®¹"></a> æˆ‘æ„å¤–çš„åšäº†ä¸€æ¬¡ç¡¬é‡ç½®(hard reset)ï¼Œæˆ‘æƒ³æ‰¾å›æˆ‘çš„å†…å®¹</h4>
<p>å¦‚æœä½ æ„å¤–çš„åšäº† <code>git reset --hard</code>, ä½ é€šå¸¸èƒ½æ‰¾å›ä½ çš„æäº¤(commit), å› ä¸º Git å¯¹æ¯ä»¶äº‹éƒ½ä¼šæœ‰æ—¥å¿—ï¼Œä¸”éƒ½ä¼šä¿å­˜å‡ å¤©ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git reflog</span><br></pre></td></tr></table></figure>
<p>ä½ å°†ä¼šçœ‹åˆ°ä¸€ä¸ªä½ è¿‡å»æäº¤(commit)çš„åˆ—è¡¨, å’Œä¸€ä¸ªé‡ç½®çš„æäº¤ã€‚ é€‰æ‹©ä½ æƒ³è¦å›åˆ°çš„æäº¤(commit)çš„ SHAï¼Œå†é‡ç½®ä¸€æ¬¡:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git reset --hard SHA1234</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å®Œæˆäº†ã€‚</p>
<h3 id="æš‚å­˜staging"><a class="markdownIt-Anchor" href="#æš‚å­˜staging"></a> æš‚å­˜(Staging)</h3>
<h4 id="æˆ‘éœ€è¦æŠŠæš‚å­˜çš„å†…å®¹æ·»åŠ åˆ°ä¸Šä¸€æ¬¡çš„æäº¤commit"><a class="markdownIt-Anchor" href="#æˆ‘éœ€è¦æŠŠæš‚å­˜çš„å†…å®¹æ·»åŠ åˆ°ä¸Šä¸€æ¬¡çš„æäº¤commit"></a> æˆ‘éœ€è¦æŠŠæš‚å­˜çš„å†…å®¹æ·»åŠ åˆ°ä¸Šä¸€æ¬¡çš„æäº¤(commit)</h4>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch*)$ git commit --amend</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³è¦æš‚å­˜ä¸€ä¸ªæ–°æ–‡ä»¶çš„ä¸€éƒ¨åˆ†è€Œä¸æ˜¯è¿™ä¸ªæ–‡ä»¶çš„å…¨éƒ¨"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³è¦æš‚å­˜ä¸€ä¸ªæ–°æ–‡ä»¶çš„ä¸€éƒ¨åˆ†è€Œä¸æ˜¯è¿™ä¸ªæ–‡ä»¶çš„å…¨éƒ¨"></a> æˆ‘æƒ³è¦æš‚å­˜ä¸€ä¸ªæ–°æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯è¿™ä¸ªæ–‡ä»¶çš„å…¨éƒ¨</h4>
<p>ä¸€èˆ¬æ¥è¯´, å¦‚æœä½ æƒ³æš‚å­˜ä¸€ä¸ªæ–‡ä»¶çš„ä¸€éƒ¨åˆ†, ä½ å¯è¿™æ ·åš:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git add --patch filename.x</span><br></pre></td></tr></table></figure>
<p><code>-p</code> ç®€å†™ã€‚è¿™ä¼šæ‰“å¼€äº¤äº’æ¨¡å¼ï¼Œ ä½ å°†èƒ½å¤Ÿç”¨ <code>s</code> é€‰é¡¹æ¥åˆ†éš”æäº¤(commit)ï¼› ç„¶è€Œ, å¦‚æœè¿™ä¸ªæ–‡ä»¶æ˜¯æ–°çš„, ä¼šæ²¡æœ‰è¿™ä¸ªé€‰æ‹©ï¼Œ æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶æ—¶, è¿™æ ·åš:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git add -N filename.x</span><br></pre></td></tr></table></figure>
<p>ç„¶å, ä½ éœ€è¦ç”¨ <code>e</code> é€‰é¡¹æ¥æ‰‹åŠ¨é€‰æ‹©éœ€è¦æ·»åŠ çš„è¡Œï¼Œæ‰§è¡Œ <code>git diff --cached</code> å°†ä¼šæ˜¾ç¤ºå“ªäº›è¡Œæš‚å­˜äº†å“ªäº›è¡Œåªæ˜¯ä¿å­˜åœ¨æœ¬åœ°äº†ã€‚</p>
<h4 id="æˆ‘æƒ³æŠŠåœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œçš„å˜åŒ–changesåŠ åˆ°ä¸¤ä¸ªæäº¤commité‡Œ"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³æŠŠåœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œçš„å˜åŒ–changesåŠ åˆ°ä¸¤ä¸ªæäº¤commité‡Œ"></a> æˆ‘æƒ³æŠŠåœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œçš„å˜åŒ–(changes)åŠ åˆ°ä¸¤ä¸ªæäº¤(commit)é‡Œ</h4>
<p><code>git add</code> ä¼šæŠŠæ•´ä¸ªæ–‡ä»¶åŠ å…¥åˆ°ä¸€ä¸ªæäº¤. <code>git add -p</code> å…è®¸äº¤äº’å¼çš„é€‰æ‹©ä½ æƒ³è¦æäº¤çš„éƒ¨åˆ†.</p>
<h4 id="æˆ‘æƒ³æŠŠæš‚å­˜çš„å†…å®¹å˜æˆæœªæš‚å­˜æŠŠæœªæš‚å­˜çš„å†…å®¹æš‚å­˜èµ·æ¥"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³æŠŠæš‚å­˜çš„å†…å®¹å˜æˆæœªæš‚å­˜æŠŠæœªæš‚å­˜çš„å†…å®¹æš‚å­˜èµ·æ¥"></a> æˆ‘æƒ³æŠŠæš‚å­˜çš„å†…å®¹å˜æˆæœªæš‚å­˜ï¼ŒæŠŠæœªæš‚å­˜çš„å†…å®¹æš‚å­˜èµ·æ¥</h4>
<p>è¿™ä¸ªæœ‰ç‚¹å›°éš¾ï¼Œ æˆ‘èƒ½æƒ³åˆ°çš„æœ€å¥½çš„æ–¹æ³•æ˜¯å…ˆ stash æœªæš‚å­˜çš„å†…å®¹ï¼Œ ç„¶åé‡ç½®(reset)ï¼Œå† pop ç¬¬ä¸€æ­¥ stashed çš„å†…å®¹, æœ€åå† add å®ƒä»¬ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git stash -k</span><br><span class="line">$ git reset --hard</span><br><span class="line">$ git stash pop</span><br><span class="line">$ git add -A</span><br></pre></td></tr></table></figure>
<h3 id="æœªæš‚å­˜unstagedçš„å†…å®¹"><a class="markdownIt-Anchor" href="#æœªæš‚å­˜unstagedçš„å†…å®¹"></a> æœªæš‚å­˜(Unstaged)çš„å†…å®¹</h3>
<h4 id="æˆ‘æƒ³æŠŠæœªæš‚å­˜çš„å†…å®¹ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³æŠŠæœªæš‚å­˜çš„å†…å®¹ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯"></a> æˆ‘æƒ³æŠŠæœªæš‚å­˜çš„å†…å®¹ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯</h4>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git checkout -b my-branch</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³æŠŠæœªæš‚å­˜çš„å†…å®¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå·²å­˜åœ¨çš„åˆ†æ”¯"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³æŠŠæœªæš‚å­˜çš„å†…å®¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå·²å­˜åœ¨çš„åˆ†æ”¯"></a> æˆ‘æƒ³æŠŠæœªæš‚å­˜çš„å†…å®¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå·²å­˜åœ¨çš„åˆ†æ”¯</h4>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git stash</span><br><span class="line">$ git checkout my-branch</span><br><span class="line">$ git stash pop</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³ä¸¢å¼ƒæœ¬åœ°æœªæäº¤çš„å˜åŒ–uncommitted-changes"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³ä¸¢å¼ƒæœ¬åœ°æœªæäº¤çš„å˜åŒ–uncommitted-changes"></a> æˆ‘æƒ³ä¸¢å¼ƒæœ¬åœ°æœªæäº¤çš„å˜åŒ–(uncommitted changes)</h4>
<p>å¦‚æœä½ åªæ˜¯æƒ³é‡ç½®æº(origin)å’Œä½ æœ¬åœ°(local)ä¹‹é—´çš„ä¸€äº›æäº¤(commit)ï¼Œä½ å¯ä»¥ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">## one commit</span></span><br><span class="line">(my-branch)$ git reset --hard HEAD^</span><br><span class="line"><span class="comment">## two commits</span></span><br><span class="line">(my-branch)$ git reset --hard HEAD^^</span><br><span class="line"><span class="comment">## four commits</span></span><br><span class="line">(my-branch)$ git reset --hard HEAD~4</span><br><span class="line"><span class="comment">## or</span></span><br><span class="line">(master)$ git checkout -f</span><br></pre></td></tr></table></figure>
<p>é‡ç½®æŸä¸ªç‰¹æ®Šçš„æ–‡ä»¶, ä½ å¯ä»¥ç”¨æ–‡ä»¶ååšä¸ºå‚æ•°:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git reset filename</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³ä¸¢å¼ƒæŸäº›æœªæš‚å­˜çš„å†…å®¹"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³ä¸¢å¼ƒæŸäº›æœªæš‚å­˜çš„å†…å®¹"></a> æˆ‘æƒ³ä¸¢å¼ƒæŸäº›æœªæš‚å­˜çš„å†…å®¹</h4>
<p>å¦‚æœä½ æƒ³ä¸¢å¼ƒå·¥ä½œæ‹·è´ä¸­çš„ä¸€éƒ¨åˆ†å†…å®¹ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ã€‚</p>
<p>ç­¾å‡º(checkout)ä¸éœ€è¦çš„å†…å®¹ï¼Œä¿ç•™éœ€è¦çš„ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git checkout -p</span><br><span class="line"><span class="comment">## Answer y to all of the snippets you want to drop</span></span><br></pre></td></tr></table></figure>
<p>å¦å¤–ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨ <code>stash</code>ï¼Œ Stash æ‰€æœ‰è¦ä¿ç•™ä¸‹çš„å†…å®¹, é‡ç½®å·¥ä½œæ‹·è´, é‡æ–°åº”ç”¨ä¿ç•™çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git stash -p</span><br><span class="line"><span class="comment">## Select all of the snippets you want to save</span></span><br><span class="line">$ git reset --hard</span><br><span class="line">$ git stash pop</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…, stash ä½ ä¸éœ€è¦çš„éƒ¨åˆ†, ç„¶å stash dropã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git stash -p</span><br><span class="line"><span class="comment">## Select all of the snippets you don't want to save</span></span><br><span class="line">$ git stash drop</span><br></pre></td></tr></table></figure>
<h3 id="åˆ†æ”¯branches"><a class="markdownIt-Anchor" href="#åˆ†æ”¯branches"></a> åˆ†æ”¯(Branches)</h3>
<h4 id="æˆ‘ä»é”™è¯¯çš„åˆ†æ”¯æ‹‰å–äº†å†…å®¹æˆ–æŠŠå†…å®¹æ‹‰å–åˆ°äº†é”™è¯¯çš„åˆ†æ”¯"><a class="markdownIt-Anchor" href="#æˆ‘ä»é”™è¯¯çš„åˆ†æ”¯æ‹‰å–äº†å†…å®¹æˆ–æŠŠå†…å®¹æ‹‰å–åˆ°äº†é”™è¯¯çš„åˆ†æ”¯"></a> æˆ‘ä»é”™è¯¯çš„åˆ†æ”¯æ‹‰å–äº†å†…å®¹ï¼Œæˆ–æŠŠå†…å®¹æ‹‰å–åˆ°äº†é”™è¯¯çš„åˆ†æ”¯</h4>
<p>è¿™æ˜¯å¦å¤–ä¸€ç§ä½¿ç”¨ <code>git reflog</code> æƒ…å†µï¼Œæ‰¾åˆ°åœ¨è¿™æ¬¡é”™è¯¯æ‹‰(pull) ä¹‹å‰ HEAD çš„æŒ‡å‘ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git reflog</span><br><span class="line">ab7555f HEAD@&#123;0&#125;: pull origin wrong-branch: Fast-forward</span><br><span class="line">c5bc55a HEAD@&#123;1&#125;: checkout: checkout message goes here</span><br></pre></td></tr></table></figure>
<p>é‡ç½®åˆ†æ”¯åˆ°ä½ æ‰€éœ€çš„æäº¤(desired commit):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git reset --hard c5bc55a</span><br></pre></td></tr></table></figure>
<p>å®Œæˆã€‚</p>
<h4 id="æˆ‘æƒ³æ‰”æ‰æœ¬åœ°çš„æäº¤commitä»¥ä¾¿æˆ‘çš„åˆ†æ”¯ä¸è¿œç¨‹çš„ä¿æŒä¸€è‡´"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³æ‰”æ‰æœ¬åœ°çš„æäº¤commitä»¥ä¾¿æˆ‘çš„åˆ†æ”¯ä¸è¿œç¨‹çš„ä¿æŒä¸€è‡´"></a> æˆ‘æƒ³æ‰”æ‰æœ¬åœ°çš„æäº¤(commit)ï¼Œä»¥ä¾¿æˆ‘çš„åˆ†æ”¯ä¸è¿œç¨‹çš„ä¿æŒä¸€è‡´</h4>
<p>å…ˆç¡®è®¤ä½ æ²¡æœ‰æ¨(push)ä½ çš„å†…å®¹åˆ°è¿œç¨‹ã€‚</p>
<p><code>git status</code> ä¼šæ˜¾ç¤ºä½ é¢†å…ˆ(ahead)æº(origin)å¤šå°‘ä¸ªæäº¤:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git status</span><br><span class="line"><span class="comment">## On branch my-branch</span></span><br><span class="line"><span class="comment">## Your branch is ahead of 'origin/my-branch' by 2 commits.</span></span><br><span class="line"><span class="comment">##   (use "git push" to publish your local commits)</span></span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p>ä¸€ç§æ–¹æ³•æ˜¯:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git reset --hard origin/my-branch</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘éœ€è¦æäº¤åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯ä½†é”™è¯¯çš„æäº¤åˆ°äº†-master"><a class="markdownIt-Anchor" href="#æˆ‘éœ€è¦æäº¤åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯ä½†é”™è¯¯çš„æäº¤åˆ°äº†-master"></a> æˆ‘éœ€è¦æäº¤åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯ï¼Œä½†é”™è¯¯çš„æäº¤åˆ°äº† master</h4>
<p>åœ¨ master ä¸‹åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ï¼Œä¸åˆ‡æ¢åˆ°æ–°åˆ†æ”¯,ä»åœ¨ master ä¸‹:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git branch my-branch</span><br></pre></td></tr></table></figure>
<p>æŠŠ master åˆ†æ”¯é‡ç½®åˆ°å‰ä¸€ä¸ªæäº¤:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git reset --hard HEAD^</span><br></pre></td></tr></table></figure>
<p><code>HEAD^</code> æ˜¯ <code>HEAD^1</code> çš„ç®€å†™ï¼Œä½ å¯ä»¥é€šè¿‡æŒ‡å®šè¦è®¾ç½®çš„<code>HEAD</code>æ¥è¿›ä¸€æ­¥é‡ç½®ã€‚</p>
<p>æˆ–è€…, å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ <code>HEAD^</code>, æ‰¾åˆ°ä½ æƒ³é‡ç½®åˆ°çš„æäº¤(commit)çš„ hash(<code>git log</code> èƒ½å¤Ÿå®Œæˆ)ï¼Œ ç„¶åé‡ç½®åˆ°è¿™ä¸ª hashã€‚ ä½¿ç”¨<code>git push</code> åŒæ­¥å†…å®¹åˆ°è¿œç¨‹ã€‚</p>
<p>ä¾‹å¦‚, master åˆ†æ”¯æƒ³é‡ç½®åˆ°çš„æäº¤çš„ hash ä¸º<code>a13b85e</code>:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git reset --hard a13b85e</span><br><span class="line">HEAD is now at a13b85e</span><br></pre></td></tr></table></figure>
<p>ç­¾å‡º(checkout)åˆšæ‰æ–°å»ºçš„åˆ†æ”¯ç»§ç»­å·¥ä½œ:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git checkout my-branch</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³ä¿ç•™æ¥è‡ªå¦å¤–ä¸€ä¸ª-ref-ish-çš„æ•´ä¸ªæ–‡ä»¶"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³ä¿ç•™æ¥è‡ªå¦å¤–ä¸€ä¸ª-ref-ish-çš„æ•´ä¸ªæ–‡ä»¶"></a> æˆ‘æƒ³ä¿ç•™æ¥è‡ªå¦å¤–ä¸€ä¸ª ref-ish çš„æ•´ä¸ªæ–‡ä»¶</h4>
<p>å‡è®¾ä½ æ­£åœ¨åšä¸€ä¸ªåŸå‹æ–¹æ¡ˆ(åŸæ–‡ä¸º working spike (see note)), æœ‰æˆç™¾çš„å†…å®¹ï¼Œæ¯ä¸ªéƒ½å·¥ä½œå¾—å¾ˆå¥½ã€‚ç°åœ¨, ä½ æäº¤åˆ°äº†ä¸€ä¸ªåˆ†æ”¯ï¼Œä¿å­˜å·¥ä½œå†…å®¹:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(solution)$ git add -A &amp;&amp; git commit -m <span class="string">"Adding all changes from this spike into one big commit."</span></span><br></pre></td></tr></table></figure>
<p>å½“ä½ æƒ³è¦æŠŠå®ƒæ”¾åˆ°ä¸€ä¸ªåˆ†æ”¯é‡Œ (å¯èƒ½æ˜¯<code>feature</code>, æˆ–è€… <code>develop</code>), ä½ å…³å¿ƒæ˜¯ä¿æŒæ•´ä¸ªæ–‡ä»¶çš„å®Œæ•´ï¼Œä½ æƒ³è¦ä¸€ä¸ªå¤§çš„æäº¤åˆ†éš”æˆæ¯”è¾ƒå°ã€‚</p>
<p>å‡è®¾ä½ æœ‰:</p>
<ul>
<li>åˆ†æ”¯ <code>solution</code>, æ‹¥æœ‰åŸå‹æ–¹æ¡ˆï¼Œ é¢†å…ˆ <code>develop</code> åˆ†æ”¯ã€‚</li>
<li>åˆ†æ”¯ <code>develop</code>, åœ¨è¿™é‡Œä½ åº”ç”¨åŸå‹æ–¹æ¡ˆçš„ä¸€äº›å†…å®¹ã€‚</li>
</ul>
<p>æˆ‘å»å¯ä»¥é€šè¿‡æŠŠå†…å®¹æ‹¿åˆ°ä½ çš„åˆ†æ”¯é‡Œï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(develop)$ git checkout solution -- file1.txt</span><br></pre></td></tr></table></figure>
<p>è¿™ä¼šæŠŠè¿™ä¸ªæ–‡ä»¶å†…å®¹ä»åˆ†æ”¯ <code>solution</code> æ‹¿åˆ°åˆ†æ”¯ <code>develop</code> é‡Œæ¥:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">## On branch develop</span></span><br><span class="line"><span class="comment">## Your branch is up-to-date with 'origin/develop'.</span></span><br><span class="line"><span class="comment">## Changes to be committed:</span></span><br><span class="line"><span class="comment">##  (use "git reset HEAD &lt;file&gt;..." to unstage)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">##        modified:   file1.txt</span></span><br></pre></td></tr></table></figure>
<p>ç„¶å, æ­£å¸¸æäº¤ã€‚</p>
<p>Note: Spike solutions are made to analyze or solve the problem. These solutions are used for estimation and discarded once everyone gets clear visualization of the problem. ~ <a href="https://en.wikipedia.org/wiki/Extreme_programming_practices" target="_blank" rel="noopener">Wikipedia</a>.</p>
<h4 id="æˆ‘æŠŠå‡ ä¸ªæäº¤commitæäº¤åˆ°äº†åŒä¸€ä¸ªåˆ†æ”¯è€Œè¿™äº›æäº¤åº”è¯¥åˆ†å¸ƒåœ¨ä¸åŒçš„åˆ†æ”¯é‡Œ"><a class="markdownIt-Anchor" href="#æˆ‘æŠŠå‡ ä¸ªæäº¤commitæäº¤åˆ°äº†åŒä¸€ä¸ªåˆ†æ”¯è€Œè¿™äº›æäº¤åº”è¯¥åˆ†å¸ƒåœ¨ä¸åŒçš„åˆ†æ”¯é‡Œ"></a> æˆ‘æŠŠå‡ ä¸ªæäº¤(commit)æäº¤åˆ°äº†åŒä¸€ä¸ªåˆ†æ”¯ï¼Œè€Œè¿™äº›æäº¤åº”è¯¥åˆ†å¸ƒåœ¨ä¸åŒçš„åˆ†æ”¯é‡Œ</h4>
<p>å‡è®¾ä½ æœ‰ä¸€ä¸ª<code>master</code>åˆ†æ”¯ï¼Œ æ‰§è¡Œ<code>git log</code>, ä½ çœ‹åˆ°ä½ åšè¿‡ä¸¤æ¬¡æäº¤:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git <span class="built_in">log</span></span><br><span class="line"></span><br><span class="line">commit e3851e817c451cc36f2e6f3049db528415e3c114</span><br><span class="line">Author: Alex Lee &lt;alexlee@example.com&gt;</span><br><span class="line">Date:   Tue Jul 22 15:39:27 2014 -0400</span><br><span class="line"></span><br><span class="line">    Bug <span class="comment">#21 - Added CSRF protection</span></span><br><span class="line"></span><br><span class="line">commit 5ea51731d150f7ddc4a365437931cd8be3bf3131</span><br><span class="line">Author: Alex Lee &lt;alexlee@example.com&gt;</span><br><span class="line">Date:   Tue Jul 22 15:39:12 2014 -0400</span><br><span class="line"></span><br><span class="line">    Bug <span class="comment">#14 - Fixed spacing on title</span></span><br><span class="line"></span><br><span class="line">commit a13b85e984171c6e2a1729bb061994525f626d14</span><br><span class="line">Author: Aki Rose &lt;akirose@example.com&gt;</span><br><span class="line">Date:   Tue Jul 21 01:12:48 2014 -0400</span><br><span class="line"></span><br><span class="line">    First commit</span><br></pre></td></tr></table></figure>
<p>è®©æˆ‘ä»¬ç”¨æäº¤ hash(commit hash)æ ‡è®° bug (<code>e3851e8</code> for #21, <code>5ea5173</code> for #14).</p>
<p>é¦–å…ˆ, æˆ‘ä»¬æŠŠ<code>master</code>åˆ†æ”¯é‡ç½®åˆ°æ­£ç¡®çš„æäº¤(<code>a13b85e</code>):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git reset --hard a13b85e</span><br><span class="line">HEAD is now at a13b85e</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨, æˆ‘ä»¬å¯¹ bug #21 åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git checkout -b 21</span><br><span class="line">(21)$</span><br></pre></td></tr></table></figure>
<p>æ¥ç€, æˆ‘ä»¬ç”¨ <em>cherry-pick</em> æŠŠå¯¹ bug #21 çš„æäº¤æ”¾å…¥å½“å‰åˆ†æ”¯ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬å°†åº”ç”¨(apply)è¿™ä¸ªæäº¤(commit)ï¼Œä»…ä»…è¿™ä¸€ä¸ªæäº¤(commit)ï¼Œç›´æ¥åœ¨ HEAD ä¸Šé¢ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(21)$ git cherry-pick e3851e8</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™, è¿™é‡Œå¯èƒ½ä¼šäº§ç”Ÿå†²çªï¼Œ å‚è§<a href="#interactive-rebase">äº¤äº’å¼ rebasing ç« </a> <a href="#merge-conflict"><strong>å†²çªèŠ‚</strong></a> è§£å†³å†²çª.</p>
<p>å†è€…ï¼Œ æˆ‘ä»¬ä¸º bug #14 åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯, ä¹ŸåŸºäº<code>master</code>åˆ†æ”¯</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(21)$ git checkout master</span><br><span class="line">(master)$ git checkout -b 14</span><br><span class="line">(14)$</span><br></pre></td></tr></table></figure>
<p>æœ€å, ä¸º bug #14 æ‰§è¡Œ <code>cherry-pick</code>:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(14)$ git cherry-pick 5ea5173</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³åˆ é™¤ä¸Šæ¸¸upstreamåˆ†æ”¯è¢«åˆ é™¤äº†çš„æœ¬åœ°åˆ†æ”¯"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³åˆ é™¤ä¸Šæ¸¸upstreamåˆ†æ”¯è¢«åˆ é™¤äº†çš„æœ¬åœ°åˆ†æ”¯"></a> æˆ‘æƒ³åˆ é™¤ä¸Šæ¸¸(upstream)åˆ†æ”¯è¢«åˆ é™¤äº†çš„æœ¬åœ°åˆ†æ”¯</h4>
<p>ä¸€æ—¦ä½ åœ¨ github ä¸Šé¢åˆå¹¶(merge)äº†ä¸€ä¸ª pull request, ä½ å°±å¯ä»¥åˆ é™¤ä½  fork é‡Œè¢«åˆå¹¶çš„åˆ†æ”¯ã€‚ å¦‚æœä½ ä¸å‡†å¤‡ç»§ç»­åœ¨è¿™ä¸ªåˆ†æ”¯é‡Œå·¥ä½œ, åˆ é™¤è¿™ä¸ªåˆ†æ”¯çš„æœ¬åœ°æ‹·è´ä¼šæ›´å¹²å‡€ï¼Œä½¿ä½ ä¸ä¼šé™·å…¥å·¥ä½œåˆ†æ”¯å’Œä¸€å †é™ˆæ—§åˆ†æ”¯çš„æ··ä¹±ä¹‹ä¸­ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git fetch -p</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘ä¸å°å¿ƒåˆ é™¤äº†æˆ‘çš„åˆ†æ”¯"><a class="markdownIt-Anchor" href="#æˆ‘ä¸å°å¿ƒåˆ é™¤äº†æˆ‘çš„åˆ†æ”¯"></a> æˆ‘ä¸å°å¿ƒåˆ é™¤äº†æˆ‘çš„åˆ†æ”¯</h4>
<p>å¦‚æœä½ å®šæœŸæ¨é€åˆ°è¿œç¨‹, å¤šæ•°æƒ…å†µä¸‹åº”è¯¥æ˜¯å®‰å…¨çš„ï¼Œä½†æœ‰äº›æ—¶å€™è¿˜æ˜¯å¯èƒ½åˆ é™¤äº†è¿˜æ²¡æœ‰æ¨åˆ°è¿œç¨‹çš„åˆ†æ”¯ã€‚ è®©æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªåˆ†æ”¯å’Œä¸€ä¸ªæ–°çš„æ–‡ä»¶:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git checkout -b my-branch</span><br><span class="line">(my-branch)$ git branch</span><br><span class="line">(my-branch)$ touch foo.txt</span><br><span class="line">(my-branch)$ ls</span><br><span class="line">README.md foo.txt</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ æ–‡ä»¶å¹¶åšä¸€æ¬¡æäº¤</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git add .</span><br><span class="line">(my-branch)$ git commit -m <span class="string">'foo.txt added'</span></span><br><span class="line">(my-branch)$ foo.txt added</span><br><span class="line"> 1 files changed, 1 insertions(+)</span><br><span class="line"> create mode 100644 foo.txt</span><br><span class="line">(my-branch)$ git <span class="built_in">log</span></span><br><span class="line"></span><br><span class="line">commit 4e3cd85a670ced7cc17a2b5d8d3d809ac88d5012</span><br><span class="line">Author: siemiatj &lt;siemiatj@example.com&gt;</span><br><span class="line">Date:   Wed Jul 30 00:34:10 2014 +0200</span><br><span class="line"></span><br><span class="line">    foo.txt added</span><br><span class="line"></span><br><span class="line">commit 69204cdf0acbab201619d95ad8295928e7f411d5</span><br><span class="line">Author: Kate Hudson &lt;katehudson@example.com&gt;</span><br><span class="line">Date:   Tue Jul 29 13:14:46 2014 -0400</span><br><span class="line"></span><br><span class="line">    Fixes <span class="comment">#6: Force pushing after amending commits</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬åˆ‡å›åˆ°ä¸»(master)åˆ†æ”¯ï¼Œâ€˜ä¸å°å¿ƒçš„â€™åˆ é™¤<code>my-branch</code>åˆ†æ”¯</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git checkout master</span><br><span class="line">Switched to branch <span class="string">'master'</span></span><br><span class="line">Your branch is up-to-date with <span class="string">'origin/master'</span>.</span><br><span class="line">(master)$ git branch -D my-branch</span><br><span class="line">Deleted branch my-branch (was 4e3cd85).</span><br><span class="line">(master)$ <span class="built_in">echo</span> oh noes, deleted my branch!</span><br><span class="line">oh noes, deleted my branch!</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™æ—¶å€™ä½ åº”è¯¥æƒ³èµ·äº†<code>reflog</code>, ä¸€ä¸ªå‡çº§ç‰ˆçš„æ—¥å¿—ï¼Œå®ƒå­˜å‚¨äº†ä»“åº“(repo)é‡Œé¢æ‰€æœ‰åŠ¨ä½œçš„å†å²ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">(master)$ git <span class="built_in">ref</span>log</span><br><span class="line"><span class="number">69204</span>cd <span class="symbol">HEAD@</span>&#123;<span class="number">0</span>&#125;: checkout: moving <span class="keyword">from</span> my-branch to master</span><br><span class="line"><span class="number">4e3</span>cd85 <span class="symbol">HEAD@</span>&#123;<span class="number">1</span>&#125;: commit: foo.txt added</span><br><span class="line"><span class="number">69204</span>cd <span class="symbol">HEAD@</span>&#123;<span class="number">2</span>&#125;: checkout: moving <span class="keyword">from</span> master to my-branch</span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¥è‡ªåˆ é™¤åˆ†æ”¯çš„æäº¤ hash(commit hash)ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹æ˜¯å¦èƒ½æ¢å¤åˆ é™¤äº†çš„åˆ†æ”¯ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git checkout -b my-branch-help</span><br><span class="line">Switched to a new branch <span class="string">'my-branch-help'</span></span><br><span class="line">(my-branch-help)$ git reset --hard 4e3cd85</span><br><span class="line">HEAD is now at 4e3cd85 foo.txt added</span><br><span class="line">(my-branch-help)$ ls</span><br><span class="line">README.md foo.txt</span><br></pre></td></tr></table></figure>
<p>çœ‹! æˆ‘ä»¬æŠŠåˆ é™¤çš„æ–‡ä»¶æ‰¾å›æ¥äº†ã€‚ Git çš„ <code>reflog</code> åœ¨ rebasing å‡ºé”™çš„æ—¶å€™ä¹Ÿæ˜¯åŒæ ·æœ‰ç”¨çš„ã€‚</p>
<h4 id="æˆ‘æƒ³åˆ é™¤ä¸€ä¸ªåˆ†æ”¯"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³åˆ é™¤ä¸€ä¸ªåˆ†æ”¯"></a> æˆ‘æƒ³åˆ é™¤ä¸€ä¸ªåˆ†æ”¯</h4>
<p>åˆ é™¤ä¸€ä¸ªè¿œç¨‹åˆ†æ”¯:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git push origin --delete my-branch</span><br></pre></td></tr></table></figure>
<p>ä½ ä¹Ÿå¯ä»¥:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git push origin :my-branch</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤ä¸€ä¸ªæœ¬åœ°åˆ†æ”¯:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git branch -D my-branch</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³ä»åˆ«äººæ­£åœ¨å·¥ä½œçš„è¿œç¨‹åˆ†æ”¯ç­¾å‡ºcheckoutä¸€ä¸ªåˆ†æ”¯"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³ä»åˆ«äººæ­£åœ¨å·¥ä½œçš„è¿œç¨‹åˆ†æ”¯ç­¾å‡ºcheckoutä¸€ä¸ªåˆ†æ”¯"></a> æˆ‘æƒ³ä»åˆ«äººæ­£åœ¨å·¥ä½œçš„è¿œç¨‹åˆ†æ”¯ç­¾å‡º(checkout)ä¸€ä¸ªåˆ†æ”¯</h4>
<p>é¦–å…ˆ, ä»è¿œç¨‹æ‹‰å–(fetch) æ‰€æœ‰åˆ†æ”¯:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git fetch --all</span><br></pre></td></tr></table></figure>
<p>å‡è®¾ä½ æƒ³è¦ä»è¿œç¨‹çš„<code>daves</code>åˆ†æ”¯ç­¾å‡ºåˆ°æœ¬åœ°çš„<code>daves</code></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git checkout --track origin/daves</span><br><span class="line">Branch daves <span class="built_in">set</span> up to track remote branch daves from origin.</span><br><span class="line">Switched to a new branch <span class="string">'daves'</span></span><br></pre></td></tr></table></figure>
<p>(<code>--track</code> æ˜¯ <code>git checkout -b [branch] [remotename]/[branch]</code> çš„ç®€å†™)</p>
<p>è¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ª<code>daves</code>åˆ†æ”¯çš„æœ¬åœ°æ‹·è´, ä»»ä½•æ¨è¿‡(pushed)çš„æ›´æ–°ï¼Œè¿œç¨‹éƒ½èƒ½çœ‹åˆ°.</p>
<h3 id="rebasing-å’Œåˆå¹¶merging"><a class="markdownIt-Anchor" href="#rebasing-å’Œåˆå¹¶merging"></a> Rebasing å’Œåˆå¹¶(Merging)</h3>
<h4 id="æˆ‘æƒ³æ’¤é”€-rebasemerge"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³æ’¤é”€-rebasemerge"></a> æˆ‘æƒ³æ’¤é”€ rebase/merge</h4>
<p>ä½ å¯ä»¥åˆå¹¶(merge)æˆ– rebase äº†ä¸€ä¸ªé”™è¯¯çš„åˆ†æ”¯, æˆ–è€…å®Œæˆä¸äº†ä¸€ä¸ªè¿›è¡Œä¸­çš„ rebase/mergeã€‚ Git åœ¨è¿›è¡Œå±é™©æ“ä½œçš„æ—¶å€™ä¼šæŠŠåŸå§‹çš„ HEAD ä¿å­˜åœ¨ä¸€ä¸ªå« ORIG_HEAD çš„å˜é‡é‡Œ, æ‰€ä»¥è¦æŠŠåˆ†æ”¯æ¢å¤åˆ° rebase/merge å‰çš„çŠ¶æ€æ˜¯å¾ˆå®¹æ˜“çš„ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git reset --hard ORIG_HEAD</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘å·²ç»-rebase-è¿‡-ä½†æ˜¯æˆ‘ä¸æƒ³å¼ºæ¨force-push"><a class="markdownIt-Anchor" href="#æˆ‘å·²ç»-rebase-è¿‡-ä½†æ˜¯æˆ‘ä¸æƒ³å¼ºæ¨force-push"></a> æˆ‘å·²ç» rebase è¿‡, ä½†æ˜¯æˆ‘ä¸æƒ³å¼ºæ¨(force push)</h4>
<p>ä¸å¹¸çš„æ˜¯ï¼Œå¦‚æœä½ æƒ³æŠŠè¿™äº›å˜åŒ–(changes)ååº”åˆ°è¿œç¨‹åˆ†æ”¯ä¸Šï¼Œä½ å°±å¿…é¡»å¾—å¼ºæ¨(force push)ã€‚ æ˜¯å› ä½ å¿«è¿›(Fast forward)äº†æäº¤ï¼Œæ”¹å˜äº† Git å†å², è¿œç¨‹åˆ†æ”¯ä¸ä¼šæ¥å—å˜åŒ–(changes)ï¼Œé™¤éå¼ºæ¨(force push)ã€‚è¿™å°±æ˜¯è®¸å¤šäººä½¿ç”¨ merge å·¥ä½œæµ, è€Œä¸æ˜¯ rebasing å·¥ä½œæµçš„ä¸»è¦åŸå› ä¹‹ä¸€ï¼Œ å¼€å‘è€…çš„å¼ºæ¨(force push)ä¼šä½¿å¤§çš„å›¢é˜Ÿé™·å…¥éº»çƒ¦ã€‚ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ï¼Œä¸€ç§å®‰å…¨ä½¿ç”¨ rebase çš„æ–¹æ³•æ˜¯ï¼Œä¸è¦æŠŠä½ çš„å˜åŒ–(changes)åæ˜ åˆ°è¿œç¨‹åˆ†æ”¯ä¸Š, è€Œæ˜¯æŒ‰ä¸‹é¢çš„åš:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git checkout my-branch</span><br><span class="line">(my-branch)$ git rebase -i master</span><br><span class="line">(my-branch)$ git checkout master</span><br><span class="line">(master)$ git merge --ff-only my-branch</span><br></pre></td></tr></table></figure>
<p>æ›´å¤š, å‚è§ <a href="http://stackoverflow.com/questions/11058312/how-can-i-use-git-rebase-without-requiring-a-forced-push" target="_blank" rel="noopener">this SO thread</a>.</p>
<h4 id="æˆ‘éœ€è¦ç»„åˆcombineå‡ ä¸ªæäº¤commit"><a class="markdownIt-Anchor" href="#æˆ‘éœ€è¦ç»„åˆcombineå‡ ä¸ªæäº¤commit"></a> æˆ‘éœ€è¦ç»„åˆ(combine)å‡ ä¸ªæäº¤(commit)</h4>
<p>å‡è®¾ä½ çš„å·¥ä½œåˆ†æ”¯å°†ä¼šåšå¯¹äº <code>master</code> çš„ pull-requestã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ä½ ä¸å…³å¿ƒæäº¤(commit)çš„æ—¶é—´æˆ³ï¼Œåªæƒ³ç»„åˆ <em>æ‰€æœ‰</em> æäº¤(commit) åˆ°ä¸€ä¸ªå•ç‹¬çš„é‡Œé¢, ç„¶åé‡ç½®(reset)é‡æäº¤(recommit)ã€‚ ç¡®ä¿ä¸»(master)åˆ†æ”¯æ˜¯æœ€æ–°çš„å’Œä½ çš„å˜åŒ–éƒ½å·²ç»æäº¤äº†, ç„¶å:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git reset --soft master</span><br><span class="line">(my-branch)$ git commit -am <span class="string">"New awesome feature"</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ æƒ³è¦æ›´å¤šçš„æ§åˆ¶, æƒ³è¦ä¿ç•™æ—¶é—´æˆ³, ä½ éœ€è¦åšäº¤äº’å¼ rebase (interactive rebase):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git rebase -i master</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ²¡æœ‰ç›¸å¯¹çš„å…¶å®ƒåˆ†æ”¯ï¼Œ ä½ å°†ä¸å¾—ä¸ç›¸å¯¹è‡ªå·±çš„<code>HEAD</code> è¿›è¡Œ rebaseã€‚ ä¾‹å¦‚ï¼šä½ æƒ³ç»„åˆæœ€è¿‘çš„ä¸¤æ¬¡æäº¤(commit), ä½ å°†ç›¸å¯¹äº<code>HEAD\~2</code> è¿›è¡Œ rebaseï¼Œ ç»„åˆæœ€è¿‘ 3 æ¬¡æäº¤(commit), ç›¸å¯¹äº<code>HEAD\~3</code>, ç­‰ç­‰ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git rebase -i HEAD~2</span><br></pre></td></tr></table></figure>
<p>åœ¨ä½ æ‰§è¡Œäº†äº¤äº’å¼ rebase çš„å‘½ä»¤(interactive rebase command)å, ä½ å°†åœ¨ä½ çš„ç¼–è¾‘å™¨é‡Œçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„å†…å®¹:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">pick a9c8a1d Some refactoring</span><br><span class="line">pick <span class="number">01</span>b2fd8 New awesome feature</span><br><span class="line">pick b729ad5 fixup</span><br><span class="line">pick e3851e8 another <span class="keyword">fix</span></span><br><span class="line"></span><br><span class="line">## Rebase <span class="number">8074</span>d12..b729ad5 onto <span class="number">8074</span>d12</span><br><span class="line">#</span><br><span class="line">## Command<span class="variable">s:</span></span><br><span class="line">##  <span class="keyword">p</span>, pick = use commit</span><br><span class="line">##  r, reword = use commit, but <span class="keyword">edit</span> the commit message</span><br><span class="line">##  <span class="keyword">e</span>, <span class="keyword">edit</span> = use commit, but <span class="keyword">stop</span> <span class="keyword">for</span> amending</span><br><span class="line">##  s, squash = use commit, but meld into <span class="keyword">previous</span> commit</span><br><span class="line">##  <span class="keyword">f</span>, fixup = like <span class="string">"squash"</span>, but discard this commit<span class="string">'s log message</span></span><br><span class="line"><span class="string">##  x, exec = run command (the rest of the line) using shell</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string">## These lines can be re-ordered; they are executed from top to bottom.</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string">## If you remove a line here THAT COMMIT WILL BE LOST.</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string">## However, if you remove everything, the rebase will be aborted.</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string">## Note that empty commits are commented out</span></span><br></pre></td></tr></table></figure>
<p>æ‰€æœ‰ä»¥ <code>#</code> å¼€å¤´çš„è¡Œéƒ½æ˜¯æ³¨é‡Š, ä¸ä¼šå½±å“ rebase.</p>
<p>ç„¶åï¼Œä½ å¯ä»¥ç”¨ä»»ä½•ä¸Šé¢å‘½ä»¤åˆ—è¡¨çš„å‘½ä»¤æ›¿æ¢ <code>pick</code>, ä½ ä¹Ÿå¯ä»¥é€šè¿‡åˆ é™¤å¯¹åº”çš„è¡Œæ¥åˆ é™¤ä¸€ä¸ªæäº¤(commit)ã€‚</p>
<p>ä¾‹å¦‚, å¦‚æœä½ æƒ³ <strong>å•ç‹¬ä¿ç•™æœ€æ—§(first)çš„æäº¤(commit),ç»„åˆæ‰€æœ‰å‰©ä¸‹çš„åˆ°ç¬¬äºŒä¸ªé‡Œé¢</strong>, ä½ å°±åº”è¯¥ç¼–è¾‘ç¬¬äºŒä¸ªæäº¤(commit)åé¢çš„æ¯ä¸ªæäº¤(commit) å‰çš„å•è¯ä¸º <code>f</code>:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">pick a9c8a1d Some refactoring</span><br><span class="line">pick <span class="number">01</span>b2fd8 New awesome feature</span><br><span class="line"><span class="keyword">f</span> b729ad5 fixup</span><br><span class="line"><span class="keyword">f</span> e3851e8 another <span class="keyword">fix</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ æƒ³ç»„åˆè¿™äº›æäº¤(commit) <strong>å¹¶é‡å‘½åè¿™ä¸ªæäº¤(commit)</strong>, ä½ åº”è¯¥åœ¨ç¬¬äºŒä¸ªæäº¤(commit)æ—è¾¹æ·»åŠ ä¸€ä¸ª<code>r</code>ï¼Œæˆ–è€…æ›´ç®€å•çš„ç”¨<code>s</code> æ›¿ä»£ <code>f</code>:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">pick a9c8a1d Some refactoring</span><br><span class="line">pick <span class="number">01</span>b2fd8 New awesome feature</span><br><span class="line">s b729ad5 fixup</span><br><span class="line">s e3851e8 another <span class="keyword">fix</span></span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥åœ¨æ¥ä¸‹æ¥å¼¹å‡ºçš„æ–‡æœ¬æç¤ºæ¡†é‡Œé‡å‘½åæäº¤(commit)ã€‚</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">Newer, awesomer features</span><br><span class="line"></span><br><span class="line">## Please enter the commit message <span class="keyword">for</span> your <span class="keyword">changes</span>. Lines starting</span><br><span class="line">## with <span class="string">'#'</span> will <span class="keyword">be</span> ignored, <span class="built_in">and</span> <span class="keyword">an</span> <span class="built_in">empty</span> message aborts the commit.</span><br><span class="line">## rebase in progress; onto 8074d12</span><br><span class="line">## You are currently editing <span class="keyword">a</span> commit <span class="keyword">while</span> rebasing branch <span class="string">'master'</span> <span class="keyword">on</span> <span class="string">'8074d12'</span>.</span><br><span class="line">#</span><br><span class="line">## Changes <span class="keyword">to</span> <span class="keyword">be</span> committed:</span><br><span class="line">#	modified:   README.md</span><br><span class="line">#</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆåŠŸäº†, ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„å†…å®¹:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ Successfully rebased and updated refs/heads/master.</span><br></pre></td></tr></table></figure>
<h5 id="å®‰å…¨åˆå¹¶mergingç­–ç•¥"><a class="markdownIt-Anchor" href="#å®‰å…¨åˆå¹¶mergingç­–ç•¥"></a> å®‰å…¨åˆå¹¶(merging)ç­–ç•¥</h5>
<p><code>--no-commit</code> æ‰§è¡Œåˆå¹¶(merge)ä½†ä¸è‡ªåŠ¨æäº¤, ç»™ç”¨æˆ·åœ¨åšæäº¤å‰æ£€æŸ¥å’Œä¿®æ”¹çš„æœºä¼šã€‚ <code>no-ff</code> ä¼šä¸ºç‰¹æ€§åˆ†æ”¯(feature branch)çš„å­˜åœ¨è¿‡ç•™ä¸‹è¯æ®, ä¿æŒé¡¹ç›®å†å²ä¸€è‡´ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git merge --no-ff --no-commit my-branch</span><br></pre></td></tr></table></figure>
<h5 id="æˆ‘éœ€è¦å°†ä¸€ä¸ªåˆ†æ”¯åˆå¹¶æˆä¸€ä¸ªæäº¤commit"><a class="markdownIt-Anchor" href="#æˆ‘éœ€è¦å°†ä¸€ä¸ªåˆ†æ”¯åˆå¹¶æˆä¸€ä¸ªæäº¤commit"></a> æˆ‘éœ€è¦å°†ä¸€ä¸ªåˆ†æ”¯åˆå¹¶æˆä¸€ä¸ªæäº¤(commit)</h5>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git merge --squash my-branch</span><br></pre></td></tr></table></figure>
<h5 id="æˆ‘åªæƒ³ç»„åˆcombineæœªæ¨çš„æäº¤unpushed-commit"><a class="markdownIt-Anchor" href="#æˆ‘åªæƒ³ç»„åˆcombineæœªæ¨çš„æäº¤unpushed-commit"></a> æˆ‘åªæƒ³ç»„åˆ(combine)æœªæ¨çš„æäº¤(unpushed commit)</h5>
<p>æœ‰æ—¶å€™ï¼Œåœ¨å°†æ•°æ®æ¨å‘ä¸Šæ¸¸ä¹‹å‰ï¼Œä½ æœ‰å‡ ä¸ªæ­£åœ¨è¿›è¡Œçš„å·¥ä½œæäº¤(commit)ã€‚è¿™æ—¶å€™ä¸å¸Œæœ›æŠŠå·²ç»æ¨(push)è¿‡çš„ç»„åˆè¿›æ¥ï¼Œå› ä¸ºå…¶ä»–äººå¯èƒ½å·²ç»æœ‰æäº¤(commit)å¼•ç”¨å®ƒä»¬äº†ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git rebase -i @&#123;u&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¼šäº§ç”Ÿä¸€æ¬¡äº¤äº’å¼çš„ rebase(interactive rebase), åªä¼šåˆ—å‡ºæ²¡æœ‰æ¨(push)çš„æäº¤(commit)ï¼Œ åœ¨è¿™ä¸ªåˆ—è¡¨æ—¶è¿›è¡Œ reorder/fix/squash éƒ½æ˜¯å®‰å…¨çš„ã€‚</p>
<h4 id="æ£€æŸ¥æ˜¯å¦åˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤commitéƒ½åˆå¹¶mergeè¿‡äº†"><a class="markdownIt-Anchor" href="#æ£€æŸ¥æ˜¯å¦åˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤commitéƒ½åˆå¹¶mergeè¿‡äº†"></a> æ£€æŸ¥æ˜¯å¦åˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤(commit)éƒ½åˆå¹¶(merge)è¿‡äº†</h4>
<p>æ£€æŸ¥ä¸€ä¸ªåˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤(commit)æ˜¯å¦éƒ½å·²ç»åˆå¹¶(merge)åˆ°äº†å…¶å®ƒåˆ†æ”¯, ä½ åº”è¯¥åœ¨è¿™äº›åˆ†æ”¯çš„ head(æˆ–ä»»ä½• commits)ä¹‹é—´åšä¸€æ¬¡ diff:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git <span class="built_in">log</span> --graph --left-right --cherry-pick --oneline HEAD...feature/120-on-scroll</span><br></pre></td></tr></table></figure>
<p>è¿™ä¼šå‘Šè¯‰ä½ åœ¨ä¸€ä¸ªåˆ†æ”¯é‡Œæœ‰è€Œå¦ä¸€ä¸ªåˆ†æ”¯æ²¡æœ‰çš„æ‰€æœ‰æäº¤(commit), å’Œåˆ†æ”¯ä¹‹é—´ä¸å…±äº«çš„æäº¤(commit)çš„åˆ—è¡¨ã€‚ å¦ä¸€ä¸ªåšæ³•å¯ä»¥æ˜¯:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git <span class="built_in">log</span> master ^feature/120-on-scroll --no-merges</span><br></pre></td></tr></table></figure>
<h4 id="äº¤äº’å¼-rebaseinteractive-rebaseå¯èƒ½å‡ºç°çš„é—®é¢˜"><a class="markdownIt-Anchor" href="#äº¤äº’å¼-rebaseinteractive-rebaseå¯èƒ½å‡ºç°çš„é—®é¢˜"></a> äº¤äº’å¼ rebase(interactive rebase)å¯èƒ½å‡ºç°çš„é—®é¢˜</h4>
<h5 id="è¿™ä¸ª-rebase-ç¼–è¾‘å±å¹•å‡ºç°noop"><a class="markdownIt-Anchor" href="#è¿™ä¸ª-rebase-ç¼–è¾‘å±å¹•å‡ºç°noop"></a> è¿™ä¸ª rebase ç¼–è¾‘å±å¹•å‡ºç°â€™noopâ€™</h5>
<p>å¦‚æœä½ çœ‹åˆ°çš„æ˜¯è¿™æ ·:</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">noop</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ„å‘³ç€ä½  rebase çš„åˆ†æ”¯å’Œå½“å‰åˆ†æ”¯åœ¨åŒä¸€ä¸ªæäº¤(commit)ä¸Š, æˆ–è€… <em>é¢†å…ˆ(ahead)</em> å½“å‰åˆ†æ”¯ã€‚ ä½ å¯ä»¥å°è¯•:</p>
<ul>
<li>æ£€æŸ¥ç¡®ä¿ä¸»(master)åˆ†æ”¯æ²¡æœ‰é—®é¢˜</li>
<li>rebase <code>HEAD\~2</code> æˆ–è€…æ›´æ—©</li>
</ul>
<h5 id="æœ‰å†²çªçš„æƒ…å†µ"><a class="markdownIt-Anchor" href="#æœ‰å†²çªçš„æƒ…å†µ"></a> æœ‰å†²çªçš„æƒ…å†µ</h5>
<p>å¦‚æœä½ ä¸èƒ½æˆåŠŸçš„å®Œæˆ rebase, ä½ å¯èƒ½å¿…é¡»è¦è§£å†³å†²çªã€‚</p>
<p>é¦–å…ˆæ‰§è¡Œ <code>git status</code> æ‰¾å‡ºå“ªäº›æ–‡ä»¶æœ‰å†²çª:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git status</span><br><span class="line">On branch my-branch</span><br><span class="line">Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">  (use <span class="string">"git add &lt;file&gt;..."</span> to update what will be committed)</span><br><span class="line">  (use <span class="string">"git checkout -- &lt;file&gt;..."</span> to discard changes <span class="keyword">in</span> working directory)</span><br><span class="line"></span><br><span class="line">	modified:   README.md</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢, <code>README.md</code> æœ‰å†²çªã€‚ æ‰“å¼€è¿™ä¸ªæ–‡ä»¶æ‰¾åˆ°ç±»ä¼¼ä¸‹é¢çš„å†…å®¹:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span><br><span class="line">some code</span><br><span class="line">=========</span><br><span class="line">some code</span><br><span class="line">&gt;&gt;&gt;&gt;&gt;&gt;&gt; <span class="keyword">new</span>-commit</span><br></pre></td></tr></table></figure>
<p>ä½ éœ€è¦è§£å†³æ–°æäº¤çš„ä»£ç (ç¤ºä¾‹é‡Œ, ä»ä¸­é—´<code>==</code>çº¿åˆ°<code>new-commit</code>çš„åœ°æ–¹)ä¸<code>HEAD</code> ä¹‹é—´ä¸ä¸€æ ·çš„åœ°æ–¹.</p>
<p>æœ‰æ—¶å€™è¿™äº›åˆå¹¶éå¸¸å¤æ‚ï¼Œä½ åº”è¯¥ä½¿ç”¨å¯è§†åŒ–çš„å·®å¼‚ç¼–è¾‘å™¨(visual diff editor):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master*)$ git mergetool -t opendiff</span><br></pre></td></tr></table></figure>
<p>åœ¨ä½ è§£å†³å®Œæ‰€æœ‰å†²çªå’Œæµ‹è¯•è¿‡å, <code>git add</code> å˜åŒ–äº†çš„(changed)æ–‡ä»¶, ç„¶åç”¨<code>git rebase --continue</code> ç»§ç»­ rebaseã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git add README.md</span><br><span class="line">(my-branch)$ git rebase --<span class="built_in">continue</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœåœ¨è§£å†³å®Œæ‰€æœ‰çš„å†²çªè¿‡åï¼Œå¾—åˆ°äº†ä¸æäº¤å‰ä¸€æ ·çš„ç»“æœ, å¯ä»¥æ‰§è¡Œ<code>git rebase --skip</code>ã€‚</p>
<p>ä»»ä½•æ—¶å€™ä½ æƒ³ç»“æŸæ•´ä¸ª rebase è¿‡ç¨‹ï¼Œå›æ¥ rebase å‰çš„åˆ†æ”¯çŠ¶æ€, ä½ å¯ä»¥åš:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(my-branch)$ git rebase --abort</span><br></pre></td></tr></table></figure>
<h3 id="æ‚é¡¹miscellaneous-objects"><a class="markdownIt-Anchor" href="#æ‚é¡¹miscellaneous-objects"></a> æ‚é¡¹(Miscellaneous Objects)</h3>
<h4 id="å…‹éš†æ‰€æœ‰å­æ¨¡å—"><a class="markdownIt-Anchor" href="#å…‹éš†æ‰€æœ‰å­æ¨¡å—"></a> å…‹éš†æ‰€æœ‰å­æ¨¡å—</h4>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> --recursive git://github.com/foo/bar.git</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå·²ç»å…‹éš†äº†:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git submodule update --init --recursive</span><br></pre></td></tr></table></figure>
<h4 id="åˆ é™¤æ ‡ç­¾tag"><a class="markdownIt-Anchor" href="#åˆ é™¤æ ‡ç­¾tag"></a> åˆ é™¤æ ‡ç­¾(tag)</h4>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git tag -d &lt;tag_name&gt;</span><br><span class="line">$ git push &lt;remote&gt; :refs/tags/&lt;tag_name&gt;</span><br></pre></td></tr></table></figure>
<h4 id="æ¢å¤å·²åˆ é™¤æ ‡ç­¾tag"><a class="markdownIt-Anchor" href="#æ¢å¤å·²åˆ é™¤æ ‡ç­¾tag"></a> æ¢å¤å·²åˆ é™¤æ ‡ç­¾(tag)</h4>
<p>å¦‚æœä½ æƒ³æ¢å¤ä¸€ä¸ªå·²åˆ é™¤æ ‡ç­¾(tag), å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤: é¦–å…ˆ, éœ€è¦æ‰¾åˆ°æ— æ³•è®¿é—®çš„æ ‡ç­¾(unreachable tag):</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git fsck --unreachable | grep tag</span><br></pre></td></tr></table></figure>
<p>è®°ä¸‹è¿™ä¸ªæ ‡ç­¾(tag)çš„ hashï¼Œç„¶åç”¨ Git çš„ <a href="http://git-scm.com/docs/git-update-ref" target="_blank" rel="noopener">update-ref</a>:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git update-ref refs/tags/&lt;tag_name&gt; &lt;<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ä½ çš„æ ‡ç­¾(tag)åº”è¯¥å·²ç»æ¢å¤äº†ã€‚</p>
<h4 id="å·²åˆ é™¤è¡¥ä¸patch"><a class="markdownIt-Anchor" href="#å·²åˆ é™¤è¡¥ä¸patch"></a> å·²åˆ é™¤è¡¥ä¸(patch)</h4>
<p>å¦‚æœæŸäººåœ¨ GitHub ä¸Šç»™ä½ å‘äº†ä¸€ä¸ª pull request, ä½†æ˜¯ç„¶åä»–åˆ é™¤äº†ä»–è‡ªå·±çš„åŸå§‹ fork, ä½ å°†æ²¡æ³•å…‹éš†ä»–ä»¬çš„æäº¤(commit)æˆ–ä½¿ç”¨ <code>git am</code>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹, æœ€å¥½æ‰‹åŠ¨çš„æŸ¥çœ‹ä»–ä»¬çš„æäº¤(commit)ï¼Œå¹¶æŠŠå®ƒä»¬æ‹·è´åˆ°ä¸€ä¸ªæœ¬åœ°æ–°åˆ†æ”¯ï¼Œç„¶ååšæäº¤ã€‚</p>
<p>åšå®Œæäº¤å, å†ä¿®æ”¹ä½œè€…ï¼Œå‚è§<a href="#commit-wrong-author">å˜æ›´ä½œè€…</a>ã€‚ ç„¶å, åº”ç”¨å˜åŒ–, å†å‘èµ·ä¸€ä¸ªæ–°çš„ pull requestã€‚</p>
<h3 id="è·Ÿè¸ªæ–‡ä»¶tracking-files"><a class="markdownIt-Anchor" href="#è·Ÿè¸ªæ–‡ä»¶tracking-files"></a> è·Ÿè¸ªæ–‡ä»¶(Tracking Files)</h3>
<h4 id="æˆ‘åªæƒ³æ”¹å˜ä¸€ä¸ªæ–‡ä»¶åå­—çš„å¤§å°å†™è€Œä¸ä¿®æ”¹å†…å®¹"><a class="markdownIt-Anchor" href="#æˆ‘åªæƒ³æ”¹å˜ä¸€ä¸ªæ–‡ä»¶åå­—çš„å¤§å°å†™è€Œä¸ä¿®æ”¹å†…å®¹"></a> æˆ‘åªæƒ³æ”¹å˜ä¸€ä¸ªæ–‡ä»¶åå­—çš„å¤§å°å†™ï¼Œè€Œä¸ä¿®æ”¹å†…å®¹</h4>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git mv --force myfile MyFile</span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³ä»-git-åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ä½†ä¿ç•™è¯¥æ–‡ä»¶"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³ä»-git-åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ä½†ä¿ç•™è¯¥æ–‡ä»¶"></a> æˆ‘æƒ³ä» Git åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†ä¿ç•™è¯¥æ–‡ä»¶</h4>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git rm --cached log.txt</span><br></pre></td></tr></table></figure>
<h3 id="é…ç½®configuration"><a class="markdownIt-Anchor" href="#é…ç½®configuration"></a> é…ç½®(Configuration)</h3>
<h4 id="æˆ‘æƒ³ç»™ä¸€äº›-git-å‘½ä»¤æ·»åŠ åˆ«åalias"><a class="markdownIt-Anchor" href="#æˆ‘æƒ³ç»™ä¸€äº›-git-å‘½ä»¤æ·»åŠ åˆ«åalias"></a> æˆ‘æƒ³ç»™ä¸€äº› Git å‘½ä»¤æ·»åŠ åˆ«å(alias)</h4>
<p>åœ¨ OS X å’Œ Linux ä¸‹, ä½ çš„ Git çš„é…ç½®æ–‡ä»¶å‚¨å­˜åœ¨ <code>\~/.gitconfig</code>ã€‚æˆ‘åœ¨<code>[alias]</code> éƒ¨åˆ†æ·»åŠ äº†ä¸€äº›å¿«æ·åˆ«å(å’Œä¸€äº›æˆ‘å®¹æ˜“æ‹¼å†™é”™è¯¯çš„)ï¼Œå¦‚ä¸‹:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">[alias]</span><br><span class="line">    <span class="keyword">a</span> = <span class="built_in">add</span></span><br><span class="line">    amend = commit --amend</span><br><span class="line">    <span class="keyword">c</span> = commit</span><br><span class="line">    <span class="keyword">ca</span> = commit --amend</span><br><span class="line">    ci = commit -<span class="keyword">a</span></span><br><span class="line">    <span class="keyword">co</span> = checkout</span><br><span class="line">    d = diff</span><br><span class="line">    dc = diff --changed</span><br><span class="line">    <span class="keyword">ds</span> = diff --staged</span><br><span class="line">    <span class="keyword">f</span> = fetch</span><br><span class="line">    loll = <span class="built_in">log</span> --graph --decorate --pretty=oneline --abbrev-commit</span><br><span class="line">    <span class="keyword">m</span> = merge</span><br><span class="line">    one = <span class="built_in">log</span> --pretty=oneline</span><br><span class="line">    outstanding = rebase -i @&#123;<span class="keyword">u</span>&#125;</span><br><span class="line">    s = status</span><br><span class="line">    unpushed = <span class="built_in">log</span> @&#123;<span class="keyword">u</span>&#125;</span><br><span class="line">    wc = whatchanged</span><br><span class="line">    wip = rebase -i @&#123;<span class="keyword">u</span>&#125;</span><br><span class="line">    zap = fetch -<span class="keyword">p</span></span><br></pre></td></tr></table></figure>
<h4 id="æˆ‘æƒ³ç¼“å­˜ä¸€ä¸ªä»“åº“repositoryçš„ç”¨æˆ·åå’Œå¯†ç "><a class="markdownIt-Anchor" href="#æˆ‘æƒ³ç¼“å­˜ä¸€ä¸ªä»“åº“repositoryçš„ç”¨æˆ·åå’Œå¯†ç "></a> æˆ‘æƒ³ç¼“å­˜ä¸€ä¸ªä»“åº“(repository)çš„ç”¨æˆ·åå’Œå¯†ç </h4>
<p>ä½ å¯èƒ½æœ‰ä¸€ä¸ªä»“åº“éœ€è¦æˆæƒï¼Œè¿™æ—¶ä½ å¯ä»¥ç¼“å­˜ç”¨æˆ·åå’Œå¯†ç ï¼Œè€Œä¸ç”¨æ¯æ¬¡æ¨/æ‹‰(push/pull)çš„æ—¶å€™éƒ½è¾“å…¥ï¼ŒCredential helper èƒ½å¸®ä½ ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git config --global credential.helper cache</span><br><span class="line"><span class="comment">## Set git to use the credential memory cache</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git config --global credential.helper <span class="string">'cache --timeout=3600'</span></span><br><span class="line"><span class="comment">## Set the cache to timeout after 1 hour (setting is in seconds)</span></span><br></pre></td></tr></table></figure>
<h3 id="æˆ‘ä¸çŸ¥é“æˆ‘åšé”™äº†äº›ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#æˆ‘ä¸çŸ¥é“æˆ‘åšé”™äº†äº›ä»€ä¹ˆ"></a> æˆ‘ä¸çŸ¥é“æˆ‘åšé”™äº†äº›ä»€ä¹ˆ</h3>
<p>ä½ æŠŠäº‹æƒ…æç ¸äº†ï¼šä½  <code>é‡ç½®(reset)</code> äº†ä¸€äº›ä¸œè¥¿, æˆ–è€…ä½ åˆå¹¶äº†é”™è¯¯çš„åˆ†æ”¯, äº¦æˆ–ä½ å¼ºæ¨äº†åæ‰¾ä¸åˆ°ä½ è‡ªå·±çš„æäº¤(commit)äº†ã€‚æœ‰äº›æ—¶å€™, ä½ ä¸€ç›´éƒ½åšå¾—å¾ˆå¥½, ä½†ä½ æƒ³å›åˆ°ä»¥å‰çš„æŸä¸ªçŠ¶æ€ã€‚</p>
<p>è¿™å°±æ˜¯ <code>git reflog</code> çš„ç›®çš„ï¼Œ <code>reflog</code> è®°å½•å¯¹åˆ†æ”¯é¡¶ç«¯(the tip of a branch)çš„ä»»ä½•æ”¹å˜, å³ä½¿é‚£ä¸ªé¡¶ç«¯æ²¡æœ‰è¢«ä»»ä½•åˆ†æ”¯æˆ–æ ‡ç­¾å¼•ç”¨ã€‚åŸºæœ¬ä¸Š, æ¯æ¬¡ HEAD çš„æ”¹å˜, ä¸€æ¡æ–°çš„è®°å½•å°±ä¼šå¢åŠ åˆ°<code>reflog</code>ã€‚é—æ†¾çš„æ˜¯ï¼Œè¿™åªå¯¹æœ¬åœ°åˆ†æ”¯èµ·ä½œç”¨ï¼Œä¸”å®ƒåªè·Ÿè¸ªåŠ¨ä½œ (ä¾‹å¦‚ï¼Œä¸ä¼šè·Ÿè¸ªä¸€ä¸ªæ²¡æœ‰è¢«è®°å½•çš„æ–‡ä»¶çš„ä»»ä½•æ”¹å˜)ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">(master)$ git reflog</span><br><span class="line">0a2e358 HEAD@&#123;0&#125;: reset: moving to HEAD\~2</span><br><span class="line">0254ea7 HEAD@&#123;1&#125;: checkout: moving from 2.2 to master</span><br><span class="line">c10f740 HEAD@&#123;2&#125;: checkout: moving from master to 2.2</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ reflog å±•ç¤ºäº†ä» master åˆ†æ”¯ç­¾å‡º(checkout)åˆ° 2.2 åˆ†æ”¯ï¼Œç„¶åå†ç­¾å›ã€‚ é‚£é‡Œï¼Œè¿˜æœ‰ä¸€ä¸ªç¡¬é‡ç½®(hard reset)åˆ°ä¸€ä¸ªè¾ƒæ—§çš„æäº¤ã€‚æœ€æ–°çš„åŠ¨ä½œå‡ºç°åœ¨æœ€ä¸Šé¢ä»¥ <code>HEAD@{0}</code>æ ‡è¯†.</p>
<p>å¦‚æœäº‹å®è¯æ˜ä½ ä¸å°å¿ƒå›ç§»(move back)äº†æäº¤(commit), reflog ä¼šåŒ…å«ä½ ä¸å°å¿ƒå›ç§»å‰ master ä¸ŠæŒ‡å‘çš„æäº¤(0254ea7)ã€‚</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git reset --hard 0254ea7</span><br></pre></td></tr></table></figure>
<p>ç„¶åä½¿ç”¨ git reset å°±å¯ä»¥æŠŠ master æ”¹å›åˆ°ä¹‹å‰çš„ commitï¼Œè¿™æä¾›äº†ä¸€ä¸ªåœ¨å†å²è¢«æ„å¤–æ›´æ”¹æƒ…å†µä¸‹çš„å®‰å…¨ç½‘ã€‚</p>
<h2 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h2>
<p>æœ€åï¼Œæ”¾ä¸€å¼ æˆ‘æ€»ç»“çš„è„‘å›¾æ€»ç»“ä¸€ä¸‹ä»¥ä¸Šçš„çŸ¥è¯†ç‚¹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/web/git/git-summary.png"/></div>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li>å®˜æ–¹èµ„æº
<ul>
<li><a href="https://git-scm.com/" target="_blank" rel="noopener">Git å®˜ç½‘</a></li>
<li><a href="https://github.com/git/git" target="_blank" rel="noopener">Git Github</a></li>
</ul>
</li>
<li>æ¨¡æ¿
<ul>
<li><a href="https://github.com/github/gitignore" target="_blank" rel="noopener">gitignore æ¨¡æ¿</a> - .gitignore æ–‡ä»¶æ¨¡æ¿</li>
<li><a href="https://github.com/alexkaratarakis/gitattributes" target="_blank" rel="noopener">gitattributes æ¨¡æ¿</a> - .gitattributes æ–‡ä»¶æ¨¡æ¿</li>
<li><a href="https://github.com/tiimgreen/github-cheat-sheet" target="_blank" rel="noopener">github-cheat-sheet</a> - git å‘½ä»¤ç®€ç•¥å›¾è¡¨</li>
</ul>
</li>
<li>Git ä¹¦
<ul>
<li><a href="https://git-scm.com/book/zh/v2" target="_blank" rel="noopener">Git å®˜æ–¹æ¨èæ•™ç¨‹</a> - Scott Chacon çš„ Git ä¹¦ã€‚</li>
</ul>
</li>
<li>Git æ•™ç¨‹
<ul>
<li><a href="https://github.com/geeeeeeeeek/git-recipes" target="_blank" rel="noopener">Git ä¸­æ–‡æ•™ç¨‹</a></li>
<li><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="noopener">å»–é›ªå³°çš„ Git æ•™ç¨‹</a></li>
<li><a href="https://github.com/xirong/my-git" target="_blank" rel="noopener">æœ‰å…³ git çš„å­¦ä¹ èµ„æº</a></li>
</ul>
</li>
<li>æ–‡ç« 
<ul>
<li><a href="https://github.com/k88hudson/git-flight-rules/blob/master/README_zh-CN.md" target="_blank" rel="noopener">Git Cookbook</a></li>
<li><a href="https://github.com/521xueweihan/git-tips" target="_blank" rel="noopener">Git å¥‡æŠ€æ·«å·§</a></li>
<li><a href="https://github.com/aseaday/git-style-guide" target="_blank" rel="noopener">Git é£æ ¼æŒ‡å—</a></li>
<li><a href="http://www.cnblogs.com/cnblogsfans/p/5075073.html" target="_blank" rel="noopener">Git åœ¨å›¢é˜Ÿä¸­çš„æœ€ä½³å®è·µâ€“å¦‚ä½•æ­£ç¡®ä½¿ç”¨ Git Flow</a></li>
</ul>
</li>
<li>Git å·¥å…·
<ul>
<li><a href="https://git-scm.com/downloads/guis" target="_blank" rel="noopener">guis</a> - Git å®˜ç½‘å±•ç¤ºçš„å®¢æˆ·ç«¯å·¥å…·åˆ—è¡¨ã€‚</li>
<li><a href="https://github.com/gogits/gogs" target="_blank" rel="noopener">gogs</a> - ææ˜“æ­å»ºçš„è‡ªåŠ© Git æœåŠ¡ã€‚</li>
<li><a href="https://github.com/nvie/gitflow" target="_blank" rel="noopener">gitflow</a> - åº”ç”¨ <a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">fit-flow</a> æ¨¡å‹çš„å·¥å…·ã€‚</li>
<li><a href="http://firstaidgit.io/" target="_blank" rel="noopener">firstaidgit.io</a> ä¸€ä¸ªå¯æœç´¢çš„æœ€å¸¸è¢«é—®åˆ°çš„ Git çš„é—®é¢˜</li>
<li><a href="https://github.com/unixorn/git-extra-commands" target="_blank" rel="noopener">git-extra-commands</a> - ä¸€å †æœ‰ç”¨çš„é¢å¤–çš„ Git è„šæœ¬</li>
<li><a href="https://github.com/tj/git-extras" target="_blank" rel="noopener">git-extras</a> - GIT å·¥å…·é›† â€“ repo summary, repl, changelog population, author commit percentages and more</li>
<li><a href="https://github.com/qw3rtman/git-fire" target="_blank" rel="noopener">git-fire</a> - git-fire æ˜¯ä¸€ä¸ª Git æ’ä»¶ï¼Œç”¨äºå¸®åŠ©åœ¨ç´§æ€¥æƒ…å†µä¸‹æ·»åŠ æ‰€æœ‰å½“å‰æ–‡ä»¶, åšæäº¤(committing), å’Œæ¨(push)åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯(é˜»æ­¢åˆå¹¶å†²çª)ã€‚</li>
<li><a href="https://github.com/git-tips/tips" target="_blank" rel="noopener">git-tips</a> - Git å°æç¤º</li>
<li><a href="https://github.com/Originate/git-town" target="_blank" rel="noopener">git-town</a> - é€šç”¨ï¼Œé«˜çº§ Git å·¥ä½œæµæ”¯æŒï¼ <a href="http://www.git-town.com" target="_blank" rel="noopener">http://www.git-town.com</a></li>
</ul>
</li>
<li>GUI å®¢æˆ·ç«¯(GUI Clients)
<ul>
<li><a href="https://www.gitkraken.com/" target="_blank" rel="noopener">GitKraken</a> - è±ªåçš„ Git å®¢æˆ·ç«¯ Windows, Mac &amp; Linux</li>
<li><a href="https://git-cola.github.io/" target="_blank" rel="noopener">git-cola</a> - å¦å¤–ä¸€ä¸ª Git å®¢æˆ·ç«¯ Windows &amp; OS X</li>
<li><a href="https://github.com/git-up/GitUp" target="_blank" rel="noopener">GitUp</a> - ä¸€ä¸ªæ–°çš„ Git å®¢æˆ·ç«¯ï¼Œåœ¨å¤„ç† Git çš„å¤æ‚æ€§ä¸Šæœ‰è‡ªå·±çš„ç‰¹ç‚¹</li>
<li><a href="https://rowanj.github.io/gitx/" target="_blank" rel="noopener">gitx-dev</a> - å›¾å½¢åŒ–çš„ Git å®¢æˆ·ç«¯ OS X</li>
<li><a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener">Source Tree</a> - å…è´¹çš„å›¾å½¢åŒ– Git å®¢æˆ·ç«¯ Windows &amp; OS X</li>
<li><a href="http://www.git-tower.com/" target="_blank" rel="noopener">Tower</a> - å›¾å½¢åŒ– Git å®¢æˆ·ç«¯ OS X(ä»˜è´¹)</li>
</ul>
</li>
<li>git cheat sheet
<ul>
<li><a href="https://services.github.com/on-demand/downloads/github-git-cheat-sheet.pdf" target="_blank" rel="noopener">github-git-cheat-sheet</a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>ç‰ˆæœ¬æ§åˆ¶</tag>
      </tags>
  </entry>
  <entry>
    <title>è½¯ä»¶å·¥ç¨‹ä¸é¡¹ç›®ç®¡ç†</title>
    <url>/blog/efficiency/software-engineering/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>è½¯ä»¶å·¥ç¨‹æ˜¯ä¸€é—¨ç ”ç©¶ç”¨å·¥ç¨‹åŒ–æ–¹æ³•æ„å»ºå’Œç»´æŠ¤æœ‰æ•ˆçš„ã€å®ç”¨çš„å’Œé«˜è´¨é‡çš„è½¯ä»¶çš„å­¦ç§‘ã€‚å®ƒæ¶‰åŠç¨‹åºè®¾è®¡è¯­è¨€ã€æ•°æ®åº“ã€è½¯ä»¶å¼€å‘å·¥å…·ã€ç³»ç»Ÿå¹³å°ã€æ ‡å‡†ã€è®¾è®¡æ¨¡å¼ç­‰æ–¹é¢ã€‚</p>
</blockquote>
<h2 id="è½¯ä»¶å·¥ç¨‹çš„ç›®æ ‡"><a class="markdownIt-Anchor" href="#è½¯ä»¶å·¥ç¨‹çš„ç›®æ ‡"></a> è½¯ä»¶å·¥ç¨‹çš„ç›®æ ‡</h2>
<p>è½¯ä»¶å·¥ç¨‹çš„ç›®æ ‡æ˜¯ï¼šåœ¨ç»™å®šæˆæœ¬ã€è¿›åº¦çš„å‰æä¸‹ï¼Œå¼€å‘å‡ºå…·æœ‰é€‚ç”¨æ€§ã€æœ‰æ•ˆæ€§ã€å¯ä¿®æ”¹æ€§ã€å¯é æ€§ã€å¯ç†è§£æ€§ã€å¯ç»´æŠ¤æ€§ã€å¯é‡ç”¨æ€§ã€å¯ç§»æ¤æ€§ã€å¯è¿½è¸ªæ€§ã€å¯äº’æ“ä½œæ€§å’Œæ»¡è¶³ç”¨æˆ·éœ€æ±‚çš„è½¯ä»¶äº§å“ã€‚</p>
<ol>
<li><strong>é€‚ç”¨æ€§</strong> - è½¯ä»¶åœ¨ä¸åŒçš„ç³»ç»Ÿçº¦æŸæ¡ä»¶ä¸‹ï¼Œä½¿ç”¨æˆ·éœ€æ±‚å¾—åˆ°æ»¡è¶³çš„éš¾æ˜“ç¨‹åº¦ã€‚</li>
<li><strong>æœ‰æ•ˆæ€§</strong> - è½¯ä»¶ç³»ç»Ÿèƒ½æœ€æœ‰æ•ˆçš„åˆ©ç”¨è®¡ç®—æœºçš„æ—¶é—´å’Œç©ºé—´èµ„æºã€‚å„ç§è½¯ä»¶æ— ä¸æŠŠç³»ç»Ÿçš„æ—¶/ç©ºå¼€é”€ä½œä¸ºè¡¡é‡è½¯ä»¶è´¨é‡çš„ä¸€é¡¹é‡è¦æŠ€æœ¯æŒ‡æ ‡ã€‚å¾ˆå¤šåœºåˆï¼Œåœ¨è¿½æ±‚æ—¶é—´æœ‰æ•ˆæ€§å’Œç©ºé—´æœ‰æ•ˆæ€§æ—¶ä¼šå‘ç”ŸçŸ›ç›¾ï¼Œè¿™æ—¶ä¸å¾—ä¸ç‰ºç‰²æ—¶é—´æœ‰æ•ˆæ€§æ¢å–ç©ºé—´æœ‰æ•ˆæ€§æˆ–ç‰ºç‰²ç©ºé—´æœ‰æ•ˆæ€§æ¢å–æ—¶é—´æœ‰æ•ˆæ€§ã€‚æ—¶/ç©ºæŠ˜è¡·æ˜¯ç»å¸¸é‡‡ç”¨çš„æŠ€å·§ã€‚</li>
<li><strong>å¯ä¿®æ”¹æ€§</strong> - å…è®¸å¯¹ç³»ç»Ÿè¿›è¡Œä¿®æ”¹è€Œä¸å¢åŠ åŸç³»ç»Ÿçš„å¤æ‚æ€§ã€‚å®ƒæ”¯æŒè½¯ä»¶çš„è°ƒè¯•å’Œç»´æŠ¤ï¼Œæ˜¯ä¸€ä¸ªéš¾ä»¥è¾¾åˆ°çš„ç›®æ ‡ã€‚</li>
<li><strong>å¯é æ€§</strong> - èƒ½é˜²æ­¢å› æ¦‚å¿µã€è®¾è®¡å’Œç»“æ„ç­‰æ–¹é¢çš„ä¸å®Œå–„é€ æˆçš„è½¯ä»¶ç³»ç»Ÿå¤±æ•ˆï¼Œå…·æœ‰æŒ½å›å› æ“ä½œä¸å½“é€ æˆè½¯ä»¶ç³»ç»Ÿå¤±æ•ˆçš„èƒ½åŠ›ã€‚</li>
<li><strong>å¯ç†è§£æ€§</strong> - ç³»ç»Ÿå…·æœ‰æ¸…æ™°çš„ç»“æ„ï¼Œèƒ½ç›´æ¥åæ˜ é—®é¢˜çš„éœ€æ±‚ã€‚å¯ç†è§£æ€§æœ‰åŠ©äºæ§åˆ¶ç³»ç»Ÿè½¯ä»¶å¤æ‚æ€§ï¼Œå¹¶æ”¯æŒè½¯ä»¶çš„ç»´æŠ¤ã€ç§»æ¤æˆ–é‡ç”¨ã€‚</li>
<li><strong>å¯ç»´æŠ¤æ€§</strong> - è½¯ä»¶äº¤ä»˜ä½¿ç”¨åï¼Œèƒ½å¤Ÿå¯¹å®ƒè¿›è¡Œä¿®æ”¹ï¼Œä»¥æ”¹æ­£æ½œä¼çš„é”™è¯¯ï¼Œæ”¹è¿›æ€§èƒ½å’Œå…¶å®ƒå±æ€§ï¼Œä½¿è½¯ä»¶äº§å“é€‚åº”ç¯å¢ƒçš„å˜åŒ–ç­‰ã€‚è½¯ä»¶ç»´æŠ¤è´¹ç”¨åœ¨è½¯ä»¶å¼€å‘è´¹ç”¨ä¸­å æœ‰å¾ˆå¤§çš„æ¯”é‡ã€‚å¯ç»´æŠ¤æ€§æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­ä¸€é¡¹ååˆ†é‡è¦çš„ç›®æ ‡ã€‚</li>
<li><strong>å¯é‡ç”¨æ€§</strong> - æŠŠæ¦‚å¿µæˆ–åŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹çš„ä¸€ä¸ªæˆ–ä¸€ç»„ç›¸å…³æ¨¡å—å®šä¹‰ä¸ºä¸€ä¸ªè½¯éƒ¨ä»¶ã€‚å¯ç»„è£…åœ¨ç³»ç»Ÿçš„ä»»ä½•ä½ç½®ï¼Œé™ä½å·¥ä½œé‡ã€‚</li>
<li><strong>å¯ç§»æ¤æ€§</strong> - è½¯ä»¶ä»ä¸€ä¸ªè®¡ç®—æœºç³»ç»Ÿæˆ–ç¯å¢ƒæ¬åˆ°å¦ä¸€ä¸ªè®¡ç®—æœºç³»ç»Ÿæˆ–ç¯å¢ƒçš„éš¾æ˜“ç¨‹åº¦ã€‚</li>
<li><strong>å¯è¿½è¸ªæ€§</strong> - æ ¹æ®è½¯ä»¶éœ€æ±‚å¯¹è½¯ä»¶è®¾è®¡ã€ç¨‹åºè¿›è¡Œæ­£å‘è¿½è¸ªï¼Œæˆ–æ ¹æ®è½¯ä»¶è®¾è®¡ã€ç¨‹åºå¯¹è½¯ä»¶éœ€æ±‚çš„é€†å‘è¿½è¸ªçš„èƒ½åŠ›ã€‚</li>
<li><strong>å¯äº’æ“ä½œæ€§</strong> - å¤šä¸ªè½¯ä»¶å…ƒç´ ç›¸äº’é€šä¿¡å¹¶ååŒå®Œæˆä»»åŠ¡çš„èƒ½åŠ›ã€‚</li>
</ol>
<h2 id="è½¯ä»¶å·¥ç¨‹çš„åŸç†"><a class="markdownIt-Anchor" href="#è½¯ä»¶å·¥ç¨‹çš„åŸç†"></a> è½¯ä»¶å·¥ç¨‹çš„åŸç†</h2>
<p>è½¯ä»¶å·¥ç¨‹çš„ä¸ƒæ¡åŸºæœ¬åŸç†ï¼š</p>
<ol>
<li>ç”¨åˆ†é˜¶æ®µçš„ç”Ÿå­˜å‘¨æœŸè®¡åˆ’è¿›è¡Œä¸¥æ ¼çš„ç®¡ç†ã€‚</li>
<li>åšæŒè¿›è¡Œé˜¶æ®µè¯„å®¡ã€‚</li>
<li>å®è¡Œä¸¥æ ¼çš„äº§å“æ§åˆ¶ã€‚</li>
<li>é‡‡ç”¨ç°ä»£ç¨‹åºè®¾è®¡æŠ€æœ¯ã€‚</li>
<li>è½¯ä»¶å·¥ç¨‹ç»“æœåº”èƒ½æ¸…æ¥šåœ°å®¡æŸ¥ã€‚</li>
<li>å¼€å‘å°ç»„çš„äººå‘˜åº”è¯¥å°‘è€Œç²¾ã€‚</li>
<li>æ‰¿è®¤ä¸æ–­æ”¹è¿›è½¯ä»¶å·¥ç¨‹å®è·µçš„å¿…è¦æ€§ã€‚</li>
</ol>
<h2 id="è½¯ä»¶å·¥ç¨‹çš„æ–¹æ³•"><a class="markdownIt-Anchor" href="#è½¯ä»¶å·¥ç¨‹çš„æ–¹æ³•"></a> è½¯ä»¶å·¥ç¨‹çš„æ–¹æ³•</h2>
<p>è‘—åçš„é‡é‡çº§å¼€å‘æ–¹æ³•ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/zh-cn/ISO_9000" target="_blank" rel="noopener">ISO9000</a> - ISO 9000 ç³»åˆ—æ ‡å‡†æ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡è®¾ç«‹çš„æ ‡å‡†ï¼Œä¸å“è´¨ç®¡ç†ç³»ç»Ÿæœ‰å…³ã€‚</li>
<li><a href="https://zh.wikipedia.org/wiki/%E8%83%BD%E5%8A%9B%E6%88%90%E7%86%9F%E5%BA%A6%E6%A8%A1%E5%9E%8B" target="_blank" rel="noopener">èƒ½åŠ›æˆç†Ÿåº¦æ¨¡å‹ï¼ˆCMMï¼‰</a> - CMM æ¶µç›–ä¸€ä¸ªæˆç†Ÿçš„è½¯ä»¶å‘å±•ç»„ç»‡æ‰€åº”å…·å¤‡çš„é‡è¦åŠŸèƒ½ä¸é¡¹ç›®ï¼Œå®ƒæè¿°äº†è½¯ä»¶å‘å±•çš„æ¼”è¿›è¿‡ç¨‹ï¼Œä»æ¯«æ— ç« æ³•ã€ä¸æˆç†Ÿçš„è½¯ä»¶å¼€å‘é˜¶æ®µåˆ°æˆç†Ÿè½¯ä»¶å¼€å‘é˜¶æ®µçš„è¿‡ç¨‹ã€‚</li>
<li><a href="https://zh.wikipedia.org/wiki/%E7%BB%9F%E4%B8%80%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B" target="_blank" rel="noopener">ç»Ÿä¸€è½¯ä»¶å¼€å‘è¿‡ç¨‹ï¼ˆRUPï¼‰</a> - RUP æ˜¯ä¸€ç§è½¯ä»¶å·¥ç¨‹æ–¹æ³•ï¼Œä¸ºè¿­ä»£å¼è½¯ä»¶å¼€å‘æµç¨‹ã€‚</li>
</ul>
<p>è‘—åçš„è½»é‡çº§å¼€å‘æ–¹æ³•ï¼š</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E6%95%8F%E6%8D%B7%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91" target="_blank" rel="noopener">æ•æ·å¼€å‘ï¼ˆAgile Developmentï¼‰</a> - æ˜¯ä¸€ç§åº”å¯¹å¿«é€Ÿå˜åŒ–çš„éœ€æ±‚çš„ä¸€ç§è½¯ä»¶å¼€å‘èƒ½åŠ›ã€‚å®ƒä»¬çš„å…·ä½“åç§°ã€ç†å¿µã€è¿‡ç¨‹ã€æœ¯è¯­éƒ½ä¸å°½ç›¸åŒï¼Œç›¸å¯¹äºâ€œéæ•æ·â€ï¼Œæ›´å¼ºè°ƒç¨‹åºå‘˜å›¢é˜Ÿä¸ä¸šåŠ¡ä¸“å®¶ä¹‹é—´çš„ç´§å¯†åä½œã€é¢å¯¹é¢çš„æ²Ÿé€šï¼ˆè®¤ä¸ºæ¯”ä¹¦é¢çš„æ–‡æ¡£æ›´æœ‰æ•ˆï¼‰ã€é¢‘ç¹äº¤ä»˜æ–°çš„è½¯ä»¶ç‰ˆæœ¬ã€ç´§å‡‘è€Œè‡ªæˆ‘ç»„ç»‡å‹çš„å›¢é˜Ÿã€èƒ½å¤Ÿå¾ˆå¥½åœ°é€‚åº”éœ€æ±‚å˜åŒ–çš„ä»£ç ç¼–å†™å’Œå›¢é˜Ÿç»„ç»‡æ–¹æ³•ï¼Œä¹Ÿæ›´æ³¨é‡è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­äººçš„ä½œç”¨ã€‚</li>
<li><a href="https://zh.wikipedia.org/wiki/%E6%9E%81%E9%99%90%E7%BC%96%E7%A8%8B" target="_blank" rel="noopener">æé™ç¼–ç¨‹ï¼ˆXPï¼‰</a> - æé™ç¼–ç¨‹æ˜¯æ•æ·è½¯ä»¶å¼€å‘ä¸­æœ€æœ‰æˆæ•ˆçš„æ–¹æ³•å­¦ä¹‹ä¸€ã€‚æé™ç¼–ç¨‹æŠ€æœ¯ä»¥æ²Ÿé€šï¼ˆCommunicationï¼‰ã€ç®€å•ï¼ˆSimplicityï¼‰ã€åé¦ˆï¼ˆFeedbackï¼‰ã€å‹‡æ°”ï¼ˆCourageï¼‰å’Œå°Šé‡ï¼ˆRespectï¼‰ä¸ºä»·å€¼æ ‡å‡†ã€‚</li>
</ul>
<h2 id="è½¯ä»¶éœ€æ±‚"><a class="markdownIt-Anchor" href="#è½¯ä»¶éœ€æ±‚"></a> è½¯ä»¶éœ€æ±‚</h2>
<p>è½¯ä»¶éœ€æ±‚åŒ…æ‹¬ä¸‰ä¸ªä¸åŒçš„å±‚æ¬¡ï¼šä¸šåŠ¡éœ€æ±‚ã€ç”¨æˆ·éœ€æ±‚å’ŒåŠŸèƒ½éœ€æ±‚ã€‚</p>
<ul>
<li>
<p>**ä¸šåŠ¡éœ€æ±‚ï¼ˆBusiness requirementï¼‰**è¡¨ç¤ºç»„ç»‡æˆ–å®¢æˆ·é«˜å±‚æ¬¡çš„ç›®æ ‡ã€‚ä¸šåŠ¡éœ€æ±‚é€šå¸¸æ¥è‡ªé¡¹ç›®æŠ•èµ„äººã€è´­ä¹°äº§å“çš„å®¢æˆ·ã€å®é™…ç”¨æˆ·çš„ç®¡ç†è€…ã€å¸‚åœºè¥é”€éƒ¨é—¨æˆ–äº§å“ç­–åˆ’éƒ¨é—¨ã€‚ä¸šåŠ¡éœ€æ±‚æè¿°äº†ç»„ç»‡ä¸ºä»€ä¹ˆè¦å¼€å‘ä¸€ä¸ªç³»ç»Ÿï¼Œå³ç»„ç»‡å¸Œæœ›è¾¾åˆ°çš„ç›®æ ‡ã€‚ä½¿ç”¨å‰æ™¯å’ŒèŒƒå›´ï¼ˆ vision and scope ï¼‰æ–‡æ¡£æ¥è®°å½•ä¸šåŠ¡éœ€æ±‚ï¼Œè¿™ä»½æ–‡æ¡£æœ‰æ—¶ä¹Ÿè¢«ç§°ä½œé¡¹ç›®è½®å»“å›¾æˆ–å¸‚åœºéœ€æ±‚ï¼ˆ project charter æˆ– market requirement ï¼‰æ–‡æ¡£ã€‚</p>
</li>
<li>
<p>**ç”¨æˆ·éœ€æ±‚ï¼ˆuser requirementï¼‰**æè¿°çš„æ˜¯ç”¨æˆ·çš„ç›®æ ‡ï¼Œæˆ–ç”¨æˆ·è¦æ±‚ç³»ç»Ÿå¿…é¡»èƒ½å®Œæˆçš„ä»»åŠ¡ã€‚ç”¨ä¾‹ã€åœºæ™¯æè¿°å’Œäº‹ä»¶â€•â€•å“åº”è¡¨éƒ½æ˜¯è¡¨è¾¾ç”¨æˆ·éœ€æ±‚çš„æœ‰æ•ˆé€”å¾„ã€‚ä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·éœ€æ±‚æè¿°äº†ç”¨æˆ·èƒ½ä½¿ç”¨ç³»ç»Ÿæ¥åšäº›ä»€ä¹ˆã€‚</p>
</li>
<li>
<p>**åŠŸèƒ½éœ€æ±‚ï¼ˆfunctional requirementï¼‰**è§„å®šå¼€å‘äººå‘˜å¿…é¡»åœ¨äº§å“ä¸­å®ç°çš„è½¯ä»¶åŠŸèƒ½ï¼Œç”¨æˆ·åˆ©ç”¨è¿™äº›åŠŸèƒ½æ¥å®Œæˆä»»åŠ¡ï¼Œæ»¡è¶³ä¸šåŠ¡éœ€æ±‚ã€‚åŠŸèƒ½éœ€æ±‚æœ‰æ—¶ä¹Ÿè¢«ç§°ä½œè¡Œä¸ºéœ€æ±‚ï¼ˆ behavioral requirement ï¼‰ï¼Œå› ä¸ºä¹ æƒ¯ä¸Šæ€»æ˜¯ç”¨â€œåº”è¯¥â€å¯¹å…¶è¿›è¡Œæè¿°ï¼šâ€œç³»ç»Ÿåº”è¯¥å‘é€ç”µå­é‚®ä»¶æ¥é€šçŸ¥ç”¨æˆ·å·²æ¥å—å…¶é¢„å®šâ€ã€‚åŠŸèƒ½éœ€æ±‚æè¿°æ˜¯å¼€å‘äººå‘˜éœ€è¦å®ç°ä»€ä¹ˆã€‚</p>
</li>
<li>
<p>**ç³»ç»Ÿéœ€æ±‚ï¼ˆsystem requirementï¼‰**ç”¨äºæè¿°åŒ…å«å¤šä¸ªå­ç³»ç»Ÿçš„äº§å“ï¼ˆå³ç³»ç»Ÿï¼‰çš„é¡¶çº§éœ€æ±‚ã€‚ç³»ç»Ÿå¯ä»¥åªåŒ…å«è½¯ä»¶ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥æ—¢åŒ…å«è½¯ä»¶åˆåŒ…å«ç¡¬ä»¶å­ç³»ç»Ÿã€‚äººä¹Ÿå¯ä»¥æ˜¯ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤æŸäº›ç³»ç»ŸåŠŸèƒ½å¯èƒ½è¦ç”±äººæ¥æ‰¿æ‹…ã€‚</p>
</li>
</ul>
<h3 id="è½¯ä»¶éœ€æ±‚è¯´æ˜ä¹¦-srs"><a class="markdownIt-Anchor" href="#è½¯ä»¶éœ€æ±‚è¯´æ˜ä¹¦-srs"></a> è½¯ä»¶éœ€æ±‚è¯´æ˜ä¹¦ï¼ˆ SRS ï¼‰</h3>
<p>è½¯ä»¶éœ€æ±‚è¯´æ˜ä¹¦ï¼ˆ SRS ï¼‰å®Œæ•´åœ°æè¿°äº†è½¯ä»¶ç³»ç»Ÿçš„é¢„æœŸç‰¹æ€§ã€‚å¼€å‘ã€æµ‹è¯•ã€è´¨é‡ä¿è¯ã€é¡¹ç›®ç®¡ç†å’Œå…¶ä»–ç›¸å…³çš„é¡¹ç›®åŠŸèƒ½éƒ½è¦ç”¨åˆ° SRS ã€‚</p>
<p>é™¤äº†åŠŸèƒ½éœ€æ±‚å¤–ï¼Œ SRS ä¸­è¿˜åŒ…å«éåŠŸèƒ½éœ€æ±‚ï¼ŒåŒ…æ‹¬æ€§èƒ½æŒ‡æ ‡å’Œå¯¹è´¨é‡å±æ€§çš„æè¿°ã€‚</p>
<ul>
<li>**è´¨é‡å±æ€§ï¼ˆquality attributeï¼‰**å¯¹äº§å“çš„åŠŸèƒ½æè¿°ä½œäº†è¡¥å……ï¼Œå®ƒä»ä¸åŒæ–¹é¢æè¿°äº†äº§å“çš„å„ç§ç‰¹æ€§ã€‚è¿™äº›ç‰¹æ€§åŒ…æ‹¬å¯ç”¨æ€§ã€å¯ç§»æ¤æ€§ã€å®Œæ•´æ€§ã€æ•ˆç‡å’Œå¥å£®æ€§ï¼Œå®ƒä»¬å¯¹ç”¨æˆ·æˆ–å¼€å‘äººå‘˜éƒ½å¾ˆé‡è¦ã€‚å…¶ä»–çš„éåŠŸèƒ½éœ€æ±‚åŒ…æ‹¬ç³»ç»Ÿä¸å¤–éƒ¨ä¸–ç•Œçš„å¤–éƒ¨ç•Œé¢ï¼Œä»¥åŠå¯¹è®¾è®¡ä¸å®ç°çš„çº¦æŸã€‚</li>
<li>**çº¦æŸï¼ˆconstraintï¼‰**é™åˆ¶äº†å¼€å‘äººå‘˜è®¾è®¡å’Œæ„å»ºç³»ç»Ÿæ—¶çš„é€‰æ‹©èŒƒå›´ã€‚</li>
</ul>
<h2 id="è½¯ä»¶ç”Ÿå‘½å‘¨æœŸ"><a class="markdownIt-Anchor" href="#è½¯ä»¶ç”Ÿå‘½å‘¨æœŸ"></a> è½¯ä»¶ç”Ÿå‘½å‘¨æœŸ</h2>
<blockquote>
<p><strong>è½¯ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆSoftware Life Cycle,SLCï¼‰æ˜¯è½¯ä»¶çš„äº§ç”Ÿç›´åˆ°æŠ¥åºŸæˆ–åœæ­¢ä½¿ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚</strong></p>
</blockquote>
<ul>
<li>é—®é¢˜å®šä¹‰ - è¦æ±‚ç³»ç»Ÿåˆ†æå‘˜ä¸ç”¨æˆ·è¿›è¡Œäº¤æµï¼Œå¼„æ¸…â€œç”¨æˆ·éœ€è¦è®¡ç®—æœºè§£å†³ä»€ä¹ˆé—®é¢˜â€ç„¶åæå‡ºå…³äºâ€œç³»ç»Ÿç›®æ ‡ä¸èŒƒå›´çš„è¯´æ˜â€ï¼Œæäº¤ç”¨æˆ·å®¡æŸ¥å’Œç¡®è®¤ã€‚</li>
<li>å¯è¡Œæ€§ç ”ç©¶ - ä¸€æ–¹é¢åœ¨äºæŠŠå¾…å¼€å‘çš„ç³»ç»Ÿçš„ç›®æ ‡ä»¥æ˜ç¡®çš„è¯­è¨€æè¿°å‡ºæ¥ï¼›å¦ä¸€æ–¹é¢ä»ç»æµã€æŠ€æœ¯ã€æ³•å¾‹ç­‰å¤šæ–¹é¢è¿›è¡Œå¯è¡Œæ€§åˆ†æã€‚</li>
<li>éœ€æ±‚åˆ†æ - å¼„æ¸…ç”¨æˆ·å¯¹è½¯ä»¶ç³»ç»Ÿçš„å…¨éƒ¨éœ€æ±‚ï¼Œç¼–å†™éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦å’Œåˆæ­¥çš„ç”¨æˆ·æ‰‹å†Œï¼Œæäº¤è¯„å®¡ã€‚</li>
<li>å¼€å‘é˜¶æ®µ
<ul>
<li>æ¦‚è¦è®¾è®¡</li>
<li>è¯¦ç»†è®¾è®¡</li>
<li>ç¼–ç å®ç°</li>
<li>è½¯ä»¶æµ‹è¯• - æµ‹è¯•çš„è¿‡ç¨‹åˆ†å•å…ƒæµ‹è¯•ã€ç»„è£…æµ‹è¯•ä»¥åŠç³»ç»Ÿæµ‹è¯•ä¸‰ä¸ªé˜¶æ®µè¿›è¡Œã€‚æµ‹è¯•çš„æ–¹æ³•ä¸»è¦æœ‰ç™½ç›’æµ‹è¯•å’Œé»‘ç›’æµ‹è¯•ä¸¤ç§ã€‚</li>
</ul>
</li>
<li>ç»´æŠ¤</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/software-engineering/è½¯ä»¶ç”Ÿå‘½å‘¨æœŸ.gif"/></div>
<h2 id="è½¯ä»¶ç”Ÿå‘½å‘¨æœŸæ¨¡å‹"><a class="markdownIt-Anchor" href="#è½¯ä»¶ç”Ÿå‘½å‘¨æœŸæ¨¡å‹"></a> è½¯ä»¶ç”Ÿå‘½å‘¨æœŸæ¨¡å‹</h2>
<h3 id="ç€‘å¸ƒæ¨¡å‹"><a class="markdownIt-Anchor" href="#ç€‘å¸ƒæ¨¡å‹"></a> ç€‘å¸ƒæ¨¡å‹</h3>
<blockquote>
<p>ç€‘å¸ƒæ¨¡å‹ï¼ˆWaterfall Modelï¼‰å¼ºè°ƒç³»ç»Ÿå¼€å‘åº”æœ‰å®Œæ•´çš„å‘¨æœŸï¼Œä¸”å¿…é¡»å®Œæ•´çš„ç»å†å‘¨æœŸçš„æ¯ä¸€å¼€å‘é˜¶æ®µï¼Œå¹¶ç³»ç»ŸåŒ–çš„è€ƒé‡åˆ†æä¸è®¾è®¡çš„æŠ€æœ¯ã€æ—¶é—´ä¸èµ„æºä¹‹æŠ•å…¥ç­‰ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/software-engineering/ç€‘å¸ƒæ¨¡å‹.jpg"/></div>
<h4 id="æ ¸å¿ƒæ€æƒ³"><a class="markdownIt-Anchor" href="#æ ¸å¿ƒæ€æƒ³"></a> æ ¸å¿ƒæ€æƒ³</h4>
<p>ç€‘å¸ƒæ¨¡å‹æ ¸å¿ƒæ€æƒ³æ˜¯æŒ‰å·¥åºå°†é—®é¢˜æ‹†åˆ†ï¼Œå°†åŠŸèƒ½çš„å®ç°ä¸è®¾è®¡åˆ†å¼€ï¼Œä¾¿äºåˆ†å·¥åä½œï¼Œå³é‡‡ç”¨ç»“æ„åŒ–çš„åˆ†æä¸è®¾è®¡æ–¹æ³•å°†é€»è¾‘å®ç°ä¸ç‰©ç†å®ç°åˆ†å¼€ã€‚å°†è½¯ä»¶ç”Ÿå‘½å‘¨æœŸåˆ’åˆ†ä¸ºåˆ¶å®šè®¡åˆ’ã€éœ€æ±‚åˆ†æã€è½¯ä»¶è®¾è®¡ã€ç¨‹åºç¼–å†™ã€è½¯ä»¶æµ‹è¯•å’Œè¿è¡Œç»´æŠ¤ç­‰å…­ä¸ªåŸºæœ¬æ´»åŠ¨ï¼Œå¹¶ä¸”è§„å®šäº†å®ƒä»¬è‡ªä¸Šè€Œä¸‹ã€ç›¸äº’è¡”æ¥çš„å›ºå®šæ¬¡åºï¼Œå¦‚åŒç€‘å¸ƒæµæ°´ï¼Œé€çº§ä¸‹è½ã€‚</p>
<h4 id="ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#ä¼˜ç¼ºç‚¹"></a> ä¼˜ç¼ºç‚¹</h4>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>ä¸ºé¡¹ç›®æä¾›äº†æŒ‰é˜¶æ®µåˆ’åˆ†çš„æ£€æŸ¥ç‚¹ã€‚</li>
<li>å½“å‰ä¸€é˜¶æ®µå®Œæˆåï¼Œæ‚¨åªéœ€è¦å»å…³æ³¨åç»­é˜¶æ®µã€‚</li>
<li>å¯åœ¨è¿­ä»£æ¨¡å‹ä¸­åº”ç”¨ç€‘å¸ƒæ¨¡å‹ã€‚</li>
<li>å®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ¿ï¼Œè¿™ä¸ªæ¨¡æ¿ä½¿å¾—åˆ†æã€è®¾è®¡ã€ç¼–ç ã€æµ‹è¯•å’Œæ”¯æŒçš„æ–¹æ³•å¯ä»¥åœ¨è¯¥æ¨¡æ¿ä¸‹æœ‰ä¸€ä¸ªå…±åŒçš„æŒ‡å¯¼ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>å„ä¸ªé˜¶æ®µçš„åˆ’åˆ†å®Œå…¨å›ºå®šï¼Œé˜¶æ®µä¹‹é—´äº§ç”Ÿå¤§é‡çš„æ–‡æ¡£ï¼Œæå¤§åœ°å¢åŠ äº†å·¥ä½œé‡ã€‚</li>
<li>ç”±äºå¼€å‘æ¨¡å‹æ˜¯çº¿æ€§çš„ï¼Œç”¨æˆ·åªæœ‰ç­‰åˆ°æ•´ä¸ªè¿‡ç¨‹çš„æœ«æœŸæ‰èƒ½è§åˆ°å¼€å‘æˆæœï¼Œä»è€Œå¢åŠ äº†å¼€å‘é£é™©ã€‚</li>
<li>é€šè¿‡è¿‡å¤šçš„å¼ºåˆ¶å®Œæˆæ—¥æœŸå’Œé‡Œç¨‹ç¢‘æ¥è·Ÿè¸ªå„ä¸ªé¡¹ç›®é˜¶æ®µã€‚</li>
<li>ç€‘å¸ƒæ¨¡å‹çš„çªå‡ºç¼ºç‚¹æ˜¯ä¸é€‚åº”ç”¨æˆ·éœ€æ±‚çš„å˜åŒ–ã€‚</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<p>æ˜¯å¦ä½¿ç”¨è¿™ä¸€æ¨¡å‹ä¸»è¦å–å†³äºæ˜¯å¦èƒ½ç†è§£å®¢æˆ·çš„éœ€æ±‚ä»¥åŠåœ¨é¡¹ç›®çš„è¿›ç¨‹ä¸­è¿™äº›éœ€æ±‚çš„å˜åŒ–ç¨‹åº¦ã€‚å¯¹äºéœ€æ±‚ç»å¸¸å˜åŒ–çš„é¡¹ç›®ï¼Œä¸è¦é€‚ç”¨ç€‘å¸ƒæ¨¡å‹ã€‚</p>
<h3 id="èºæ—‹æ¨¡å‹"><a class="markdownIt-Anchor" href="#èºæ—‹æ¨¡å‹"></a> èºæ—‹æ¨¡å‹</h3>
<blockquote>
<p>èºæ—‹æ¨¡å‹åŸºæœ¬åšæ³•æ˜¯åœ¨â€œç€‘å¸ƒæ¨¡å‹â€çš„æ¯ä¸€ä¸ªå¼€å‘é˜¶æ®µå‰å¼•å…¥ä¸€ä¸ªéå¸¸ä¸¥æ ¼çš„é£é™©è¯†åˆ«ã€é£é™©åˆ†æå’Œé£é™©æ§åˆ¶ï¼Œå®ƒæŠŠè½¯ä»¶é¡¹ç›®åˆ†è§£æˆä¸€ä¸ªä¸ªå°é¡¹ç›®ã€‚æ¯ä¸ªå°é¡¹ç›®éƒ½æ ‡è¯†ä¸€ä¸ªæˆ–å¤šä¸ªä¸»è¦é£é™©ï¼Œç›´åˆ°æ‰€æœ‰çš„ä¸»è¦é£é™©å› ç´ éƒ½è¢«ç¡®å®šã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/software-engineering/èºæ—‹æ¨¡å‹.png"/></div>
<h4 id="æ ¸å¿ƒæ€æƒ³-2"><a class="markdownIt-Anchor" href="#æ ¸å¿ƒæ€æƒ³-2"></a> æ ¸å¿ƒæ€æƒ³</h4>
<p>èºæ—‹æ¨¡å‹æ²¿ç€èºçº¿è¿›è¡Œè‹¥å¹²æ¬¡è¿­ä»£ï¼Œå›¾ä¸­çš„å››ä¸ªè±¡é™ä»£è¡¨äº†ä»¥ä¸‹æ´»åŠ¨ï¼š</p>
<ol>
<li>åˆ¶å®šè®¡åˆ’ - ç¡®å®šè½¯ä»¶ç›®æ ‡ï¼Œé€‰å®šå®æ–½æ–¹æ¡ˆï¼Œå¼„æ¸…é¡¹ç›®å¼€å‘çš„é™åˆ¶æ¡ä»¶ï¼›</li>
<li>é£é™©åˆ†æ - åˆ†æè¯„ä¼°æ‰€é€‰æ–¹æ¡ˆï¼Œè€ƒè™‘å¦‚ä½•è¯†åˆ«å’Œæ¶ˆé™¤é£é™©ï¼›</li>
<li>å®æ–½å·¥ç¨‹ - å®æ–½è½¯ä»¶å¼€å‘å’ŒéªŒè¯ï¼›</li>
<li>å®¢æˆ·è¯„ä¼° - è¯„ä»·å¼€å‘å·¥ä½œï¼Œæå‡ºä¿®æ­£å»ºè®®ï¼Œåˆ¶å®šä¸‹ä¸€æ­¥è®¡åˆ’ã€‚</li>
</ol>
<p>èºæ—‹æ¨¡å‹ç”±é£é™©é©±åŠ¨ï¼Œå¼ºè°ƒå¯é€‰æ–¹æ¡ˆå’Œçº¦æŸæ¡ä»¶ä»è€Œæ”¯æŒè½¯ä»¶çš„é‡ç”¨ï¼Œæœ‰åŠ©äºå°†è½¯ä»¶è´¨é‡ä½œä¸ºç‰¹æ®Šç›®æ ‡èå…¥äº§å“å¼€å‘ä¹‹ä¸­ã€‚</p>
<h4 id="ä¼˜ç¼ºç‚¹-2"><a class="markdownIt-Anchor" href="#ä¼˜ç¼ºç‚¹-2"></a> ä¼˜ç¼ºç‚¹</h4>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>è®¾è®¡ä¸Šçš„çµæ´»æ€§,å¯ä»¥åœ¨é¡¹ç›®çš„å„ä¸ªé˜¶æ®µè¿›è¡Œå˜æ›´ã€‚</li>
<li>ä»¥å°çš„åˆ†æ®µæ¥æ„å»ºå¤§å‹ç³»ç»Ÿ,ä½¿æˆæœ¬è®¡ç®—å˜å¾—ç®€å•å®¹æ˜“ã€‚</li>
<li>å®¢æˆ·å§‹ç»ˆå‚ä¸æ¯ä¸ªé˜¶æ®µçš„å¼€å‘,ä¿è¯äº†é¡¹ç›®ä¸åç¦»æ­£ç¡®æ–¹å‘ä»¥åŠé¡¹ç›®çš„å¯æ§æ€§ã€‚</li>
<li>éšç€é¡¹ç›®æ¨è¿›,å®¢æˆ·å§‹ç»ˆæŒæ¡é¡¹ç›®çš„æœ€æ–°ä¿¡æ¯, ä»è€Œä»–æˆ–å¥¹èƒ½å¤Ÿå’Œç®¡ç†å±‚æœ‰æ•ˆåœ°äº¤äº’ã€‚</li>
<li>å®¢æˆ·è®¤å¯è¿™ç§å…¬å¸å†…éƒ¨çš„å¼€å‘æ–¹å¼å¸¦æ¥çš„è‰¯å¥½çš„æ²Ÿé€šå’Œé«˜è´¨é‡çš„äº§å“ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<p>å¾ˆéš¾è®©ç”¨æˆ·ç¡®ä¿¡è¿™ç§æ¼”åŒ–æ–¹æ³•çš„ç»“æœæ˜¯å¯ä»¥æ§åˆ¶çš„ã€‚å»ºè®¾å‘¨æœŸé•¿ï¼Œè€Œè½¯ä»¶æŠ€æœ¯å‘å±•æ¯”è¾ƒå¿«ï¼Œæ‰€ä»¥ç»å¸¸å‡ºç°è½¯ä»¶å¼€å‘å®Œæ¯•åï¼Œå’Œå½“å‰çš„æŠ€æœ¯æ°´å¹³æœ‰äº†è¾ƒå¤§çš„å·®è·ï¼Œæ— æ³•æ»¡è¶³å½“å‰ç”¨æˆ·éœ€æ±‚ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<p>å¯¹äºæ–°é¡¹ç›®ï¼Œéœ€æ±‚ä¸æ˜ç¡®çš„æƒ…å†µä¸‹ï¼Œé€‚åˆç”¨èºæ—‹æ¨¡å‹è¿›è¡Œå¼€å‘ï¼Œä¾¿äºé£é™©æ§åˆ¶å’Œéœ€æ±‚å˜æ›´ã€‚</p>
<h2 id="è½¯ä»¶å·¥ç¨‹æœ¯è¯­"><a class="markdownIt-Anchor" href="#è½¯ä»¶å·¥ç¨‹æœ¯è¯­"></a> è½¯ä»¶å·¥ç¨‹æœ¯è¯­</h2>
<ul>
<li><strong>é‡Œç¨‹ç¢‘ï¼ˆMilestoneï¼‰</strong> - åœ¨åˆ¶å®šé¡¹ç›®è¿›åº¦è®¡åˆ’æ—¶ï¼Œåœ¨è¿›åº¦æ—¶é—´è¡¨ä¸Šè®¾ç«‹ä¸€äº›é‡è¦çš„æ—¶é—´æ£€æŸ¥ç‚¹ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥åœ¨é¡¹ç›®æ‰§è¡Œè¿‡ç¨‹ä¸­åˆ©ç”¨è¿™äº›é‡è¦çš„æ—¶é—´æ£€æŸ¥ç‚¹æ¥å¯¹é¡¹ç›®çš„è¿›ç¨‹è¿›è¡Œæ£€æŸ¥å’Œæ§åˆ¶ã€‚è¿™äº›é‡è¦çš„æ—¶é—´æ£€æŸ¥ç‚¹è¢«ç§°ä½œé¡¹ç›®çš„é‡Œç¨‹ç¢‘ã€‚</li>
<li><strong>äººæœˆ</strong> - è½¯ä»¶å¼€å‘çš„å·¥ä½œé‡å•ä½ã€‚å¦‚ 200 äººæœˆï¼Œ10 ä¸ªäººå¼€å‘ï¼Œé‚£ç®—æ¥å°±æ˜¯èŠ± 20 ä¸ªæœˆå°±å¯å®Œå·¥ã€‚</li>
<li><strong>åŸºçº¿</strong> - åŸºçº¿æ˜¯é¡¹ç›®å‚¨å­˜åº“ä¸­æ¯ä¸ªå·¥ä»¶ç‰ˆæœ¬åœ¨ç‰¹å®šæ—¶æœŸçš„ä¸€ä¸ªâ€œå¿«ç…§â€ã€‚å®ƒæä¾›ä¸€ä¸ªæ­£å¼æ ‡å‡†ï¼Œéšåçš„å·¥ä½œåŸºäºæ­¤æ ‡å‡†ï¼Œå¹¶ä¸”åªæœ‰ç»è¿‡æˆæƒåæ‰èƒ½å˜æ›´è¿™ä¸ªæ ‡å‡†ã€‚å»ºç«‹ä¸€ä¸ªåˆå§‹åŸºçº¿åï¼Œä»¥åæ¯æ¬¡å¯¹å…¶è¿›è¡Œçš„å˜æ›´éƒ½å°†è®°å½•ä¸ºä¸€ä¸ªå·®å€¼ï¼Œç›´åˆ°å»ºæˆä¸‹ä¸€ä¸ªåŸºçº¿ã€‚</li>
</ul>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
<ul>
<li><strong>ä¹¦ç±</strong>
<ul>
<li><a href="https://book.douban.com/subject/2230248/" target="_blank" rel="noopener">äººæœˆç¥è¯</a></li>
<li><a href="https://book.douban.com/subject/1477390/" target="_blank" rel="noopener">ä»£ç å¤§å…¨</a></li>
</ul>
</li>
<li><strong>æ–‡ç« </strong>
<ul>
<li><a href="https://juejin.im/post/5a4991e151882574d23cafbf" target="_blank" rel="noopener">ä½¿ç”¨ç”˜ç‰¹å›¾åšé¡¹ç›®ç®¡ç†</a></li>
<li><a href="https://juejin.im/post/5c1f6a1e6fb9a04a03793573" target="_blank" rel="noopener">ä½¿ç”¨ç‡ƒå°½å›¾ç›‘æ§é¡¹ç›®æ•´ä½“è¿›åº¦</a></li>
</ul>
</li>
<li><strong>å·¥å…·</strong>
<ul>
<li><a href="https://my.oschina.net/editorial-story/blog/1559395" target="_blank" rel="noopener">10 å¤§å¼€æºå…è´¹çš„é¡¹ç›®ç®¡ç†è½¯ä»¶æ¨è</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2017/08/issue.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2017/08/issue.html</a></li>
</ul>
</li>
<li><strong>æ–‡æ¡£æ¨¡æ¿</strong>
<ul>
<li><a href="https://pan.baidu.com/s/1sXTOs1PSDyw9P2zWtzbsmw" target="_blank" rel="noopener">è½¯ä»¶å·¥ç¨‹æ–‡æ¡£æ ‡å‡†æ¨¡æ¿ç™¾åº¦ç½‘ç›˜ä¸‹è½½</a> - ä¸‹è½½å¯†ç ï¼šuu1f</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>æ•ˆç‡æå‡</category>
      </categories>
      <tags>
        <tag>æ•ˆç‡æå‡</tag>
        <tag>è½¯ä»¶å·¥ç¨‹</tag>
        <tag>ç®¡ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€ç¯‡æ–‡ç« è®©ä½ å½»åº•æŒæ¡ Shell</title>
    <url>/blog/coding/shell/</url>
    <content><![CDATA[<blockquote>
<p>ç”±äº bash æ˜¯ Linux æ ‡å‡†é»˜è®¤çš„ shell è§£é‡Šå™¨ï¼Œå¯ä»¥è¯´ bash æ˜¯ shell ç¼–ç¨‹çš„åŸºç¡€ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç» bash çš„è¯­æ³•ï¼Œå¯¹äº linux æŒ‡ä»¤ä¸åšä»»ä½•ä»‹ç»ã€‚</p>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€<br />
ğŸ” æœ¬æ–‡çš„æºç å·²å½’æ¡£åˆ° <a href="https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos" target="_blank" rel="noopener">linux-tutorial</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—</span><br><span class="line">â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘</span><br><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘</span><br><span class="line">â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘</span><br><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—</span><br></pre></td></tr></table></figure>
<h2 id="1-ç®€ä»‹"><a class="markdownIt-Anchor" href="#1-ç®€ä»‹"></a> 1. ç®€ä»‹</h2>
<h3 id="11-ä»€ä¹ˆæ˜¯-shell"><a class="markdownIt-Anchor" href="#11-ä»€ä¹ˆæ˜¯-shell"></a> 1.1. ä»€ä¹ˆæ˜¯ shell</h3>
<ul>
<li>Shell æ˜¯ä¸€ä¸ªç”¨ C è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œå®ƒæ˜¯ç”¨æˆ·ä½¿ç”¨ Linux çš„æ¡¥æ¢ã€‚</li>
<li>Shell æ—¢æ˜¯ä¸€ç§å‘½ä»¤è¯­è¨€ï¼Œåˆæ˜¯ä¸€ç§ç¨‹åºè®¾è®¡è¯­è¨€ã€‚</li>
<li>Shell æ˜¯æŒ‡ä¸€ç§åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªç•Œé¢ï¼Œç”¨æˆ·é€šè¿‡è¿™ä¸ªç•Œé¢è®¿é—® Linux å†…æ ¸çš„æœåŠ¡ã€‚</li>
</ul>
<p>Ken Thompson çš„ sh æ˜¯ç¬¬ä¸€ç§ Unix Shellï¼ŒWindows Explorer æ˜¯ä¸€ä¸ªå…¸å‹çš„å›¾å½¢ç•Œé¢ Shellã€‚</p>
<h3 id="12-ä»€ä¹ˆæ˜¯-shell-è„šæœ¬"><a class="markdownIt-Anchor" href="#12-ä»€ä¹ˆæ˜¯-shell-è„šæœ¬"></a> 1.2. ä»€ä¹ˆæ˜¯ shell è„šæœ¬</h3>
<p>Shell è„šæœ¬ï¼ˆshell scriptï¼‰ï¼Œæ˜¯ä¸€ç§ä¸º shell ç¼–å†™çš„è„šæœ¬ç¨‹åºï¼Œä¸€èˆ¬æ–‡ä»¶åç¼€ä¸º <code>.sh</code>ã€‚</p>
<p>ä¸šç•Œæ‰€è¯´çš„ shell é€šå¸¸éƒ½æ˜¯æŒ‡ shell è„šæœ¬ï¼Œä½† shell å’Œ shell script æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µã€‚</p>
<h3 id="13-shell-ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#13-shell-ç¯å¢ƒ"></a> 1.3. Shell ç¯å¢ƒ</h3>
<p>Shell ç¼–ç¨‹è·Ÿ javaã€php ç¼–ç¨‹ä¸€æ ·ï¼Œåªè¦æœ‰ä¸€ä¸ªèƒ½ç¼–å†™ä»£ç çš„æ–‡æœ¬ç¼–è¾‘å™¨å’Œä¸€ä¸ªèƒ½è§£é‡Šæ‰§è¡Œçš„è„šæœ¬è§£é‡Šå™¨å°±å¯ä»¥äº†ã€‚</p>
<p>Shell çš„è§£é‡Šå™¨ç§ç±»ä¼—å¤šï¼Œå¸¸è§çš„æœ‰ï¼š</p>
<ul>
<li><a href="https://www.gnu.org/software/bash/" target="_blank" rel="noopener">sh</a> - å³ Bourne Shellã€‚sh æ˜¯ Unix æ ‡å‡†é»˜è®¤çš„ shellã€‚</li>
<li><a href="https://www.gnu.org/software/bash/" target="_blank" rel="noopener">bash</a> - å³ Bourne Again Shellã€‚bash æ˜¯ Linux æ ‡å‡†é»˜è®¤çš„ shellã€‚</li>
<li><a href="https://fishshell.com/" target="_blank" rel="noopener">fish</a> - æ™ºèƒ½å’Œç”¨æˆ·å‹å¥½çš„å‘½ä»¤è¡Œ shellã€‚</li>
<li><a href="http://xiki.org/" target="_blank" rel="noopener">xiki</a> - ä½¿ shell æ§åˆ¶å°æ›´å‹å¥½ï¼Œæ›´å¼ºå¤§ã€‚</li>
<li><a href="http://www.zsh.org/" target="_blank" rel="noopener">zsh</a> - åŠŸèƒ½å¼ºå¤§çš„ shell ä¸è„šæœ¬è¯­è¨€ã€‚</li>
</ul>
<h4 id="æŒ‡å®šè„šæœ¬è§£é‡Šå™¨"><a class="markdownIt-Anchor" href="#æŒ‡å®šè„šæœ¬è§£é‡Šå™¨"></a> æŒ‡å®šè„šæœ¬è§£é‡Šå™¨</h4>
<p>åœ¨ shell è„šæœ¬ï¼Œ<code>#!</code> å‘Šè¯‰ç³»ç»Ÿå…¶åè·¯å¾„æ‰€æŒ‡å®šçš„ç¨‹åºå³æ˜¯è§£é‡Šæ­¤è„šæœ¬æ–‡ä»¶çš„ Shell è§£é‡Šå™¨ã€‚<code>#!</code> è¢«ç§°ä½œ<a href="https://zh.wikipedia.org/wiki/Shebang" target="_blank" rel="noopener">shebangï¼ˆä¹Ÿç§°ä¸º Hashbang ï¼‰</a>ã€‚</p>
<p>æ‰€ä»¥ï¼Œä½ åº”è¯¥ä¼šåœ¨ shell ä¸­ï¼Œè§åˆ°è¯¸å¦‚ä»¥ä¸‹çš„æ³¨é‡Šï¼š</p>
<ul>
<li>æŒ‡å®š sh è§£é‡Šå™¨</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŒ‡å®š bash è§£é‡Šå™¨</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>æ³¨æ„</strong></p>
<p>ä¸Šé¢çš„æŒ‡å®šè§£é‡Šå™¨çš„æ–¹å¼æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œä½†æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½ä¹Ÿä¼šçœ‹åˆ°ä¸‹é¢çš„æ–¹å¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åœ¨ <code>PATH</code> ç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾ä½ æŒ‡å®šçš„ç¨‹åºï¼ˆæœ¬ä¾‹ä¸­çš„<code>bash</code>ï¼‰ã€‚ç›¸æ¯”ç¬¬ä¸€ç§å†™æ³•ï¼Œä½ åº”è¯¥å°½é‡ç”¨è¿™ç§å†™æ³•ï¼Œå› ä¸ºç¨‹åºçš„è·¯å¾„æ˜¯ä¸ç¡®å®šçš„ã€‚è¿™æ ·å†™è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œæ“ä½œç³»ç»Ÿçš„<code>PATH</code>å˜é‡æœ‰å¯èƒ½è¢«é…ç½®ä¸ºæŒ‡å‘ç¨‹åºçš„å¦ä¸€ä¸ªç‰ˆæœ¬ã€‚æ¯”å¦‚ï¼Œå®‰è£…å®Œæ–°ç‰ˆæœ¬çš„<code>bash</code>ï¼Œæˆ‘ä»¬å¯èƒ½å°†å…¶è·¯å¾„æ·»åŠ åˆ°<code>PATH</code>ä¸­ï¼Œæ¥â€œéšè—â€è€ç‰ˆæœ¬ã€‚å¦‚æœç›´æ¥ç”¨<code>#!/bin/bash</code>ï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šé€‰æ‹©è€ç‰ˆæœ¬çš„<code>bash</code>æ¥æ‰§è¡Œè„šæœ¬ï¼Œå¦‚æœç”¨<code>#!/usr/bin/env bash</code>ï¼Œåˆ™ä¼šä½¿ç”¨æ–°ç‰ˆæœ¬ã€‚</p>
</blockquote>
<h3 id="14-æ¨¡å¼"><a class="markdownIt-Anchor" href="#14-æ¨¡å¼"></a> 1.4. æ¨¡å¼</h3>
<p>shell æœ‰äº¤äº’å’Œéäº¤äº’ä¸¤ç§æ¨¡å¼ã€‚</p>
<h4 id="äº¤äº’æ¨¡å¼"><a class="markdownIt-Anchor" href="#äº¤äº’æ¨¡å¼"></a> äº¤äº’æ¨¡å¼</h4>
<blockquote>
<p>ç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥å°† shell çš„äº¤äº’æ¨¡å¼ç†è§£ä¸ºæ‰§è¡Œå‘½ä»¤è¡Œã€‚</p>
</blockquote>
<p>çœ‹åˆ°å½¢å¦‚ä¸‹é¢çš„ä¸œè¥¿ï¼Œè¯´æ˜ shell å¤„äºäº¤äº’æ¨¡å¼ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@host:~$</span><br></pre></td></tr></table></figure>
<p>æ¥ç€ï¼Œä¾¿å¯ä»¥è¾“å…¥ä¸€ç³»åˆ— Linux å‘½ä»¤ï¼Œæ¯”å¦‚ <code>ls</code>ï¼Œ<code>grep</code>ï¼Œ<code>cd</code>ï¼Œ<code>mkdir</code>ï¼Œ<code>rm</code> ç­‰ç­‰ã€‚</p>
<h4 id="éäº¤äº’æ¨¡å¼"><a class="markdownIt-Anchor" href="#éäº¤äº’æ¨¡å¼"></a> éäº¤äº’æ¨¡å¼</h4>
<blockquote>
<p>ç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥å°† shell çš„éäº¤äº’æ¨¡å¼ç†è§£ä¸ºæ‰§è¡Œ shell è„šæœ¬ã€‚</p>
</blockquote>
<p>åœ¨éäº¤äº’æ¨¡å¼ä¸‹ï¼Œshell ä»æ–‡ä»¶æˆ–è€…ç®¡é“ä¸­è¯»å–å‘½ä»¤å¹¶æ‰§è¡Œã€‚</p>
<p>å½“ shell è§£é‡Šå™¨æ‰§è¡Œå®Œæ–‡ä»¶ä¸­çš„æœ€åä¸€ä¸ªå‘½ä»¤ï¼Œshell è¿›ç¨‹ç»ˆæ­¢ï¼Œå¹¶å›åˆ°çˆ¶è¿›ç¨‹ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è®© shell ä»¥éäº¤äº’æ¨¡å¼è¿è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh /path/to/script.sh</span><br><span class="line">bash /path/to/script.sh</span><br><span class="line"><span class="built_in">source</span> /path/to/script.sh</span><br><span class="line">./path/to/script.sh</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>script.sh</code>æ˜¯ä¸€ä¸ªåŒ…å« shell è§£é‡Šå™¨å¯ä»¥è¯†åˆ«å¹¶æ‰§è¡Œçš„å‘½ä»¤çš„æ™®é€šæ–‡æœ¬æ–‡ä»¶ï¼Œ<code>sh</code>å’Œ<code>bash</code>æ˜¯ shell è§£é‡Šå™¨ç¨‹åºã€‚ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•å–œæ¬¢çš„ç¼–è¾‘å™¨åˆ›å»º<code>script.sh</code>ï¼ˆvimï¼Œnanoï¼ŒSublime Text, Atom ç­‰ç­‰ï¼‰ã€‚</p>
<p>å…¶ä¸­ï¼Œ<code>source /path/to/script.sh</code> å’Œ <code>./path/to/script.sh</code> æ˜¯ç­‰ä»·çš„ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡<code>chmod</code>å‘½ä»¤ç»™æ–‡ä»¶æ·»åŠ å¯æ‰§è¡Œçš„æƒé™ï¼Œæ¥ç›´æ¥æ‰§è¡Œè„šæœ¬æ–‡ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod +x /path/to/script.sh <span class="comment">#ä½¿è„šæœ¬å…·æœ‰æ‰§è¡Œæƒé™</span></span><br><span class="line">/path/to/test.sh</span><br></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹å¼è¦æ±‚è„šæœ¬æ–‡ä»¶çš„ç¬¬ä¸€è¡Œå¿…é¡»æŒ‡æ˜è¿è¡Œè¯¥è„šæœ¬çš„ç¨‹åºï¼Œæ¯”å¦‚ï¼š</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Hello, world!"</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„å‘½ä»¤<code>echo</code>æ¥è¾“å‡ºå­—ç¬¦ä¸²åˆ°å±å¹•ä¸Šã€‚</p>
<h2 id="2-åŸºæœ¬è¯­æ³•"><a class="markdownIt-Anchor" href="#2-åŸºæœ¬è¯­æ³•"></a> 2. åŸºæœ¬è¯­æ³•</h2>
<h3 id="21-è§£é‡Šå™¨"><a class="markdownIt-Anchor" href="#21-è§£é‡Šå™¨"></a> 2.1. è§£é‡Šå™¨</h3>
<p>å‰é¢è™½ç„¶ä¸¤æ¬¡æåˆ°äº†<code>#!</code> ï¼Œä½†æ˜¯æœ¬ç€é‡è¦çš„äº‹æƒ…è¯´ä¸‰éçš„ç²¾ç¥ï¼Œè¿™é‡Œå†å¼ºè°ƒä¸€éï¼š</p>
<p>åœ¨ shell è„šæœ¬ï¼Œ<code>#!</code> å‘Šè¯‰ç³»ç»Ÿå…¶åè·¯å¾„æ‰€æŒ‡å®šçš„ç¨‹åºå³æ˜¯è§£é‡Šæ­¤è„šæœ¬æ–‡ä»¶çš„ Shell è§£é‡Šå™¨ã€‚<code>#!</code> è¢«ç§°ä½œ<a href="https://zh.wikipedia.org/wiki/Shebang" target="_blank" rel="noopener">shebangï¼ˆä¹Ÿç§°ä¸º Hashbang ï¼‰</a>ã€‚</p>
<p><code>#!</code> å†³å®šäº†è„šæœ¬å¯ä»¥åƒä¸€ä¸ªç‹¬ç«‹çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸€æ ·æ‰§è¡Œï¼Œè€Œä¸ç”¨åœ¨ç»ˆç«¯ä¹‹å‰è¾“å…¥<code>sh</code>, <code>bash</code>, <code>python</code>, <code>php</code>ç­‰ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä»¥ä¸‹ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥æŒ‡å®š shell è§£é‡Šå™¨ä¸º bashï¼Œç¬¬äºŒç§æ–¹å¼æ›´å¥½</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br></pre></td></tr></table></figure>
<h3 id="22-æ³¨é‡Š"><a class="markdownIt-Anchor" href="#22-æ³¨é‡Š"></a> 2.2. æ³¨é‡Š</h3>
<p>æ³¨é‡Šå¯ä»¥è¯´æ˜ä½ çš„ä»£ç æ˜¯ä»€ä¹ˆä½œç”¨ï¼Œä»¥åŠä¸ºä»€ä¹ˆè¿™æ ·å†™ã€‚</p>
<p>shell è¯­æ³•ä¸­ï¼Œæ³¨é‡Šæ˜¯ç‰¹æ®Šçš„è¯­å¥ï¼Œä¼šè¢« shell è§£é‡Šå™¨å¿½ç•¥ã€‚</p>
<ul>
<li>å•è¡Œæ³¨é‡Š - ä»¥ <code>#</code> å¼€å¤´ï¼Œåˆ°è¡Œå°¾ç»“æŸã€‚</li>
<li>å¤šè¡Œæ³¨é‡Š - ä»¥ <code>:&lt;&lt;EOF</code> å¼€å¤´ï¼Œåˆ° <code>EOF</code> ç»“æŸã€‚</li>
</ul>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#--------------------------------------------</span></span><br><span class="line"><span class="comment"># shell æ³¨é‡Šç¤ºä¾‹</span></span><br><span class="line"><span class="comment"># authorï¼šzp</span></span><br><span class="line"><span class="comment">#--------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># echo 'è¿™æ˜¯å•è¡Œæ³¨é‡Š'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">########## è¿™æ˜¯åˆ†å‰²çº¿ ##########</span></span><br><span class="line"></span><br><span class="line">:&lt;&lt;EOF</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'è¿™æ˜¯å¤šè¡Œæ³¨é‡Š'</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'è¿™æ˜¯å¤šè¡Œæ³¨é‡Š'</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'è¿™æ˜¯å¤šè¡Œæ³¨é‡Š'</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<h3 id="23-echo"><a class="markdownIt-Anchor" href="#23-echo"></a> 2.3. echo</h3>
<p>echo ç”¨äºå­—ç¬¦ä¸²çš„è¾“å‡ºã€‚</p>
<p>è¾“å‡ºæ™®é€šå­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"hello, world"</span></span><br><span class="line"><span class="comment"># Output: hello, world</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºå«å˜é‡çš„å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"hello, \"zp\""</span></span><br><span class="line"><span class="comment"># Output: hello, "zp"</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºå«å˜é‡çš„å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">name=zp</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello, \"<span class="variable">$&#123;name&#125;</span>\""</span></span><br><span class="line"><span class="comment"># Output: hello, "zp"</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºå«æ¢è¡Œç¬¦çš„å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¾“å‡ºå«æ¢è¡Œç¬¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"YES\nNO"</span></span><br><span class="line"><span class="comment">#  Output: YES\nNO</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"YES\nNO"</span> <span class="comment"># -e å¼€å¯è½¬ä¹‰</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  YES</span></span><br><span class="line"><span class="comment">#  NO</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºå«ä¸æ¢è¡Œç¬¦çš„å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"YES"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"NO"</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  YES</span></span><br><span class="line"><span class="comment">#  NO</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"YES\c"</span> <span class="comment"># -e å¼€å¯è½¬ä¹‰ \c ä¸æ¢è¡Œ</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"NO"</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  YESNO</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºé‡å®šå‘è‡³æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"test"</span> &gt; test.txt</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºæ‰§è¡Œç»“æœ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> `<span class="built_in">pwd</span>`</span><br><span class="line"><span class="comment">#  Output:(å½“å‰ç›®å½•è·¯å¾„)</span></span><br></pre></td></tr></table></figure>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºæ™®é€šå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello, world"</span></span><br><span class="line"><span class="comment">#  Output: hello, world</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå«å˜é‡çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello, \"zp\""</span></span><br><span class="line"><span class="comment">#  Output: hello, "zp"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå«å˜é‡çš„å­—ç¬¦ä¸²</span></span><br><span class="line">name=zp</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello, \"<span class="variable">$&#123;name&#125;</span>\""</span></span><br><span class="line"><span class="comment">#  Output: hello, "zp"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå«æ¢è¡Œç¬¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"YES\nNO"</span></span><br><span class="line"><span class="comment">#  Output: YES\nNO</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"YES\nNO"</span> <span class="comment"># -e å¼€å¯è½¬ä¹‰</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  YES</span></span><br><span class="line"><span class="comment">#  NO</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå«ä¸æ¢è¡Œç¬¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"YES"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"NO"</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  YES</span></span><br><span class="line"><span class="comment">#  NO</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">"YES\c"</span> <span class="comment"># -e å¼€å¯è½¬ä¹‰ \c ä¸æ¢è¡Œ</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"NO"</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  YESNO</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå†…å®¹å®šå‘è‡³æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"test"</span> &gt; test.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºæ‰§è¡Œç»“æœ</span></span><br><span class="line"><span class="built_in">echo</span> `<span class="built_in">pwd</span>`</span><br><span class="line"><span class="comment">#  Output:(å½“å‰ç›®å½•è·¯å¾„)</span></span><br></pre></td></tr></table></figure>
<h3 id="24-printf"><a class="markdownIt-Anchor" href="#24-printf"></a> 2.4. printf</h3>
<p>printf ç”¨äºæ ¼å¼åŒ–è¾“å‡ºå­—ç¬¦ä¸²ã€‚</p>
<p>é»˜è®¤ï¼Œprintf ä¸ä¼šåƒ echo ä¸€æ ·è‡ªåŠ¨æ·»åŠ æ¢è¡Œç¬¦ï¼Œå¦‚æœéœ€è¦æ¢è¡Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ  <code>\n</code>ã€‚</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å•å¼•å·</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">'%d %s\n'</span> 1 <span class="string">"abc"</span></span><br><span class="line"><span class="comment">#  Output:1 abc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒå¼•å·</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"%d %s\n"</span> 1 <span class="string">"abc"</span></span><br><span class="line"><span class="comment">#  Output:1 abc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ— å¼•å·</span></span><br><span class="line"><span class="built_in">printf</span> %s abcdef</span><br><span class="line"><span class="comment">#  Output: abcdef(å¹¶ä¸ä¼šæ¢è¡Œ)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¼å¼åªæŒ‡å®šäº†ä¸€ä¸ªå‚æ•°ï¼Œä½†å¤šå‡ºçš„å‚æ•°ä»ç„¶ä¼šæŒ‰ç…§è¯¥æ ¼å¼è¾“å‡º</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"%s\n"</span> abc def</span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  abc</span></span><br><span class="line"><span class="comment">#  def</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"%s %s %s\n"</span> a b c d e f g h i j</span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  a b c</span></span><br><span class="line"><span class="comment">#  d e f</span></span><br><span class="line"><span class="comment">#  g h i</span></span><br><span class="line"><span class="comment">#  j</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œé‚£ä¹ˆ %s ç”¨ NULL ä»£æ›¿ï¼Œ%d ç”¨ 0 ä»£æ›¿</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"%s and %d \n"</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#   and 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¼å¼åŒ–è¾“å‡º</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"%-10s %-8s %-4s\n"</span> å§“å æ€§åˆ« ä½“é‡kg</span><br><span class="line"><span class="built_in">printf</span> <span class="string">"%-10s %-8s %-4.2f\n"</span> éƒ­é– ç”· 66.1234</span><br><span class="line"><span class="built_in">printf</span> <span class="string">"%-10s %-8s %-4.2f\n"</span> æ¨è¿‡ ç”· 48.6543</span><br><span class="line"><span class="built_in">printf</span> <span class="string">"%-10s %-8s %-4.2f\n"</span> éƒ­èŠ™ å¥³ 47.9876</span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  å§“å     æ€§åˆ«   ä½“é‡kg</span></span><br><span class="line"><span class="comment">#  éƒ­é–     ç”·      66.12</span></span><br><span class="line"><span class="comment">#  æ¨è¿‡     ç”·      48.65</span></span><br><span class="line"><span class="comment">#  éƒ­èŠ™     å¥³      47.99</span></span><br></pre></td></tr></table></figure>
<h4 id="printf-çš„è½¬ä¹‰ç¬¦"><a class="markdownIt-Anchor" href="#printf-çš„è½¬ä¹‰ç¬¦"></a> printf çš„è½¬ä¹‰ç¬¦</h4>
<table>
<thead>
<tr>
<th>åºåˆ—</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\a</code></td>
<td>è­¦å‘Šå­—ç¬¦ï¼Œé€šå¸¸ä¸º ASCII çš„ BEL å­—ç¬¦</td>
</tr>
<tr>
<td><code>\b</code></td>
<td>åé€€</td>
</tr>
<tr>
<td><code>\c</code></td>
<td>æŠ‘åˆ¶ï¼ˆä¸æ˜¾ç¤ºï¼‰è¾“å‡ºç»“æœä¸­ä»»ä½•ç»“å°¾çš„æ¢è¡Œå­—ç¬¦ï¼ˆåªåœ¨%b æ ¼å¼æŒ‡ç¤ºç¬¦æ§åˆ¶ä¸‹çš„å‚æ•°å­—ç¬¦ä¸²ä¸­æœ‰æ•ˆï¼‰ï¼Œè€Œä¸”ï¼Œä»»ä½•ç•™åœ¨å‚æ•°é‡Œçš„å­—ç¬¦ã€ä»»ä½•æ¥ä¸‹æ¥çš„å‚æ•°ä»¥åŠä»»ä½•ç•™åœ¨æ ¼å¼å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œéƒ½è¢«å¿½ç•¥</td>
</tr>
<tr>
<td><code>\f</code></td>
<td>æ¢é¡µï¼ˆformfeedï¼‰</td>
</tr>
<tr>
<td><code>\n</code></td>
<td>æ¢è¡Œ</td>
</tr>
<tr>
<td><code>\r</code></td>
<td>å›è½¦ï¼ˆCarriage returnï¼‰</td>
</tr>
<tr>
<td><code>\t</code></td>
<td>æ°´å¹³åˆ¶è¡¨ç¬¦</td>
</tr>
<tr>
<td><code>\v</code></td>
<td>å‚ç›´åˆ¶è¡¨ç¬¦</td>
</tr>
<tr>
<td><code>\\</code></td>
<td>ä¸€ä¸ªå­—é¢ä¸Šçš„åæ–œæ å­—ç¬¦</td>
</tr>
<tr>
<td><code>\ddd</code></td>
<td>è¡¨ç¤º 1 åˆ° 3 ä½æ•°å…«è¿›åˆ¶å€¼çš„å­—ç¬¦ã€‚ä»…åœ¨æ ¼å¼å­—ç¬¦ä¸²ä¸­æœ‰æ•ˆ</td>
</tr>
<tr>
<td><code>\0ddd</code></td>
<td>è¡¨ç¤º 1 åˆ° 3 ä½çš„å…«è¿›åˆ¶å€¼å­—ç¬¦</td>
</tr>
</tbody>
</table>
<h2 id="3-å˜é‡"><a class="markdownIt-Anchor" href="#3-å˜é‡"></a> 3. å˜é‡</h2>
<p>è·Ÿè®¸å¤šç¨‹åºè®¾è®¡è¯­è¨€ä¸€æ ·ï¼Œä½ å¯ä»¥åœ¨ bash ä¸­åˆ›å»ºå˜é‡ã€‚</p>
<p>Bash ä¸­æ²¡æœ‰æ•°æ®ç±»å‹ï¼Œbash ä¸­çš„å˜é‡å¯ä»¥ä¿å­˜ä¸€ä¸ªæ•°å­—ã€ä¸€ä¸ªå­—ç¬¦ã€ä¸€ä¸ªå­—ç¬¦ä¸²ç­‰ç­‰ã€‚åŒæ—¶æ— éœ€æå‰å£°æ˜å˜é‡ï¼Œç»™å˜é‡èµ‹å€¼ä¼šç›´æ¥åˆ›å»ºå˜é‡ã€‚</p>
<h3 id="31-å˜é‡å‘½ååŸåˆ™"><a class="markdownIt-Anchor" href="#31-å˜é‡å‘½ååŸåˆ™"></a> 3.1. å˜é‡å‘½ååŸåˆ™</h3>
<ul>
<li>å‘½ååªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œé¦–ä¸ªå­—ç¬¦ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ã€‚</li>
<li>ä¸­é—´ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰ã€‚</li>
<li>ä¸èƒ½ä½¿ç”¨æ ‡ç‚¹ç¬¦å·ã€‚</li>
<li>ä¸èƒ½ä½¿ç”¨ bash é‡Œçš„å…³é”®å­—ï¼ˆå¯ç”¨ help å‘½ä»¤æŸ¥çœ‹ä¿ç•™å…³é”®å­—ï¼‰ã€‚</li>
</ul>
<h3 id="32-å£°æ˜å˜é‡"><a class="markdownIt-Anchor" href="#32-å£°æ˜å˜é‡"></a> 3.2. å£°æ˜å˜é‡</h3>
<p>è®¿é—®å˜é‡çš„è¯­æ³•å½¢å¼ä¸ºï¼š<code>${var}</code> å’Œ <code>$var</code> ã€‚</p>
<p>å˜é‡åå¤–é¢çš„èŠ±æ‹¬å·æ˜¯å¯é€‰çš„ï¼ŒåŠ ä¸åŠ éƒ½è¡Œï¼ŒåŠ èŠ±æ‹¬å·æ˜¯ä¸ºäº†å¸®åŠ©è§£é‡Šå™¨è¯†åˆ«å˜é‡çš„è¾¹ç•Œï¼Œæ‰€ä»¥æ¨èåŠ èŠ±æ‹¬å·ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">word=<span class="string">"hello"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;word&#125;</span></span><br><span class="line"><span class="comment"># Output: hello</span></span><br></pre></td></tr></table></figure>
<h3 id="33-åªè¯»å˜é‡"><a class="markdownIt-Anchor" href="#33-åªè¯»å˜é‡"></a> 3.3. åªè¯»å˜é‡</h3>
<p>ä½¿ç”¨ readonly å‘½ä»¤å¯ä»¥å°†å˜é‡å®šä¹‰ä¸ºåªè¯»å˜é‡ï¼Œåªè¯»å˜é‡çš„å€¼ä¸èƒ½è¢«æ”¹å˜ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rword=<span class="string">"hello"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;rword&#125;</span></span><br><span class="line"><span class="built_in">readonly</span> rword</span><br><span class="line"><span class="comment"># rword="bye"  # å¦‚æœæ”¾å¼€æ³¨é‡Šï¼Œæ‰§è¡Œæ—¶ä¼šæŠ¥é”™</span></span><br></pre></td></tr></table></figure>
<h3 id="34-åˆ é™¤å˜é‡"><a class="markdownIt-Anchor" href="#34-åˆ é™¤å˜é‡"></a> 3.4. åˆ é™¤å˜é‡</h3>
<p>ä½¿ç”¨ unset å‘½ä»¤å¯ä»¥åˆ é™¤å˜é‡ã€‚å˜é‡è¢«åˆ é™¤åä¸èƒ½å†æ¬¡ä½¿ç”¨ã€‚unset å‘½ä»¤ä¸èƒ½åˆ é™¤åªè¯»å˜é‡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dword=<span class="string">"hello"</span>  <span class="comment"># å£°æ˜å˜é‡</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;dword&#125;</span>  <span class="comment"># è¾“å‡ºå˜é‡å€¼</span></span><br><span class="line"><span class="comment"># Output: hello</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> dword    <span class="comment"># åˆ é™¤å˜é‡</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;dword&#125;</span></span><br><span class="line"><span class="comment"># Output: ï¼ˆç©ºï¼‰</span></span><br></pre></td></tr></table></figure>
<h3 id="35-å˜é‡ç±»å‹"><a class="markdownIt-Anchor" href="#35-å˜é‡ç±»å‹"></a> 3.5. å˜é‡ç±»å‹</h3>
<ul>
<li><strong>å±€éƒ¨å˜é‡</strong> - å±€éƒ¨å˜é‡æ˜¯ä»…åœ¨æŸä¸ªè„šæœ¬å†…éƒ¨æœ‰æ•ˆçš„å˜é‡ã€‚å®ƒä»¬ä¸èƒ½è¢«å…¶ä»–çš„ç¨‹åºå’Œè„šæœ¬è®¿é—®ã€‚</li>
<li><strong>ç¯å¢ƒå˜é‡</strong> - ç¯å¢ƒå˜é‡æ˜¯å¯¹å½“å‰ shell ä¼šè¯å†…æ‰€æœ‰çš„ç¨‹åºæˆ–è„šæœ¬éƒ½å¯è§çš„å˜é‡ã€‚åˆ›å»ºå®ƒä»¬è·Ÿåˆ›å»ºå±€éƒ¨å˜é‡ç±»ä¼¼ï¼Œä½†ä½¿ç”¨çš„æ˜¯ <code>export</code> å…³é”®å­—ï¼Œshell è„šæœ¬ä¹Ÿå¯ä»¥å®šä¹‰ç¯å¢ƒå˜é‡ã€‚</li>
</ul>
<p>å¸¸è§çš„ç¯å¢ƒå˜é‡ï¼š</p>
<table>
<thead>
<tr>
<th>å˜é‡</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$HOME</code></td>
<td>å½“å‰ç”¨æˆ·çš„ç”¨æˆ·ç›®å½•</td>
</tr>
<tr>
<td><code>$PATH</code></td>
<td>ç”¨åˆ†å·åˆ†éš”çš„ç›®å½•åˆ—è¡¨ï¼Œshell ä¼šåˆ°è¿™äº›ç›®å½•ä¸­æŸ¥æ‰¾å‘½ä»¤</td>
</tr>
<tr>
<td><code>$PWD</code></td>
<td>å½“å‰å·¥ä½œç›®å½•</td>
</tr>
<tr>
<td><code>$RANDOM</code></td>
<td>0 åˆ° 32767 ä¹‹é—´çš„æ•´æ•°</td>
</tr>
<tr>
<td><code>$UID</code></td>
<td>æ•°å€¼ç±»å‹ï¼Œå½“å‰ç”¨æˆ·çš„ç”¨æˆ· ID</td>
</tr>
<tr>
<td><code>$PS1</code></td>
<td>ä¸»è¦ç³»ç»Ÿè¾“å…¥æç¤ºç¬¦</td>
</tr>
<tr>
<td><code>$PS2</code></td>
<td>æ¬¡è¦ç³»ç»Ÿè¾“å…¥æç¤ºç¬¦</td>
</tr>
</tbody>
</table>
<p><a href="http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_02.html###sect_03_02_04" target="_blank" rel="noopener">è¿™é‡Œ</a> æœ‰ä¸€å¼ æ›´å…¨é¢çš„ Bash ç¯å¢ƒå˜é‡åˆ—è¡¨ã€‚</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### å£°æ˜å˜é‡ ###################</span></span><br><span class="line">name=<span class="string">"world"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello <span class="variable">$&#123;name&#125;</span>"</span></span><br><span class="line"><span class="comment"># Output: hello world</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### è¾“å‡ºå˜é‡ ###################</span></span><br><span class="line">folder=$(<span class="built_in">pwd</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"current path: <span class="variable">$&#123;folder&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### åªè¯»å˜é‡ ###################</span></span><br><span class="line">rword=<span class="string">"hello"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;rword&#125;</span></span><br><span class="line"><span class="comment"># Output: hello</span></span><br><span class="line"><span class="built_in">readonly</span> rword</span><br><span class="line"><span class="comment"># rword="bye"  # å¦‚æœæ”¾å¼€æ³¨é‡Šï¼Œæ‰§è¡Œæ—¶ä¼šæŠ¥é”™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### åˆ é™¤å˜é‡ ###################</span></span><br><span class="line">dword=<span class="string">"hello"</span> <span class="comment"># å£°æ˜å˜é‡</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;dword&#125;</span> <span class="comment"># è¾“å‡ºå˜é‡å€¼</span></span><br><span class="line"><span class="comment"># Output: hello</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> dword <span class="comment"># åˆ é™¤å˜é‡</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;dword&#125;</span></span><br><span class="line"><span class="comment"># Output: ï¼ˆç©ºï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### ç³»ç»Ÿå˜é‡ ###################</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"UID:<span class="variable">$UID</span>"</span></span><br><span class="line"><span class="built_in">echo</span> LOGNAME:<span class="variable">$LOGNAME</span></span><br><span class="line"><span class="built_in">echo</span> User:<span class="variable">$USER</span></span><br><span class="line"><span class="built_in">echo</span> HOME:<span class="variable">$HOME</span></span><br><span class="line"><span class="built_in">echo</span> PATH:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">echo</span> HOSTNAME:<span class="variable">$HOSTNAME</span></span><br><span class="line"><span class="built_in">echo</span> SHELL:<span class="variable">$SHELL</span></span><br><span class="line"><span class="built_in">echo</span> LANG:<span class="variable">$LANG</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### è‡ªå®šä¹‰å˜é‡ ###################</span></span><br><span class="line">days=10</span><br><span class="line">user=<span class="string">"admin"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$user</span> logged in <span class="variable">$days</span> days age"</span></span><br><span class="line">days=5</span><br><span class="line">user=<span class="string">"root"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$user</span> logged in <span class="variable">$days</span> days age"</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># admin logged in 10 days age</span></span><br><span class="line"><span class="comment"># root logged in 5 days age</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### ä»å˜é‡è¯»å–åˆ—è¡¨ ###################</span></span><br><span class="line">colors=<span class="string">"Red Yellow Blue"</span></span><br><span class="line">colors=<span class="variable">$colors</span><span class="string">" White Black"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> color <span class="keyword">in</span> <span class="variable">$colors</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">" <span class="variable">$color</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="4-å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#4-å­—ç¬¦ä¸²"></a> 4. å­—ç¬¦ä¸²</h2>
<h3 id="41-å•å¼•å·å’ŒåŒå¼•å·"><a class="markdownIt-Anchor" href="#41-å•å¼•å·å’ŒåŒå¼•å·"></a> 4.1. å•å¼•å·å’ŒåŒå¼•å·</h3>
<p>shell å­—ç¬¦ä¸²å¯ä»¥ç”¨å•å¼•å· <code>''</code>ï¼Œä¹Ÿå¯ä»¥ç”¨åŒå¼•å· <code>â€œâ€</code>ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·ã€‚</p>
<ul>
<li>å•å¼•å·çš„ç‰¹ç‚¹
<ul>
<li>å•å¼•å·é‡Œä¸è¯†åˆ«å˜é‡</li>
<li>å•å¼•å·é‡Œä¸èƒ½å‡ºç°å•ç‹¬çš„å•å¼•å·ï¼ˆä½¿ç”¨è½¬ä¹‰ç¬¦ä¹Ÿä¸è¡Œï¼‰ï¼Œä½†å¯æˆå¯¹å‡ºç°ï¼Œä½œä¸ºå­—ç¬¦ä¸²æ‹¼æ¥ä½¿ç”¨ã€‚</li>
</ul>
</li>
<li>åŒå¼•å·çš„ç‰¹ç‚¹
<ul>
<li>åŒå¼•å·é‡Œè¯†åˆ«å˜é‡</li>
<li>åŒå¼•å·é‡Œå¯ä»¥å‡ºç°è½¬ä¹‰å­—ç¬¦</li>
</ul>
</li>
</ul>
<p>ç»¼ä¸Šï¼Œæ¨èä½¿ç”¨åŒå¼•å·ã€‚</p>
<h3 id="42-æ‹¼æ¥å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#42-æ‹¼æ¥å­—ç¬¦ä¸²"></a> 4.2. æ‹¼æ¥å­—ç¬¦ä¸²</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨å•å¼•å·æ‹¼æ¥</span></span><br><span class="line">name1=<span class="string">'white'</span></span><br><span class="line">str1=<span class="string">'hello, '</span><span class="variable">$&#123;name1&#125;</span><span class="string">''</span></span><br><span class="line">str2=<span class="string">'hello, $&#123;name1&#125;'</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str1&#125;</span>_<span class="variable">$&#123;str2&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># hello, white_hello, $&#123;name1&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨åŒå¼•å·æ‹¼æ¥</span></span><br><span class="line">name2=<span class="string">"black"</span></span><br><span class="line">str3=<span class="string">"hello, "</span><span class="variable">$&#123;name2&#125;</span><span class="string">""</span></span><br><span class="line">str4=<span class="string">"hello, <span class="variable">$&#123;name2&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str3&#125;</span>_<span class="variable">$&#123;str4&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># hello, black_hello, black</span></span><br></pre></td></tr></table></figure>
<h3 id="43-è·å–å­—ç¬¦ä¸²é•¿åº¦"><a class="markdownIt-Anchor" href="#43-è·å–å­—ç¬¦ä¸²é•¿åº¦"></a> 4.3. è·å–å­—ç¬¦ä¸²é•¿åº¦</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">text=<span class="string">"12345"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#text&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 5</span></span><br></pre></td></tr></table></figure>
<h3 id="44-æˆªå–å­å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#44-æˆªå–å­å­—ç¬¦ä¸²"></a> 4.4. æˆªå–å­å­—ç¬¦ä¸²</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">text=<span class="string">"12345"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;text:2:2&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 34</span></span><br></pre></td></tr></table></figure>
<p>ä»ç¬¬ 3 ä¸ªå­—ç¬¦å¼€å§‹ï¼Œæˆªå– 2 ä¸ªå­—ç¬¦</p>
<h3 id="45-æŸ¥æ‰¾å­å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#45-æŸ¥æ‰¾å­å­—ç¬¦ä¸²"></a> 4.5. æŸ¥æ‰¾å­å­—ç¬¦ä¸²</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line">text=<span class="string">"hello"</span></span><br><span class="line"><span class="built_in">echo</span> `expr index <span class="string">"<span class="variable">$&#123;text&#125;</span>"</span> ll`</span><br><span class="line"></span><br><span class="line"><span class="comment"># Execute: ./str-demo5.sh</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 3</span></span><br></pre></td></tr></table></figure>
<p>æŸ¥æ‰¾ <code>ll</code> å­å­—ç¬¦åœ¨ <code>hello</code> å­—ç¬¦ä¸²ä¸­çš„èµ·å§‹ä½ç½®ã€‚</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### ä½¿ç”¨å•å¼•å·æ‹¼æ¥å­—ç¬¦ä¸² ###################</span></span><br><span class="line">name1=<span class="string">'white'</span></span><br><span class="line">str1=<span class="string">'hello, '</span><span class="variable">$&#123;name1&#125;</span><span class="string">''</span></span><br><span class="line">str2=<span class="string">'hello, $&#123;name1&#125;'</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str1&#125;</span>_<span class="variable">$&#123;str2&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># hello, white_hello, $&#123;name1&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### ä½¿ç”¨åŒå¼•å·æ‹¼æ¥å­—ç¬¦ä¸² ###################</span></span><br><span class="line">name2=<span class="string">"black"</span></span><br><span class="line">str3=<span class="string">"hello, "</span><span class="variable">$&#123;name2&#125;</span><span class="string">""</span></span><br><span class="line">str4=<span class="string">"hello, <span class="variable">$&#123;name2&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str3&#125;</span>_<span class="variable">$&#123;str4&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># hello, black_hello, black</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### è·å–å­—ç¬¦ä¸²é•¿åº¦ ###################</span></span><br><span class="line">text=<span class="string">"12345"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;text&#125;</span> length is: <span class="variable">$&#123;#text&#125;</span>"</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 12345 length is: 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å­å­—ç¬¦ä¸²</span></span><br><span class="line">text=<span class="string">"12345"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;text:2:2&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 34</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### æŸ¥æ‰¾å­å­—ç¬¦ä¸² ###################</span></span><br><span class="line">text=<span class="string">"hello"</span></span><br><span class="line"><span class="built_in">echo</span> `expr index <span class="string">"<span class="variable">$&#123;text&#125;</span>"</span> ll`</span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### åˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«å­å­—ç¬¦ä¸² ###################</span></span><br><span class="line">result=$(<span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;str&#125;</span>"</span> | grep <span class="string">"feature/"</span>)</span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">"<span class="variable">$result</span>"</span> != <span class="string">""</span> ]]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"feature/ æ˜¯ <span class="variable">$&#123;str&#125;</span> çš„å­å­—ç¬¦ä¸²"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"feature/ ä¸æ˜¯ <span class="variable">$&#123;str&#125;</span> çš„å­å­—ç¬¦ä¸²"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### æˆªå–å…³é”®å­—å·¦è¾¹å†…å®¹ ###################</span></span><br><span class="line">full_branch=<span class="string">"feature/1.0.0"</span></span><br><span class="line">branch=`<span class="built_in">echo</span> <span class="variable">$&#123;full_branch#feature/&#125;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"branch is <span class="variable">$&#123;branch&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### æˆªå–å…³é”®å­—å³è¾¹å†…å®¹ ###################</span></span><br><span class="line">full_version=<span class="string">"0.0.1-SNAPSHOT"</span></span><br><span class="line">version=`<span class="built_in">echo</span> <span class="variable">$&#123;full_version%-SNAPSHOT&#125;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"version is <span class="variable">$&#123;version&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### å­—ç¬¦ä¸²åˆ†å‰²æˆæ•°ç»„ ###################</span></span><br><span class="line">str=<span class="string">"0.0.0.1"</span></span><br><span class="line">OLD_IFS=<span class="string">"<span class="variable">$IFS</span>"</span></span><br><span class="line">IFS=<span class="string">"."</span></span><br><span class="line">array=( <span class="variable">$&#123;str&#125;</span> )</span><br><span class="line">IFS=<span class="string">"<span class="variable">$OLD_IFS</span>"</span></span><br><span class="line">size=<span class="variable">$&#123;#array[*]&#125;</span></span><br><span class="line">lastIndex=`expr <span class="variable">$&#123;size&#125;</span> - 1`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"æ•°ç»„é•¿åº¦ï¼š<span class="variable">$&#123;size&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"æœ€åä¸€ä¸ªæ•°ç»„å…ƒç´ ï¼š<span class="variable">$&#123;array[$&#123;lastIndex&#125;</span>]&#125;"</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> <span class="variable">$&#123;array[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"<span class="variable">$item</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º ###################</span></span><br><span class="line"><span class="comment">#-n åˆ¤æ–­é•¿åº¦æ˜¯å¦éé›¶</span></span><br><span class="line"><span class="comment">#-z åˆ¤æ–­é•¿åº¦æ˜¯å¦ä¸ºé›¶</span></span><br><span class="line"></span><br><span class="line">str=testing</span><br><span class="line">str2=<span class="string">''</span></span><br><span class="line"><span class="keyword">if</span> [[ -n <span class="string">"<span class="variable">$str</span>"</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"The string <span class="variable">$str</span> is not empty"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"The string <span class="variable">$str</span> is empty"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ -n <span class="string">"<span class="variable">$str2</span>"</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"The string <span class="variable">$str2</span> is not empty"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"The string <span class="variable">$str2</span> is empty"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#	Output:</span></span><br><span class="line"><span class="comment">#	The string testing is not empty</span></span><br><span class="line"><span class="comment">#	The string  is empty</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### å­—ç¬¦ä¸²æ¯”è¾ƒ ###################</span></span><br><span class="line">str=hello</span><br><span class="line">str2=world</span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$str</span> = <span class="string">"hello"</span> ]]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"str equals hello"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"str not equals hello"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$str2</span> = <span class="string">"hello"</span> ]]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"str2 equals hello"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"str2 not equals hello"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h2 id="5-æ•°ç»„"><a class="markdownIt-Anchor" href="#5-æ•°ç»„"></a> 5. æ•°ç»„</h2>
<p>bash åªæ”¯æŒä¸€ç»´æ•°ç»„ã€‚</p>
<p>æ•°ç»„ä¸‹æ ‡ä» 0 å¼€å§‹ï¼Œä¸‹æ ‡å¯ä»¥æ˜¯æ•´æ•°æˆ–ç®—æœ¯è¡¨è¾¾å¼ï¼Œå…¶å€¼åº”å¤§äºæˆ–ç­‰äº 0ã€‚</p>
<h3 id="51-åˆ›å»ºæ•°ç»„"><a class="markdownIt-Anchor" href="#51-åˆ›å»ºæ•°ç»„"></a> 5.1. åˆ›å»ºæ•°ç»„</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæ•°ç»„çš„ä¸åŒæ–¹å¼</span></span><br><span class="line">nums=([2]=2 [0]=0 [1]=1)</span><br><span class="line">colors=(red yellow <span class="string">"dark blue"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="52-è®¿é—®æ•°ç»„å…ƒç´ "><a class="markdownIt-Anchor" href="#52-è®¿é—®æ•°ç»„å…ƒç´ "></a> 5.2. è®¿é—®æ•°ç»„å…ƒç´ </h3>
<ul>
<li><strong>è®¿é—®æ•°ç»„çš„å•ä¸ªå…ƒç´ ï¼š</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;nums[1]&#125;</span></span><br><span class="line"><span class="comment"># Output: 1</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>è®¿é—®æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ï¼š</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;colors[*]&#125;</span></span><br><span class="line"><span class="comment"># Output: red yellow dark blue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;colors[@]&#125;</span></span><br><span class="line"><span class="comment"># Output: red yellow dark blue</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤è¡Œæœ‰å¾ˆé‡è¦ï¼ˆä¹Ÿå¾ˆå¾®å¦™ï¼‰çš„åŒºåˆ«ï¼š</p>
<p>ä¸ºäº†å°†æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ å•ç‹¬ä¸€è¡Œè¾“å‡ºï¼Œæˆ‘ä»¬ç”¨ <code>printf</code> å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="variable">$&#123;colors[*]&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># + red</span></span><br><span class="line"><span class="comment"># + yellow</span></span><br><span class="line"><span class="comment"># + dark</span></span><br><span class="line"><span class="comment"># + blue</span></span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆ<code>dark</code>å’Œ<code>blue</code>å„å äº†ä¸€è¡Œï¼Ÿå°è¯•ç”¨å¼•å·åŒ…èµ·æ¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="string">"<span class="variable">$&#123;colors[*]&#125;</span>"</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># + red yellow dark blue</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æ‰€æœ‰çš„å…ƒç´ éƒ½åœ¨ä¸€è¡Œè¾“å‡º â€”â€” è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼è®©æˆ‘ä»¬è¯•è¯•<code>${colors[@]}</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="string">"<span class="variable">$&#123;colors[@]&#125;</span>"</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># + red</span></span><br><span class="line"><span class="comment"># + yellow</span></span><br><span class="line"><span class="comment"># + dark blue</span></span><br></pre></td></tr></table></figure>
<p>åœ¨å¼•å·å†…ï¼Œ<code>${colors[@]}</code>å°†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ‰©å±•ä¸ºä¸€ä¸ªå•ç‹¬çš„å‚æ•°ï¼›æ•°ç»„å…ƒç´ ä¸­çš„ç©ºæ ¼å¾—ä»¥ä¿ç•™ã€‚</p>
<ul>
<li><strong>è®¿é—®æ•°ç»„çš„éƒ¨åˆ†å…ƒç´ ï¼š</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;nums[@]:0:2&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 0 1</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>${array[@]}</code> æ‰©å±•ä¸ºæ•´ä¸ªæ•°ç»„ï¼Œ<code>:0:2</code>å–å‡ºäº†æ•°ç»„ä¸­ä» 0 å¼€å§‹ï¼Œé•¿åº¦ä¸º 2 çš„å…ƒç´ ã€‚</p>
<h3 id="53-è®¿é—®æ•°ç»„é•¿åº¦"><a class="markdownIt-Anchor" href="#53-è®¿é—®æ•°ç»„é•¿åº¦"></a> 5.3. è®¿é—®æ•°ç»„é•¿åº¦</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#nums[*]&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 3</span></span><br></pre></td></tr></table></figure>
<h3 id="54-å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´ "><a class="markdownIt-Anchor" href="#54-å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´ "></a> 5.4. å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´ </h3>
<p>å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´ ä¹Ÿéå¸¸ç®€å•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">colors=(white <span class="string">"<span class="variable">$&#123;colors[@]&#125;</span>"</span> green black)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;colors[@]&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># white red yellow dark blue green black</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>${colors[@]}</code> æ‰©å±•ä¸ºæ•´ä¸ªæ•°ç»„ï¼Œå¹¶è¢«ç½®æ¢åˆ°å¤åˆèµ‹å€¼è¯­å¥ä¸­ï¼Œæ¥ç€ï¼Œå¯¹æ•°ç»„<code>colors</code>çš„èµ‹å€¼è¦†ç›–äº†å®ƒåŸæ¥çš„å€¼ã€‚</p>
<h3 id="55-ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ "><a class="markdownIt-Anchor" href="#55-ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ "></a> 5.5. ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ </h3>
<p>ç”¨<code>unset</code>å‘½ä»¤æ¥ä»æ•°ç»„ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">unset</span> nums[0]</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;nums[@]&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 1 2</span></span><br></pre></td></tr></table></figure>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### åˆ›å»ºæ•°ç»„ ###################</span></span><br><span class="line">nums=( [ 2 ] = 2 [ 0 ] = 0 [ 1 ] = 1 )</span><br><span class="line">colors=( red yellow <span class="string">"dark blue"</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment">################### è®¿é—®æ•°ç»„çš„å•ä¸ªå…ƒç´  ###################</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;nums[1]&#125;</span></span><br><span class="line"><span class="comment"># Output: 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### è®¿é—®æ•°ç»„çš„æ‰€æœ‰å…ƒç´  ###################</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;colors[*]&#125;</span></span><br><span class="line"><span class="comment"># Output: red yellow dark blue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;colors[@]&#125;</span></span><br><span class="line"><span class="comment"># Output: red yellow dark blue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="variable">$&#123;colors[*]&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># + red</span></span><br><span class="line"><span class="comment"># + yellow</span></span><br><span class="line"><span class="comment"># + dark</span></span><br><span class="line"><span class="comment"># + blue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="string">"<span class="variable">$&#123;colors[*]&#125;</span>"</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># + red yellow dark blue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="string">"<span class="variable">$&#123;colors[@]&#125;</span>"</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># + red</span></span><br><span class="line"><span class="comment"># + yellow</span></span><br><span class="line"><span class="comment"># + dark blue</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### è®¿é—®æ•°ç»„çš„éƒ¨åˆ†å…ƒç´  ###################</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;nums[@]:0:2&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 0 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### è·å–æ•°ç»„é•¿åº¦ ###################</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#nums[*]&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### å‘æ•°ç»„ä¸­æ·»åŠ å…ƒç´  ###################</span></span><br><span class="line">colors=( white <span class="string">"<span class="variable">$&#123;colors[@]&#125;</span>"</span> green black )</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;colors[@]&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># white red yellow dark blue green black</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################### ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´  ###################</span></span><br><span class="line"><span class="built_in">unset</span> nums[ 0 ]</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;nums[@]&#125;</span></span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># 1 2</span></span><br></pre></td></tr></table></figure>
<h2 id="6-è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#6-è¿ç®—ç¬¦"></a> 6. è¿ç®—ç¬¦</h2>
<h3 id="61-ç®—æœ¯è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#61-ç®—æœ¯è¿ç®—ç¬¦"></a> 6.1. ç®—æœ¯è¿ç®—ç¬¦</h3>
<p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„ç®—æœ¯è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ x ä¸º 10ï¼Œå˜é‡ y ä¸º 20ï¼š</p>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>è¯´æ˜</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>åŠ æ³•</td>
<td><code>expr $x + $y</code> ç»“æœä¸º 30ã€‚</td>
</tr>
<tr>
<td>-</td>
<td>å‡æ³•</td>
<td><code>expr $x - $y</code> ç»“æœä¸º -10ã€‚</td>
</tr>
<tr>
<td>*</td>
<td>ä¹˜æ³•</td>
<td><code>expr $x * $y</code> ç»“æœä¸º 200ã€‚</td>
</tr>
<tr>
<td>/</td>
<td>é™¤æ³•</td>
<td><code>expr $y / $x</code> ç»“æœä¸º 2ã€‚</td>
</tr>
<tr>
<td>%</td>
<td>å–ä½™</td>
<td><code>expr $y % $x</code> ç»“æœä¸º 0ã€‚</td>
</tr>
<tr>
<td>=</td>
<td>èµ‹å€¼</td>
<td><code>x=$y</code> å°†æŠŠå˜é‡ y çš„å€¼èµ‹ç»™ xã€‚</td>
</tr>
<tr>
<td>==</td>
<td>ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œç›¸åŒåˆ™è¿”å› trueã€‚</td>
<td><code>[ $x == $y ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td>!=</td>
<td>ä¸ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œä¸ç›¸åŒåˆ™è¿”å› trueã€‚</td>
<td><code>[ $x != $y ]</code> è¿”å› trueã€‚</td>
</tr>
</tbody>
</table>
<p>**æ³¨æ„ï¼š**æ¡ä»¶è¡¨è¾¾å¼è¦æ”¾åœ¨æ–¹æ‹¬å·ä¹‹é—´ï¼Œå¹¶ä¸”è¦æœ‰ç©ºæ ¼ï¼Œä¾‹å¦‚: <code>[$x==$y]</code> æ˜¯é”™è¯¯çš„ï¼Œå¿…é¡»å†™æˆ <code>[ $x == $y ]</code>ã€‚</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x=10</span><br><span class="line">y=20</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"x=<span class="variable">$&#123;x&#125;</span>, y=<span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"></span><br><span class="line">val=`expr <span class="variable">$&#123;x&#125;</span> + <span class="variable">$&#123;y&#125;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> + <span class="variable">$&#123;y&#125;</span> = <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line">val=`expr <span class="variable">$&#123;x&#125;</span> - <span class="variable">$&#123;y&#125;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> - <span class="variable">$&#123;y&#125;</span> = <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line">val=`expr <span class="variable">$&#123;x&#125;</span> \* <span class="variable">$&#123;y&#125;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> * <span class="variable">$&#123;y&#125;</span> = <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line">val=`expr <span class="variable">$&#123;y&#125;</span> / <span class="variable">$&#123;x&#125;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;y&#125;</span> / <span class="variable">$&#123;x&#125;</span> = <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line">val=`expr <span class="variable">$&#123;y&#125;</span> % <span class="variable">$&#123;x&#125;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;y&#125;</span> % <span class="variable">$&#123;x&#125;</span> = <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> == <span class="variable">$&#123;y&#125;</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> = <span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> != <span class="variable">$&#123;y&#125;</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> != <span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  x=10, y=20</span></span><br><span class="line"><span class="comment">#  10 + 20 = 30</span></span><br><span class="line"><span class="comment">#  10 - 20 = -10</span></span><br><span class="line"><span class="comment">#  10 * 20 = 200</span></span><br><span class="line"><span class="comment">#  20 / 10 = 2</span></span><br><span class="line"><span class="comment">#  20 % 10 = 0</span></span><br><span class="line"><span class="comment">#  10 != 20</span></span><br></pre></td></tr></table></figure>
<h3 id="62-å…³ç³»è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#62-å…³ç³»è¿ç®—ç¬¦"></a> 6.2. å…³ç³»è¿ç®—ç¬¦</h3>
<p>å…³ç³»è¿ç®—ç¬¦åªæ”¯æŒæ•°å­—ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²ï¼Œé™¤éå­—ç¬¦ä¸²çš„å€¼æ˜¯æ•°å­—ã€‚</p>
<p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å…³ç³»è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ x ä¸º 10ï¼Œå˜é‡ y ä¸º 20ï¼š</p>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>è¯´æ˜</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-eq</code></td>
<td>æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚</td>
<td><code>[ $a -eq $b ]</code>è¿”å› falseã€‚</td>
</tr>
<tr>
<td><code>-ne</code></td>
<td>æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚</td>
<td><code>[ $a -ne $b ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td><code>-gt</code></td>
<td>æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ $a -gt $b ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td><code>-lt</code></td>
<td>æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ $a -lt $b ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td><code>-ge</code></td>
<td>æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ $a -ge $b ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td><code>-le</code></td>
<td>æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ $a -le $b ]</code>è¿”å› trueã€‚</td>
</tr>
</tbody>
</table>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x=10</span><br><span class="line">y=20</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"x=<span class="variable">$&#123;x&#125;</span>, y=<span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -eq <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -eq <span class="variable">$&#123;y&#125;</span> : x ç­‰äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -eq <span class="variable">$&#123;y&#125;</span>: x ä¸ç­‰äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -ne <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -ne <span class="variable">$&#123;y&#125;</span>: x ä¸ç­‰äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -ne <span class="variable">$&#123;y&#125;</span>: x ç­‰äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -gt <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -gt <span class="variable">$&#123;y&#125;</span>: x å¤§äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -gt <span class="variable">$&#123;y&#125;</span>: x ä¸å¤§äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -lt <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -lt <span class="variable">$&#123;y&#125;</span>: x å°äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -lt <span class="variable">$&#123;y&#125;</span>: x ä¸å°äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -ge <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -ge <span class="variable">$&#123;y&#125;</span>: x å¤§äºæˆ–ç­‰äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -ge <span class="variable">$&#123;y&#125;</span>: x å°äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -le <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -le <span class="variable">$&#123;y&#125;</span>: x å°äºæˆ–ç­‰äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -le <span class="variable">$&#123;y&#125;</span>: x å¤§äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  x=10, y=20</span></span><br><span class="line"><span class="comment">#  10 -eq 20: x ä¸ç­‰äº y</span></span><br><span class="line"><span class="comment">#  10 -ne 20: x ä¸ç­‰äº y</span></span><br><span class="line"><span class="comment">#  10 -gt 20: x ä¸å¤§äº y</span></span><br><span class="line"><span class="comment">#  10 -lt 20: x å°äº y</span></span><br><span class="line"><span class="comment">#  10 -ge 20: x å°äº y</span></span><br><span class="line"><span class="comment">#  10 -le 20: x å°äºæˆ–ç­‰äº y</span></span><br></pre></td></tr></table></figure>
<h3 id="63-å¸ƒå°”è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#63-å¸ƒå°”è¿ç®—ç¬¦"></a> 6.3. å¸ƒå°”è¿ç®—ç¬¦</h3>
<p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å¸ƒå°”è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ x ä¸º 10ï¼Œå˜é‡ y ä¸º 20ï¼š</p>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>è¯´æ˜</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>!</code></td>
<td>éè¿ç®—ï¼Œè¡¨è¾¾å¼ä¸º true åˆ™è¿”å› falseï¼Œå¦åˆ™è¿”å› trueã€‚</td>
<td><code>[ ! false ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td><code>-o</code></td>
<td>æˆ–è¿ç®—ï¼Œæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ä¸º true åˆ™è¿”å› trueã€‚</td>
<td><code>[ $a -lt 20 -o $b -gt 100 ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td><code>-a</code></td>
<td>ä¸è¿ç®—ï¼Œä¸¤ä¸ªè¡¨è¾¾å¼éƒ½ä¸º true æ‰è¿”å› trueã€‚</td>
<td><code>[ $a -lt 20 -a $b -gt 100 ]</code> è¿”å› falseã€‚</td>
</tr>
</tbody>
</table>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x=10</span><br><span class="line">y=20</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"x=<span class="variable">$&#123;x&#125;</span>, y=<span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> != <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> != <span class="variable">$&#123;y&#125;</span> : x ä¸ç­‰äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> != <span class="variable">$&#123;y&#125;</span>: x ç­‰äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -lt 100 &amp;&amp; <span class="variable">$&#123;y&#125;</span> -gt 15 ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> å°äº 100 ä¸” <span class="variable">$&#123;y&#125;</span> å¤§äº 15 : è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> å°äº 100 ä¸” <span class="variable">$&#123;y&#125;</span> å¤§äº 15 : è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -lt 100 || <span class="variable">$&#123;y&#125;</span> -gt 100 ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> å°äº 100 æˆ– <span class="variable">$&#123;y&#125;</span> å¤§äº 100 : è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> å°äº 100 æˆ– <span class="variable">$&#123;y&#125;</span> å¤§äº 100 : è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -lt 5 || <span class="variable">$&#123;y&#125;</span> -gt 100 ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> å°äº 5 æˆ– <span class="variable">$&#123;y&#125;</span> å¤§äº 100 : è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> å°äº 5 æˆ– <span class="variable">$&#123;y&#125;</span> å¤§äº 100 : è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  x=10, y=20</span></span><br><span class="line"><span class="comment">#  10 != 20 : x ä¸ç­‰äº y</span></span><br><span class="line"><span class="comment">#  10 å°äº 100 ä¸” 20 å¤§äº 15 : è¿”å› true</span></span><br><span class="line"><span class="comment">#  10 å°äº 100 æˆ– 20 å¤§äº 100 : è¿”å› true</span></span><br><span class="line"><span class="comment">#  10 å°äº 5 æˆ– 20 å¤§äº 100 : è¿”å› false</span></span><br></pre></td></tr></table></figure>
<h3 id="64-é€»è¾‘è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#64-é€»è¾‘è¿ç®—ç¬¦"></a> 6.4. é€»è¾‘è¿ç®—ç¬¦</h3>
<p>ä»¥ä¸‹ä»‹ç» Shell çš„é€»è¾‘è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ x ä¸º 10ï¼Œå˜é‡ y ä¸º 20:</p>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>è¯´æ˜</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&amp;&amp;</code></td>
<td>é€»è¾‘çš„ AND</td>
<td><code>[[ ${x} -lt 100 &amp;&amp; ${y} -gt 100 ]]</code> è¿”å› false</td>
</tr>
<tr>
<td><code>||</code></td>
<td>é€»è¾‘çš„ OR</td>
<td><code>[[ ${x} -lt 100 || ${y} -gt 100 ]]</code> è¿”å› true</td>
</tr>
</tbody>
</table>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x=10</span><br><span class="line">y=20</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"x=<span class="variable">$&#123;x&#125;</span>, y=<span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -lt 100 &amp;&amp; <span class="variable">$&#123;y&#125;</span> -gt 100 ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -lt 100 &amp;&amp; <span class="variable">$&#123;y&#125;</span> -gt 100 è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -lt 100 &amp;&amp; <span class="variable">$&#123;y&#125;</span> -gt 100 è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> -lt 100 || <span class="variable">$&#123;y&#125;</span> -gt 100 ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -lt 100 || <span class="variable">$&#123;y&#125;</span> -gt 100 è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> -lt 100 || <span class="variable">$&#123;y&#125;</span> -gt 100 è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  x=10, y=20</span></span><br><span class="line"><span class="comment">#  10 -lt 100 &amp;&amp; 20 -gt 100 è¿”å› false</span></span><br><span class="line"><span class="comment">#  10 -lt 100 || 20 -gt 100 è¿”å› true</span></span><br></pre></td></tr></table></figure>
<h3 id="65-å­—ç¬¦ä¸²è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#65-å­—ç¬¦ä¸²è¿ç®—ç¬¦"></a> 6.5. å­—ç¬¦ä¸²è¿ç®—ç¬¦</h3>
<p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å­—ç¬¦ä¸²è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ a ä¸º â€œabcâ€ï¼Œå˜é‡ b ä¸º â€œefgâ€ï¼š</p>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>è¯´æ˜</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>=</code></td>
<td>æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚</td>
<td><code>[ $a = $b ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td><code>!=</code></td>
<td>æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚</td>
<td><code>[ $a != $b ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td><code>-z</code></td>
<td>æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º 0ï¼Œä¸º 0 è¿”å› trueã€‚</td>
<td><code>[ -z $a ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º 0ï¼Œä¸ä¸º 0 è¿”å› trueã€‚</td>
<td><code>[ -n $a ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td><code>str</code></td>
<td>æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚</td>
<td><code>[ $a ]</code> è¿”å› trueã€‚</td>
</tr>
</tbody>
</table>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x=<span class="string">"abc"</span></span><br><span class="line">y=<span class="string">"xyz"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"x=<span class="variable">$&#123;x&#125;</span>, y=<span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> = <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> = <span class="variable">$&#123;y&#125;</span> : x ç­‰äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> = <span class="variable">$&#123;y&#125;</span>: x ä¸ç­‰äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> != <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> != <span class="variable">$&#123;y&#125;</span> : x ä¸ç­‰äº y"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> != <span class="variable">$&#123;y&#125;</span>: x ç­‰äº y"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ -z <span class="variable">$&#123;x&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"-z <span class="variable">$&#123;x&#125;</span> : å­—ç¬¦ä¸²é•¿åº¦ä¸º 0"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"-z <span class="variable">$&#123;x&#125;</span> : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ -n <span class="string">"<span class="variable">$&#123;x&#125;</span>"</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"-n <span class="variable">$&#123;x&#125;</span> : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"-n <span class="variable">$&#123;x&#125;</span> : å­—ç¬¦ä¸²é•¿åº¦ä¸º 0"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> : å­—ç¬¦ä¸²ä¸ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> : å­—ç¬¦ä¸²ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  x=abc, y=xyz</span></span><br><span class="line"><span class="comment">#  abc = xyz: x ä¸ç­‰äº y</span></span><br><span class="line"><span class="comment">#  abc != xyz : x ä¸ç­‰äº y</span></span><br><span class="line"><span class="comment">#  -z abc : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0</span></span><br><span class="line"><span class="comment">#  -n abc : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0</span></span><br><span class="line"><span class="comment">#  abc : å­—ç¬¦ä¸²ä¸ä¸ºç©º</span></span><br></pre></td></tr></table></figure>
<h3 id="66-æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦"><a class="markdownIt-Anchor" href="#66-æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦"></a> 6.6. æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦</h3>
<p>æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦ç”¨äºæ£€æµ‹ Unix æ–‡ä»¶çš„å„ç§å±æ€§ã€‚</p>
<p>å±æ€§æ£€æµ‹æè¿°å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>æ“ä½œç¬¦</th>
<th>è¯´æ˜</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>-b file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å—è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -b $file ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td>-c file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -c $file ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td>-d file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯ç›®å½•ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -d $file ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td>-f file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆæ—¢ä¸æ˜¯ç›®å½•ï¼Œä¹Ÿä¸æ˜¯è®¾å¤‡æ–‡ä»¶ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -f $file ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td>-g file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SGID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -g $file ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td>-k file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº†ç²˜ç€ä½(Sticky Bit)ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -k $file ]</code>è¿”å› falseã€‚</td>
</tr>
<tr>
<td>-p file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æœ‰åç®¡é“ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -p $file ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td>-u file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SUID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -u $file ]</code> è¿”å› falseã€‚</td>
</tr>
<tr>
<td>-r file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -r $file ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td>-w file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯å†™ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -w $file ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td>-x file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -x $file ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td>-s file</td>
<td>æ£€æµ‹æ–‡ä»¶æ˜¯å¦ä¸ºç©ºï¼ˆæ–‡ä»¶å¤§å°æ˜¯å¦å¤§äº 0ï¼‰ï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚</td>
<td><code>[ -s $file ]</code> è¿”å› trueã€‚</td>
</tr>
<tr>
<td>-e file</td>
<td>æ£€æµ‹æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç›®å½•ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td>
<td><code>[ -e $file ]</code> è¿”å› trueã€‚</td>
</tr>
</tbody>
</table>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file=<span class="string">"/etc/hosts"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ -r <span class="variable">$&#123;file&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶å¯è¯»"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸å¯è¯»"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [[ -w <span class="variable">$&#123;file&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶å¯å†™"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸å¯å†™"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [[ -x <span class="variable">$&#123;file&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶å¯æ‰§è¡Œ"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸å¯æ‰§è¡Œ"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [[ -f <span class="variable">$&#123;file&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸ºæ™®é€šæ–‡ä»¶"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸ºç‰¹æ®Šæ–‡ä»¶"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [[ -d <span class="variable">$&#123;file&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶æ˜¯ä¸ªç›®å½•"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸æ˜¯ä¸ªç›®å½•"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [[ -s <span class="variable">$&#123;file&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [[ -e <span class="variable">$&#123;file&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶å­˜åœ¨"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;file&#125;</span> æ–‡ä»¶ä¸å­˜åœ¨"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Output:(æ ¹æ®æ–‡ä»¶çš„å®é™…æƒ…å†µï¼Œè¾“å‡ºç»“æœå¯èƒ½ä¸åŒ)</span></span><br><span class="line"><span class="comment">#  /etc/hosts æ–‡ä»¶å¯è¯»</span></span><br><span class="line"><span class="comment">#  /etc/hosts æ–‡ä»¶å¯å†™</span></span><br><span class="line"><span class="comment">#  /etc/hosts æ–‡ä»¶ä¸å¯æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">#  /etc/hosts æ–‡ä»¶ä¸ºæ™®é€šæ–‡ä»¶</span></span><br><span class="line"><span class="comment">#  /etc/hosts æ–‡ä»¶ä¸æ˜¯ä¸ªç›®å½•</span></span><br><span class="line"><span class="comment">#  /etc/hosts æ–‡ä»¶ä¸ä¸ºç©º</span></span><br><span class="line"><span class="comment">#  /etc/hosts æ–‡ä»¶å­˜åœ¨</span></span><br></pre></td></tr></table></figure>
<h2 id="7-æ§åˆ¶è¯­å¥"><a class="markdownIt-Anchor" href="#7-æ§åˆ¶è¯­å¥"></a> 7. æ§åˆ¶è¯­å¥</h2>
<h3 id="71-æ¡ä»¶è¯­å¥"><a class="markdownIt-Anchor" href="#71-æ¡ä»¶è¯­å¥"></a> 7.1. æ¡ä»¶è¯­å¥</h3>
<p>è·Ÿå…¶å®ƒç¨‹åºè®¾è®¡è¯­è¨€ä¸€æ ·ï¼ŒBash ä¸­çš„æ¡ä»¶è¯­å¥è®©æˆ‘ä»¬å¯ä»¥å†³å®šä¸€ä¸ªæ“ä½œæ˜¯å¦è¢«æ‰§è¡Œã€‚ç»“æœå–å†³äºä¸€ä¸ªåŒ…åœ¨<code>[[ ]]</code>é‡Œçš„è¡¨è¾¾å¼ã€‚</p>
<p>ç”±<code>[[ ]]</code>ï¼ˆ<code>sh</code>ä¸­æ˜¯<code>[ ]</code>ï¼‰åŒ…èµ·æ¥çš„è¡¨è¾¾å¼è¢«ç§°ä½œ <strong>æ£€æµ‹å‘½ä»¤</strong> æˆ– <strong>åŸºå…ƒ</strong>ã€‚è¿™äº›è¡¨è¾¾å¼å¸®åŠ©æˆ‘ä»¬æ£€æµ‹ä¸€ä¸ªæ¡ä»¶çš„ç»“æœã€‚è¿™é‡Œå¯ä»¥æ‰¾åˆ°æœ‰å…³<a href="http://serverfault.com/a/52050" target="_blank" rel="noopener">bash ä¸­å•åŒä¸­æ‹¬å·åŒºåˆ«</a>çš„ç­”æ¡ˆã€‚</p>
<p>å…±æœ‰ä¸¤ä¸ªä¸åŒçš„æ¡ä»¶è¡¨è¾¾å¼ï¼š<code>if</code>å’Œ<code>case</code>ã€‚</p>
<h4 id="if"><a class="markdownIt-Anchor" href="#if"></a> <code>if</code></h4>
<p>ï¼ˆ1ï¼‰<code>if</code> è¯­å¥</p>
<p><code>if</code>åœ¨ä½¿ç”¨ä¸Šè·Ÿå…¶å®ƒè¯­è¨€ç›¸åŒã€‚å¦‚æœä¸­æ‹¬å·é‡Œçš„è¡¨è¾¾å¼ä¸ºçœŸï¼Œé‚£ä¹ˆ<code>then</code>å’Œ<code>fi</code>ä¹‹é—´çš„ä»£ç ä¼šè¢«æ‰§è¡Œã€‚<code>fi</code>æ ‡å¿—ç€æ¡ä»¶ä»£ç å—çš„ç»“æŸã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å†™æˆä¸€è¡Œ</span></span><br><span class="line"><span class="keyword">if</span> [[ 1 -eq 1 ]]; <span class="keyword">then</span> <span class="built_in">echo</span> <span class="string">"1 -eq 1 result is: true"</span>; <span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output: 1 -eq 1 result is: true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™æˆå¤šè¡Œ</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">"abc"</span> -eq <span class="string">"abc"</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">""</span>abc<span class="string">" -eq "</span>abc<span class="string">" result is: true"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output: abc -eq abc result is: true</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰<code>if else</code> è¯­å¥</p>
<p>åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>if..else</code>è¯­å¥ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ 2 -ne 1 ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output: true</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰<code>if elif else</code> è¯­å¥</p>
<p>æœ‰äº›æ—¶å€™ï¼Œ<code>if..else</code>ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚åˆ«å¿˜äº†<code>if..elif..else</code>ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x=10</span><br><span class="line">y=20</span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$&#123;x&#125;</span> &gt; <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> &gt; <span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"><span class="keyword">elif</span> [[ <span class="variable">$&#123;x&#125;</span> &lt; <span class="variable">$&#123;y&#125;</span> ]]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> &lt; <span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> = <span class="variable">$&#123;y&#125;</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Output: 10 &lt; 20</span></span><br></pre></td></tr></table></figure>
<h4 id="case"><a class="markdownIt-Anchor" href="#case"></a> <code>case</code></h4>
<p>å¦‚æœä½ éœ€è¦é¢å¯¹å¾ˆå¤šæƒ…å†µï¼Œåˆ†åˆ«è¦é‡‡å–ä¸åŒçš„æªæ–½ï¼Œé‚£ä¹ˆä½¿ç”¨<code>case</code>ä¼šæ¯”åµŒå¥—çš„<code>if</code>æ›´æœ‰ç”¨ã€‚ä½¿ç”¨<code>case</code>æ¥è§£å†³å¤æ‚çš„æ¡ä»¶åˆ¤æ–­ï¼Œçœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exec</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$&#123;oper&#125;</span> <span class="keyword">in</span></span><br><span class="line">  <span class="string">"+"</span>)</span><br><span class="line">    val=`expr <span class="variable">$&#123;x&#125;</span> + <span class="variable">$&#123;y&#125;</span>`</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> + <span class="variable">$&#123;y&#125;</span> = <span class="variable">$&#123;val&#125;</span>"</span></span><br><span class="line">  ;;</span><br><span class="line">  <span class="string">"-"</span>)</span><br><span class="line">    val=`expr <span class="variable">$&#123;x&#125;</span> - <span class="variable">$&#123;y&#125;</span>`</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> - <span class="variable">$&#123;y&#125;</span> = <span class="variable">$&#123;val&#125;</span>"</span></span><br><span class="line">  ;;</span><br><span class="line">  <span class="string">"*"</span>)</span><br><span class="line">    val=`expr <span class="variable">$&#123;x&#125;</span> \* <span class="variable">$&#123;y&#125;</span>`</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> * <span class="variable">$&#123;y&#125;</span> = <span class="variable">$&#123;val&#125;</span>"</span></span><br><span class="line">  ;;</span><br><span class="line">  <span class="string">"/"</span>)</span><br><span class="line">    val=`expr <span class="variable">$&#123;x&#125;</span> / <span class="variable">$&#123;y&#125;</span>`</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;x&#125;</span> / <span class="variable">$&#123;y&#125;</span> = <span class="variable">$&#123;val&#125;</span>"</span></span><br><span class="line">  ;;</span><br><span class="line">  *)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Unknown oper!"</span></span><br><span class="line">  ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<p>æ¯ç§æƒ…å†µéƒ½æ˜¯åŒ¹é…äº†æŸä¸ªæ¨¡å¼çš„è¡¨è¾¾å¼ã€‚<code>|</code>ç”¨æ¥åˆ†å‰²å¤šä¸ªæ¨¡å¼ï¼Œ<code>)</code>ç”¨æ¥ç»“æŸä¸€ä¸ªæ¨¡å¼åºåˆ—ã€‚ç¬¬ä¸€ä¸ªåŒ¹é…ä¸Šçš„æ¨¡å¼å¯¹åº”çš„å‘½ä»¤å°†ä¼šè¢«æ‰§è¡Œã€‚<code>*</code>ä»£è¡¨ä»»ä½•ä¸åŒ¹é…ä»¥ä¸Šç»™å®šæ¨¡å¼çš„æ¨¡å¼ã€‚å‘½ä»¤å—å„¿ä¹‹é—´è¦ç”¨<code>;;</code>åˆ†éš”ã€‚</p>
<h3 id="72-å¾ªç¯è¯­å¥"><a class="markdownIt-Anchor" href="#72-å¾ªç¯è¯­å¥"></a> 7.2. å¾ªç¯è¯­å¥</h3>
<p>å¾ªç¯å…¶å®ä¸è¶³ä¸ºå¥‡ã€‚è·Ÿå…¶å®ƒç¨‹åºè®¾è®¡è¯­è¨€ä¸€æ ·ï¼Œbash ä¸­çš„å¾ªç¯ä¹Ÿæ˜¯åªè¦æ§åˆ¶æ¡ä»¶ä¸ºçœŸå°±ä¸€ç›´è¿­ä»£æ‰§è¡Œçš„ä»£ç å—ã€‚</p>
<p>Bash ä¸­æœ‰å››ç§å¾ªç¯ï¼š<code>for</code>ï¼Œ<code>while</code>ï¼Œ<code>until</code>å’Œ<code>select</code>ã€‚</p>
<h4 id="forå¾ªç¯"><a class="markdownIt-Anchor" href="#forå¾ªç¯"></a> <code>for</code>å¾ªç¯</h4>
<p><code>for</code>ä¸å®ƒåœ¨ C è¯­è¨€ä¸­çš„å§Šå¦¹éå¸¸åƒã€‚çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> elem1 elem2 ... elemN</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="comment">### è¯­å¥</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æ¯æ¬¡å¾ªç¯çš„è¿‡ç¨‹ä¸­ï¼Œ<code>arg</code>ä¾æ¬¡è¢«èµ‹å€¼ä¸ºä»<code>elem1</code>åˆ°<code>elemN</code>ã€‚è¿™äº›å€¼è¿˜å¯ä»¥æ˜¯é€šé…ç¬¦æˆ–è€…<a href="https://github.com/denysdovhan/bash-handbook/blob/master/translations/zh-CN/README.md#%E5%A4%A7%E6%8B%AC%E5%8F%B7%E6%89%A9%E5%B1%95" target="_blank" rel="noopener">å¤§æ‹¬å·æ‰©å±•</a>ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠ<code>for</code>å¾ªç¯å†™åœ¨ä¸€è¡Œï¼Œä½†è¿™è¦æ±‚<code>do</code>ä¹‹å‰è¦æœ‰ä¸€ä¸ªåˆ†å·ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ï¼Œå¦‚æœä½ è§‰å¾—<code>for..in..do</code>å¯¹ä½ æ¥è¯´æœ‰ç‚¹å¥‡æ€ªï¼Œé‚£ä¹ˆä½ ä¹Ÿå¯ä»¥åƒ C è¯­è¨€é‚£æ ·ä½¿ç”¨<code>for</code>ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (( i = 0; i &lt; 10; i++ )); <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>å½“æˆ‘ä»¬æƒ³å¯¹ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åšåŒæ ·çš„æ“ä½œæ—¶ï¼Œ<code>for</code>å°±å¾ˆæ–¹ä¾¿äº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æŠŠæ‰€æœ‰çš„<code>.bash</code>æ–‡ä»¶ç§»åŠ¨åˆ°<code>script</code>æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ç»™å®ƒä»¬å¯æ‰§è¡Œæƒé™ï¼Œæˆ‘ä»¬çš„è„šæœ¬å¯ä»¥è¿™æ ·å†™ï¼š</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DIR=/home/zp</span><br><span class="line"><span class="keyword">for</span> FILE <span class="keyword">in</span> <span class="variable">$&#123;DIR&#125;</span>/*.sh; <span class="keyword">do</span></span><br><span class="line">  mv <span class="string">"<span class="variable">$FILE</span>"</span> <span class="string">"<span class="variable">$&#123;DIR&#125;</span>/scripts"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># å°† /home/zp ç›®å½•ä¸‹æ‰€æœ‰ sh æ–‡ä»¶æ‹·è´åˆ° /home/zp/scripts</span></span><br></pre></td></tr></table></figure>
<h4 id="whileå¾ªç¯"><a class="markdownIt-Anchor" href="#whileå¾ªç¯"></a> <code>while</code>å¾ªç¯</h4>
<p><code>while</code>å¾ªç¯æ£€æµ‹ä¸€ä¸ªæ¡ä»¶ï¼Œåªè¦è¿™ä¸ªæ¡ä»¶ä¸º <em>çœŸ</em>ï¼Œå°±æ‰§è¡Œä¸€æ®µå‘½ä»¤ã€‚è¢«æ£€æµ‹çš„æ¡ä»¶è·Ÿ<code>if..then</code>ä¸­ä½¿ç”¨çš„<a href="https://github.com/denysdovhan/bash-handbook/blob/master/translations/zh-CN/README.md#%E5%9F%BA%E5%85%83%E5%92%8C%E7%BB%84%E5%90%88%E8%A1%A8%E8%BE%BE%E5%BC%8F" target="_blank" rel="noopener">åŸºå…ƒ</a>å¹¶æ— äºŒå¼‚ã€‚å› æ­¤ä¸€ä¸ª<code>while</code>å¾ªç¯çœ‹èµ·æ¥ä¼šæ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> [[ condition ]]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="comment">### è¯­å¥</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>è·Ÿ<code>for</code>å¾ªç¯ä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬æŠŠ<code>do</code>å’Œè¢«æ£€æµ‹çš„æ¡ä»¶å†™åˆ°ä¸€è¡Œï¼Œé‚£ä¹ˆå¿…é¡»è¦åœ¨<code>do</code>ä¹‹å‰åŠ ä¸€ä¸ªåˆ†å·ã€‚</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### 0åˆ°9ä¹‹é—´æ¯ä¸ªæ•°çš„å¹³æ–¹</span></span><br><span class="line">x=0</span><br><span class="line"><span class="keyword">while</span> [[ <span class="variable">$&#123;x&#125;</span> -lt 10 ]]; <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> $((x * x))</span><br><span class="line">  x=$((x + 1))</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  0</span></span><br><span class="line"><span class="comment">#  1</span></span><br><span class="line"><span class="comment">#  4</span></span><br><span class="line"><span class="comment">#  9</span></span><br><span class="line"><span class="comment">#  16</span></span><br><span class="line"><span class="comment">#  25</span></span><br><span class="line"><span class="comment">#  36</span></span><br><span class="line"><span class="comment">#  49</span></span><br><span class="line"><span class="comment">#  64</span></span><br><span class="line"><span class="comment">#  81</span></span><br></pre></td></tr></table></figure>
<h4 id="untilå¾ªç¯"><a class="markdownIt-Anchor" href="#untilå¾ªç¯"></a> <code>until</code>å¾ªç¯</h4>
<p><code>until</code>å¾ªç¯è·Ÿ<code>while</code>å¾ªç¯æ­£å¥½ç›¸åã€‚å®ƒè·Ÿ<code>while</code>ä¸€æ ·ä¹Ÿéœ€è¦æ£€æµ‹ä¸€ä¸ªæµ‹è¯•æ¡ä»¶ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œåªè¦è¯¥æ¡ä»¶ä¸º <em>å‡</em> å°±ä¸€ç›´æ‰§è¡Œå¾ªç¯ï¼š</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x=0</span><br><span class="line">until [[ <span class="variable">$&#123;x&#125;</span> -ge 5 ]]; <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$&#123;x&#125;</span></span><br><span class="line">  x=`expr <span class="variable">$&#123;x&#125;</span> + 1`</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  0</span></span><br><span class="line"><span class="comment">#  1</span></span><br><span class="line"><span class="comment">#  2</span></span><br><span class="line"><span class="comment">#  3</span></span><br><span class="line"><span class="comment">#  4</span></span><br></pre></td></tr></table></figure>
<h4 id="selectå¾ªç¯"><a class="markdownIt-Anchor" href="#selectå¾ªç¯"></a> <code>select</code>å¾ªç¯</h4>
<p><code>select</code>å¾ªç¯å¸®åŠ©æˆ‘ä»¬ç»„ç»‡ä¸€ä¸ªç”¨æˆ·èœå•ã€‚å®ƒçš„è¯­æ³•å‡ ä¹è·Ÿ<code>for</code>å¾ªç¯ä¸€è‡´ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">select answer <span class="keyword">in</span> elem1 elem2 ... elemN</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="comment">### è¯­å¥</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p><code>select</code>ä¼šæ‰“å°<code>elem1..elemN</code>ä»¥åŠå®ƒä»¬çš„åºåˆ—å·åˆ°å±å¹•ä¸Šï¼Œä¹‹åä¼šæç¤ºç”¨æˆ·è¾“å…¥ã€‚é€šå¸¸çœ‹åˆ°çš„æ˜¯<code>$?</code>ï¼ˆ<code>PS3</code>å˜é‡ï¼‰ã€‚ç”¨æˆ·çš„é€‰æ‹©ç»“æœä¼šè¢«ä¿å­˜åˆ°<code>answer</code>ä¸­ã€‚å¦‚æœ<code>answer</code>æ˜¯ä¸€ä¸ªåœ¨<code>1..N</code>ä¹‹é—´çš„æ•°å­—ï¼Œé‚£ä¹ˆ<code>è¯­å¥</code>ä¼šè¢«æ‰§è¡Œï¼Œç´§æ¥ç€ä¼šè¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ â€”â€” å¦‚æœä¸æƒ³è¿™æ ·çš„è¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>break</code>è¯­å¥ã€‚</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line">PS3=<span class="string">"Choose the package manager: "</span></span><br><span class="line">select ITEM <span class="keyword">in</span> bower npm gem pip</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">"Enter the package name: "</span> &amp;&amp; <span class="built_in">read</span> PACKAGE</span><br><span class="line"><span class="keyword">case</span> <span class="variable">$&#123;ITEM&#125;</span> <span class="keyword">in</span></span><br><span class="line">  bower) bower install <span class="variable">$&#123;PACKAGE&#125;</span> ;;</span><br><span class="line">  npm) npm install <span class="variable">$&#123;PACKAGE&#125;</span> ;;</span><br><span class="line">  gem) gem install <span class="variable">$&#123;PACKAGE&#125;</span> ;;</span><br><span class="line">  pip) pip install <span class="variable">$&#123;PACKAGE&#125;</span> ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">break</span> <span class="comment"># é¿å…æ— é™å¾ªç¯</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ï¼Œå…ˆè¯¢é—®ç”¨æˆ·ä»–æƒ³ä½¿ç”¨ä»€ä¹ˆåŒ…ç®¡ç†å™¨ã€‚æ¥ç€ï¼Œåˆè¯¢é—®äº†æƒ³å®‰è£…ä»€ä¹ˆåŒ…ï¼Œæœ€åæ‰§è¡Œå®‰è£…æ“ä½œã€‚</p>
<p>è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./my_script</span><br><span class="line">1) bower</span><br><span class="line">2) npm</span><br><span class="line">3) gem</span><br><span class="line">4) pip</span><br><span class="line">Choose the package manager: 2</span><br><span class="line">Enter the package name: gitbook-cli</span><br></pre></td></tr></table></figure>
<h4 id="break-å’Œ-continue"><a class="markdownIt-Anchor" href="#break-å’Œ-continue"></a> <code>break</code> å’Œ <code>continue</code></h4>
<p>å¦‚æœæƒ³æå‰ç»“æŸä¸€ä¸ªå¾ªç¯æˆ–è·³è¿‡æŸæ¬¡å¾ªç¯æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ shell çš„<code>break</code>å’Œ<code>continue</code>è¯­å¥æ¥å®ç°ã€‚å®ƒä»¬å¯ä»¥åœ¨ä»»ä½•å¾ªç¯ä¸­ä½¿ç”¨ã€‚</p>
<blockquote>
<p><code>break</code>è¯­å¥ç”¨æ¥æå‰ç»“æŸå½“å‰å¾ªç¯ã€‚</p>
<p><code>continue</code>è¯­å¥ç”¨æ¥è·³è¿‡æŸæ¬¡è¿­ä»£ã€‚</p>
</blockquote>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾ 10 ä»¥å†…ç¬¬ä¸€ä¸ªèƒ½æ•´é™¤ 2 å’Œ 3 çš„æ­£æ•´æ•°</span></span><br><span class="line">i=1</span><br><span class="line"><span class="keyword">while</span> [[ <span class="variable">$&#123;i&#125;</span> -lt 10 ]]; <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">if</span> [[ $((i % 3)) -eq 0 ]] &amp;&amp; [[ $((i % 2)) -eq 0 ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$&#123;i&#125;</span></span><br><span class="line">    <span class="built_in">break</span>;</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  i=`expr <span class="variable">$&#123;i&#125;</span> + 1`</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># Output: 6</span></span><br></pre></td></tr></table></figure>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰“å°10ä»¥å†…çš„å¥‡æ•°</span></span><br><span class="line"><span class="keyword">for</span> (( i = 0; i &lt; 10; i ++ )); <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">if</span> [[ $((i % 2)) -eq 0 ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">continue</span>;</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$&#123;i&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  1</span></span><br><span class="line"><span class="comment">#  3</span></span><br><span class="line"><span class="comment">#  5</span></span><br><span class="line"><span class="comment">#  7</span></span><br><span class="line"><span class="comment">#  9</span></span><br></pre></td></tr></table></figure>
<h2 id="8-å‡½æ•°"><a class="markdownIt-Anchor" href="#8-å‡½æ•°"></a> 8. å‡½æ•°</h2>
<p>bash å‡½æ•°å®šä¹‰è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[ <span class="keyword">function</span> ] funname [()] &#123;</span><br><span class="line">    action;</span><br><span class="line">    [<span class="built_in">return</span> int;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ğŸ’¡ è¯´æ˜ï¼š</p>
<ol>
<li>å‡½æ•°å®šä¹‰æ—¶ï¼Œ<code>function</code> å…³é”®å­—å¯æœ‰å¯æ— ã€‚</li>
<li>å‡½æ•°è¿”å›å€¼ - return è¿”å›å‡½æ•°è¿”å›å€¼ï¼Œè¿”å›å€¼ç±»å‹åªèƒ½ä¸ºæ•´æ•°ï¼ˆ0-255ï¼‰ã€‚å¦‚æœä¸åŠ  return è¯­å¥ï¼Œshell é»˜è®¤å°†ä»¥æœ€åä¸€æ¡å‘½ä»¤çš„è¿è¡Œç»“æœï¼Œä½œä¸ºå‡½æ•°è¿”å›å€¼ã€‚</li>
<li>å‡½æ•°è¿”å›å€¼åœ¨è°ƒç”¨è¯¥å‡½æ•°åé€šè¿‡ <code>$?</code> æ¥è·å¾—ã€‚</li>
<li>æ‰€æœ‰å‡½æ•°åœ¨ä½¿ç”¨å‰å¿…é¡»å®šä¹‰ã€‚è¿™æ„å‘³ç€å¿…é¡»å°†å‡½æ•°æ”¾åœ¨è„šæœ¬å¼€å§‹éƒ¨åˆ†ï¼Œç›´è‡³ shell è§£é‡Šå™¨é¦–æ¬¡å‘ç°å®ƒæ—¶ï¼Œæ‰å¯ä»¥ä½¿ç”¨ã€‚è°ƒç”¨å‡½æ•°ä»…ä½¿ç”¨å…¶å‡½æ•°åå³å¯ã€‚</li>
</ol>
</blockquote>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">calc</span></span>()&#123;</span><br><span class="line">  PS3=<span class="string">"choose the oper: "</span></span><br><span class="line">  select oper <span class="keyword">in</span> + - \* / <span class="comment"># ç”Ÿæˆæ“ä½œç¬¦é€‰æ‹©èœå•</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> -n <span class="string">"enter first num: "</span> &amp;&amp; <span class="built_in">read</span> x <span class="comment"># è¯»å–è¾“å…¥å‚æ•°</span></span><br><span class="line">  <span class="built_in">echo</span> -n <span class="string">"enter second num: "</span> &amp;&amp; <span class="built_in">read</span> y <span class="comment"># è¯»å–è¾“å…¥å‚æ•°</span></span><br><span class="line">  <span class="built_in">exec</span></span><br><span class="line">  <span class="keyword">case</span> <span class="variable">$&#123;oper&#125;</span> <span class="keyword">in</span></span><br><span class="line">    <span class="string">"+"</span>)</span><br><span class="line">      <span class="built_in">return</span> $((<span class="variable">$&#123;x&#125;</span> + <span class="variable">$&#123;y&#125;</span>))</span><br><span class="line">    ;;</span><br><span class="line">    <span class="string">"-"</span>)</span><br><span class="line">      <span class="built_in">return</span> $((<span class="variable">$&#123;x&#125;</span> - <span class="variable">$&#123;y&#125;</span>))</span><br><span class="line">    ;;</span><br><span class="line">    <span class="string">"*"</span>)</span><br><span class="line">      <span class="built_in">return</span> $((<span class="variable">$&#123;x&#125;</span> * <span class="variable">$&#123;y&#125;</span>))</span><br><span class="line">    ;;</span><br><span class="line">    <span class="string">"/"</span>)</span><br><span class="line">      <span class="built_in">return</span> $((<span class="variable">$&#123;x&#125;</span> / <span class="variable">$&#123;y&#125;</span>))</span><br><span class="line">    ;;</span><br><span class="line">    *)</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;oper&#125;</span> is not support!"</span></span><br><span class="line">      <span class="built_in">return</span> 0</span><br><span class="line">    ;;</span><br><span class="line">  <span class="keyword">esac</span></span><br><span class="line">  <span class="built_in">break</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line">calc</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"the result is: $?"</span> <span class="comment"># $? è·å– calc å‡½æ•°è¿”å›å€¼</span></span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œç»“æœï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./<span class="keyword">function</span>-demo.sh</span><br><span class="line">1) +</span><br><span class="line">2) -</span><br><span class="line">3) *</span><br><span class="line">4) /</span><br><span class="line">choose the oper: 3</span><br><span class="line">enter first num: 10</span><br><span class="line">enter second num: 10</span><br><span class="line">the result is: 100</span><br></pre></td></tr></table></figure>
<h3 id="81-ä½ç½®å‚æ•°"><a class="markdownIt-Anchor" href="#81-ä½ç½®å‚æ•°"></a> 8.1. ä½ç½®å‚æ•°</h3>
<p><strong>ä½ç½®å‚æ•°</strong>æ˜¯åœ¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°å¹¶ä¼ ç»™å®ƒå‚æ•°æ—¶åˆ›å»ºçš„å˜é‡ã€‚</p>
<p>ä½ç½®å‚æ•°å˜é‡è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>å˜é‡</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$0</code></td>
<td>è„šæœ¬åç§°</td>
</tr>
<tr>
<td><code>$1 â€¦ $9</code></td>
<td>ç¬¬ 1 ä¸ªåˆ°ç¬¬ 9 ä¸ªå‚æ•°åˆ—è¡¨</td>
</tr>
<tr>
<td><code>${10} â€¦ ${N}</code></td>
<td>ç¬¬ 10 ä¸ªåˆ° N ä¸ªå‚æ•°åˆ—è¡¨</td>
</tr>
<tr>
<td><code>$*</code> or <code>$@</code></td>
<td>é™¤äº†<code>$0</code>å¤–çš„æ‰€æœ‰ä½ç½®å‚æ•°</td>
</tr>
<tr>
<td><code>$#</code></td>
<td>ä¸åŒ…æ‹¬<code>$0</code>åœ¨å†…çš„ä½ç½®å‚æ•°çš„ä¸ªæ•°</td>
</tr>
<tr>
<td><code>$FUNCNAME</code></td>
<td>å‡½æ•°åç§°ï¼ˆä»…åœ¨å‡½æ•°å†…éƒ¨æœ‰å€¼ï¼‰</td>
</tr>
</tbody>
</table>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line">x=0</span><br><span class="line"><span class="keyword">if</span> [[ -n <span class="variable">$1</span> ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š<span class="variable">$1</span>"</span></span><br><span class="line">  x=<span class="variable">$1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">y=0</span><br><span class="line"><span class="keyword">if</span> [[ -n <span class="variable">$2</span> ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š<span class="variable">$2</span>"</span></span><br><span class="line">  y=<span class="variable">$2</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"ç¬¬äºŒä¸ªå‚æ•°ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">paramsFunction</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š<span class="variable">$1</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼š<span class="variable">$2</span>"</span></span><br><span class="line">&#125;</span><br><span class="line">paramsFunction <span class="variable">$&#123;x&#125;</span> <span class="variable">$&#123;y&#125;</span></span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œç»“æœï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./<span class="keyword">function</span>-demo2.sh</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç©º</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ä¸ºç©º</span><br><span class="line">å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š0</span><br><span class="line">å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼š0</span><br><span class="line"></span><br><span class="line">$ ./<span class="keyword">function</span>-demo2.sh 10 20</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š10</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š20</span><br><span class="line">å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š10</span><br><span class="line">å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼š20</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œ <code>./variable-demo4.sh hello world</code> ï¼Œç„¶ååœ¨è„šæœ¬ä¸­é€šè¿‡ <code>$1</code>ã€<code>$2</code> â€¦ è¯»å–ç¬¬ 1 ä¸ªå‚æ•°ã€ç¬¬ 2 ä¸ªå‚æ•°ã€‚ã€‚ã€‚</p>
<h3 id="82-å‡½æ•°å¤„ç†å‚æ•°"><a class="markdownIt-Anchor" href="#82-å‡½æ•°å¤„ç†å‚æ•°"></a> 8.2. å‡½æ•°å¤„ç†å‚æ•°</h3>
<p>å¦å¤–ï¼Œè¿˜æœ‰å‡ ä¸ªç‰¹æ®Šå­—ç¬¦ç”¨æ¥å¤„ç†å‚æ•°ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°å¤„ç†</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$#</code></td>
<td>è¿”å›å‚æ•°ä¸ªæ•°</td>
</tr>
<tr>
<td><code>$*</code></td>
<td>è¿”å›æ‰€æœ‰å‚æ•°</td>
</tr>
<tr>
<td><code>$$</code></td>
<td>è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹ ID å·</td>
</tr>
<tr>
<td><code>$!</code></td>
<td>åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„ ID å·</td>
</tr>
<tr>
<td><code>$@</code></td>
<td>è¿”å›æ‰€æœ‰å‚æ•°</td>
</tr>
<tr>
<td><code>$-</code></td>
<td>è¿”å› Shell ä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼Œä¸ set å‘½ä»¤åŠŸèƒ½ç›¸åŒã€‚</td>
</tr>
<tr>
<td><code>$?</code></td>
<td>å‡½æ•°è¿”å›å€¼</td>
</tr>
</tbody>
</table>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">runner</span></span>() &#123;</span><br><span class="line">  <span class="built_in">return</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">name=zp</span><br><span class="line"><span class="function"><span class="title">paramsFunction</span></span>()&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š<span class="variable">$1</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼š<span class="variable">$2</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°ä¸ªæ•°ï¼š<span class="variable">$#</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"æ‰€æœ‰å‚æ•°ï¼š"</span></span><br><span class="line">  <span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="string">"$*"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹ ID å·ï¼š$$"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„ ID å·ï¼š$!"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"æ‰€æœ‰å‚æ•°ï¼š"</span></span><br><span class="line">  <span class="built_in">printf</span> <span class="string">"+ %s\n"</span> <span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Shell ä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼š$-"</span></span><br><span class="line">  runner</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"runner å‡½æ•°çš„è¿”å›å€¼ï¼š$?"</span></span><br><span class="line">&#125;</span><br><span class="line">paramsFunction 1 <span class="string">"abc"</span> <span class="string">"hello, \"zp\""</span></span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š1</span></span><br><span class="line"><span class="comment">#  å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼šabc</span></span><br><span class="line"><span class="comment">#  ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°ä¸ªæ•°ï¼š3</span></span><br><span class="line"><span class="comment">#  æ‰€æœ‰å‚æ•°ï¼š</span></span><br><span class="line"><span class="comment">#  + 1 abc hello, "zp"</span></span><br><span class="line"><span class="comment">#  è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹ ID å·ï¼š26400</span></span><br><span class="line"><span class="comment">#  åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„ ID å·ï¼š</span></span><br><span class="line"><span class="comment">#  æ‰€æœ‰å‚æ•°ï¼š</span></span><br><span class="line"><span class="comment">#  + 1</span></span><br><span class="line"><span class="comment">#  + abc</span></span><br><span class="line"><span class="comment">#  + hello, "zp"</span></span><br><span class="line"><span class="comment">#  Shell ä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼šhB</span></span><br><span class="line"><span class="comment">#  runner å‡½æ•°çš„è¿”å›å€¼ï¼š0</span></span><br></pre></td></tr></table></figure>
<h2 id="9-shell-æ‰©å±•"><a class="markdownIt-Anchor" href="#9-shell-æ‰©å±•"></a> 9. Shell æ‰©å±•</h2>
<p><em>æ‰©å±•</em> å‘ç”Ÿåœ¨ä¸€è¡Œå‘½ä»¤è¢«åˆ†æˆä¸€ä¸ªä¸ªçš„ <em>è®°å·ï¼ˆtokensï¼‰</em> ä¹‹åã€‚æ¢è¨€ä¹‹ï¼Œæ‰©å±•æ˜¯ä¸€ç§æ‰§è¡Œæ•°å­¦è¿ç®—çš„æœºåˆ¶ï¼Œè¿˜å¯ä»¥ç”¨æ¥ä¿å­˜å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œç­‰ç­‰ã€‚</p>
<p>æ„Ÿå…´è¶£çš„è¯å¯ä»¥é˜…è¯»<a href="https://www.gnu.org/software/bash/manual/bash.html###Shell-Expansions" target="_blank" rel="noopener">å…³äº shell æ‰©å±•çš„æ›´å¤šç»†èŠ‚</a>ã€‚</p>
<h4 id="å¤§æ‹¬å·æ‰©å±•"><a class="markdownIt-Anchor" href="#å¤§æ‹¬å·æ‰©å±•"></a> å¤§æ‹¬å·æ‰©å±•</h4>
<p>å¤§æ‹¬å·æ‰©å±•è®©ç”Ÿæˆä»»æ„çš„å­—ç¬¦ä¸²æˆä¸ºå¯èƒ½ã€‚å®ƒè·Ÿ <em>æ–‡ä»¶åæ‰©å±•</em> å¾ˆç±»ä¼¼ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> beg&#123;i,a,u&#125;n <span class="comment">### begin began begun</span></span><br></pre></td></tr></table></figure>
<p>å¤§æ‹¬å·æ‰©å±•è¿˜å¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ªå¯è¢«å¾ªç¯è¿­ä»£çš„åŒºé—´ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> &#123;0..5&#125; <span class="comment">### 0 1 2 3 4 5</span></span><br><span class="line"><span class="built_in">echo</span> &#123;00..8..2&#125; <span class="comment">### 00 02 04 06 08</span></span><br></pre></td></tr></table></figure>
<h4 id="å‘½ä»¤ç½®æ¢"><a class="markdownIt-Anchor" href="#å‘½ä»¤ç½®æ¢"></a> å‘½ä»¤ç½®æ¢</h4>
<p>å‘½ä»¤ç½®æ¢å…è®¸æˆ‘ä»¬å¯¹ä¸€ä¸ªå‘½ä»¤æ±‚å€¼ï¼Œå¹¶å°†å…¶å€¼ç½®æ¢åˆ°å¦ä¸€ä¸ªå‘½ä»¤æˆ–è€…å˜é‡èµ‹å€¼è¡¨è¾¾å¼ä¸­ã€‚å½“ä¸€ä¸ªå‘½ä»¤è¢«``æˆ–<code>$()</code>åŒ…å›´æ—¶ï¼Œå‘½ä»¤ç½®æ¢å°†ä¼šæ‰§è¡Œã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">now=`date +%T`</span><br><span class="line"><span class="comment">### or</span></span><br><span class="line">now=$(date +%T)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$now</span> <span class="comment">### 19:08:26</span></span><br></pre></td></tr></table></figure>
<h4 id="ç®—æ•°æ‰©å±•"><a class="markdownIt-Anchor" href="#ç®—æ•°æ‰©å±•"></a> ç®—æ•°æ‰©å±•</h4>
<p>åœ¨ bash ä¸­ï¼Œæ‰§è¡Œç®—æ•°è¿ç®—æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚ç®—æ•°è¡¨è¾¾å¼å¿…é¡»åŒ…åœ¨<code>$(( ))</code>ä¸­ã€‚ç®—æ•°æ‰©å±•çš„æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">result=$(( ((10 + 5*3) - 7) / 2 ))</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$result</span> <span class="comment">### 9</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ç®—æ•°è¡¨è¾¾å¼ä¸­ï¼Œä½¿ç”¨å˜é‡æ— éœ€å¸¦ä¸Š<code>$</code>å‰ç¼€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x=4</span><br><span class="line">y=7</span><br><span class="line"><span class="built_in">echo</span> $(( x + y ))     <span class="comment">### 11</span></span><br><span class="line"><span class="built_in">echo</span> $(( ++x + y++ )) <span class="comment">### 12</span></span><br><span class="line"><span class="built_in">echo</span> $(( x + y ))     <span class="comment">### 13</span></span><br></pre></td></tr></table></figure>
<h4 id="å•å¼•å·å’ŒåŒå¼•å·"><a class="markdownIt-Anchor" href="#å•å¼•å·å’ŒåŒå¼•å·"></a> å•å¼•å·å’ŒåŒå¼•å·</h4>
<p>å•å¼•å·å’ŒåŒå¼•å·ä¹‹é—´æœ‰å¾ˆé‡è¦çš„åŒºåˆ«ã€‚åœ¨åŒå¼•å·ä¸­ï¼Œå˜é‡å¼•ç”¨æˆ–è€…å‘½ä»¤ç½®æ¢æ˜¯ä¼šè¢«å±•å¼€çš„ã€‚åœ¨å•å¼•å·ä¸­æ˜¯ä¸ä¼šçš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"Your home: <span class="variable">$HOME</span>"</span> <span class="comment">### Your home: /Users/&lt;username&gt;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'Your home: $HOME'</span> <span class="comment">### Your home: $HOME</span></span><br></pre></td></tr></table></figure>
<p>å½“å±€éƒ¨å˜é‡å’Œç¯å¢ƒå˜é‡åŒ…å«ç©ºæ ¼æ—¶ï¼Œå®ƒä»¬åœ¨å¼•å·ä¸­çš„æ‰©å±•è¦æ ¼å¤–æ³¨æ„ã€‚éšä¾¿ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚æˆ‘ä»¬ç”¨<code>echo</code>æ¥è¾“å‡ºç”¨æˆ·çš„è¾“å…¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">INPUT=<span class="string">"A string  with   strange    whitespace."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$INPUT</span>   <span class="comment">### A string with strange whitespace.</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$INPUT</span>"</span> <span class="comment">### A string  with   strange    whitespace.</span></span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨ç¬¬ä¸€ä¸ª<code>echo</code>æ—¶ç»™äº†å®ƒ 5 ä¸ªå•ç‹¬çš„å‚æ•° â€”â€” <code>$INPUT</code> è¢«åˆ†æˆäº†å•ç‹¬çš„è¯ï¼Œ<code>echo</code>åœ¨æ¯ä¸ªè¯ä¹‹é—´æ‰“å°äº†ä¸€ä¸ªç©ºæ ¼ã€‚ç¬¬äºŒç§æƒ…å†µï¼Œè°ƒç”¨<code>echo</code>æ—¶åªç»™äº†å®ƒä¸€ä¸ªå‚æ•°ï¼ˆæ•´ä¸ª$INPUT çš„å€¼ï¼ŒåŒ…æ‹¬å…¶ä¸­çš„ç©ºæ ¼ï¼‰ã€‚</p>
<p>æ¥çœ‹ä¸€ä¸ªæ›´ä¸¥è‚ƒçš„ä¾‹å­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">FILE=<span class="string">"Favorite Things.txt"</span></span><br><span class="line">cat <span class="variable">$FILE</span>   <span class="comment">### å°è¯•è¾“å‡ºä¸¤ä¸ªæ–‡ä»¶: `Favorite` å’Œ `Things.txt`</span></span><br><span class="line">cat <span class="string">"<span class="variable">$FILE</span>"</span> <span class="comment">### è¾“å‡ºä¸€ä¸ªæ–‡ä»¶: `Favorite Things.txt`</span></span><br></pre></td></tr></table></figure>
<p>å°½ç®¡è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡æŠŠ FILE é‡å‘½åæˆ<code>Favorite-Things.txt</code>æ¥è§£å†³ï¼Œä½†æ˜¯ï¼Œå‡å¦‚è¿™ä¸ªå€¼æ¥è‡ªæŸä¸ªç¯å¢ƒå˜é‡ï¼Œæ¥è‡ªä¸€ä¸ªä½ç½®å‚æ•°ï¼Œæˆ–è€…æ¥è‡ªå…¶å®ƒå‘½ä»¤ï¼ˆ<code>find</code>, <code>cat</code>, ç­‰ç­‰ï¼‰å‘¢ã€‚å› æ­¤ï¼Œå¦‚æœè¾“å…¥ <em>å¯èƒ½</em> åŒ…å«ç©ºæ ¼ï¼ŒåŠ¡å¿…è¦ç”¨å¼•å·æŠŠè¡¨è¾¾å¼åŒ…èµ·æ¥ã€‚</p>
<h2 id="10-æµå’Œé‡å®šå‘"><a class="markdownIt-Anchor" href="#10-æµå’Œé‡å®šå‘"></a> 10. æµå’Œé‡å®šå‘</h2>
<p>Bash æœ‰å¾ˆå¼ºå¤§çš„å·¥å…·æ¥å¤„ç†ç¨‹åºä¹‹é—´çš„ååŒå·¥ä½œã€‚ä½¿ç”¨æµï¼Œæˆ‘ä»¬èƒ½å°†ä¸€ä¸ªç¨‹åºçš„è¾“å‡ºå‘é€åˆ°å¦ä¸€ä¸ªç¨‹åºæˆ–æ–‡ä»¶ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬èƒ½æ–¹ä¾¿åœ°è®°å½•æ—¥å¿—æˆ–åšä¸€äº›å…¶å®ƒæˆ‘ä»¬æƒ³åšçš„äº‹ã€‚</p>
<p>ç®¡é“ç»™äº†æˆ‘ä»¬åˆ›å»ºä¼ é€å¸¦çš„æœºä¼šï¼Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæˆä¸ºå¯èƒ½ã€‚</p>
<p>å­¦ä¹ å¦‚ä½•ä½¿ç”¨è¿™äº›å¼ºå¤§çš„ã€é«˜çº§çš„å·¥å…·æ˜¯éå¸¸éå¸¸é‡è¦çš„ã€‚</p>
<h3 id="101-è¾“å…¥-è¾“å‡ºæµ"><a class="markdownIt-Anchor" href="#101-è¾“å…¥-è¾“å‡ºæµ"></a> 10.1. è¾“å…¥ã€è¾“å‡ºæµ</h3>
<p>Bash æ¥æ”¶è¾“å…¥ï¼Œå¹¶ä»¥å­—ç¬¦åºåˆ—æˆ– <strong>å­—ç¬¦æµ</strong> çš„å½¢å¼äº§ç”Ÿè¾“å‡ºã€‚è¿™äº›æµèƒ½è¢«é‡å®šå‘åˆ°æ–‡ä»¶æˆ–å¦ä¸€ä¸ªæµä¸­ã€‚</p>
<p>æœ‰ä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼š</p>
<table>
<thead>
<tr>
<th>ä»£ç </th>
<th>æè¿°ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td><code>stdin</code></td>
<td>æ ‡å‡†è¾“å…¥</td>
</tr>
<tr>
<td><code>1</code></td>
<td><code>stdout</code></td>
<td>æ ‡å‡†è¾“å‡º</td>
</tr>
<tr>
<td><code>2</code></td>
<td><code>stderr</code></td>
<td>æ ‡å‡†é”™è¯¯è¾“å‡º</td>
</tr>
</tbody>
</table>
<h3 id="102-é‡å®šå‘"><a class="markdownIt-Anchor" href="#102-é‡å®šå‘"></a> 10.2. é‡å®šå‘</h3>
<p>é‡å®šå‘è®©æˆ‘ä»¬å¯ä»¥æ§åˆ¶ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥æ¥è‡ªå“ªé‡Œï¼Œè¾“å‡ºç»“æœåˆ°ä»€ä¹ˆåœ°æ–¹ã€‚è¿™äº›è¿ç®—ç¬¦åœ¨æ§åˆ¶æµçš„é‡å®šå‘æ—¶ä¼šè¢«ç”¨åˆ°ï¼š</p>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&gt;</code></td>
<td>é‡å®šå‘è¾“å‡º</td>
</tr>
<tr>
<td><code>&amp;&gt;</code></td>
<td>é‡å®šå‘è¾“å‡ºå’Œé”™è¯¯è¾“å‡º</td>
</tr>
<tr>
<td><code>&amp;&gt;&gt;</code></td>
<td>ä»¥é™„åŠ çš„å½¢å¼é‡å®šå‘è¾“å‡ºå’Œé”™è¯¯è¾“å‡º</td>
</tr>
<tr>
<td><code>&lt;</code></td>
<td>é‡å®šå‘è¾“å…¥</td>
</tr>
<tr>
<td><code>&lt;&lt;</code></td>
<td><a href="http://tldp.org/LDP/abs/html/here-docs.html" target="_blank" rel="noopener">Here æ–‡æ¡£</a> è¯­æ³•</td>
</tr>
<tr>
<td><code>&lt;&lt;&lt;</code></td>
<td><a href="http://www.tldp.org/LDP/abs/html/x17837.html" target="_blank" rel="noopener">Here å­—ç¬¦ä¸²</a></td>
</tr>
</tbody>
</table>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›ä½¿ç”¨é‡å®šå‘çš„ä¾‹å­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">### lsçš„ç»“æœå°†ä¼šè¢«å†™åˆ°list.txtä¸­</span></span><br><span class="line">ls -l &gt; list.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">### å°†è¾“å‡ºé™„åŠ åˆ°list.txtä¸­</span></span><br><span class="line">ls -a &gt;&gt; list.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">### æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ä¼šè¢«å†™åˆ°errors.txtä¸­</span></span><br><span class="line">grep da * 2&gt; errors.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">### ä»errors.txtä¸­è¯»å–è¾“å…¥</span></span><br><span class="line">less &lt; errors.txt</span><br></pre></td></tr></table></figure>
<h3 id="103-devnull-æ–‡ä»¶"><a class="markdownIt-Anchor" href="#103-devnull-æ–‡ä»¶"></a> 10.3. <code>/dev/null</code> æ–‡ä»¶</h3>
<p>å¦‚æœå¸Œæœ›æ‰§è¡ŒæŸä¸ªå‘½ä»¤ï¼Œä½†åˆä¸å¸Œæœ›åœ¨å±å¹•ä¸Šæ˜¾ç¤ºè¾“å‡ºç»“æœï¼Œé‚£ä¹ˆå¯ä»¥å°†è¾“å‡ºé‡å®šå‘åˆ° /dev/nullï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">command</span> &gt; /dev/null</span><br></pre></td></tr></table></figure>
<p>/dev/null æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå†™å…¥åˆ°å®ƒçš„å†…å®¹éƒ½ä¼šè¢«ä¸¢å¼ƒï¼›å¦‚æœå°è¯•ä»è¯¥æ–‡ä»¶è¯»å–å†…å®¹ï¼Œé‚£ä¹ˆä»€ä¹ˆä¹Ÿè¯»ä¸åˆ°ã€‚ä½†æ˜¯ /dev/null æ–‡ä»¶éå¸¸æœ‰ç”¨ï¼Œå°†å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°å®ƒï¼Œä¼šèµ·åˆ°&quot;ç¦æ­¢è¾“å‡º&quot;çš„æ•ˆæœã€‚</p>
<p>å¦‚æœå¸Œæœ›å±è”½ stdout å’Œ stderrï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">command</span> &gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
<h2 id="11-debug"><a class="markdownIt-Anchor" href="#11-debug"></a> 11. Debug</h2>
<p>shell æä¾›äº†ç”¨äº debug è„šæœ¬çš„å·¥å…·ã€‚</p>
<p>å¦‚æœæƒ³é‡‡ç”¨ debug æ¨¡å¼è¿è¡ŒæŸè„šæœ¬ï¼Œå¯ä»¥åœ¨å…¶ shebang ä¸­ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„é€‰é¡¹ï¼š</p>
<figure class="highlight d"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash options</span></span><br></pre></td></tr></table></figure>
<p>options æ˜¯ä¸€äº›å¯ä»¥æ”¹å˜ shell è¡Œä¸ºçš„é€‰é¡¹ã€‚ä¸‹è¡¨æ˜¯ä¸€äº›å¯èƒ½å¯¹ä½ æœ‰ç”¨çš„é€‰é¡¹ï¼š</p>
<table>
<thead>
<tr>
<th>Short</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-f</code></td>
<td>noglob</td>
<td>ç¦æ­¢æ–‡ä»¶åå±•å¼€ï¼ˆglobbingï¼‰</td>
</tr>
<tr>
<td><code>-i</code></td>
<td>interactive</td>
<td>è®©è„šæœ¬ä»¥ <em>äº¤äº’</em> æ¨¡å¼è¿è¡Œ</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>noexec</td>
<td>è¯»å–å‘½ä»¤ï¼Œä½†ä¸æ‰§è¡Œï¼ˆè¯­æ³•æ£€æŸ¥ï¼‰</td>
</tr>
<tr>
<td><code>-t</code></td>
<td>â€”</td>
<td>æ‰§è¡Œå®Œç¬¬ä¸€æ¡å‘½ä»¤åé€€å‡º</td>
</tr>
<tr>
<td><code>-v</code></td>
<td>verbose</td>
<td>åœ¨æ‰§è¡Œæ¯æ¡å‘½ä»¤å‰ï¼Œå‘<code>stderr</code>è¾“å‡ºè¯¥å‘½ä»¤</td>
</tr>
<tr>
<td><code>-x</code></td>
<td>xtrace</td>
<td>åœ¨æ‰§è¡Œæ¯æ¡å‘½ä»¤å‰ï¼Œå‘<code>stderr</code>è¾“å‡ºè¯¥å‘½ä»¤ä»¥åŠè¯¥å‘½ä»¤çš„æ‰©å±•å‚æ•°</td>
</tr>
</tbody>
</table>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è„šæœ¬ä¸­æŒ‡å®šäº†<code>-x</code>ä¾‹å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash -x</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (( i = 0; i &lt; 3; i++ )); <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¼šå‘<code>stdout</code>æ‰“å°å‡ºå˜é‡çš„å€¼å’Œä¸€äº›å…¶å®ƒæœ‰ç”¨çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./my_script</span><br><span class="line">+ (( i = 0 ))</span><br><span class="line">+ (( i &lt; 3 ))</span><br><span class="line">+ <span class="built_in">echo</span> 0</span><br><span class="line">0</span><br><span class="line">+ (( i++  ))</span><br><span class="line">+ (( i &lt; 3 ))</span><br><span class="line">+ <span class="built_in">echo</span> 1</span><br><span class="line">1</span><br><span class="line">+ (( i++  ))</span><br><span class="line">+ (( i &lt; 3 ))</span><br><span class="line">+ <span class="built_in">echo</span> 2</span><br><span class="line">2</span><br><span class="line">+ (( i++  ))</span><br><span class="line">+ (( i &lt; 3 ))</span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶æˆ‘ä»¬å€¼éœ€è¦ debug è„šæœ¬çš„ä¸€éƒ¨åˆ†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨<code>set</code>å‘½ä»¤ä¼šå¾ˆæ–¹ä¾¿ã€‚è¿™ä¸ªå‘½ä»¤å¯ä»¥å¯ç”¨æˆ–ç¦ç”¨é€‰é¡¹ã€‚ä½¿ç”¨<code>-</code>å¯ç”¨é€‰é¡¹ï¼Œ<code>+</code>ç¦ç”¨é€‰é¡¹ï¼š</p>
<p><strong>âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¼€å¯ debug</span></span><br><span class="line"><span class="built_in">set</span> -x</span><br><span class="line"><span class="keyword">for</span> (( i = 0; i &lt; 3; i++ )); <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">printf</span> <span class="variable">$&#123;i&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># å…³é—­ debug</span></span><br><span class="line"><span class="built_in">set</span> +x</span><br><span class="line"><span class="comment">#  Output:</span></span><br><span class="line"><span class="comment">#  + (( i = 0 ))</span></span><br><span class="line"><span class="comment">#  + (( i &lt; 3 ))</span></span><br><span class="line"><span class="comment">#  + printf 0</span></span><br><span class="line"><span class="comment">#  0+ (( i++  ))</span></span><br><span class="line"><span class="comment">#  + (( i &lt; 3 ))</span></span><br><span class="line"><span class="comment">#  + printf 1</span></span><br><span class="line"><span class="comment">#  1+ (( i++  ))</span></span><br><span class="line"><span class="comment">#  + (( i &lt; 3 ))</span></span><br><span class="line"><span class="comment">#  + printf 2</span></span><br><span class="line"><span class="comment">#  2+ (( i++  ))</span></span><br><span class="line"><span class="comment">#  + (( i &lt; 3 ))</span></span><br><span class="line"><span class="comment">#  + set +x</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;; <span class="keyword">do</span> <span class="built_in">printf</span> <span class="variable">$&#123;i&#125;</span>; <span class="keyword">done</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">"\n"</span></span><br><span class="line"><span class="comment">#  Output: 12345</span></span><br></pre></td></tr></table></figure>
<h2 id="12-æ›´å¤šå†…å®¹"><a class="markdownIt-Anchor" href="#12-æ›´å¤šå†…å®¹"></a> 12. æ›´å¤šå†…å®¹</h2>
<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<ul>
<li><a href="https://github.com/alebcay/awesome-shell" target="_blank" rel="noopener">awesome-shell</a>ï¼Œshell èµ„æºåˆ—è¡¨</li>
<li><a href="https://github.com/awesome-lists/awesome-bash" target="_blank" rel="noopener">awesome-bash</a>ï¼Œbash èµ„æºåˆ—è¡¨</li>
<li><a href="https://github.com/denysdovhan/bash-handbook" target="_blank" rel="noopener">bash-handbook</a></li>
<li><a href="https://github.com/vuuihc/bash-guide" target="_blank" rel="noopener">bash-guide</a> ï¼Œbash åŸºæœ¬ç”¨æ³•æŒ‡å—</li>
<li><a href="https://github.com/Bash-it/bash-it" target="_blank" rel="noopener">bash-it</a>ï¼Œä¸ºä½ æ—¥å¸¸ä½¿ç”¨ï¼Œå¼€å‘ä»¥åŠç»´æŠ¤ shell è„šæœ¬å’Œè‡ªå®šä¹‰å‘½ä»¤æä¾›äº†ä¸€ä¸ªå¯é çš„æ¡†æ¶</li>
<li><a href="http://dotfiles.github.io/" target="_blank" rel="noopener">dotfiles.github.io</a>ï¼Œä¸Šé¢æœ‰ bash å’Œå…¶å®ƒ shell çš„å„ç§ dotfiles é›†åˆä»¥åŠ shell æ¡†æ¶çš„é“¾æ¥</li>
<li><a href="http://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener">Runoob Shell æ•™ç¨‹</a></li>
<li><a href="https://github.com/koalaman/shellcheck" target="_blank" rel="noopener">shellcheck</a> ä¸€ä¸ªé™æ€ shell è„šæœ¬åˆ†æå·¥å…·ï¼Œæœ¬è´¨ä¸Šæ˜¯ bashï¼shï¼zsh çš„ lintã€‚</li>
</ul>
<p>æœ€åï¼ŒStack Overflow ä¸Š <a href="https://stackoverflow.com/questions/tagged/bash" target="_blank" rel="noopener">bash æ ‡ç­¾ä¸‹</a>æœ‰å¾ˆå¤šä½ å¯ä»¥å­¦ä¹ çš„é—®é¢˜ï¼Œå½“ä½ é‡åˆ°é—®é¢˜æ—¶ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæé—®çš„å¥½åœ°æ–¹ã€‚</p>
]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹</tag>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼</title>
    <url>/blog/tools/regex/</url>
    <content><![CDATA[<blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<p>ä¸ºäº†ç†è§£ä¸‹é¢ç« èŠ‚çš„å†…å®¹ï¼Œä½ éœ€è¦å…ˆäº†è§£ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p>
<ul>
<li><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> - æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯¹å­—ç¬¦ä¸²æ“ä½œçš„ä¸€ç§é€»è¾‘å…¬å¼ï¼Œå°±æ˜¯ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ã€åŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ï¼Œè¿™ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ç”¨æ¥è¡¨è¾¾å¯¹å­—ç¬¦ä¸²çš„ä¸€ç§è¿‡æ»¤é€»è¾‘ã€‚</li>
<li><strong>å…ƒå­—ç¬¦</strong> - å…ƒå­—ç¬¦(metacharacters)å°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­å…·æœ‰ç‰¹æ®Šæ„ä¹‰çš„ä¸“ç”¨å­—ç¬¦ã€‚</li>
<li><strong>æ™®é€šå­—ç¬¦</strong> - æ™®é€šå­—ç¬¦åŒ…æ‹¬æ²¡æœ‰æ˜¾å¼æŒ‡å®šä¸ºå…ƒå­—ç¬¦çš„æ‰€æœ‰å¯æ‰“å°å’Œä¸å¯æ‰“å°å­—ç¬¦ã€‚è¿™åŒ…æ‹¬æ‰€æœ‰å¤§å†™å’Œå°å†™å­—æ¯ã€æ‰€æœ‰æ•°å­—ã€æ‰€æœ‰æ ‡ç‚¹ç¬¦å·å’Œä¸€äº›å…¶ä»–ç¬¦å·ã€‚</li>
</ul>
<h2 id="åŸºæœ¬å…ƒå­—ç¬¦"><a class="markdownIt-Anchor" href="#åŸºæœ¬å…ƒå­—ç¬¦"></a> åŸºæœ¬å…ƒå­—ç¬¦</h2>
<p>æ­£åˆ™è¡¨è¾¾å¼çš„å…ƒå­—ç¬¦éš¾ä»¥è®°å¿†ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å› ä¸ºæœ‰å¾ˆå¤šä¸ºäº†ç®€åŒ–è¡¨è¾¾è€Œå‡ºç°çš„ç­‰ä»·å­—ç¬¦ã€‚</p>
<p>è€Œå®é™…ä¸Šæœ€åŸºæœ¬çš„å…ƒå­—ç¬¦ï¼Œå¹¶æ²¡æœ‰é‚£ä¹ˆå¤šã€‚å¯¹äºå¤§éƒ¨åˆ†çš„åœºæ™¯ï¼ŒåŸºæœ¬å…ƒå­—ç¬¦éƒ½å¯ä»¥æå®šã€‚</p>
<p>è®©æˆ‘ä»¬ä»ä¸€ä¸ªä¸ªå®ä¾‹å‡ºå‘ï¼Œç”±æµ…å…¥æ·±çš„å»ä½“ä¼šæ­£åˆ™çš„å¥¥å¦™ã€‚</p>
<h3 id="å¤šé€‰-"><a class="markdownIt-Anchor" href="#å¤šé€‰-"></a> å¤šé€‰ - |</h3>
<p><strong>ä¾‹ åŒ¹é…ä¸€ä¸ªç¡®å®šçš„å­—ç¬¦ä¸²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">checkMatches(<span class="string">"abc"</span>, <span class="string">"abc"</span>);</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦åŒ¹é…ä¸€ä¸ªç¡®å®šçš„å­—ç¬¦ä¸²ï¼Œéå¸¸ç®€å•ï¼Œå¦‚ä¾‹ 1 æ‰€ç¤ºã€‚</p>
<p>å¦‚æœä½ ä¸ç¡®å®šè¦åŒ¹é…çš„å­—ç¬¦ä¸²ï¼Œå¸Œæœ›æœ‰å¤šä¸ªé€‰æ‹©ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼šä½¿ç”¨å…ƒå­—ç¬¦<code>|</code> ï¼Œå®ƒçš„å«ä¹‰æ˜¯æˆ–ã€‚</p>
<p><strong>ä¾‹ åŒ¹é…å¤šä¸ªå¯é€‰çš„å­—ç¬¦ä¸²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ï¼š|</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"yes|no"</span>, <span class="string">"yes"</span>));</span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"yes|no"</span>, <span class="string">"no"</span>));</span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"yes|no"</span>, <span class="string">"right"</span>));</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="literal">yes</span>	<span class="string">matchesï¼š</span> <span class="literal">yes</span><span class="string">|no</span></span><br><span class="line"><span class="literal">no</span>	<span class="string">matchesï¼š</span> <span class="literal">yes</span><span class="string">|no</span></span><br><span class="line"><span class="string">right</span>	<span class="string">not</span> <span class="string">matchesï¼š</span> <span class="literal">yes</span><span class="string">|no</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ†ç»„-"><a class="markdownIt-Anchor" href="#åˆ†ç»„-"></a> åˆ†ç»„ - ()</h3>
<p>å¦‚æœä½ å¸Œæœ›è¡¨è¾¾å¼ç”±å¤šä¸ªå­è¡¨è¾¾å¼ç»„æˆï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>()</code>ã€‚</p>
<p><strong>ä¾‹ åŒ¹é…ç»„åˆå­—ç¬¦ä¸²</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Assert.assertTrue(checkMatches(<span class="string">"(play|end)(ing|ed)"</span>, <span class="string">"ended"</span>));</span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"(play|end)(ing|ed)"</span>, <span class="string">"ending"</span>));</span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"(play|end)(ing|ed)"</span>, <span class="string">"playing"</span>));</span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"(play|end)(ing|ed)"</span>, <span class="string">"played"</span>));</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">ended	matchesï¼š (play|<span class="type">end</span>)(ing|<span class="type">ed</span>)</span><br><span class="line">ending	matchesï¼š (play|<span class="type">end</span>)(ing|<span class="type">ed</span>)</span><br><span class="line">playing	matchesï¼š (play|<span class="type">end</span>)(ing|<span class="type">ed</span>)</span><br><span class="line">played	matchesï¼š (play|<span class="type">end</span>)(ing|<span class="type">ed</span>)</span><br></pre></td></tr></table></figure>
<h3 id="æŒ‡å®šå•å­—ç¬¦æœ‰æ•ˆèŒƒå›´-"><a class="markdownIt-Anchor" href="#æŒ‡å®šå•å­—ç¬¦æœ‰æ•ˆèŒƒå›´-"></a> æŒ‡å®šå•å­—ç¬¦æœ‰æ•ˆèŒƒå›´ - []</h3>
<p>å‰é¢å±•ç¤ºäº†å¦‚ä½•åŒ¹é…å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ä½ éœ€è¦ç²¾ç¡®çš„åŒ¹é…ä¸€ä¸ªå­—ç¬¦ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨<code>[]</code> ã€‚</p>
<p><strong>ä¾‹ å­—ç¬¦åœ¨æŒ‡å®šèŒƒå›´</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ï¼š[]</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"[abc]"</span>, <span class="string">"b"</span>));  <span class="comment">// å­—ç¬¦åªèƒ½æ˜¯aã€bã€c</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"[a-z]"</span>, <span class="string">"m"</span>)); <span class="comment">// å­—ç¬¦åªèƒ½æ˜¯a - z</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"[A-Z]"</span>, <span class="string">"O"</span>)); <span class="comment">// å­—ç¬¦åªèƒ½æ˜¯A - Z</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"[a-zA-Z]"</span>, <span class="string">"K"</span>)); <span class="comment">// å­—ç¬¦åªèƒ½æ˜¯a - zå’ŒA - Z</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"[a-zA-Z]"</span>, <span class="string">"k"</span>));</span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"[0-9]"</span>, <span class="string">"5"</span>)); <span class="comment">// å­—ç¬¦åªèƒ½æ˜¯0 - 9</span></span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">b</span>	matchesï¼š<span class="meta"> [abc]</span></span><br><span class="line"><span class="attribute">m</span>	matchesï¼š<span class="meta"> [a-z]</span></span><br><span class="line"><span class="attribute">O</span>	matchesï¼š<span class="meta"> [A-Z]</span></span><br><span class="line"><span class="attribute">K</span>	matchesï¼š<span class="meta"> [a-zA-Z]</span></span><br><span class="line"><span class="attribute">k</span>	matchesï¼š<span class="meta"> [a-zA-Z]</span></span><br><span class="line"><span class="attribute">5</span>	matchesï¼š<span class="meta"> [0-9]</span></span><br></pre></td></tr></table></figure>
<h3 id="æŒ‡å®šå•å­—ç¬¦æ— æ•ˆèŒƒå›´-"><a class="markdownIt-Anchor" href="#æŒ‡å®šå•å­—ç¬¦æ— æ•ˆèŒƒå›´-"></a> æŒ‡å®šå•å­—ç¬¦æ— æ•ˆèŒƒå›´ - [^]</h3>
<p><strong>ä¾‹ å­—ç¬¦ä¸èƒ½åœ¨æŒ‡å®šèŒƒå›´</strong></p>
<p>å¦‚æœéœ€è¦åŒ¹é…ä¸€ä¸ªå­—ç¬¦çš„é€†æ“ä½œï¼Œå³å­—ç¬¦ä¸èƒ½åœ¨æŒ‡å®šèŒƒå›´ï¼Œå¯ä»¥ä½¿ç”¨<code>[^]</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ï¼š[^]</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"[^abc]"</span>, <span class="string">"b"</span>)); <span class="comment">// å­—ç¬¦ä¸èƒ½æ˜¯aã€bã€c</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"[^a-z]"</span>, <span class="string">"m"</span>)); <span class="comment">// å­—ç¬¦ä¸èƒ½æ˜¯a - z</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"[^A-Z]"</span>, <span class="string">"O"</span>)); <span class="comment">// å­—ç¬¦ä¸èƒ½æ˜¯A - Z</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"[^a-zA-Z]"</span>, <span class="string">"K"</span>)); <span class="comment">// å­—ç¬¦ä¸èƒ½æ˜¯a - zå’ŒA - Z</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"[^a-zA-Z]"</span>, <span class="string">"k"</span>));</span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"[^0-9]"</span>, <span class="string">"5"</span>)); <span class="comment">// å­—ç¬¦ä¸èƒ½æ˜¯0 - 9</span></span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">b<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š [^abc]</span><br><span class="line">m<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š [^a-z]</span><br><span class="line">O<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š [^A-Z]</span><br><span class="line">K<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š [^a-zA-Z]</span><br><span class="line">k<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š [^a-zA-Z]</span><br><span class="line"><span class="number">5</span><span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š [^<span class="number">0</span>-<span class="number">9</span>]</span><br></pre></td></tr></table></figure>
<h3 id="é™åˆ¶å­—ç¬¦æ•°é‡-"><a class="markdownIt-Anchor" href="#é™åˆ¶å­—ç¬¦æ•°é‡-"></a> é™åˆ¶å­—ç¬¦æ•°é‡ - {}</h3>
<p>å¦‚æœæƒ³è¦æ§åˆ¶å­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œå¯ä»¥ä½¿ç”¨<code>{}</code>ã€‚</p>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>{n}</code></td>
<td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚</td>
</tr>
<tr>
<td><code>{n,}</code></td>
<td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é… n æ¬¡ã€‚</td>
</tr>
<tr>
<td><code>{n,m}</code></td>
<td>m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­ n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>ä¾‹ é™åˆ¶å­—ç¬¦å‡ºç°æ¬¡æ•°</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// &#123;n&#125;: n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚</span></span><br><span class="line">checkMatches(<span class="string">"ap&#123;1&#125;"</span>, <span class="string">"a"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;1&#125;"</span>, <span class="string">"ap"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;1&#125;"</span>, <span class="string">"app"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;1&#125;"</span>, <span class="string">"apppppppppp"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123;n,&#125;: n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é… n æ¬¡ã€‚</span></span><br><span class="line">checkMatches(<span class="string">"ap&#123;1,&#125;"</span>, <span class="string">"a"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;1,&#125;"</span>, <span class="string">"ap"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;1,&#125;"</span>, <span class="string">"app"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;1,&#125;"</span>, <span class="string">"apppppppppp"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123;n,m&#125;: m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­ n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚</span></span><br><span class="line">checkMatches(<span class="string">"ap&#123;2,5&#125;"</span>, <span class="string">"a"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;2,5&#125;"</span>, <span class="string">"ap"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;2,5&#125;"</span>, <span class="string">"app"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap&#123;2,5&#125;"</span>, <span class="string">"apppppppppp"</span>);</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">a<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š ap&#123;<span class="number">1</span>&#125;</span><br><span class="line">ap<span class="built_in">	matches</span>ï¼š ap&#123;<span class="number">1</span>&#125;</span><br><span class="line">app<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š ap&#123;<span class="number">1</span>&#125;</span><br><span class="line">apppppppppp<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š ap&#123;<span class="number">1</span>&#125;</span><br><span class="line">a<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š ap&#123;<span class="number">1</span>,&#125;</span><br><span class="line">ap<span class="built_in">	matches</span>ï¼š ap&#123;<span class="number">1</span>,&#125;</span><br><span class="line">app<span class="built_in">	matches</span>ï¼š ap&#123;<span class="number">1</span>,&#125;</span><br><span class="line">apppppppppp<span class="built_in">	matches</span>ï¼š ap&#123;<span class="number">1</span>,&#125;</span><br><span class="line">a<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š ap&#123;<span class="number">2</span>,<span class="number">5</span>&#125;</span><br><span class="line">ap<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š ap&#123;<span class="number">2</span>,<span class="number">5</span>&#125;</span><br><span class="line">app<span class="built_in">	matches</span>ï¼š ap&#123;<span class="number">2</span>,<span class="number">5</span>&#125;</span><br><span class="line">apppppppppp<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š ap&#123;<span class="number">2</span>,<span class="number">5</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è½¬ä¹‰å­—ç¬¦-"><a class="markdownIt-Anchor" href="#è½¬ä¹‰å­—ç¬¦-"></a> è½¬ä¹‰å­—ç¬¦ - /</h3>
<p>å¦‚æœæƒ³è¦æŸ¥æ‰¾å…ƒå­—ç¬¦æœ¬èº«ï¼Œä½ éœ€è¦ä½¿ç”¨è½¬ä¹‰ç¬¦ï¼Œä½¿å¾—æ­£åˆ™å¼•æ“å°†å…¶è§†ä½œä¸€ä¸ªæ™®é€šå­—ç¬¦ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…ƒå­—ç¬¦å»å¤„ç†ã€‚</p>
<figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line">* çš„è½¬ä¹‰å­—ç¬¦ï¼š<span class="string">\*</span></span><br><span class="line">+ çš„è½¬ä¹‰å­—ç¬¦ï¼š<span class="string">\+</span></span><br><span class="line">? çš„è½¬ä¹‰å­—ç¬¦ï¼š<span class="string">\?</span></span><br><span class="line">^ çš„è½¬ä¹‰å­—ç¬¦ï¼š<span class="string">\^</span></span><br><span class="line">$ çš„è½¬ä¹‰å­—ç¬¦ï¼š<span class="string">\$</span></span><br><span class="line">. çš„è½¬ä¹‰å­—ç¬¦ï¼š<span class="string">\.</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯è½¬ä¹‰ç¬¦<code>\</code>æœ¬èº«ï¼Œä½ ä¹Ÿéœ€è¦ä½¿ç”¨<code>\\</code> ã€‚</p>
<h3 id="æŒ‡å®šè¡¨è¾¾å¼å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“å°¾-"><a class="markdownIt-Anchor" href="#æŒ‡å®šè¡¨è¾¾å¼å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“å°¾-"></a> æŒ‡å®šè¡¨è¾¾å¼å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“å°¾ - ^ã€$</h3>
<p>å¦‚æœå¸Œæœ›åŒ¹é…çš„å­—ç¬¦ä¸²å¿…é¡»ä»¥ç‰¹å®šå­—ç¬¦ä¸²å¼€å¤´ï¼Œå¯ä»¥ä½¿ç”¨<code>^</code> ã€‚</p>
<p>æ³¨ï¼šè¯·ç‰¹åˆ«ç•™æ„ï¼Œè¿™é‡Œçš„<code>^</code> ä¸€å®šè¦å’Œ <code>[^]</code> ä¸­çš„ â€œ^â€ åŒºåˆ†ã€‚</p>
<p><strong>ä¾‹ é™åˆ¶å­—ç¬¦ä¸²å¤´éƒ¨</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Assert.assertTrue(checkMatches(<span class="string">"^app[a-z]&#123;0,&#125;"</span>, <span class="string">"apple"</span>)); <span class="comment">// å­—ç¬¦ä¸²å¿…é¡»ä»¥appå¼€å¤´</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"^app[a-z]&#123;0,&#125;"</span>, <span class="string">"aplause"</span>));</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">apple<span class="built_in">	matches</span>ï¼š ^app[a-z]&#123;<span class="number">0</span>,&#125;</span><br><span class="line">aplause<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š ^app[a-z]&#123;<span class="number">0</span>,&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå¸Œæœ›åŒ¹é…çš„å­—ç¬¦ä¸²å¿…é¡»ä»¥ç‰¹å®šå­—ç¬¦ä¸²å¼€å¤´ï¼Œå¯ä»¥ä½¿ç”¨<code>$</code> ã€‚</p>
<p><strong>ä¾‹ é™åˆ¶å­—ç¬¦ä¸²å°¾éƒ¨</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Assert.assertTrue(checkMatches(<span class="string">"[a-z]&#123;0,&#125;ing$"</span>, <span class="string">"playing"</span>)); <span class="comment">// å­—ç¬¦ä¸²å¿…é¡»ä»¥ingç»“å°¾</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"[a-z]&#123;0,&#125;ing$"</span>, <span class="string">"long"</span>));</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">playing<span class="built_in">	matches</span>ï¼š [a-z]&#123;<span class="number">0</span>,&#125;ing$</span><br><span class="line">long<span class="built_in">	not</span><span class="built_in"> matches</span>ï¼š [a-z]&#123;<span class="number">0</span>,&#125;ing$</span><br></pre></td></tr></table></figure>
<h2 id="ç­‰ä»·å­—ç¬¦"><a class="markdownIt-Anchor" href="#ç­‰ä»·å­—ç¬¦"></a> ç­‰ä»·å­—ç¬¦</h2>
<p>ç­‰ä»·å­—ç¬¦ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¯¹äºåŸºæœ¬å…ƒå­—ç¬¦è¡¨è¾¾çš„ä¸€ç§ç®€åŒ–ï¼ˆç­‰ä»·å­—ç¬¦çš„åŠŸèƒ½éƒ½å¯ä»¥é€šè¿‡åŸºæœ¬å…ƒå­—ç¬¦æ¥å®ç°ï¼‰ã€‚</p>
<p>åœ¨æ²¡æœ‰æŒæ¡åŸºæœ¬å…ƒå­—ç¬¦ä¹‹å‰ï¼Œå¯ä»¥å…ˆä¸ç”¨ç†ä¼šï¼Œå› ä¸ºå¾ˆå®¹æ˜“æŠŠäººç»•æ™•ã€‚</p>
<p>ç­‰ä»·å­—ç¬¦çš„å¥½å¤„åœ¨äºç®€åŒ–äº†åŸºæœ¬å…ƒå­—ç¬¦çš„å†™æ³•ã€‚</p>
<h3 id="è¡¨ç¤ºæŸä¸€ç±»å‹å­—ç¬¦çš„ç­‰ä»·å­—ç¬¦"><a class="markdownIt-Anchor" href="#è¡¨ç¤ºæŸä¸€ç±»å‹å­—ç¬¦çš„ç­‰ä»·å­—ç¬¦"></a> è¡¨ç¤ºæŸä¸€ç±»å‹å­—ç¬¦çš„ç­‰ä»·å­—ç¬¦</h3>
<p>ä¸‹è¡¨ä¸­çš„ç­‰ä»·å­—ç¬¦éƒ½è¡¨ç¤ºæŸä¸€ç±»å‹çš„å­—ç¬¦ã€‚</p>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>.</code></strong></td>
<td>åŒ¹é…é™¤â€œ\nâ€ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚</td>
</tr>
<tr>
<td><strong><code>\d</code></strong></td>
<td>åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº[0-9]ã€‚</td>
</tr>
<tr>
<td><strong><code>\D</code></strong></td>
<td>åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº[^0-9]ã€‚</td>
</tr>
<tr>
<td><strong><code>\w</code></strong></td>
<td>åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦ã€‚ç±»ä¼¼ä½†ä¸ç­‰ä»·äºâ€œ[A-Za-z0-9_]â€ï¼Œè¿™é‡Œçš„å•è¯å­—ç¬¦æŒ‡çš„æ˜¯ Unicode å­—ç¬¦é›†ã€‚</td>
</tr>
<tr>
<td><strong><code>\W</code></strong></td>
<td>åŒ¹é…ä»»ä½•éå•è¯å­—ç¬¦ã€‚</td>
</tr>
<tr>
<td><strong><code>\s</code></strong></td>
<td>åŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº[ \f\n\r\t\v]ã€‚</td>
</tr>
<tr>
<td><strong><code>\S</code></strong></td>
<td>åŒ¹é…ä»»ä½•å¯è§å­—ç¬¦ã€‚ç­‰ä»·äº[ \f\n\r\t\v]ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>æ¡ˆä¾‹ åŸºæœ¬ç­‰ä»·å­—ç¬¦çš„ç”¨æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŒ¹é…é™¤â€œ\nâ€ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">".&#123;1,&#125;"</span>, <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_"</span>));</span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">".&#123;1,&#125;"</span>, <span class="string">"~!@#$%^&amp;*()+`-=[]&#123;&#125;;:&lt;&gt;,./?|\\"</span>));</span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"."</span>, <span class="string">"\n"</span>));</span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"[^\n]"</span>, <span class="string">"\n"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº[0-9]</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"\\d&#123;1,&#125;"</span>, <span class="string">"0123456789"</span>));</span><br><span class="line"><span class="comment">// åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº[^0-9]</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"\\D&#123;1,&#125;"</span>, <span class="string">"0123456789"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦ã€‚ç±»ä¼¼ä½†ä¸ç­‰ä»·äºâ€œ[A-Za-z0-9_]â€ï¼Œè¿™é‡Œçš„å•è¯å­—ç¬¦æŒ‡çš„æ˜¯Unicodeå­—ç¬¦é›†</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"\\w&#123;1,&#125;"</span>, <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_"</span>));</span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"\\w&#123;1,&#125;"</span>, <span class="string">"~!@#$%^&amp;*()+`-=[]&#123;&#125;;:&lt;&gt;,./?|\\"</span>));</span><br><span class="line"><span class="comment">// åŒ¹é…ä»»ä½•éå•è¯å­—ç¬¦</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"\\W&#123;1,&#125;"</span>, <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_"</span>));</span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"\\W&#123;1,&#125;"</span>, <span class="string">"~!@#$%^&amp;*()+`-=[]&#123;&#125;;:&lt;&gt;,./?|\\"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº[ \f\n\r\t\v]</span></span><br><span class="line">Assert.assertTrue(checkMatches(<span class="string">"\\s&#123;1,&#125;"</span>, <span class="string">" \f\r\n\t"</span>));</span><br><span class="line"><span class="comment">// åŒ¹é…ä»»ä½•å¯è§å­—ç¬¦ã€‚ç­‰ä»·äº[^ \f\n\r\t\v]</span></span><br><span class="line">Assert.assertFalse(checkMatches(<span class="string">"\\S&#123;1,&#125;"</span>, <span class="string">" \f\r\n\t"</span>));</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight tex"><table><tr><td class="code"><pre><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_	matchesï¼š .&#123;1,&#125;</span><br><span class="line">~!@#<span class="formula">$%^&amp;*()+`-=[]&#123;&#125;;:&lt;&gt;,./?|<span class="tag">\<span class="name">\</span></span>	matchesï¼š .&#123;1,&#125;</span></span><br><span class="line"><span class="formula"><span class="tag">\<span class="name">n</span></span>	not matchesï¼š .</span></span><br><span class="line"><span class="formula"><span class="tag">\<span class="name">n</span></span>	not matchesï¼š [^<span class="tag">\<span class="name">n</span></span>]</span></span><br><span class="line"><span class="formula">0123456789	matchesï¼š <span class="tag">\<span class="name">\</span></span>d&#123;1,&#125;</span></span><br><span class="line"><span class="formula">0123456789	not matchesï¼š <span class="tag">\<span class="name">\</span></span>D&#123;1,&#125;</span></span><br><span class="line"><span class="formula">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_	matchesï¼š <span class="tag">\<span class="name">\</span></span>w&#123;1,&#125;</span></span><br><span class="line"><span class="formula">~!@#$</span><span class="comment">%^&amp;*()+`-=[]&#123;&#125;;:&lt;&gt;,./?|\\	not matchesï¼š \\w&#123;1,&#125;</span></span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_	not matchesï¼š <span class="tag">\<span class="name">\</span></span>W&#123;1,&#125;</span><br><span class="line">~!@#<span class="formula">$%^&amp;*()+`-=[]&#123;&#125;;:&lt;&gt;,./?|<span class="tag">\<span class="name">\</span></span>	matchesï¼š <span class="tag">\<span class="name">\</span></span>W&#123;1,&#125;</span></span><br><span class="line"><span class="formula"> <span class="tag">\<span class="name">f</span></span><span class="tag">\<span class="name">r</span></span><span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name">t</span></span>	matchesï¼š <span class="tag">\<span class="name">\</span></span>s&#123;1,&#125;</span></span><br><span class="line"><span class="formula"> <span class="tag">\<span class="name">f</span></span><span class="tag">\<span class="name">r</span></span><span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name">t</span></span>	not matchesï¼š <span class="tag">\<span class="name">\</span></span>S&#123;1,&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="é™åˆ¶å­—ç¬¦æ•°é‡çš„ç­‰ä»·å­—ç¬¦"><a class="markdownIt-Anchor" href="#é™åˆ¶å­—ç¬¦æ•°é‡çš„ç­‰ä»·å­—ç¬¦"></a> é™åˆ¶å­—ç¬¦æ•°é‡çš„ç­‰ä»·å­—ç¬¦</h3>
<p>åœ¨åŸºæœ¬å…ƒå­—ç¬¦ç« èŠ‚ä¸­ï¼Œå·²ç»ä»‹ç»äº†é™åˆ¶å­—ç¬¦æ•°é‡çš„åŸºæœ¬å…ƒå­—ç¬¦ - <code>{}</code> ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿˜æœ‰ <code>*</code>ã€<code>+</code>ã€<code>?</code> è¿™ä¸ªä¸‰ä¸ªä¸ºäº†ç®€åŒ–å†™æ³•è€Œå‡ºç°çš„ç­‰ä»·å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥è®¤è¯†ä¸€ä¸‹ã€‚</p>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ç­‰ä»·äº{0,}ã€‚</td>
</tr>
<tr>
<td><code>+</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ç­‰ä»·äº{1,}ã€‚</td>
</tr>
<tr>
<td><code>?</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ç­‰ä»·äº {0,1}ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>æ¡ˆä¾‹ é™åˆ¶å­—ç¬¦æ•°é‡çš„ç­‰ä»·å­—ç¬¦</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// *: åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚* ç­‰ä»·äº&#123;0,&#125;ã€‚</span></span><br><span class="line">checkMatches(<span class="string">"ap*"</span>, <span class="string">"a"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap*"</span>, <span class="string">"ap"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap*"</span>, <span class="string">"app"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap*"</span>, <span class="string">"apppppppppp"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// +: åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚+ ç­‰ä»·äº &#123;1,&#125;ã€‚</span></span><br><span class="line">checkMatches(<span class="string">"ap+"</span>, <span class="string">"a"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap+"</span>, <span class="string">"ap"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap+"</span>, <span class="string">"app"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap+"</span>, <span class="string">"apppppppppp"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ?: åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚? ç­‰ä»·äº &#123;0,1&#125;ã€‚</span></span><br><span class="line">checkMatches(<span class="string">"ap?"</span>, <span class="string">"a"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap?"</span>, <span class="string">"ap"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap?"</span>, <span class="string">"app"</span>);</span><br><span class="line">checkMatches(<span class="string">"ap?"</span>, <span class="string">"apppppppppp"</span>);</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">a	matchesï¼š <span class="keyword">ap</span>*</span><br><span class="line"><span class="keyword">ap</span>	matchesï¼š <span class="keyword">ap</span>*</span><br><span class="line"><span class="keyword">app</span>	matchesï¼š <span class="keyword">ap</span>*</span><br><span class="line">apppppppppp	matchesï¼š <span class="keyword">ap</span>*</span><br><span class="line">a	not matchesï¼š <span class="keyword">ap</span>+</span><br><span class="line"><span class="keyword">ap</span>	matchesï¼š <span class="keyword">ap</span>+</span><br><span class="line"><span class="keyword">app</span>	matchesï¼š <span class="keyword">ap</span>+</span><br><span class="line">apppppppppp	matchesï¼š <span class="keyword">ap</span>+</span><br><span class="line">a	matchesï¼š <span class="keyword">ap</span>?</span><br><span class="line"><span class="keyword">ap</span>	matchesï¼š <span class="keyword">ap</span>?</span><br><span class="line"><span class="keyword">app</span>	not matchesï¼š <span class="keyword">ap</span>?</span><br><span class="line">apppppppppp	not matchesï¼š <span class="keyword">ap</span>?</span><br></pre></td></tr></table></figure>
<h2 id="å…ƒå­—ç¬¦ä¼˜å…ˆçº§é¡ºåº"><a class="markdownIt-Anchor" href="#å…ƒå­—ç¬¦ä¼˜å…ˆçº§é¡ºåº"></a> å…ƒå­—ç¬¦ä¼˜å…ˆçº§é¡ºåº</h2>
<p>æ­£åˆ™è¡¨è¾¾å¼ä»å·¦åˆ°å³è¿›è¡Œè®¡ç®—ï¼Œå¹¶éµå¾ªä¼˜å…ˆçº§é¡ºåºï¼Œè¿™ä¸ç®—æœ¯è¡¨è¾¾å¼éå¸¸ç±»ä¼¼ã€‚</p>
<p>ä¸‹è¡¨ä»æœ€é«˜åˆ°æœ€ä½è¯´æ˜äº†å„ç§æ­£åˆ™è¡¨è¾¾å¼è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é¡ºåºï¼š</p>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>\</td>
<td>è½¬ä¹‰ç¬¦</td>
</tr>
<tr>
<td>(), (?ğŸ˜ƒ, (?=), []</td>
<td>æ‹¬å·å’Œä¸­æ‹¬å·</td>
</tr>
<tr>
<td>*, +, ?, {n}, {n,}, {n,m}</td>
<td>é™å®šç¬¦</td>
</tr>
<tr>
<td>^, $, *ä»»ä½•å…ƒå­—ç¬¦ã€ä»»ä½•å­—ç¬¦*</td>
<td>å®šä½ç‚¹å’Œåºåˆ—</td>
</tr>
<tr>
<td>|</td>
<td>æ›¿æ¢</td>
</tr>
</tbody>
</table>
<p>å­—ç¬¦å…·æœ‰é«˜äºæ›¿æ¢è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼Œä½¿å¾—â€œm|foodâ€åŒ¹é…â€œmâ€æˆ–â€œfoodâ€ã€‚è‹¥è¦åŒ¹é…â€œmoodâ€æˆ–â€œfoodâ€ï¼Œè¯·ä½¿ç”¨æ‹¬å·åˆ›å»ºå­è¡¨è¾¾å¼ï¼Œä»è€Œäº§ç”Ÿâ€œ(m|f)oodâ€ã€‚</p>
<h2 id="åˆ†ç»„æ„é€ "><a class="markdownIt-Anchor" href="#åˆ†ç»„æ„é€ "></a> åˆ†ç»„æ„é€ </h2>
<p>åœ¨åŸºæœ¬å…ƒå­—ç¬¦ç« èŠ‚ï¼Œæåˆ°äº† <code>()</code> å­—ç¬¦å¯ä»¥ç”¨æ¥å¯¹è¡¨è¾¾å¼åˆ†ç»„ã€‚å®é™…ä¸Šåˆ†ç»„è¿˜æœ‰æ›´å¤šå¤æ‚çš„ç”¨æ³•ã€‚</p>
<p>æ‰€è°“åˆ†ç»„æ„é€ ï¼Œæ˜¯ç”¨æ¥æè¿°æ­£åˆ™è¡¨è¾¾å¼çš„å­è¡¨è¾¾å¼ï¼Œç”¨äºæ•è·å­—ç¬¦ä¸²ä¸­çš„å­å­—ç¬¦ä¸²ã€‚</p>
<h2 id="æ•è·ä¸éæ•è·"><a class="markdownIt-Anchor" href="#æ•è·ä¸éæ•è·"></a> æ•è·ä¸éæ•è·</h2>
<p>ä¸‹è¡¨ä¸ºåˆ†ç»„æ„é€ ä¸­çš„æ•è·å’Œéæ•è·åˆ†ç±»ã€‚</p>
<table>
<thead>
<tr>
<th>è¡¨è¾¾å¼</th>
<th>æè¿°</th>
<th>æ•è·æˆ–éæ•è·</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(exp)</code></td>
<td>åŒ¹é…çš„å­è¡¨è¾¾å¼</td>
<td>æ•è·</td>
</tr>
<tr>
<td><code>(?&lt;name&gt;exp)</code></td>
<td>å‘½åçš„åå‘å¼•ç”¨</td>
<td>æ•è·</td>
</tr>
<tr>
<td><code>(?:exp)</code></td>
<td>éæ•è·ç»„</td>
<td>éæ•è·</td>
</tr>
<tr>
<td><code>(?=exp)</code></td>
<td>é›¶å®½åº¦æ­£é¢„æµ‹å…ˆè¡Œæ–­è¨€</td>
<td>éæ•è·</td>
</tr>
<tr>
<td><code>(?!exp)</code></td>
<td>é›¶å®½åº¦è´Ÿé¢„æµ‹å…ˆè¡Œæ–­è¨€</td>
<td>éæ•è·</td>
</tr>
<tr>
<td><code>(?&lt;=exp)</code></td>
<td>é›¶å®½åº¦æ­£å›é¡¾åå‘æ–­è¨€</td>
<td>éæ•è·</td>
</tr>
<tr>
<td><code>(?&lt;!exp)</code></td>
<td>é›¶å®½åº¦è´Ÿå›é¡¾åå‘æ–­è¨€</td>
<td>éæ•è·</td>
</tr>
</tbody>
</table>
<p>æ³¨ï¼šJava æ­£åˆ™å¼•æ“ä¸æ”¯æŒå¹³è¡¡ç»„ã€‚</p>
<h2 id="åå‘å¼•ç”¨"><a class="markdownIt-Anchor" href="#åå‘å¼•ç”¨"></a> åå‘å¼•ç”¨</h2>
<h3 id="å¸¦ç¼–å·çš„åå‘å¼•ç”¨"><a class="markdownIt-Anchor" href="#å¸¦ç¼–å·çš„åå‘å¼•ç”¨"></a> å¸¦ç¼–å·çš„åå‘å¼•ç”¨</h3>
<p>å¸¦ç¼–å·çš„åå‘å¼•ç”¨ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼š<code>\number</code></p>
<p>å…¶ä¸­<em>number</em> æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­æ•è·ç»„çš„åºå·ä½ç½®ã€‚ ä¾‹å¦‚ï¼Œ\4 åŒ¹é…ç¬¬å››ä¸ªæ•è·ç»„çš„å†…å®¹ã€‚ å¦‚æœæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­æœªå®šä¹‰<em>number</em>ï¼Œåˆ™å°†å‘ç”Ÿåˆ†æé”™è¯¯</p>
<p><strong>ä¾‹ åŒ¹é…é‡å¤çš„å•è¯å’Œç´§éšæ¯ä¸ªé‡å¤çš„å•è¯çš„å•è¯(ä¸å‘½åå­è¡¨è¾¾å¼)</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// (\w+)\s\1\W(\w+) åŒ¹é…é‡å¤çš„å•è¯å’Œç´§éšæ¯ä¸ªé‡å¤çš„å•è¯çš„å•è¯</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"(\\w+)\\s\\1\\W(\\w+)"</span>,</span><br><span class="line">		<span class="string">"He said that that was the the correct answer."</span>) &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">(\w+)\s\1\W(\w+),</span> <span class="attr">content:</span> <span class="string">He</span> <span class="string">said</span> <span class="string">that</span> <span class="string">that</span> <span class="string">was</span> <span class="string">the</span> <span class="string">the</span> <span class="string">correct</span> <span class="string">answer.</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">8</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">21</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">that</span> <span class="string">that</span> <span class="string">was</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">22</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">37</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">the</span> <span class="string">the</span> <span class="string">correct</span></span><br></pre></td></tr></table></figure>
<p><strong>è¯´æ˜</strong></p>
<p>(\w+): åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯å­—ç¬¦ã€‚<br />
\s: ä¸ç©ºç™½å­—ç¬¦åŒ¹é…ã€‚<br />
\1: åŒ¹é…ç¬¬ä¸€ä¸ªç»„ï¼Œå³(\w+)ã€‚<br />
\W: åŒ¹é…åŒ…æ‹¬ç©ºæ ¼å’Œæ ‡ç‚¹ç¬¦å·çš„ä¸€ä¸ªéå•è¯å­—ç¬¦ã€‚ è¿™æ ·å¯ä»¥é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…ä»ç¬¬ä¸€ä¸ªæ•è·ç»„çš„å•è¯å¼€å¤´çš„å•è¯ã€‚</p>
<h3 id="å‘½åçš„åå‘å¼•ç”¨"><a class="markdownIt-Anchor" href="#å‘½åçš„åå‘å¼•ç”¨"></a> å‘½åçš„åå‘å¼•ç”¨</h3>
<p>å‘½ååå‘å¼•ç”¨é€šè¿‡ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•è¿›è¡Œå®šä¹‰ï¼š<code>\k&lt;name &gt;</code></p>
<p><strong>ä¾‹ åŒ¹é…é‡å¤çš„å•è¯å’Œç´§éšæ¯ä¸ªé‡å¤çš„å•è¯çš„å•è¯(å‘½åå­è¡¨è¾¾å¼)</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// (?&lt;duplicateWord&gt;\w+)\s\k&lt;duplicateWord&gt;\W(?&lt;nextWord&gt;\w+) åŒ¹é…é‡å¤çš„å•è¯å’Œç´§éšæ¯ä¸ªé‡å¤çš„å•è¯çš„å•è¯</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"(?&lt;duplicateWord&gt;\\w+)\\s\\k&lt;duplicateWord&gt;\\W(?&lt;nextWord&gt;\\w+)"</span>,</span><br><span class="line">		<span class="string">"He said that that was the the correct answer."</span>) &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">(?&lt;duplicateWord&gt;\w+)\s\k&lt;duplicateWord&gt;\W(?&lt;nextWord&gt;\w+),</span> <span class="attr">content:</span> <span class="string">He</span> <span class="string">said</span> <span class="string">that</span> <span class="string">that</span> <span class="string">was</span> <span class="string">the</span> <span class="string">the</span> <span class="string">correct</span> <span class="string">answer.</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">8</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">21</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">that</span> <span class="string">that</span> <span class="string">was</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">22</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">37</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">the</span> <span class="string">the</span> <span class="string">correct</span></span><br></pre></td></tr></table></figure>
<p><strong>è¯´æ˜</strong></p>
<p>(?<duplicateWord>\w+): åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯å­—ç¬¦ã€‚ å‘½åæ­¤æ•è·ç»„ duplicateWordã€‚<br />
\s: ä¸ç©ºç™½å­—ç¬¦åŒ¹é…ã€‚<br />
\k<duplicateWord>: åŒ¹é…åä¸º duplicateWord çš„æ•è·çš„ç»„ã€‚<br />
\W: åŒ¹é…åŒ…æ‹¬ç©ºæ ¼å’Œæ ‡ç‚¹ç¬¦å·çš„ä¸€ä¸ªéå•è¯å­—ç¬¦ã€‚ è¿™æ ·å¯ä»¥é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…ä»ç¬¬ä¸€ä¸ªæ•è·ç»„çš„å•è¯å¼€å¤´çš„å•è¯ã€‚<br />
(?<nextWord>\w+): åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯å­—ç¬¦ã€‚ å‘½åæ­¤æ•è·ç»„ nextWordã€‚</p>
<h2 id="éæ•è·ç»„"><a class="markdownIt-Anchor" href="#éæ•è·ç»„"></a> éæ•è·ç»„</h2>
<p><code>(?:exp)</code> è¡¨ç¤ºå½“ä¸€ä¸ªé™å®šç¬¦åº”ç”¨åˆ°ä¸€ä¸ªç»„ï¼Œä½†ç»„æ•è·çš„å­å­—ç¬¦ä¸²å¹¶éæ‰€éœ€æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨éæ•è·ç»„æ„é€ ã€‚</p>
<p><strong>ä¾‹ åŒ¹é…ä»¥.ç»“æŸçš„è¯­å¥ã€‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŒ¹é…ç”±å¥å·ç»ˆæ­¢çš„è¯­å¥ã€‚</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"(?:\\b(?:\\w+)\\W*)+\\."</span>, <span class="string">"This is a short sentence. Never end"</span>) &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">regex = (?:\b(?:\w+)\W*)+\., <span class="string">content:</span> This is a <span class="keyword">short</span> sentence. Never end</span><br><span class="line">[<span class="number">1</span>th] <span class="string">start:</span> <span class="number">0</span>, <span class="string">end:</span> <span class="number">25</span>, <span class="string">group:</span> This is a <span class="keyword">short</span> sentence.</span><br></pre></td></tr></table></figure>
<h2 id="é›¶å®½æ–­è¨€"><a class="markdownIt-Anchor" href="#é›¶å®½æ–­è¨€"></a> é›¶å®½æ–­è¨€</h2>
<p>ç”¨äºæŸ¥æ‰¾åœ¨æŸäº›å†…å®¹(ä½†å¹¶ä¸åŒ…æ‹¬è¿™äº›å†…å®¹)ä¹‹å‰æˆ–ä¹‹åçš„ä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬åƒ\b,^,$é‚£æ ·ç”¨äºæŒ‡å®šä¸€ä¸ªä½ç½®ï¼Œè¿™ä¸ªä½ç½®åº”è¯¥æ»¡è¶³ä¸€å®šçš„æ¡ä»¶(å³æ–­è¨€)ï¼Œå› æ­¤å®ƒä»¬ä¹Ÿè¢«ç§°ä¸ºé›¶å®½æ–­è¨€ã€‚</p>
<table>
<thead>
<tr>
<th>è¡¨è¾¾å¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(?=exp)</code></td>
<td>åŒ¹é… exp å‰é¢çš„ä½ç½®</td>
</tr>
<tr>
<td><code>(?&lt;=exp)</code></td>
<td>åŒ¹é… exp åé¢çš„ä½ç½®</td>
</tr>
<tr>
<td><code>(?!exp)</code></td>
<td>åŒ¹é…åé¢è·Ÿçš„ä¸æ˜¯ exp çš„ä½ç½®</td>
</tr>
<tr>
<td><code>(?&lt;!exp)</code></td>
<td>åŒ¹é…å‰é¢ä¸æ˜¯ exp çš„ä½ç½®</td>
</tr>
</tbody>
</table>
<h3 id="åŒ¹é…-exp-å‰é¢çš„ä½ç½®"><a class="markdownIt-Anchor" href="#åŒ¹é…-exp-å‰é¢çš„ä½ç½®"></a> åŒ¹é… exp å‰é¢çš„ä½ç½®</h3>
<p><code>(?=exp)</code> è¡¨ç¤ºè¾“å…¥å­—ç¬¦ä¸²å¿…é¡»åŒ¹é…<em>å­è¡¨è¾¾å¼</em>ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼Œå°½ç®¡åŒ¹é…çš„å­å­—ç¬¦ä¸²æœªåŒ…å«åœ¨åŒ¹é…ç»“æœä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// \b\w+(?=\sis\b) è¡¨ç¤ºè¦æ•è·isä¹‹å‰çš„å•è¯</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"\\b\\w+(?=\\sis\\b)"</span>, <span class="string">"The dog is a Malamute."</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertFalse(findAll(<span class="string">"\\b\\w+(?=\\sis\\b)"</span>, <span class="string">"The island has beautiful birds."</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertFalse(findAll(<span class="string">"\\b\\w+(?=\\sis\\b)"</span>, <span class="string">"The pitch missed home plate."</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"\\b\\w+(?=\\sis\\b)"</span>, <span class="string">"Sunday is a weekend day."</span>) &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>è¾“å‡º</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line">regex = <span class="symbol">\b</span><span class="symbol">\w</span>+(?=<span class="symbol">\s</span>is<span class="symbol">\b</span>), content: The dog is a Malamute.</span><br><span class="line">[1th] start: 4, end: 7, group: dog</span><br><span class="line">regex = <span class="symbol">\b</span><span class="symbol">\w</span>+(?=<span class="symbol">\s</span>is<span class="symbol">\b</span>), content: The island has beautiful birds.</span><br><span class="line">not found</span><br><span class="line">regex = <span class="symbol">\b</span><span class="symbol">\w</span>+(?=<span class="symbol">\s</span>is<span class="symbol">\b</span>), content: The pitch missed home plate.</span><br><span class="line">not found</span><br><span class="line">regex = <span class="symbol">\b</span><span class="symbol">\w</span>+(?=<span class="symbol">\s</span>is<span class="symbol">\b</span>), content: Sunday is a weekend day.</span><br><span class="line">[1th] start: 0, end: 6, group: Sunday</span><br></pre></td></tr></table></figure>
<p><strong>è¯´æ˜</strong></p>
<p>\b: åœ¨å•è¯è¾¹ç•Œå¤„å¼€å§‹åŒ¹é…ã€‚</p>
<p>\w+: åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯å­—ç¬¦ã€‚</p>
<p>(?=\sis\b): ç¡®å®šå•è¯å­—ç¬¦æ˜¯å¦åæ¥ç©ºç™½å­—ç¬¦å’Œå­—ç¬¦ä¸²â€œisâ€ï¼Œå…¶åœ¨å•è¯è¾¹ç•Œå¤„ç»“æŸã€‚ å¦‚æœå¦‚æ­¤ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚</p>
<h3 id="åŒ¹é…-exp-åé¢çš„ä½ç½®"><a class="markdownIt-Anchor" href="#åŒ¹é…-exp-åé¢çš„ä½ç½®"></a> åŒ¹é… exp åé¢çš„ä½ç½®</h3>
<p><code>(?&lt;=exp)</code> è¡¨ç¤ºå­è¡¨è¾¾å¼ä¸å¾—åœ¨è¾“å…¥å­—ç¬¦ä¸²å½“å‰ä½ç½®å·¦ä¾§å‡ºç°ï¼Œå°½ç®¡å­è¡¨è¾¾å¼æœªåŒ…å«åœ¨åŒ¹é…ç»“æœä¸­ã€‚é›¶å®½åº¦æ­£å›é¡¾åå‘æ–­è¨€ä¸ä¼šå›æº¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// (?&lt;=\b20)\d&#123;2&#125;\b è¡¨ç¤ºè¦æ•è·ä»¥20å¼€å¤´çš„æ•°å­—çš„åé¢éƒ¨åˆ†</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"(?&lt;=\\b20)\\d&#123;2&#125;\\b"</span>, <span class="string">"2010 1999 1861 2140 2009"</span>) &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>è¾“å‡º</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">(?&lt;=\b20)\d&#123;2&#125;\b,</span> <span class="attr">content:</span> <span class="number">2010</span> <span class="number">1999</span> <span class="number">1861</span> <span class="number">2140</span> <span class="number">2009</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">2</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">4</span><span class="string">,</span> <span class="attr">group:</span> <span class="number">10</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">22</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">24</span><span class="string">,</span> <span class="attr">group:</span> <span class="number">09</span></span><br></pre></td></tr></table></figure>
<p><strong>è¯´æ˜</strong></p>
<p>\d{2}: åŒ¹é…ä¸¤ä¸ªåè¿›åˆ¶æ•°å­—ã€‚</p>
<p>{?&lt;=\b20): å¦‚æœä¸¤ä¸ªåè¿›åˆ¶æ•°å­—çš„å­—è¾¹ç•Œä»¥å°æ•°ä½æ•°â€œ20â€å¼€å¤´ï¼Œåˆ™ç»§ç»­åŒ¹é…ã€‚</p>
<p>\b: åœ¨å•è¯è¾¹ç•Œå¤„ç»“æŸåŒ¹é…ã€‚</p>
<h3 id="åŒ¹é…åé¢è·Ÿçš„ä¸æ˜¯-exp-çš„ä½ç½®"><a class="markdownIt-Anchor" href="#åŒ¹é…åé¢è·Ÿçš„ä¸æ˜¯-exp-çš„ä½ç½®"></a> åŒ¹é…åé¢è·Ÿçš„ä¸æ˜¯ exp çš„ä½ç½®</h3>
<p><code>(?!exp)</code> è¡¨ç¤ºè¾“å…¥å­—ç¬¦ä¸²ä¸å¾—åŒ¹é…<em>å­è¡¨è¾¾å¼</em>ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼Œå°½ç®¡åŒ¹é…çš„å­å­—ç¬¦ä¸²æœªåŒ…å«åœ¨åŒ¹é…ç»“æœä¸­ã€‚</p>
<p><strong>ä¾‹ æ•è·æœªä»¥â€œunâ€å¼€å¤´çš„å•è¯</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// \b(?!un)\w+\b è¡¨ç¤ºè¦æ•è·æœªä»¥â€œunâ€å¼€å¤´çš„å•è¯</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"\\b(?!un)\\w+\\b"</span>, <span class="string">"unite one unethical ethics use untie ultimate"</span>) &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">\b(?!un)\w+\b,</span> <span class="attr">content:</span> <span class="string">unite</span> <span class="string">one</span> <span class="string">unethical</span> <span class="string">ethics</span> <span class="string">use</span> <span class="string">untie</span> <span class="string">ultimate</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">6</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">9</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">one</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">20</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">26</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">ethics</span></span><br><span class="line"><span class="string">[3th]</span> <span class="attr">start:</span> <span class="number">27</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">30</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">use</span></span><br><span class="line"><span class="string">[4th]</span> <span class="attr">start:</span> <span class="number">37</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">45</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">ultimate</span></span><br></pre></td></tr></table></figure>
<p><strong>è¯´æ˜</strong></p>
<p>\b: åœ¨å•è¯è¾¹ç•Œå¤„å¼€å§‹åŒ¹é…ã€‚</p>
<p>(?!un): ç¡®å®šæ¥ä¸‹æ¥çš„ä¸¤ä¸ªçš„å­—ç¬¦æ˜¯å¦ä¸ºâ€œunâ€ã€‚ å¦‚æœæ²¡æœ‰ï¼Œåˆ™å¯èƒ½åŒ¹é…ã€‚</p>
<p>\w+: åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯å­—ç¬¦ã€‚</p>
<p>\b: åœ¨å•è¯è¾¹ç•Œå¤„ç»“æŸåŒ¹é…ã€‚</p>
<h3 id="åŒ¹é…å‰é¢ä¸æ˜¯-exp-çš„ä½ç½®"><a class="markdownIt-Anchor" href="#åŒ¹é…å‰é¢ä¸æ˜¯-exp-çš„ä½ç½®"></a> åŒ¹é…å‰é¢ä¸æ˜¯ exp çš„ä½ç½®</h3>
<p><code>(?&lt;!exp)</code> è¡¨ç¤ºå­è¡¨è¾¾å¼ä¸å¾—åœ¨è¾“å…¥å­—ç¬¦ä¸²å½“å‰ä½ç½®çš„å·¦ä¾§å‡ºç°ã€‚ ä½†æ˜¯ï¼Œä»»ä½•ä¸åŒ¹é…å­è¡¨è¾¾å¼ çš„å­å­—ç¬¦ä¸²ä¸åŒ…å«åœ¨åŒ¹é…ç»“æœä¸­ã€‚</p>
<p><strong>ä¾‹ æ•è·ä»»æ„å·¥ä½œæ—¥</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// (?&lt;!(Saturday|Sunday) )\b\w+ \d&#123;1,2&#125;, \d&#123;4&#125;\b è¡¨ç¤ºè¦æ•è·ä»»æ„å·¥ä½œæ—¥ï¼ˆå³å‘¨ä¸€åˆ°å‘¨äº”ï¼‰</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"(?&lt;!(Saturday|Sunday) )\\b\\w+ \\d&#123;1,2&#125;, \\d&#123;4&#125;\\b"</span>, <span class="string">"Monday February 1, 2010"</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"(?&lt;!(Saturday|Sunday) )\\b\\w+ \\d&#123;1,2&#125;, \\d&#123;4&#125;\\b"</span>, <span class="string">"Wednesday February 3, 2010"</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertFalse(findAll(<span class="string">"(?&lt;!(Saturday|Sunday) )\\b\\w+ \\d&#123;1,2&#125;, \\d&#123;4&#125;\\b"</span>, <span class="string">"Saturday February 6, 2010"</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertFalse(findAll(<span class="string">"(?&lt;!(Saturday|Sunday) )\\b\\w+ \\d&#123;1,2&#125;, \\d&#123;4&#125;\\b"</span>, <span class="string">"Sunday February 7, 2010"</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"(?&lt;!(Saturday|Sunday) )\\b\\w+ \\d&#123;1,2&#125;, \\d&#123;4&#125;\\b"</span>, <span class="string">"Monday, February 8, 2010"</span>) &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">regex = (?&lt;!(Saturday|Sunday) )\b\w+ \d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;, \d&#123;<span class="number">4</span>&#125;\b, content: Monday February <span class="number">1</span>, <span class="number">2010</span></span><br><span class="line">[<span class="number">1</span>th] start: <span class="number">7</span>, end: <span class="number">23</span>, group: February <span class="number">1</span>, <span class="number">2010</span></span><br><span class="line">regex = (?&lt;!(Saturday|Sunday) )\b\w+ \d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;, \d&#123;<span class="number">4</span>&#125;\b, content: Wednesday February <span class="number">3</span>, <span class="number">2010</span></span><br><span class="line">[<span class="number">1</span>th] start: <span class="number">10</span>, end: <span class="number">26</span>, group: February <span class="number">3</span>, <span class="number">2010</span></span><br><span class="line">regex = (?&lt;!(Saturday|Sunday) )\b\w+ \d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;, \d&#123;<span class="number">4</span>&#125;\b, content: Saturday February <span class="number">6</span>, <span class="number">2010</span></span><br><span class="line"><span class="keyword">not</span> found</span><br><span class="line">regex = (?&lt;!(Saturday|Sunday) )\b\w+ \d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;, \d&#123;<span class="number">4</span>&#125;\b, content: Sunday February <span class="number">7</span>, <span class="number">2010</span></span><br><span class="line"><span class="keyword">not</span> found</span><br><span class="line">regex = (?&lt;!(Saturday|Sunday) )\b\w+ \d&#123;<span class="number">1</span>,<span class="number">2</span>&#125;, \d&#123;<span class="number">4</span>&#125;\b, content: Monday, February <span class="number">8</span>, <span class="number">2010</span></span><br><span class="line">[<span class="number">1</span>th] start: <span class="number">8</span>, end: <span class="number">24</span>, group: February <span class="number">8</span>, <span class="number">2010</span></span><br></pre></td></tr></table></figure>
<h2 id="è´ªå©ªä¸æ‡’æƒ°"><a class="markdownIt-Anchor" href="#è´ªå©ªä¸æ‡’æƒ°"></a> è´ªå©ªä¸æ‡’æƒ°</h2>
<p>å½“æ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ…å«èƒ½æ¥å—é‡å¤çš„é™å®šç¬¦æ—¶ï¼Œé€šå¸¸çš„è¡Œä¸ºæ˜¯ï¼ˆåœ¨ä½¿æ•´ä¸ªè¡¨è¾¾å¼èƒ½å¾—åˆ°åŒ¹é…çš„å‰æä¸‹ï¼‰åŒ¹é…<strong>å°½å¯èƒ½å¤š</strong>çš„å­—ç¬¦ã€‚ä»¥è¿™ä¸ªè¡¨è¾¾å¼ä¸ºä¾‹ï¼ša.*bï¼Œå®ƒå°†ä¼šåŒ¹é…æœ€é•¿çš„ä»¥ a å¼€å§‹ï¼Œä»¥ b ç»“æŸçš„å­—ç¬¦ä¸²ã€‚å¦‚æœç”¨å®ƒæ¥æœç´¢ aabab çš„è¯ï¼Œå®ƒä¼šåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸² aababã€‚è¿™è¢«ç§°ä¸ºè´ªå©ªåŒ¹é…ã€‚</p>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬æ›´éœ€è¦æ‡’æƒ°åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯åŒ¹é…<strong>å°½å¯èƒ½å°‘</strong>çš„å­—ç¬¦ã€‚å‰é¢ç»™å‡ºçš„é™å®šç¬¦éƒ½å¯ä»¥è¢«è½¬åŒ–ä¸ºæ‡’æƒ°åŒ¹é…æ¨¡å¼ï¼Œåªè¦åœ¨å®ƒåé¢åŠ ä¸Šä¸€ä¸ªé—®å·?ã€‚è¿™æ ·.*?å°±æ„å‘³ç€åŒ¹é…ä»»æ„æ•°é‡çš„é‡å¤ï¼Œä½†æ˜¯åœ¨èƒ½ä½¿æ•´ä¸ªåŒ¹é…æˆåŠŸçš„å‰æä¸‹ä½¿ç”¨æœ€å°‘çš„é‡å¤ã€‚</p>
<table>
<thead>
<tr>
<th>è¡¨è¾¾å¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*?</code></td>
<td>é‡å¤ä»»æ„æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td>
</tr>
<tr>
<td><code>+?</code></td>
<td>é‡å¤ 1 æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td>
</tr>
<tr>
<td><code>??</code></td>
<td>é‡å¤ 0 æ¬¡æˆ– 1 æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td>
</tr>
<tr>
<td><code>{n,m}?</code></td>
<td>é‡å¤ n åˆ° m æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td>
</tr>
<tr>
<td><code>{n,}?</code></td>
<td>é‡å¤ n æ¬¡ä»¥ä¸Šï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</td>
</tr>
</tbody>
</table>
<p><strong>ä¾‹ Java æ­£åˆ™ä¸­è´ªå©ªä¸æ‡’æƒ°çš„ç¤ºä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è´ªå©ªåŒ¹é…</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"a\\w*b"</span>, <span class="string">"abaabaaabaaaab"</span>) &gt; <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‡’æƒ°åŒ¹é…</span></span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"a\\w*?b"</span>, <span class="string">"abaabaaabaaaab"</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"a\\w+?b"</span>, <span class="string">"abaabaaabaaaab"</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"a\\w??b"</span>, <span class="string">"abaabaaabaaaab"</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"a\\w&#123;0,4&#125;?b"</span>, <span class="string">"abaabaaabaaaab"</span>) &gt; <span class="number">0</span>);</span><br><span class="line">Assert.assertTrue(findAll(<span class="string">"a\\w&#123;3,&#125;?b"</span>, <span class="string">"abaabaaabaaaab"</span>) &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p><strong>è¾“å‡º</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">a\w*b,</span> <span class="attr">content:</span> <span class="string">abaabaaabaaaab</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">0</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">14</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">abaabaaabaaaab</span></span><br><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">a\w*?b,</span> <span class="attr">content:</span> <span class="string">abaabaaabaaaab</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">0</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">2</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">ab</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">2</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aab</span></span><br><span class="line"><span class="string">[3th]</span> <span class="attr">start:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">9</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aaab</span></span><br><span class="line"><span class="string">[4th]</span> <span class="attr">start:</span> <span class="number">9</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">14</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aaaab</span></span><br><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">a\w+?b,</span> <span class="attr">content:</span> <span class="string">abaabaaabaaaab</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">0</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">abaab</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">9</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aaab</span></span><br><span class="line"><span class="string">[3th]</span> <span class="attr">start:</span> <span class="number">9</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">14</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aaaab</span></span><br><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">a\w??b,</span> <span class="attr">content:</span> <span class="string">abaabaaabaaaab</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">0</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">2</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">ab</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">2</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aab</span></span><br><span class="line"><span class="string">[3th]</span> <span class="attr">start:</span> <span class="number">6</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">9</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aab</span></span><br><span class="line"><span class="string">[4th]</span> <span class="attr">start:</span> <span class="number">11</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">14</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aab</span></span><br><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">a\w&#123;0,4&#125;?b,</span> <span class="attr">content:</span> <span class="string">abaabaaabaaaab</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">0</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">2</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">ab</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">2</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aab</span></span><br><span class="line"><span class="string">[3th]</span> <span class="attr">start:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">9</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aaab</span></span><br><span class="line"><span class="string">[4th]</span> <span class="attr">start:</span> <span class="number">9</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">14</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aaaab</span></span><br><span class="line"><span class="string">regex</span> <span class="string">=</span> <span class="string">a\w&#123;3,&#125;?b,</span> <span class="attr">content:</span> <span class="string">abaabaaabaaaab</span></span><br><span class="line"><span class="string">[1th]</span> <span class="attr">start:</span> <span class="number">0</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">abaab</span></span><br><span class="line"><span class="string">[2th]</span> <span class="attr">start:</span> <span class="number">5</span><span class="string">,</span> <span class="attr">end:</span> <span class="number">14</span><span class="string">,</span> <span class="attr">group:</span> <span class="string">aaabaaaab</span></span><br></pre></td></tr></table></figure>
<p><strong>è¯´æ˜</strong></p>
<p>æœ¬ä¾‹ä¸­ä»£ç å±•ç¤ºçš„æ˜¯ä½¿ç”¨ä¸åŒè´ªå©ªæˆ–æ‡’æƒ°ç­–ç•¥å»æŸ¥æ‰¾å­—ç¬¦ä¸²&quot;abaabaaabaaaab&quot; ä¸­åŒ¹é…<strong>ä»¥&quot;a&quot;å¼€å¤´ï¼Œä»¥&quot;b&quot;ç»“å°¾çš„æ‰€æœ‰å­å­—ç¬¦ä¸²</strong>ã€‚</p>
<p>è¯·ä»è¾“å‡ºç»“æœä¸­ï¼Œç»†ç»†ä½“å‘³ä½¿ç”¨ä¸åŒçš„è´ªå©ªæˆ–æ‡’æƒ°ç­–ç•¥ï¼Œå¯¹äºåŒ¹é…å­å­—ç¬¦ä¸²æœ‰ä»€ä¹ˆå½±å“ã€‚</p>
<h2 id="æœ€å®ç”¨çš„æ­£åˆ™"><a class="markdownIt-Anchor" href="#æœ€å®ç”¨çš„æ­£åˆ™"></a> æœ€å®ç”¨çš„æ­£åˆ™</h2>
<h3 id="æ ¡éªŒä¸­æ–‡"><a class="markdownIt-Anchor" href="#æ ¡éªŒä¸­æ–‡"></a> æ ¡éªŒä¸­æ–‡</h3>
<p>**æè¿°ï¼š**æ ¡éªŒå­—ç¬¦ä¸²ä¸­åªèƒ½æœ‰ä¸­æ–‡å­—ç¬¦ï¼ˆä¸åŒ…æ‹¬ä¸­æ–‡æ ‡ç‚¹ç¬¦å·ï¼‰ã€‚ä¸­æ–‡å­—ç¬¦çš„ Unicode ç¼–ç èŒƒå›´æ˜¯\u4e00 åˆ° \u9fa5ã€‚</p>
<p>å¦‚æœ‰å…´è¶£ï¼Œå¯ä»¥å‚è€ƒ<a href="http://baike.baidu.com/link?url=3xi0vmvCIGKQLJZdn_BYhQ1IDFsoSJMrya6_eOjCBb7A6cRIW-zhZFLC9Yh8wjxU6A_HCfNuP8FBBXU9CN3Wcq" target="_blank" rel="noopener"><strong><em>ç™¾åº¦ç™¾ç§‘-Unicode</em></strong></a> ã€‚</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line">^[<span class="symbol">\u</span>4e00-<span class="symbol">\u</span>9fa5]+$</span><br></pre></td></tr></table></figure>
<p><strong>åŒ¹é…ï¼š</strong> æ˜¥çœ ä¸è§‰æ™“</p>
<p>**ä¸åŒ¹é…ï¼š**æ˜¥çœ ä¸è§‰æ™“ï¼Œ</p>
<h3 id="æ ¡éªŒèº«ä»½è¯å·ç "><a class="markdownIt-Anchor" href="#æ ¡éªŒèº«ä»½è¯å·ç "></a> æ ¡éªŒèº«ä»½è¯å·ç </h3>
<p>**æè¿°ï¼š**èº«ä»½è¯ä¸º 15 ä½æˆ– 18 ä½ã€‚15 ä½æ˜¯ç¬¬ä¸€ä»£èº«ä»½è¯ã€‚ä» 1999 å¹´ 10 æœˆ 1 æ—¥èµ·ï¼Œå…¨å›½å®è¡Œå…¬æ°‘èº«ä»½è¯å·ç åˆ¶åº¦ï¼Œå±…æ°‘èº«ä»½è¯ç¼–å·ç”±åŸ 15 ä½å‡è‡³ 18 ä½ã€‚</p>
<p><strong>15 ä½èº«ä»½è¯</strong></p>
<p>**æè¿°ï¼š**ç”± 15 ä½æ•°å­—ç»„æˆã€‚æ’åˆ—é¡ºåºä»å·¦è‡³å³ä¾æ¬¡ä¸ºï¼šå…­ä½æ•°å­—åœ°åŒºç ï¼›å…­ä½æ•°å­—å‡ºç”Ÿæ—¥æœŸï¼›ä¸‰ä½é¡ºåºå·ï¼Œå…¶ä¸­ 15 ä½ç”·ä¸ºå•æ•°ï¼Œå¥³ä¸ºåŒæ•°ã€‚</p>
<p><strong>18 ä½èº«ä»½è¯</strong></p>
<p>**æè¿°ï¼š**ç”±åä¸ƒä½æ•°å­—æœ¬ä½“ç å’Œä¸€ä½æ•°å­—æ ¡éªŒç ç»„æˆã€‚æ’åˆ—é¡ºåºä»å·¦è‡³å³ä¾æ¬¡ä¸ºï¼šå…­ä½æ•°å­—åœ°åŒºç ï¼›å…«ä½æ•°å­—å‡ºç”Ÿæ—¥æœŸï¼›ä¸‰ä½æ•°å­—é¡ºåºç å’Œä¸€ä½æ•°å­—æ ¡éªŒç ï¼ˆä¹Ÿå¯èƒ½æ˜¯ Xï¼‰ã€‚</p>
<p>èº«ä»½è¯å·å«ä¹‰è¯¦æƒ…è¯·è§ï¼š<a href="http://baike.baidu.com/link?url=5mYlYNE0RsSe2D4tydajtiaR8hAm4pPZ0FHSPuQ05N4f6H-i7qPuw7sY5KfNuiOVJWVWZvU4gf3IY-vIcKdP1CU4Fv-9pKmFQB50qGv_hZT2dkGbkd9--8_saY7omV80vEw9ixVeEwda37fHswfmtyU4QSiBG5s3K5K-JnYr1dqNlPu0f3t008UcLh5-wyID" target="_blank" rel="noopener"><strong><em>ç™¾åº¦ç™¾ç§‘-å±…æ°‘èº«ä»½è¯å·ç </em></strong></a></p>
<p><strong>åœ°åŒºç ï¼ˆ6 ä½ï¼‰</strong></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">(<span class="number">1</span>[<span class="number">1</span><span class="number">-5</span>]|<span class="number">2</span>[<span class="number">1</span><span class="number">-3</span>]|<span class="number">3</span>[<span class="number">1</span><span class="number">-7</span>]|<span class="number">4</span>[<span class="number">1</span><span class="number">-3</span>]|<span class="number">5</span>[<span class="number">0</span><span class="number">-4</span>]|<span class="number">6</span>[<span class="number">1</span><span class="number">-5</span>])\d&#123;<span class="number">4</span>&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å‡ºç”Ÿæ—¥æœŸï¼ˆ8 ä½ï¼‰</strong></p>
<p>æ³¨ï¼šä¸‹é¢çš„æ˜¯ 18 ä½èº«ä»½è¯çš„æœ‰æ•ˆå‡ºç”Ÿæ—¥æœŸï¼Œå¦‚æœæ˜¯ 15 ä½èº«ä»½è¯ï¼Œåªè¦å°†ç¬¬ä¸€ä¸ª\d{4}æ”¹ä¸º\d{2}å³å¯ã€‚</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">((\d&#123;4&#125;((0[<span class="string">13578</span>]|1[<span class="string">02</span>])(0[<span class="string">1-9</span>]|[<span class="string">12</span>]\d|3[<span class="string">01</span>])|(0[<span class="string">13456789</span>]|1[<span class="string">012</span>])(0[<span class="string">1-9</span>]|[<span class="string">12</span>]\d|30)|02(0[<span class="string">1-9</span>]|1\d|2[<span class="string">0-8</span>])))|([<span class="string">02468</span>][<span class="symbol">048</span>]|[<span class="string">13579</span>][<span class="symbol">26</span>])0229)</span><br></pre></td></tr></table></figure>
<p><strong>15 ä½æœ‰æ•ˆèº«ä»½è¯</strong></p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">^((1[<span class="string">1-5</span>]|2[<span class="string">1-3</span>]|3[<span class="string">1-7</span>]|4[<span class="string">1-3</span>]|5[<span class="string">0-4</span>]|6[<span class="string">1-5</span>])\d&#123;4&#125;)((\d&#123;2&#125;((0[<span class="string">13578</span>]|1[<span class="string">02</span>])(0[<span class="string">1-9</span>]|[<span class="string">12</span>]\d|3[<span class="string">01</span>])|(0[<span class="string">13456789</span>]|1[<span class="string">012</span>])(0[<span class="string">1-9</span>]|[<span class="string">12</span>]\d|30)|02(0[<span class="string">1-9</span>]|1\d|2[<span class="string">0-8</span>])))|([<span class="string">02468</span>][<span class="symbol">048</span>]|[<span class="string">13579</span>][<span class="symbol">26</span>])0229)(\d&#123;3&#125;)$</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**110001700101031</p>
<p>**ä¸åŒ¹é…ï¼š**110001701501031</p>
<p><strong>18 ä½æœ‰æ•ˆèº«ä»½è¯</strong></p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">^((1[<span class="string">1-5</span>]|2[<span class="string">1-3</span>]|3[<span class="string">1-7</span>]|4[<span class="string">1-3</span>]|5[<span class="string">0-4</span>]|6[<span class="string">1-5</span>])\d&#123;4&#125;)((\d&#123;4&#125;((0[<span class="string">13578</span>]|1[<span class="string">02</span>])(0[<span class="string">1-9</span>]|[<span class="string">12</span>]\d|3[<span class="string">01</span>])|(0[<span class="string">13456789</span>]|1[<span class="string">012</span>])(0[<span class="string">1-9</span>]|[<span class="string">12</span>]\d|30)|02(0[<span class="string">1-9</span>]|1\d|2[<span class="string">0-8</span>])))|([<span class="string">02468</span>][<span class="symbol">048</span>]|[<span class="string">13579</span>][<span class="symbol">26</span>])0229)(\d&#123;3&#125;(\d|X))$</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**110001199001010310 | 11000019900101015X</p>
<p>**ä¸åŒ¹é…ï¼š**990000199001010310 | 110001199013010310</p>
<h3 id="æ ¡éªŒæœ‰æ•ˆç”¨æˆ·å-å¯†ç "><a class="markdownIt-Anchor" href="#æ ¡éªŒæœ‰æ•ˆç”¨æˆ·å-å¯†ç "></a> æ ¡éªŒæœ‰æ•ˆç”¨æˆ·åã€å¯†ç </h3>
<p>**æè¿°ï¼š**é•¿åº¦ä¸º 6-18 ä¸ªå­—ç¬¦ï¼Œå…è®¸è¾“å…¥å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œé¦–å­—ç¬¦å¿…é¡»ä¸ºå­—æ¯ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">^[a-zA-Z]\w&#123;<span class="number">5</span>,<span class="number">17</span>&#125;$</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**he_llo@worl.d.com | <a href="mailto:hel.l-o@wor-ld.museum" target="_blank" rel="noopener">hel.l-o@wor-ld.museum</a> | <a href="mailto:h1ello@123.com" target="_blank" rel="noopener">h1ello@123.com</a></p>
<p>**ä¸åŒ¹é…ï¼š**hello@worl_d.com | he&amp;llo@world.co1 | .hello@wor#.co.uk</p>
<h3 id="æ ¡éªŒé‚®ç®±"><a class="markdownIt-Anchor" href="#æ ¡éªŒé‚®ç®±"></a> æ ¡éªŒé‚®ç®±</h3>
<p>**æè¿°ï¼š**ä¸å…è®¸ä½¿ç”¨ IP ä½œä¸ºåŸŸåï¼Œå¦‚ : <a href="mailto:hello@154.145.68.12" target="_blank" rel="noopener">hello@154.145.68.12</a></p>
<p><code>@</code>ç¬¦å·å‰çš„é‚®ç®±ç”¨æˆ·å’Œ<code>.</code>ç¬¦å·å‰çš„åŸŸå(domain)å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>å­—ç¬¦åªèƒ½æ˜¯è‹±æ–‡å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿<code>_</code>ã€<code>.</code>ã€<code>-</code> ï¼›</li>
<li>é¦–å­—ç¬¦å¿…é¡»ä¸ºå­—æ¯æˆ–æ•°å­—ï¼›</li>
<li><code>_</code>ã€<code>.</code>ã€<code>-</code> ä¸èƒ½è¿ç»­å‡ºç°ã€‚</li>
</ul>
<p>åŸŸåçš„æ ¹åŸŸåªèƒ½ä¸ºå­—æ¯ï¼Œä¸”è‡³å°‘ä¸ºä¸¤ä¸ªå­—ç¬¦ã€‚</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">^[<span class="string">A-Za-z0-9</span>](<span class="link">([_\.\-]?[a-zA-Z0-9]+</span>)<span class="emphasis">*)@([A-Za-z0-9]+)(([\.\-]?[a-zA-Z0-9]+)*</span>)\.([A-Za-z]&#123;2,&#125;)$</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**he_llo@worl.d.com | <a href="mailto:hel.l-o@wor-ld.museum" target="_blank" rel="noopener">hel.l-o@wor-ld.museum</a> | <a href="mailto:h1ello@123.com" target="_blank" rel="noopener">h1ello@123.com</a></p>
<p>**ä¸åŒ¹é…ï¼š**hello@worl_d.com | he&amp;llo@world.co1 | .hello@wor#.co.uk</p>
<h3 id="æ ¡éªŒ-url"><a class="markdownIt-Anchor" href="#æ ¡éªŒ-url"></a> æ ¡éªŒ URL</h3>
<p>**æè¿°ï¼š**æ ¡éªŒ URLã€‚æ”¯æŒ httpã€httpsã€ftpã€ftpsã€‚</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">^<span class="comment">(ht|f)</span><span class="comment">(tp|tps)</span>\:<span class="comment">//[a-zA-Z0-9\-\.]+\.([a-zA-Z]&#123;2,3&#125;)?(/\S*)?$</span></span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**<a href="http://google.com/help/me" target="_blank" rel="noopener">http://google.com/help/me</a> | <a href="http://www.google.com/help/me/" target="_blank" rel="noopener">http://www.google.com/help/me/</a> | <a href="https://www.google.com/help.asp" target="_blank" rel="noopener">https://www.google.com/help.asp</a> | <a href="ftp://www.google.com" target="_blank" rel="noopener">ftp://www.google.com</a> | ftps://google.org</p>
<p>**ä¸åŒ¹é…ï¼š**<a href="http://un/www.google.com/index.asp" target="_blank" rel="noopener">http://un/www.google.com/index.asp</a></p>
<h3 id="æ ¡éªŒæ—¶é—´"><a class="markdownIt-Anchor" href="#æ ¡éªŒæ—¶é—´"></a> æ ¡éªŒæ—¶é—´</h3>
<p>**æè¿°ï¼š**æ ¡éªŒæ—¶é—´ã€‚æ—¶ã€åˆ†ã€ç§’å¿…é¡»æ˜¯æœ‰æ•ˆæ•°å­—ï¼Œå¦‚æœæ•°å€¼ä¸æ˜¯ä¸¤ä½æ•°ï¼Œåä½éœ€è¦è¡¥é›¶ã€‚</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">^([<span class="string">0-1</span>][<span class="symbol">0-9</span>]|[<span class="string">2</span>][<span class="symbol">0-3</span>]):([<span class="string">0-5</span>][<span class="symbol">0-9</span>])$</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**00:00:00 | 23:59:59 | 17:06:30</p>
<p>**ä¸åŒ¹é…ï¼š**17:6:30 | 24:16:30</p>
<h3 id="æ ¡éªŒæ—¥æœŸ"><a class="markdownIt-Anchor" href="#æ ¡éªŒæ—¥æœŸ"></a> æ ¡éªŒæ—¥æœŸ</h3>
<p>**æè¿°ï¼š**æ ¡éªŒæ—¥æœŸã€‚æ—¥æœŸæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>æ ¼å¼ yyyy-MM-dd æˆ– yyyy-M-d</li>
<li>è¿å­—ç¬¦å¯ä»¥æ²¡æœ‰æˆ–æ˜¯â€œ-â€ã€â€œ/â€ã€â€œ.â€ä¹‹ä¸€</li>
<li>é—°å¹´çš„äºŒæœˆå¯ä»¥æœ‰ 29 æ—¥ï¼›è€Œå¹³å¹´ä¸å¯ä»¥ã€‚</li>
<li>ä¸€ã€ä¸‰ã€äº”ã€ä¸ƒã€å…«ã€åã€åäºŒæœˆä¸º 31 æ—¥ã€‚å››ã€å…­ã€ä¹ã€åä¸€æœˆä¸º 30 æ—¥ã€‚</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">^(?:(?!0000)[<span class="string">0-9</span>]&#123;4&#125;([<span class="string">-/.</span>]?)(?:(?:0?[<span class="string">1-9</span>]|1[<span class="string">0-2</span>])\1(?:0?[<span class="string">1-9</span>]|1[<span class="string">0-9</span>]|2[<span class="string">0-8</span>])|(?:0?[<span class="string">13-9</span>]|1[<span class="string">0-2</span>])\1(?:29|30)|(?:0?[<span class="string">13578</span>]|1[<span class="string">02</span>])\1(?:31))|(?:[<span class="string">0-9</span>]&#123;2&#125;(?:0[<span class="string">48</span>]|[<span class="string">2468</span>][<span class="symbol">048</span>]|[<span class="string">13579</span>][<span class="symbol">26</span>])|(?:0[<span class="string">48</span>]|[<span class="string">2468</span>][<span class="symbol">048</span>]|[<span class="string">13579</span>][<span class="symbol">26</span>])00)([-/.]?)0?2\2(?:29))$</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**2016/1/1 | 2016/01/01 | 20160101 | 2016-01-01 | 2016.01.01 | 2000-02-29</p>
<p>**ä¸åŒ¹é…ï¼š**2001-02-29 | 2016/12/32 | 2016/6/31 | 2016/13/1 | 2016/0/1</p>
<h3 id="æ ¡éªŒä¸­å›½æ‰‹æœºå·ç "><a class="markdownIt-Anchor" href="#æ ¡éªŒä¸­å›½æ‰‹æœºå·ç "></a> æ ¡éªŒä¸­å›½æ‰‹æœºå·ç </h3>
<p>**æè¿°ï¼š**ä¸­å›½æ‰‹æœºå·ç æ­£ç¡®æ ¼å¼ï¼š11 ä½æ•°å­—ã€‚</p>
<p>ç§»åŠ¨æœ‰ 16 ä¸ªå·æ®µï¼š134ã€135ã€136ã€137ã€138ã€139ã€147ã€150ã€151ã€152ã€157ã€158ã€159ã€182ã€187ã€188ã€‚å…¶ä¸­ 147ã€157ã€188 æ˜¯ 3G å·æ®µï¼Œå…¶ä»–éƒ½æ˜¯ 2G å·æ®µã€‚è”é€šæœ‰ 7 ç§å·æ®µï¼š130ã€131ã€132ã€155ã€156ã€185ã€186ã€‚å…¶ä¸­ 186 æ˜¯ 3Gï¼ˆWCDMAï¼‰å·æ®µï¼Œå…¶ä½™ä¸º 2G å·æ®µã€‚ç”µä¿¡æœ‰ 4 ä¸ªå·æ®µï¼š133ã€153ã€180ã€189ã€‚å…¶ä¸­ 189 æ˜¯ 3G å·æ®µï¼ˆCDMA2000ï¼‰ï¼Œ133 å·æ®µä¸»è¦ç”¨ä½œæ— çº¿ç½‘å¡å·ã€‚æ€»ç»“ï¼š13 å¼€å¤´æ‰‹æœºå· 0-9ï¼›15 å¼€å¤´æ‰‹æœºå· 0-3ã€5-9ï¼›18 å¼€å¤´æ‰‹æœºå· 0ã€2ã€5-9ã€‚</p>
<p>æ­¤å¤–ï¼Œä¸­å›½åœ¨å›½é™…ä¸Šçš„åŒºå·ä¸º 86ï¼Œæ‰€ä»¥æ‰‹æœºå·å¼€å¤´æœ‰+86ã€86 ä¹Ÿæ˜¯åˆæ³•çš„ã€‚</p>
<p>ä»¥ä¸Šä¿¡æ¯æ¥æºäº <a href="http://baike.baidu.com/link?url=Bia2K_f8rGcakOlP4d9m_-DNSgXU5-0NDP0pPavS0ZbhRHQcUFUTbMERjdO4u7cvkpTJaIDeUXq_EXWnMqXMdSuMQDX3NAbZXAlZYl_V18KATWF7y1EFzUyJ62rf3bAN" target="_blank" rel="noopener"><strong><em>ç™¾åº¦ç™¾ç§‘-æ‰‹æœºå·</em></strong></a></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">^((\+)?<span class="number">86</span>\s*)?((<span class="number">13</span>[<span class="number">0</span><span class="number">-9</span>])|(<span class="number">15</span>([<span class="number">0</span><span class="number">-3</span>]|[<span class="number">5</span><span class="number">-9</span>]))|(<span class="number">18</span>[<span class="number">0</span>,<span class="number">2</span>,<span class="number">5</span><span class="number">-9</span>]))\d&#123;<span class="number">8</span>&#125;$</span><br></pre></td></tr></table></figure>
<p><strong>åŒ¹é…ï¼š</strong>+86 18012345678 | 86 18012345678 | 15812345678</p>
<p>**ä¸åŒ¹é…ï¼š**15412345678 | 12912345678 | 180123456789</p>
<h3 id="æ ¡éªŒä¸­å›½å›ºè¯å·ç "><a class="markdownIt-Anchor" href="#æ ¡éªŒä¸­å›½å›ºè¯å·ç "></a> æ ¡éªŒä¸­å›½å›ºè¯å·ç </h3>
<p>**æè¿°ï¼š**å›ºè¯å·ç ï¼Œå¿…é¡»åŠ åŒºå·ï¼ˆä»¥ 0 å¼€å¤´ï¼‰ã€‚<br />
3 ä½æœ‰æ•ˆåŒºå·ï¼š010ã€020~029ï¼Œå›ºè¯ä½æ•°ä¸º 8 ä½ã€‚<br />
4 ä½æœ‰æ•ˆåŒºå·ï¼š03xx å¼€å¤´åˆ° 09xxï¼Œå›ºè¯ä½æ•°ä¸º 7ã€‚</p>
<p>å¦‚æœæƒ³äº†è§£æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œè¯·å‚è€ƒ <a href="http://baike.baidu.com/link?url=sX8JoxK1ja5uM5pDYvQe27_QsyqAZ_78DLSeEvwjqtG_uXqU6p5Oh7CPbImNbnwu1ClOmD8udgDIswZfYzQIw0z3BYZO3eTplvVDzieuowTYqt7yHGDAqyT7o4vvGhg4" target="_blank" rel="noopener"><strong><em>ç™¾åº¦ç™¾ç§‘-ç”µè¯åŒºå·</em></strong></a> ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">^(<span class="number">010</span>|<span class="number">02</span>[<span class="number">0</span><span class="number">-9</span>])(\s|-)\d&#123;<span class="number">8</span>&#125;|(<span class="number">0</span>[<span class="number">3</span><span class="number">-9</span>]\d&#123;<span class="number">2</span>&#125;)(\s|-)\d&#123;<span class="number">7</span>&#125;$</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**010-12345678 | 010 12345678 | 0512-1234567 | 0512 1234567</p>
<p>**ä¸åŒ¹é…ï¼š**1234567 | 12345678</p>
<h3 id="æ ¡éªŒ-ipv4-åœ°å€"><a class="markdownIt-Anchor" href="#æ ¡éªŒ-ipv4-åœ°å€"></a> æ ¡éªŒ IPv4 åœ°å€</h3>
<p>**æè¿°ï¼š**IP åœ°å€æ˜¯ä¸€ä¸ª 32 ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œé€šå¸¸è¢«åˆ†å‰²ä¸º 4 ä¸ªâ€œ8 ä½äºŒè¿›åˆ¶æ•°â€ï¼ˆä¹Ÿå°±æ˜¯ 4 ä¸ªå­—èŠ‚ï¼‰ã€‚IP åœ°å€é€šå¸¸ç”¨â€œç‚¹åˆ†åè¿›åˆ¶â€è¡¨ç¤ºæˆï¼ˆa.b.c.dï¼‰çš„å½¢å¼ï¼Œå…¶ä¸­ï¼Œa,b,c,d éƒ½æ˜¯ 0~255 ä¹‹é—´çš„åè¿›åˆ¶æ•´æ•°ã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">^([<span class="number">01</span>]?\d\d?|<span class="number">2</span>[<span class="number">0</span><span class="number">-4</span>]\d|<span class="number">25</span>[<span class="number">0</span><span class="number">-5</span>])\.([<span class="number">01</span>]?\d\d?|<span class="number">2</span>[<span class="number">0</span><span class="number">-4</span>]\d|<span class="number">25</span>[<span class="number">0</span><span class="number">-5</span>])\.([<span class="number">01</span>]?\d\d?|<span class="number">2</span>[<span class="number">0</span><span class="number">-4</span>]\d|<span class="number">25</span>[<span class="number">0</span><span class="number">-5</span>])\.([<span class="number">01</span>]?\d\d?|<span class="number">2</span>[<span class="number">0</span><span class="number">-4</span>]\d|<span class="number">25</span>[<span class="number">0</span><span class="number">-5</span>])$</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**0.0.0.0 | 255.255.255.255 | 127.0.0.1</p>
<p>**ä¸åŒ¹é…ï¼š**10.10.10 | 10.10.10.256</p>
<h3 id="æ ¡éªŒ-ipv6-åœ°å€"><a class="markdownIt-Anchor" href="#æ ¡éªŒ-ipv6-åœ°å€"></a> æ ¡éªŒ IPv6 åœ°å€</h3>
<p>**æè¿°ï¼š**IPv6 çš„ 128 ä½åœ°å€é€šå¸¸å†™æˆ 8 ç»„ï¼Œæ¯ç»„ä¸ºå››ä¸ªåå…­è¿›åˆ¶æ•°çš„å½¢å¼ã€‚</p>
<p>IPv6 åœ°å€å¯ä»¥è¡¨ç¤ºä¸ºä»¥ä¸‹å½¢å¼ï¼š</p>
<ul>
<li>IPv6 åœ°å€</li>
<li>é›¶å‹ç¼© IPv6 åœ°å€(<a href="https://tools.ietf.org/html/rfc5952#section-2.2" target="_blank" rel="noopener">section 2.2 of rfc5952</a>)</li>
<li>å¸¦æœ‰æœ¬åœ°é“¾æ¥åŒºåŸŸç´¢å¼•çš„ IPv6 åœ°å€ (<a href="https://tools.ietf.org/html/rfc4007#section-11" target="_blank" rel="noopener">section 11 of rfc4007</a>)</li>
<li>åµŒå…¥ IPv4 çš„ IPv6 åœ°å€(<a href="https://tools.ietf.org/html/rfc6052#section-2" target="_blank" rel="noopener">section 2 of rfc6052</a></li>
<li>æ˜ å°„ IPv4 çš„ IPv6 åœ°å€ (<a href="https://tools.ietf.org/html/rfc2765#section-2.1" target="_blank" rel="noopener">section 2.1 of rfc2765</a>)</li>
<li>ç¿»è¯‘ IPv4 çš„ IPv6 åœ°å€ (<a href="https://tools.ietf.org/html/rfc2765#section-2.1" target="_blank" rel="noopener">section 2.1 of rfc2765</a>)</li>
</ul>
<p>æ˜¾ç„¶ï¼ŒIPv6 åœ°å€çš„è¡¨ç¤ºæ–¹å¼å¾ˆå¤æ‚ã€‚ä½ ä¹Ÿå¯ä»¥å‚è€ƒ</p>
<p><a href="http://baike.baidu.com/link?url=D3nmh0q_G_ZVmxXFG79mjjNfT4hs9fwjqUgygh-tvhq43KYqx88HV27WEXmoT4nA4iGzXwXMm5L-j50C2gSL5q" target="_blank" rel="noopener"><strong><em>ç™¾åº¦ç™¾ç§‘-IPv6</em></strong></a></p>
<p><a href="http://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses" target="_blank" rel="noopener"><strong><em>Stack overflow ä¸Šçš„ IPv6 æ­£åˆ™è¡¨è¾¾é«˜ç¥¨ç­”æ¡ˆ</em></strong></a></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">(([<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:)&#123;<span class="number">7</span>,<span class="number">7</span>&#125;[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;|([<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:)&#123;<span class="number">1</span>,<span class="number">7</span>&#125;:|([<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:)&#123;<span class="number">1</span>,<span class="number">6</span>&#125;:[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;|([<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:)&#123;<span class="number">1</span>,<span class="number">5</span>&#125;(:[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;)&#123;<span class="number">1</span>,<span class="number">2</span>&#125;|([<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:)&#123;<span class="number">1</span>,<span class="number">4</span>&#125;(:[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;)&#123;<span class="number">1</span>,<span class="number">3</span>&#125;|([<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:)&#123;<span class="number">1</span>,<span class="number">3</span>&#125;(:[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;)&#123;<span class="number">1</span>,<span class="number">4</span>&#125;|([<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:)&#123;<span class="number">1</span>,<span class="number">2</span>&#125;(:[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;)&#123;<span class="number">1</span>,<span class="number">5</span>&#125;|[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:((:[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;)&#123;<span class="number">1</span>,<span class="number">6</span>&#125;)|:((:[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;)&#123;<span class="number">1</span>,<span class="number">7</span>&#125;|:)|fe80:(:[<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">0</span>,<span class="number">4</span>&#125;)&#123;<span class="number">0</span>,<span class="number">4</span>&#125;%[<span class="number">0</span><span class="number">-9</span>a-zA-Z]&#123;<span class="number">1</span>,&#125;|::(ffff(:<span class="number">0</span>&#123;<span class="number">1</span>,<span class="number">4</span>&#125;)&#123;<span class="number">0</span>,<span class="number">1</span>&#125;:)&#123;<span class="number">0</span>,<span class="number">1</span>&#125;((<span class="number">25</span>[<span class="number">0</span><span class="number">-5</span>]|(<span class="number">2</span>[<span class="number">0</span><span class="number">-4</span>]|<span class="number">1</span>&#123;<span class="number">0</span>,<span class="number">1</span>&#125;[<span class="number">0</span><span class="number">-9</span>])&#123;<span class="number">0</span>,<span class="number">1</span>&#125;[<span class="number">0</span><span class="number">-9</span>])\.)&#123;<span class="number">3</span>,<span class="number">3</span>&#125;(<span class="number">25</span>[<span class="number">0</span><span class="number">-5</span>]|(<span class="number">2</span>[<span class="number">0</span><span class="number">-4</span>]|<span class="number">1</span>&#123;<span class="number">0</span>,<span class="number">1</span>&#125;[<span class="number">0</span><span class="number">-9</span>])&#123;<span class="number">0</span>,<span class="number">1</span>&#125;[<span class="number">0</span><span class="number">-9</span>])|([<span class="number">0</span><span class="number">-9</span>a-fA-F]&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:)&#123;<span class="number">1</span>,<span class="number">4</span>&#125;:((<span class="number">25</span>[<span class="number">0</span><span class="number">-5</span>]|(<span class="number">2</span>[<span class="number">0</span><span class="number">-4</span>]|<span class="number">1</span>&#123;<span class="number">0</span>,<span class="number">1</span>&#125;[<span class="number">0</span><span class="number">-9</span>])&#123;<span class="number">0</span>,<span class="number">1</span>&#125;[<span class="number">0</span><span class="number">-9</span>])\.)&#123;<span class="number">3</span>,<span class="number">3</span>&#125;(<span class="number">25</span>[<span class="number">0</span><span class="number">-5</span>]|(<span class="number">2</span>[<span class="number">0</span><span class="number">-4</span>]|<span class="number">1</span>&#123;<span class="number">0</span>,<span class="number">1</span>&#125;[<span class="number">0</span><span class="number">-9</span>])&#123;<span class="number">0</span>,<span class="number">1</span>&#125;[<span class="number">0</span><span class="number">-9</span>]))</span><br></pre></td></tr></table></figure>
<p>**åŒ¹é…ï¼š**1:2:3:4:5:6:7:8 | 1:: | 1::8 | 1::6:7:8 | 1::5:6:7:8 | 1::4:5:6:7:8 | 1::3:4:5:6:7:8 | ::2:3:4:5:6:7:8 | 1:2:3:4:5:6:7:: | 1:2:3:4:5:6::8 | 1:2:3:4:5::8 | 1:2:3:4::8 | 1:2:3::8 | 1:2::8 | 1::8 | ::8 | fe80::7:8%1 | ::255.255.255.255 | 2001:db8:3:4::192.0.2.33 | 64:ff9b::192.0.2.33</p>
<p>**ä¸åŒ¹é…ï¼š**1.2.3.4.5.6.7.8 | 1::2::3</p>
<h3 id="ç‰¹å®šå­—ç¬¦"><a class="markdownIt-Anchor" href="#ç‰¹å®šå­—ç¬¦"></a> ç‰¹å®šå­—ç¬¦</h3>
<p>åŒ¹é…é•¿åº¦ä¸º 3 çš„å­—ç¬¦ä¸²ï¼š<code>^.{3}$</code>ã€‚</p>
<p>åŒ¹é…ç”± 26 ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š<code>^[A-Za-z]+$</code>ã€‚</p>
<p>åŒ¹é…ç”± 26 ä¸ªå¤§å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š<code>^[A-Z]+$</code>ã€‚</p>
<p>åŒ¹é…ç”± 26 ä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š<code>^[a-z]+$</code>ã€‚</p>
<p>åŒ¹é…ç”±æ•°å­—å’Œ 26 ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š<code>^[A-Za-z0-9]+$</code>ã€‚</p>
<p>åŒ¹é…ç”±æ•°å­—ã€26 ä¸ªè‹±æ–‡å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼š<code>^\w+$</code>ã€‚</p>
<h3 id="ç‰¹å®šæ•°å­—"><a class="markdownIt-Anchor" href="#ç‰¹å®šæ•°å­—"></a> ç‰¹å®šæ•°å­—</h3>
<p>åŒ¹é…æ­£æ•´æ•°ï¼š<code>^[1-9]\d*$</code></p>
<p>åŒ¹é…è´Ÿæ•´æ•°ï¼š<code>^-[1-9]\d*$</code></p>
<p>åŒ¹é…æ•´æ•°ï¼š<code>^(-?[1-9]\d*)|0$</code></p>
<p>åŒ¹é…æ­£æµ®ç‚¹æ•°ï¼š<code>^[1-9]\d*\.\d+|0\.\d+$</code></p>
<p>åŒ¹é…è´Ÿæµ®ç‚¹æ•°ï¼š<code>^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$</code></p>
<p>åŒ¹é…æµ®ç‚¹æ•°ï¼š<code>^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$</code></p>
<h2 id="é€ŸæŸ¥å…ƒå­—ç¬¦å­—å…¸"><a class="markdownIt-Anchor" href="#é€ŸæŸ¥å…ƒå­—ç¬¦å­—å…¸"></a> é€ŸæŸ¥å…ƒå­—ç¬¦å­—å…¸</h2>
<p>ä¸ºäº†æ–¹ä¾¿å¿«æŸ¥æ­£åˆ™çš„å…ƒå­—ç¬¦å«ä¹‰ï¼Œåœ¨æœ¬èŠ‚æ ¹æ®å…ƒå­—ç¬¦çš„åŠŸèƒ½é›†ä¸­ç½—åˆ—æ­£åˆ™çš„å„ç§å…ƒå­—ç¬¦ã€‚</p>
<h3 id="é™å®šç¬¦"><a class="markdownIt-Anchor" href="#é™å®šç¬¦"></a> é™å®šç¬¦</h3>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚* ç­‰ä»·äº{0,}ã€‚</td>
</tr>
<tr>
<td><code>+</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€˜zo+â€™ èƒ½åŒ¹é… â€œzoâ€ ä»¥åŠ â€œzooâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œzâ€ã€‚+ ç­‰ä»·äº {1,}ã€‚</td>
</tr>
<tr>
<td><code>?</code></td>
<td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œdo(es)?â€ å¯ä»¥åŒ¹é… â€œdoâ€ æˆ– â€œdoesâ€ ä¸­çš„&quot;do&quot; ã€‚? ç­‰ä»·äº {0,1}ã€‚</td>
</tr>
<tr>
<td><code>{n}</code></td>
<td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€˜o{2}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚</td>
</tr>
<tr>
<td><code>{n,}</code></td>
<td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é… n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€˜o{2,}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ ä¸­çš„æ‰€æœ‰ oã€‚â€˜o{1,}â€™ ç­‰ä»·äº â€˜o+â€™ã€‚â€˜o{0,}â€™ åˆ™ç­‰ä»·äº â€˜o*â€™ã€‚</td>
</tr>
<tr>
<td><code>{n,m}</code></td>
<td>m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­ n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œo{1,3}â€ å°†åŒ¹é… â€œfoooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€˜o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ã€‚è¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="å®šä½ç¬¦"><a class="markdownIt-Anchor" href="#å®šä½ç¬¦"></a> å®šä½ç¬¦</h3>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>^</code></td>
<td>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²å¼€å§‹çš„ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ^ è¿˜ä¼šä¸ \n æˆ– \r ä¹‹åçš„ä½ç½®åŒ¹é…ã€‚</td>
</tr>
<tr>
<td><code>$</code></td>
<td>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²ç»“å°¾çš„ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ$ è¿˜ä¼šä¸ \n æˆ– \r ä¹‹å‰çš„ä½ç½®åŒ¹é…ã€‚</td>
</tr>
<tr>
<td><code>\b</code></td>
<td>åŒ¹é…ä¸€ä¸ªå­—è¾¹ç•Œï¼Œå³å­—ä¸ç©ºæ ¼é—´çš„ä½ç½®ã€‚</td>
</tr>
<tr>
<td><code>\B</code></td>
<td>éå­—è¾¹ç•ŒåŒ¹é…ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="éæ‰“å°å­—ç¬¦"><a class="markdownIt-Anchor" href="#éæ‰“å°å­—ç¬¦"></a> éæ‰“å°å­—ç¬¦</h3>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\cx</code></td>
<td>åŒ¹é…ç”± x æŒ‡æ˜çš„æ§åˆ¶å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ \cM åŒ¹é…ä¸€ä¸ª Control-M æˆ–å›è½¦ç¬¦ã€‚x çš„å€¼å¿…é¡»ä¸º A-Z æˆ– a-z ä¹‹ä¸€ã€‚å¦åˆ™ï¼Œå°† c è§†ä¸ºä¸€ä¸ªåŸä¹‰çš„ â€˜câ€™ å­—ç¬¦ã€‚</td>
</tr>
<tr>
<td><code>\f</code></td>
<td>åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ã€‚ç­‰ä»·äº \x0c å’Œ \cLã€‚</td>
</tr>
<tr>
<td><code>\n</code></td>
<td>åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ç­‰ä»·äº \x0a å’Œ \cJã€‚</td>
</tr>
<tr>
<td><code>\r</code></td>
<td>åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ã€‚ç­‰ä»·äº \x0d å’Œ \cMã€‚</td>
</tr>
<tr>
<td><code>\s</code></td>
<td>åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº [ \f\n\r\t\v]ã€‚</td>
</tr>
<tr>
<td><code>\S</code></td>
<td>åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äº [ \f\n\r\t\v]ã€‚</td>
</tr>
<tr>
<td><code>\t</code></td>
<td>åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº \x09 å’Œ \cIã€‚</td>
</tr>
<tr>
<td><code>\v</code></td>
<td>åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº \x0b å’Œ \cKã€‚</td>
</tr>
</tbody>
</table>
<h3 id="åˆ†ç»„"><a class="markdownIt-Anchor" href="#åˆ†ç»„"></a> åˆ†ç»„</h3>
<table>
<thead>
<tr>
<th>è¡¨è¾¾å¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(exp)</code></td>
<td>åŒ¹é…çš„å­è¡¨è¾¾å¼ã€‚()ä¸­çš„å†…å®¹å°±æ˜¯å­è¡¨è¾¾å¼ã€‚</td>
</tr>
<tr>
<td><code>(?&lt;name&gt;exp)</code></td>
<td>å‘½åçš„å­è¡¨è¾¾å¼ï¼ˆåå‘å¼•ç”¨ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>(?:exp)</code></td>
<td>éæ•è·ç»„ï¼Œè¡¨ç¤ºå½“ä¸€ä¸ªé™å®šç¬¦åº”ç”¨åˆ°ä¸€ä¸ªç»„ï¼Œä½†ç»„æ•è·çš„å­å­—ç¬¦ä¸²å¹¶éæ‰€éœ€æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨éæ•è·ç»„æ„é€ ã€‚</td>
</tr>
<tr>
<td><code>(?=exp)</code></td>
<td>åŒ¹é… exp å‰é¢çš„ä½ç½®ã€‚</td>
</tr>
<tr>
<td><code>(?&lt;=exp)</code></td>
<td>åŒ¹é… exp åé¢çš„ä½ç½®ã€‚</td>
</tr>
<tr>
<td><code>(?!exp)</code></td>
<td>åŒ¹é…åé¢è·Ÿçš„ä¸æ˜¯ exp çš„ä½ç½®ã€‚</td>
</tr>
<tr>
<td><code>(?&lt;!exp)</code></td>
<td>åŒ¹é…å‰é¢ä¸æ˜¯ exp çš„ä½ç½®ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="ç‰¹æ®Šç¬¦å·"><a class="markdownIt-Anchor" href="#ç‰¹æ®Šç¬¦å·"></a> ç‰¹æ®Šç¬¦å·</h3>
<table>
<thead>
<tr>
<th>å­—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\</code></td>
<td>å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºæˆ–ç‰¹æ®Šå­—ç¬¦ã€æˆ–åŸä¹‰å­—ç¬¦ã€æˆ–å‘åå¼•ç”¨ã€æˆ–å…«è¿›åˆ¶è½¬ä¹‰ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜nâ€™ åŒ¹é…å­—ç¬¦ â€˜nâ€™ã€‚â€™\nâ€™ åŒ¹é…æ¢è¡Œç¬¦ã€‚åºåˆ— â€˜\â€™ åŒ¹é… â€œâ€ï¼Œè€Œ â€˜(â€™ åˆ™åŒ¹é… â€œ(â€ã€‚</td>
</tr>
<tr>
<td><code>\|</code></td>
<td>æŒ‡æ˜ä¸¤é¡¹ä¹‹é—´çš„ä¸€ä¸ªé€‰æ‹©ã€‚</td>
</tr>
<tr>
<td><code>[]</code></td>
<td>åŒ¹é…æ–¹æ‹¬å·èŒƒå›´å†…çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚å½¢å¼å¦‚ï¼š[xyz]ã€[<sup>xyz]ã€[a-z]ã€[</sup>a-z]ã€[x,y,z]</td>
</tr>
</tbody>
</table>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><strong>æ•™ç¨‹</strong>
<ul>
<li><a href="http://deerchao.net/tutorials/regex/regex.htm" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼ 30 åˆ†é’Ÿå…¥é—¨æ•™ç¨‹</a></li>
<li><a href="https://msdn.microsoft.com/zh-cn/library/d9eze55x(v=vs.80).aspx" target="_blank" rel="noopener">msdn æ­£åˆ™è¡¨è¾¾å¼æ•™ç¨‹</a></li>
<li><a href="http://blog.csdn.net/lxcnn/article/details/4362500" target="_blank" rel="noopener">æ­£åˆ™åº”ç”¨ä¹‹â€”â€”æ—¥æœŸæ­£åˆ™è¡¨è¾¾å¼</a></li>
<li><a href="https://github.com/ziishaned/learn-regex" target="_blank" rel="noopener">learn-regex</a></li>
<li><a href="http://www.regexlib.com/" target="_blank" rel="noopener">http://www.regexlib.com/</a></li>
</ul>
</li>
<li><strong>æ–‡ç« /å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼</strong>
<ul>
<li><a href="https://github.com/VincentSit/ChinaMobilePhoneNumberRegex/blob/master/README-CN.md" target="_blank" rel="noopener">ChinaMobilePhoneNumberRegex</a></li>
<li><a href="https://github.com/cdoco/common-regex" target="_blank" rel="noopener">https://github.com/cdoco/common-regex</a></li>
</ul>
</li>
<li><strong>æ­£åˆ™æµ‹è¯•</strong>
<ul>
<li><a href="https://regex101.com/" target="_blank" rel="noopener">https://regex101.com</a></li>
<li><a href="https://regexr.com/" target="_blank" rel="noopener">https://regexr.com</a></li>
<li><a href="https://www.debuggex.com/" target="_blank" rel="noopener">https://www.debuggex.com</a></li>
<li><a href="https://extendsclass.com/regex-tester.html" target="_blank" rel="noopener">https://extendsclass.com/regex-tester.html</a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>æ­£åˆ™</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œåè®®ä¹‹ HTTP</title>
    <url>/blog/communication/http/</url>
    <content><![CDATA[<h1 id="ç½‘ç»œåè®®ä¹‹-http"><a class="markdownIt-Anchor" href="#ç½‘ç»œåè®®ä¹‹-http"></a> ç½‘ç»œåè®®ä¹‹ HTTP</h1>
<blockquote>
<p>**è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼‰**æ˜¯ä¸€ä¸ªç”¨äºä¼ è¾“è¶…åª’ä½“æ–‡æ¡£ï¼ˆä¾‹å¦‚ HTMLï¼‰çš„<a href="https://en.wikipedia.org/wiki/Application_Layer" target="_blank" rel="noopener">åº”ç”¨å±‚</a>åè®®ã€‚</p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:2 -->
<ul>
<li><a href="#http-%E7%AE%80%E4%BB%8B">HTTP ç®€ä»‹</a></li>
<li><a href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86">å·¥ä½œåŸç†</a></li>
<li><a href="#http-%E6%8A%A5%E6%96%87">HTTP æŠ¥æ–‡</a></li>
<li><a href="#https">HTTPS</a></li>
<li><a href="#cookie-%E5%92%8C-session">Cookie å’Œ Session</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
<!-- /TOC -->
<h2 id="http-ç®€ä»‹"><a class="markdownIt-Anchor" href="#http-ç®€ä»‹"></a> HTTP ç®€ä»‹</h2>
<h3 id="http-æ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#http-æ˜¯ä»€ä¹ˆ"></a> HTTP æ˜¯ä»€ä¹ˆ</h3>
<p>**è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼‰**æ˜¯ä¸€ä¸ªç”¨äºä¼ è¾“è¶…åª’ä½“æ–‡æ¡£ï¼ˆä¾‹å¦‚ HTMLï¼‰çš„<a href="https://en.wikipedia.org/wiki/Application_Layer" target="_blank" rel="noopener">åº”ç”¨å±‚</a>åè®®ã€‚å®ƒæ˜¯ä¸º Web æµè§ˆå™¨ä¸ Web æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡è€Œè®¾è®¡çš„ï¼Œä½†ä¹Ÿå¯ä»¥ç”¨äºå…¶ä»–ç›®çš„ã€‚HTTP éµå¾ªç»å…¸çš„<a href="https://en.wikipedia.org/wiki/Client%E2%80%93server_model" target="_blank" rel="noopener">å®¢æˆ·ç«¯-æœåŠ¡ç«¯æ¨¡å‹</a>ï¼Œå®¢æˆ·ç«¯æ‰“å¼€ä¸€ä¸ªè¿æ¥ä»¥å‘å‡ºè¯·æ±‚ï¼Œç„¶åç­‰å¾…å®ƒæ”¶åˆ°æœåŠ¡å™¨ç«¯å“åº”ã€‚HTTP æ˜¯<a href="http://en.wikipedia.org/wiki/Stateless_protocol" target="_blank" rel="noopener">æ— çŠ¶æ€åè®®</a>ï¼Œè¿™æ„å‘³ç€æœåŠ¡å™¨ä¸ä¼šåœ¨ä¸¤ä¸ªè¯·æ±‚ä¹‹é—´ä¿ç•™ä»»ä½•æ•°æ®ï¼ˆçŠ¶æ€ï¼‰ã€‚è¯¥åè®®è™½ç„¶é€šå¸¸åŸºäº TCP/IP å±‚ï¼Œä½†å¯ä»¥åœ¨ä»»ä½•å¯é çš„<a href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82" target="_blank" rel="noopener">ä¼ è¾“å±‚</a>ä¸Šä½¿ç”¨ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åƒ UDPï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸ä¼šé™é»˜ä¸¢å¤±æ¶ˆæ¯çš„åè®®ã€‚</p>
<p>HTTP æ˜¯ç”± <strong>IETF</strong>(Internet Engineering Task Forceï¼Œäº’è”ç½‘å·¥ç¨‹å·¥ä½œå°ç»„) å’Œ <strong>W3C</strong>(World Wide Web Consortiumï¼Œä¸‡ç»´ç½‘åä¼š) å…±åŒåˆä½œåˆ¶è®¢çš„ï¼Œå®ƒä»¬å‘å¸ƒäº†ä¸€ç³»åˆ—çš„<strong>RFC</strong>(Request For Comments)ï¼Œå…¶ä¸­æœ€è‘—åçš„æ˜¯ RFC 2616ï¼Œå®ƒå®šä¹‰äº†<strong>HTTP /1.1</strong>ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200119131949.png" alt="" /></p>
<h3 id="http-åè®®ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#http-åè®®ç‰¹ç‚¹"></a> HTTP åè®®ç‰¹ç‚¹</h3>
<ul>
<li><strong>æ— è¿æ¥çš„</strong> - æ— è¿æ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚</li>
<li><strong>æ— çŠ¶æ€çš„</strong> - HTTP åè®®æ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«ã€‚</li>
<li><strong>åª’ä½“ç‹¬ç«‹çš„</strong> - è¿™æ„å‘³ç€ï¼Œåªè¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çŸ¥é“å¦‚ä½•å¤„ç†çš„æ•°æ®å†…å®¹ï¼Œä»»ä½•ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥é€šè¿‡ HTTP å‘é€ã€‚å®¢æˆ·ç«¯ä»¥åŠæœåŠ¡å™¨æŒ‡å®šä½¿ç”¨é€‚åˆçš„ MIME-type å†…å®¹ç±»å‹ã€‚</li>
<li><strong>C/S æ¨¡å‹çš„</strong> - åŸºäº Client/Server æ¨¡å‹å·¥ä½œã€‚</li>
</ul>
<h3 id="http-ç‰ˆæœ¬ç‰¹æ€§"><a class="markdownIt-Anchor" href="#http-ç‰ˆæœ¬ç‰¹æ€§"></a> HTTP ç‰ˆæœ¬ç‰¹æ€§</h3>
<h4 id="http-11"><a class="markdownIt-Anchor" href="#http-11"></a> HTTP 1.1</h4>
<p>HTTP1.0 å’Œ HTTP 1.1 ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>ç¼“å­˜å¤„ç†</strong>ï¼Œåœ¨ HTTP1.0 ä¸­ä¸»è¦ä½¿ç”¨ header é‡Œçš„ If-Modified-Since,Expires æ¥åšä¸ºç¼“å­˜åˆ¤æ–­çš„æ ‡å‡†ï¼ŒHTTP1.1 åˆ™å¼•å…¥äº†æ›´å¤šçš„ç¼“å­˜æ§åˆ¶ç­–ç•¥ä¾‹å¦‚ Entity tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Match ç­‰æ›´å¤šå¯ä¾›é€‰æ‹©çš„ç¼“å­˜å¤´æ¥æ§åˆ¶ç¼“å­˜ç­–ç•¥ã€‚</li>
<li><strong>å¸¦å®½ä¼˜åŒ–åŠç½‘ç»œè¿æ¥çš„ä½¿ç”¨</strong></li>
<li><strong>é”™è¯¯é€šçŸ¥çš„ç®¡ç†</strong> - HTTP1.1 ä¸­æ–°å¢äº† 24 ä¸ªé”™è¯¯çŠ¶æ€å“åº”ç ã€‚</li>
<li><strong>Host å¤´å¤„ç†</strong>
<ul>
<li>HTTP1.0 ä¸­è®¤ä¸ºæ¯å°æœåŠ¡å™¨éƒ½ç»‘å®šä¸€ä¸ªå”¯ä¸€çš„ IP åœ°å€ï¼Œå› æ­¤ï¼Œè¯·æ±‚æ¶ˆæ¯ä¸­çš„ URL å¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºåï¼ˆhostnameï¼‰ã€‚</li>
<li>éšç€è™šæ‹Ÿä¸»æœºæŠ€æœ¯çš„å‘å±•ï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºï¼Œå¹¶ä¸”å®ƒä»¬å…±äº«ä¸€ä¸ª IP åœ°å€ã€‚HTTP1.1 çš„è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½åº”æ”¯æŒ Host å¤´åŸŸï¼Œä¸”è¯·æ±‚æ¶ˆæ¯ä¸­å¦‚æœæ²¡æœ‰ Host å¤´åŸŸä¼šæŠ¥å‘Šä¸€ä¸ªé”™è¯¯ï¼ˆ400 Bad Requestï¼‰ã€‚</li>
</ul>
</li>
<li><strong>é•¿è¿æ¥</strong>ï¼ŒHTTP 1.1 æ”¯æŒé•¿è¿æ¥ï¼ˆPersistentConnectionï¼‰å’Œè¯·æ±‚çš„æµæ°´çº¿ï¼ˆPipeliningï¼‰å¤„ç†ï¼Œåœ¨ä¸€ä¸ª TCP è¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ª HTTP è¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿï¼Œåœ¨ HTTP1.1 ä¸­é»˜è®¤å¼€å¯ Connectionï¼š keep-aliveï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº† HTTP1.0 æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚</li>
</ul>
<h4 id="http-20"><a class="markdownIt-Anchor" href="#http-20"></a> HTTP 2.0</h4>
<p>HTTP/2 åœ¨ HTTP/1.1 æœ‰å‡ å¤„åŸºæœ¬çš„ä¸åŒ:</p>
<ul>
<li>HTTP/2 æ˜¯äºŒè¿›åˆ¶åè®®è€Œä¸æ˜¯æ–‡æœ¬åè®®ã€‚ä¸å†å¯è¯»ï¼Œä¹Ÿä¸å¯æ— éšœç¢çš„æ‰‹åŠ¨åˆ›å»ºï¼Œæ”¹å–„çš„ä¼˜åŒ–æŠ€æœ¯ç°åœ¨å¯è¢«å®æ–½ã€‚</li>
<li>è¿™æ˜¯ä¸€ä¸ªå¤ç”¨åè®®ã€‚å¹¶è¡Œçš„è¯·æ±‚èƒ½åœ¨åŒä¸€ä¸ªé“¾æ¥ä¸­å¤„ç†ï¼Œç§»é™¤äº† HTTP/1.x ä¸­é¡ºåºå’Œé˜»å¡çš„çº¦æŸã€‚</li>
<li>å‹ç¼©äº† headersã€‚å› ä¸º headers åœ¨ä¸€ç³»åˆ—è¯·æ±‚ä¸­å¸¸å¸¸æ˜¯ç›¸ä¼¼çš„ï¼Œå…¶ç§»é™¤äº†é‡å¤å’Œä¼ è¾“é‡å¤æ•°æ®çš„æˆæœ¬ã€‚</li>
<li>å…¶å…è®¸æœåŠ¡å™¨åœ¨å®¢æˆ·ç«¯ç¼“å­˜ä¸­å¡«å……æ•°æ®ï¼Œé€šè¿‡ä¸€ä¸ªå«æœåŠ¡å™¨æ¨é€çš„æœºåˆ¶æ¥æå‰è¯·æ±‚ã€‚</li>
</ul>
<h2 id="å·¥ä½œåŸç†"><a class="markdownIt-Anchor" href="#å·¥ä½œåŸç†"></a> å·¥ä½œåŸç†</h2>
<p>HTTP å·¥ä½œäº <strong>Client/Server</strong> æ¨¡å‹ä¸Šã€‚</p>
<p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡é‡‡ç”¨ <strong>request/response</strong> æœºåˆ¶ã€‚</p>
<p>å®¢æˆ·ç«¯æ˜¯ç»ˆç«¯ï¼ˆå¯ä»¥æ˜¯æµè§ˆå™¨ã€çˆ¬è™«ç¨‹åºç­‰ï¼‰ï¼ŒæœåŠ¡å™¨æ˜¯ç½‘ç«™çš„ Web æœåŠ¡å™¨ã€‚</p>
<p>ä¸€æ¬¡ HTTP æ“ä½œç§°ä¸ºä¸€ä¸ªäº‹åŠ¡ï¼Œå…¶å·¥ä½œè¿‡ç¨‹å¤§è‡´å¯åˆ†ä¸ºå››æ­¥ï¼š</p>
<ol>
<li><strong>å»ºç«‹è¿æ¥</strong> - é¦–å…ˆï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦å»ºç«‹ä¸€ä¸ªåˆ°æœåŠ¡å™¨æŒ‡å®šç«¯å£ï¼ˆé»˜è®¤ç«¯å£å·ä¸º <strong>80</strong>ï¼‰çš„ TCP è¿æ¥ï¼ˆæ³¨ï¼šè™½ç„¶ HTTP é‡‡ç”¨ TCP è¿æ¥æ˜¯æœ€æµè¡Œçš„æ–¹å¼ï¼Œä½†æ˜¯ RFC å¹¶æ²¡æœ‰æŒ‡å®šä¸€å®šè¦é‡‡ç”¨è¿™ç§ç½‘ç»œä¼ è¾“æ–¹å¼ã€‚ï¼‰ã€‚</li>
<li><strong>å‘é€è¯·æ±‚ä¿¡æ¯</strong> - å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚è¯·æ±‚æ–¹å¼çš„æ ¼å¼ä¸ºï¼Œç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ã€åè®®ç‰ˆæœ¬å·ï¼Œåè¾¹æ˜¯ MIME ä¿¡æ¯åŒ…æ‹¬è¯·æ±‚ä¿®é¥°ç¬¦</li>
<li><strong>å‘é€å“åº”ä¿¡æ¯</strong> - æœåŠ¡å™¨ç›‘å¬æŒ‡å®šæ¥å£æ˜¯å¦æ”¶åˆ°è¯·æ±‚ï¼Œä¸€æ—¦å‘ç°è¯·æ±‚ï¼Œå¤„ç†åï¼Œè¿”å›å“åº”ç»“æœç»™å®¢æˆ·ç«¯ã€‚å…¶æ ¼å¼ä¸ºä¸€ä¸ªçŠ¶æ€è¡ŒåŒ…æ‹¬ä¿¡æ¯çš„åè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªæˆåŠŸæˆ–é”™è¯¯çš„ä»£ç ï¼Œåè¾¹æ˜¯ MIME ä¿¡æ¯åŒ…æ‹¬æœåŠ¡å™¨ä¿¡æ¯ã€å®ä½“ä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚</li>
<li><strong>å…³é—­è¿æ¥</strong> - å®¢æˆ·ç«¯æ ¹æ®å“åº”ï¼Œæ˜¾ç¤ºç»“æœç»™ç”¨æˆ·ï¼Œæœ€åå…³é—­è¿æ¥ã€‚</li>
</ol>
<h3 id="http-ä¼˜åŒ–"><a class="markdownIt-Anchor" href="#http-ä¼˜åŒ–"></a> HTTP ä¼˜åŒ–</h3>
<p>å½±å“ä¸€ä¸ª HTTP ç½‘ç»œè¯·æ±‚çš„å› ç´ ä¸»è¦æœ‰ä¸¤ä¸ªï¼š<strong>å¸¦å®½å’Œå»¶è¿Ÿã€‚</strong></p>
<ul>
<li>
<p>**å¸¦å®½ï¼š**å¦‚æœè¯´æˆ‘ä»¬è¿˜åœç•™åœ¨æ‹¨å·ä¸Šç½‘çš„é˜¶æ®µï¼Œå¸¦å®½å¯èƒ½ä¼šæˆä¸ºä¸€ä¸ªæ¯”è¾ƒä¸¥é‡å½±å“è¯·æ±‚çš„é—®é¢˜ï¼Œä½†æ˜¯ç°åœ¨ç½‘ç»œåŸºç¡€å»ºè®¾å·²ç»ä½¿å¾—å¸¦å®½å¾—åˆ°æå¤§çš„æå‡ï¼Œæˆ‘ä»¬ä¸å†ä¼šæ‹…å¿ƒç”±å¸¦å®½è€Œå½±å“ç½‘é€Ÿï¼Œé‚£ä¹ˆå°±åªå‰©ä¸‹å»¶è¿Ÿäº†ã€‚</p>
</li>
<li>
<p><strong>å»¶è¿Ÿï¼š</strong></p>
</li>
<li>
<ul>
<li>æµè§ˆå™¨é˜»å¡ï¼ˆHOL blockingï¼‰ï¼šæµè§ˆå™¨ä¼šå› ä¸ºä¸€äº›åŸå› é˜»å¡è¯·æ±‚ã€‚æµè§ˆå™¨å¯¹äºåŒä¸€ä¸ªåŸŸåï¼ŒåŒæ—¶åªèƒ½æœ‰ 4 ä¸ªè¿æ¥ï¼ˆè¿™ä¸ªæ ¹æ®æµè§ˆå™¨å†…æ ¸ä¸åŒå¯èƒ½ä¼šæœ‰æ‰€å·®å¼‚ï¼‰ï¼Œè¶…è¿‡æµè§ˆå™¨æœ€å¤§è¿æ¥æ•°é™åˆ¶ï¼Œåç»­è¯·æ±‚å°±ä¼šè¢«é˜»å¡ã€‚</li>
<li>DNS æŸ¥è¯¢ï¼ˆDNS Lookupï¼‰ï¼šæµè§ˆå™¨éœ€è¦çŸ¥é“ç›®æ ‡æœåŠ¡å™¨çš„ IP æ‰èƒ½å»ºç«‹è¿æ¥ã€‚å°†åŸŸåè§£æä¸º IP çš„è¿™ä¸ªç³»ç»Ÿå°±æ˜¯ DNSã€‚è¿™ä¸ªé€šå¸¸å¯ä»¥åˆ©ç”¨ DNS ç¼“å­˜ç»“æœæ¥è¾¾åˆ°å‡å°‘è¿™ä¸ªæ—¶é—´çš„ç›®çš„ã€‚</li>
<li>å»ºç«‹è¿æ¥ï¼ˆInitial connectionï¼‰ï¼šHTTP æ˜¯åŸºäº TCP åè®®çš„ï¼Œæµè§ˆå™¨æœ€å¿«ä¹Ÿè¦åœ¨ç¬¬ä¸‰æ¬¡æ¡æ‰‹æ—¶æ‰èƒ½æå¸¦ HTTP è¯·æ±‚æŠ¥æ–‡ï¼Œè¾¾åˆ°çœŸæ­£çš„å»ºç«‹è¿æ¥ï¼Œä½†æ˜¯è¿™äº›è¿æ¥æ— æ³•å¤ç”¨ä¼šå¯¼è‡´æ¯æ¬¡è¯·æ±‚éƒ½ç»å†ä¸‰æ¬¡æ¡æ‰‹å’Œæ…¢å¯åŠ¨ã€‚ä¸‰æ¬¡æ¡æ‰‹åœ¨é«˜å»¶è¿Ÿçš„åœºæ™¯ä¸‹å½±å“è¾ƒæ˜æ˜¾ï¼Œæ…¢å¯åŠ¨åˆ™å¯¹æ–‡ä»¶ç±»å¤§è¯·æ±‚å½±å“è¾ƒå¤§ã€‚</li>
</ul>
</li>
</ul>
<h2 id="http-æŠ¥æ–‡"><a class="markdownIt-Anchor" href="#http-æŠ¥æ–‡"></a> HTTP æŠ¥æ–‡</h2>
<p>HTTP æ˜¯åŸºäºå®¢æˆ·ç«¯/æœåŠ¡ç«¯ï¼ˆC/Sï¼‰çš„æ¶æ„æ¨¡å‹ï¼Œé€šè¿‡ä¸€ä¸ªå¯é çš„é“¾æ¥æ¥äº¤æ¢ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„è¯·æ±‚/å“åº”åè®®ã€‚</p>
<p>ä¸€ä¸ª HTTP&quot;å®¢æˆ·ç«¯&quot;æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ˆWeb æµè§ˆå™¨æˆ–å…¶ä»–ä»»ä½•å®¢æˆ·ç«¯ï¼‰ï¼Œé€šè¿‡è¿æ¥åˆ°æœåŠ¡å™¨è¾¾åˆ°å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªæˆ–å¤šä¸ª HTTP çš„è¯·æ±‚çš„ç›®çš„ã€‚</p>
<p>ä¸€ä¸ª HTTP&quot;æœåŠ¡å™¨&quot;åŒæ ·ä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ª Web æœåŠ¡ï¼Œå¦‚ Apache Web æœåŠ¡å™¨æˆ– IIS æœåŠ¡å™¨ç­‰ï¼‰ï¼Œé€šè¿‡æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚å¹¶å‘å®¢æˆ·ç«¯å‘é€ HTTP å“åº”æ•°æ®ã€‚</p>
<p>HTTP ä½¿ç”¨ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifiers, URIï¼‰æ¥ä¼ è¾“æ•°æ®å’Œå»ºç«‹è¿æ¥ã€‚</p>
<p>ä¸€æ—¦å»ºç«‹è¿æ¥åï¼Œæ•°æ®æ¶ˆæ¯å°±é€šè¿‡ç±»ä¼¼ Internet é‚®ä»¶æ‰€ä½¿ç”¨çš„æ ¼å¼[RFC5322]å’Œå¤šç”¨é€” Internet é‚®ä»¶æ‰©å±•ï¼ˆMIMEï¼‰[RFC2045]æ¥ä¼ é€ã€‚</p>
<div align="center"><img src="https://images2015.cnblogs.com/blog/318837/201601/318837-20160108221141668-2097587842.png"/></div>
ä»¥ä¸‹æ˜¯ä½¿ç”¨ wireshark æŠ“å–çš„ä¸€ä¸ªå®é™…è®¿é—®ç™¾åº¦é¦–é¡µçš„ HTTP GET æŠ¥æ–‡ï¼š
<div align="center"><img src="http://images2015.cnblogs.com/blog/318837/201601/318837-20160108221137996-786139964.png"/></div>
å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°å®ƒçš„å±‚çº§ç»“æ„å¦‚ä¸‹å›¾ï¼Œç»è¿‡äº†å±‚å±‚çš„åŒ…è£…ã€‚
<div align="center"><img src="https://images2015.cnblogs.com/blog/318837/201601/318837-20160108221140731-222242798.png"/></div>
### HTTP è¯·æ±‚æŠ¥æ–‡
<p>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª HTTP è¯·æ±‚åˆ°æœåŠ¡å™¨çš„è¯·æ±‚æ¶ˆæ¯åŒ…æ‹¬ä»¥ä¸‹æ ¼å¼ï¼šè¯·æ±‚è¡Œï¼ˆrequest lineï¼‰ã€è¯·æ±‚å¤´éƒ¨ï¼ˆheaderï¼‰ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œä¸‹å›¾ç»™å‡ºäº†è¯·æ±‚æŠ¥æ–‡çš„ä¸€èˆ¬æ ¼å¼ã€‚</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200119132129.png" alt="" /></p>
<p>HTTP è¯·æ±‚æŠ¥æ–‡ç”±ä»¥ä¸‹å…ƒç´ ç»„æˆï¼š</p>
<ul>
<li>ä¸€ä¸ª HTTP çš„<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods" target="_blank" rel="noopener">method</a>ï¼Œç»å¸¸æ˜¯ç”±ä¸€ä¸ªåŠ¨è¯åƒ<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET" target="_blank" rel="noopener"><code>GET</code></a>, <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST" target="_blank" rel="noopener"><code>POST</code></a> æˆ–è€…ä¸€ä¸ªåè¯åƒ<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/OPTIONS" target="_blank" rel="noopener"><code>OPTIONS</code></a>ï¼Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/HEAD" target="_blank" rel="noopener"><code>HEAD</code></a>æ¥å®šä¹‰å®¢æˆ·ç«¯çš„åŠ¨ä½œè¡Œä¸ºã€‚é€šå¸¸å®¢æˆ·ç«¯çš„æ“ä½œéƒ½æ˜¯è·å–èµ„æºï¼ˆGET æ–¹æ³•ï¼‰æˆ–è€…å‘é€<a href="https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Forms" target="_blank" rel="noopener">HTML form</a>è¡¨å•å€¼ï¼ˆPOST æ–¹æ³•ï¼‰ï¼Œè™½ç„¶åœ¨ä¸€äº›æƒ…å†µä¸‹ä¹Ÿä¼šæœ‰å…¶ä»–æ“ä½œã€‚</li>
<li>è¦è·å–çš„èµ„æºçš„è·¯å¾„ï¼Œé€šå¸¸æ˜¯ä¸Šä¸‹æ–‡ä¸­å°±å¾ˆæ˜æ˜¾çš„å…ƒç´ èµ„æºçš„ URLï¼Œå®ƒæ²¡æœ‰<a href="https://developer.mozilla.org/en-US/docs/Glossary/protocol" target="_blank" rel="noopener">protocol</a> ï¼ˆ<code>http://</code>ï¼‰ï¼Œ<a href="https://developer.mozilla.org/en-US/docs/Glossary/domain" target="_blank" rel="noopener">domain</a>ï¼ˆ<code>developer.mozilla.org</code>ï¼‰ï¼Œæˆ–æ˜¯ TCP çš„<a href="https://developer.mozilla.org/en-US/docs/Glossary/port" target="_blank" rel="noopener">port</a>ï¼ˆHTTP ä¸€èˆ¬åœ¨ 80 ç«¯å£ï¼‰ã€‚</li>
<li>HTTP åè®®ç‰ˆæœ¬å·ã€‚</li>
<li>ä¸ºæœåŠ¡ç«¯è¡¨è¾¾å…¶ä»–ä¿¡æ¯çš„å¯é€‰å¤´éƒ¨<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers" target="_blank" rel="noopener">headers</a>ã€‚</li>
<li>å¯¹äºä¸€äº›åƒ POST è¿™æ ·çš„æ–¹æ³•ï¼ŒæŠ¥æ–‡çš„ body å°±åŒ…å«äº†å‘é€çš„èµ„æºï¼Œè¿™ä¸å“åº”æŠ¥æ–‡çš„ body ç±»ä¼¼ã€‚</li>
</ul>
<p>æ ¹æ® HTTP æ ‡å‡†ï¼ŒHTTP è¯·æ±‚å¯ä»¥ä½¿ç”¨å¤šç§è¯·æ±‚æ–¹æ³•ã€‚</p>
<p><strong>HTTP1.0</strong> å®šä¹‰äº†ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼š <strong>GET</strong>, <strong>POST</strong> å’Œ <strong>HEAD</strong>æ–¹æ³•ã€‚</p>
<p><strong>HTTP1.1</strong> æ–°å¢äº†äº”ç§è¯·æ±‚æ–¹æ³•ï¼š<strong>OPTIONS</strong>, <strong>PUT</strong>, <strong>DELETE</strong>, <strong>TRACE</strong> å’Œ <strong>CONNECT</strong>æ–¹æ³•ã€‚</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ã€‚</td>
</tr>
<tr>
<td>HEAD</td>
<td>ç±»ä¼¼äº get è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´</td>
</tr>
<tr>
<td>POST</td>
<td>å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POST è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚</td>
</tr>
<tr>
<td>PUT</td>
<td>ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚</td>
</tr>
<tr>
<td>DELETE</td>
<td>è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚</td>
</tr>
<tr>
<td>CONNECT</td>
<td>HTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚</td>
</tr>
<tr>
<td>OPTIONS</td>
<td>å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚</td>
</tr>
<tr>
<td>TRACE</td>
<td>å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>HTTP</strong> <strong>è¯·æ±‚æ¶ˆæ¯å¤´</strong></p>
<table>
<thead>
<tr>
<th><strong>è¯·æ±‚æ¶ˆæ¯å¤´</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Accept</td>
<td>æµè§ˆå™¨æ”¯æŒçš„æ ¼å¼</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>æ”¯æŒçš„ç¼–ç æ ¼å¼ï¼Œå¦‚ï¼ˆUTF-8ï¼ŒGBKï¼‰</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>æ”¯æŒçš„è¯­è¨€ç±»å‹</td>
</tr>
<tr>
<td>User-Agent</td>
<td>æµè§ˆå™¨ä¿¡æ¯</td>
</tr>
<tr>
<td>Cookie</td>
<td>è®°å½•çš„æ˜¯ç”¨æˆ·å½“å‰çš„çŠ¶æ€</td>
</tr>
<tr>
<td>Referer</td>
<td>æŒ‡ä»å“ªä¸ªé¡µé¢å•å‡»é“¾æ¥è¿›å…¥çš„é¡µé¢</td>
</tr>
<tr>
<td>HOST</td>
<td>ç›®çš„åœ°å€å¯¹åº”çš„ä¸»æœºå</td>
</tr>
<tr>
<td>Connection</td>
<td>è¿æ¥ç±»å‹ã€‚å¦‚ Keep-Alive è¡¨ç¤ºé•¿è¿æ¥ï¼Œä¸ä¼šæ–­å¼€</td>
</tr>
<tr>
<td>Content-Length</td>
<td>å†…å®¹é•¿åº¦</td>
</tr>
<tr>
<td>Content-Type</td>
<td>å†…å®¹ç±»å‹</td>
</tr>
</tbody>
</table>
<h3 id="http-å“åº”æŠ¥æ–‡"><a class="markdownIt-Anchor" href="#http-å“åº”æŠ¥æ–‡"></a> HTTP å“åº”æŠ¥æ–‡</h3>
<p><img src="https://raw.githubusercontent.com/dunwu/images/master/snap/20200119132311.png" alt="" /></p>
<p>HTTP å“åº”æŠ¥æ–‡åŒ…å«äº†ä¸‹é¢çš„å…ƒç´ ï¼š</p>
<ul>
<li>HTTP åè®®ç‰ˆæœ¬å·ã€‚</li>
<li>ä¸€ä¸ªçŠ¶æ€ç ï¼ˆ<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" target="_blank" rel="noopener">status code</a>ï¼‰ï¼Œæ¥å‘ŠçŸ¥å¯¹åº”è¯·æ±‚æ‰§è¡ŒæˆåŠŸæˆ–å¤±è´¥ï¼Œä»¥åŠå¤±è´¥çš„åŸå› ã€‚</li>
<li>ä¸€ä¸ªçŠ¶æ€ä¿¡æ¯ï¼Œè¿™ä¸ªä¿¡æ¯æ˜¯éæƒå¨çš„çŠ¶æ€ç æè¿°ä¿¡æ¯ï¼Œå¯ä»¥ç”±æœåŠ¡ç«¯è‡ªè¡Œè®¾å®šã€‚</li>
<li>HTTP <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers" target="_blank" rel="noopener">headers</a>ï¼Œä¸è¯·æ±‚å¤´éƒ¨ç±»ä¼¼ã€‚</li>
<li>å¯é€‰é¡¹ï¼Œæ¯”èµ·è¯·æ±‚æŠ¥æ–‡ï¼Œå“åº”æŠ¥æ–‡ä¸­æ›´å¸¸è§åœ°åŒ…å«è·å–çš„èµ„æº bodyã€‚</li>
</ul>
<h4 id="å“åº”æ¶ˆæ¯å¤´"><a class="markdownIt-Anchor" href="#å“åº”æ¶ˆæ¯å¤´"></a> å“åº”æ¶ˆæ¯å¤´</h4>
<table>
<thead>
<tr>
<th><strong>å“åº”æ¶ˆæ¯å¤´</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Allow</td>
<td>æœåŠ¡å™¨æ”¯æŒå“ªäº›è¯·æ±‚æ–¹æ³•ï¼ˆå¦‚ GETã€POST ç­‰ï¼‰ã€‚</td>
</tr>
<tr>
<td>Content-Encoding</td>
<td>æ–‡æ¡£çš„ç¼–ç ï¼ˆEncodeï¼‰æ–¹æ³•ã€‚åªæœ‰åœ¨è§£ç ä¹‹åæ‰å¯ä»¥å¾—åˆ° Content-Type å¤´æŒ‡å®šçš„å†…å®¹ç±»å‹ã€‚åˆ©ç”¨ gzip å‹ç¼©æ–‡æ¡£èƒ½å¤Ÿæ˜¾è‘—åœ°å‡å°‘ HTML æ–‡æ¡£çš„ä¸‹è½½æ—¶é—´ã€‚Java çš„ GZIPOutputStream å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œ gzip å‹ç¼©ï¼Œä½†åªæœ‰ Unix ä¸Šçš„ Netscape å’Œ Windows ä¸Šçš„ IE 4ã€IE 5 æ‰æ”¯æŒå®ƒã€‚å› æ­¤ï¼ŒServlet åº”è¯¥é€šè¿‡æŸ¥çœ‹ Accept-Encoding å¤´ï¼ˆå³ request.getHeader(â€œAccept-Encodingâ€)ï¼‰æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒ gzipï¼Œä¸ºæ”¯æŒ gzip çš„æµè§ˆå™¨è¿”å›ç» gzip å‹ç¼©çš„ HTML é¡µé¢ï¼Œä¸ºå…¶ä»–æµè§ˆå™¨è¿”å›æ™®é€šé¡µé¢ã€‚</td>
</tr>
<tr>
<td>Content-Length</td>
<td>è¡¨ç¤ºå†…å®¹é•¿åº¦ã€‚åªæœ‰å½“æµè§ˆå™¨ä½¿ç”¨æŒä¹… HTTP è¿æ¥æ—¶æ‰éœ€è¦è¿™ä¸ªæ•°æ®ã€‚å¦‚æœä½ æƒ³è¦åˆ©ç”¨æŒä¹…è¿æ¥çš„ä¼˜åŠ¿ï¼Œå¯ä»¥æŠŠè¾“å‡ºæ–‡æ¡£å†™å…¥ ByteArrayOutputStramï¼Œå®ŒæˆåæŸ¥çœ‹å…¶å¤§å°ï¼Œç„¶åæŠŠè¯¥å€¼æ”¾å…¥ Content-Length å¤´ï¼Œæœ€åé€šè¿‡<code>byteArrayStream.writeTo(response.getOutputStream()</code> å‘é€å†…å®¹ã€‚</td>
</tr>
<tr>
<td>Content-Type</td>
<td>è¡¨ç¤ºåé¢çš„æ–‡æ¡£å±äºä»€ä¹ˆ MIME ç±»å‹ã€‚Servlet é»˜è®¤ä¸º <code>text/plain</code>ï¼Œä½†é€šå¸¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šä¸º text/htmlã€‚ç”±äºç»å¸¸è¦è®¾ç½® Content-Typeï¼Œå› æ­¤ HttpServletResponse æä¾›äº†ä¸€ä¸ªä¸“ç”¨çš„æ–¹æ³• setContentTypeã€‚</td>
</tr>
<tr>
<td>Date</td>
<td>å½“å‰çš„ GMT æ—¶é—´ã€‚ä½ å¯ä»¥ç”¨ setDateHeader æ¥è®¾ç½®è¿™ä¸ªå¤´ä»¥é¿å…è½¬æ¢æ—¶é—´æ ¼å¼çš„éº»çƒ¦ã€‚</td>
</tr>
<tr>
<td>Expires</td>
<td>åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™è®¤ä¸ºæ–‡æ¡£å·²ç»è¿‡æœŸï¼Œä»è€Œä¸å†ç¼“å­˜å®ƒï¼Ÿ</td>
</tr>
<tr>
<td>Last-Modified</td>
<td>æ–‡æ¡£çš„æœ€åæ”¹åŠ¨æ—¶é—´ã€‚å®¢æˆ·å¯ä»¥é€šè¿‡ If-Modified-Since è¯·æ±‚å¤´æä¾›ä¸€ä¸ªæ—¥æœŸï¼Œè¯¥è¯·æ±‚å°†è¢«è§†ä¸ºä¸€ä¸ªæ¡ä»¶ GETï¼Œåªæœ‰æ”¹åŠ¨æ—¶é—´è¿ŸäºæŒ‡å®šæ—¶é—´çš„æ–‡æ¡£æ‰ä¼šè¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ª 304ï¼ˆNot Modifiedï¼‰çŠ¶æ€ã€‚Last-Modified ä¹Ÿå¯ç”¨ setDateHeader æ–¹æ³•æ¥è®¾ç½®ã€‚</td>
</tr>
<tr>
<td>Location</td>
<td>è¡¨ç¤ºå®¢æˆ·åº”å½“åˆ°å“ªé‡Œå»æå–æ–‡æ¡£ã€‚Location é€šå¸¸ä¸æ˜¯ç›´æ¥è®¾ç½®çš„ï¼Œè€Œæ˜¯é€šè¿‡ HttpServletResponse çš„ sendRedirect æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åŒæ—¶è®¾ç½®çŠ¶æ€ä»£ç ä¸º 302ã€‚</td>
</tr>
<tr>
<td>Refresh</td>
<td>è¡¨ç¤ºæµè§ˆå™¨åº”è¯¥åœ¨å¤šå°‘æ—¶é—´ä¹‹ååˆ·æ–°æ–‡æ¡£ï¼Œä»¥ç§’è®¡ã€‚é™¤äº†åˆ·æ–°å½“å‰æ–‡æ¡£ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡ <code>response.setHeader(&quot;Refresh&quot;, &quot;5;URL=http://host/path&quot;)</code>è®©æµè§ˆå™¨è¯»å–æŒ‡å®šçš„é¡µé¢ã€‚ æ³¨æ„è¿™ç§åŠŸèƒ½é€šå¸¸æ˜¯é€šè¿‡è®¾ç½® HTML é¡µé¢ HEAD åŒºçš„ <code>&lt;META HTTP-EQUIV=&quot;Refresh&quot; CONTENT=&quot;5;URL=http://host/path&quot;&gt;</code>å®ç°ï¼Œè¿™æ˜¯å› ä¸ºï¼Œè‡ªåŠ¨åˆ·æ–°æˆ–é‡å®šå‘å¯¹äºé‚£äº›ä¸èƒ½ä½¿ç”¨ CGI æˆ– Servlet çš„ HTML ç¼–å†™è€…ååˆ†é‡è¦ã€‚ä½†æ˜¯ï¼Œå¯¹äº Servlet æ¥è¯´ï¼Œç›´æ¥è®¾ç½® Refresh å¤´æ›´åŠ æ–¹ä¾¿ã€‚ æ³¨æ„ Refresh çš„æ„ä¹‰æ˜¯&quot;N ç§’ä¹‹ååˆ·æ–°æœ¬é¡µé¢æˆ–è®¿é—®æŒ‡å®šé¡µé¢&quot;ï¼Œè€Œä¸æ˜¯&quot;æ¯éš” N ç§’åˆ·æ–°æœ¬é¡µé¢æˆ–è®¿é—®æŒ‡å®šé¡µé¢&quot;ã€‚å› æ­¤ï¼Œè¿ç»­åˆ·æ–°è¦æ±‚æ¯æ¬¡éƒ½å‘é€ä¸€ä¸ª Refresh å¤´ï¼Œè€Œå‘é€ 204 çŠ¶æ€ä»£ç åˆ™å¯ä»¥é˜»æ­¢æµè§ˆå™¨ç»§ç»­åˆ·æ–°ï¼Œä¸ç®¡æ˜¯ä½¿ç”¨ Refresh å¤´è¿˜æ˜¯ <code>&lt;META HTTP-EQUIV=&quot;Refresh&quot; ...&gt;</code>ã€‚ æ³¨æ„ Refresh å¤´ä¸å±äº HTTP 1.1 æ­£å¼è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ä¸€ä¸ªæ‰©å±•ï¼Œä½† Netscape å’Œ IE éƒ½æ”¯æŒå®ƒã€‚</td>
</tr>
<tr>
<td>Server</td>
<td>æœåŠ¡å™¨åå­—ã€‚Servlet ä¸€èˆ¬ä¸è®¾ç½®è¿™ä¸ªå€¼ï¼Œè€Œæ˜¯ç”± Web æœåŠ¡å™¨è‡ªå·±è®¾ç½®ã€‚</td>
</tr>
<tr>
<td>Set-Cookie</td>
<td>è®¾ç½®å’Œé¡µé¢å…³è”çš„ Cookieã€‚Servlet ä¸åº”ä½¿ç”¨<code>response.setHeader(&quot;Set-Cookie&quot;, ...)</code>ï¼Œè€Œæ˜¯åº”ä½¿ç”¨ HttpServletResponse æä¾›çš„ä¸“ç”¨æ–¹æ³• addCookieã€‚å‚è§ä¸‹æ–‡æœ‰å…³ Cookie è®¾ç½®çš„è®¨è®ºã€‚</td>
</tr>
<tr>
<td>WWW-Authenticate</td>
<td>å®¢æˆ·åº”è¯¥åœ¨ Authorization å¤´ä¸­æä¾›ä»€ä¹ˆç±»å‹çš„æˆæƒä¿¡æ¯ï¼Ÿåœ¨åŒ…å« 401ï¼ˆUnauthorizedï¼‰çŠ¶æ€è¡Œçš„åº”ç­”ä¸­è¿™ä¸ªå¤´æ˜¯å¿…éœ€çš„ã€‚ä¾‹å¦‚ï¼Œ<code>response.setHeader(&quot;WWW-Authenticate&quot;, &quot;BASIC realm=ï¼¼&quot;executivesï¼¼&quot;&quot;)</code>ã€‚ æ³¨æ„ Servlet ä¸€èˆ¬ä¸è¿›è¡Œè¿™æ–¹é¢çš„å¤„ç†ï¼Œè€Œæ˜¯è®© Web æœåŠ¡å™¨çš„ä¸“é—¨æœºåˆ¶æ¥æ§åˆ¶å—å¯†ç ä¿æŠ¤é¡µé¢çš„è®¿é—®ï¼ˆä¾‹å¦‚.htaccessï¼‰ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="http-å“åº”çŠ¶æ€ç "><a class="markdownIt-Anchor" href="#http-å“åº”çŠ¶æ€ç "></a> HTTP å“åº”çŠ¶æ€ç </h4>
<p>å½“æµè§ˆè€…è®¿é—®ä¸€ä¸ªç½‘é¡µæ—¶ï¼Œæµè§ˆè€…çš„æµè§ˆå™¨ä¼šå‘ç½‘é¡µæ‰€åœ¨æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ã€‚å½“æµè§ˆå™¨æ¥æ”¶å¹¶æ˜¾ç¤ºç½‘é¡µå‰ï¼Œæ­¤ç½‘é¡µæ‰€åœ¨çš„æœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªåŒ…å« HTTP çŠ¶æ€ç çš„ä¿¡æ¯å¤´ï¼ˆserver headerï¼‰ç”¨ä»¥å“åº”æµè§ˆå™¨çš„è¯·æ±‚ã€‚</p>
<p>HTTP çŠ¶æ€ç çš„è‹±æ–‡ä¸º <strong><code>HTTP Status Code</code></strong>ã€‚</p>
<p>ä¸‹é¢æ˜¯å¸¸è§çš„ HTTP çŠ¶æ€ç ï¼š</p>
<ul>
<li><strong>200</strong> - è¯·æ±‚æˆåŠŸ</li>
<li><strong>301</strong> - èµ„æºï¼ˆç½‘é¡µç­‰ï¼‰è¢«æ°¸ä¹…è½¬ç§»åˆ°å…¶å®ƒ URL</li>
<li><strong>404</strong> - è¯·æ±‚çš„èµ„æºï¼ˆç½‘é¡µç­‰ï¼‰ä¸å­˜åœ¨</li>
<li><strong>500</strong> - å†…éƒ¨æœåŠ¡å™¨é”™è¯¯</li>
</ul>
<p>HTTP çŠ¶æ€ç åˆ†ç±»</p>
<p>HTTP çŠ¶æ€ç ç”±ä¸‰ä¸ªåè¿›åˆ¶æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªåè¿›åˆ¶æ•°å­—å®šä¹‰äº†çŠ¶æ€ç çš„ç±»å‹ï¼Œåä¸¤ä¸ªæ•°å­—æ²¡æœ‰åˆ†ç±»çš„ä½œç”¨ã€‚HTTP çŠ¶æ€ç å…±åˆ†ä¸º 5 ç§ç±»å‹ï¼š</p>
<table>
<thead>
<tr>
<th><strong>åˆ†ç±»</strong></th>
<th><strong>åˆ†ç±»æè¿°</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1xx</td>
<td><strong>ä¿¡æ¯å“åº”</strong>ã€‚æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ</td>
</tr>
<tr>
<td>2xx</td>
<td><strong>æˆåŠŸå“åº”</strong>ã€‚æ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†</td>
</tr>
<tr>
<td>3xx</td>
<td><strong>é‡å®šå‘</strong>ã€‚éœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td>4xx</td>
<td><strong>å®¢æˆ·ç«¯é”™è¯¯</strong>ã€‚è¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚</td>
</tr>
<tr>
<td>5xx</td>
<td><strong>æœåŠ¡å™¨é”™è¯¯</strong>ã€‚æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯</td>
</tr>
</tbody>
</table>
<blockquote>
<p>ğŸ”” æ›´è¯¦ç»†çš„ HTTP çŠ¶æ€ç å¯ä»¥å‚è€ƒï¼š</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status" target="_blank" rel="noopener">MDN HTTP å“åº”ä»£ç </a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes" target="_blank" rel="noopener">Wiki List of HTTP status codes</a></li>
</ul>
</blockquote>
<h2 id="https"><a class="markdownIt-Anchor" href="#https"></a> HTTPS</h2>
<p>HTTP æ˜¯æ˜æ–‡ä¼ è¾“ï¼ŒHTTPS é€šè¿‡ SSL\TLS è¿›è¡Œäº†åŠ å¯†</p>
<p>HTTP çš„ç«¯å£å·æ˜¯ 80ï¼ŒHTTPS æ˜¯ 443</p>
<p>HTTPS éœ€è¦åˆ° CA ç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦å¾ˆå°‘ï¼Œéœ€è¦äº¤è´¹</p>
<p>HTTPS çš„è¿æ¥å¾ˆç®€å•ï¼Œæ˜¯æ— çŠ¶æ€çš„ï¼›HTTPS åè®®æ˜¯ç”± SSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®å®‰å…¨ã€‚</p>
<h2 id="cookie-å’Œ-session"><a class="markdownIt-Anchor" href="#cookie-å’Œ-session"></a> Cookie å’Œ Session</h2>
<blockquote>
<p>ç”±äº Http æ˜¯ä¸€ç§æ— çŠ¶æ€çš„åè®®ï¼ŒæœåŠ¡å™¨å•ä»ç½‘ç»œè¿æ¥ä¸Šæ— ä»çŸ¥é“å®¢æˆ·èº«ä»½ã€‚</p>
<p>ä¼šè¯è·Ÿè¸ªæ˜¯ Web ç¨‹åºä¸­å¸¸ç”¨çš„æŠ€æœ¯ï¼Œç”¨æ¥è·Ÿè¸ªç”¨æˆ·çš„æ•´ä¸ªä¼šè¯ã€‚å¸¸ç”¨ä¼šè¯è·Ÿè¸ªæŠ€æœ¯æ˜¯ Cookie ä¸ Sessionã€‚</p>
</blockquote>
<h3 id="cookie"><a class="markdownIt-Anchor" href="#cookie"></a> Cookie</h3>
<p>HTTP Cookieï¼ˆä¹Ÿå« Web Cookie æˆ–æµè§ˆå™¨ Cookieï¼‰æ˜¯æœåŠ¡å™¨å‘é€åˆ°ç”¨æˆ·æµè§ˆå™¨å¹¶ä¿å­˜åœ¨æœ¬åœ°çš„ä¸€å°å—æ•°æ®ï¼Œå®ƒä¼šåœ¨æµè§ˆå™¨ä¸‹æ¬¡å‘åŒä¸€æœåŠ¡å™¨å†å‘èµ·è¯·æ±‚æ—¶è¢«æºå¸¦å¹¶å‘é€åˆ°æœåŠ¡å™¨ä¸Šã€‚é€šå¸¸ï¼Œå®ƒç”¨äºå‘ŠçŸ¥æœåŠ¡ç«¯ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€æµè§ˆå™¨ï¼Œå¦‚ä¿æŒç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚Cookie ä½¿åŸºäº<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview#HTTP_is_stateless_but_not_sessionless" target="_blank" rel="noopener">æ— çŠ¶æ€</a>çš„ HTTP åè®®è®°å½•ç¨³å®šçš„çŠ¶æ€ä¿¡æ¯æˆä¸ºäº†å¯èƒ½ã€‚</p>
<p>Cookie ä¸»è¦ç”¨äºä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>ä¼šè¯çŠ¶æ€ç®¡ç†ï¼ˆå¦‚ç”¨æˆ·ç™»å½•çŠ¶æ€ã€è´­ç‰©è½¦ã€æ¸¸æˆåˆ†æ•°æˆ–å…¶å®ƒéœ€è¦è®°å½•çš„ä¿¡æ¯ï¼‰</li>
<li>ä¸ªæ€§åŒ–è®¾ç½®ï¼ˆå¦‚ç”¨æˆ·è‡ªå®šä¹‰è®¾ç½®ã€ä¸»é¢˜ç­‰ï¼‰</li>
<li>æµè§ˆå™¨è¡Œä¸ºè·Ÿè¸ªï¼ˆå¦‚è·Ÿè¸ªåˆ†æç”¨æˆ·è¡Œä¸ºç­‰ï¼‰</li>
</ul>
<p>Cookie å·¥ä½œæ­¥éª¤ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çš„çŠ¶æ€ï¼Œå°±æ˜¯ç”¨ response å‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ª Cookieã€‚</li>
<li>å®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠ Cookie ä¿å­˜ä¸‹æ¥ã€‚</li>
<li>å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯¥è¯·æ±‚çš„ç½‘å€è¿åŒ Cookie ä¸€åŒæäº¤ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æ£€æŸ¥è¯¥ Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚</li>
</ol>
<p><strong><em>æ³¨ï¼šCookie åŠŸèƒ½éœ€è¦æµè§ˆå™¨çš„æ”¯æŒï¼Œå¦‚æœæµè§ˆå™¨ä¸æ”¯æŒ Cookie æˆ–è€… Cookie ç¦ç”¨äº†ï¼ŒCookie åŠŸèƒ½å°±ä¼šå¤±æ•ˆã€‚</em></strong></p>
<p>Java ä¸­æŠŠ Cookie å°è£…æˆäº† <code>javax.servlet.http.Cookie</code> ç±»ã€‚</p>
<p>Cookie å’Œ Http æ¶ˆæ¯ï¼š</p>
<p><code>Cookies</code> é€šå¸¸è®¾ç½®åœ¨ HTTP å¤´ä¿¡æ¯ä¸­ï¼ˆè™½ç„¶ JavaScript ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸Šè®¾ç½®ä¸€ä¸ª Cookieï¼‰ã€‚</p>
<p>è®¾ç½® Cookie çš„ Servlet ä¼šå‘é€å¦‚ä¸‹çš„å¤´ä¿¡æ¯ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Fri, <span class="number">04</span> Feb <span class="number">2000</span> <span class="number">21</span>:<span class="number">03</span>:<span class="number">38</span> GMT</span><br><span class="line">Server: Apache/<span class="number">1.3</span><span class="number">.9</span> (UNIX) PHP/<span class="number">4.0</span>b3</span><br><span class="line">Set-Cookie: name=xyz; expires=Friday, <span class="number">04</span>-Feb<span class="number">-07</span> <span class="number">22</span>:<span class="number">03</span>:<span class="number">38</span> GMT;</span><br><span class="line">                 path=/; domain=w3cschool.cc</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html</span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œ<code>Set-Cookie</code> å¤´åŒ…å«äº†ä¸€ä¸ªåç§°å€¼å¯¹ã€ä¸€ä¸ª GMT æ—¥æœŸã€ä¸€ä¸ªè·¯å¾„å’Œä¸€ä¸ªåŸŸã€‚åç§°å’Œå€¼ä¼šè¢« URL ç¼–ç ã€‚<code>expires</code> å­—æ®µæ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œå‘Šè¯‰æµè§ˆå™¨åœ¨ç»™å®šçš„æ—¶é—´å’Œæ—¥æœŸä¹‹å&quot;å¿˜è®°&quot;è¯¥ Cookieã€‚</p>
<p>å¦‚æœæµè§ˆå™¨è¢«é…ç½®ä¸ºå­˜å‚¨ Cookiesï¼Œå®ƒå°†ä¼šä¿ç•™æ­¤ä¿¡æ¯ç›´åˆ°åˆ°æœŸæ—¥æœŸã€‚å¦‚æœç”¨æˆ·çš„æµè§ˆå™¨æŒ‡å‘ä»»ä½•åŒ¹é…è¯¥ Cookie çš„è·¯å¾„å’ŒåŸŸçš„é¡µé¢ï¼Œå®ƒä¼šé‡æ–°å‘é€ Cookie åˆ°æœåŠ¡å™¨ã€‚æµè§ˆå™¨çš„å¤´ä¿¡æ¯å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> HTTP/1.0</span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/4.6 (X11; I; Linux 2.2.6-15apmac ppc)</span><br><span class="line"><span class="attribute">Host</span>: zink.demon.co.uk:1126</span><br><span class="line"><span class="attribute">Accept</span>: image/gif, */*</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip</span><br><span class="line"><span class="attribute">Accept-Language</span>: en</span><br><span class="line"><span class="attribute">Accept-Charset</span>: iso-8859-1,*,utf-8</span><br><span class="line"><span class="attribute">Cookie</span>: name=xyz</span><br></pre></td></tr></table></figure>
<h3 id="session"><a class="markdownIt-Anchor" href="#session"></a> Session</h3>
<p>ä¸åŒäº <strong>Cookie ä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­</strong>ï¼Œ<strong>Session ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Š</strong>ã€‚</p>
<p>å¦‚æœè¯´ Cookie æœºåˆ¶æ˜¯é€šè¿‡æ£€æŸ¥å®¢æˆ·èº«ä¸Šçš„â€œé€šè¡Œè¯â€æ¥ç¡®å®šå®¢æˆ·èº«ä»½çš„è¯ï¼Œé‚£ä¹ˆ Session æœºåˆ¶å°±æ˜¯é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨ä¸Šçš„â€œå®¢æˆ·æ˜ç»†è¡¨â€æ¥ç¡®è®¤å®¢æˆ·èº«ä»½ã€‚</p>
<h4 id="session-å¯¹æµè§ˆå™¨çš„è¦æ±‚"><a class="markdownIt-Anchor" href="#session-å¯¹æµè§ˆå™¨çš„è¦æ±‚"></a> Session å¯¹æµè§ˆå™¨çš„è¦æ±‚</h4>
<p>HTTP åè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œ<code>Session</code> ä¸èƒ½ä¾æ® HTTP è¿æ¥æ¥åˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€å®¢æˆ·ã€‚å› æ­¤æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æµè§ˆå™¨å‘é€ä¸€ä¸ªåä¸º <code>JESSIONID</code> çš„ Cookieï¼Œä»–çš„å€¼ä¸ºè¯¥ Session çš„ idï¼ˆä¹Ÿå°±æ˜¯ HttpSession.getId()çš„è¿”å›å€¼ï¼‰ã€‚Session ä¾æ®è¯¥ Cookie æ¥è¯†åˆ«æ˜¯å¦ä¸ºåŒä¸€ç”¨æˆ·ã€‚</p>
<p>è¯¥ Cookie ä¸ºæœåŠ¡å™¨è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œå®ƒçš„<code>maxAge</code>å±æ€§ä¸€èˆ¬ä¸º-1ï¼Œè¡¨ç¤ºä»…å½“å‰æµè§ˆå™¨å†…æœ‰æ•ˆï¼Œå¹¶ä¸”å„æµè§ˆå™¨çª—å£é—´ä¸å…±äº«ï¼Œå…³é—­æµè§ˆå™¨å°±ä¼šå¤±æ•ˆã€‚</p>
<h3 id="cookie-vs-session"><a class="markdownIt-Anchor" href="#cookie-vs-session"></a> Cookie vs. Session</h3>
<p>Cookie vs. Session å¯¹æ¯”å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>å­˜å‚¨ä½ç½®</strong>
<ul>
<li>Cookie å­˜å‚¨åœ¨æµè§ˆå™¨ã€‚
<ul>
<li>ä¸å ç”¨æœåŠ¡å™¨èµ„æºã€‚</li>
<li>ä¸€äº›å®¢æˆ·ç«¯çš„ç¨‹åºå¯èƒ½ä¼šçª¥æ¢ã€å¤åˆ¶æˆ–ä¿®æ”¹ Cookie å†…å®¹ï¼Œå®‰å…¨é£é™©æ›´å¤§ã€‚</li>
</ul>
</li>
<li>Session å­˜å‚¨åœ¨æœåŠ¡å™¨ã€‚
<ul>
<li>æ¯ä¸ªç”¨æˆ·éƒ½ä¼šäº§ç”Ÿä¸€ä¸ª Sessionï¼Œå¦‚æœå¹¶å‘è®¿é—®çš„ç”¨æˆ·éå¸¸å¤šï¼Œä¼šäº§ç”Ÿå¾ˆå¤šçš„ Sessionï¼Œæ¶ˆè€—å¤§é‡çš„å†…å­˜ã€‚</li>
<li>å¯¹å®¢æˆ·ç«¯æ˜¯é€æ˜çš„ï¼Œä¸å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²çš„å±é™©ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>å­˜å–æ–¹å¼</strong>
<ul>
<li>Cookie åªèƒ½ä¿å­˜ <code>ASCII</code> å­—ç¬¦ä¸²ï¼Œå¦‚æœéœ€è¦å­˜å– <code>Unicode</code> å­—ç¬¦æˆ–äºŒè¿›åˆ¶æ•°æ®ï¼Œéœ€è¦è¿›è¡Œ<code>UTF-8</code>ã€<code>GBK</code>æˆ–<code>BASE64</code>ç­‰æ–¹å¼çš„ç¼–ç ã€‚</li>
<li>Session å¯ä»¥å­˜å–ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œç”šè‡³æ˜¯ä»»ä½• Java ç±»ã€‚å¯ä»¥å°† Session çœ‹æˆæ˜¯ä¸€ä¸ª Java å®¹å™¨ç±»ã€‚</li>
</ul>
</li>
<li><strong>æœ‰æ•ˆæœŸ</strong>
<ul>
<li>ä½¿ç”¨ Cookie å¯ä»¥ä¿è¯é•¿æ—¶é—´ç™»å½•æœ‰æ•ˆï¼Œåªè¦è®¾ç½® Cookie çš„ <code>maxAge</code> å±æ€§ä¸ºä¸€ä¸ªå¾ˆå¤§çš„æ•°å­—ã€‚</li>
<li>è€Œ Session è™½ç„¶ç†è®ºä¸Šä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®å¾ˆå¤§çš„æ•°å€¼æ¥ä¿æŒé•¿æ—¶é—´ç™»å½•æœ‰æ•ˆï¼Œä½†æ˜¯ï¼Œç”±äº Session ä¾èµ–äºåä¸º <code>JESSIONID</code> çš„ Cookieï¼Œè€Œ Cookie <code>JESSIONID</code>çš„ <code>maxAge</code> é»˜è®¤ä¸º-1ï¼Œåªè¦å…³é—­äº†æµè§ˆå™¨è¯¥ Session å°±ä¼šå¤±æ•ˆï¼Œå› æ­¤ï¼ŒSession ä¸èƒ½å®ç°ä¿¡æ¯æ°¸ä¹…æœ‰æ•ˆçš„æ•ˆæœã€‚ä½¿ç”¨ URL åœ°å€é‡å†™ä¹Ÿä¸èƒ½å®ç°ã€‚</li>
</ul>
</li>
<li><strong>æµè§ˆå™¨çš„æ”¯æŒ</strong>
<ul>
<li>æµè§ˆå™¨å¦‚æœç¦ç”¨ Cookieï¼Œåˆ™ Cookie ä¸èƒ½ä½¿ç”¨ã€‚</li>
<li>æµè§ˆå™¨å¦‚æœç¦ç”¨ Cookieï¼Œéœ€è¦ä½¿ç”¨ Session ä»¥åŠ URL åœ°å€é‡å†™ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ‰€æœ‰çš„ç”¨åˆ° Session ç¨‹åºçš„ URL éƒ½è¦ä½¿ç”¨<code>response.encodeURL(StringURL)</code> æˆ–<code>response.encodeRediretURL(String URL)</code>è¿›è¡Œ URL åœ°å€é‡å†™ï¼Œå¦åˆ™å¯¼è‡´ Session ä¼šè¯è·Ÿè¸ªå¤±æ•ˆã€‚</li>
</ul>
</li>
<li><strong>è·¨åŸŸå</strong>
<ul>
<li>Cookie æ”¯æŒè·¨åŸŸåã€‚</li>
<li>Session ä¸æ”¯æŒè·¨åŸŸåã€‚</li>
</ul>
</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/25863515/" target="_blank" rel="noopener">ã€Šå›¾è§£ HTTPã€‹</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP" target="_blank" rel="noopener">MDN HTTP æ•™ç¨‹</a></li>
<li><a href="https://juejin.im/entry/5981c5df518825359a2b9476" target="_blank" rel="noopener">HTTP1.0ã€HTTP1.1 å’Œ HTTP2.0 çš„åŒºåˆ«</a></li>
<li><a href="http://blog.csdn.net/gueter/article/details/1524447" target="_blank" rel="noopener">http://blog.csdn.net/gueter/article/details/1524447</a></li>
<li><a href="http://www.runoob.com/http/http-intro.html" target="_blank" rel="noopener">http://www.runoob.com/http/http-intro.html</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS</a></li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
        <tag>åè®®</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œåè®®ä¹‹ ICMP</title>
    <url>/blog/communication/icmp/</url>
    <content><![CDATA[<h2 id="icmp-ç®€ä»‹"><a class="markdownIt-Anchor" href="#icmp-ç®€ä»‹"></a> ICMP ç®€ä»‹</h2>
<p>ICMP å…¨åä¸º(INTERNET CONTROL MESSAGE PROTOCOL)ç½‘ç»œæ§åˆ¶æ¶ˆæ¯åè®®ã€‚</p>
<p>ICMP çš„åè®®å·ä¸º<strong>1</strong>ã€‚</p>
<p>ICMP æŠ¥æ–‡å°±åƒæ˜¯ IP æŠ¥æ–‡çš„å°å¼Ÿï¼Œæ€»é¡¶ç€ IP æŠ¥æ–‡çš„åå¤´å‡ºæ¥æ··ã€‚å› ä¸º ICMP æŠ¥æ–‡æ˜¯åœ¨ IP æŠ¥æ–‡å†…éƒ¨çš„ï¼Œå¦‚å›¾ï¼š</p>
<div align="center"><img src="https://images2015.cnblogs.com/blog/318837/201606/318837-20160617091834260-1410966672.png"/></div>
<h2 id="icmp-ç±»å‹"><a class="markdownIt-Anchor" href="#icmp-ç±»å‹"></a> ICMP ç±»å‹</h2>
<p>ICMP æŠ¥æ–‡ä¸»è¦æœ‰ä¸¤å¤§åŠŸèƒ½ï¼šæŸ¥è¯¢æŠ¥æ–‡å’Œå·®é”™æŠ¥æ–‡ã€‚</p>
<h2 id="ç›®çš„ä¸å¯è¾¾destination-unreachable-message"><a class="markdownIt-Anchor" href="#ç›®çš„ä¸å¯è¾¾destination-unreachable-message"></a> ç›®çš„ä¸å¯è¾¾(Destination Unreachable Message)</h2>
<p>0 1 2 3</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Type | Code | Checksum |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| unused |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Internet Header + 64 bits of Original Data Datagram |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œé‚®å¯„åŒ…è£¹ä¼šç»è¿‡å¤šä¸ªä¼ é€’ç¯èŠ‚ï¼Œä»»æ„ä¸€ç¯å¦‚æœæ— æ³•ä¼ ä¸‹å»ï¼Œéƒ½ä¼šè¿”å›å¯„ä»¶äººï¼Œå¹¶é™„ä¸Šæ— æ³•é‚®å¯„çš„åŸå› ã€‚åŒç†ï¼Œå½“è·¯ç”±å™¨æ”¶åˆ°ä¸€ä¸ªæ— æ³•ä¼ é€’ä¸‹å»çš„ IP æŠ¥æ–‡æ—¶ï¼Œä¼šå‘é€ ICMP<strong>ç›®çš„ä¸å¯è¾¾æŠ¥æ–‡</strong>ï¼ˆType ä¸º 3ï¼‰ç»™ IP æŠ¥æ–‡çš„æºå‘é€æ–¹ã€‚æŠ¥æ–‡ä¸­çš„ Code å°±è¡¨ç¤ºå‘é€å¤±è´¥çš„åŸå› ã€‚</p>
<p>Code</p>
<p>0 = net unreachable;</p>
<p>1 = host unreachable;</p>
<p>2 = protocol unreachable;</p>
<p>3 = port unreachable;</p>
<p>4 = fragmentation needed and DF set;</p>
<p>5 = source route failed.</p>
<h2 id="è¶…æ—¶time-exceeded-message"><a class="markdownIt-Anchor" href="#è¶…æ—¶time-exceeded-message"></a> è¶…æ—¶(Time Exceeded Message)</h2>
<p>0 1 2 3</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Type | Code | Checksum |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| unused |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Internet Header + 64 bits of Original Data Datagram |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>ç½‘ç»œä¼ è¾“ IP æ•°æ®æŠ¥çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ IP æ•°æ®åŒ…çš„ TTL å€¼é€æ¸é€’å‡ä¸º 0 æ—¶ï¼Œéœ€è¦ä¸¢å¼ƒæ•°æ®æŠ¥ã€‚è¿™æ—¶ï¼Œè·¯ç”±å™¨éœ€è¦å‘æºå‘é€æ–¹å‘é€ <strong>ICMP è¶…æ—¶æŠ¥æ–‡</strong>(Type ä¸º 11)ï¼ŒCode ä¸º 0ï¼Œè¡¨ç¤ºä¼ è¾“è¿‡ç¨‹ä¸­è¶…æ—¶äº†ã€‚</p>
<p>ä¸€ä¸ª IP æ•°æ®æŠ¥å¯èƒ½ä¼šå› ä¸ºè¿‡å¤§è€Œè¢«åˆ†ç‰‡ï¼Œç„¶ååœ¨ç›®çš„ä¸»æœºä¾§æŠŠæ‰€æœ‰çš„åˆ†ç‰‡é‡ç»„ã€‚å¦‚æœä¸»æœºè¿Ÿè¿Ÿæ²¡æœ‰ç­‰åˆ°æ‰€æœ‰çš„åˆ†ç‰‡æŠ¥æ–‡ï¼Œå°±ä¼šå‘æºå‘é€æ–¹å‘é€ä¸€ä¸ª ICMP è¶…æ—¶æŠ¥æ–‡ï¼ŒCode ä¸º 1ï¼Œè¡¨ç¤ºåˆ†ç‰‡é‡ç»„è¶…æ—¶äº†ã€‚</p>
<h2 id="å‚æ•°é”™è¯¯æŠ¥æ–‡parameter-problem-message"><a class="markdownIt-Anchor" href="#å‚æ•°é”™è¯¯æŠ¥æ–‡parameter-problem-message"></a> å‚æ•°é”™è¯¯æŠ¥æ–‡(Parameter Problem Message)</h2>
<p>0 1 2 3</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Type | Code | Checksum |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Pointer | unused |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Internet Header + 64 bits of Original Data Datagram |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>å½“è·¯ç”±å™¨æˆ–ä¸»æœºå¤„ç†æ•°æ®æŠ¥æ—¶ï¼Œå‘ç°å› ä¸ºæŠ¥æ–‡å¤´çš„å‚æ•°é”™è¯¯è€Œä¸å¾—ä¸ä¸¢å¼ƒæŠ¥æ–‡æ—¶ï¼Œéœ€è¦å‘æºå‘é€æ–¹å‘é€<strong>å‚æ•°é”™è¯¯æŠ¥æ–‡</strong>(Type ä¸º 12)ã€‚å½“ Code ä¸º 0 æ—¶ï¼ŒæŠ¥æ–‡ä¸­çš„ Pointer è¡¨ç¤ºé”™è¯¯çš„å­—èŠ‚ä½ç½®ã€‚</p>
<h2 id="æºå†·å´source-quench-message"><a class="markdownIt-Anchor" href="#æºå†·å´source-quench-message"></a> æºå†·å´(Source Quench Message)</h2>
<p>0 1 2 3</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Type | Code | Checksum |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| unused |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Internet Header + 64 bits of Original Data Datagram |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>è·¯ç”±å™¨åœ¨å¤„ç†æŠ¥æ–‡æ—¶ä¼šæœ‰ä¸€ä¸ªç¼“å­˜é˜Ÿåˆ—ã€‚å¦‚æœè¶…è¿‡æœ€å¤§ç¼“å­˜é˜Ÿåˆ—ï¼Œå°†æ— æ³•å¤„ç†ï¼Œä»è€Œä¸¢å¼ƒæŠ¥æ–‡ã€‚å¹¶å‘æºå‘é€æ–¹å‘ä¸€ä¸ª <strong>ICMP æºå†·å´æŠ¥æ–‡</strong>(Type ä¸º 4)ï¼Œå‘Šè¯‰å¯¹æ–¹ï¼šâ€œå˜¿ï¼Œæˆ‘è¿™é‡Œå®¢æ»¡äº†ï¼Œä½ è¿Ÿç‚¹å†æ¥ã€‚â€</p>
<h2 id="é‡å®šå‘redirect-message"><a class="markdownIt-Anchor" href="#é‡å®šå‘redirect-message"></a> é‡å®šå‘(Redirect Message)</h2>
<p>0 1 2 3</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Type | Code | Checksum |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Gateway Internet Address |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Internet Header + 64 bits of Original Data Datagram |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>æƒ³åƒä¸€ä¸‹ï¼Œåœ¨å…¬å¸ä¸­ï¼Œæœ‰äººæ¥ä½ çš„é¡¹ç›®ç»„é—®ä½ æŸæŸæŸåœ¨å“ªå„¿ã€‚ä½ ä¸€æƒ³ï¼Œæˆ‘ä»¬ç»„æ²¡æœ‰è¿™äººå•Šã€‚ä½ è‚¯å®šå°±ä¼šè¯´ï¼Œæˆ‘ä»¬ç»„æ²¡æœ‰è¿™å·äººï¼Œä½ å»å…¶ä»–ç»„çœ‹çœ‹ã€‚å½“è·¯ç”±æ”¶åˆ° IP æ•°æ®æŠ¥ï¼Œå‘ç°æ•°æ®æŠ¥çš„ç›®çš„åœ°å€åœ¨è·¯ç”±è¡¨ä¸Šæ²¡æœ‰ï¼Œå®ƒå°±ä¼šå‘ <strong>ICMP é‡å®šå‘æŠ¥æ–‡</strong>(Type ä¸º 5)ç»™æºå‘é€æ–¹ï¼Œæé†’å®ƒæƒ³è¦å‘é€çš„åœ°å€ä¸åœ¨ï¼Œå»å…¶ä»–åœ°æ–¹æ‰¾æ‰¾å§ã€‚</p>
<h2 id="è¯·æ±‚å›æ˜¾æˆ–å›æ˜¾åº”ç­”echo-or-echo-reply-message"><a class="markdownIt-Anchor" href="#è¯·æ±‚å›æ˜¾æˆ–å›æ˜¾åº”ç­”echo-or-echo-reply-message"></a> è¯·æ±‚å›æ˜¾æˆ–å›æ˜¾åº”ç­”(Echo or Echo Reply Message)</h2>
<p>0 1 2 3</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Type | Code | Checksum |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Identifier | Sequence Number |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Data â€¦</p>
<p>Â±Â±Â±Â±Â±</p>
<p><strong>Type(8)<strong>æ˜¯</strong>è¯·æ±‚å›æ˜¾æŠ¥æ–‡(Echo)</strong>ï¼›Type(0)æ˜¯<strong>å›æ˜¾åº”ç­”æŠ¥æ–‡(Echo Reply)</strong>ã€‚</p>
<p>è¯·æ±‚å›æ˜¾æˆ–å›æ˜¾åº”ç­”æŠ¥æ–‡å±äºæŸ¥è¯¢æŠ¥æ–‡ã€‚Ping å°±æ˜¯ç”¨è¿™ç§æŠ¥æ–‡è¿›è¡ŒæŸ¥è¯¢å’Œå›åº”ã€‚</p>
<h2 id="æ—¶é—´æˆ³æˆ–æ—¶é—´æˆ³è¯·æ±‚timestamp-or-timestamp-reply-message"><a class="markdownIt-Anchor" href="#æ—¶é—´æˆ³æˆ–æ—¶é—´æˆ³è¯·æ±‚timestamp-or-timestamp-reply-message"></a> æ—¶é—´æˆ³æˆ–æ—¶é—´æˆ³è¯·æ±‚(Timestamp or Timestamp Reply Message)</h2>
<p>0 1 2 3</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Type | Code | Checksum |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Identifier | Sequence Number |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Originate Timestamp |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Receive Timestamp |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Transmit Timestamp |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>æ—¶é—´æˆ³æŠ¥æ–‡æ˜¯ç”¨æ¥è®°å½•æ”¶å‘ä»¥åŠä¼ è¾“æ—¶é—´çš„æŠ¥æ–‡ã€‚Originate Timestamp è®°å½•çš„æ˜¯å‘é€æ–¹å‘é€æŠ¥æ–‡çš„æ—¶åˆ»ï¼›<strong>Receive Timestamp</strong>è®°å½•çš„æ˜¯æ¥æ”¶æ–¹æ”¶åˆ°æŠ¥æ–‡çš„æ—¶åˆ»ï¼›<strong>Transmit Timestamp</strong>è¡¨ç¤ºå›æ˜¾è¿™æœ€åå‘é€æŠ¥æ–‡çš„æ—¶åˆ»ã€‚</p>
<h2 id="ä¿¡æ¯è¯·æ±‚æˆ–ä¿¡æ¯å“åº”"><a class="markdownIt-Anchor" href="#ä¿¡æ¯è¯·æ±‚æˆ–ä¿¡æ¯å“åº”"></a> ä¿¡æ¯è¯·æ±‚æˆ–ä¿¡æ¯å“åº”</h2>
<p>0 1 2 3</p>
<p>0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Type | Code | Checksum |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>| Identifier | Sequence Number |</p>
<p>Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±Â±+</p>
<p>è¿™ç§æŠ¥æ–‡æ˜¯ç”¨æ¥æ‰¾å‡ºä¸€ä¸ªä¸»æœºæ‰€åœ¨çš„ç½‘ç»œä¸ªæ•°ï¼ˆä¸€ä¸ªä¸»æœºå¯èƒ½ä¼šåœ¨å¤šä¸ªç½‘ç»œä¸­ï¼‰ã€‚æŠ¥æ–‡çš„ IP æ¶ˆæ¯å¤´çš„ç›®çš„åœ°å€ä¼šå¡«ä¸ºå…¨ 0ï¼Œè¡¨ç¤º thisï¼Œæºåœ°å€ä¼šå¡«ä¸ºæº IP æ‰€åœ¨çš„ç½‘ç»œ IPã€‚</p>
<h2 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h2>
<p><strong>å›¾ï¼šICMP çŸ¥è¯†ç‚¹æ€ç»´å¯¼å›¾</strong></p>
<div align="center"><img src="https://images2015.cnblogs.com/blog/318837/201606/318837-20160617091835838-1982473379.png"/></div>
<h2 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h2>
<ul>
<li><a href="http://www.rfc-editor.org/info/rfc792" target="_blank" rel="noopener">RFC792</a></li>
</ul>
]]></content>
      <categories>
        <category>é€šä¿¡</category>
      </categories>
      <tags>
        <tag>é€šä¿¡</tag>
        <tag>ç½‘ç»œ</tag>
        <tag>åè®®</tag>
      </tags>
  </entry>
</search>
