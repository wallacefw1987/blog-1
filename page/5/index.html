<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-minimal.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Pisces',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":true},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="Dunwu&amp;apos;s Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Dunwu">
<meta property="og:url" content="https:&#x2F;&#x2F;dunwu.github.io&#x2F;blog&#x2F;page&#x2F;5&#x2F;index.html">
<meta property="og:site_name" content="Dunwu">
<meta property="og:description" content="Dunwu&amp;apos;s Blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://dunwu.github.io/blog/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Dunwu</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/blog/atom.xml" title="Dunwu" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Dunwu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">å¤§é“è‡³ç®€ï¼ŒçŸ¥æ˜“è¡Œéš¾</h1>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/blog/about/" rel="section"><i class="fa fa-fw fa-user"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ ‡ç­¾<span class="badge">43</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»<span class="badge">11</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£<span class="badge">71</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="æœç´¢..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/dunwu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" class="post-title-link" itemprop="url">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-10-13 22:48:00" itemprop="dateCreated datePublished" datetime="2018-10-13T22:48:00+08:00">2018-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-01-16 17:48:30" itemprop="dateModified" datetime="2020-01-16T17:48:30+08:00">2020-01-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index">
                    <span itemprop="name">è®¾è®¡</span>
                  </a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E9%87%8D%E6%9E%84/" itemprop="url" rel="index">
                    <span itemprop="name">é‡æ„</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="design/refactor/ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>6.5k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>6 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/oo-abusers" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/oo-abusers</a></p>
<p><strong>æ»¥ç”¨é¢å‘å¯¹è±¡(Object-Orientation Abusers)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä»£ç éƒ¨åˆ†æˆ–å®Œå…¨åœ°è¿èƒŒäº†é¢å‘å¯¹è±¡ç¼–ç¨‹åŸåˆ™ã€‚</strong></p>
</blockquote>
<h2 id="switch-å£°æ˜"><a class="markdownIt-Anchor" href="#switch-å£°æ˜"></a> Switch å£°æ˜</h2>
<blockquote>
<p>Switch å£°æ˜(Switch Statements)</p>
<p>ä½ æœ‰ä¸€ä¸ªå¤æ‚çš„ <code>switch</code> è¯­å¥æˆ– <code>if</code> åºåˆ—è¯­å¥ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/switch-statements-1.png"/></div>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>é¢å‘å¯¹è±¡ç¨‹åºçš„ä¸€ä¸ªæœ€æ˜æ˜¾ç‰¹å¾å°±æ˜¯ï¼šå°‘ç”¨ <code>switch</code> å’Œ <code>case</code> è¯­å¥ã€‚ä»æœ¬è´¨ä¸Šè¯´ï¼Œ<code>switch</code> è¯­å¥çš„é—®é¢˜åœ¨äºé‡å¤ï¼ˆ<code>if</code> åºåˆ—ä¹ŸåŒæ ·å¦‚æ­¤ï¼‰ã€‚ä½ å¸¸ä¼šå‘ç° <code>switch</code> è¯­å¥æ•£å¸ƒäºä¸åŒåœ°ç‚¹ã€‚å¦‚æœè¦ä¸ºå®ƒæ·»åŠ ä¸€ä¸ªæ–°çš„ <code>case</code> å­å¥ï¼Œå°±å¿…é¡»æ‰¾åˆ°æ‰€æœ‰ <code>switch</code> è¯­å¥å¹¶ä¿®æ”¹å®ƒä»¬ã€‚é¢å‘å¯¹è±¡ä¸­çš„å¤šæ€æ¦‚å¿µå¯ä¸ºæ­¤å¸¦æ¥ä¼˜é›…çš„è§£å†³åŠæ³•ã€‚</p>
<p>å¤§å¤šæ•°æ—¶å€™ï¼Œä¸€çœ‹åˆ° <code>switch</code> è¯­å¥ï¼Œå°±åº”è¯¥è€ƒè™‘ä»¥å¤šæ€æ¥æ›¿æ¢å®ƒã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>é—®é¢˜æ˜¯å¤šæ€è¯¥å‡ºç°åœ¨å“ªï¼Ÿswitch è¯­å¥å¸¸å¸¸æ ¹æ®ç±»å‹ç è¿›è¡Œé€‰æ‹©ï¼Œä½ è¦çš„æ˜¯â€œä¸è¯¥ç±»å‹ç ç›¸å…³çš„å‡½æ•°æˆ–ç±»â€ï¼Œæ‰€ä»¥åº”è¯¥è¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°† <code>switch</code> è¯­å¥æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå†ä»¥ <code>æ¬ç§»å‡½æ•°(Move Method)</code> å°†å®ƒæ¬ç§»åˆ°éœ€è¦å¤šæ€æ€§çš„é‚£ä¸ªç±»é‡Œã€‚</li>
<li>å¦‚æœä½ çš„ <code>switch</code> æ˜¯åŸºäºç±»å‹ç æ¥è¯†åˆ«åˆ†æ”¯ï¼Œè¿™æ—¶å¯ä»¥è¿ç”¨ <code>ä»¥å­ç±»å–ä»£ç±»å‹ç (Replace Type Code with Subclass)</code> æˆ– <code>ä»¥çŠ¶æ€/ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç (Replace Type Code with State/Strategy)</code> ã€‚</li>
<li>ä¸€æ—¦å®Œæˆè¿™æ ·çš„ç»§æ‰¿ç»“æ„åï¼Œå°±å¯ä»¥è¿ç”¨ <code>ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼(Replace Conditional with Polymorphism)</code> äº†ã€‚</li>
<li>å¦‚æœæ¡ä»¶åˆ†æ”¯å¹¶ä¸å¤šå¹¶ä¸”å®ƒä»¬ä½¿ç”¨ä¸åŒå‚æ•°è°ƒç”¨ç›¸åŒçš„å‡½æ•°ï¼Œå¤šæ€å°±æ²¡å¿…è¦äº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥è¿ç”¨ <code>ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°(Replace Parameter with Explicit Methods)</code> ã€‚</li>
<li>å¦‚æœä½ çš„é€‰æ‹©æ¡ä»¶ä¹‹ä¸€æ˜¯ nullï¼Œå¯ä»¥è¿ç”¨ <code>å¼•å…¥ Null å¯¹è±¡(Introduce Null Object)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>æå‡ä»£ç ç»„ç»‡æ€§ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/switch-statements-2.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>å¦‚æœä¸€ä¸ª <code>switch</code> æ“ä½œåªæ˜¯æ‰§è¡Œç®€å•çš„è¡Œä¸ºï¼Œå°±æ²¡æœ‰é‡æ„çš„å¿…è¦äº†ã€‚</li>
<li><code>switch</code> å¸¸è¢«å·¥å‚è®¾è®¡æ¨¡å¼æ—ï¼ˆ<code>å·¥å‚æ–¹æ³•æ¨¡å¼(Factory Method)</code>å’Œ<code>æŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory)</code>ï¼‰æ‰€ä½¿ç”¨ï¼Œè¿™ç§æƒ…å†µä¸‹ä¹Ÿæ²¡å¿…è¦é‡æ„ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼å‡½æ•°extract-method"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¬ç§»å‡½æ•°move-method"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="ä»¥å­ç±»å–ä»£ç±»å‹ç replace-type-code-with-subclass"><a class="markdownIt-Anchor" href="#ä»¥å­ç±»å–ä»£ç±»å‹ç replace-type-code-with-subclass"></a> ä»¥å­ç±»å–ä»£ç±»å‹ç (Replace Type Code with Subclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªä¸å¯å˜çš„ç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-subclasses-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥å­ç±»å–ä»£è¿™ä¸ªç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-subclasses-after.png"/></div>
<h4 id="ä»¥çŠ¶æ€ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç replace-type-code-with-statestrategy"><a class="markdownIt-Anchor" href="#ä»¥çŠ¶æ€ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç replace-type-code-with-statestrategy"></a> ä»¥çŠ¶æ€/ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç (Replace Type Code with State/Strategy)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºï¼Œä½†ä½ æ— æ³•é€šè¿‡ç»§æ‰¿æ¶ˆé™¤å®ƒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-state-strategy-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥çŠ¶æ€å¯¹è±¡å–ä»£ç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-state-strategy-after.png"/></div>
<h4 id="ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼replace-conditional-with-polymorphism"><a class="markdownIt-Anchor" href="#ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼replace-conditional-with-polymorphism"></a> ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼(Replace Conditional with Polymorphism)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æ‰‹ä¸Šæœ‰ä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œå®ƒæ ¹æ®å¯¹è±¡ç±»å‹çš„ä¸åŒè€Œé€‰æ‹©ä¸åŒçš„è¡Œä¸ºã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">      <span class="keyword">case</span> EUROPEAN:</span><br><span class="line">        <span class="keyword">return</span> getBaseSpeed();</span><br><span class="line">      <span class="keyword">case</span> AFRICAN:</span><br><span class="line">        <span class="keyword">return</span> getBaseSpeed() - getLoadFactor() * numberOfCoconuts;</span><br><span class="line">      <span class="keyword">case</span> NORWEGIAN_BLUE:</span><br><span class="line">        <span class="keyword">return</span> (isNailed) ? <span class="number">0</span> : getBaseSpeed(voltage);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Should be unreachable"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªæ¡ä»¶è¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯æ”¾è¿›ä¸€ä¸ªå­ç±»å†…çš„è¦†å†™å‡½æ•°ä¸­ï¼Œç„¶åå°†åŸå§‹å‡½æ•°å£°æ˜ä¸ºæŠ½è±¡å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">abstract</span> <span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">European</span> <span class="keyword">extends</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getBaseSpeed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">African</span> <span class="keyword">extends</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getBaseSpeed() - getLoadFactor() * numberOfCoconuts;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NorwegianBlue</span> <span class="keyword">extends</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">double</span> <span class="title">getSpeed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (isNailed) ? <span class="number">0</span> : getBaseSpeed(voltage);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Somewhere in client code</span></span><br><span class="line">speed = bird.getSpeed();</span><br></pre></td></tr></table></figure>
<h4 id="ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°replace-parameter-with-explicit-methods"><a class="markdownIt-Anchor" href="#ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°replace-parameter-with-explicit-methods"></a> ä»¥æ˜ç¡®å‡½æ•°å–ä»£å‚æ•°(Replace Parameter with Explicit Methods)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä¸­å®Œå…¨å–å†³äºå‚æ•°å€¼è€Œé‡‡å–ä¸åŒçš„è¡Œä¸ºã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setValue</span><span class="params">(String name, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (name.equals(<span class="string">"height"</span>)) &#123;</span><br><span class="line">    height = value;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (name.equals(<span class="string">"width"</span>)) &#123;</span><br><span class="line">    width = value;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  Assert.shouldNeverReachHere();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>é’ˆå¯¹è¯¥å‚æ•°çš„æ¯ä¸€ä¸ªå¯èƒ½å€¼ï¼Œå»ºç«‹ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123;</span><br><span class="line">  height = arg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> arg)</span> </span>&#123;</span><br><span class="line">  width = arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥-null-å¯¹è±¡introduce-null-object"><a class="markdownIt-Anchor" href="#å¼•å…¥-null-å¯¹è±¡introduce-null-object"></a> å¼•å…¥ Null å¯¹è±¡(Introduce Null Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ éœ€è¦å†ä¸‰æ£€æŸ¥æŸå¯¹è±¡æ˜¯å¦ä¸º nullã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (customer == <span class="keyword">null</span>) &#123;</span><br><span class="line">  plan = BillingPlan.basic();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  plan = customer.getPlan();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°† null å€¼æ›¿æ¢ä¸º null å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NullCustomer</span> <span class="keyword">extends</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">  <span class="function">Plan <span class="title">getPlan</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> NullPlan();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Some other NULL functionality.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replace null values with Null-object.</span></span><br><span class="line">customer = (order.customer != <span class="keyword">null</span>) ? order.customer : <span class="keyword">new</span> NullCustomer();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use Null-object as if it's normal subclass.</span></span><br><span class="line">plan = customer.getPlan();</span><br></pre></td></tr></table></figure>
<h2 id="ä¸´æ—¶å­—æ®µ"><a class="markdownIt-Anchor" href="#ä¸´æ—¶å­—æ®µ"></a> ä¸´æ—¶å­—æ®µ</h2>
<blockquote>
<p>ä¸´æ—¶å­—æ®µ(Temporary Field)çš„å€¼åªåœ¨ç‰¹å®šç¯å¢ƒä¸‹æœ‰æ„ä¹‰ï¼Œç¦»å¼€è¿™ä¸ªç¯å¢ƒï¼Œå®ƒä»¬å°±ä»€ä¹ˆä¹Ÿä¸æ˜¯äº†ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/temporary-field-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>æœ‰æ—¶ä½ ä¼šçœ‹åˆ°è¿™æ ·çš„å¯¹è±¡ï¼šå…¶å†…æŸä¸ªå®ä¾‹å˜é‡ä»…ä¸ºæŸç§ç‰¹å®šæƒ…å†µè€Œè®¾ã€‚è¿™æ ·çš„ä»£ç è®©äººä¸æ˜“ç†è§£ï¼Œå› ä¸ºä½ é€šå¸¸è®¤ä¸ºå¯¹è±¡åœ¨æ‰€æœ‰æ—¶å€™éƒ½éœ€è¦å®ƒçš„æ‰€æœ‰å˜é‡ã€‚åœ¨å˜é‡æœªè¢«ä½¿ç”¨çš„æƒ…å†µä¸‹çŒœæµ‹å½“åˆè®¾ç½®ç›®çš„ï¼Œä¼šè®©ä½ å‘ç–¯ã€‚<br />
é€šå¸¸ï¼Œä¸´æ—¶å­—æ®µæ˜¯åœ¨æŸä¸€ç®—æ³•éœ€è¦å¤§é‡è¾“å…¥æ—¶è€Œåˆ›å»ºã€‚å› æ­¤ï¼Œä¸ºäº†é¿å…å‡½æ•°æœ‰è¿‡å¤šå‚æ•°ï¼Œç¨‹åºå‘˜å†³å®šåœ¨ç±»ä¸­åˆ›å»ºè¿™äº›æ•°æ®çš„ä¸´æ—¶å­—æ®µã€‚è¿™äº›ä¸´æ—¶å­—æ®µä»…ä»…åœ¨ç®—æ³•ä¸­ä½¿ç”¨ï¼Œå…¶ä»–æ—¶å€™å´æ¯«æ— ç”¨å¤„ã€‚<br />
è¿™ç§ä»£ç ä¸å¥½ç†è§£ã€‚ä½ æœŸæœ›æŸ¥çœ‹å¯¹è±¡å­—æ®µçš„æ•°æ®ï¼Œä½†æ˜¯å‡ºäºæŸç§åŸå› ï¼Œå®ƒä»¬æ€»æ˜¯ä¸ºç©ºã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¯ä»¥é€šè¿‡ <code>æç‚¼ç±»(Extract Class)</code> å°†ä¸´æ—¶å­—æ®µå’Œæ“ä½œå®ƒä»¬çš„æ‰€æœ‰ä»£ç æç‚¼åˆ°ä¸€ä¸ªå•ç‹¬çš„ç±»ä¸­ã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥è¿ç”¨ <code>ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°(Replace Method with Method Object)</code> æ¥å®ç°åŒæ ·çš„ç›®çš„ã€‚</li>
<li><code>å¼•å…¥ Null å¯¹è±¡(Introduce Null Object)</code> åœ¨â€œå˜é‡ä¸åˆæ³•â€çš„æƒ…å†µä¸‹åˆ›å»ºä¸€ä¸ª null å¯¹è±¡ï¼Œä»è€Œé¿å…å†™å‡ºæ¡ä»¶è¡¨è¾¾å¼ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/temporary-field-2.png"/></div>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>æ›´å¥½çš„ä»£ç æ¸…æ™°åº¦å’Œç»„ç»‡æ€§ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/temporary-field-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°replace-method-with-method-object"><a class="markdownIt-Anchor" href="#ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°replace-method-with-method-object"></a> ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°(Replace Method with Method Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªè¿‡é•¿å‡½æ•°ï¼Œå®ƒçš„å±€éƒ¨å˜é‡äº¤ç»‡åœ¨ä¸€èµ·ï¼Œä»¥è‡´äºä½ æ— æ³•åº”ç”¨æç‚¼å‡½æ•°(Extract Method) ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">price</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> primaryBasePrice;</span><br><span class="line">    <span class="keyword">double</span> secondaryBasePrice;</span><br><span class="line">    <span class="keyword">double</span> tertiaryBasePrice;</span><br><span class="line">    <span class="comment">// long computation.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†å‡½æ•°ç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç±»ä¸­ï¼Œä½¿å¾—å±€éƒ¨å˜é‡æˆäº†è¿™ä¸ªç±»çš„å­—æ®µã€‚ç„¶åï¼Œä½ å¯ä»¥å°†å‡½æ•°åˆ†å‰²æˆè¿™ä¸ªç±»ä¸­çš„å¤šä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">price</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> PriceCalculator(<span class="keyword">this</span>).compute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriceCalculator</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> primaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> secondaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> tertiaryBasePrice;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PriceCalculator</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// copy relevant information from order object.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">compute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// long computation.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥-null-å¯¹è±¡introduce-null-object-2"><a class="markdownIt-Anchor" href="#å¼•å…¥-null-å¯¹è±¡introduce-null-object-2"></a> å¼•å…¥ Null å¯¹è±¡(Introduce Null Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ éœ€è¦å†ä¸‰æ£€æŸ¥æŸå¯¹è±¡æ˜¯å¦ä¸º nullã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (customer == <span class="keyword">null</span>) &#123;</span><br><span class="line">  plan = BillingPlan.basic();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  plan = customer.getPlan();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°† null å€¼æ›¿æ¢ä¸º null å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NullCustomer</span> <span class="keyword">extends</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">  <span class="function">Plan <span class="title">getPlan</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> NullPlan();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Some other NULL functionality.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replace null values with Null-object.</span></span><br><span class="line">customer = (order.customer != <span class="keyword">null</span>) ? order.customer : <span class="keyword">new</span> NullCustomer();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use Null-object as if it's normal subclass.</span></span><br><span class="line">plan = customer.getPlan();</span><br></pre></td></tr></table></figure>
<h2 id="å¼‚æ›²åŒå·¥çš„ç±»"><a class="markdownIt-Anchor" href="#å¼‚æ›²åŒå·¥çš„ç±»"></a> å¼‚æ›²åŒå·¥çš„ç±»</h2>
<blockquote>
<p>å¼‚æ›²åŒå·¥çš„ç±»(Alternative Classes with Different Interfaces)</p>
<p>ä¸¤ä¸ªç±»ä¸­æœ‰ç€ä¸åŒçš„å‡½æ•°ï¼Œå´åœ¨åšç€åŒä¸€ä»¶äº‹ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/alternative-classes-with-different-interfaces-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>è¿™ç§æƒ…å†µå¾€å¾€æ˜¯å› ä¸ºï¼šåˆ›å»ºè¿™ä¸ªç±»çš„ç¨‹åºå‘˜å¹¶ä¸çŸ¥é“å·²ç»æœ‰å®ç°è¿™ä¸ªåŠŸèƒ½çš„ç±»å­˜åœ¨äº†ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-3"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-3"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä¸¤ä¸ªå‡½æ•°åšåŒä¸€ä»¶äº‹ï¼Œå´æœ‰ç€ä¸åŒçš„ç­¾åï¼Œè¯·è¿ç”¨ <code>å‡½æ•°æ”¹å(Rename Method)</code> æ ¹æ®å®ƒä»¬çš„ç”¨é€”é‡æ–°å‘½åã€‚</li>
<li>è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> ã€ <code>æ·»åŠ å‚æ•°(Add Parameter)</code> å’Œ <code>ä»¤å‡½æ•°æºå¸¦å‚æ•°(Parameterize Method)</code> æ¥ä½¿å¾—æ–¹æ³•çš„åç§°å’Œå®ç°ä¸€è‡´ã€‚</li>
<li>å¦‚æœä¸¤ä¸ªç±»ä»…æœ‰éƒ¨åˆ†åŠŸèƒ½æ˜¯é‡å¤çš„ï¼Œå°è¯•è¿ç”¨ <code>æç‚¼è¶…ç±»(Extract Superclass)</code> ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå·²å­˜åœ¨çš„ç±»å°±æˆäº†è¶…ç±»ã€‚</li>
<li>å½“æœ€ç»ˆé€‰æ‹©å¹¶è¿ç”¨æŸç§æ–¹æ³•æ¥é‡æ„åï¼Œä¹Ÿè®¸ä½ å°±èƒ½åˆ é™¤å…¶ä¸­ä¸€ä¸ªç±»äº†ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>æ¶ˆé™¤äº†ä¸å¿…è¦çš„é‡å¤ä»£ç ï¼Œä¸ºä»£ç ç˜¦èº«äº†ã€‚</li>
<li>ä»£ç æ›´æ˜“è¯»ï¼ˆä¸å†éœ€è¦çŒœæµ‹ä¸ºä»€ä¹ˆè¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ç›¸åŒçš„ç±»ï¼‰ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/alternative-classes-with-different-interfaces-2.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥-2"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-2"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶åˆå¹¶ç±»æ˜¯ä¸å¯èƒ½çš„ï¼Œæˆ–è€…æ˜¯å¦‚æ­¤å›°éš¾ä»¥è‡³äºæ²¡æœ‰æ„ä¹‰ã€‚ä¾‹å¦‚ï¼šä¸¤ä¸ªåŠŸèƒ½ç›¸ä¼¼çš„ç±»å­˜åœ¨äºä¸åŒçš„ lib åº“ä¸­ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="å‡½æ•°æ”¹årename-method"><a class="markdownIt-Anchor" href="#å‡½æ•°æ”¹årename-method"></a> å‡½æ•°æ”¹å(Rename Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å‡½æ•°çš„åç§°æœªèƒ½æ°å½“çš„æ­ç¤ºå‡½æ•°çš„ç”¨é€”ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getsnm</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ä¿®æ”¹å‡½æ•°åã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getSecondName</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¬ç§»å‡½æ•°move-method-2"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method-2"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æ·»åŠ å‚æ•°add-parameter"><a class="markdownIt-Anchor" href="#æ·»åŠ å‚æ•°add-parameter"></a> æ·»åŠ å‚æ•°(Add Parameter)</h4>
<p><strong>é—®é¢˜</strong><br />
æŸä¸ªå‡½æ•°éœ€è¦ä»è°ƒç”¨ç«¯å¾—åˆ°æ›´å¤šä¿¡æ¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Contact <span class="title">getContact</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong><br />
ä¸ºæ­¤å‡½æ•°æ·»åŠ ä¸€ä¸ªå¯¹è±¡å‡½æ•°ï¼Œè®©æ”¹å¯¹è±¡å¸¦è¿›å‡½æ•°æ‰€éœ€ä¿¡æ¯ã€‚</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">class<span class="built_in"> Customer </span>&#123;</span><br><span class="line">  public Contact getContact(Date date);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä»¤å‡½æ•°æºå¸¦å‚æ•°parameterize-method"><a class="markdownIt-Anchor" href="#ä»¤å‡½æ•°æºå¸¦å‚æ•°parameterize-method"></a> ä»¤å‡½æ•°æºå¸¦å‚æ•°(Parameterize Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>è‹¥å¹²å‡½æ•°åšäº†ç±»ä¼¼çš„å·¥ä½œï¼Œä½†åœ¨å‡½æ•°æœ¬ä½“ä¸­å´åŒ…å«äº†ä¸åŒçš„å€¼ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/parameterize-method-before.png"/></div>
**è§£å†³**
<p>å»ºç«‹å•ä¸€å‡½æ•°ï¼Œä»¥å‚æ•°è¡¨è¾¾å“ªäº›ä¸åŒçš„å€¼ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/parameterize-method-after.png"/></div>
<h4 id="æç‚¼è¶…ç±»extract-superclass"><a class="markdownIt-Anchor" href="#æç‚¼è¶…ç±»extract-superclass"></a> æç‚¼è¶…ç±»(Extract Superclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸¤ä¸ªç±»æœ‰ç›¸ä¼¼ç‰¹æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä¸ºè¿™ä¸¤ä¸ªç±»å»ºç«‹ä¸€ä¸ªè¶…ç±»ï¼Œå°†ç›¸åŒç‰¹æ€§ç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-after.png"/></div>
<h2 id="è¢«æ‹’ç»çš„é¦ˆèµ "><a class="markdownIt-Anchor" href="#è¢«æ‹’ç»çš„é¦ˆèµ "></a> è¢«æ‹’ç»çš„é¦ˆèµ </h2>
<blockquote>
<p>è¢«æ‹’ç»çš„é¦ˆèµ (Refused Bequest)</p>
<p>å­ç±»ä»…ä»…ä½¿ç”¨çˆ¶ç±»ä¸­çš„éƒ¨åˆ†æ–¹æ³•å’Œå±æ€§ã€‚å…¶ä»–æ¥è‡ªçˆ¶ç±»çš„é¦ˆèµ æˆä¸ºäº†ç´¯èµ˜ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/refused-bequest-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -4"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -4"></a> é—®é¢˜åŸå› </h3>
<p>æœ‰äº›äººä»…ä»…æ˜¯æƒ³é‡ç”¨è¶…ç±»ä¸­çš„éƒ¨åˆ†ä»£ç è€Œåˆ›å»ºäº†å­ç±»ã€‚ä½†å®é™…ä¸Šè¶…ç±»å’Œå­ç±»å®Œå…¨ä¸åŒã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-4"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-4"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœç»§æ‰¿æ²¡æœ‰æ„ä¹‰å¹¶ä¸”å­ç±»å’Œçˆ¶ç±»ä¹‹é—´ç¡®å®æ²¡æœ‰å…±åŒç‚¹ï¼Œå¯ä»¥è¿ç”¨ <code>ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿(Replace Inheritance with Delegation)</code> æ¶ˆé™¤ç»§æ‰¿ã€‚</li>
<li>å¦‚æœç»§æ‰¿æ˜¯é€‚å½“çš„ï¼Œåˆ™å»é™¤å­ç±»ä¸­ä¸éœ€è¦çš„å­—æ®µå’Œæ–¹æ³•ã€‚è¿ç”¨ <code>æç‚¼è¶…ç±»(Extract Superclass)</code> å°†æ‰€æœ‰è¶…ç±»ä¸­å¯¹äºå­ç±»æœ‰ç”¨çš„å­—æ®µå’Œå‡½æ•°æå–å‡ºæ¥ï¼Œç½®å…¥ä¸€ä¸ªæ–°çš„è¶…ç±»ä¸­ï¼Œç„¶åè®©ä¸¤ä¸ªç±»éƒ½ç»§æ‰¿è‡ªå®ƒã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/refused-bequest-2.png"/></div>
<h3 id="æ”¶ç›Š-4"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-4"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç çš„æ¸…æ™°åº¦å’Œç»„ç»‡æ€§ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/refused-bequest-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-4"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-4"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿replace-inheritance-with-delegation"><a class="markdownIt-Anchor" href="#ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿replace-inheritance-with-delegation"></a> ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿(Replace Inheritance with Delegation)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªå­ç±»åªä½¿ç”¨è¶…ç±»æ¥å£ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–æ˜¯æ ¹æœ¬ä¸éœ€è¦ç»§æ‰¿è€Œæ¥çš„æ•°æ®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-inheritance-with-delegation-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<ol>
<li>åœ¨å­ç±»ä¸­æ–°å»ºä¸€ä¸ªå­—æ®µç”¨ä»¥ä¿å­˜è¶…ç±»ï¼›</li>
<li>è°ƒæ•´å­ç±»å‡½æ•°ï¼Œä»¤å®ƒæ”¹è€Œå§”æ‰˜è¶…ç±»ï¼›</li>
<li>ç„¶åå»æ‰ä¸¤è€…ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚</li>
</ol>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-inheritance-with-delegation-after.png"/></div>
<h4 id="æç‚¼è¶…ç±»extract-superclass-2"><a class="markdownIt-Anchor" href="#æç‚¼è¶…ç±»extract-superclass-2"></a> æç‚¼è¶…ç±»(Extract Superclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸¤ä¸ªç±»æœ‰ç›¸ä¼¼ç‰¹æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä¸ºè¿™ä¸¤ä¸ªç±»å»ºç«‹ä¸€ä¸ªè¶…ç±»ï¼Œå°†ç›¸åŒç‰¹æ€§ç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-after.png"/></div>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84/" class="post-title-link" itemprop="url">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-10-13 22:48:00" itemprop="dateCreated datePublished" datetime="2018-10-13T22:48:00+08:00">2018-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-01-16 17:48:30" itemprop="dateModified" datetime="2020-01-16T17:48:30+08:00">2020-01-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index">
                    <span itemprop="name">è®¾è®¡</span>
                  </a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E9%87%8D%E6%9E%84/" itemprop="url" rel="index">
                    <span itemprop="name">é‡æ„</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="design/refactor/ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>8.5k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>8 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/dispensables" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/dispensables</a></p>
<p><strong>éå¿…è¦çš„(Dispensables)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šè¿™æ ·çš„ä»£ç å¯æœ‰å¯æ— ï¼Œå®ƒçš„å­˜åœ¨åè€Œå½±å“æ•´ä½“ä»£ç çš„æ•´æ´å’Œå¯è¯»æ€§ã€‚</strong></p>
</blockquote>
<h2 id="å†—ä½™ç±»"><a class="markdownIt-Anchor" href="#å†—ä½™ç±»"></a> å†—ä½™ç±»</h2>
<blockquote>
<p>å†—ä½™ç±»(Lazy Class)</p>
<p>ç†è§£å’Œç»´æŠ¤æ€»æ˜¯è´¹æ—¶è´¹åŠ›çš„ã€‚å¦‚æœä¸€ä¸ªç±»ä¸å€¼å¾—ä½ èŠ±è´¹ç²¾åŠ›ï¼Œå®ƒå°±åº”è¯¥è¢«åˆ é™¤ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/lazy-class-1.png"/></div>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>ä¹Ÿè®¸ä¸€ä¸ªç±»çš„åˆå§‹è®¾è®¡æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå…¨çš„ç±»ï¼Œç„¶è€Œéšç€ä»£ç çš„å˜è¿ï¼Œå˜å¾—æ²¡ä»€ä¹ˆç”¨äº†ã€‚<br />
åˆæˆ–è€…ç±»èµ·åˆçš„è®¾è®¡æ˜¯ä¸ºäº†æ”¯æŒæœªæ¥çš„åŠŸèƒ½æ‰©å±•ï¼Œç„¶è€Œå´ä¸€ç›´æœªæ´¾ä¸Šç”¨åœºã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>æ²¡ä»€ä¹ˆç”¨çš„ç±»å¯ä»¥è¿ç”¨ <code>å°†ç±»å†…è”åŒ–(Inline Class)</code> æ¥å¹²æ‰ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/lazy-class-2.png"/></div>
<ul>
<li>å¦‚æœå­ç±»ç”¨å¤„ä¸å¤§ï¼Œè¯•è¯• <code>æŠ˜å ç»§æ‰¿ä½“ç³»(Collapse Hierarchy)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘ä»£ç é‡</li>
<li>æ˜“äºç»´æŠ¤</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶ï¼Œåˆ›å»ºå†—ä½™ç±»æ˜¯ä¸ºäº†æè¿°æœªæ¥å¼€å‘çš„æ„å›¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°è¯•åœ¨ä»£ç ä¸­ä¿æŒæ¸…æ™°å’Œç®€å•ä¹‹é—´çš„å¹³è¡¡ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="å°†ç±»å†…è”åŒ–inline-class"><a class="markdownIt-Anchor" href="#å°†ç±»å†…è”åŒ–inline-class"></a> å°†ç±»å†…è”åŒ–(Inline Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»æ²¡æœ‰åšå¤ªå¤šäº‹æƒ…ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªç±»çš„æ‰€æœ‰ç‰¹æ€§æ¬ç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­ï¼Œç„¶åç§»é™¤åŸç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-after.png"/></div>
<h4 id="æŠ˜å ç»§æ‰¿ä½“ç³»collapse-hierarchy"><a class="markdownIt-Anchor" href="#æŠ˜å ç»§æ‰¿ä½“ç³»collapse-hierarchy"></a> æŠ˜å ç»§æ‰¿ä½“ç³»(Collapse Hierarchy)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>è¶…ç±»å’Œå­ç±»ä¹‹é—´æ— å¤ªå¤§åŒºåˆ«ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/collapse-hierarchy-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†å®ƒä»¬åˆä¸ºä¸€ä½“ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/collapse-hierarchy-after.png"/></div>
<h2 id="å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§"><a class="markdownIt-Anchor" href="#å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§"></a> å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§</h2>
<blockquote>
<p>å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§(Speculative Generality)</p>
<p>å­˜åœ¨æœªè¢«ä½¿ç”¨çš„ç±»ã€å‡½æ•°ã€å­—æ®µæˆ–å‚æ•°ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/speculative-generality-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>æœ‰æ—¶ï¼Œä»£ç ä»…ä»…ä¸ºäº†æ”¯æŒæœªæ¥çš„ç‰¹æ€§è€Œäº§ç”Ÿï¼Œç„¶è€Œå´ä¸€ç›´æœªå®ç°ã€‚ç»“æœï¼Œä»£ç å˜å¾—éš¾ä»¥ç†è§£å’Œç»´æŠ¤ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä½ çš„æŸä¸ªæŠ½è±¡ç±»å…¶å®æ²¡æœ‰å¤ªå¤§ä½œç”¨ï¼Œè¯·è¿ç”¨ <code>æŠ˜å ç»§æ‰¿ä½“ç³»(Collapse Hierarch)</code> ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/speculative-generality-2.png"/></div>
<ul>
<li>ä¸å¿…è¦çš„å§”æ‰˜å¯è¿ç”¨ <code>å°†ç±»å†…è”åŒ–(Inline Class)</code> æ¶ˆé™¤ã€‚</li>
<li>æ— ç”¨çš„å‡½æ•°å¯è¿ç”¨ <code>å†…è”å‡½æ•°(Inline Method)</code> æ¶ˆé™¤ã€‚</li>
<li>å‡½æ•°ä¸­æœ‰æ— ç”¨çš„å‚æ•°åº”è¯¥è¿ç”¨ <code>ç§»é™¤å‚æ•°(Remove Parameter)</code> æ¶ˆé™¤ã€‚</li>
<li>æ— ç”¨å­—æ®µå¯ä»¥ç›´æ¥åˆ é™¤ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘ä»£ç é‡ã€‚</li>
<li>æ›´æ˜“ç»´æŠ¤ã€‚</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥-2"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-2"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>å¦‚æœä½ åœ¨ä¸€ä¸ªæ¡†æ¶ä¸Šå·¥ä½œï¼Œåˆ›å»ºæ¡†æ¶æœ¬èº«æ²¡æœ‰ä½¿ç”¨çš„åŠŸèƒ½æ˜¯éå¸¸åˆç†çš„ï¼Œåªè¦æ¡†æ¶çš„ç”¨æˆ·éœ€è¦è¿™ä¸ªåŠŸèƒ½ã€‚</li>
<li>åˆ é™¤å…ƒç´ ä¹‹å‰ï¼Œè¯·ç¡®ä¿å®ƒä»¬ä¸åœ¨å•å…ƒæµ‹è¯•ä¸­ä½¿ç”¨ã€‚å¦‚æœæµ‹è¯•éœ€è¦ä»ç±»ä¸­è·å–æŸäº›å†…éƒ¨ä¿¡æ¯æˆ–æ‰§è¡Œç‰¹æ®Šçš„æµ‹è¯•ç›¸å…³æ“ä½œï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æŠ˜å ç»§æ‰¿ä½“ç³»collapse-hierarchy-2"><a class="markdownIt-Anchor" href="#æŠ˜å ç»§æ‰¿ä½“ç³»collapse-hierarchy-2"></a> æŠ˜å ç»§æ‰¿ä½“ç³»(Collapse Hierarchy)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>è¶…ç±»å’Œå­ç±»ä¹‹é—´æ— å¤ªå¤§åŒºåˆ«ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/collapse-hierarchy-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†å®ƒä»¬åˆä¸ºä¸€ä½“ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/collapse-hierarchy-after.png"/></div>
<h4 id="å°†ç±»å†…è”åŒ–inline-class-2"><a class="markdownIt-Anchor" href="#å°†ç±»å†…è”åŒ–inline-class-2"></a> å°†ç±»å†…è”åŒ–(Inline Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»æ²¡æœ‰åšå¤ªå¤šäº‹æƒ…ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªç±»çš„æ‰€æœ‰ç‰¹æ€§æ¬ç§»åˆ°å¦ä¸€ä¸ªç±»ä¸­ï¼Œç„¶åç§»é™¤åŸç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inline-class-after.png"/></div>
<h4 id="å†…è”å‡½æ•°inline-method"><a class="markdownIt-Anchor" href="#å†…è”å‡½æ•°inline-method"></a> å†…è”å‡½æ•°(Inline Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸€ä¸ªå‡½æ•°çš„æœ¬ä½“æ¯”å‡½æ•°åæ›´æ¸…æ¥šæ˜“æ‡‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PizzaDelivery</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">getRating</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> moreThanFiveLateDeliveries() ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">boolean</span> <span class="title">moreThanFiveLateDeliveries</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> numberOfLateDeliveries &gt; <span class="number">5</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>åœ¨å‡½æ•°è°ƒç”¨ç‚¹æ’å…¥å‡½æ•°æœ¬ä½“ï¼Œç„¶åç§»é™¤è¯¥å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PizzaDelivery</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">getRating</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> numberOfLateDeliveries &gt; <span class="number">5</span> ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç§»é™¤å‚æ•°remove-parameter"><a class="markdownIt-Anchor" href="#ç§»é™¤å‚æ•°remove-parameter"></a> ç§»é™¤å‚æ•°(Remove Parameter)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å‡½æ•°æœ¬ä½“ä¸å†éœ€è¦æŸä¸ªå‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-parameter-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¯¥å‚æ•°å»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-parameter-after.png"/></div>
<h2 id="çº¯ç¨šçš„æ•°æ®ç±»"><a class="markdownIt-Anchor" href="#çº¯ç¨šçš„æ•°æ®ç±»"></a> çº¯ç¨šçš„æ•°æ®ç±»</h2>
<blockquote>
<p><code>çº¯ç¨šçš„æ•°æ®ç±»(Data Class)</code> æŒ‡çš„æ˜¯åªåŒ…å«å­—æ®µå’Œè®¿é—®å®ƒä»¬çš„ getter å’Œ setter å‡½æ•°çš„ç±»ã€‚è¿™äº›ä»…ä»…æ˜¯ä¾›å…¶ä»–ç±»ä½¿ç”¨çš„æ•°æ®å®¹å™¨ã€‚è¿™äº›ç±»ä¸åŒ…å«ä»»ä½•é™„åŠ åŠŸèƒ½ï¼Œå¹¶ä¸”ä¸èƒ½å¯¹è‡ªå·±æ‹¥æœ‰çš„æ•°æ®è¿›è¡Œç‹¬ç«‹æ“ä½œã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/data-class-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>å½“ä¸€ä¸ªæ–°åˆ›å»ºçš„ç±»åªåŒ…å«å‡ ä¸ªå…¬å…±å­—æ®µï¼ˆç”šè‡³å¯èƒ½å‡ ä¸ª getters / settersï¼‰æ˜¯å¾ˆæ­£å¸¸çš„ã€‚ä½†æ˜¯å¯¹è±¡çš„çœŸæ­£åŠ›é‡åœ¨äºå®ƒä»¬å¯ä»¥åŒ…å«ä½œç”¨äºæ•°æ®çš„è¡Œä¸ºç±»å‹æˆ–æ“ä½œã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-3"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-3"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä¸€ä¸ªç±»æœ‰å…¬å…±å­—æ®µï¼Œä½ åº”è¯¥è¿ç”¨ <code>å°è£…å­—æ®µ(Encapsulated Field)</code> æ¥éšè—å­—æ®µçš„ç›´æ¥è®¿é—®æ–¹å¼ã€‚</li>
<li>å¦‚æœè¿™äº›ç±»å«å®¹å™¨ç±»çš„å­—æ®µï¼Œä½ åº”è¯¥æ£€æŸ¥å®ƒä»¬æ˜¯ä¸æ˜¯å¾—åˆ°äº†æ°å½“çš„å°è£…ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±è¿ç”¨ <code>å°è£…é›†åˆ(Encapsulated Collection)</code> æŠŠå®ƒä»¬å°è£…èµ·æ¥ã€‚</li>
<li>æ‰¾å‡ºè¿™äº› getter/setter å‡½æ•°è¢«å…¶ä»–ç±»è¿ç”¨çš„åœ°ç‚¹ã€‚å°è¯•ä»¥ <code>æ¬ç§»å‡½æ•°(Move Method)</code> æŠŠé‚£äº›è°ƒç”¨è¡Œä¸ºæ¬ç§»åˆ° <code>çº¯ç¨šçš„æ•°æ®ç±»(Data Class)</code> æ¥ã€‚å¦‚æœæ— æ³•æ¬ç§»è¿™ä¸ªå‡½æ•°ï¼Œå°±è¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> äº§ç”Ÿä¸€ä¸ªå¯æ¬ç§»çš„å‡½æ•°ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/data-class-2.png"/></div>
<ul>
<li>åœ¨ç±»å·²ç»å……æ»¡äº†æ·±æ€ç†Ÿè™‘çš„å‡½æ•°ä¹‹åï¼Œä½ å¯èƒ½æƒ³è¦æ‘†è„±æ—§çš„æ•°æ®è®¿é—®æ–¹æ³•ï¼Œä»¥æä¾›é€‚åº”é¢è¾ƒå¹¿çš„ç±»æ•°æ®è®¿é—®æ¥å£ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥è¿ç”¨ <code>ç§»é™¤è®¾ç½®å‡½æ•°(Remove Setting Method)</code> å’Œ <code>éšè—å‡½æ•°(Hide Method)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç çš„å¯è¯»æ€§å’Œç»„ç»‡æ€§ã€‚ç‰¹å®šæ•°æ®çš„æ“ä½œç°åœ¨è¢«é›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œè€Œä¸æ˜¯åœ¨åˆ†æ•£åœ¨ä»£ç å„å¤„ã€‚</li>
<li>å¸®åŠ©ä½ å‘ç°å®¢æˆ·ç«¯ä»£ç çš„é‡å¤å¤„ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="å°è£…å­—æ®µencapsulated-field"><a class="markdownIt-Anchor" href="#å°è£…å­—æ®µencapsulated-field"></a> å°è£…å­—æ®µ(Encapsulated Field)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç±»ä¸­å­˜åœ¨ public å­—æ®µã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="symbol">Person</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†å®ƒå£°æ˜ä¸º privateï¼Œå¹¶æä¾›ç›¸åº”çš„è®¿é—®å‡½æ•°ã€‚</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(<span class="keyword">String</span> arg)</span> </span>&#123;</span><br><span class="line">    name = arg;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å°è£…é›†åˆencapsulated-collection"><a class="markdownIt-Anchor" href="#å°è£…é›†åˆencapsulated-collection"></a> å°è£…é›†åˆ(Encapsulated Collection)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æœ‰ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªé›†åˆã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/encapsulate-collection-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>è®©è¯¥å‡½æ•°è¿”å›è¯¥é›†åˆçš„ä¸€ä¸ªåªè¯»å‰¯æœ¬ï¼Œå¹¶åœ¨è¿™ä¸ªç±»ä¸­æä¾›æ·»åŠ ã€ç§»é™¤é›†åˆå…ƒç´ çš„å‡½æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/encapsulate-collection-after.png"/></div>
<h4 id="æ¬ç§»å‡½æ•°move-method"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æç‚¼å‡½æ•°extract-method"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç§»é™¤è®¾ç½®å‡½æ•°remove-setting-method"><a class="markdownIt-Anchor" href="#ç§»é™¤è®¾ç½®å‡½æ•°remove-setting-method"></a> ç§»é™¤è®¾ç½®å‡½æ•°(Remove Setting Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ç±»ä¸­çš„æŸä¸ªå­—æ®µåº”è¯¥åœ¨å¯¹è±¡åˆ›å»ºæ—¶è¢«è®¾å€¼ï¼Œç„¶åå°±ä¸å†æ”¹å˜ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-setting-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»æ‰è¯¥å­—æ®µçš„æ‰€æœ‰è®¾å€¼å‡½æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-setting-method-after.png"/></div>
<h4 id="éšè—å‡½æ•°hide-method"><a class="markdownIt-Anchor" href="#éšè—å‡½æ•°hide-method"></a> éšè—å‡½æ•°(Hide Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œä»æ¥æ²¡æœ‰è¢«å…¶ä»–ä»»ä½•ç±»ç”¨åˆ°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™ä¸ªå‡½æ•°ä¿®æ”¹ä¸º privateã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-method-after.png"/></div>
<h2 id="è¿‡å¤šçš„æ³¨é‡Š"><a class="markdownIt-Anchor" href="#è¿‡å¤šçš„æ³¨é‡Š"></a> è¿‡å¤šçš„æ³¨é‡Š</h2>
<blockquote>
<p>è¿‡å¤šçš„æ³¨é‡Š(Comments)</p>
<p>æ³¨é‡Šæœ¬èº«å¹¶ä¸æ˜¯åäº‹ã€‚ä½†æ˜¯å¸¸å¸¸æœ‰è¿™æ ·çš„æƒ…å†µï¼šä¸€æ®µä»£ç ä¸­å‡ºç°é•¿é•¿çš„æ³¨é‡Šï¼Œè€Œå®ƒä¹‹æ‰€ä»¥å­˜åœ¨ï¼Œæ˜¯å› ä¸ºä»£ç å¾ˆç³Ÿç³•ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/comments-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -4"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -4"></a> é—®é¢˜åŸå› </h3>
<p>æ³¨é‡Šçš„ä½œè€…æ„è¯†åˆ°è‡ªå·±çš„ä»£ç ä¸ç›´è§‚æˆ–ä¸æ˜æ˜¾ï¼Œæ‰€ä»¥æƒ³ä½¿ç”¨æ³¨é‡Šæ¥è¯´æ˜è‡ªå·±çš„æ„å›¾ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ³¨é‡Šå°±åƒæ˜¯çƒ‚ä»£ç çš„é™¤è‡­å‰‚ã€‚</p>
<blockquote>
<p>æœ€å¥½çš„æ³¨é‡Šæ˜¯ä¸ºå‡½æ•°æˆ–ç±»èµ·ä¸€ä¸ªæ°å½“çš„åå­—ã€‚</p>
</blockquote>
<p>å¦‚æœä½ è§‰å¾—ä¸€ä¸ªä»£ç ç‰‡æ®µæ²¡æœ‰æ³¨é‡Šå°±æ— æ³•ç†è§£ï¼Œè¯·å…ˆå°è¯•é‡æ„ï¼Œè¯•ç€è®©æ‰€æœ‰æ³¨é‡Šéƒ½å˜å¾—å¤šä½™ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-4"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-4"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä¸€ä¸ªæ³¨é‡Šæ˜¯ä¸ºäº†è§£é‡Šä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥è¿ç”¨ <code>æç‚¼å˜é‡(Extract Variable)</code> å°†è¡¨è¾¾å¼åˆ‡åˆ†ä¸ºæ˜“ç†è§£çš„å­è¡¨è¾¾å¼ã€‚</li>
<li>å¦‚æœä½ éœ€è¦é€šè¿‡æ³¨é‡Šæ¥è§£é‡Šä¸€æ®µä»£ç åšäº†ä»€ä¹ˆï¼Œè¯·è¯•è¯• <code>æç‚¼å‡½æ•°(Extract Method)</code> ã€‚</li>
<li>å¦‚æœå‡½æ•°å·²ç»è¢«æç‚¼ï¼Œä½†ä»éœ€è¦æ³¨é‡Šå‡½æ•°åšäº†ä»€ä¹ˆï¼Œè¯•è¯•è¿ç”¨ <code>å‡½æ•°æ”¹å(Rename Method)</code> æ¥ä¸ºå‡½æ•°èµ·ä¸€ä¸ªå¯ä»¥è‡ªè§£é‡Šçš„åå­—ã€‚</li>
<li>å¦‚æœéœ€è¦å¯¹ç³»ç»ŸæŸçŠ¶æ€è¿›è¡Œæ–­è¨€ï¼Œè¯·è¿ç”¨ <code>å¼•å…¥æ–­è¨€(Introduce Assertion)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-4"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-4"></a> æ”¶ç›Š</h3>
<ul>
<li>ä»£ç å˜å¾—æ›´ç›´è§‚å’Œæ˜æ˜¾ã€‚</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥-3"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-3"></a> ä½•æ—¶å¿½ç•¥</h3>
<p>æ³¨é‡Šæœ‰æ—¶å€™å¾ˆæœ‰ç”¨ï¼š</p>
<ul>
<li>å½“è§£é‡Šä¸ºä»€ä¹ˆæŸäº‹ç‰©è¦ä»¥ç‰¹æ®Šæ–¹å¼å®ç°æ—¶ã€‚</li>
<li>å½“è§£é‡ŠæŸç§å¤æ‚ç®—æ³•æ—¶ã€‚</li>
<li>å½“ä½ å®åœ¨ä¸çŸ¥å¯ä»¥åšäº›ä»€ä¹ˆæ—¶ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-4"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-4"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼å˜é‡extract-variable"><a class="markdownIt-Anchor" href="#æç‚¼å˜é‡extract-variable"></a> æç‚¼å˜é‡(Extract Variable)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸ªéš¾ä»¥ç†è§£çš„è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">renderBanner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ((platform.toUpperCase().indexOf(<span class="string">"MAC"</span>) &gt; -<span class="number">1</span>) &amp;&amp;</span><br><span class="line">       (browser.toUpperCase().indexOf(<span class="string">"IE"</span>) &gt; -<span class="number">1</span>) &amp;&amp;</span><br><span class="line">        wasInitialized() &amp;&amp; resize &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†è¡¨è¾¾å¼çš„ç»“æœæˆ–å®ƒçš„å­è¡¨è¾¾å¼çš„ç»“æœç”¨ä¸è¨€è‡ªæ˜çš„å˜é‡æ¥æ›¿ä»£ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">renderBanner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">boolean</span> isMacOs = platform.toUpperCase().indexOf(<span class="string">"MAC"</span>) &gt; -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">boolean</span> isIE = browser.toUpperCase().indexOf(<span class="string">"IE"</span>) &gt; -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">boolean</span> wasResized = resize &gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isMacOs &amp;&amp; isIE &amp;&amp; wasInitialized() &amp;&amp; wasResized) &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æç‚¼å‡½æ•°extract-method-2"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method-2"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‡½æ•°æ”¹årename-method"><a class="markdownIt-Anchor" href="#å‡½æ•°æ”¹årename-method"></a> å‡½æ•°æ”¹å(Rename Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å‡½æ•°çš„åç§°æœªèƒ½æ°å½“çš„æ­ç¤ºå‡½æ•°çš„ç”¨é€”ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getsnm</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ä¿®æ”¹å‡½æ•°åã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getSecondName</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥æ–­è¨€introduce-assertion"><a class="markdownIt-Anchor" href="#å¼•å…¥æ–­è¨€introduce-assertion"></a> å¼•å…¥æ–­è¨€(Introduce Assertion)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸€æ®µä»£ç éœ€è¦å¯¹ç¨‹åºçŠ¶æ€åšå‡ºæŸç§å‡è®¾ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getExpenseLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// should have either expense limit or a primary project</span></span><br><span class="line">  <span class="keyword">return</span> (expenseLimit != NULL_EXPENSE) ?</span><br><span class="line">    expenseLimit:</span><br><span class="line">    primaryProject.getMemberExpenseLimit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ä»¥æ–­è¨€æ˜ç¡®è¡¨ç°è¿™ç§å‡è®¾ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getExpenseLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Assert.isTrue(expenseLimit != NULL_EXPENSE || primaryProject != <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (expenseLimit != NULL_EXPENSE) ?</span><br><span class="line">    expenseLimit:</span><br><span class="line">    primaryProject.getMemberExpenseLimit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>æ³¨ï¼šè¯·ä¸è¦æ»¥ç”¨æ–­è¨€ã€‚ä¸è¦ä½¿ç”¨å®ƒæ¥æ£€æŸ¥â€åº”è¯¥ä¸ºçœŸâ€œçš„æ¡ä»¶ï¼Œåªèƒ½ä½¿ç”¨å®ƒæ¥æ£€æŸ¥â€œä¸€å®šå¿…é¡»ä¸ºçœŸâ€çš„æ¡ä»¶ã€‚å®é™…ä¸Šï¼Œæ–­è¨€æ›´å¤šæ˜¯ç”¨äºè‡ªæˆ‘æ£€æµ‹ä»£ç çš„ä¸€ç§æ‰‹æ®µã€‚åœ¨äº§å“çœŸæ­£äº¤ä»˜æ—¶ï¼Œå¾€å¾€éƒ½ä¼šæ¶ˆé™¤æ‰€æœ‰æ–­è¨€ã€‚</em></p>
<h2 id="é‡å¤ä»£ç "><a class="markdownIt-Anchor" href="#é‡å¤ä»£ç "></a> é‡å¤ä»£ç </h2>
<blockquote>
<p>é‡å¤ä»£ç (Duplicate Code)</p>
<p>é‡å¤ä»£ç å ªç§°ä¸ºä»£ç åå‘³é“ä¹‹é¦–ã€‚æ¶ˆé™¤é‡å¤ä»£ç æ€»æ˜¯æœ‰åˆ©æ— å®³çš„ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/duplicate-code-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -5"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -5"></a> é—®é¢˜åŸå› </h3>
<p>é‡å¤ä»£ç é€šå¸¸å‘ç”Ÿåœ¨å¤šä¸ªç¨‹åºå‘˜åŒæ—¶åœ¨åŒä¸€ç¨‹åºçš„ä¸åŒéƒ¨åˆ†ä¸Šå·¥ä½œæ—¶ã€‚ç”±äºä»–ä»¬æ­£åœ¨å¤„ç†ä¸åŒçš„ä»»åŠ¡ï¼Œä»–ä»¬å¯èƒ½ä¸çŸ¥é“ä»–ä»¬çš„åŒäº‹å·²ç»å†™äº†ç±»ä¼¼çš„ä»£ç ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æ›´éšæ™¦çš„é‡å¤ï¼Œç‰¹å®šéƒ¨åˆ†çš„ä»£ç çœ‹ä¸Šå»ä¸åŒä½†å®é™…åœ¨åšåŒä¸€ä»¶äº‹ã€‚è¿™ç§é‡å¤ä»£ç å¾€å¾€éš¾ä»¥æ‰¾åˆ°å’Œæ¶ˆé™¤ã€‚</p>
<p>æœ‰æ—¶é‡å¤æ˜¯æœ‰ç›®çš„æ€§çš„ã€‚å½“æ€¥äºæ»¡è¶³ deadlineï¼Œå¹¶ä¸”ç°æœ‰ä»£ç å¯¹äºè¦äº¤ä»˜çš„ä»»åŠ¡æ˜¯â€œå‡ ä¹æ­£ç¡®çš„â€æ—¶ï¼Œæ–°æ‰‹ç¨‹åºå‘˜å¯èƒ½æ— æ³•æŠµæŠ—å¤åˆ¶å’Œç²˜è´´ç›¸å…³ä»£ç çš„è¯±æƒ‘ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¨‹åºå‘˜åªæ˜¯å¤ªæ‡’æƒ°ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-5"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-5"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>åŒä¸€ä¸ªç±»çš„ä¸¤ä¸ªå‡½æ•°å«æœ‰ç›¸åŒçš„è¡¨è¾¾å¼ï¼Œè¿™æ—¶å¯ä»¥é‡‡ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> æç‚¼å‡ºé‡å¤çš„ä»£ç ï¼Œç„¶åè®©è¿™ä¸¤ä¸ªåœ°ç‚¹éƒ½è°ƒç”¨è¢«æç‚¼å‡ºæ¥çš„é‚£æ®µä»£ç ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/duplicate-code-2.png"/></div>
<ul>
<li>å¦‚æœä¸¤ä¸ªäº’ä¸ºå…„å¼Ÿçš„å­ç±»å«æœ‰é‡å¤ä»£ç ï¼š
<ul>
<li>é¦–å…ˆå¯¹ä¸¤ä¸ªç±»éƒ½è¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> ï¼Œç„¶åå¯¹è¢«æç‚¼å‡ºæ¥çš„å‡½æ•°è¿ç”¨ <code>å‡½æ•°ä¸Šç§»(Pull Up Method)</code> ï¼Œå°†å®ƒæ¨å…¥è¶…ç±»ã€‚</li>
<li>å¦‚æœé‡å¤ä»£ç åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œè¿ç”¨ <code>æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»(Pull Up Constructor Body)</code> ã€‚</li>
<li>å¦‚æœé‡å¤ä»£ç åªæ˜¯ç›¸ä¼¼ä½†ä¸æ˜¯å®Œå…¨ç›¸åŒï¼Œè¿ç”¨ <code>å¡‘é€ æ¨¡æ¿å‡½æ•°(Form Template Method)</code> è·å¾—ä¸€ä¸ª <strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼(Template Method)</strong> ã€‚</li>
<li>å¦‚æœæœ‰äº›å‡½æ•°ä»¥ä¸åŒçš„ç®—æ³•åšç›¸åŒçš„äº‹ï¼Œä½ å¯ä»¥é€‰æ‹©å…¶ä¸­è¾ƒæ¸…æ™°åœ°ä¸€ä¸ªï¼Œå¹¶è¿ç”¨ <code>æ›¿æ¢ç®—æ³•(Substitute Algorithm)</code> å°†å…¶ä»–å‡½æ•°çš„ç®—æ³•æ›¿æ¢æ‰ã€‚</li>
</ul>
</li>
<li>å¦‚æœä¸¤ä¸ªæ¯«ä¸ç›¸å…³çš„ç±»ä¸­æœ‰é‡å¤ä»£ç ï¼š
<ul>
<li>è¯·å°è¯•è¿ç”¨ <code>æç‚¼è¶…ç±»(Extract Superclass)</code> ï¼Œä»¥ä¾¿ä¸ºç»´æŠ¤æ‰€æœ‰å…ˆå‰åŠŸèƒ½çš„è¿™äº›ç±»åˆ›å»ºä¸€ä¸ªè¶…ç±»ã€‚</li>
<li>å¦‚æœåˆ›å»ºè¶…ç±»ååˆ†å›°éš¾ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªç±»ä¸­è¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code> ï¼Œå¹¶åœ¨å¦ä¸€ä¸ªç±»ä¸­ä½¿ç”¨è¿™ä¸ªæ–°çš„ç»„ä»¶ã€‚</li>
</ul>
</li>
<li>å¦‚æœå­˜åœ¨å¤§é‡çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œå¹¶ä¸”å®ƒä»¬æ‰§è¡Œå®Œå…¨ç›¸åŒçš„ä»£ç ï¼ˆä»…ä»…æ˜¯å®ƒä»¬çš„æ¡ä»¶ä¸åŒï¼‰ï¼Œå¯ä»¥è¿ç”¨ <code>åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼(Consolidate Conditional Expression)</code> å°†è¿™äº›æ“ä½œåˆå¹¶ä¸ºå•ä¸ªæ¡ä»¶ï¼Œå¹¶è¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°†è¯¥æ¡ä»¶æ”¾å…¥ä¸€ä¸ªåå­—å®¹æ˜“ç†è§£çš„ç‹¬ç«‹å‡½æ•°ä¸­ã€‚</li>
<li>å¦‚æœæ¡ä»¶è¡¨è¾¾å¼çš„æ‰€æœ‰åˆ†æ”¯éƒ½æœ‰éƒ¨åˆ†ç›¸åŒçš„ä»£ç ç‰‡æ®µï¼šå¯ä»¥è¿ç”¨ <code>åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ(Consolidate Duplicate Conditional Fragments)</code> å°†å®ƒä»¬éƒ½å­˜åœ¨çš„ä»£ç ç‰‡æ®µç½®äºæ¡ä»¶è¡¨è¾¾å¼å¤–éƒ¨ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-5"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-5"></a> æ”¶ç›Š</h3>
<ul>
<li>åˆå¹¶é‡å¤ä»£ç ä¼šç®€åŒ–ä»£ç çš„ç»“æ„ï¼Œå¹¶å‡å°‘ä»£ç é‡ã€‚</li>
<li>ä»£ç æ›´ç®€åŒ–ã€æ›´æ˜“ç»´æŠ¤ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-5"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-5"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼å‡½æ•°extract-method-3"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method-3"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‡½æ•°ä¸Šç§»pull-up-method"><a class="markdownIt-Anchor" href="#å‡½æ•°ä¸Šç§»pull-up-method"></a> å‡½æ•°ä¸Šç§»(Pull Up Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æœ‰äº›å‡½æ•°ï¼Œåœ¨å„ä¸ªå­ç±»ä¸­äº§ç”Ÿå®Œå…¨ç›¸åŒçš„ç»“æœã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/pull-up-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¯¥å‡½æ•°ç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/pull-up-method-after.png"/></div>
<h4 id="æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»pull-up-constructor-body"><a class="markdownIt-Anchor" href="#æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»pull-up-constructor-body"></a> æ„é€ å‡½æ•°æœ¬ä½“ä¸Šç§»(Pull Up Constructor Body)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ åœ¨å„ä¸ªå­ç±»ä¸­æ‹¥æœ‰ä¸€äº›æ„é€ å‡½æ•°ï¼Œå®ƒä»¬çš„æœ¬ä½“å‡ ä¹å®Œå…¨ä¸€è‡´ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">(String name, String id, <span class="keyword">int</span> grade)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">    <span class="keyword">this</span>.grade = grade;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¶…ç±»ä¸­æ–°å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨å®ƒã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">(String name, String id, <span class="keyword">int</span> grade)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(name, id);</span><br><span class="line">    <span class="keyword">this</span>.grade = grade;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¡‘é€ æ¨¡æ¿å‡½æ•°form-template-method"><a class="markdownIt-Anchor" href="#å¡‘é€ æ¨¡æ¿å‡½æ•°form-template-method"></a> å¡‘é€ æ¨¡æ¿å‡½æ•°(Form Template Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€äº›å­ç±»ï¼Œå…¶ä¸­ç›¸åº”çš„æŸäº›å‡½æ•°ä»¥ç›¸åŒçš„é¡ºåºæ‰§è¡Œç±»ä¼¼çš„æ“ä½œï¼Œä½†å„ä¸ªæ“ä½œçš„ç»†èŠ‚ä¸Šæœ‰æ‰€ä¸åŒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/form-template-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™äº›æ“ä½œåˆ†åˆ«æ”¾è¿›ç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå¹¶ä¿æŒå®ƒä»¬éƒ½æœ‰ç›¸åŒçš„ç­¾åï¼Œäºæ˜¯åŸå‡½æ•°ä¹Ÿå°±å˜å¾—ç›¸åŒäº†ã€‚ç„¶åå°†åŸå‡½æ•°ä¸Šç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/form-template-method-after.png"/></div>
<p><em>æ³¨ï¼šè¿™é‡Œåªæåˆ°å…·ä½“åšæ³•ï¼Œå»ºè®®äº†è§£ä¸€ä¸‹æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ã€‚</em></p>
<h4 id="æ›¿æ¢ç®—æ³•substitute-algorithm"><a class="markdownIt-Anchor" href="#æ›¿æ¢ç®—æ³•substitute-algorithm"></a> æ›¿æ¢ç®—æ³•(Substitute Algorithm)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æƒ³è¦æŠŠæŸä¸ªç®—æ³•æ›¿æ¢ä¸ºå¦ä¸€ä¸ªæ›´æ¸…æ™°çš„ç®—æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">String <span class="title">foundPerson</span><span class="params">(String[] people)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; people.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">"Don"</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"Don"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">"John"</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"John"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">"Kent"</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"Kent"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†å‡½æ•°æœ¬ä½“æ›¿æ¢ä¸ºå¦ä¸€ä¸ªç®—æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">String <span class="title">foundPerson</span><span class="params">(String[] people)</span></span>&#123;</span><br><span class="line">  List candidates =</span><br><span class="line">    Arrays.asList(<span class="keyword">new</span> String[] &#123;<span class="string">"Don"</span>, <span class="string">"John"</span>, <span class="string">"Kent"</span>&#125;);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; people.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (candidates.contains(people[i])) &#123;</span><br><span class="line">      <span class="keyword">return</span> people[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æç‚¼è¶…ç±»extract-superclass"><a class="markdownIt-Anchor" href="#æç‚¼è¶…ç±»extract-superclass"></a> æç‚¼è¶…ç±»(Extract Superclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸¤ä¸ªç±»æœ‰ç›¸ä¼¼ç‰¹æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä¸ºè¿™ä¸¤ä¸ªç±»å»ºç«‹ä¸€ä¸ªè¶…ç±»ï¼Œå°†ç›¸åŒç‰¹æ€§ç§»è‡³è¶…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-superclass-after.png"/></div>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼consolidate-conditional-expression"><a class="markdownIt-Anchor" href="#åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼consolidate-conditional-expression"></a> åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼(Consolidate Conditional Expression)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ç³»åˆ—æ¡ä»¶åˆ†æ”¯ï¼Œéƒ½å¾—åˆ°ç›¸åŒç»“æœã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">disabilityAmount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (seniority &lt; <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (monthsDisabled &gt; <span class="number">12</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (isPartTime) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// compute the disability amount</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™äº›æ¡ä»¶åˆ†æ”¯åˆå¹¶ä¸ºä¸€ä¸ªæ¡ä»¶ï¼Œå¹¶å°†è¿™ä¸ªæ¡ä»¶æç‚¼ä¸ºä¸€ä¸ªç‹¬ç«‹å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">disabilityAmount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotEligableForDisability()) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// compute the disability amount</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µconsolidate-duplicate-conditional-fragments"><a class="markdownIt-Anchor" href="#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µconsolidate-duplicate-conditional-fragments"></a> åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ(Consolidate Duplicate Conditional Fragments)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>åœ¨æ¡ä»¶è¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯ä¸Šæœ‰ç€ç›¸åŒçš„ä¸€æ®µä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSpecialDeal()) &#123;</span><br><span class="line">  total = price * <span class="number">0.95</span>;</span><br><span class="line">  send();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  total = price * <span class="number">0.98</span>;</span><br><span class="line">  send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†è¿™æ®µé‡å¤ä»£ç æ¬ç§»åˆ°æ¡ä»¶è¡¨è¾¾å¼ä¹‹å¤–ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSpecialDeal()) &#123;</span><br><span class="line">  total = price * <span class="number">0.95</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  total = price * <span class="number">0.98</span>;</span><br><span class="line">&#125;</span><br><span class="line">send();</span><br></pre></td></tr></table></figure>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF/" class="post-title-link" itemprop="url">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-10-13 22:48:00" itemprop="dateCreated datePublished" datetime="2018-10-13T22:48:00+08:00">2018-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-01-16 17:48:30" itemprop="dateModified" datetime="2020-01-16T17:48:30+08:00">2020-01-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index">
                    <span itemprop="name">è®¾è®¡</span>
                  </a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E9%87%8D%E6%9E%84/" itemprop="url" rel="index">
                    <span itemprop="name">é‡æ„</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="design/refactor/ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>8.1k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>7 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/bloaters" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/bloaters</a></p>
<p><strong>ä»£ç è‡ƒè‚¿(Bloated)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä»£ç ä¸­çš„ç±»ã€å‡½æ•°ã€å­—æ®µæ²¡æœ‰ç»è¿‡åˆç†çš„ç»„ç»‡ï¼Œåªæ˜¯ç®€å•çš„å †ç Œèµ·æ¥ã€‚è¿™ä¸€ç±»å‹çš„é—®é¢˜é€šå¸¸åœ¨ä»£ç çš„åˆæœŸå¹¶ä¸æ˜æ˜¾ï¼Œä½†æ˜¯éšç€ä»£ç è§„æ¨¡çš„å¢é•¿è€Œé€æ¸ç§¯ç´¯ï¼ˆç‰¹åˆ«æ˜¯å½“æ²¡æœ‰äººåŠªåŠ›å»æ ¹é™¤å®ƒä»¬æ—¶ï¼‰ã€‚</strong></p>
</blockquote>
<h2 id="åŸºæœ¬ç±»å‹åæ‰§"><a class="markdownIt-Anchor" href="#åŸºæœ¬ç±»å‹åæ‰§"></a> åŸºæœ¬ç±»å‹åæ‰§</h2>
<blockquote>
<p>åŸºæœ¬ç±»å‹åæ‰§(Primitive Obsession)</p>
<ul>
<li>ä½¿ç”¨åŸºæœ¬ç±»å‹è€Œä¸æ˜¯å°å¯¹è±¡æ¥å®ç°ç®€å•ä»»åŠ¡ï¼ˆä¾‹å¦‚è´§å¸ã€èŒƒå›´ã€ç”µè¯å·ç å­—ç¬¦ä¸²ç­‰ï¼‰ã€‚</li>
<li>ä½¿ç”¨å¸¸é‡ç¼–ç ä¿¡æ¯ï¼ˆä¾‹å¦‚ä¸€ä¸ªç”¨äºå¼•ç”¨ç®¡ç†å‘˜æƒé™çš„å¸¸é‡<code>USER_ADMIN_ROLE = 1</code> ï¼‰ã€‚</li>
<li>ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡ä½œä¸ºå­—æ®µååœ¨æ•°ç»„ä¸­ä½¿ç”¨ã€‚</li>
</ul>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/primitive-obsession-1.png"/></div>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>ç±»ä¼¼å…¶ä»–å¤§éƒ¨åˆ†åå‘³é“ï¼ŒåŸºæœ¬ç±»å‹åæ‰§è¯ç”Ÿäºç±»åˆå»ºçš„æ—¶å€™ã€‚ä¸€å¼€å§‹ï¼Œå¯èƒ½åªæ˜¯ä¸å¤šçš„å­—æ®µï¼Œéšç€è¡¨ç¤ºçš„ç‰¹æ€§è¶Šæ¥è¶Šå¤šï¼ŒåŸºæœ¬æ•°æ®ç±»å‹å­—æ®µä¹Ÿè¶Šæ¥è¶Šå¤šã€‚</p>
<p>åŸºæœ¬ç±»å‹å¸¸å¸¸è¢«ç”¨äºè¡¨ç¤ºæ¨¡å‹çš„ç±»å‹ã€‚ä½ æœ‰ä¸€ç»„æ•°å­—æˆ–å­—ç¬¦ä¸²ç”¨æ¥è¡¨ç¤ºæŸä¸ªå®ä½“ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªåœºæ™¯ï¼šåœ¨æ¨¡æ‹Ÿåœºæ™¯ï¼Œå¤§é‡çš„å­—ç¬¦ä¸²å¸¸é‡è¢«ç”¨äºæ•°ç»„çš„ç´¢å¼•ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/primitive-obsession-2.png"/></div>
<p>å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹å’Œç»“æ„ç±»å‹ï¼ˆç±»ã€ç»“æ„ä½“ç­‰ï¼‰ã€‚ç»“æ„ç±»å‹å…è®¸ç¨‹åºå‘˜å°†åŸºæœ¬æ•°æ®ç±»å‹ç»„ç»‡èµ·æ¥ï¼Œä»¥ä»£è¡¨æŸä¸€äº‹ç‰©çš„æ¨¡å‹ã€‚</p>
<p>åŸºæœ¬æ•°æ®ç±»å‹å¯ä»¥çœ‹æˆæ˜¯æœºæ„ç±»å‹çš„ç§¯æœ¨å—ã€‚å½“åŸºæœ¬æ•°æ®ç±»å‹æ•°é‡æˆè§„æ¨¡åï¼Œå°†å®ƒä»¬æœ‰ç»„ç»‡åœ°ç»“åˆèµ·æ¥ï¼Œå¯ä»¥æ›´æ–¹ä¾¿çš„ç®¡ç†è¿™äº›æ•°æ®ã€‚</p>
<ul>
<li>å¦‚æœä½ æœ‰å¤§é‡çš„åŸºæœ¬æ•°æ®ç±»å‹å­—æ®µï¼Œå°±æœ‰å¯èƒ½å°†å…¶ä¸­éƒ¨åˆ†å­˜åœ¨é€»è¾‘è”ç³»çš„å­—æ®µç»„ç»‡èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªç±»ã€‚æ›´è¿›ä¸€æ­¥çš„æ˜¯ï¼Œå°†ä¸è¿™äº›æ•°æ®æœ‰å…³è”çš„æ–¹æ³•ä¹Ÿä¸€å¹¶ç§»å…¥ç±»ä¸­ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼Œå¯ä»¥å°è¯• <code>ä»¥ç±»å–ä»£ç±»å‹ç (Replace Type Code with Class)</code> ã€‚</li>
<li>å¦‚æœåŸºæœ¬æ•°æ®ç±»å‹å­—æ®µçš„å€¼æ˜¯ç”¨äºæ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</code> æˆ– <code>ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</code> ã€‚</li>
<li>å¦‚æœæƒ³è¦æ›¿æ¢çš„æ•°æ®å€¼æ˜¯ç±»å‹ç ï¼Œè€Œå®ƒå¹¶ä¸å½±å“è¡Œä¸ºï¼Œåˆ™å¯ä»¥è¿ç”¨ <code>ä»¥ç±»å–ä»£ç±»å‹ç (Replace Type Code with Class)</code> å°†å®ƒæ›¿æ¢æ‰ã€‚å¦‚æœä½ æœ‰ä¸ç±»å‹ç ç›¸å…³çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œå¯è¿ç”¨ <code>ä»¥å­ç±»å–ä»£ç±»å‹ç (Replace Type Code with Subclass)</code> æˆ– <code>ä»¥çŠ¶æ€/ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç (Replace Type Code with State/Strategy)</code> åŠ ä»¥å¤„ç†ã€‚</li>
<li>å¦‚æœä½ å‘ç°è‡ªå·±æ­£ä»æ•°ç»„ä¸­æŒ‘é€‰æ•°æ®ï¼Œå¯è¿ç”¨ <code>ä»¥å¯¹è±¡å–ä»£æ•°ç»„(Replace Array with Object)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>å¤šäºäº†ä½¿ç”¨å¯¹è±¡æ›¿ä»£åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä½¿å¾—ä»£ç å˜å¾—æ›´åŠ çµæ´»ã€‚</li>
<li>ä»£ç å˜å¾—æ›´åŠ æ˜“è¯»å’Œæ›´åŠ æœ‰ç»„ç»‡ã€‚ç‰¹æ®Šæ•°æ®å¯ä»¥é›†ä¸­è¿›è¡Œæ“ä½œï¼Œè€Œä¸åƒä¹‹å‰é‚£æ ·åˆ†æ•£ã€‚ä¸ç”¨å†çŒœæµ‹è¿™äº›é™Œç”Ÿçš„å¸¸é‡çš„æ„ä¹‰ä»¥åŠå®ƒä»¬ä¸ºä»€ä¹ˆåœ¨æ•°ç»„ä¸­ã€‚</li>
<li>æ›´å®¹æ˜“å‘ç°é‡å¤ä»£ç ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/primitive-obsession-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="ä»¥ç±»å–ä»£ç±»å‹ç replace-type-code-with-class"><a class="markdownIt-Anchor" href="#ä»¥ç±»å–ä»£ç±»å‹ç replace-type-code-with-class"></a> ä»¥ç±»å–ä»£ç±»å‹ç (Replace Type Code with Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ç±»ä¹‹ä¸­æœ‰ä¸€ä¸ªæ•°å€¼ç±»å‹ç ï¼Œä½†å®ƒå¹¶ä¸å½±å“ç±»çš„è¡Œä¸ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªæ–°çš„ç±»æ›¿æ¢è¯¥æ•°å€¼ç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-class-after.png"/></div>
<h4 id="å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object"><a class="markdownIt-Anchor" href="#å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object"></a> å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªå¯¹è±¡æ¥å–ä»£è¿™äº›å‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-after.png"/></div>
<h4 id="ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object"><a class="markdownIt-Anchor" href="#ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object"></a> ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange.getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange.getHigh();</span><br><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>
<h4 id="ä»¥å­ç±»å–ä»£ç±»å‹ç replace-type-code-with-subclass"><a class="markdownIt-Anchor" href="#ä»¥å­ç±»å–ä»£ç±»å‹ç replace-type-code-with-subclass"></a> ä»¥å­ç±»å–ä»£ç±»å‹ç (Replace Type Code with Subclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªä¸å¯å˜çš„ç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-subclasses-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥å­ç±»å–ä»£è¿™ä¸ªç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-subclasses-after.png"/></div>
<h4 id="ä»¥çŠ¶æ€ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç replace-type-code-with-statestrategy"><a class="markdownIt-Anchor" href="#ä»¥çŠ¶æ€ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç replace-type-code-with-statestrategy"></a> ä»¥çŠ¶æ€/ç­–ç•¥æ¨¡å¼å–ä»£ç±»å‹ç (Replace Type Code with State/Strategy)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªç±»å‹ç ï¼Œå®ƒä¼šå½±å“ç±»çš„è¡Œä¸ºï¼Œä½†ä½ æ— æ³•é€šè¿‡ç»§æ‰¿æ¶ˆé™¤å®ƒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-state-strategy-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥çŠ¶æ€å¯¹è±¡å–ä»£ç±»å‹ç ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-type-code-with-state-strategy-after.png"/></div>
<h4 id="ä»¥å¯¹è±¡å–ä»£æ•°ç»„replace-array-with-object"><a class="markdownIt-Anchor" href="#ä»¥å¯¹è±¡å–ä»£æ•°ç»„replace-array-with-object"></a> ä»¥å¯¹è±¡å–ä»£æ•°ç»„(Replace Array with Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­çš„å…ƒç´ å„è‡ªä»£è¡¨ä¸åŒçš„ä¸œè¥¿ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String[] row = <span class="keyword">new</span> String[<span class="number">3</span>];</span><br><span class="line">row[<span class="number">0</span>] = <span class="string">"Liverpool"</span>;</span><br><span class="line">row[<span class="number">1</span>] = <span class="string">"15"</span>;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ä»¥å¯¹è±¡æ›¿æ¢æ•°ç»„ã€‚å¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œä»¥ä¸€ä¸ªå­—æ®µæ¥è¡¨ç¤ºã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Performance row = <span class="keyword">new</span> Performance();</span><br><span class="line">row.setName(<span class="string">"Liverpool"</span>);</span><br><span class="line">row.setWins(<span class="string">"15"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®æ³¥å›¢"><a class="markdownIt-Anchor" href="#æ•°æ®æ³¥å›¢"></a> æ•°æ®æ³¥å›¢</h2>
<blockquote>
<p>æ•°æ®æ³¥å›¢(Data Clumps)</p>
<p>æœ‰æ—¶ï¼Œä»£ç çš„ä¸åŒéƒ¨åˆ†åŒ…å«ç›¸åŒçš„å˜é‡ç»„ï¼ˆä¾‹å¦‚ç”¨äºè¿æ¥åˆ°æ•°æ®åº“çš„å‚æ•°ï¼‰ã€‚è¿™äº›ç»‘åœ¨ä¸€èµ·å‡ºç°çš„æ•°æ®åº”è¯¥æ‹¥æœ‰è‡ªå·±çš„å¯¹è±¡ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/data-clumps-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>é€šå¸¸ï¼Œæ•°æ®æ³¥å›¢çš„å‡ºç°æ—¶å› ä¸ºç³Ÿç³•çš„ç¼–ç¨‹ç»“æ„æˆ–â€œå¤åˆ¶-ç²˜è´´å¼ç¼–ç¨‹â€ã€‚</p>
<p>æœ‰ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦æ˜¯æ•°æ®æ³¥å›¢çš„å¥½åŠæ³•ï¼šåˆ æ‰ä¼—å¤šæ•°æ®ä¸­çš„ä¸€é¡¹ã€‚è¿™ä¹ˆåšï¼Œå…¶ä»–æ•°æ®æœ‰æ²¡æœ‰å› è€Œå¤±å»æ„ä¹‰ï¼Ÿå¦‚æœå®ƒä»¬ä¸å†æœ‰æ„ä¹‰ï¼Œè¿™å°±æ˜¯ä¸ªæ˜ç¡®çš„ä¿¡å·ï¼šä½ åº”è¯¥ä¸ºå®ƒä»¬äº§ç”Ÿä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>é¦–å…ˆæ‰¾å‡ºè¿™äº›æ•°æ®ä»¥å­—æ®µå½¢å¼å‡ºç°çš„åœ°æ–¹ï¼Œè¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code> å°†å®ƒä»¬æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å¯¹è±¡ä¸­ã€‚</li>
<li>å¦‚æœæ•°æ®æ³¥å›¢åœ¨å‡½æ•°çš„å‚æ•°åˆ—ä¸­å‡ºç°ï¼Œè¿ç”¨ <code>å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</code> å°†å®ƒä»¬ç»„ç»‡æˆä¸€ä¸ªç±»ã€‚</li>
<li>å¦‚æœæ•°æ®æ³¥å›¢çš„éƒ¨åˆ†æ•°æ®å‡ºç°åœ¨å…¶ä»–å‡½æ•°ä¸­ï¼Œè€ƒè™‘è¿ç”¨ <code>ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</code> å°†æ•´ä¸ªæ•°æ®å¯¹è±¡ä¼ å…¥åˆ°å‡½æ•°ä¸­ã€‚</li>
<li>æ£€è§†ä¸€ä¸‹ä½¿ç”¨è¿™äº›å­—æ®µçš„ä»£ç ï¼Œä¹Ÿè®¸ï¼Œå°†å®ƒä»¬ç§»å…¥ä¸€ä¸ªæ•°æ®ç±»æ˜¯ä¸ªä¸é”™çš„ä¸»æ„ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç æ˜“è¯»æ€§å’Œç»„ç»‡æ€§ã€‚å¯¹äºç‰¹æ®Šæ•°æ®çš„æ“ä½œï¼Œå¯ä»¥é›†ä¸­è¿›è¡Œå¤„ç†ï¼Œè€Œä¸åƒä»¥å‰é‚£æ ·åˆ†æ•£ã€‚</li>
<li>å‡å°‘ä»£ç é‡ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/data-clumps-3.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶ä¸ºäº†å¯¹è±¡ä¸­çš„éƒ¨åˆ†æ•°æ®è€Œå°†æ•´ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œå¯èƒ½ä¼šäº§ç”Ÿè®©ä¸¤ä¸ªç±»ä¹‹é—´ä¸æ”¶æ¬¢è¿çš„ä¾èµ–å…³ç³»ï¼Œè¿™ä¸­æƒ…å†µä¸‹å¯ä»¥ä¸ä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-2"><a class="markdownIt-Anchor" href="#å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-2"></a> å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªå¯¹è±¡æ¥å–ä»£è¿™äº›å‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-after.png"/></div>
<h4 id="ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-2"><a class="markdownIt-Anchor" href="#ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-2"></a> ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange.getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange.getHigh();</span><br><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>
<h2 id="è¿‡å¤§çš„ç±»"><a class="markdownIt-Anchor" href="#è¿‡å¤§çš„ç±»"></a> è¿‡å¤§çš„ç±»</h2>
<blockquote>
<p>è¿‡å¤§çš„ç±»(Large Class)</p>
<p>ä¸€ä¸ªç±»å«æœ‰è¿‡å¤šå­—æ®µã€å‡½æ•°ã€ä»£ç è¡Œã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/large-class-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>ç±»é€šå¸¸ä¸€å¼€å§‹å¾ˆå°ï¼Œä½†æ˜¯éšç€ç¨‹åºçš„å¢é•¿è€Œé€æ¸è†¨èƒ€ã€‚</p>
<p>ç±»ä¼¼äºè¿‡é•¿å‡½æ•°ï¼Œç¨‹åºå‘˜é€šå¸¸è§‰å¾—åœ¨ä¸€ä¸ªç°å­˜ç±»ä¸­æ·»åŠ æ–°ç‰¹æ€§æ¯”åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»è¦å®¹æ˜“ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-3"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-3"></a> è§£å†³æ–¹æ³•</h3>
<p>è®¾è®¡æ¨¡å¼ä¸­æœ‰ä¸€æ¡é‡è¦åŸåˆ™ï¼šèŒè´£å•ä¸€åŸåˆ™ã€‚ä¸€ä¸ªç±»åº”è¯¥åªèµ‹äºˆå®ƒä¸€ä¸ªèŒè´£ã€‚å¦‚æœå®ƒæ‰€æ‰¿æ‹…çš„èŒè´£å¤ªå¤šï¼Œå°±è¯¥è€ƒè™‘ä¸ºå®ƒå‡å‡è´Ÿã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/large-class-2.png"/></div>
<ul>
<li>å¦‚æœè¿‡å¤§ç±»ä¸­çš„éƒ¨åˆ†è¡Œä¸ºå¯ä»¥æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç»„ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code>ã€‚</li>
<li>å¦‚æœè¿‡å¤§ç±»ä¸­çš„éƒ¨åˆ†è¡Œä¸ºå¯ä»¥ç”¨ä¸åŒæ–¹å¼å®ç°æˆ–ä½¿ç”¨äºç‰¹æ®Šåœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>æç‚¼å­ç±»(Extract Subclass)</code>ã€‚</li>
<li>å¦‚æœæœ‰å¿…è¦ä¸ºå®¢æˆ·ç«¯æä¾›ä¸€ç»„æ“ä½œå’Œè¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨ <code>æç‚¼æ¥å£(Extract Interface)</code>ã€‚</li>
<li>å¦‚æœä½ çš„è¿‡å¤§ç±»æ˜¯ä¸ª GUI ç±»ï¼Œå¯èƒ½éœ€è¦æŠŠæ•°æ®å’Œè¡Œä¸ºç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„é¢†åŸŸå¯¹è±¡å»ã€‚ä½ å¯èƒ½éœ€è¦ä¸¤è¾¹å„ä¿ç•™ä¸€äº›é‡å¤æ•°æ®ï¼Œå¹¶ä¿æŒä¸¤è¾¹åŒæ­¥ã€‚ <code>å¤åˆ¶è¢«ç›‘è§†æ•°æ®(Duplicate Observed Data)</code> å¯ä»¥å‘Šè¯‰ä½ æ€ä¹ˆåšã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>é‡æ„è¿‡å¤§çš„ç±»å¯ä»¥ä½¿ç¨‹åºå‘˜ä¸å¿…è®°ä½ä¸€ä¸ªç±»ä¸­å¤§é‡çš„å±æ€§ã€‚</li>
<li>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåˆ†å‰²è¿‡å¤§çš„ç±»å¯ä»¥é¿å…ä»£ç å’ŒåŠŸèƒ½çš„é‡å¤ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/large-class-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼ç±»extract-class-2"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class-2"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="æç‚¼å­ç±»extract-subclass"><a class="markdownIt-Anchor" href="#æç‚¼å­ç±»extract-subclass"></a> æç‚¼å­ç±»(Extract Subclass)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸€ä¸ªç±»ä¸­æœ‰äº›ç‰¹æ€§ä»…ç”¨äºç‰¹å®šåœºæ™¯ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-subclass-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åˆ›å»ºä¸€ä¸ªå­ç±»ï¼Œå¹¶å°†ç”¨äºç‰¹æ®Šåœºæ™¯çš„ç‰¹æ€§ç½®å…¥å…¶ä¸­ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-subclass-after.png"/></div>
<h4 id="æç‚¼æ¥å£extract-interface"><a class="markdownIt-Anchor" href="#æç‚¼æ¥å£extract-interface"></a> æç‚¼æ¥å£(Extract Interface)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å¤šä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ä¸€ä¸ªç±»éƒ¨åˆ†ç›¸åŒçš„å‡½æ•°ã€‚å¦ä¸€ä¸ªåœºæ™¯æ˜¯ä¸¤ä¸ªç±»ä¸­çš„éƒ¨åˆ†å‡½æ•°ç›¸åŒã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-interface-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨ç›¸åŒçš„éƒ¨åˆ†å‡½æ•°åˆ°æ¥å£ä¸­ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-interface-after.png"/></div>
<h4 id="å¤åˆ¶è¢«ç›‘è§†æ•°æ®duplicate-observed-data"><a class="markdownIt-Anchor" href="#å¤åˆ¶è¢«ç›‘è§†æ•°æ®duplicate-observed-data"></a> å¤åˆ¶è¢«ç›‘è§†æ•°æ®(Duplicate Observed Data)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å¦‚æœå­˜å‚¨åœ¨ç±»ä¸­çš„æ•°æ®æ˜¯è´Ÿè´£ GUI çš„ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/duplicate-observed-data-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯å°†è´Ÿè´£ GUI çš„æ•°æ®æ”¾å…¥ä¸€ä¸ªç‹¬ç«‹çš„ç±»ï¼Œä»¥ç¡®ä¿ GUI æ•°æ®ä¸åŸŸç±»ä¹‹é—´çš„è¿æ¥å’ŒåŒæ­¥ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/duplicate-observed-data-after.png"/></div>
<h2 id="è¿‡é•¿å‡½æ•°"><a class="markdownIt-Anchor" href="#è¿‡é•¿å‡½æ•°"></a> è¿‡é•¿å‡½æ•°</h2>
<blockquote>
<p>è¿‡é•¿å‡½æ•°(Long Method)</p>
<p>ä¸€ä¸ªå‡½æ•°å«æœ‰å¤ªå¤šè¡Œä»£ç ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä»»ä½•å‡½æ•°è¶…è¿‡ 10 è¡Œæ—¶ï¼Œä½ å°±å¯ä»¥è€ƒè™‘æ˜¯ä¸æ˜¯è¿‡é•¿äº†ã€‚<br />
å‡½æ•°ä¸­çš„ä»£ç è¡Œæ•°åŸåˆ™ä¸Šä¸è¦è¶…è¿‡ 100 è¡Œã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-method-1.png"/></div>
<h3 id="é—®é¢˜çš„åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜çš„åŸå› "></a> é—®é¢˜çš„åŸå› </h3>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°çš„éš¾åº¦è¦å¤§äºæ·»åŠ åŠŸèƒ½åˆ°ä¸€ä¸ªå·²å­˜åœ¨çš„å‡½æ•°ã€‚å¤§éƒ¨åˆ†äººéƒ½è§‰å¾—ï¼šâ€œæˆ‘å°±æ·»åŠ è¿™ä¹ˆä¸¤è¡Œä»£ç ï¼Œä¸ºæ­¤æ–°å»ºä¸€ä¸ªå‡½æ•°å®åœ¨æ˜¯å°é¢˜å¤§åšäº†ã€‚â€äºæ˜¯ï¼Œå¼ ä¸‰åŠ ä¸¤è¡Œï¼Œæå››åŠ ä¸¤è¡Œï¼Œç‹äº”åŠ ä¸¤è¡Œã€‚ã€‚ã€‚å‡½æ•°æ—¥ç›Šåºå¤§ï¼Œæœ€ç»ˆçƒ‚çš„åƒä¸€é”…æµ†ç³Šï¼Œå†ä¹Ÿæ²¡äººèƒ½å®Œå…¨çœ‹æ‡‚äº†ã€‚äºæ˜¯å¤§å®¶å°±æ›´ä¸æ•¢è½»æ˜“åŠ¨è¿™ä¸ªå‡½æ•°äº†ï¼Œåªèƒ½æ¶æ€§å¾ªç¯çš„å¾€å…¶ä¸­æ·»åŠ ä»£ç ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ çœ‹åˆ°ä¸€ä¸ªè¶…è¿‡ 200 è¡Œçš„å‡½æ•°ï¼Œé€šå¸¸éƒ½æ˜¯å¤šä¸ªç¨‹åºå‘˜ä¸œæ‹¼è¥¿å‡‘å‡ºæ¥çš„ã€‚</p>
<h3 id="è§£å†³å‡½æ•°"><a class="markdownIt-Anchor" href="#è§£å†³å‡½æ•°"></a> è§£å†³å‡½æ•°</h3>
<p>ä¸€ä¸ªå¾ˆå¥½çš„æŠ€å·§æ˜¯ï¼š<strong>å¯»æ‰¾æ³¨é‡Š</strong>ã€‚æ·»åŠ æ³¨é‡Šï¼Œä¸€èˆ¬æœ‰è¿™ä¹ˆå‡ ä¸ªåŸå› ï¼šä»£ç é€»è¾‘è¾ƒä¸ºæ™¦æ¶©æˆ–å¤æ‚ï¼›è¿™æ®µä»£ç åŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹ï¼›ç‰¹æ®Šå¤„ç†ã€‚<br />
å¦‚æœä»£ç å‰æ–¹æœ‰ä¸€è¡Œæ³¨é‡Šï¼Œå°±æ˜¯åœ¨æé†’ä½ ï¼šå¯ä»¥å°†è¿™æ®µä»£ç æ›¿æ¢æˆä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸”å¯ä»¥åœ¨æ³¨é‡Šçš„åŸºç¡€ä¸Šç»™è¿™ä¸ªå‡½æ•°å‘½åã€‚å¦‚æœå‡½æ•°æœ‰ä¸€ä¸ªæè¿°æ°å½“çš„åå­—ï¼Œå°±ä¸éœ€è¦å»çœ‹å†…éƒ¨ä»£ç ç©¶ç«Ÿæ˜¯å¦‚ä½•å®ç°çš„ã€‚å°±ç®—åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¦‚æœå®ƒéœ€è¦ä»¥æ³¨é‡Šæ¥è¯´æ˜ï¼Œé‚£ä¹Ÿå€¼å¾—å°†å®ƒæç‚¼åˆ°ç‹¬ç«‹å‡½æ•°ä¸­ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-method-2.png"/></div>
<ul>
<li>ä¸ºäº†ç»™ä¸€ä¸ªå‡½æ•°ç˜¦èº«ï¼Œå¯ä»¥ä½¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code>ã€‚</li>
<li>å¦‚æœå±€éƒ¨å˜é‡å’Œå‚æ•°å¹²æ‰°æç‚¼å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡(Replace Temp with Query)</code>ï¼Œ<code>å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</code> æˆ– <code>ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</code> ã€‚</li>
<li>å¦‚æœå‰é¢ä¸¤æ¡æ²¡æœ‰å¸®åŠ©ï¼Œå¯ä»¥é€šè¿‡ <code>ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°(Replace Method with Method Object)</code> å°è¯•ç§»åŠ¨æ•´ä¸ªå‡½æ•°åˆ°ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ä¸­ã€‚</li>
<li>æ¡ä»¶è¡¨è¾¾å¼å’Œå¾ªç¯å¸¸å¸¸ä¹Ÿæ˜¯æç‚¼çš„ä¿¡å·ã€‚å¯¹äºæ¡ä»¶è¡¨è¾¾å¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼(Decompose Conditional)</code> ã€‚è‡³äºå¾ªç¯ï¼Œåº”è¯¥ä½¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°†å¾ªç¯å’Œå…¶å†…çš„ä»£ç æç‚¼åˆ°ç‹¬ç«‹å‡½æ•°ä¸­ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-4"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-4"></a> æ”¶ç›Š</h3>
<ul>
<li>åœ¨æ‰€æœ‰ç±»å‹çš„é¢å‘å¯¹è±¡ä»£ç ä¸­ï¼Œå‡½æ•°æ¯”è¾ƒçŸ­å°ç²¾æ‚çš„ç±»å¾€å¾€ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿ã€‚ä¸€ä¸ªå‡½æ•°è¶Šé•¿ï¼Œå°±è¶Šä¸å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚</li>
<li>æ­¤å¤–ï¼Œè¿‡é•¿å‡½æ•°ä¸­å¾€å¾€å«æœ‰éš¾ä»¥å‘ç°çš„é‡å¤ä»£ç ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-method-3.png"/></div>
<h3 id="æ€§èƒ½"><a class="markdownIt-Anchor" href="#æ€§èƒ½"></a> æ€§èƒ½</h3>
<p>æ˜¯å¦åƒè®¸å¤šäººè¯´çš„é‚£æ ·ï¼Œå¢åŠ å‡½æ•°çš„æ•°é‡ä¼šå½±å“æ€§èƒ½ï¼Ÿåœ¨å‡ ä¹ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ç§å½±å“æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒã€‚<br />
æ­¤å¤–ï¼Œç°åœ¨æœ‰äº†æ¸…æ™°å’Œæ˜“è¯»çš„ä»£ç ï¼Œåœ¨éœ€è¦çš„æ—¶å€™ï¼Œä½ å°†æ›´å®¹æ˜“æ‰¾åˆ°çœŸæ­£æœ‰æ•ˆçš„å‡½æ•°æ¥é‡ç»„ä»£ç å’Œæé«˜æ€§èƒ½ã€‚</p>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-4"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-4"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æç‚¼å‡½æ•°extract-method"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡replace-temp-with-query"><a class="markdownIt-Anchor" href="#ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡replace-temp-with-query"></a> ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡(Replace Temp with Query)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å°†è¡¨è¾¾å¼çš„ç»“æœæ”¾åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œç„¶ååœ¨ä»£ç ä¸­ä½¿ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">calculateTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">double</span> basePrice = quantity * itemPrice;</span><br><span class="line">  <span class="keyword">if</span> (basePrice &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice * <span class="number">0.95</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice * <span class="number">0.98</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†æ•´ä¸ªè¡¨è¾¾å¼ç§»åŠ¨åˆ°ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ä¸­å¹¶è¿”å›ç»“æœã€‚ä½¿ç”¨æŸ¥è¯¢å‡½æ•°æ¥æ›¿ä»£ä½¿ç”¨å˜é‡ã€‚å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨å…¶ä»–å‡½æ•°ä¸­åˆå¹¶æ–°å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">calculateTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (basePrice() &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice() * <span class="number">0.95</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice() * <span class="number">0.98</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">basePrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> quantity * itemPrice;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-3"><a class="markdownIt-Anchor" href="#å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-3"></a> å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªå¯¹è±¡æ¥å–ä»£è¿™äº›å‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-after.png"/></div>
<h4 id="ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-3"><a class="markdownIt-Anchor" href="#ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-3"></a> ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange.getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange.getHigh();</span><br><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>
<h4 id="ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°replace-method-with-method-object"><a class="markdownIt-Anchor" href="#ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°replace-method-with-method-object"></a> ä»¥å‡½æ•°å¯¹è±¡å–ä»£å‡½æ•°(Replace Method with Method Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€ä¸ªè¿‡é•¿å‡½æ•°ï¼Œå®ƒçš„å±€éƒ¨å˜é‡äº¤ç»‡åœ¨ä¸€èµ·ï¼Œä»¥è‡´äºä½ æ— æ³•åº”ç”¨æç‚¼å‡½æ•°(Extract Method) ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">price</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> primaryBasePrice;</span><br><span class="line">    <span class="keyword">double</span> secondaryBasePrice;</span><br><span class="line">    <span class="keyword">double</span> tertiaryBasePrice;</span><br><span class="line">    <span class="comment">// long computation.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>å°†å‡½æ•°ç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç±»ä¸­ï¼Œä½¿å¾—å±€éƒ¨å˜é‡æˆäº†è¿™ä¸ªç±»çš„å­—æ®µã€‚ç„¶åï¼Œä½ å¯ä»¥å°†å‡½æ•°åˆ†å‰²æˆè¿™ä¸ªç±»ä¸­çš„å¤šä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">price</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> PriceCalculator(<span class="keyword">this</span>).compute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriceCalculator</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> primaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> secondaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> tertiaryBasePrice;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PriceCalculator</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// copy relevant information from order object.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">compute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// long computation.</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼decompose-conditional"><a class="markdownIt-Anchor" href="#åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼decompose-conditional"></a> åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼(Decompose Conditional)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰å¤æ‚çš„æ¡ä»¶è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (date.before(SUMMER_START) || date.after(SUMMER_END)) &#123;</span><br><span class="line">  charge = quantity * winterRate + winterServiceCharge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  charge = quantity * summerRate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ ¹æ®æ¡ä»¶åˆ†æ”¯å°†æ•´ä¸ªæ¡ä»¶è¡¨è¾¾å¼åˆ†è§£æˆå‡ ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (notSummer(date)) &#123;</span><br><span class="line">  charge = winterCharge(quantity);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  charge = summerCharge(quantity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="è¿‡é•¿å‚æ•°åˆ—"><a class="markdownIt-Anchor" href="#è¿‡é•¿å‚æ•°åˆ—"></a> è¿‡é•¿å‚æ•°åˆ—</h2>
<blockquote>
<p>è¿‡é•¿å‚æ•°åˆ—(Long Parameter List)</p>
<p>ä¸€ä¸ªå‡½æ•°æœ‰è¶…è¿‡ 3ã€4 ä¸ªå…¥å‚ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-parameter-list-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -4"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -4"></a> é—®é¢˜åŸå› </h3>
<p>è¿‡é•¿å‚æ•°åˆ—å¯èƒ½æ˜¯å°†å¤šä¸ªç®—æ³•å¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­æ—¶å‘ç”Ÿçš„ã€‚å‡½æ•°ä¸­çš„å…¥å‚å¯ä»¥ç”¨æ¥æ§åˆ¶æœ€ç»ˆé€‰ç”¨å“ªä¸ªç®—æ³•å»æ‰§è¡Œã€‚</p>
<p>è¿‡é•¿å‚æ•°åˆ—ä¹Ÿå¯èƒ½æ˜¯è§£è€¦ç±»ä¹‹é—´ä¾èµ–å…³ç³»æ—¶çš„å‰¯äº§å“ã€‚ä¾‹å¦‚ï¼Œç”¨äºåˆ›å»ºå‡½æ•°ä¸­æ‰€éœ€çš„ç‰¹å®šå¯¹è±¡çš„ä»£ç å·²ä»å‡½æ•°ç§»åŠ¨åˆ°è°ƒç”¨å‡½æ•°çš„ä»£ç å¤„ï¼Œä½†åˆ›å»ºçš„å¯¹è±¡æ˜¯ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚å› æ­¤ï¼ŒåŸå§‹ç±»ä¸å†çŸ¥é“å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶ä¸”ä¾èµ–æ€§ä¹Ÿå·²ç»å‡å°‘ã€‚ä½†æ˜¯å¦‚æœåˆ›å»ºçš„è¿™äº›å¯¹è±¡ï¼Œæ¯ä¸€ä¸ªéƒ½å°†éœ€è¦å®ƒè‡ªå·±çš„å‚æ•°ï¼Œè¿™æ„å‘³ç€è¿‡é•¿å‚æ•°åˆ—ã€‚</p>
<p>å¤ªé•¿çš„å‚æ•°åˆ—éš¾ä»¥ç†è§£ï¼Œå¤ªå¤šå‚æ•°ä¼šé€ æˆå‰åä¸ä¸€è‡´ã€ä¸æ˜“ä½¿ç”¨ï¼Œè€Œä¸”ä¸€æ—¦éœ€è¦æ›´å¤šæ•°æ®ï¼Œå°±ä¸å¾—ä¸ä¿®æ”¹å®ƒã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ¡ˆ"></a> è§£å†³æ–¹æ¡ˆ</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/long-parameter-list-2.png"/></div>
<ul>
<li>å¦‚æœå‘å·²æœ‰çš„å¯¹è±¡å‘å‡ºä¸€æ¡è¯·æ±‚å°±å¯ä»¥å–ä»£ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆä½ åº”è¯¥ä½¿ç”¨ <code>ä»¥å‡½æ•°å–ä»£å‚æ•°(Replace Parameter with Methods)</code> ã€‚åœ¨è¿™é‡Œï¼Œï¼Œâ€œå·²æœ‰çš„å¯¹è±¡â€å¯èƒ½æ˜¯å‡½æ•°æ‰€å±ç±»é‡Œçš„ä¸€ä¸ªå­—æ®µï¼Œä¹Ÿå¯èƒ½æ˜¯å¦ä¸€ä¸ªå‚æ•°ã€‚</li>
<li>ä½ è¿˜å¯ä»¥è¿ç”¨ <code>ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</code> å°†æ¥è‡ªåŒä¸€å¯¹è±¡çš„ä¸€å †æ•°æ®æ”¶é›†èµ·æ¥ï¼Œå¹¶ä»¥è¯¥å¯¹è±¡æ›¿æ¢å®ƒä»¬ã€‚</li>
<li>å¦‚æœæŸäº›æ•°æ®ç¼ºä¹åˆç†çš„å¯¹è±¡å½’å±ï¼Œå¯ä½¿ç”¨ <code>å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</code> ä¸ºå®ƒä»¬åˆ¶é€ å‡ºä¸€ä¸ªâ€œå‚æ•°å¯¹è±¡â€ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-5"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-5"></a> æ”¶ç›Š</h3>
<ul>
<li>æ›´æ˜“è¯»ï¼Œæ›´ç®€çŸ­çš„ä»£ç ã€‚</li>
<li>é‡æ„å¯èƒ½ä¼šæš´éœ²å‡ºä¹‹å‰æœªæ³¨æ„åˆ°çš„é‡å¤ä»£ç ã€‚</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥-2"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-2"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>è¿™é‡Œæœ‰ä¸€ä¸ªé‡è¦çš„ä¾‹å¤–ï¼šæœ‰æ—¶å€™ä½ æ˜æ˜¾ä¸æƒ³é€ æˆ&quot;è¢«è°ƒç”¨å¯¹è±¡&quot;ä¸&quot;è¾ƒå¤§å¯¹è±¡&quot;é—´çš„æŸç§ä¾èµ–å…³ç³»ã€‚è¿™æ—¶å€™å°†æ•°æ®ä»å¯¹è±¡ä¸­æ‹†è§£å‡ºæ¥å•ç‹¬ä½œä¸ºå‚æ•°ï¼Œä¹Ÿå¾ˆåˆæƒ…ç†ã€‚ä½†æ˜¯è¯·æ³¨æ„å…¶æ‰€å¼•å‘çš„ä»£ä»·ã€‚å¦‚æœå‚æ•°åˆ—å¤ªé•¿æˆ–å˜åŒ–å¤ªé¢‘ç¹ï¼Œå°±éœ€è¦é‡æ–°è€ƒè™‘è‡ªå·±çš„ä¾èµ–ç»“æ„äº†ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-5"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-5"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="ä»¥å‡½æ•°å–ä»£å‚æ•°replace-parameter-with-methods"><a class="markdownIt-Anchor" href="#ä»¥å‡½æ•°å–ä»£å‚æ•°replace-parameter-with-methods"></a> ä»¥å‡½æ•°å–ä»£å‚æ•°(Replace Parameter with Methods)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å¯¹è±¡è°ƒç”¨æŸä¸ªå‡½æ•°ï¼Œå¹¶å°†æ‰€å¾—ç»“æœä½œä¸ºå‚æ•°ï¼Œä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚è€Œæ¥å—è¯¥å‚æ•°çš„å‡½æ•°æœ¬èº«ä¹Ÿèƒ½å¤Ÿè°ƒç”¨å‰ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> basePrice = quantity * itemPrice;</span><br><span class="line"><span class="keyword">double</span> seasonDiscount = <span class="keyword">this</span>.getSeasonalDiscount();</span><br><span class="line"><span class="keyword">double</span> fees = <span class="keyword">this</span>.getFees();</span><br><span class="line"><span class="keyword">double</span> finalPrice = discountedPrice(basePrice, seasonDiscount, fees);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>è®©å‚æ•°æ¥å—è€…å»é™¤è¯¥é¡¹å‚æ•°ï¼Œå¹¶ç›´æ¥è°ƒç”¨å‰ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> basePrice = quantity * itemPrice;</span><br><span class="line"><span class="keyword">double</span> finalPrice = discountedPrice(basePrice);</span><br></pre></td></tr></table></figure>
<h4 id="ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-4"><a class="markdownIt-Anchor" href="#ä¿æŒå¯¹è±¡å®Œæ•´preserve-whole-object-4"></a> ä¿æŒå¯¹è±¡å®Œæ•´(Preserve Whole Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ ä»æŸä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å€¼ï¼Œå°†å®ƒä»¬ä½œä¸ºæŸä¸€æ¬¡å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> low = daysTempRange.getLow();</span><br><span class="line"><span class="keyword">int</span> high = daysTempRange.getHigh();</span><br><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>æ”¹ä¸ºä¼ é€’æ•´ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">boolean</span> withinPlan = plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-4"><a class="markdownIt-Anchor" href="#å¼•å…¥å‚æ•°å¯¹è±¡introduce-parameter-object-4"></a> å¼•å…¥å‚æ•°å¯¹è±¡(Introduce Parameter Object)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸäº›å‚æ•°æ€»æ˜¯å¾ˆè‡ªç„¶åœ°åŒæ—¶å‡ºç°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>ä»¥ä¸€ä¸ªå¯¹è±¡æ¥å–ä»£è¿™äº›å‚æ•°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-parameter-object-after.png"/></div>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88/" class="post-title-link" itemprop="url">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-10-13 22:48:00" itemprop="dateCreated datePublished" datetime="2018-10-13T22:48:00+08:00">2018-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-01-16 17:48:30" itemprop="dateModified" datetime="2020-01-16T17:48:30+08:00">2020-01-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index">
                    <span itemprop="name">è®¾è®¡</span>
                  </a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E9%87%8D%E6%9E%84/" itemprop="url" rel="index">
                    <span itemprop="name">é‡æ„</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="design/refactor/ä»£ç åå‘³é“ä¹‹è€¦åˆ/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>4.6k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>4 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
<p>ç¿»è¯‘è‡ªï¼š<a href="https://sourcemaking.com/refactoring/smells/couplers" target="_blank" rel="noopener">https://sourcemaking.com/refactoring/smells/couplers</a></p>
<p><strong>è€¦åˆ(Couplers)è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä¸åŒç±»ä¹‹é—´è¿‡åº¦è€¦åˆã€‚</strong></p>
</blockquote>
<h2 id="ä¸å®Œç¾çš„åº“ç±»"><a class="markdownIt-Anchor" href="#ä¸å®Œç¾çš„åº“ç±»"></a> ä¸å®Œç¾çš„åº“ç±»</h2>
<blockquote>
<p>ä¸å®Œç¾çš„åº“ç±»(Incomplete Library Class)</p>
<p>å½“ä¸€ä¸ªç±»åº“å·²ç»ä¸èƒ½æ»¡è¶³å®é™…éœ€è¦æ—¶ï¼Œä½ å°±ä¸å¾—ä¸æ”¹å˜è¿™ä¸ªåº“ï¼ˆå¦‚æœè¿™ä¸ªåº“æ˜¯åªè¯»çš„ï¼Œé‚£å°±æ²¡è¾™äº†ï¼‰ã€‚</p>
</blockquote>
<h3 id="é—®é¢˜åŸå› "><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› "></a> é—®é¢˜åŸå› </h3>
<p>è®¸å¤šç¼–ç¨‹æŠ€æœ¯éƒ½å»ºç«‹åœ¨åº“ç±»çš„åŸºç¡€ä¸Šã€‚åº“ç±»çš„ä½œè€…æ²¡ç”¨æœªåœå…ˆçŸ¥çš„èƒ½åŠ›ï¼Œä¸èƒ½å› æ­¤è´£æ€ªä»–ä»¬ã€‚éº»çƒ¦çš„æ˜¯åº“å¾€å¾€æ„é€ çš„ä¸å¤Ÿå¥½ï¼Œè€Œä¸”å¾€å¾€ä¸å¯èƒ½è®©æˆ‘ä»¬ä¿®æ”¹å…¶ä¸­çš„ç±»ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¦‚æœä½ åªæƒ³ä¿®æ”¹ç±»åº“çš„ä¸€ä¸¤ä¸ªå‡½æ•°ï¼Œå¯ä»¥è¿ç”¨ <code>å¼•å…¥å¤–åŠ å‡½æ•°(Introduce Foreign Method)</code>ï¼›</li>
<li>å¦‚æœæƒ³è¦æ·»åŠ ä¸€å¤§å †é¢å¤–è¡Œä¸ºï¼Œå°±å¾—è¿ç”¨ <code>å¼•å…¥æœ¬åœ°æ‰©å±•(Introduce Local Extension)</code> ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š"><a class="markdownIt-Anchor" href="#æ”¶ç›Š"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘ä»£ç é‡å¤ï¼ˆä½ ä¸ç”¨ä¸€è¨€ä¸åˆå°±è‡ªå·±åŠ¨æ‰‹å®ç°ä¸€ä¸ªåº“çš„å…¨éƒ¨åŠŸèƒ½ï¼Œä»£ä»·å¤ªé«˜ï¼‰</li>
</ul>
<h3 id="ä½•æ—¶å¿½ç•¥"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>å¦‚æœæ‰©å±•åº“ä¼šå¸¦æ¥é¢å¤–çš„å·¥ä½œé‡ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="å¼•å…¥å¤–åŠ å‡½æ•°introduce-foreign-method"><a class="markdownIt-Anchor" href="#å¼•å…¥å¤–åŠ å‡½æ•°introduce-foreign-method"></a> å¼•å…¥å¤–åŠ å‡½æ•°(Introduce Foreign Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ éœ€è¦ä¸ºæä¾›æœåŠ¡çš„ç±»å¢åŠ ä¸€ä¸ªå‡½æ•°ï¼Œä½†ä½ æ— æ³•ä¿®æ”¹è¿™ä¸ªç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Report</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sendReport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Date nextDay = <span class="keyword">new</span> Date(previousEnd.getYear(),</span><br><span class="line">      previousEnd.getMonth(), previousEnd.getDate() + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>åœ¨å®¢æˆ·ç±»ä¸­å»ºç«‹ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸€ä¸ªç¬¬ä¸€ä¸ªå‚æ•°å½¢å¼ä¼ å…¥ä¸€ä¸ªæœåŠ¡ç±»å®ä¾‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Report</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">sendReport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Date newStart = nextDay(previousEnd);</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Date <span class="title">nextDay</span><span class="params">(Date arg)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Date(arg.getYear(), arg.getMonth(), arg.getDate() + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥æœ¬åœ°æ‰©å±•introduce-local-extension"><a class="markdownIt-Anchor" href="#å¼•å…¥æœ¬åœ°æ‰©å±•introduce-local-extension"></a> å¼•å…¥æœ¬åœ°æ‰©å±•(Introduce Local Extension)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ éœ€è¦ä¸ºæœåŠ¡ç±»æä¾›ä¸€äº›é¢å¤–å‡½æ•°ï¼Œä½†ä½ æ— æ³•ä¿®æ”¹è¿™ä¸ªç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-local-extension-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œä½¿å®ƒåŒ…å«è¿™äº›é¢å¤–å‡½æ•°ï¼Œè®©è¿™ä¸ªæ‰©å±•å“æˆä¸ºæºç±»çš„å­ç±»æˆ–åŒ…è£…ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/introduce-local-extension-after.png"/></div>
<h2 id="ä¸­é—´äºº"><a class="markdownIt-Anchor" href="#ä¸­é—´äºº"></a> ä¸­é—´äºº</h2>
<blockquote>
<p>ä¸­é—´äºº(Middle Man)</p>
<p>å¦‚æœä¸€ä¸ªç±»çš„ä½œç”¨ä»…ä»…æ˜¯æŒ‡å‘å¦ä¸€ä¸ªç±»çš„å§”æ‰˜ï¼Œä¸ºä»€ä¹ˆè¦å­˜åœ¨å‘¢ï¼Ÿ</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/middle-man-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -2"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -2"></a> é—®é¢˜åŸå› </h3>
<p>å¯¹è±¡çš„åŸºæœ¬ç‰¹å¾ä¹‹ä¸€å°±æ˜¯å°è£…ï¼šå¯¹å¤–éƒ¨ä¸–ç•Œéšè—å…¶å†…éƒ¨ç»†èŠ‚ã€‚å°è£…å¾€å¾€ä¼´éšå§”æ‰˜ã€‚ä½†æ˜¯äººä»¬å¯èƒ½è¿‡åº¦è¿ç”¨å§”æ‰˜ã€‚æ¯”å¦‚ï¼Œä½ ä¹Ÿè®¸ä¼šçœ‹åˆ°ä¸€ä¸ªç±»çš„å¤§éƒ¨åˆ†æœ‰ç”¨å·¥ä½œéƒ½å§”æ‰˜ç»™äº†å…¶ä»–ç±»ï¼Œç±»æœ¬èº«æˆäº†ä¸€ä¸ªç©ºå£³ï¼Œé™¤äº†å§”æ‰˜ä¹‹å¤–ä¸åšä»»ä½•äº‹æƒ…ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-2"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-2"></a> è§£å†³æ–¹æ³•</h3>
<p>åº”è¯¥è¿ç”¨ <code>ç§»é™¤ä¸­é—´äºº(Remove Middle Man)</code>ï¼Œç›´æ¥å’ŒçœŸæ­£è´Ÿè´£çš„å¯¹è±¡æ‰“äº¤é“ã€‚</p>
<h3 id="æ”¶ç›Š-2"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-2"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘ç¬¨é‡çš„ä»£ç ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/middle-man-2.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥-2"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-2"></a> ä½•æ—¶å¿½ç•¥</h3>
<p>å¦‚æœæ˜¯ä»¥ä¸‹æƒ…å†µï¼Œä¸è¦åˆ é™¤å·²åˆ›å»ºçš„ä¸­é—´äººï¼š</p>
<ul>
<li>æ·»åŠ ä¸­é—´äººæ˜¯ä¸ºäº†é¿å…ç±»ä¹‹é—´ä¾èµ–å…³ç³»ã€‚</li>
<li>ä¸€äº›è®¾è®¡æ¨¡å¼æœ‰ç›®çš„åœ°åˆ›å»ºä¸­é—´äººï¼ˆä¾‹å¦‚ä»£ç†æ¨¡å¼å’Œè£…é¥°å™¨æ¨¡å¼ï¼‰ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-2"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-2"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="ç§»é™¤ä¸­é—´äººremove-middle-man"><a class="markdownIt-Anchor" href="#ç§»é™¤ä¸­é—´äººremove-middle-man"></a> ç§»é™¤ä¸­é—´äºº(Remove Middle Man)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†è¿‡å¤šçš„ç®€å•å§”æ‰˜åŠ¨ä½œã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-middle-man-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>è®©å®¢æˆ·ç›´æ¥è°ƒç”¨å§”æ‰˜ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/remove-middle-man-after.png"/></div>
<h2 id="ä¾æ‹æƒ…ç»“"><a class="markdownIt-Anchor" href="#ä¾æ‹æƒ…ç»“"></a> ä¾æ‹æƒ…ç»“</h2>
<blockquote>
<p>ä¾æ‹æƒ…ç»“(Feature Envy)</p>
<p>ä¸€ä¸ªå‡½æ•°è®¿é—®å…¶å®ƒå¯¹è±¡çš„æ•°æ®æ¯”è®¿é—®è‡ªå·±çš„æ•°æ®æ›´å¤šã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/feature-envy-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -3"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -3"></a> é—®é¢˜åŸå› </h3>
<p>è¿™ç§æ°”å‘³å¯èƒ½å‘ç”Ÿåœ¨å­—æ®µç§»åŠ¨åˆ°æ•°æ®ç±»ä¹‹åã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œä½ å¯èƒ½æƒ³å°†æ•°æ®ç±»çš„æ“ä½œç§»åŠ¨åˆ°è¿™ä¸ªç±»ä¸­ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-3"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-3"></a> è§£å†³æ–¹æ³•</h3>
<p>As a basic rule, if things change at the same time, you should keep them in the same place. Usually data and functions that use this data are changed together (although exceptions are possible).</p>
<p>æœ‰ä¸€ä¸ªåŸºæœ¬åŸåˆ™ï¼šåŒæ—¶ä¼šå‘ç”Ÿæ”¹å˜çš„äº‹æƒ…åº”è¯¥è¢«æ”¾åœ¨åŒä¸€ä¸ªåœ°æ–¹ã€‚é€šå¸¸ï¼Œæ•°æ®å’Œä½¿ç”¨è¿™äº›æ•°æ®çš„å‡½æ•°æ˜¯ä¸€èµ·æ”¹å˜çš„ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/feature-envy-2.png"/></div>
<ul>
<li>å¦‚æœä¸€ä¸ªå‡½æ•°æ˜æ˜¾åº”è¯¥è¢«ç§»åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œå¯è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> ã€‚</li>
<li>å¦‚æœä»…ä»…æ˜¯å‡½æ•°çš„éƒ¨åˆ†ä»£ç è®¿é—®å¦ä¸€ä¸ªå¯¹è±¡çš„æ•°æ®ï¼Œè¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°†è¿™éƒ¨åˆ†ä»£ç ç§»åˆ°ç‹¬ç«‹çš„å‡½æ•°ä¸­ã€‚</li>
<li>å¦‚æœä¸€ä¸ªæ–¹æ³•ä½¿ç”¨æ¥è‡ªå…¶ä»–å‡ ä¸ªç±»çš„å‡½æ•°ï¼Œé¦–å…ˆç¡®å®šå“ªä¸ªç±»åŒ…å«å¤§å¤šæ•°ä½¿ç”¨çš„æ•°æ®ã€‚ç„¶åï¼Œå°†è¯¥æ–¹æ³•ä¸å…¶ä»–æ•°æ®ä¸€èµ·æ”¾åœ¨æ­¤ç±»ä¸­ã€‚æˆ–è€…ï¼Œä½¿ç”¨ <code>æç‚¼å‡½æ•°(Extract Method)</code> å°†æ–¹æ³•æ‹†åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œå¯ä»¥æ”¾ç½®åœ¨ä¸åŒç±»ä¸­çš„ä¸åŒä½ç½®ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-3"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-3"></a> æ”¶ç›Š</h3>
<ul>
<li>å‡å°‘é‡å¤ä»£ç ï¼ˆå¦‚æœæ•°æ®å¤„ç†çš„ä»£ç æ”¾åœ¨ä¸­å¿ƒä½ç½®ï¼‰ã€‚</li>
<li>æ›´å¥½çš„ä»£ç ç»„ç»‡æ€§ï¼ˆå¤„ç†æ•°æ®çš„å‡½æ•°é è¿‘å®é™…æ•°æ®ï¼‰ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/feature-envy-3.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥-3"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-3"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>æœ‰æ—¶ï¼Œè¡Œä¸ºè¢«æœ‰æ„åœ°ä¸ä¿å­˜æ•°æ®çš„ç±»åˆ†å¼€ã€‚è¿™é€šå¸¸çš„ä¼˜ç‚¹æ˜¯èƒ½å¤ŸåŠ¨æ€åœ°æ”¹å˜è¡Œä¸ºï¼ˆè§ç­–ç•¥è®¾è®¡æ¨¡å¼ï¼Œè®¿é—®è€…è®¾è®¡æ¨¡å¼å’Œå…¶ä»–æ¨¡å¼ï¼‰ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-3"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-3"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æ¬ç§»å‡½æ•°move-method"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æç‚¼å‡½æ•°extract-method"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç‹æ˜µå…³ç³»"><a class="markdownIt-Anchor" href="#ç‹æ˜µå…³ç³»"></a> ç‹æ˜µå…³ç³»</h2>
<blockquote>
<p>ç‹æ˜µå…³ç³»(Inappropriate Intimacy)</p>
<p>ä¸€ä¸ªç±»å¤§é‡ä½¿ç”¨å¦ä¸€ä¸ªç±»çš„å†…éƒ¨å­—æ®µå’Œæ–¹æ³•ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inappropriate-intimacy-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -4"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -4"></a> é—®é¢˜åŸå› </h3>
<p>ç±»å’Œç±»ä¹‹é—´åº”è¯¥å°½é‡å°‘çš„æ„ŸçŸ¥å½¼æ­¤ï¼ˆå‡å°‘è€¦åˆï¼‰ã€‚è¿™æ ·çš„ç±»æ›´å®¹æ˜“ç»´æŠ¤å’Œå¤ç”¨ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-4"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-4"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>æœ€ç®€å•çš„è§£å†³æ–¹æ³•æ˜¯è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> å’Œ <code>æ¬ç§»å­—æ®µ(Move Field)</code> æ¥è®©ç±»ä¹‹é—´æ–©æ–­ç¾ç»Šã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inappropriate-intimacy-2.png"/></div>
<ul>
<li>
<p>ä½ ä¹Ÿå¯ä»¥çœ‹çœ‹æ˜¯å¦èƒ½è¿ç”¨ <code>å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”(Change Bidirectional Association to Unidirectional)</code> è®©å…¶ä¸­ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªè¯´åˆ†æ‰‹ã€‚</p>
</li>
<li>
<p>å¦‚æœè¿™ä¸¤ä¸ªç±»å®åœ¨æ˜¯æƒ…æ¯”é‡‘åšï¼Œéš¾åˆ†éš¾èˆï¼Œå¯ä»¥è¿ç”¨ <code>æç‚¼ç±»(Extract Class)</code> æŠŠäºŒè€…å…±åŒç‚¹æç‚¼åˆ°ä¸€ä¸ªæ–°ç±»ä¸­ï¼Œè®©å®ƒä»¬äº§ç”Ÿçˆ±çš„ç»“æ™¶ã€‚æˆ–è€…ï¼Œå¯ä»¥å°è¯•è¿ç”¨ <code>éšè—å§”æ‰˜å…³ç³»(Hide Delegate)</code> è®©å¦ä¸€ä¸ªç±»æ¥ä¸ºå®ƒä»¬ç‰µçº¿æ­æ¡¥ã€‚</p>
</li>
<li>
<p>ç»§æ‰¿å¾€å¾€é€ æˆç±»ä¹‹é—´è¿‡åˆ†ç´§å¯†ï¼Œå› ä¸ºå­ç±»å¯¹è¶…ç±»çš„äº†è§£æ€»æ˜¯è¶…è¿‡åè€…çš„ä¸»è§‚æ„¿æœ›ï¼Œå¦‚æœä½ è§‰å¾—è¯¥è®©è¿™ä¸ªå­ç±»è‡ªå·±é—¯è¡ï¼Œè¯·è¿ç”¨ <code>ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿(Replace Inheritance with Delegation)</code> æ¥è®©è¶…ç±»å’Œå­ç±»åˆ†å®¶ã€‚</p>
</li>
</ul>
<h3 id="æ”¶ç›Š-4"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-4"></a> æ”¶ç›Š</h3>
<ul>
<li>æé«˜ä»£ç ç»„ç»‡æ€§ã€‚</li>
<li>æé«˜ä»£ç å¤ç”¨æ€§ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/inappropriate-intimacy-3.png"/></div>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-4"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-4"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="æ¬ç§»å‡½æ•°move-method-2"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method-2"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h4 id="æ¬ç§»å­—æ®µmove-field"><a class="markdownIt-Anchor" href="#æ¬ç§»å­—æ®µmove-field"></a> æ¬ç§»å­—æ®µ(Move Field)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>åœ¨ä½ çš„ç¨‹åºä¸­ï¼ŒæŸä¸ªå­—æ®µè¢«å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»æ›´å¤šåœ°ç”¨åˆ°ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-field-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨ç›®æ ‡ç±»æ–°å»ºä¸€ä¸ªå­—æ®µï¼Œä¿®æ”¹æºå­—æ®µçš„æ‰€æœ‰ç”¨æˆ·ï¼Œä»¤ä»–ä»¬æ”¹ç”¨æ–°å­—æ®µã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-field-after.png"/></div>
<h4 id="å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”change-bidirectional-association-to-unidirectional"><a class="markdownIt-Anchor" href="#å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”change-bidirectional-association-to-unidirectional"></a> å°†åŒå‘å…³è”æ”¹ä¸ºå•å‘å…³è”(Change Bidirectional Association to Unidirectional)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä¸¤ä¸ªç±»ä¹‹é—´æœ‰åŒå‘å…³è”ï¼Œä½†å…¶ä¸­ä¸€ä¸ªç±»å¦‚ä»Šä¸å†éœ€è¦å¦ä¸€ä¸ªç±»çš„ç‰¹æ€§ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/change-bidirectional-association-to-unidirectional-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»é™¤ä¸å¿…è¦çš„å…³è”ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/change-bidirectional-association-to-unidirectional-after.png"/></div>
<h4 id="æç‚¼ç±»extract-class"><a class="markdownIt-Anchor" href="#æç‚¼ç±»extract-class"></a> æç‚¼ç±»(Extract Class)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªç±»åšäº†ä¸æ­¢ä¸€ä»¶äº‹ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>å»ºç«‹ä¸€ä¸ªæ–°ç±»ï¼Œå°†ç›¸å…³çš„å­—æ®µå’Œå‡½æ•°ä»æ—§ç±»æ¬ç§»åˆ°æ–°ç±»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/extract-class-after.png"/></div>
<h4 id="éšè—å§”æ‰˜å…³ç³»hide-delegate"><a class="markdownIt-Anchor" href="#éšè—å§”æ‰˜å…³ç³»hide-delegate"></a> éšè—å§”æ‰˜å…³ç³»(Hide Delegate)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å®¢æˆ·é€šè¿‡ä¸€ä¸ªå§”æ‰˜ç±»æ¥è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-delegate-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨æœåŠ¡ç±»ä¸Šå»ºç«‹å®¢æˆ·æ‰€éœ€çš„æ‰€æœ‰å‡½æ•°ï¼Œç”¨ä»¥éšè—å§”æ‰˜å…³ç³»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-delegate-after.png"/></div>
<h4 id="ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿replace-inheritance-with-delegation"><a class="markdownIt-Anchor" href="#ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿replace-inheritance-with-delegation"></a> ä»¥å§”æ‰˜å–ä»£ç»§æ‰¿(Replace Inheritance with Delegation)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>æŸä¸ªå­ç±»åªä½¿ç”¨è¶…ç±»æ¥å£ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–æ˜¯æ ¹æœ¬ä¸éœ€è¦ç»§æ‰¿è€Œæ¥çš„æ•°æ®ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-delegation-with-inheritance-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨å­ç±»ä¸­æ–°å»ºä¸€ä¸ªå­—æ®µç”¨ä»¥ä¿å­˜è¶…ç±»ï¼›è°ƒæ•´å­ç±»å‡½æ•°ï¼Œä»¤å®ƒæ”¹è€Œå§”æ‰˜è¶…ç±»ï¼›ç„¶åå»æ‰ä¸¤è€…ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/replace-delegation-with-inheritance-after.png"/></div>
<h2 id="è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾"><a class="markdownIt-Anchor" href="#è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾"></a> è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾</h2>
<blockquote>
<p>è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾(Message Chains)</p>
<p>æ¶ˆæ¯é“¾çš„å½¢å¼ç±»ä¼¼äºï¼š<code>obj.getA().getB().getC()</code>ã€‚</p>
</blockquote>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/message-chains-1.png"/></div>
<h3 id="é—®é¢˜åŸå› -5"><a class="markdownIt-Anchor" href="#é—®é¢˜åŸå› -5"></a> é—®é¢˜åŸå› </h3>
<p>å¦‚æœä½ çœ‹åˆ°ç”¨æˆ·å‘ä¸€ä¸ªå¯¹è±¡è¯·æ±‚å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå†å‘åè€…è¯·æ±‚å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå†è¯·æ±‚å¦ä¸€ä¸ªå¯¹è±¡â€¦â€¦è¿™å°±æ˜¯æ¶ˆæ¯é“¾ã€‚å®é™…ä»£ç ä¸­ä½ çœ‹åˆ°çš„å¯èƒ½æ˜¯ä¸€é•¿ä¸² getThis()æˆ–ä¸€é•¿ä¸²ä¸´æ—¶å˜é‡ã€‚é‡‡å–è¿™ç§æ–¹å¼ï¼Œæ„å‘³å®¢æˆ·ä»£ç å°†ä¸æŸ¥æ‰¾è¿‡ç¨‹ä¸­çš„å¯¼èˆªç´§å¯†è€¦åˆã€‚ä¸€æ—¦å¯¹è±¡é—´å…³ç³»å‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œå®¢æˆ·ç«¯å°±ä¸å¾—ä¸åšå‡ºç›¸åº”çš„ä¿®æ”¹ã€‚</p>
<h3 id="è§£å†³æ–¹æ³•-5"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ³•-5"></a> è§£å†³æ–¹æ³•</h3>
<ul>
<li>å¯ä»¥è¿ç”¨ <code>éšè—å§”æ‰˜å…³ç³»(Hide Delegate)</code> åˆ é™¤ä¸€ä¸ªæ¶ˆæ¯é“¾ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/message-chains-2.png"/></div>
<ul>
<li>æœ‰æ—¶æ›´å¥½çš„é€‰æ‹©æ˜¯ï¼šå…ˆè§‚å¯Ÿæ¶ˆæ¯é“¾æœ€ç»ˆå¾—åˆ°çš„å¯¹è±¡æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ã€‚çœ‹çœ‹èƒ½å¦ä»¥ <code>æç‚¼å‡½æ•°(Extract Method)</code>æŠŠä½¿ç”¨è¯¥å¯¹è±¡çš„ä»£ç æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹å‡½æ•°ä¸­ï¼Œå†è¿ç”¨ <code>æ¬ç§»å‡½æ•°(Move Method)</code> æŠŠè¿™ä¸ªå‡½æ•°æ¨å…¥æ¶ˆæ¯é“¾ã€‚</li>
</ul>
<h3 id="æ”¶ç›Š-5"><a class="markdownIt-Anchor" href="#æ”¶ç›Š-5"></a> æ”¶ç›Š</h3>
<ul>
<li>èƒ½å‡å°‘é“¾ä¸­ç±»ä¹‹é—´çš„ä¾èµ–ã€‚</li>
<li>èƒ½å‡å°‘ä»£ç é‡ã€‚</li>
</ul>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/message-chains-3.png"/></div>
<h3 id="ä½•æ—¶å¿½ç•¥-4"><a class="markdownIt-Anchor" href="#ä½•æ—¶å¿½ç•¥-4"></a> ä½•æ—¶å¿½ç•¥</h3>
<ul>
<li>è¿‡äºä¾µç•¥æ€§çš„å§”æ‰˜å¯èƒ½ä¼šä½¿ç¨‹åºå‘˜éš¾ä»¥ç†è§£åŠŸèƒ½æ˜¯å¦‚ä½•è§¦å‘çš„ã€‚</li>
</ul>
<h3 id="é‡æ„æ–¹æ³•è¯´æ˜-5"><a class="markdownIt-Anchor" href="#é‡æ„æ–¹æ³•è¯´æ˜-5"></a> é‡æ„æ–¹æ³•è¯´æ˜</h3>
<h4 id="éšè—å§”æ‰˜å…³ç³»hide-delegate-2"><a class="markdownIt-Anchor" href="#éšè—å§”æ‰˜å…³ç³»hide-delegate-2"></a> éšè—å§”æ‰˜å…³ç³»(Hide Delegate)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>å®¢æˆ·é€šè¿‡ä¸€ä¸ªå§”æ‰˜ç±»æ¥è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-delegate-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨æœåŠ¡ç±»ä¸Šå»ºç«‹å®¢æˆ·æ‰€éœ€çš„æ‰€æœ‰å‡½æ•°ï¼Œç”¨ä»¥éšè—å§”æ‰˜å…³ç³»ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/hide-delegate-after.png"/></div>
<h4 id="æç‚¼å‡½æ•°extract-method-2"><a class="markdownIt-Anchor" href="#æç‚¼å‡½æ•°extract-method-2"></a> æç‚¼å‡½æ•°(Extract Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ æœ‰ä¸€æ®µä»£ç å¯ä»¥ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//print details</span></span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è§£å†³</strong></p>
<p>ç§»åŠ¨è¿™æ®µä»£ç åˆ°ä¸€ä¸ªæ–°çš„å‡½æ•°ä¸­ï¼Œä½¿ç”¨å‡½æ•°çš„è°ƒç”¨æ¥æ›¿ä»£è€ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOwing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printDetails</span><span class="params">(<span class="keyword">double</span> outstanding)</span> </span>&#123;</span><br><span class="line">  System.out.println(<span class="string">"name: "</span> + name);</span><br><span class="line">  System.out.println(<span class="string">"amount: "</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¬ç§»å‡½æ•°move-method-3"><a class="markdownIt-Anchor" href="#æ¬ç§»å‡½æ•°move-method-3"></a> æ¬ç§»å‡½æ•°(Move Method)</h4>
<p><strong>é—®é¢˜</strong></p>
<p>ä½ çš„ç¨‹åºä¸­ï¼Œæœ‰ä¸ªå‡½æ•°ä¸å…¶æ‰€é©»ç±»ä¹‹å¤–çš„å¦ä¸€ä¸ªç±»è¿›è¡Œæ›´å¤šäº¤æµï¼šè°ƒç”¨åè€…ï¼Œæˆ–è¢«åè€…è°ƒç”¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-before.png"/></div>
<p><strong>è§£å†³</strong></p>
<p>åœ¨è¯¥å‡½æ•°æœ€å¸¸å¼•ç”¨çš„ç±»ä¸­å»ºç«‹ä¸€ä¸ªæœ‰ç€ç±»ä¼¼è¡Œä¸ºçš„æ–°å‡½æ•°ã€‚å°†æ—§å‡½æ•°å˜æˆä¸€ä¸ªå•çº¯çš„å§”æ‰˜å‡½æ•°ï¼Œæˆ–æ˜¯æ—§å‡½æ•°å®Œå…¨ç§»é™¤ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/move-method-after.png"/></div>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/design/refactor/%E4%BB%A3%E7%A0%81%E7%9A%84%E5%9D%8F%E5%91%B3%E9%81%93%E5%92%8C%E9%87%8D%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E7%9A%84%E5%9D%8F%E5%91%B3%E9%81%93%E5%92%8C%E9%87%8D%E6%9E%84/" class="post-title-link" itemprop="url">ä»£ç çš„åå‘³é“å’Œé‡æ„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-10-13 22:48:00" itemprop="dateCreated datePublished" datetime="2018-10-13T22:48:00+08:00">2018-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-01-16 17:48:30" itemprop="dateModified" datetime="2020-01-16T17:48:30+08:00">2020-01-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/" itemprop="url" rel="index">
                    <span itemprop="name">è®¾è®¡</span>
                  </a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%BE%E8%AE%A1/%E9%87%8D%E6%9E%84/" itemprop="url" rel="index">
                    <span itemprop="name">é‡æ„</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/design/refactor/%E4%BB%A3%E7%A0%81%E7%9A%84%E5%9D%8F%E5%91%B3%E9%81%93%E5%92%8C%E9%87%8D%E6%9E%84/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="design/refactor/ä»£ç çš„åå‘³é“å’Œé‡æ„/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>3.1k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>3 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ğŸ““ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener">blog</a>ã€</p>
</blockquote>
<p>ç¬¬ä¸€æ¬¡è¯»ã€Šé‡æ„:æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹æ—¶ï¼Œæˆ‘æ›¾æ•´ç†è¿‡ä¸€ä¸ªç®€å•çš„ç¬”è®°ã€‚æœ€è¿‘ï¼Œå› ä¸ºå‚ä¸ä¸€ä¸ªé‡æ„é¡¹ç›®ï¼Œå†ä¸€æ¬¡æ¸©ä¹ äº†ã€Šé‡æ„:æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹ã€‚è¿‡ç¨‹ä¸­ï¼ŒèŒå‘äº†è®¤çœŸæ€»ç»“ã€æ•´ç†é‡æ„æ–¹æ³•çš„å†²åŠ¨ï¼Œäºæ˜¯æœ‰äº†è¿™ç³»åˆ—æ–‡å­—ã€‚</p>
<p>ä»£ç çš„åå‘³é“è¿˜æœ‰å‡ ç¯‡æ²¡æœ‰å®Œç¨¿ï¼Œåé¢æˆ‘ä¼šé™†ç»­è¡¥å……ã€‚ã€‚ã€‚</p>
<h2 id="ç—‡ä¸è¯"><a class="markdownIt-Anchor" href="#ç—‡ä¸è¯"></a> ç—‡ä¸è¯</h2>
<h3 id="å¯¹ä»£ç çš„åå‘³é“çš„æ€è€ƒ"><a class="markdownIt-Anchor" href="#å¯¹ä»£ç çš„åå‘³é“çš„æ€è€ƒ"></a> å¯¹ä»£ç çš„åå‘³é“çš„æ€è€ƒ</h3>
<p>â€œæœ‰ç—…è¦æ—©æ²»ï¼Œä¸è¦æ”¾å¼ƒæ²»ç–—â€ã€‚å¤šä¹ˆæœ´ç´ çš„é“ç† ï¼Œäººäººéƒ½æ‡‚ã€‚</p>
<p>ç—…ï¼Œå°±æ˜¯ä¸å¥åº·ã€‚</p>
<p>äººæœ‰ç—…ï¼Œå¯ä»¥é€šè¿‡æ‰“é’ˆã€åƒè¯ã€åšæ‰‹æœ¯æ¥è¿›è¡Œæ²»ç–—ã€‚</p>
<p><strong>å¦‚æœæŠŠä»£ç çš„åå‘³é“ï¼ˆä»£ç è´¨é‡é—®é¢˜ï¼‰æ¯”ä½œç—…ç—‡ï¼Œé‚£ä¹ˆé‡æ„å°±æ˜¯æ²»ç–—ä»£ç çš„åå‘³é“çš„è¯ã€‚</strong></p>
<p>ä¸ªäººè®¤ä¸ºï¼Œåœ¨é‡æ„è¿™ä»¶äº‹ä¸Šï¼Œä¹Ÿå¯ä»¥åº”ç”¨æ²»ç—…çš„é“ç†ï¼š</p>
<ul>
<li>
<p><strong>é˜²ç—…äºæœªç„¶ã€‚</strong><br />
â€”â€” æ˜¥ç§‹æˆ˜å›½æ—¶æœŸçš„ä¸€ä»£ååŒ»æ‰é¹Šï¼Œæ›¾ç»æœ‰ä¸ªå¾ˆè‘—åçš„åŒ»å­¦ä¸»å¼ ï¼š<strong>é˜²ç—…äºæœªç„¶</strong>ã€‚ æˆ‘è§‰å¾—è¿™ä¸ªé“ç†åº”ç”¨äºè½¯ä»¶ä»£ç çš„é‡æ„äº¦ç„¶ã€‚ç¼–ç¨‹å‰è¦æœ‰åˆç†çš„è®¾è®¡ã€ç¼–ç¨‹æ—¶è¦æœ‰è‰¯å¥½çš„ç¼–ç¨‹é£æ ¼ï¼Œå°½é‡å‡å°‘é—®é¢˜ã€‚ä»è¿™ä¸ªå±‚é¢ä¸Šè¯´ï¼Œäº†è§£ä»£ç çš„åå‘³é“ï¼Œä¸ä»…ä»…æ˜¯ä¸ºäº†å‘ç°é—®é¢˜ã€è§£å†³é—®é¢˜ã€‚æ›´é‡è¦çš„ä½œç”¨æ˜¯ï¼šæŒ‡å¯¼æˆ‘ä»¬åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­æœ‰æ„è¯†çš„å»è§„é¿è¿™äº›é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>å°ç—…ä¸åŒ»ï¼Œæ˜“å¾—å¤§ç—…ã€‚</strong><br />
â€”â€” åˆ˜å¤‡è¯´è¿‡ï¼šâ€œå‹¿ä»¥å–„å°è€Œä¸ä¸ºï¼Œå‹¿ä»¥æ¶å°è€Œä¸ºä¹‹â€ã€‚å‘ç°é—®é¢˜å°±åŠæ—¶ä¿®æ”¹ï¼Œä»£ç è´¨é‡è‡ªç„¶å®¹æ˜“è¿›å…¥è‰¯æ€§å¾ªç¯ï¼›åä¹‹ï¼Œäº¦ç„¶ã€‚è¦é‡è§†ç§¯ç´¯çš„åŠ›é‡ï¼Œåˆ«æ€»ä»¥ä¸ºä»£ç å‡ºç°ç‚¹å°é—®é¢˜ï¼Œé‚£éƒ½ä¸æ˜¯äº‹å„¿ã€‚</p>
</li>
<li>
<p><strong>å¯¹ç—‡ä¸‹è¯ã€‚</strong><br />
â€”â€” ç¨‹åºå‡ºç°äº†é—®é¢˜ï¼Œè¦åˆ†æå‡ºé—®é¢˜çš„æ ¹æœ¬ï¼Œæœ‰é’ˆå¯¹æ€§çš„åˆ¶å®šåˆç†çš„é‡æ„æ–¹æ¡ˆã€‚å¤§å®¶éƒ½çŸ¥é“åƒé”™è¯çš„åæœï¼ŒåŒæ ·çš„ï¼Œ<strong>çæ”¹è¿˜ä¸å¦‚ä¸æ”¹</strong>ã€‚</p>
</li>
<li>
<p><strong>å¿ŒçŒ›è¯</strong><br />
â€”â€” åŒ»ç—…ç”¨çŒ›è¯å®¹æ˜“äº§ç”Ÿå‰¯ä½œç”¨ã€‚æ¢ä¸€å¥ä¿—è¯­ï¼šæ­¥å­å¤§äº†å®¹æ˜“æ‰¯ç€è›‹ã€‚é‡æ„å¦‚æœå¤§åˆ€é˜”æ–§çš„å¹²ï¼Œé‚£ä½ å°±è¦æœ‰éšæ—¶å¯èƒ½æ‰‘è¡—çš„å¿ƒç†å‡†å¤‡ã€‚æ¨å€’é‡æ¥ä¸æ˜¯é‡æ„ï¼Œè€Œæ˜¯é‡å†™ã€‚é‡æ„åº”è¯¥æ˜¯å¾ªåºæ¸è¿›ï¼Œæ­¥æ­¥ä¸ºè¥çš„è¿‡ç¨‹ã€‚å½“ä½ å‘ç°é‡å†™ä»£ç æ¯”é‡æ„ä»£ç æ›´ç®€å•ï¼Œå¾€å¾€è¯´æ˜ä½ æ—©å°±è¯¥é‡æ„äº†ã€‚</p>
</li>
</ul>
<h3 id="é‡æ„çš„åŸåˆ™"><a class="markdownIt-Anchor" href="#é‡æ„çš„åŸåˆ™"></a> é‡æ„çš„åŸåˆ™</h3>
<p>å‰é¢æŠŠä»£ç è´¨é‡é—®é¢˜æ¯”ä½œç—…ç—‡ï¼Œè€ŒæŠŠé‡æ„æ¯”ä½œè¯ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å†è¿›ä¸€æ­¥è®¨è®ºä¸€ä¸‹é‡æ„çš„åŸåˆ™ã€‚</p>
<h4 id="ä½•è°“é‡æ„what"><a class="markdownIt-Anchor" href="#ä½•è°“é‡æ„what"></a> ä½•è°“é‡æ„(What)</h4>
<p><code>é‡æ„ï¼ˆRefactoringï¼‰</code> çš„å¸¸è§å®šä¹‰æ˜¯ï¼šä¸æ”¹å˜è½¯ä»¶ç³»ç»Ÿå¤–éƒ¨è¡Œä¸ºçš„å‰æä¸‹ï¼Œæ”¹å–„å®ƒçš„å†…éƒ¨ç»“æ„ã€‚</p>
<p>ä¸ªäººè§‰å¾—è¿™ä¸ªå®šä¹‰æœ‰ç‚¹ç”Ÿæ¶©ã€‚ä¸å¦¨ç†è§£ä¸ºï¼šé‡æ„æ˜¯ç»™ä»£ç æ²»ç—…çš„è¡Œä¸ºã€‚è€Œä»£ç æœ‰ç—…æ˜¯æŒ‡ä»£ç çš„è´¨é‡ï¼ˆå¯é æ€§ã€å®‰å…¨æ€§ã€å¯å¤ç”¨æ€§ã€å¯ç»´æŠ¤æ€§ï¼‰å’Œæ€§èƒ½æœ‰é—®é¢˜ã€‚</p>
<p><strong>é‡æ„çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜ä»£ç çš„è´¨é‡å’Œæ€§èƒ½</strong>ã€‚</p>
<p><em>æ³¨ï¼šåŠŸèƒ½ä¸å…¨æˆ–è€…ä¸æ­£ç¡®ï¼Œé‚£æ˜¯æ®‹ç–¾ä»£ç ã€‚å°±åƒæ²»ç—…æ²»ä¸äº†æ®‹ç–¾ï¼Œé‡æ„ä¹Ÿè§£å†³ä¸äº†åŠŸèƒ½é—®é¢˜ã€‚</em></p>
<h4 id="ä¸ºä½•é‡æ„why"><a class="markdownIt-Anchor" href="#ä¸ºä½•é‡æ„why"></a> ä¸ºä½•é‡æ„(Why)</h4>
<p>ç¿»ç¿»ä¹¦ï¼Œä¸Šç½‘æœä¸€ä¸‹ï¼Œè°ˆåˆ°é‡æ„çš„ç†ç”±å¤§ä½“ç›¸åŒï¼š</p>
<ul>
<li>é‡æ„æ”¹è¿›è½¯ä»¶è®¾è®¡</li>
<li>é‡æ„ä½¿è½¯ä»¶æ›´å®¹æ˜“ç†è§£</li>
<li>é‡æ„å¸®åŠ©æ‰¾åˆ° bug</li>
<li>é‡æ„æé«˜ç¼–ç¨‹é€Ÿåº¦</li>
</ul>
<p>æ€»ä¹‹å°±æ˜¯ï¼Œ<strong>é‡æ„å¯ä»¥æé«˜ä»£ç è´¨é‡</strong>ã€‚</p>
<h4 id="ä½•æ—¶é‡æ„when"><a class="markdownIt-Anchor" href="#ä½•æ—¶é‡æ„when"></a> ä½•æ—¶é‡æ„(When)</h4>
<p>å…³äºä½•æ—¶é‡æ„ï¼Œæˆ‘å…ˆå¼•ç”¨ä¸€ä¸‹ <a href="http://mt.sohu.com/20160812/n463980993.shtml" target="_blank" rel="noopener"><u>é‡æ„å¹¶ééš¾åœ¨å¦‚ä½•åšï¼Œè€Œæ˜¯éš¾åœ¨ä½•æ—¶å¼€å§‹åš</u></a> ä¸€æ–‡çš„è§‚ç‚¹ã€‚</p>
<blockquote>
<p>å¯¹äºä¸€ä¸ªé«˜é€Ÿå‘å±•çš„å…¬å¸æ¥è¯´ï¼Œåœæ­¢ä¸šåŠ¡å¼€å‘ï¼Œä¸“é—¨æ¥åšé‡æ„é¡¹ç›®ï¼Œ<strong>ä»æ¥å°±ä¸æ˜¯ä¸€ä¸ªå¯æ¥å—çš„é€‰é¡¹</strong>ï¼Œâ€œè¾¹å¼€é£æœºè¾¹æ¢å¼•æ“â€æ‰æ˜¯è¿™ç§å…¬å¸æƒ³è¦çš„ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬ä¸å¦¨æ¥è¡¡é‡ä¸€ä¸‹é‡æ„çš„æˆæœ¬å’Œæ”¶ç›Šã€‚</p>
<ul>
<li>
<p><strong>é‡æ„çš„æˆæœ¬</strong></p>
<p>é‡æ„æ˜¯æœ‰æˆæœ¬çš„ï¼Œè´¹æ—¶è´¹åŠ›ï¼ˆæ—¶é—´ã€äººåŠ›ï¼‰ä¸è¯´ï¼Œè¿˜æœ‰å¯èƒ½ä¼šä½¿æœ¬æ¥æ­£å¸¸è¿è¡Œçš„ç¨‹åºå‡ºé”™ã€‚æ‰€ä»¥ï¼Œå¾ˆå¤šäººéƒ½æŠ±ç€â€œä¸æ±‚æœ‰åŠŸï¼Œä½†æ±‚æ— è¿‡â€çš„å¿ƒç†å¾—è¿‡ä¸”è¿‡ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æˆæœ¬ï¼šé‡æ„ä½¿ç”¨è¾ƒæ–°ä¸”è¾ƒä¸ºå¤æ‚çš„æŠ€æœ¯ï¼Œå­¦ä¹ æ›²çº¿ä¸å¹³æ»‘ï¼Œå›¢é˜Ÿæˆå‘˜æŠ€æœ¯åˆ‡æ¢å›°éš¾ï¼ŒçŸ­æœŸå†…å¼€å‘æ•ˆç‡å¯èƒ½ä¸å‡åé™ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœä¸€ç›´æ”¾ä»»ä»£ç è…æœ½ä¸‹å»ï¼ŒæŠ€æœ¯å€ºåŠ¡ä¼šè¶Šæ¥è¶Šæ²‰é‡ã€‚å½“ä»£ç æœ€ç»ˆå¿«è¦è·‘ä¸åŠ¨æ—¶ï¼Œæ¶æ„å¸ˆä»¬å¾€å¾€è¿˜æ˜¯ä¸å¾—ä¸ä½¿ç”¨æ¿€è¿›çš„æ‰‹æ®µæ¥æ²»ç–—ä»£ç çš„é¡½ç–¾ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªè¿‡ç¨‹é€šå¸¸éƒ½æ˜¯éå¸¸ç—›è‹¦çš„ï¼Œè€Œä¸”æœ‰ç€å¾ˆé«˜çš„å¤±è´¥é£é™©ã€‚</p>
</li>
<li>
<p><strong>é‡æ„çš„æ”¶ç›Š</strong></p>
<p>é‡æ„çš„æ”¶ç›Šæ˜¯æé«˜ä»£ç çš„è´¨é‡å’Œæ€§èƒ½ï¼Œå¹¶æé«˜æœªæ¥çš„å¼€å‘æ•ˆç‡ã€‚ä½†æ˜¯ï¼Œåº”å½“çœ‹åˆ°ï¼Œé‡æ„å¾€å¾€å¹¶ä¸èƒ½åœ¨çŸ­æœŸå†…å¸¦æ¥å®é™…çš„æ•ˆç›Šï¼Œæˆ–è€…å¾ˆéš¾ç›´è§‚çœ‹å‡ºæ•ˆç›Šã€‚è€Œå¯¹äºä¸€ä¸ªä¼ä¸šæ¥è¯´ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”æ•ˆç›Šæ›´é‡è¦ã€‚æ¢å¥è¯è¯´ï¼Œæ²¡æœ‰å®é™…æ•ˆç›Šçš„äº‹ï¼Œé€šå¸¸ä¹Ÿæ²¡æœ‰ä»·å€¼ã€‚å¾ˆå¤šé¢†å¯¼ï¼Œå°¤å…¶æ˜¯éæŠ€æœ¯æ–¹å‘çš„é¢†å¯¼ï¼Œå¹¶ä¸å…³å¿ƒä½ åº”ç”¨äº†ä»€ä¹ˆæ–°æŠ€æœ¯ï¼Œè®©ä»£ç å˜å¾—å¤šä¹ˆä¼˜é›…ç­‰ç­‰ã€‚</p>
</li>
<li>
<p><strong>é‡æ„çš„åˆé€‚æ—¶æœº</strong></p>
<p>ä»ä»¥ä¸Šæ¥çœ‹ï¼Œé‡æ„å®åœ¨æ˜¯ä¸ªåƒåŠ›ä¸è®¨å¥½çš„äº‹æƒ…ã€‚</p>
<p>äºæ˜¯ï¼Œå¾ˆå¤šäººå±ˆæœäºä¸‡æ¶çš„ KPI å’Œè¦å‘½çš„ deadlineï¼Œä¸€è¾¹åæ§½ç€ä»¥å‰çš„ä»£ç æ˜¯åƒåœ¾ï¼Œä¸€è¾¹è‡ªå·±ä¹Ÿåœ¨é€ åƒåœ¾ã€‚</p>
<p>ä½†æ˜¯ï¼Œ**é‡æ„æœ¬åº”è¯¥æ˜¯ä¸ªæ¸è¿›å¼çš„è¿‡ç¨‹ï¼Œä¸æ˜¯åªæœ‰ä¼¤ç­‹åŠ¨éª¨çš„æ”¹é€ æ‰å«é‡æ„ã€‚**å¦‚æœéè¦ç­‰åˆ°ä»£ç å·²ç»çƒ‚åˆ°ç—…å…¥è†è‚“ï¼Œå†ä½¿ç”¨æ¿€è¿›æ–¹å¼æ¥é‡æ„ï¼Œé‚£å¿…ç„¶æ˜¯å›°éš¾é‡é‡ï¼Œé£é™©æé«˜ã€‚</p>
<p>ã€Šé‡æ„ã€‹ä¹¦ä¸­æåˆ°çš„é‡æ„æ—¶æœºåº”è¯¥åœ¨æ·»åŠ åŠŸèƒ½ã€ä¿®å¤åŠŸèƒ½ã€å®¡æŸ¥ä»£ç æ—¶ï¼Œä¸å»ºè®®ä¸“é—¨æŠ½å‡ºæ—¶é—´ä¸“é—¨åšé‡æ„é¡¹ç›®ã€‚</p>
<p>æˆ‘è®¤ä¸ºï¼Œå…¶æ€æƒ³å°±æ˜¯æŒ‡ï¼š<strong>é‡æ„åº”è¯¥æ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­å®æ—¶çš„ã€æ¸è¿›çš„æ¼”åŒ–è¿‡ç¨‹ã€‚</strong></p>
</li>
<li>
<p><strong>é‡æ„çš„ä¸æ°å½“æ—¶æœº</strong></p>
<p>ä½†æ˜¯ï¼Œè¿™é‡Œæˆ‘ä¹Ÿè¦å¼ºè°ƒä¸€ä¸‹ï¼š<strong>ä¸æ˜¯æ‰€æœ‰è½¯ä»¶å¼€å‘è¿‡ç¨‹éƒ½ä¸€å®šè¦é‡æ„ã€‚</strong></p>
<p>è¾ƒèƒ½<strong>å‡¸æ˜¾é‡æ„ä»·å€¼çš„åœºæ™¯</strong>æ˜¯ï¼šä»£ç è§„æ¨¡è¾ƒå¤§ã€ç”Ÿå‘½å‘¨æœŸè¿˜è¾ƒé•¿ã€æ‰¿æ‹…äº†è¾ƒå¤šè´£ä»»ã€æœ‰ä¸€ä¸ªè¾ƒå¤§ï¼ˆä¸”è¾ƒä¸ç¨³å®šï¼Œäººå‘˜æµåŠ¨é¢‘ç¹ï¼‰å›¢é˜Ÿåœ¨å…¶ä¸Šå·¥ä½œçš„å•ä¸€ä»£ç åº“ã€‚</p>
<p>ä¸ä¹‹ç›¸åï¼Œæœ‰ä¸€äº›åœºæ™¯çš„é‡æ„ä»·å€¼å°±å¾ˆå°ï¼š</p>
<ul>
<li>ä»£ç åº“ç”Ÿå‘½å‘¨æœŸå¿«è¦èµ°åˆ°å°¾å£°ï¼Œå¼€å‘é€æ¸å‡å°‘ï¼Œä»¥ç»´æŠ¤ä¸ºä¸»ã€‚</li>
<li>ä»£ç åº“å½“å‰ç‰ˆæœ¬é©¬ä¸Šè¦å‘å¸ƒäº†ï¼Œè¿™æ—¶é‡æ„æ— ç–‘æ˜¯ç»™è‡ªå·±æ‰¾éº»çƒ¦ã€‚</li>
<li>é‡æ„ä»£ä»·è¿‡äºæ²‰é‡ï¼šé‡æ„ååŠŸèƒ½çš„æ­£ç¡®æ€§ã€ç¨³å®šæ€§éš¾ä»¥ä¿éšœï¼›æŠ€æœ¯è¿‡äºè¶…å‰ï¼Œå›¢é˜Ÿæˆå‘˜æŠ€æœ¯è¿ç§»éš¾åº¦å¤ªå¤§ã€‚</li>
</ul>
</li>
</ul>
<h4 id="å¦‚ä½•é‡æ„how"><a class="markdownIt-Anchor" href="#å¦‚ä½•é‡æ„how"></a> å¦‚ä½•é‡æ„(How)</h4>
<p>é‡æ„è¡Œä¸ºåœ¨æˆ‘çœ‹æ¥ï¼Œä¹Ÿæ˜¯å¯ä»¥åˆ†å±‚çº§çš„ã€‚ç”±é«˜åˆ°ä½ï¼Œè¶Šé«˜å±‚çº§éš¾åº¦è¶Šå¤§ï¼š</p>
<ul>
<li>
<p>æœåŠ¡ã€æ•°æ®åº“<br />
ç°ä»£è½¯ä»¶å¾€å¾€ä¸šåŠ¡å¤æ‚ã€åºå¤§ã€‚ä½¿ç”¨å¾®æœåŠ¡ã€æ•°æ®è¿ç§»æ¥æ‹†åˆ†ä¸šåŠ¡ï¼Œé™ä½ä¸šåŠ¡å¤æ‚åº¦æˆä¸ºäº†ä¸»æµã€‚ä½†æ˜¯ï¼Œè¿™äº›æŠ€æœ¯çš„æµ‹è¯•ã€éƒ¨ç½²å¤æ‚ï¼ŒæŠ€æœ¯éš¾åº¦å¾ˆé«˜ã€‚</p>
</li>
<li>
<p>ç»„ä»¶ã€æ¨¡å—ã€æ¡†æ¶<br />
ç»„ä»¶ã€æ¨¡å—ã€æ¡†æ¶çš„é‡æ„ï¼Œä¸»è¦æ˜¯é’ˆå¯¹ä»£ç çš„è®¾è®¡é—®é¢˜ã€‚è§£å†³çš„æ˜¯ä»£ç çš„æ•´ä½“ç»“æ„é—®é¢˜ã€‚éœ€è¦å¯¹æ¡†æ¶ã€è®¾è®¡æ¨¡å¼ã€åˆ†å¸ƒå¼ã€å¹¶å‘ç­‰ç­‰æœ‰è¶³å¤Ÿçš„äº†è§£ã€‚</p>
</li>
<li>
<p>ç±»ã€æ¥å£ã€å‡½æ•°ã€å­—æ®µ<br />
ã€Šé‡æ„ã€‹ä¸€ä¹¦æåˆ°äº†**â€œä»£ç çš„åå‘³é“â€**ä»¥åŠç›¸å…³çš„é‡æ„æ–¹æ³•ã€‚è¿™äº›éƒ½æ˜¯å¯¹ç±»ã€æ¥å£ã€å‡½æ•°ã€å­—æ®µçº§åˆ«ä»£ç çš„é‡æ„æ‰‹æ®µã€‚ç”±äºè¿™ä¸€çº§åˆ«çš„é‡æ„æ–¹æ³•è¾ƒä¸ºç®€å•ï¼Œæ‰€ä»¥å¯æ“ä½œæ€§è¾ƒå¼ºã€‚å…·ä½“ç»†èŠ‚å¯ä»¥é˜…è¯»ã€Šä»£ç çš„åå‘³é“ã€‹ç¯‡ç« ã€‚</p>
</li>
</ul>
<p>å‰ä¸¤ç§å±‚çº§çš„é‡æ„å·²ç»æ¶‰åŠåˆ°æ¶æ„å±‚é¢ï¼Œå½±å“è¾ƒå¤§ï¼Œéš¾åº¦è¾ƒé«˜ï¼Œå¦‚æœåŠŸåŠ›ä¸å¤Ÿä¸è¦è½»æ˜“å˜åŠ¨ã€‚ç”±äºè¿™ä¸¤ä¸ªå±‚çº§æ¶‰åŠé¢†åŸŸè¾ƒå¹¿ï¼Œè¿™é‡Œä¸åšè®ºè¿°ã€‚</p>
<p><u><strong><em>æ­¤å¤„ä¸ºåˆ†å‰²çº¿ã€‚ä¸‹é¢æ˜¯ä»£ç çš„åå‘³é“ç³»åˆ—ã€‚ã€‚ã€‚</em></strong></u></p>
<h2 id="ä»£ç çš„åå‘³é“"><a class="markdownIt-Anchor" href="#ä»£ç çš„åå‘³é“"></a> ä»£ç çš„åå‘³é“</h2>
<p>ã€Šé‡æ„:æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡ã€‹ä¸­ä»‹ç»äº† 22 ç§ä»£ç çš„åå‘³é“ä»¥åŠé‡æ„æ‰‹æ³•ã€‚è¿™äº›åå‘³é“å¯ä»¥è¿›ä¸€æ­¥å½’ç±»ã€‚æˆ‘æ€»è§‰å¾—å°†äº‹ç‰©åˆ†ç±»æœ‰åŠ©äºç†è§£å’Œè®°å¿†ã€‚æ‰€ä»¥æœ¬ç³»åˆ—å°†åå‘³é“æŒ‰ç…§ç‰¹æ€§åˆ†ç±»ï¼Œç„¶åé€ä¸€è®²è§£ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/design/refactor/code-smell.png"/></div>
<h3 id="ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿"></a> ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç è‡ƒè‚¿(Bloated)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä»£ç ä¸­çš„ç±»ã€å‡½æ•°ã€å­—æ®µæ²¡æœ‰ç»è¿‡åˆç†çš„ç»„ç»‡ï¼Œåªæ˜¯ç®€å•çš„å †ç Œèµ·æ¥ã€‚è¿™ä¸€ç±»å‹çš„é—®é¢˜é€šå¸¸åœ¨ä»£ç çš„åˆæœŸå¹¶ä¸æ˜æ˜¾ï¼Œä½†æ˜¯éšç€ä»£ç è§„æ¨¡çš„å¢é•¿è€Œé€æ¸ç§¯ç´¯ï¼ˆç‰¹åˆ«æ˜¯å½“æ²¡æœ‰äººåŠªåŠ›å»æ ¹é™¤å®ƒä»¬æ—¶ï¼‰ã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E8%BF%87%E9%95%BF%E5%87%BD%E6%95%B0" target="_blank" rel="noopener">è¿‡é•¿å‡½æ•°</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E8%BF%87%E5%A4%A7%E7%9A%84%E7%B1%BB" target="_blank" rel="noopener">è¿‡å¤§çš„ç±»</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%81%8F%E6%89%A7" target="_blank" rel="noopener">åŸºæœ¬ç±»å‹åæ‰§</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E8%BF%87%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97" target="_blank" rel="noopener">è¿‡é•¿å‚æ•°åˆ—</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md#%E6%95%B0%E6%8D%AE%E6%B3%A5%E5%9B%A2" target="_blank" rel="noopener">æ•°æ®æ³¥å›¢</a></li>
</ul>
<h3 id="ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡"></a> ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">æ»¥ç”¨é¢å‘å¯¹è±¡(Object-Orientation Abusers)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä»£ç éƒ¨åˆ†æˆ–å®Œå…¨åœ°è¿èƒŒäº†é¢å‘å¯¹è±¡ç¼–ç¨‹åŸåˆ™ã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md#switch-%E5%A3%B0%E6%98%8E" target="_blank" rel="noopener">switch å£°æ˜</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md#%E4%B8%B4%E6%97%B6%E5%AD%97%E6%AE%B5" target="_blank" rel="noopener">ä¸´æ—¶å­—æ®µ</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md#%E8%A2%AB%E6%8B%92%E7%BB%9D%E7%9A%84%E9%A6%88%E8%B5%A0" target="_blank" rel="noopener">è¢«æ‹’ç»çš„é¦ˆèµ </a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md#%E5%BC%82%E6%9B%B2%E5%90%8C%E5%B7%A5%E7%9A%84%E7%B1%BB" target="_blank" rel="noopener">å¼‚æ›²åŒå·¥çš„ç±»</a></li>
</ul>
<h3 id="ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢"></a> ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">å˜é©çš„éšœç¢(Change Preventers)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šå½“ä½ éœ€è¦æ”¹å˜ä¸€å¤„ä»£ç æ—¶ï¼Œå´å‘ç°ä¸å¾—ä¸æ”¹å˜å…¶ä»–çš„åœ°æ–¹ã€‚è¿™ä½¿å¾—ç¨‹åºå¼€å‘å˜å¾—å¤æ‚ã€ä»£ä»·é«˜æ˜‚ã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md#%E5%8F%91%E6%95%A3%E5%BC%8F%E5%8F%98%E5%8C%96" target="_blank" rel="noopener">å‘æ•£å¼å˜åŒ–</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md#%E9%9C%B0%E5%BC%B9%E5%BC%8F%E4%BF%AE%E6%94%B9" target="_blank" rel="noopener">éœ°å¼¹å¼ä¿®æ”¹</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md#%E5%B9%B3%E8%A1%8C%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB" target="_blank" rel="noopener">å¹³è¡Œç»§æ‰¿ä½“ç³»</a></li>
</ul>
<h3 id="ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„"></a> ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">éå¿…è¦çš„(Dispensables)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šè¿™æ ·çš„ä»£ç å¯æœ‰å¯æ— ï¼Œå®ƒçš„å­˜åœ¨åè€Œå½±å“æ•´ä½“ä»£ç çš„æ•´æ´å’Œå¯è¯»æ€§ã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E8%BF%87%E5%A4%9A%E7%9A%84%E6%B3%A8%E9%87%8A" target="_blank" rel="noopener">è¿‡å¤šçš„æ³¨é‡Š</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener">é‡å¤ä»£ç </a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E5%86%97%E4%BD%99%E7%B1%BB" target="_blank" rel="noopener">å†—ä½™ç±»</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E7%BA%AF%E7%A8%9A%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB" target="_blank" rel="noopener">çº¯ç¨šçš„æ•°æ®ç±»</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md#%E5%A4%B8%E5%A4%B8%E5%85%B6%E8%B0%88%E6%9C%AA%E6%9D%A5%E6%80%A7" target="_blank" rel="noopener">å¤¸å¤¸å…¶è°ˆæœªæ¥æ€§</a></li>
</ul>
<h3 id="ä»£ç åå‘³é“ä¹‹è€¦åˆ"><a class="markdownIt-Anchor" href="#ä»£ç åå‘³é“ä¹‹è€¦åˆ"></a> ä»£ç åå‘³é“ä¹‹è€¦åˆ</h3>
<blockquote>
<p><strong><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">è€¦åˆ(Couplers)</a>è¿™ç»„åå‘³é“æ„å‘³ç€ï¼šä¸åŒç±»ä¹‹é—´è¿‡åº¦è€¦åˆã€‚</strong></p>
</blockquote>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E4%BE%9D%E6%81%8B%E6%83%85%E7%BB%93" target="_blank" rel="noopener">ä¾æ‹æƒ…ç»“</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E7%8B%8E%E6%98%B5%E5%85%B3%E7%B3%BB" target="_blank" rel="noopener">ç‹æ˜µå…³ç³»</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E8%BF%87%E5%BA%A6%E8%80%A6%E5%90%88%E7%9A%84%E6%B6%88%E6%81%AF%E9%93%BE" target="_blank" rel="noopener">è¿‡åº¦è€¦åˆçš„æ¶ˆæ¯é“¾</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E4%B8%AD%E9%97%B4%E4%BA%BA" target="_blank" rel="noopener">ä¸­é—´äºº</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md#%E4%B8%8D%E5%AE%8C%E7%BE%8E%E7%9A%84%E5%BA%93%E7%B1%BB" target="_blank" rel="noopener">ä¸å®Œç¾çš„åº“ç±»</a></li>
</ul>
<h2 id="æ‰©å±•é˜…è¯»"><a class="markdownIt-Anchor" href="#æ‰©å±•é˜…è¯»"></a> æ‰©å±•é˜…è¯»</h2>
<ul>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/" target="_blank" rel="noopener">ä»£ç çš„åå‘³é“å’Œé‡æ„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%87%83%E8%82%BF.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹ä»£ç è‡ƒè‚¿</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E6%BB%A5%E7%94%A8%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹æ»¥ç”¨é¢å‘å¯¹è±¡</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E5%8F%98%E9%9D%A9%E7%9A%84%E9%9A%9C%E7%A2%8D.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹å˜é©çš„éšœç¢</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E9%9D%9E%E5%BF%85%E8%A6%81%E7%9A%84.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹éå¿…è¦çš„</a></li>
<li><a href="https://github.com/dunwu/blog/blob/master/source/_posts/design/refactor/%E4%BB%A3%E7%A0%81%E5%9D%8F%E5%91%B3%E9%81%93%E4%B9%8B%E8%80%A6%E5%90%88.md" target="_blank" rel="noopener">ä»£ç åå‘³é“ä¹‹è€¦åˆ</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://book.douban.com/subject/4262627/" target="_blank" rel="noopener">é‡æ„â€”â€”æ”¹å–„æ—¢æœ‰ä»£ç çš„è®¾è®¡</a> - by Martin Fowler</li>
<li><a href="https://sourcemaking.com/refactoring" target="_blank" rel="noopener">https://sourcemaking.com/refactoring</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/bigdata/Sqoop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/bigdata/Sqoop/" class="post-title-link" itemprop="url">Sqoop</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-04T00:00:00+08:00">2018-09-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-01-16 17:48:30" itemprop="dateModified" datetime="2020-01-16T17:48:30+08:00">2020-01-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/bigdata/" itemprop="url" rel="index">
                    <span itemprop="name">bigdata</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/bigdata/Sqoop/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="bigdata/Sqoop/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>503</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="sqoop"><a class="markdownIt-Anchor" href="#sqoop"></a> Sqoop</h1>
<blockquote>
<p><strong>Sqoop æ˜¯ä¸€ä¸ªä¸»è¦åœ¨ Hadoop å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´è¿›è¡Œæ‰¹é‡æ•°æ®è¿ç§»çš„å·¥å…·ã€‚</strong></p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#sqoop-%E7%AE%80%E4%BB%8B">Sqoop ç®€ä»‹</a>
<ul>
<li><a href="#%E6%8F%90%E4%BE%9B%E5%A4%9A%E7%A7%8D-sqoop-%E8%BF%9E%E6%8E%A5%E5%99%A8">æä¾›å¤šç§ Sqoop è¿æ¥å™¨</a></li>
<li><a href="#sqoop-%E7%89%88%E6%9C%AC">Sqoop ç‰ˆæœ¬</a></li>
</ul>
</li>
<li><a href="#sqoop-%E5%8E%9F%E7%90%86">Sqoop åŸç†</a>
<ul>
<li><a href="#%E5%AF%BC%E5%85%A5">å¯¼å…¥</a></li>
<li><a href="#%E5%AF%BC%E5%87%BA">å¯¼å‡º</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="sqoop-ç®€ä»‹"><a class="markdownIt-Anchor" href="#sqoop-ç®€ä»‹"></a> Sqoop ç®€ä»‹</h2>
<p><strong>Sqoop æ˜¯ä¸€ä¸ªä¸»è¦åœ¨ Hadoop å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´è¿›è¡Œæ‰¹é‡æ•°æ®è¿ç§»çš„å·¥å…·ã€‚</strong></p>
<ul>
<li>Hadoopï¼šHDFSã€Hiveã€HBaseã€Inceptorã€Hyperbase</li>
<li>é¢å‘å¤§æ•°æ®é›†çš„æ‰¹é‡å¯¼å…¥å¯¼å‡º</li>
<li>å°†è¾“å…¥æ•°æ®é›†åˆ†ä¸º N ä¸ªåˆ‡ç‰‡ï¼Œç„¶åå¯åŠ¨ N ä¸ª Map ä»»åŠ¡å¹¶è¡Œä¼ è¾“</li>
<li>æ”¯æŒå…¨é‡ã€å¢é‡ä¸¤ç§ä¼ è¾“æ–¹å¼</li>
</ul>
<h3 id="æä¾›å¤šç§-sqoop-è¿æ¥å™¨"><a class="markdownIt-Anchor" href="#æä¾›å¤šç§-sqoop-è¿æ¥å™¨"></a> æä¾›å¤šç§ Sqoop è¿æ¥å™¨</h3>
<h4 id="å†…ç½®è¿æ¥å™¨"><a class="markdownIt-Anchor" href="#å†…ç½®è¿æ¥å™¨"></a> å†…ç½®è¿æ¥å™¨</h4>
<ul>
<li>ç»è¿‡ä¼˜åŒ–çš„ä¸“ç”¨ RDBMS è¿æ¥å™¨ï¼šMySQLã€PostgreSQLã€Oracleã€DB2ã€SQL Serverã€Netzza ç­‰</li>
<li>é€šç”¨çš„ JDBC è¿æ¥å™¨ï¼šæ”¯æŒ JDBC åè®®çš„æ•°æ®åº“</li>
</ul>
<h4 id="ç¬¬ä¸‰æ–¹è¿æ¥å™¨"><a class="markdownIt-Anchor" href="#ç¬¬ä¸‰æ–¹è¿æ¥å™¨"></a> ç¬¬ä¸‰æ–¹è¿æ¥å™¨</h4>
<ul>
<li>æ•°æ®ä»“åº“ï¼šTeradata</li>
<li>NoSQL æ•°æ®åº“ï¼šCouchbase</li>
</ul>
<h3 id="sqoop-ç‰ˆæœ¬"><a class="markdownIt-Anchor" href="#sqoop-ç‰ˆæœ¬"></a> Sqoop ç‰ˆæœ¬</h3>
<h4 id="sqoop-1-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#sqoop-1-ä¼˜ç¼ºç‚¹"></a> Sqoop 1 ä¼˜ç¼ºç‚¹</h4>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/Sqoop/sqoop-architecture.png"/></div>
<p>ä¼˜ç‚¹</p>
<ul>
<li>æ¶æ„ç®€å•</li>
<li>éƒ¨ç½²ç®€å•</li>
<li>åŠŸèƒ½å…¨é¢</li>
<li>ç¨³å®šæ€§è¾ƒé«˜</li>
<li>é€Ÿåº¦è¾ƒå¿«</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>è®¿é—®æ–¹å¼å•ä¸€</li>
<li>å‘½ä»¤è¡Œæ–¹å¼å®¹æ˜“å‡ºé”™ï¼Œæ ¼å¼ç´§è€¦åˆ</li>
<li>å®‰å…¨æœºåˆ¶ä¸å¤Ÿå®Œå–„ï¼Œå­˜åœ¨å¯†ç æ³„éœ²é£é™©</li>
</ul>
<h4 id="sqoop-2-ä¼˜ç¼ºç‚¹"><a class="markdownIt-Anchor" href="#sqoop-2-ä¼˜ç¼ºç‚¹"></a> Sqoop 2 ä¼˜ç¼ºç‚¹</h4>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/Sqoop/sqoop-v2-architecture.png"/></div>
<p>ä¼˜ç‚¹</p>
<ul>
<li>è®¿é—®æ–¹å¼å¤šæ ·</li>
<li>é›†ä¸­ç®¡ç†è¿æ¥å™¨</li>
<li>å®‰å…¨æœºåˆ¶è¾ƒå®Œå–„</li>
<li>æ”¯æŒå¤šç”¨æˆ·</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>æ¶æ„è¾ƒå¤æ‚</li>
<li>éƒ¨ç½²è¾ƒç¹ç</li>
<li>ç¨³å®šæ€§ä¸€èˆ¬</li>
<li>é€Ÿåº¦ä¸€èˆ¬</li>
</ul>
<h2 id="sqoop-åŸç†"><a class="markdownIt-Anchor" href="#sqoop-åŸç†"></a> Sqoop åŸç†</h2>
<h3 id="å¯¼å…¥"><a class="markdownIt-Anchor" href="#å¯¼å…¥"></a> å¯¼å…¥</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/Sqoop/sqoop-import.png"/></div>
<h3 id="å¯¼å‡º"><a class="markdownIt-Anchor" href="#å¯¼å‡º"></a> å¯¼å‡º</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/Sqoop/sqoop-export.png"/></div>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/bigdata/Flume/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/bigdata/Flume/" class="post-title-link" itemprop="url">Flume</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-04T00:00:00+08:00">2018-09-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-08 18:07:48" itemprop="dateModified" datetime="2019-05-08T18:07:48+08:00">2019-05-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/bigdata/" itemprop="url" rel="index">
                    <span itemprop="name">bigdata</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/bigdata/Flume/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="bigdata/Flume/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.1k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="flume"><a class="markdownIt-Anchor" href="#flume"></a> Flume</h1>
<blockquote>
<p><strong>Sqoop æ˜¯ä¸€ä¸ªä¸»è¦åœ¨ Hadoop å’Œå…³ç³»æ•°æ®åº“ä¹‹é—´è¿›è¡Œæ‰¹é‡æ•°æ®è¿ç§»çš„å·¥å…·ã€‚</strong></p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#flume-%E7%AE%80%E4%BB%8B">Flume ç®€ä»‹</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-flume-">ä»€ä¹ˆæ˜¯ Flume ï¼Ÿ</a></li>
<li><a href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">åº”ç”¨åœºæ™¯</a></li>
</ul>
</li>
<li><a href="#flume-%E5%8E%9F%E7%90%86">Flume åŸç†</a>
<ul>
<li><a href="#flume-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5">Flume åŸºæœ¬æ¦‚å¿µ</a></li>
<li><a href="#flume-%E5%9F%BA%E6%9C%AC%E7%BB%84%E4%BB%B6">Flume åŸºæœ¬ç»„ä»¶</a></li>
<li><a href="#flume-%E6%95%B0%E6%8D%AE%E6%B5%81">Flume æ•°æ®æµ</a></li>
</ul>
</li>
<li><a href="#%E8%B5%84%E6%BA%90">èµ„æº</a></li>
</ul>
<!-- /TOC -->
<h2 id="flume-ç®€ä»‹"><a class="markdownIt-Anchor" href="#flume-ç®€ä»‹"></a> Flume ç®€ä»‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯-flume"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯-flume"></a> ä»€ä¹ˆæ˜¯ Flume ï¼Ÿ</h3>
<p>Flume æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æµ·é‡æ•°æ®é‡‡é›†ã€èšåˆå’Œä¼ è¾“ç³»ç»Ÿã€‚</p>
<p>ç‰¹ç‚¹</p>
<ul>
<li>åŸºäºäº‹ä»¶çš„æµ·é‡æ•°æ®é‡‡é›†</li>
<li>æ•°æ®æµæ¨¡å‹ï¼šSource -&gt; Channel -&gt; Sink</li>
<li>äº‹åŠ¡æœºåˆ¶ï¼šæ”¯æŒé‡è¯»é‡å†™ï¼Œä¿è¯æ¶ˆæ¯ä¼ é€’çš„å¯é æ€§</li>
<li>å†…ç½®ä¸°å¯Œæ’ä»¶ï¼šè½»æ¾ä¸å„ç§å¤–éƒ¨ç³»ç»Ÿé›†æˆ</li>
<li>é«˜å¯ç”¨ï¼šAgent ä¸»å¤‡åˆ‡æ¢</li>
<li>Java å®ç°ï¼šå¼€æºï¼Œä¼˜ç§€çš„ç³»ç»Ÿè®¾è®¡</li>
</ul>
<h3 id="åº”ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#åº”ç”¨åœºæ™¯"></a> åº”ç”¨åœºæ™¯</h3>
<h2 id="flume-åŸç†"><a class="markdownIt-Anchor" href="#flume-åŸç†"></a> Flume åŸç†</h2>
<h3 id="flume-åŸºæœ¬æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#flume-åŸºæœ¬æ¦‚å¿µ"></a> Flume åŸºæœ¬æ¦‚å¿µ</h3>
<ul>
<li>Eventï¼šäº‹ä»¶ï¼Œæœ€å°æ•°æ®ä¼ è¾“å•å…ƒï¼Œç”± Header å’Œ Body ç»„æˆã€‚</li>
<li>Agentï¼šä»£ç†ï¼ŒJVM è¿›ç¨‹ï¼Œæœ€å°è¿è¡Œå•å…ƒï¼Œç”± Sourceã€Channelã€Sink ä¸‰ä¸ªåŸºæœ¬ç»„ä»¶æ„æˆï¼Œè´Ÿè´£å°†å¤–éƒ¨æ•°æ®æºäº§ç”Ÿçš„æ•°æ®ä»¥ Event çš„å½¢å¼ä¼ è¾“åˆ°ç›®çš„åœ°
<ul>
<li>Sourceï¼šè´Ÿè´£å¯¹æ¥å„ç§å¤–éƒ¨æ•°æ®æºï¼Œå°†é‡‡é›†åˆ°çš„æ•°æ®å°è£…æˆ Eventï¼Œç„¶åå†™å…¥ Channel</li>
<li>Channelï¼šEvent æš‚å­˜å®¹å™¨ï¼Œè´Ÿè´£ä¿å­˜ Source å‘é€çš„ Eventï¼Œç›´è‡³è¢« Sink æˆåŠŸè¯»å–</li>
<li>Sinkï¼šè´Ÿè´£ä» Channel è¯»å– Eventï¼Œç„¶åå°†å…¶å†™å…¥å¤–éƒ¨å­˜å‚¨ï¼Œæˆ–ä¼ è¾“ç»™ä¸‹ä¸€é˜¶æ®µçš„ Agent</li>
<li>æ˜ å°„å…³ç³»ï¼š1 ä¸ª Source -&gt; å¤šä¸ª Channelï¼Œ1 ä¸ª Channel -&gt; å¤šä¸ª Sinkï¼Œ1 ä¸ª Sink -&gt; 1 ä¸ª Channel</li>
</ul>
</li>
</ul>
<h3 id="flume-åŸºæœ¬ç»„ä»¶"><a class="markdownIt-Anchor" href="#flume-åŸºæœ¬ç»„ä»¶"></a> Flume åŸºæœ¬ç»„ä»¶</h3>
<h4 id="source-ç»„ä»¶"><a class="markdownIt-Anchor" href="#source-ç»„ä»¶"></a> Source ç»„ä»¶</h4>
<ul>
<li>å¯¹æ¥å„ç§å¤–éƒ¨æ•°æ®æºï¼Œå°†é‡‡é›†åˆ°çš„æ•°æ®å°è£…æˆ Eventï¼Œç„¶åå†™å…¥ Channel</li>
<li>ä¸€ä¸ª Source å¯å‘å¤šä¸ª Channel å‘é€ Event</li>
<li>Flume å†…ç½®ç±»å‹ä¸°å¯Œçš„ Sourceï¼ŒåŒæ—¶ç”¨æˆ·å¯è‡ªå®šä¹‰ Source</li>
</ul>
<h4 id="channel-ç»„ä»¶"><a class="markdownIt-Anchor" href="#channel-ç»„ä»¶"></a> Channel ç»„ä»¶</h4>
<ul>
<li>Event ä¸­è½¬æš‚å­˜åŒºï¼Œå­˜å‚¨ Source é‡‡é›†ä½†æœªè¢« Sink è¯»å–çš„ Event</li>
<li>ä¸ºäº†å¹³è¡¡ Source é‡‡é›†ã€Sink è¯»å–çš„é€Ÿåº¦ï¼Œå¯è§†ä¸º Flume å†…éƒ¨çš„æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>çº¿ç¨‹å®‰å…¨å¹¶å…·æœ‰äº‹åŠ¡æ€§ï¼Œæ”¯æŒ Source å†™å¤±è´¥é‡å†™å’Œ Sink è¯»å¤±è´¥é‡è¯»</li>
</ul>
<h4 id="sink-ç»„ä»¶"><a class="markdownIt-Anchor" href="#sink-ç»„ä»¶"></a> Sink ç»„ä»¶</h4>
<ul>
<li>ä» Channel è¯»å– Eventï¼Œå°†å…¶å†™å…¥å¤–éƒ¨å­˜å‚¨ï¼Œæˆ–ä¼ è¾“åˆ°ä¸‹ä¸€é˜¶æ®µçš„ Agent</li>
<li>ä¸€ä¸ª Sink åªèƒ½ä»ä¸€ä¸ª Channel ä¸­è¯»å– Event</li>
<li>Sink æˆåŠŸè¯»å– Event åï¼Œå‘ Channel æäº¤äº‹åŠ¡ï¼ŒEvent è¢«åˆ é™¤ï¼Œå¦åˆ™ Channel ä¼šç­‰å¾… Sink é‡æ–°è¯»å–</li>
</ul>
<h3 id="flume-æ•°æ®æµ"><a class="markdownIt-Anchor" href="#flume-æ•°æ®æµ"></a> Flume æ•°æ®æµ</h3>
<p>å•å±‚æ¶æ„</p>
<p>ä¼˜ç‚¹ï¼šæ¶æ„ç®€å•ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œå ç”¨èµ„æºè¾ƒå°‘<br />
ç¼ºç‚¹<br />
å¦‚æœé‡‡é›†çš„æ•°æ®æºæˆ–Agentè¾ƒå¤šï¼Œå°†Eventå†™å…¥åˆ°HDFSä¼šäº§ç”Ÿå¾ˆå¤šå°æ–‡ä»¶<br />
å¤–éƒ¨å­˜å‚¨å‡çº§ç»´æŠ¤æˆ–å‘ç”Ÿæ•…éšœï¼Œéœ€å¯¹é‡‡é›†å±‚çš„æ‰€æœ‰Agentåšå¤„ç†ï¼ŒäººåŠ›æˆæœ¬è¾ƒé«˜ï¼Œç³»ç»Ÿç¨³å®šæ€§è¾ƒå·®<br />
ç³»ç»Ÿå®‰å…¨æ€§è¾ƒå·®<br />
æ•°æ®æºç®¡ç†è¾ƒæ··ä¹±</p>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/bigdata/MapReduce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/bigdata/MapReduce/" class="post-title-link" itemprop="url">MapReduce</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-09-03 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-03T00:00:00+08:00">2018-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-08 18:07:48" itemprop="dateModified" datetime="2019-05-08T18:07:48+08:00">2019-05-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/bigdata/" itemprop="url" rel="index">
                    <span itemprop="name">bigdata</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/bigdata/MapReduce/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="bigdata/MapReduce/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.8k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="mapreduce"><a class="markdownIt-Anchor" href="#mapreduce"></a> MapReduce</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#mapreduce-%E7%AE%80%E4%BB%8B">MapReduce ç®€ä»‹</a>
<ul>
<li><a href="#%E6%A6%82%E5%BF%B5">æ¦‚å¿µ</a></li>
<li><a href="#%E6%80%9D%E6%83%B3">æ€æƒ³</a></li>
<li><a href="#%E7%89%B9%E7%82%B9">ç‰¹ç‚¹</a></li>
<li><a href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">é€‚ç”¨åœºæ™¯</a></li>
<li><a href="#%E4%B8%8D%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">ä¸é€‚ç”¨åœºæ™¯</a></li>
</ul>
</li>
<li><a href="#mapreduce-%E5%8E%9F%E7%90%86">MapReduce åŸç†</a>
<ul>
<li><a href="#job--task%E4%BD%9C%E4%B8%9A%E4%B8%8E%E4%BB%BB%E5%8A%A1">Job &amp; Taskï¼ˆä½œä¸šä¸ä»»åŠ¡ï¼‰</a></li>
<li><a href="#split%E5%88%87%E7%89%87">Splitï¼ˆåˆ‡ç‰‡ï¼‰</a></li>
<li><a href="#map-%E9%98%B6%E6%AE%B5%E6%98%A0%E5%B0%84">Map é˜¶æ®µï¼ˆæ˜ å°„ï¼‰</a></li>
<li><a href="#reduce-%E9%98%B6%E6%AE%B5%E5%8C%96%E7%AE%80">Reduce é˜¶æ®µï¼ˆåŒ–ç®€ï¼‰</a></li>
<li><a href="#shuffle-%E9%98%B6%E6%AE%B5%E6%B4%97%E7%89%8C">Shuffle é˜¶æ®µï¼ˆæ´—ç‰Œï¼‰</a></li>
</ul>
</li>
<li><a href="#shuffle-%E8%AF%A6%E8%A7%A3">Shuffle è¯¦è§£</a>
<ul>
<li><a href="#map-%E7%AB%AF">Map ç«¯</a></li>
<li><a href="#reduce-%E7%AB%AF">Reduce ç«¯</a></li>
</ul>
</li>
<li><a href="#%E4%BD%9C%E4%B8%9A%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F">ä½œä¸šè¿è¡Œæ¨¡å¼</a>
<ul>
<li><a href="#jobtrackertasktracker-%E6%A8%A1%E5%BC%8Fhadoop-1x">JobTracker/TaskTracker æ¨¡å¼ï¼ˆHadoop 1.Xï¼‰</a></li>
<li><a href="#yarn-%E6%A8%A1%E5%BC%8Fhadoop-2x">YARN æ¨¡å¼ï¼ˆHadoop 2.Xï¼‰</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="mapreduce-ç®€ä»‹"><a class="markdownIt-Anchor" href="#mapreduce-ç®€ä»‹"></a> MapReduce ç®€ä»‹</h2>
<h3 id="æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#æ¦‚å¿µ"></a> æ¦‚å¿µ</h3>
<p>MapReduce æ˜¯ä¸€ä¸ªé¢å‘æ‰¹å¤„ç†çš„åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ã€‚</p>
<p>ç¼–ç¨‹æ¨¡å‹ï¼šMapReduce ç¨‹åºè¢«åˆ†ä¸º Mapï¼ˆæ˜ å°„ï¼‰é˜¶æ®µå’Œ Reduceï¼ˆåŒ–ç®€ï¼‰é˜¶æ®µã€‚</p>
<h3 id="æ€æƒ³"><a class="markdownIt-Anchor" href="#æ€æƒ³"></a> æ€æƒ³</h3>
<p>åˆ†è€Œæ²»ä¹‹ï¼Œå¹¶è¡Œè®¡ç®—<br />
ç§»åŠ¨è®¡ç®—ï¼Œè€Œéç§»åŠ¨æ•°æ®</p>
<h3 id="ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#ç‰¹ç‚¹"></a> ç‰¹ç‚¹</h3>
<ul>
<li>è®¡ç®—è·Ÿç€æ•°æ®èµ°</li>
<li>è‰¯å¥½çš„æ‰©å±•æ€§ï¼šè®¡ç®—èƒ½åŠ›éšç€èŠ‚ç‚¹æ•°å¢åŠ ï¼Œè¿‘ä¼¼çº¿æ€§é€’å¢</li>
<li>é«˜å®¹é”™</li>
<li>çŠ¶æ€ç›‘æ§</li>
<li>é€‚åˆæµ·é‡æ•°æ®çš„ç¦»çº¿æ‰¹å¤„ç†</li>
<li>é™ä½äº†åˆ†å¸ƒå¼ç¼–ç¨‹çš„é—¨æ§›</li>
</ul>
<h3 id="é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#é€‚ç”¨åœºæ™¯"></a> é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>æ•°æ®ç»Ÿè®¡ï¼Œå¦‚ï¼šç½‘ç«™çš„ PVã€UV ç»Ÿè®¡</li>
<li>æœç´¢å¼•æ“æ„å»ºç´¢å¼•</li>
<li>æµ·é‡æ•°æ®æŸ¥è¯¢</li>
</ul>
<h3 id="ä¸é€‚ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#ä¸é€‚ç”¨åœºæ™¯"></a> ä¸é€‚ç”¨åœºæ™¯</h3>
<ul>
<li>OLAP
<ul>
<li>è¦æ±‚æ¯«ç§’æˆ–ç§’çº§è¿”å›ç»“æœ</li>
</ul>
</li>
<li>æµè®¡ç®—
<ul>
<li>æµè®¡ç®—çš„è¾“å…¥æ•°æ®é›†æ˜¯åŠ¨æ€çš„ï¼Œè€Œ MapReduce æ˜¯é™æ€çš„</li>
</ul>
</li>
<li>DAG è®¡ç®—
<ul>
<li>å¤šä¸ªä½œä¸šå­˜åœ¨ä¾èµ–å…³ç³»ï¼Œåä¸€ä¸ªçš„è¾“å…¥æ˜¯å‰ä¸€ä¸ªçš„è¾“å‡ºï¼Œæ„æˆæœ‰å‘æ— ç¯å›¾ DAG</li>
<li>æ¯ä¸ª MapReduce ä½œä¸šçš„è¾“å‡ºç»“æœéƒ½ä¼šè½ç›˜ï¼Œé€ æˆå¤§é‡ç£ç›˜ IOï¼Œå¯¼è‡´æ€§èƒ½éå¸¸ä½ä¸‹</li>
</ul>
</li>
</ul>
<h2 id="mapreduce-åŸç†"><a class="markdownIt-Anchor" href="#mapreduce-åŸç†"></a> MapReduce åŸç†</h2>
<h3 id="job-taskä½œä¸šä¸ä»»åŠ¡"><a class="markdownIt-Anchor" href="#job-taskä½œä¸šä¸ä»»åŠ¡"></a> Job &amp; Taskï¼ˆä½œä¸šä¸ä»»åŠ¡ï¼‰</h3>
<ul>
<li>ä½œä¸šæ˜¯å®¢æˆ·ç«¯è¯·æ±‚æ‰§è¡Œçš„ä¸€ä¸ªå·¥ä½œå•å…ƒ
<ul>
<li>åŒ…æ‹¬è¾“å…¥æ•°æ®ã€MapReduce ç¨‹åºã€é…ç½®ä¿¡æ¯</li>
</ul>
</li>
<li>ä»»åŠ¡æ˜¯å°†ä½œä¸šåˆ†è§£åå¾—åˆ°çš„ç»†åˆ†å·¥ä½œå•å…ƒ
<ul>
<li>åˆ†ä¸º Map ä»»åŠ¡å’Œ Reduce ä»»åŠ¡</li>
</ul>
</li>
</ul>
<h3 id="splitåˆ‡ç‰‡"><a class="markdownIt-Anchor" href="#splitåˆ‡ç‰‡"></a> Splitï¼ˆåˆ‡ç‰‡ï¼‰</h3>
<ul>
<li>è¾“å…¥æ•°æ®è¢«åˆ’åˆ†æˆç­‰é•¿çš„å°æ•°æ®å—ï¼Œç§°ä¸ºè¾“å…¥åˆ‡ç‰‡ï¼ˆInput Splitï¼‰ï¼Œç®€ç§°åˆ‡ç‰‡</li>
<li>Split æ˜¯é€»è¾‘æ¦‚å¿µï¼Œä»…åŒ…å«å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚ï¼šæ•°æ®çš„èµ·å§‹ä½ç½®ã€é•¿åº¦ã€æ‰€åœ¨èŠ‚ç‚¹ç­‰</li>
<li>æ¯ä¸ª Split äº¤ç»™ä¸€ä¸ª Map ä»»åŠ¡å¤„ç†ï¼ŒSplit çš„æ•°é‡å†³å®š Map ä»»åŠ¡çš„æ•°é‡</li>
<li>Split çš„åˆ’åˆ†æ–¹å¼ç”±ç¨‹åºè®¾å®šï¼ŒSplit ä¸ HDFS Block æ²¡æœ‰ä¸¥æ ¼çš„å¯¹åº”å…³ç³»</li>
<li>Split çš„å¤§å°é»˜è®¤ç­‰äº Block å¤§å°</li>
<li>Split è¶Šå°ï¼Œè´Ÿè½½è¶Šå‡è¡¡ï¼Œä½†é›†ç¾¤çš„å¼€é”€è¶Šå¤§</li>
</ul>
<h3 id="map-é˜¶æ®µæ˜ å°„"><a class="markdownIt-Anchor" href="#map-é˜¶æ®µæ˜ å°„"></a> Map é˜¶æ®µï¼ˆæ˜ å°„ï¼‰</h3>
<ul>
<li>ç”±è‹¥å¹² Map ä»»åŠ¡ç»„æˆï¼Œä»»åŠ¡æ•°é‡ç”± Split æ•°é‡å†³å®š</li>
<li>è¾“å…¥ï¼šSplit åˆ‡ç‰‡ï¼ˆkey-valueï¼‰ï¼Œè¾“å‡ºï¼šä¸­é—´è®¡ç®—ç»“æœï¼ˆkey-valueï¼‰</li>
</ul>
<h3 id="reduce-é˜¶æ®µåŒ–ç®€"><a class="markdownIt-Anchor" href="#reduce-é˜¶æ®µåŒ–ç®€"></a> Reduce é˜¶æ®µï¼ˆåŒ–ç®€ï¼‰</h3>
<ul>
<li>ç”±è‹¥å¹² Reduce ä»»åŠ¡ç»„æˆï¼Œä»»åŠ¡æ•°é‡ç”±ç¨‹åºæŒ‡å®š</li>
<li>è¾“å…¥ï¼šMap é˜¶æ®µè¾“å‡ºçš„ä¸­é—´ç»“æœï¼ˆkey-valueï¼‰ï¼Œè¾“å‡ºï¼šæœ€ç»ˆç»“æœï¼ˆkey-valueï¼‰</li>
</ul>
<h3 id="shuffle-é˜¶æ®µæ´—ç‰Œ"><a class="markdownIt-Anchor" href="#shuffle-é˜¶æ®µæ´—ç‰Œ"></a> Shuffle é˜¶æ®µï¼ˆæ´—ç‰Œï¼‰</h3>
<ul>
<li>Mapã€Reduce é˜¶æ®µçš„ä¸­é—´ç¯èŠ‚ï¼Œè´Ÿè´£æ‰§è¡Œ Partitionï¼ˆåˆ†åŒºï¼‰ã€Sortï¼ˆæ’åºï¼‰ã€Spillï¼ˆæº¢å†™ï¼‰ã€Mergeï¼ˆåˆå¹¶ï¼‰ã€æŠ“å–ï¼ˆFetchï¼‰ç­‰å·¥ä½œ</li>
<li>Partition å†³å®šäº† Map ä»»åŠ¡è¾“å‡ºçš„æ¯æ¡æ•°æ®æ”¾å…¥å“ªä¸ªåˆ†åŒºï¼Œäº¤ç»™å“ªä¸ª Reduce ä»»åŠ¡å¤„ç†</li>
<li>Reduce ä»»åŠ¡çš„æ•°é‡å†³å®šäº† Partition æ•°é‡</li>
<li>Partition ç¼–å· = Reduce ä»»åŠ¡ç¼–å· =â€œkey hashcode % reduce task numberâ€</li>
<li>é¿å…å’Œå‡å°‘ Shuffle æ˜¯ MapReduce ç¨‹åºè°ƒä¼˜çš„é‡ç‚¹</li>
</ul>
<h2 id="shuffle-è¯¦è§£"><a class="markdownIt-Anchor" href="#shuffle-è¯¦è§£"></a> Shuffle è¯¦è§£</h2>
<h3 id="map-ç«¯"><a class="markdownIt-Anchor" href="#map-ç«¯"></a> Map ç«¯</h3>
<p>Map ä»»åŠ¡å°†ä¸­é—´ç»“æœå†™å…¥ä¸“ç”¨å†…å­˜ç¼“å†²åŒº Bufferï¼ˆé»˜è®¤ 100Mï¼‰ï¼ŒåŒæ—¶è¿›è¡Œ Partition å’Œ Sortï¼ˆå…ˆæŒ‰â€œkey hashcode % reduce task numberâ€å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºï¼Œåˆ†åŒºå†…å†æŒ‰ key æ’åºï¼‰<br />
å½“ Buffer çš„æ•°æ®é‡è¾¾åˆ°é˜ˆå€¼ï¼ˆé»˜è®¤ 80%ï¼‰æ—¶ï¼Œå°†æ•°æ®æº¢å†™ï¼ˆSpillï¼‰åˆ°ç£ç›˜çš„ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶å†…æ•°æ®å…ˆåˆ†åŒºåæ’åº<br />
Map ä»»åŠ¡ç»“æŸå‰ï¼Œå°†å¤šä¸ªä¸´æ—¶æ–‡ä»¶åˆå¹¶ï¼ˆMergeï¼‰ä¸ºä¸€ä¸ª Map è¾“å‡ºæ–‡ä»¶ï¼Œæ–‡ä»¶å†…æ•°æ®å…ˆåˆ†åŒºåæ’åº</p>
<h3 id="reduce-ç«¯"><a class="markdownIt-Anchor" href="#reduce-ç«¯"></a> Reduce ç«¯</h3>
<p>Reduce ä»»åŠ¡ä»å¤šä¸ª Map è¾“å‡ºæ–‡ä»¶ä¸­ä¸»åŠ¨æŠ“å–ï¼ˆFetchï¼‰å±äºè‡ªå·±çš„åˆ†åŒºæ•°æ®ï¼Œå…ˆå†™å…¥ Bufferï¼Œæ•°æ®é‡è¾¾åˆ°é˜ˆå€¼åï¼Œæº¢å†™åˆ°ç£ç›˜çš„ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­<br />
æ•°æ®æŠ“å–å®Œæˆåï¼Œå°†å¤šä¸ªä¸´æ—¶æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ª Reduce è¾“å…¥æ–‡ä»¶ï¼Œæ–‡ä»¶å†…æ•°æ®æŒ‰ key æ’åº</p>
<h2 id="ä½œä¸šè¿è¡Œæ¨¡å¼"><a class="markdownIt-Anchor" href="#ä½œä¸šè¿è¡Œæ¨¡å¼"></a> ä½œä¸šè¿è¡Œæ¨¡å¼</h2>
<h3 id="jobtrackertasktracker-æ¨¡å¼hadoop-1x"><a class="markdownIt-Anchor" href="#jobtrackertasktracker-æ¨¡å¼hadoop-1x"></a> JobTracker/TaskTracker æ¨¡å¼ï¼ˆHadoop 1.Xï¼‰</h3>
<p><strong>JobTracker èŠ‚ç‚¹ï¼ˆMasterï¼‰</strong></p>
<ul>
<li>è°ƒåº¦ä»»åŠ¡åœ¨ TaskTracker ä¸Šè¿è¡Œ</li>
<li>è‹¥ä»»åŠ¡å¤±è´¥ï¼ŒæŒ‡å®šæ–° TaskTracker é‡æ–°è¿è¡Œ</li>
</ul>
<p><strong>TaskTracker èŠ‚ç‚¹ï¼ˆSlaveï¼‰</strong></p>
<ul>
<li>æ‰§è¡Œä»»åŠ¡ï¼Œå‘é€è¿›åº¦æŠ¥å‘Š</li>
</ul>
<p><strong>å­˜åœ¨çš„é—®é¢˜</strong></p>
<ul>
<li>JobTracker å­˜åœ¨å•ç‚¹æ•…éšœ</li>
<li>JobTracker è´Ÿè½½å¤ªé‡ï¼ˆä¸Šé™ 4000 èŠ‚ç‚¹ï¼‰</li>
<li>JobTracker ç¼ºå°‘å¯¹èµ„æºçš„å…¨é¢ç®¡ç†</li>
<li>TaskTracker å¯¹èµ„æºçš„æè¿°è¿‡äºç®€å•</li>
<li>æºç å¾ˆéš¾ç†è§£</li>
</ul>
<h3 id="yarn-æ¨¡å¼hadoop-2x"><a class="markdownIt-Anchor" href="#yarn-æ¨¡å¼hadoop-2x"></a> YARN æ¨¡å¼ï¼ˆHadoop 2.Xï¼‰</h3>
<ul>
<li>æäº¤ä½œä¸š</li>
<li>æŸ¥çœ‹ä½œä¸š</li>
<li>ç»ˆæ­¢ä½œä¸š</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/bigdata/HDFS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/bigdata/HDFS/" class="post-title-link" itemprop="url">HDFS</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-09-03 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-03T00:00:00+08:00">2018-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-01-16 17:48:30" itemprop="dateModified" datetime="2020-01-16T17:48:30+08:00">2020-01-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/bigdata/" itemprop="url" rel="index">
                    <span itemprop="name">bigdata</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/bigdata/HDFS/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="bigdata/HDFS/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>4.1k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>4 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="hdfs"><a class="markdownIt-Anchor" href="#hdfs"></a> HDFS</h1>
<blockquote>
<p><strong>HDFS æ˜¯ Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚</strong></p>
<p>å…³é”®è¯ï¼šåˆ†å¸ƒå¼ã€æ–‡ä»¶ç³»ç»Ÿ</p>
</blockquote>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E6%A6%82%E8%BF%B0">æ¦‚è¿°</a>
<ul>
<li><a href="#hdfs-%E7%9A%84%E7%89%B9%E7%82%B9">HDFS çš„ç‰¹ç‚¹</a></li>
</ul>
</li>
<li><a href="#hdfs-%E7%9A%84%E6%A6%82%E5%BF%B5">HDFS çš„æ¦‚å¿µ</a>
<ul>
<li><a href="#namenode">NameNode</a></li>
<li><a href="#datanode">DataNode</a></li>
<li><a href="#block-%E6%95%B0%E6%8D%AE%E5%9D%97">Block æ•°æ®å—</a></li>
<li><a href="#client">Client</a></li>
</ul>
</li>
<li><a href="#block-%E5%89%AF%E6%9C%AC%E7%AD%96%E7%95%A5">Block å‰¯æœ¬ç­–ç•¥</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E6%B5%81">æ•°æ®æµ</a>
<ul>
<li><a href="#hdfs-%E8%AF%BB%E6%96%87%E4%BB%B6">HDFS è¯»æ–‡ä»¶</a></li>
<li><a href="#hdfs-%E5%86%99%E6%96%87%E4%BB%B6">HDFS å†™æ–‡ä»¶</a></li>
</ul>
</li>
<li><a href="#hdfs-%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F">HDFS å®‰å…¨æ¨¡å¼</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F">ä»€ä¹ˆæ˜¯å®‰å…¨æ¨¡å¼ï¼Ÿ</a></li>
<li><a href="#%E4%BD%95%E6%97%B6%E6%AD%A3%E5%B8%B8%E7%A6%BB%E5%BC%80%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F">ä½•æ—¶æ­£å¸¸ç¦»å¼€å®‰å…¨æ¨¡å¼</a></li>
<li><a href="#%E8%A7%A6%E5%8F%91%E5%AE%89%E5%85%A8%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8E%9F%E5%9B%A0">è§¦å‘å®‰å…¨æ¨¡å¼çš„åŸå› </a></li>
<li><a href="#%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5">æ•…éšœæ’æŸ¥</a></li>
</ul>
</li>
<li><a href="#hdfs-%E9%AB%98%E5%8F%AF%E7%94%A8">HDFS é«˜å¯ç”¨</a>
<ul>
<li><a href="#namenode-%E7%9A%84-ha-%E6%9C%BA%E5%88%B6">NameNode çš„ HA æœºåˆ¶</a></li>
<li><a href="#%E5%88%A9%E7%94%A8-qjm-%E5%AE%9E%E7%8E%B0%E5%85%83%E6%95%B0%E6%8D%AE%E9%AB%98%E5%8F%AF%E7%94%A8">åˆ©ç”¨ QJM å®ç°å…ƒæ•°æ®é«˜å¯ç”¨</a></li>
</ul>
</li>
<li><a href="#%E8%B5%84%E6%BA%90">èµ„æº</a></li>
</ul>
<!-- /TOC -->
<h2 id="æ¦‚è¿°"><a class="markdownIt-Anchor" href="#æ¦‚è¿°"></a> æ¦‚è¿°</h2>
<blockquote>
<p>HDFS æ˜¯ Hadoop çš„æ ¸å¿ƒå­é¡¹ç›®ã€‚</p>
<p><strong>HDFS</strong> æ˜¯ <strong>Hadoop Distributed File System</strong> çš„ç¼©å†™ï¼Œå³ Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p>HDFS æ˜¯ä¸€ç§ç”¨äºå­˜å‚¨å…·æœ‰æµæ•°æ®è®¿é—®æ¨¡å¼çš„è¶…å¤§æ–‡ä»¶çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒè¿è¡Œåœ¨å»‰ä»·çš„æœºå™¨é›†ç¾¤ä¸Šã€‚</p>
</blockquote>
<h3 id="hdfs-çš„ç‰¹ç‚¹"><a class="markdownIt-Anchor" href="#hdfs-çš„ç‰¹ç‚¹"></a> HDFS çš„ç‰¹ç‚¹</h3>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li><strong>é«˜å®¹é”™</strong> - æ•°æ®å†—ä½™å¤šå‰¯æœ¬ï¼Œå‰¯æœ¬ä¸¢å¤±åè‡ªåŠ¨æ¢å¤</li>
<li><strong>é«˜å¯ç”¨</strong> - NameNode HAã€å®‰å…¨æ¨¡å¼</li>
<li><strong>é«˜æ‰©å±•</strong> - èƒ½å¤Ÿå¤„ç† 10K èŠ‚ç‚¹çš„è§„æ¨¡ï¼›å¤„ç†æ•°æ®è¾¾åˆ° GBã€TBã€ç”šè‡³ PB çº§åˆ«çš„æ•°æ®ï¼›èƒ½å¤Ÿå¤„ç†ç™¾ä¸‡è§„æ¨¡ä»¥ä¸Šçš„æ–‡ä»¶æ•°é‡ï¼Œæ•°é‡ç›¸å½“ä¹‹å¤§ã€‚</li>
<li><strong>æ‰¹å¤„ç†</strong> - æµå¼æ•°æ®è®¿é—®ï¼›æ•°æ®ä½ç½®æš´éœ²ç»™è®¡ç®—æ¡†æ¶</li>
<li><strong>æ„å»ºåœ¨å»‰ä»·å•†ç”¨æœºå™¨ä¸Š</strong> - æä¾›äº†å®¹é”™å’Œæ¢å¤æœºåˆ¶</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li><strong>ä¸é€‚åˆä½å»¶è¿Ÿæ•°æ®è®¿é—®</strong> - é€‚åˆé«˜ååç‡çš„åœºæ™¯ï¼Œå°±æ˜¯åœ¨æŸä¸€æ—¶é—´å†…å†™å…¥å¤§é‡çš„æ•°æ®ã€‚ä½†æ˜¯å®ƒåœ¨ä½å»¶æ—¶çš„æƒ…å†µä¸‹æ˜¯ä¸è¡Œçš„ï¼Œæ¯”å¦‚æ¯«ç§’çº§ä»¥å†…è¯»å–æ•°æ®ï¼Œå®ƒæ˜¯å¾ˆéš¾åšåˆ°çš„ã€‚</li>
<li><strong>ä¸é€‚åˆå¤§é‡å°æ–‡ä»¶å­˜å‚¨</strong>
<ul>
<li>å­˜å‚¨å¤§é‡å°æ–‡ä»¶(è¿™é‡Œçš„å°æ–‡ä»¶æ˜¯æŒ‡å°äº HDFS ç³»ç»Ÿçš„ Block å¤§å°çš„æ–‡ä»¶ï¼ˆé»˜è®¤ 64Mï¼‰)çš„è¯ï¼Œå®ƒä¼šå ç”¨ NameNode å¤§é‡çš„å†…å­˜æ¥å­˜å‚¨æ–‡ä»¶ã€ç›®å½•å’Œå—ä¿¡æ¯ã€‚è¿™æ ·æ˜¯ä¸å¯å–çš„ï¼Œå› ä¸º NameNode çš„å†…å­˜æ€»æ˜¯æœ‰é™çš„ã€‚</li>
<li>ç£ç›˜å¯»é“æ—¶é—´è¶…è¿‡è¯»å–æ—¶é—´</li>
</ul>
</li>
<li><strong>ä¸æ”¯æŒå¹¶å‘å†™å…¥</strong> - ä¸€ä¸ªæ–‡ä»¶åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªå†™å…¥è€…</li>
<li><strong>ä¸æ”¯æŒæ–‡ä»¶éšæœºä¿®æ”¹</strong> - ä»…æ”¯æŒè¿½åŠ å†™å…¥</li>
</ul>
<h2 id="hdfs-çš„æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#hdfs-çš„æ¦‚å¿µ"></a> HDFS çš„æ¦‚å¿µ</h2>
<p>HDFS é‡‡ç”¨ Master/Slave æ¶æ„ã€‚</p>
<p>ä¸€ä¸ª HDFS é›†ç¾¤æ˜¯ç”±ä¸€ä¸ª Namenode å’Œä¸€å®šæ•°ç›®çš„ Datanodes ç»„æˆã€‚Namenode æ˜¯ä¸€ä¸ªä¸­å¿ƒæœåŠ¡å™¨ï¼Œè´Ÿè´£ç®¡ç†æ–‡ä»¶ç³»ç»Ÿçš„åå­—ç©ºé—´(namespace)ä»¥åŠå®¢æˆ·ç«¯å¯¹æ–‡ä»¶çš„è®¿é—®ã€‚é›†ç¾¤ä¸­çš„ Datanode ä¸€èˆ¬æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ä¸€ä¸ªï¼Œè´Ÿè´£ç®¡ç†å®ƒæ‰€åœ¨èŠ‚ç‚¹ä¸Šçš„å­˜å‚¨ã€‚HDFS æš´éœ²äº†æ–‡ä»¶ç³»ç»Ÿçš„åå­—ç©ºé—´ï¼Œç”¨æˆ·èƒ½å¤Ÿä»¥æ–‡ä»¶çš„å½¢å¼åœ¨ä¸Šé¢å­˜å‚¨æ•°æ®ã€‚ä»å†…éƒ¨çœ‹ï¼Œä¸€ä¸ªæ–‡ä»¶å…¶å®è¢«åˆ†æˆä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å—ï¼Œè¿™äº›å—å­˜å‚¨åœ¨ä¸€ç»„ Datanode ä¸Šã€‚Namenode æ‰§è¡Œæ–‡ä»¶ç³»ç»Ÿçš„åå­—ç©ºé—´æ“ä½œï¼Œæ¯”å¦‚æ‰“å¼€ã€å…³é—­ã€é‡å‘½åæ–‡ä»¶æˆ–ç›®å½•ã€‚å®ƒä¹Ÿè´Ÿè´£ç¡®å®šæ•°æ®å—åˆ°å…·ä½“ Datanode èŠ‚ç‚¹çš„æ˜ å°„ã€‚Datanode è´Ÿè´£å¤„ç†æ–‡ä»¶ç³»ç»Ÿå®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ã€‚åœ¨ Namenode çš„ç»Ÿä¸€è°ƒåº¦ä¸‹è¿›è¡Œæ•°æ®å—çš„åˆ›å»ºã€åˆ é™¤å’Œå¤åˆ¶ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hdfs/hdfs-architecture.png"/></div>
<h3 id="namenode"><a class="markdownIt-Anchor" href="#namenode"></a> NameNode</h3>
<p><strong>NameNode å°±æ˜¯ master å·¥ä½œèŠ‚ç‚¹ã€‚</strong></p>
<ul>
<li>ç®¡ç†å‘½åç©ºé—´</li>
<li>ç®¡ç†å…ƒæ•°æ®ï¼šæ–‡ä»¶çš„ä½ç½®ã€æ‰€æœ‰è€…ã€æƒé™ã€æ•°æ®å—ç­‰</li>
<li>ç®¡ç† Block å‰¯æœ¬ç­–ç•¥ï¼šé»˜è®¤ 3 ä¸ªå‰¯æœ¬</li>
<li>å¤„ç†å®¢æˆ·ç«¯è¯»å†™è¯·æ±‚ï¼Œä¸º DataNode åˆ†é…ä»»åŠ¡</li>
</ul>
<h4 id="active-namenode-å’Œ-standby-namenode"><a class="markdownIt-Anchor" href="#active-namenode-å’Œ-standby-namenode"></a> Active NameNode å’Œ Standby NameNode</h4>
<p>NameNode é€šè¿‡ HA æœºåˆ¶æ¥å®¹é”™ã€‚</p>
<ul>
<li><strong>Active NameNode</strong> - æ˜¯æ­£åœ¨å·¥ä½œçš„ NameNodeï¼›</li>
<li><strong>Standby NameNode</strong> - æ˜¯å¤‡ä»½çš„ NameNodeã€‚</li>
</ul>
<p>Active NameNode å®•æœºåï¼ŒStandby NameNode å¿«é€Ÿå‡çº§ä¸ºæ–°çš„ Active NameNodeã€‚</p>
<p>Standby NameNode å‘¨æœŸæ€§åŒæ­¥ edits ç¼–è¾‘æ—¥å¿—ï¼Œå®šæœŸåˆå¹¶ fsimage ä¸ edits åˆ°æœ¬åœ°ç£ç›˜ã€‚</p>
<p>Hadoop 3.0 å…è®¸é…ç½®å¤šä¸ª Standby NameNodeã€‚</p>
<h4 id="å…ƒæ•°æ®æ–‡ä»¶"><a class="markdownIt-Anchor" href="#å…ƒæ•°æ®æ–‡ä»¶"></a> å…ƒæ•°æ®æ–‡ä»¶</h4>
<ul>
<li><strong>editsï¼ˆç¼–è¾‘æ—¥å¿—æ–‡ä»¶ï¼‰</strong> - ä¿å­˜äº†è‡ªæœ€æ–°æ£€æŸ¥ç‚¹ï¼ˆCheckpointï¼‰ä¹‹åçš„æ‰€æœ‰æ–‡ä»¶æ›´æ–°æ“ä½œã€‚</li>
<li><strong>fsimageï¼ˆå…ƒæ•°æ®æ£€æŸ¥ç‚¹é•œåƒæ–‡ä»¶ï¼‰</strong> - ä¿å­˜äº†æ–‡ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰çš„ç›®å½•å’Œæ–‡ä»¶ä¿¡æ¯ï¼Œå¦‚ï¼šæŸä¸ªç›®å½•ä¸‹æœ‰å“ªäº›å­ç›®å½•å’Œæ–‡ä»¶ï¼Œä»¥åŠæ–‡ä»¶åã€æ–‡ä»¶å‰¯æœ¬æ•°ã€æ–‡ä»¶ç”±å“ªäº› Block ç»„æˆç­‰ã€‚</li>
</ul>
<p>Active NameNode å†…å­˜ä¸­æœ‰ä¸€ä»½æœ€æ–°çš„å…ƒæ•°æ®ï¼ˆ= fsimage + editsï¼‰ã€‚</p>
<p>Standby NameNode åœ¨æ£€æŸ¥ç‚¹å®šæœŸå°†å†…å­˜ä¸­çš„å…ƒæ•°æ®ä¿å­˜åˆ° fsimage æ–‡ä»¶ä¸­ã€‚</p>
<h3 id="datanode"><a class="markdownIt-Anchor" href="#datanode"></a> DataNode</h3>
<p>**DataNode å°±æ˜¯ slave å·¥ä½œèŠ‚ç‚¹ã€‚**NameNode ä¸‹è¾¾å‘½ä»¤ï¼ŒDataNode æ‰§è¡Œå®é™…çš„æ“ä½œã€‚</p>
<ul>
<li>å­˜å‚¨ Block å’Œæ•°æ®æ ¡éªŒå’Œ</li>
<li>æ‰§è¡Œå®¢æˆ·ç«¯å‘é€çš„è¯»å†™æ“ä½œ</li>
<li>é€šè¿‡å¿ƒè·³æœºåˆ¶å®šæœŸï¼ˆé»˜è®¤ 3 ç§’ï¼‰å‘ NameNode æ±‡æŠ¥è¿è¡ŒçŠ¶æ€å’Œ Block åˆ—è¡¨ä¿¡æ¯</li>
<li>é›†ç¾¤å¯åŠ¨æ—¶ï¼ŒDataNode å‘ NameNode æä¾› Block åˆ—è¡¨ä¿¡æ¯</li>
</ul>
<h3 id="block-æ•°æ®å—"><a class="markdownIt-Anchor" href="#block-æ•°æ®å—"></a> Block æ•°æ®å—</h3>
<ul>
<li>HDFS æœ€å°å­˜å‚¨å•å…ƒ</li>
<li>æ–‡ä»¶å†™å…¥ HDFS ä¼šè¢«åˆ‡åˆ†æˆè‹¥å¹²ä¸ª Block</li>
<li>Block å¤§å°å›ºå®šï¼Œé»˜è®¤ä¸º 128MBï¼Œå¯è‡ªå®šä¹‰</li>
<li>è‹¥ä¸€ä¸ª Block çš„å¤§å°å°äºè®¾å®šå€¼ï¼Œä¸ä¼šå ç”¨æ•´ä¸ªå—ç©ºé—´</li>
<li>é»˜è®¤æƒ…å†µä¸‹æ¯ä¸ª Block æœ‰ 3 ä¸ªå‰¯æœ¬</li>
</ul>
<h3 id="client"><a class="markdownIt-Anchor" href="#client"></a> Client</h3>
<ul>
<li>å°†æ–‡ä»¶åˆ‡åˆ†ä¸º Block æ•°æ®å—</li>
<li>ä¸ NameNode äº¤äº’ï¼Œè·å–æ–‡ä»¶å…ƒæ•°æ®</li>
<li>ä¸ DataNode äº¤äº’ï¼Œè¯»å–æˆ–å†™å…¥æ•°æ®</li>
<li>ç®¡ç† HDFS</li>
</ul>
<h2 id="block-å‰¯æœ¬ç­–ç•¥"><a class="markdownIt-Anchor" href="#block-å‰¯æœ¬ç­–ç•¥"></a> Block å‰¯æœ¬ç­–ç•¥</h2>
<p>HDFS è¢«è®¾è®¡æˆèƒ½å¤Ÿåœ¨ä¸€ä¸ªå¤§é›†ç¾¤ä¸­è·¨æœºå™¨å¯é åœ°å­˜å‚¨è¶…å¤§æ–‡ä»¶ã€‚å®ƒå°†æ¯ä¸ªæ–‡ä»¶å­˜å‚¨æˆä¸€ç³»åˆ—çš„æ•°æ®å—ï¼Œé™¤äº†æœ€åä¸€ä¸ªï¼Œæ‰€æœ‰çš„æ•°æ®å—éƒ½æ˜¯åŒæ ·å¤§å°çš„ã€‚ä¸ºäº†å®¹é”™ï¼Œæ–‡ä»¶çš„æ‰€æœ‰æ•°æ®å—éƒ½ä¼šæœ‰å‰¯æœ¬ã€‚æ¯ä¸ªæ–‡ä»¶çš„æ•°æ®å—å¤§å°å’Œå‰¯æœ¬ç³»æ•°éƒ½æ˜¯å¯é…ç½®çš„ã€‚åº”ç”¨ç¨‹åºå¯ä»¥æŒ‡å®šæŸä¸ªæ–‡ä»¶çš„å‰¯æœ¬æ•°ç›®ã€‚å‰¯æœ¬ç³»æ•°å¯ä»¥åœ¨æ–‡ä»¶åˆ›å»ºçš„æ—¶å€™æŒ‡å®šï¼Œä¹Ÿå¯ä»¥åœ¨ä¹‹åæ”¹å˜ã€‚HDFS ä¸­çš„æ–‡ä»¶éƒ½æ˜¯ä¸€æ¬¡æ€§å†™å…¥çš„ï¼Œå¹¶ä¸”ä¸¥æ ¼è¦æ±‚åœ¨ä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªå†™å…¥è€…ã€‚</p>
<p><strong>Namenode å…¨æƒç®¡ç†æ•°æ®å—çš„å¤åˆ¶</strong>ï¼Œå®ƒå‘¨æœŸæ€§åœ°ä»é›†ç¾¤ä¸­çš„æ¯ä¸ª Datanode æ¥æ”¶å¿ƒè·³ä¿¡å·å’Œå—çŠ¶æ€æŠ¥å‘Š(Blockreport)ã€‚æ¥æ”¶åˆ°å¿ƒè·³ä¿¡å·æ„å‘³ç€è¯¥ Datanode èŠ‚ç‚¹å·¥ä½œæ­£å¸¸ã€‚å—çŠ¶æ€æŠ¥å‘ŠåŒ…å«äº†ä¸€ä¸ªè¯¥ Datanode ä¸Šæ‰€æœ‰æ•°æ®å—çš„åˆ—è¡¨ã€‚</p>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hdfs/hdfs-replica.png"/></div>
<ul>
<li>å‰¯æœ¬ 1ï¼šæ”¾åœ¨ Client æ‰€åœ¨èŠ‚ç‚¹
<ul>
<li>å¯¹äºè¿œç¨‹ Clientï¼Œç³»ç»Ÿä¼šéšæœºé€‰æ‹©èŠ‚ç‚¹</li>
</ul>
</li>
<li>å‰¯æœ¬ 2ï¼šæ”¾åœ¨ä¸åŒçš„æœºæ¶èŠ‚ç‚¹ä¸Š</li>
<li>å‰¯æœ¬ 3ï¼šæ”¾åœ¨ä¸ç¬¬äºŒä¸ªå‰¯æœ¬åŒä¸€æœºæ¶çš„ä¸åŒèŠ‚ç‚¹ä¸Š</li>
<li>å‰¯æœ¬ Nï¼šéšæœºé€‰æ‹©</li>
<li>èŠ‚ç‚¹é€‰æ‹©ï¼šåŒç­‰æ¡ä»¶ä¸‹ä¼˜å…ˆé€‰æ‹©ç©ºé—²èŠ‚ç‚¹</li>
</ul>
<h2 id="æ•°æ®æµ"><a class="markdownIt-Anchor" href="#æ•°æ®æµ"></a> æ•°æ®æµ</h2>
<h3 id="hdfs-è¯»æ–‡ä»¶"><a class="markdownIt-Anchor" href="#hdfs-è¯»æ–‡ä»¶"></a> HDFS è¯»æ–‡ä»¶</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hdfs/hdfs-read.png"/></div>
<ol>
<li>å®¢æˆ·ç«¯è°ƒç”¨ FileSyste å¯¹è±¡çš„ open() æ–¹æ³•åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­<strong>æ‰“å¼€è¦è¯»å–çš„æ–‡ä»¶</strong>ã€‚</li>
<li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ä½¿ç”¨ RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ¥è°ƒç”¨ namenodeï¼Œ<strong>ç¡®å®šæ–‡ä»¶èµ·å§‹å—çš„ä½ç½®</strong>ã€‚</li>
<li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„ DistributedFileSystem ç±»è¿”å›ä¸€ä¸ªæ”¯æŒæ–‡ä»¶å®šä½çš„è¾“å…¥æµ FSDataInputStream å¯¹è±¡ï¼ŒFSDataInputStream å¯¹è±¡æ¥ç€å°è£… DFSInputStream å¯¹è±¡ï¼ˆ<strong>å­˜å‚¨ç€æ–‡ä»¶èµ·å§‹å‡ ä¸ªå—çš„ datanode åœ°å€</strong>ï¼‰ï¼Œå®¢æˆ·ç«¯å¯¹è¿™ä¸ªè¾“å…¥æµè°ƒç”¨ read()æ–¹æ³•ã€‚</li>
<li>DFSInputStream è¿æ¥è·ç¦»æœ€è¿‘çš„ datanodeï¼Œé€šè¿‡åå¤è°ƒç”¨ read æ–¹æ³•ï¼Œ<strong>å°†æ•°æ®ä» datanode ä¼ è¾“åˆ°å®¢æˆ·ç«¯</strong>ã€‚</li>
<li>åˆ°è¾¾å—çš„æœ«ç«¯æ—¶ï¼ŒDFSInputStream å…³é—­ä¸è¯¥ datanode çš„è¿æ¥ï¼Œ<strong>å¯»æ‰¾ä¸‹ä¸€ä¸ªå—çš„æœ€ä½³ datanode</strong>ã€‚</li>
<li>å®¢æˆ·ç«¯å®Œæˆè¯»å–ï¼Œå¯¹ FSDataInputStream è°ƒç”¨ close()æ–¹æ³•<strong>å…³é—­è¿æ¥</strong>ã€‚</li>
</ol>
<h3 id="hdfs-å†™æ–‡ä»¶"><a class="markdownIt-Anchor" href="#hdfs-å†™æ–‡ä»¶"></a> HDFS å†™æ–‡ä»¶</h3>
<div align="center"><img src="http://dunwu.test.upcdn.net/cs/bigdata/hdfs/hdfs-write.png"/></div>
<ol>
<li>å®¢æˆ·ç«¯é€šè¿‡å¯¹ DistributedFileSystem å¯¹è±¡è°ƒç”¨ create() å‡½æ•°æ¥<strong>æ–°å»ºæ–‡ä»¶</strong>ã€‚</li>
<li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå¯¹ namenod åˆ›å»ºä¸€ä¸ª RPC è°ƒç”¨ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿçš„<strong>å‘½åç©ºé—´ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶</strong>ã€‚</li>
<li>Namenode å¯¹æ–°å»ºæ–‡ä»¶è¿›è¡Œæ£€æŸ¥æ— è¯¯åï¼Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ª FSDataOutputStream å¯¹è±¡ï¼ŒFSDataOutputStream å¯¹è±¡å°è£…ä¸€ä¸ª DFSoutPutstream å¯¹è±¡ï¼Œè´Ÿè´£å¤„ç† namenode å’Œ datanode ä¹‹é—´çš„é€šä¿¡ï¼Œ<strong>å®¢æˆ·ç«¯å¼€å§‹å†™å…¥æ•°æ®</strong>ã€‚</li>
<li>FSDataOutputStream å°†<strong>æ•°æ®åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„æ•°æ®åŒ…ï¼Œå†™å…¥å†…éƒ¨é˜Ÿåˆ—â€œæ•°æ®é˜Ÿåˆ—â€</strong>ï¼ŒDataStreamer è´Ÿè´£å°†æ•°æ®åŒ…ä¾æ¬¡æµå¼ä¼ è¾“åˆ°ç”±ä¸€ç»„ namenode æ„æˆçš„ç®¡çº¿ä¸­ã€‚</li>
<li>DFSOutputStream ç»´æŠ¤ç€ç¡®è®¤é˜Ÿåˆ—æ¥ç­‰å¾… datanode æ”¶åˆ°ç¡®è®¤å›æ‰§ï¼Œ<strong>æ”¶åˆ°ç®¡é“ä¸­æ‰€æœ‰ datanode ç¡®è®¤åï¼Œæ•°æ®åŒ…ä»ç¡®è®¤é˜Ÿåˆ—åˆ </strong>é™¤ã€‚</li>
<li><strong>å®¢æˆ·ç«¯å®Œæˆæ•°æ®çš„å†™å…¥</strong>ï¼Œå¯¹æ•°æ®æµè°ƒç”¨ close() æ–¹æ³•ã€‚</li>
<li>namenode <strong>ç¡®è®¤å®Œæˆ</strong>ã€‚</li>
</ol>
<h2 id="hdfs-å®‰å…¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#hdfs-å®‰å…¨æ¨¡å¼"></a> HDFS å®‰å…¨æ¨¡å¼</h2>
<h3 id="ä»€ä¹ˆæ˜¯å®‰å…¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯å®‰å…¨æ¨¡å¼"></a> ä»€ä¹ˆæ˜¯å®‰å…¨æ¨¡å¼ï¼Ÿ</h3>
<ul>
<li>å®‰å…¨æ¨¡å¼æ˜¯ HDFS çš„ä¸€ç§ç‰¹æ®ŠçŠ¶æ€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼ŒHDFS åªæ¥æ”¶è¯»æ•°æ®è¯·æ±‚ï¼Œè€Œä¸æ¥æ”¶å†™å…¥ã€åˆ é™¤ã€ä¿®æ”¹ç­‰å˜æ›´è¯·æ±‚ã€‚</li>
<li>å®‰å…¨æ¨¡å¼æ˜¯ HDFS ç¡®ä¿ Block æ•°æ®å®‰å…¨çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚</li>
<li>Active NameNode å¯åŠ¨æ—¶ï¼ŒHDFS ä¼šè¿›å…¥å®‰å…¨æ¨¡å¼ï¼ŒDataNode ä¸»åŠ¨å‘ NameNode æ±‡æŠ¥å¯ç”¨ Block åˆ—è¡¨ç­‰ä¿¡æ¯ï¼Œåœ¨ç³»ç»Ÿè¾¾åˆ°å®‰å…¨æ ‡å‡†å‰ï¼ŒHDFS ä¸€ç›´å¤„äºâ€œåªè¯»â€çŠ¶æ€ã€‚</li>
</ul>
<h3 id="ä½•æ—¶æ­£å¸¸ç¦»å¼€å®‰å…¨æ¨¡å¼"><a class="markdownIt-Anchor" href="#ä½•æ—¶æ­£å¸¸ç¦»å¼€å®‰å…¨æ¨¡å¼"></a> ä½•æ—¶æ­£å¸¸ç¦»å¼€å®‰å…¨æ¨¡å¼</h3>
<ul>
<li>Block ä¸ŠæŠ¥ç‡ï¼šDataNode ä¸ŠæŠ¥çš„å¯ç”¨ Block ä¸ªæ•° / NameNode å…ƒæ•°æ®è®°å½•çš„ Block ä¸ªæ•°</li>
<li>å½“ Block ä¸ŠæŠ¥ç‡ &gt;= é˜ˆå€¼æ—¶ï¼ŒHDFS æ‰èƒ½ç¦»å¼€å®‰å…¨æ¨¡å¼ï¼Œé»˜è®¤é˜ˆå€¼ä¸º 0.999</li>
<li>ä¸å»ºè®®æ‰‹åŠ¨å¼ºåˆ¶é€€å‡ºå®‰å…¨æ¨¡å¼</li>
</ul>
<h3 id="è§¦å‘å®‰å…¨æ¨¡å¼çš„åŸå› "><a class="markdownIt-Anchor" href="#è§¦å‘å®‰å…¨æ¨¡å¼çš„åŸå› "></a> è§¦å‘å®‰å…¨æ¨¡å¼çš„åŸå› </h3>
<ul>
<li>NameNode é‡å¯</li>
<li>NameNode ç£ç›˜ç©ºé—´ä¸è¶³</li>
<li>Block ä¸ŠæŠ¥ç‡ä½äºé˜ˆå€¼</li>
<li>DataNode æ— æ³•æ­£å¸¸å¯åŠ¨</li>
<li>æ—¥å¿—ä¸­å‡ºç°ä¸¥é‡å¼‚å¸¸</li>
<li>ç”¨æˆ·æ“ä½œä¸å½“ï¼Œå¦‚ï¼š<strong>å¼ºåˆ¶å…³æœºï¼ˆç‰¹åˆ«æ³¨æ„ï¼ï¼‰</strong></li>
</ul>
<h3 id="æ•…éšœæ’æŸ¥"><a class="markdownIt-Anchor" href="#æ•…éšœæ’æŸ¥"></a> æ•…éšœæ’æŸ¥</h3>
<ul>
<li>æ‰¾åˆ° DataNode ä¸èƒ½æ­£å¸¸å¯åŠ¨çš„åŸå› ï¼Œé‡å¯ DataNode</li>
<li>æ¸…ç† NameNode ç£ç›˜</li>
<li>è°¨æ…æ“ä½œï¼Œæœ‰é—®é¢˜æ‰¾æ˜Ÿç¯ï¼Œä»¥å…ä¸¢å¤±æ•°æ®</li>
</ul>
<h2 id="hdfs-é«˜å¯ç”¨"><a class="markdownIt-Anchor" href="#hdfs-é«˜å¯ç”¨"></a> HDFS é«˜å¯ç”¨</h2>
<h3 id="namenode-çš„-ha-æœºåˆ¶"><a class="markdownIt-Anchor" href="#namenode-çš„-ha-æœºåˆ¶"></a> NameNode çš„ HA æœºåˆ¶</h3>
<p>Active NameNode å’Œ Standby NameNode å®ç°ä¸»å¤‡ã€‚</p>
<h3 id="åˆ©ç”¨-qjm-å®ç°å…ƒæ•°æ®é«˜å¯ç”¨"><a class="markdownIt-Anchor" href="#åˆ©ç”¨-qjm-å®ç°å…ƒæ•°æ®é«˜å¯ç”¨"></a> åˆ©ç”¨ QJM å®ç°å…ƒæ•°æ®é«˜å¯ç”¨</h3>
<blockquote>
<p>åŸºäº Paxos ç®—æ³•</p>
</blockquote>
<p>QJM æœºåˆ¶ï¼ˆQuorum Journal Managerï¼‰</p>
<p>åªè¦ä¿è¯ Quorumï¼ˆæ³•å®šäººæ•°ï¼‰æ•°é‡çš„æ“ä½œæˆåŠŸï¼Œå°±è®¤ä¸ºè¿™æ˜¯ä¸€æ¬¡æœ€ç»ˆæˆåŠŸçš„æ“ä½œ</p>
<p>QJM å…±äº«å­˜å‚¨ç³»ç»Ÿ</p>
<ul>
<li>éƒ¨ç½²å¥‡æ•°ï¼ˆ2N+1ï¼‰ä¸ª JournalNode</li>
<li>JournalNode è´Ÿè´£å­˜å‚¨ edits ç¼–è¾‘æ—¥å¿—</li>
<li>å†™ edits çš„æ—¶å€™ï¼Œåªè¦è¶…è¿‡åŠæ•°ï¼ˆï‚³N+1ï¼‰çš„ JournalNode è¿”å›æˆåŠŸï¼Œå°±ä»£è¡¨æœ¬æ¬¡å†™å…¥æˆåŠŸ</li>
<li>æœ€å¤šå¯å®¹å¿ N ä¸ª JournalNode å®•æœº</li>
</ul>
<p>åˆ©ç”¨ ZooKeeper å®ç° Active èŠ‚ç‚¹é€‰ä¸¾ã€‚</p>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
<ul>
<li><a href="http://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html" target="_blank" rel="noopener">HDFS å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://www.cnblogs.com/caiyisen/p/7395843.html" target="_blank" rel="noopener">HDFS çŸ¥è¯†ç‚¹æ€»ç»“</a></li>
<li><a href="http://shop.oreilly.com/product/0636920033448.do" target="_blank" rel="noopener">ã€ŠHadoop: The Definitive Guide, Fourth Editionã€‹</a> by Tom White</li>
<li><a href="http://hadoop.apache.org/docs/r1.0.4/cn/hdfs_design.html" target="_blank" rel="noopener">http://hadoop.apache.org/docs/r1.0.4/cn/hdfs_design.html</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dunwu.github.io/blog/blog/bigdata/overview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Zhang Peng">
      <meta itemprop="description" content="Dunwu's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/bigdata/overview/" class="post-title-link" itemprop="url">å¤§æ•°æ®ç®€ä»‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-09-03 00:00:00" itemprop="dateCreated datePublished" datetime="2018-09-03T00:00:00+08:00">2018-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-05-08 18:07:48" itemprop="dateModified" datetime="2019-05-08T18:07:48+08:00">2019-05-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/bigdata/" itemprop="url" rel="index">
                    <span itemprop="name">bigdata</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqusï¼š</span>
    
    <a title="disqus" href="/blog/bigdata/overview/#comments" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="bigdata/overview/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>2k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å¤§æ•°æ®ç®€ä»‹"><a class="markdownIt-Anchor" href="#å¤§æ•°æ®ç®€ä»‹"></a> å¤§æ•°æ®ç®€ä»‹</h1>
<!-- TOC depthFrom:2 depthTo:3 -->
<ul>
<li><a href="#%E7%AE%80%E4%BB%8B">ç®€ä»‹</a>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%A4%A7%E6%95%B0%E6%8D%AE">ä»€ä¹ˆæ˜¯å¤§æ•°æ®</a></li>
<li><a href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">åº”ç”¨åœºæ™¯</a></li>
<li><a href="#hadoop-%E7%BC%96%E5%B9%B4%E5%8F%B2">Hadoop ç¼–å¹´å²</a></li>
</ul>
</li>
<li><a href="#%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB">æŠ€æœ¯ä½“ç³»</a>
<ul>
<li><a href="#hdfs">HDFS</a></li>
<li><a href="#mapreduce">MapReduce</a></li>
<li><a href="#spark">Spark</a></li>
<li><a href="#yarn">YARN</a></li>
<li><a href="#hive">Hive</a></li>
<li><a href="#hbase">HBase</a></li>
<li><a href="#elasticsearch">ElasticSearch</a></li>
</ul>
</li>
<li><a href="#%E6%9C%AF%E8%AF%AD">æœ¯è¯­</a></li>
<li><a href="#%E8%B5%84%E6%BA%90">èµ„æº</a></li>
</ul>
<!-- /TOC -->
<h2 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h2>
<h3 id="ä»€ä¹ˆæ˜¯å¤§æ•°æ®"><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯å¤§æ•°æ®"></a> ä»€ä¹ˆæ˜¯å¤§æ•°æ®</h3>
<p>å¤§æ•°æ®æ˜¯æŒ‡è¶…å‡ºä¼ ç»Ÿæ•°æ®åº“å·¥å…·æ”¶é›†ã€å­˜å‚¨ã€ç®¡ç†å’Œåˆ†æèƒ½åŠ›çš„æ•°æ®é›†ã€‚ä¸æ­¤åŒæ—¶ï¼ŒåŠæ—¶é‡‡é›†ã€å­˜å‚¨ã€èšåˆã€ç®¡ç†æ•°æ®ï¼Œä»¥åŠå¯¹æ•°æ®æ·±åº¦åˆ†æçš„æ–°æŠ€æœ¯å’Œæ–°èƒ½åŠ›ï¼Œæ­£åœ¨å¿«é€Ÿå¢é•¿ï¼Œå°±åƒé¢„æµ‹è®¡ç®—èŠ¯ç‰‡å¢é•¿é€Ÿåº¦çš„æ‘©å°”å®šå¾‹ä¸€æ ·ã€‚</p>
<ul>
<li><strong>Volume</strong> - æ•°æ®è§„æ¨¡å·¨å¤§</li>
<li><strong>Velocity</strong> - ç”Ÿæˆå’Œå¤„ç†é€Ÿåº¦æå¿«</li>
<li><strong>Variety</strong> - æ•°æ®è§„æ¨¡å·¨å¤§</li>
<li><strong>Value</strong> - ç”Ÿæˆå’Œå¤„ç†é€Ÿåº¦æå¿«</li>
</ul>
<h3 id="åº”ç”¨åœºæ™¯"><a class="markdownIt-Anchor" href="#åº”ç”¨åœºæ™¯"></a> åº”ç”¨åœºæ™¯</h3>
<p>åŸºäºå¤§æ•°æ®çš„æ•°æ®ä»“åº“</p>
<p>åŸºäºå¤§æ•°æ®çš„å®æ—¶æµå¤„ç†</p>
<h3 id="hadoop-ç¼–å¹´å²"><a class="markdownIt-Anchor" href="#hadoop-ç¼–å¹´å²"></a> Hadoop ç¼–å¹´å²</h3>
<table>
<thead>
<tr>
<th style="text-align:left">æ—¶é—´</th>
<th style="text-align:left">äº‹ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2003.01</td>
<td style="text-align:left">Googleå‘è¡¨äº†Google File Systemè®ºæ–‡</td>
</tr>
<tr>
<td style="text-align:left">2004.01</td>
<td style="text-align:left">Googleå‘è¡¨äº†MapReduceè®ºæ–‡</td>
</tr>
<tr>
<td style="text-align:left">2006.02</td>
<td style="text-align:left">Apache Hadoopé¡¹ç›®æ­£å¼å¯åŠ¨ï¼Œå¹¶æ”¯æŒMapReduceå’ŒHDFSç‹¬ç«‹å‘å±•</td>
</tr>
<tr>
<td style="text-align:left">2006.11</td>
<td style="text-align:left">Googleå‘è¡¨äº†Bigtableè®ºæ–‡</td>
</tr>
<tr>
<td style="text-align:left">2008.01</td>
<td style="text-align:left">Hadoopæˆä¸ºApacheé¡¶çº§é¡¹ç›®</td>
</tr>
<tr>
<td style="text-align:left">2009.03</td>
<td style="text-align:left">Clouderaæ¨å‡ºä¸–ç•Œä¸Šé¦–ä¸ªHadoopå‘è¡Œç‰ˆâ€”â€”CDHï¼Œå¹¶å®Œå…¨å¼€æ”¾æºç </td>
</tr>
<tr>
<td style="text-align:left">2012.03</td>
<td style="text-align:left">HDFS NameNode HAåŠ å…¥Hadoopä¸»ç‰ˆæœ¬</td>
</tr>
<tr>
<td style="text-align:left">2014.02</td>
<td style="text-align:left">Sparkä»£æ›¿MapReduceæˆä¸ºHadoopçš„ç¼ºçœè®¡ç®—å¼•æ“ï¼Œå¹¶æˆä¸ºApacheé¡¶çº§é¡¹ç›®</td>
</tr>
</tbody>
</table>
<h2 id="æŠ€æœ¯ä½“ç³»"><a class="markdownIt-Anchor" href="#æŠ€æœ¯ä½“ç³»"></a> æŠ€æœ¯ä½“ç³»</h2>
<h3 id="hdfs"><a class="markdownIt-Anchor" href="#hdfs"></a> HDFS</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆHadoop Distributed File Systemï¼‰</li>
<li>åœ¨å¼€æºå¤§æ•°æ®æŠ€æœ¯ä½“ç³»ä¸­ï¼Œåœ°ä½æ— å¯æ›¿ä»£</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>é«˜å®¹é”™ï¼šæ•°æ®å¤šå‰¯æœ¬ï¼Œå‰¯æœ¬ä¸¢å¤±åè‡ªåŠ¨æ¢å¤</li>
<li>é«˜å¯ç”¨ï¼šNameNode HAï¼Œå®‰å…¨æ¨¡å¼</li>
<li>é«˜æ‰©å±•ï¼š10K èŠ‚ç‚¹è§„æ¨¡</li>
<li>ç®€å•ä¸€è‡´æ€§æ¨¡å‹ï¼šä¸€æ¬¡å†™å…¥å¤šæ¬¡è¯»å–ï¼Œæ”¯æŒè¿½åŠ ï¼Œä¸å…è®¸ä¿®æ”¹</li>
<li>æµå¼æ•°æ®è®¿é—®ï¼šæ‰¹é‡è¯»è€Œééšæœºè¯»ï¼Œå…³æ³¨ååé‡è€Œéæ—¶é—´</li>
<li>å¤§è§„æ¨¡æ•°æ®é›†ï¼šå…¸å‹æ–‡ä»¶å¤§å° GB~TB çº§ï¼Œç™¾ä¸‡ä»¥ä¸Šæ–‡ä»¶æ•°é‡ï¼Œ PB ä»¥ä¸Šæ•°æ®è§„æ¨¡</li>
<li>æ„å»ºæˆæœ¬ä½ä¸”å®‰å…¨å¯é ï¼šè¿è¡Œåœ¨å¤§é‡çš„å»‰ä»·å•†ç”¨æœºå™¨ä¸Šï¼Œç¡¬ä»¶é”™è¯¯æ˜¯å¸¸æ€ï¼Œæä¾›å®¹é”™æœºåˆ¶</li>
</ul>
<h3 id="mapreduce"><a class="markdownIt-Anchor" href="#mapreduce"></a> MapReduce</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>é¢å‘æ‰¹å¤„ç†çš„åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶</li>
<li>ç¼–ç¨‹æ¨¡å‹ï¼šå°† MapReduce ç¨‹åºåˆ†ä¸º Mapã€Reduce ä¸¤ä¸ªé˜¶æ®µ</li>
</ul>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong></p>
<ul>
<li>åˆ†è€Œæ²»ä¹‹ï¼Œåˆ†å¸ƒå¼è®¡ç®—</li>
<li>ç§»åŠ¨è®¡ç®—ï¼Œè€Œéç§»åŠ¨æ•°æ®</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>é«˜å®¹é”™ï¼šä»»åŠ¡å¤±è´¥ï¼Œè‡ªåŠ¨è°ƒåº¦åˆ°å…¶ä»–èŠ‚ç‚¹é‡æ–°æ‰§è¡Œ</li>
<li>é«˜æ‰©å±•ï¼šè®¡ç®—èƒ½åŠ›éšç€èŠ‚ç‚¹æ•°å¢åŠ ï¼Œè¿‘ä¼¼çº¿æ€§é€’å¢</li>
<li>é€‚ç”¨äºæµ·é‡æ•°æ®çš„ç¦»çº¿æ‰¹å¤„ç†</li>
<li>é™ä½äº†åˆ†å¸ƒå¼ç¼–ç¨‹çš„é—¨æ§›</li>
</ul>
<h3 id="spark"><a class="markdownIt-Anchor" href="#spark"></a> Spark</h3>
<p>é«˜æ€§èƒ½åˆ†å¸ƒå¼é€šç”¨è®¡ç®—å¼•æ“</p>
<ul>
<li>Spark Core - åŸºç¡€è®¡ç®—æ¡†æ¶ï¼ˆæ‰¹å¤„ç†ã€äº¤äº’å¼åˆ†æï¼‰</li>
<li>Spark SQL - SQL å¼•æ“ï¼ˆæµ·é‡ç»“æ„åŒ–æ•°æ®çš„é«˜æ€§èƒ½æŸ¥è¯¢ï¼‰</li>
<li>Spark Streaming - å®æ—¶æµå¤„ç†ï¼ˆå¾®æ‰¹ï¼‰</li>
<li>Spark MLlib - æœºå™¨å­¦ä¹ </li>
<li>Spark GraphX - å›¾è®¡ç®—</li>
</ul>
<p>é‡‡ç”¨ Scala è¯­è¨€å¼€å‘</p>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>è®¡ç®—é«˜æ•ˆ - å†…å­˜è®¡ç®—ã€Cache ç¼“å­˜æœºåˆ¶ã€DAG å¼•æ“ã€å¤šçº¿ç¨‹æ± æ¨¡å‹</li>
<li>é€šç”¨æ˜“ç”¨ - é€‚ç”¨äºæ‰¹å¤„ç†ã€äº¤äº’å¼è®¡ç®—ã€æµå¤„ç†ã€æœºå™¨å­¦ä¹ ã€å›¾è®¡ç®—ç­‰å¤šç§åœºæ™¯</li>
<li>è¿è¡Œæ¨¡å¼å¤šæ · - Localã€Standaloneã€YARN/Mesos</li>
</ul>
<h3 id="yarn"><a class="markdownIt-Anchor" href="#yarn"></a> YARN</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>Yet Another Resource Negotiatorï¼Œå¦ä¸€ç§èµ„æºç®¡ç†å™¨</li>
<li>ä¸ºäº†è§£å†³ Hadoop 1.x ä¸­ MapReduce çš„å…ˆå¤©ç¼ºé™·</li>
<li>åˆ†å¸ƒå¼é€šç”¨èµ„æºç®¡ç†ç³»ç»Ÿ</li>
<li>è´Ÿè´£é›†ç¾¤èµ„æºçš„ç»Ÿä¸€ç®¡ç†</li>
<li>ä» Hadoop 2.x å¼€å§‹ï¼ŒYARN æˆä¸º Hadoop çš„æ ¸å¿ƒç»„ä»¶</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>ä¸“æ³¨äºèµ„æºç®¡ç†å’Œä½œä¸šè°ƒåº¦</li>
<li>é€šç”¨ - é€‚ç”¨å„ç§è®¡ç®—æ¡†æ¶ï¼Œå¦‚ - MapReduceã€Spark</li>
<li>é«˜å¯ç”¨ - ResourceManager é«˜å¯ç”¨ã€HDFS é«˜å¯ç”¨</li>
<li>é«˜æ‰©å±•</li>
</ul>
<h3 id="hive"><a class="markdownIt-Anchor" href="#hive"></a> Hive</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>Hadoop æ•°æ®ä»“åº“ - ä¼ä¸šå†³ç­–æ”¯æŒ</li>
<li>SQL å¼•æ“ - å¯¹æµ·é‡ç»“æ„åŒ–æ•°æ®è¿›è¡Œé«˜æ€§èƒ½çš„ SQL æŸ¥è¯¢</li>
<li>é‡‡ç”¨ HDFS æˆ– HBase ä¸ºæ•°æ®å­˜å‚¨</li>
<li>é‡‡ç”¨ MapReduce æˆ– Spark ä¸ºè®¡ç®—æ¡†æ¶</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>æä¾›ç±» SQL æŸ¥è¯¢è¯­è¨€</li>
<li>æ”¯æŒå‘½ä»¤è¡Œæˆ– JDBC/ODBC</li>
<li>æä¾›çµæ´»çš„æ‰©å±•æ€§</li>
<li>æä¾›å¤æ‚æ•°æ®ç±»å‹ã€æ‰©å±•å‡½æ•°ã€è„šæœ¬ç­‰</li>
</ul>
<h3 id="hbase"><a class="markdownIt-Anchor" href="#hbase"></a> HBase</h3>
<p><strong>æ¦‚å¿µ</strong></p>
<ul>
<li>Hadoop Database</li>
<li>Google BigTable çš„å¼€æºå®ç°</li>
<li>åˆ†å¸ƒå¼ NoSQL æ•°æ®åº“</li>
<li>åˆ—å¼å­˜å‚¨ - ä¸»è¦ç”¨äºåŠç»“æ„åŒ–ã€éç»“æ„åŒ–æ•°æ®</li>
<li>é‡‡ç”¨ HDFS ä¸ºæ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ</li>
</ul>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li>é«˜æ€§èƒ½ - æ”¯æŒé«˜å¹¶å‘å†™å…¥å’ŒæŸ¥è¯¢</li>
<li>é«˜å¯ç”¨ - HDFS é«˜å¯ç”¨ã€Region é«˜å¯ç”¨</li>
<li>é«˜æ‰©å±• - æ•°æ®è‡ªåŠ¨åˆ‡åˆ†å’Œåˆ†å¸ƒï¼Œå¯åŠ¨æ€æ‰©å®¹ï¼Œæ— éœ€åœæœº</li>
<li>æµ·é‡å­˜å‚¨ - å•è¡¨å¯å®¹çº³æ•°åäº¿è¡Œï¼Œä¸Šç™¾ä¸‡åˆ—</li>
</ul>
<h3 id="elasticsearch"><a class="markdownIt-Anchor" href="#elasticsearch"></a> ElasticSearch</h3>
<ul>
<li>å¼€æºçš„åˆ†å¸ƒå¼å…¨æ–‡æ£€ç´¢å¼•æ“</li>
<li>åŸºäº Lucene å®ç°å…¨æ–‡æ•°æ®çš„å¿«é€Ÿå­˜å‚¨ã€æœç´¢å’Œåˆ†æ</li>
<li>å¤„ç†å¤§è§„æ¨¡æ•°æ® - PB çº§ä»¥ä¸Š</li>
<li>å…·æœ‰è¾ƒå¼ºçš„æ‰©å±•æ€§ï¼Œé›†ç¾¤è§„æ¨¡å¯è¾¾ä¸Šç™¾å°</li>
<li>é¦–é€‰çš„åˆ†å¸ƒå¼æœç´¢å¼•æ“</li>
</ul>
<h2 id="æœ¯è¯­"><a class="markdownIt-Anchor" href="#æœ¯è¯­"></a> æœ¯è¯­</h2>
<p><strong>æ•°æ®ä»“åº“ï¼ˆData Warehouseï¼‰</strong> - æ•°æ®ä»“åº“ï¼Œæ˜¯ä¸ºä¼ä¸šæ‰€æœ‰çº§åˆ«çš„å†³ç­–åˆ¶å®šè¿‡ç¨‹ï¼Œæä¾›æ‰€æœ‰ç±»å‹æ•°æ®æ”¯æŒçš„æˆ˜ç•¥é›†åˆã€‚å®ƒæ˜¯å•ä¸ªæ•°æ®å­˜å‚¨ï¼Œå‡ºäºåˆ†ææ€§æŠ¥å‘Šå’Œå†³ç­–æ”¯æŒç›®çš„è€Œåˆ›å»ºã€‚ ä¸ºéœ€è¦ä¸šåŠ¡æ™ºèƒ½çš„ä¼ä¸šï¼Œæä¾›æŒ‡å¯¼ä¸šåŠ¡æµç¨‹æ”¹è¿›ã€ç›‘è§†æ—¶é—´ã€æˆæœ¬ã€è´¨é‡ä»¥åŠæ§åˆ¶ã€‚</p>
<h2 id="èµ„æº"><a class="markdownIt-Anchor" href="#èµ„æº"></a> èµ„æº</h2>
<ul>
<li><a href="https://github.com/onurakpolat/awesome-bigdata" target="_blank" rel="noopener">awesome-bigdata</a></li>
<li><a href="http://hadoop.apache.org/" target="_blank" rel="noopener">Hadoop</a></li>
<li><a href="http://hbase.apache.org/" target="_blank" rel="noopener">HBase</a></li>
<li><a href="http://hive.apache.org/" target="_blank" rel="noopener">Hive</a></li>
<li><a href="http://impala.apache.org/" target="_blank" rel="noopener">Impala</a></li>
<li><a href="http://flume.apache.org/" target="_blank" rel="noopener">Flume</a></li>
<li><a href="http://kafka.apache.org/" target="_blank" rel="noopener">Kafka</a></li>
<li><a href="http://spark.apache.org/" target="_blank" rel="noopener">Spark</a></li>
<li><a href="http://sqoop.apache.org/" target="_blank" rel="noopener">Sqoop</a></li>
<li><a href="https://www.elastic.co/guide/index.html" target="_blank" rel="noopener">ElasticSearch</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/page/4/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/blog/page/6/">6</a><a class="page-number" href="/blog/page/7/">7</a><a class="extend next" rel="next" href="/blog/page/6/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="Zhang Peng"
    src="/blog/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Zhang Peng</p>
  <div class="site-description" itemprop="description">Dunwu's Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/dunwu" title="GitHub &amp;rarr; https:&#x2F;&#x2F;github.com&#x2F;dunwu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/blog/mailto:forbreak@163.com" title="E-Mail &amp;rarr; mailto:forbreak@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/blog/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2015 â€“ 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-paper-plane"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhang Peng</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">356k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">5:23</span>
</div>

        












        
      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script>
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>
<script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script>
<script src="/blog/js/schemes/pisces.js"></script>
<script src="/blog/js/next-boot.js"></script><script src="/blog/js/bookmark.js"></script>



  




  <script src="/blog/js/local-search.js"></script>













  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://blog-ajay4qmfci.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

</body>
</html>
